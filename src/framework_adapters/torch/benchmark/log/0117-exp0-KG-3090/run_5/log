WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240118 23:50:08.441553  7002 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_0', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [7002 sampler.py:454] Start PreSampling
WARNING [7002 sampler.py:532] Before construct renumbering_dict
WARNING [7002 sampler.py:555] PreSampling done
W20240118 23:50:10.995795  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240118 23:50:10.996151  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240118 23:50:10.996196  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240118 23:50:10.996237  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240118 23:50:10.996289  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240118 23:50:10.996330  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240118 23:50:10.996363  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240118 23:50:10.996420  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240118 23:50:10.996449  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240118 23:50:10.996497  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240118 23:50:10.996559  7002 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240118 23:50:10.996591  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240118 23:50:10.996615  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240118 23:50:10.996853  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240118 23:50:10.996922  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240118 23:50:10.996964  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240118 23:50:10.996995  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240118 23:50:10.997022  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240118 23:50:10.997064  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240118 23:50:10.997112  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240118 23:50:10.997139  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240118 23:50:10.997174  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240118 23:50:10.997202  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240118 23:50:10.997231  7002 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240118 23:50:10.997254  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240118 23:50:10.997280  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240118 23:50:10.997346  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240118 23:50:10.997376  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240118 23:50:10.997403  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240118 23:50:10.997450  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240118 23:50:10.997478  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240118 23:50:10.997510  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240118 23:50:10.997543  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240118 23:50:10.997570  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240118 23:50:10.997602  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240118 23:50:10.997642  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240118 23:50:10.997668  7002 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240118 23:50:10.997691  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240118 23:50:10.997713  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240118 23:50:10.997769  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240118 23:50:10.997804  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240118 23:50:10.997838  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240118 23:50:10.997871  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240118 23:50:10.997905  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240118 23:50:10.997943  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240118 23:50:10.997972  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240118 23:50:10.997998  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240118 23:50:10.998035  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240118 23:50:10.998068  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240118 23:50:10.998101  7002 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240118 23:50:10.998124  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240118 23:50:10.998152  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240118 23:50:10.998224  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240118 23:50:10.998257  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240118 23:50:10.998301  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240118 23:50:10.998342  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240118 23:50:10.998384  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240118 23:50:10.998423  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240118 23:50:10.998471  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240118 23:50:10.998509  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240118 23:50:10.998558  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240118 23:50:10.998586  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240118 23:50:10.998620  7002 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240118 23:50:10.998644  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240118 23:50:10.998667  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240118 23:50:10.998725  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240118 23:50:10.998755  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240118 23:50:10.998796  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240118 23:50:10.998823  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240118 23:50:10.998857  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240118 23:50:10.998894  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240118 23:50:10.998926  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240118 23:50:10.998970  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240118 23:50:10.999017  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240118 23:50:10.999050  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240118 23:50:10.999080  7002 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240118 23:50:10.999104  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240118 23:50:10.999132  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240118 23:50:10.999190  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240118 23:50:10.999220  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240118 23:50:10.999248  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240118 23:50:10.999275  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240118 23:50:10.999320  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240118 23:50:10.999370  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240118 23:50:10.999420  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240118 23:50:10.999466  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240118 23:50:10.999501  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240118 23:50:10.999541  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240118 23:50:10.999589  7002 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240118 23:50:10.999614  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240118 23:50:10.999636  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240118 23:50:10.999694  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240118 23:50:10.999732  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240118 23:50:10.999765  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240118 23:50:10.999809  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240118 23:50:10.999852  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240118 23:50:10.999897  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240118 23:50:10.999925  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240118 23:50:10.999953  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240118 23:50:10.999981  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240118 23:50:11.000010  7002 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240118 23:50:11.000037  7002 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240118 23:50:11.000061  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240118 23:50:11.000082  7002 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240118 23:50:11.225711  7002 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240118 23:50:11.225909  7002 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1508,  2036,  2815,  ...,  7942, 10902,  8446]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.820 seconds
[Rank1] pid = 7280
[Rank2] pid = 7344
[Rank3] pid = 7408
[Rank4] pid = 7476
[Rank5] pid = 7479
[Rank6] pid = 7606
INFO [7002 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [7280 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [7344 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [7476 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [7606 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [7408 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [7479 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [7607 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [7606 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7476 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7607 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7479 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7408 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240118 23:50:14.830338  7608 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240118 23:50:14.830566  7480 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240118 23:50:14.830566  7505 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240118 23:50:14.831049  7409 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240118 23:50:14.831049  7674 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
INFO [7002 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7344 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7280 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240118 23:50:14.832722  7609 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240118 23:50:14.833853  7345 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240118 23:50:14.834000  7281 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240118 23:50:14.856003  7505 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x1000054a6000
W20240118 23:50:14.856179  7505 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x10000556b000
W20240118 23:50:14.856226  7505 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 400]0x100005630000
W20240118 23:50:14.856271  7505 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10000eec8000
W20240118 23:50:14.856323  7505 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240118 23:50:14.856593  7480 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x100018764000
W20240118 23:50:14.856663  7608 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x100018829000
W20240118 23:50:14.856734  7480 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x1000188ee000
W20240118 23:50:14.856784  7480 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 400]0x1000189b3000
W20240118 23:50:14.856810  7608 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x10002224b000
W20240118 23:50:14.856850  7480 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x100022310000
W20240118 23:50:14.856871  7608 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 400]0x10002bba8000
W20240118 23:50:14.856889  7480 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240118 23:50:14.856915  7608 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x100035440000
W20240118 23:50:14.856949  7608 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240118 23:50:14.858127  7505 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240118 23:50:14.858481  7609 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x10003ecdc000
W20240118 23:50:14.858629  7609 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x10003eda1000
W20240118 23:50:14.858685  7609 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x10003ee66000
W20240118 23:50:14.858753  7609 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1000486fe000
W20240118 23:50:14.858790  7609 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240118 23:50:14.859436  7480 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240118 23:50:14.859781  7608 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240118 23:50:14.859970  7345 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x100051f9e000
W20240118 23:50:14.860093  7345 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100052063000
W20240118 23:50:14.860105  7281 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x100052128000
W20240118 23:50:14.860141  7345 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x1000521ed000
W20240118 23:50:14.860191  7345 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10005ba85000
W20240118 23:50:14.860224  7345 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240118 23:50:14.860242  7281 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x10006531d000
W20240118 23:50:14.860306  7281 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x1000653e2000
W20240118 23:50:14.860364  7281 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10006ec7a000
W20240118 23:50:14.860394  7281 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240118 23:50:14.861665  7609 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240118 23:50:14.863463  7345 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240118 23:50:14.863538  7281 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240118 23:50:14.868968  7674 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x100078528000
W20240118 23:50:14.869067  7409 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1000785ed000
W20240118 23:50:14.869148  7674 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x1000786b2000
W20240118 23:50:14.869187  7409 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x100078777000
W20240118 23:50:14.869215  7674 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 400]0x10007883c000
W20240118 23:50:14.869271  7674 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x1000820d4000
W20240118 23:50:14.869278  7409 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x10008b96c000
W20240118 23:50:14.869318  7674 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240118 23:50:14.869349  7409 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100095204000
W20240118 23:50:14.869393  7409 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240118 23:50:14.874019  7674 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240118 23:50:14.874400  7409 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [7479 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [7280 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [7344 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [7606 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [7476 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 7607
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [7002 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [7607 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [7408 DistTensor.py:56] The tensor name already exists in the kvstore
I20240118 23:50:15.054967  7409 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055027  7674 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055058  7505 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055092  7609 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055116  7480 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055157  7345 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055184  7608 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:50:15.055212  7281 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240118 23:50:15.056407  7609 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1
        }
W20240118 23:50:15.056499  7609 grad_base.h:172] Init GradProcessingBase done
I20240118 23:50:15.060012  7609 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240118 23:50:15.060106  7609 kg_controller.h:78] after init GradAsyncProcessingV2
I20240118 23:50:15.060111  7609 kg_controller.h:84] Construct KGCacheController done
I20240118 23:50:15.795022  7609 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240118 23:50:16.877346  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:50:16.877780  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240118 23:50:16.931756  7281 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240118 23:50:16.936985  7608 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.937337  7409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.939873  7345 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.940562  7505 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.946857  7609 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.972637  7674 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:50:16.972898  7480 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240118 23:50:19.281245  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240118 23:50:19.343647  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=0
W20240118 23:50:19.387459  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.304 ms                  | 7.657 ms                  |
| Forward                   | 11.835 ms                 | 834.462 ms                |
| Backward                  | 7.170 ms                  | 270.912 ms                |
| Optimize                  | 10.220 ms                 | 45.603 ms                 |
| BarrierTimeBeforeRank0    | 4.139 ms                  | 96.753 ms                 |
| AfterBackward             | 87.622 ms                 | 1.159 s                   |
| BlockToStepN              | 121.028 us                | 36.374 ms                 |
| OneStep                   | 98.193 ms                 | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:20.281378  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4490
W20240118 23:50:20.387435  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:50:20.435593  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=6, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 13.449 ms                 | 248.140 ms                |
| ProcessBack:UpdateCache   | 9.816 ms                  | 836.731 ms                |
| ProcessBack:UpsertPq      | 40.376 ms                 | 62.961 ms                 |
| ProcessOneStep            | 84.587 ms                 | 1.158 s                   |
| BlockToStepN              | 343.004 us                | 324.663 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:21.281066  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2723
W20240118 23:50:21.392112  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:50:21.435007  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=12, pq.top=10
E20240118 23:50:22.281133  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3891
W20240118 23:50:22.407377  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:50:22.502575  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=17
E20240118 23:50:23.281019  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2571
W20240118 23:50:23.450116  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:50:23.578112  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=26, pq.top=25
E20240118 23:50:24.281090  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=1869
W20240118 23:50:24.465123  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:50:24.578037  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=30, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.318 ms                  | 64.979 ms                 |
| Forward                   | 9.357 ms                  | 834.462 ms                |
| Backward                  | 8.381 ms                  | 270.912 ms                |
| Optimize                  | 5.413 ms                  | 45.603 ms                 |
| BarrierTimeBeforeRank0    | 69.360 us                 | 96.753 ms                 |
| AfterBackward             | 72.425 ms                 | 1.159 s                   |
| BlockToStepN              | 41.180 ms                 | 324.863 ms                |
| OneStep                   | 169.761 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:25.281059  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=914
W20240118 23:50:25.468822  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:50:25.578047  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.438 ms                 | 247.907 ms                |
| ProcessBack:UpdateCache   | 10.131 ms                 | 835.865 ms                |
| ProcessBack:UpsertPq      | 41.884 ms                 | 65.155 ms                 |
| ProcessOneStep            | 73.196 ms                 | 1.158 s                   |
| BlockToStepN              | 54.608 ms                 | 324.663 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:26.281132  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=1675
W20240118 23:50:26.487133  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:50:26.634388  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=38
E20240118 23:50:27.281010  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=4684
W20240118 23:50:27.523159  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
W20240118 23:50:27.649853  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=45, pq.top=43
E20240118 23:50:28.281109  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=32
W20240118 23:50:28.649019  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=46, pq.top=44
E20240118 23:50:29.281116  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1785
W20240118 23:50:29.649057  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=46, pq.top=44
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.299 ms                  | 64.979 ms                 |
| Forward                   | 9.413 ms                  | 834.462 ms                |
| Backward                  | 7.299 ms                  | 270.912 ms                |
| Optimize                  | 5.587 ms                  | 45.603 ms                 |
| BarrierTimeBeforeRank0    | 1.064 ms                  | 96.753 ms                 |
| AfterBackward             | 71.328 ms                 | 1.159 s                   |
| BlockToStepN              | 59.600 ms                 | 376.408 ms                |
| OneStep                   | 174.810 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:30.284812  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3088
W20240118 23:50:30.649011  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=46, pq.top=44
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.008 ms                 | 247.907 ms                |
| ProcessBack:UpdateCache   | 9.991 ms                  | 835.865 ms                |
| ProcessBack:UpsertPq      | 38.691 ms                 | 65.155 ms                 |
| ProcessOneStep            | 71.299 ms                 | 1.158 s                   |
| BlockToStepN              | 59.495 ms                 | 376.266 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:31.292410  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4462
W20240118 23:50:31.311069  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:50:31.649065  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=45
E20240118 23:50:32.292061  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4510
W20240118 23:50:32.315871  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:50:32.649037  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=43
E20240118 23:50:33.292837  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=838
W20240118 23:50:33.517990  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:50:33.661262  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=52, pq.top=49
E20240118 23:50:34.294462  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1681
W20240118 23:50:34.661079  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=54, pq.top=52
W20240118 23:50:34.776836  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.110 ms                  | 62.794 ms                 |
| Forward                   | 9.413 ms                  | 41.358 ms                 |
| Backward                  | 6.865 ms                  | 13.673 ms                 |
| Optimize                  | 5.701 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.242 ms                  | 66.694 ms                 |
| AfterBackward             | 70.535 ms                 | 247.442 ms                |
| BlockToStepN              | 74.181 ms                 | 411.345 ms                |
| OneStep                   | 184.488 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:35.294035  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=683
W20240118 23:50:35.661032  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=56
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.913 ms                 | 247.907 ms                |
| ProcessBack:UpdateCache   | 9.991 ms                  | 835.865 ms                |
| ProcessBack:UpsertPq      | 36.786 ms                 | 65.155 ms                 |
| ProcessOneStep            | 70.287 ms                 | 247.302 ms                |
| BlockToStepN              | 74.942 ms                 | 411.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:35.810199  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:50:36.294013  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1354
W20240118 23:50:36.661100  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=60, pq.top=57
W20240118 23:50:36.819816  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:50:37.294036  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1553
W20240118 23:50:37.661033  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=62
W20240118 23:50:38.022656  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:50:38.294086  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1658
W20240118 23:50:38.777777  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=67, pq.top=66
W20240118 23:50:39.022830  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:50:39.294008  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4104
W20240118 23:50:39.777078  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=68
W20240118 23:50:40.033440  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.104 ms                  | 62.794 ms                 |
| Forward                   | 9.213 ms                  | 41.358 ms                 |
| Backward                  | 7.840 ms                  | 13.673 ms                 |
| Optimize                  | 5.701 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.242 ms                  | 66.694 ms                 |
| AfterBackward             | 66.639 ms                 | 247.442 ms                |
| BlockToStepN              | 108.334 ms                | 411.345 ms                |
| OneStep                   | 239.819 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:40.294008  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3683
W20240118 23:50:40.777101  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.913 ms                 | 247.907 ms                |
| ProcessBack:UpdateCache   | 9.962 ms                  | 835.865 ms                |
| ProcessBack:UpsertPq      | 36.786 ms                 | 65.155 ms                 |
| ProcessOneStep            | 66.503 ms                 | 247.302 ms                |
| BlockToStepN              | 108.902 ms                | 411.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:41.043462  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:50:41.294037  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4913
W20240118 23:50:41.777124  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=73
W20240118 23:50:42.181893  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:50:42.294263  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=320
W20240118 23:50:42.899945  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=78
W20240118 23:50:43.186286  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:50:43.294494  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1505
W20240118 23:50:43.899156  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=82, pq.top=81
W20240118 23:50:44.267359  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:50:44.294009  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4492
W20240118 23:50:44.899130  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=85, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.968 ms                  | 62.794 ms                 |
| Forward                   | 8.973 ms                  | 41.358 ms                 |
| Backward                  | 6.865 ms                  | 13.673 ms                 |
| Optimize                  | 5.850 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.364 ms                  | 66.694 ms                 |
| AfterBackward             | 66.380 ms                 | 247.442 ms                |
| BlockToStepN              | 141.337 ms                | 411.345 ms                |
| OneStep                   | 272.680 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:45.294731  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1720
W20240118 23:50:45.348522  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.045 ms                 | 17.911 ms                 |
| ProcessBack:UpdateCache   | 9.986 ms                  | 16.549 ms                 |
| ProcessBack:UpsertPq      | 36.786 ms                 | 64.804 ms                 |
| ProcessOneStep            | 66.326 ms                 | 247.302 ms                |
| BlockToStepN              | 151.396 ms                | 411.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:45.899189  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=88, pq.top=85
E20240118 23:50:46.294163  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=380
W20240118 23:50:46.530692  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:50:47.015245  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=87
E20240118 23:50:47.296407  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
W20240118 23:50:47.571939  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:50:48.015130  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=92
E20240118 23:50:48.296072  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1704
W20240118 23:50:48.725139  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:50:49.015201  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=96, pq.top=94
E20240118 23:50:49.301585  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1167
W20240118 23:50:49.795295  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:50:50.015096  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=99, pq.top=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.968 ms                  | 62.794 ms                 |
| Forward                   | 8.759 ms                  | 41.358 ms                 |
| Backward                  | 6.700 ms                  | 13.673 ms                 |
| Optimize                  | 5.916 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.364 ms                  | 66.694 ms                 |
| AfterBackward             | 66.105 ms                 | 247.442 ms                |
| BlockToStepN              | 174.362 ms                | 411.345 ms                |
| OneStep                   | 302.176 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:50:50.301028  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=5440
[proc 6] 100 steps, total: 33.598, sample: 0.860, forward: 1.552, backward: 0.982, update: 0.559
[proc 7] 100 steps, total: 33.562, sample: 0.770, forward: 1.530, backward: 1.026, update: 0.589
[proc 3] 100 steps, total: 33.598, sample: 0.878, forward: 1.516, backward: 1.126, update: 0.536
[proc 5] 100 steps, total: 33.594, sample: 0.726, forward: 1.546, backward: 1.122, update: 0.576
[proc 2] 100 steps, total: 33.595, sample: 0.849, forward: 1.590, backward: 1.020, update: 0.570
[proc 4] 100 steps, total: 33.562, sample: 0.808, forward: 1.734, backward: 1.042, update: 0.587
[proc 1] 100 steps, total: 33.604, sample: 0.789, forward: 1.532, backward: 0.967, update: 0.545
-------Step 0-------
tensor([ 2483,     6,  3503,   125, 10591, 13813,  1807,  6934, 13962, 10089]) tensor([ 2815,  8275,  5490, 13049, 10252,  1725,  6455,  6367,   945,  1332])
-------Step 1-------
tensor([ 2483,     6,  3503,   125, 10591, 13813,  1807,  6934, 13962, 10089]) tensor([11809, 12821, 11756, 13396,  1156,  2685,  6485,  1028,  3191, 11820])
-------Step 2-------
tensor([ 3737,  6519,  6006, 13595,  8234, 13532,  8422,   108,  4505,  3078]) tensor([ 7379,  6905,  4478,  6766,  2987, 14453,   318,  2244, 13179,  4419])
-------Step 3-------
tensor([ 3737,  6519,  6006, 13595,  8234, 13532,  8422,   108,  4505,  3078]) tensor([11415,   398, 10473, 14912,  8456,  9113, 10739,   843,  4642,  4871])
-------Step 4-------
tensor([10839,    32,   157,  4179,  6607, 13633,    24, 10087,  5012,   171]) tensor([ 3868, 12092, 14691,  2115,  1777,  9187,   606, 11835,  5052, 11611])
-------Step 5-------
tensor([10839,    32,   157,  4179,  6607, 13633,    24, 10087,  5012,   171]) tensor([ 5195,  5415,  2749, 14020,  9710,  9929, 13751,  7033,  3013,  8275])
-------Step 6-------
tensor([ 2198,  4283, 14477,  3730,   129,  7550,  7828,  1864, 12839,  1096]) tensor([10704,  3925, 13919,  9637,  1126, 12147, 14582, 11835, 13631, 11367])
-------Step 7-------
tensor([ 2198,  4283, 14477,  3730,   129,  7550,  7828,  1864, 12839,  1096]) tensor([ 3857,  9960,  5550, 14806,  7994,    90,  6549,  1625,  2858,  3664])
-------Step 8-------
tensor([ 2248,  7791, 10237, 14472,  5012,  3063, 10318,  4589,  2959,  6205]) tensor([  292,   337, 14272, 14279,  6440,  4886, 14030,   758,    91,  5696])
-------Step 9-------
tensor([ 2248,  7791, 10237, 14472,  5012,  3063, 10318,  4589,  2959,  6205]) tensor([  114, 11654, 14382, 12959,  5336,  8452,  1210, 11631,  5718,  8903])
[proc 0] 100 steps, total: 33.588, sample: 1.016, forward: 1.775, backward: 0.977, update: 0.635
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.045 ms                 | 17.911 ms                 |
| ProcessBack:UpdateCache   | 9.962 ms                  | 16.549 ms                 |
| ProcessBack:UpsertPq      | 36.786 ms                 | 64.804 ms                 |
| ProcessOneStep            | 66.005 ms                 | 247.302 ms                |
| BlockToStepN              | 174.438 ms                | 411.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:50.946569  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:50:51.038440  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=102, pq.top=97
E20240118 23:50:51.301018  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2666
W20240118 23:50:52.038247  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=102
W20240118 23:50:52.110153  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:50:52.301044  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=980
W20240118 23:50:53.118393  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=106
W20240118 23:50:53.118451  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:50:53.301021  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1593
W20240118 23:50:54.118108  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=108
W20240118 23:50:54.261719  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:50:54.301008  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=5230
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.810 ms                  | 62.794 ms                 |
| Forward                   | 8.749 ms                  | 41.358 ms                 |
| Backward                  | 6.682 ms                  | 13.673 ms                 |
| Optimize                  | 5.916 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.242 ms                  | 66.694 ms                 |
| AfterBackward             | 66.061 ms                 | 247.442 ms                |
| BlockToStepN              | 191.096 ms                | 442.354 ms                |
| OneStep                   | 315.414 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:55.118197  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=112, pq.top=105
W20240118 23:50:55.286293  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:50:55.301014  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3689
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.976 ms                 | 17.911 ms                 |
| ProcessBack:UpdateCache   | 9.850 ms                  | 16.549 ms                 |
| ProcessBack:UpsertPq      | 33.952 ms                 | 64.804 ms                 |
| ProcessOneStep            | 66.005 ms                 | 247.302 ms                |
| BlockToStepN              | 191.937 ms                | 442.221 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:50:56.205917  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=115, pq.top=113
E20240118 23:50:56.301012  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=856
W20240118 23:50:56.536237  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:50:57.205086  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=115
E20240118 23:50:57.301563  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1732
W20240118 23:50:57.669286  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:50:58.205034  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=116
E20240118 23:50:58.303136  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1196
W20240118 23:50:58.670156  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:50:59.205168  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=122, pq.top=120
E20240118 23:50:59.303032  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1660
W20240118 23:50:59.809700  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.743 ms                  | 62.794 ms                 |
| Forward                   | 8.718 ms                  | 41.358 ms                 |
| Backward                  | 6.664 ms                  | 13.673 ms                 |
| Optimize                  | 5.921 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.395 ms                  | 66.694 ms                 |
| AfterBackward             | 65.707 ms                 | 247.442 ms                |
| BlockToStepN              | 205.445 ms                | 452.749 ms                |
| OneStep                   | 320.968 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:00.205065  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=123
E20240118 23:51:00.303790  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.118 ms                 | 17.214 ms                 |
| ProcessBack:UpdateCache   | 9.738 ms                  | 15.892 ms                 |
| ProcessBack:UpsertPq      | 29.696 ms                 | 64.784 ms                 |
| ProcessOneStep            | 65.655 ms                 | 247.302 ms                |
| BlockToStepN              | 205.314 ms                | 452.555 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:00.879437  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:51:01.205128  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=125
E20240118 23:51:01.303009  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3612
W20240118 23:51:02.153017  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:51:02.232142  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=128
E20240118 23:51:02.303020  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=972
W20240118 23:51:03.232177  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=132, pq.top=130
E20240118 23:51:03.310277  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2232
W20240118 23:51:03.341699  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:51:04.310048  8032 parallel_pq_v2.h:76] insert failed, size(hashtable)=3702
W20240118 23:51:04.311671  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=132
W20240118 23:51:04.354385  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.741 ms                  | 62.794 ms                 |
| Forward                   | 8.664 ms                  | 41.358 ms                 |
| Backward                  | 6.606 ms                  | 13.673 ms                 |
| Optimize                  | 5.942 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 4.431 ms                  | 66.694 ms                 |
| AfterBackward             | 65.372 ms                 | 247.442 ms                |
| BlockToStepN              | 213.034 ms                | 452.749 ms                |
| OneStep                   | 335.631 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:05.310097  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1615
W20240118 23:51:05.311111  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=136
W20240118 23:51:05.475178  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.118 ms                 | 17.214 ms                 |
| ProcessBack:UpdateCache   | 9.435 ms                  | 15.892 ms                 |
| ProcessBack:UpsertPq      | 29.628 ms                 | 64.784 ms                 |
| ProcessOneStep            | 65.294 ms                 | 247.302 ms                |
| BlockToStepN              | 220.221 ms                | 452.555 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:06.310025  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=221
W20240118 23:51:06.344308  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=138
W20240118 23:51:06.628865  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:51:07.310012  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1423
W20240118 23:51:07.344131  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=142, pq.top=139
W20240118 23:51:07.826823  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:51:08.314116  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=276
W20240118 23:51:08.344059  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=142
W20240118 23:51:08.930388  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:51:09.314010  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4053
W20240118 23:51:09.377382  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=148, pq.top=147
W20240118 23:51:10.065834  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.699 ms                  | 62.794 ms                 |
| Forward                   | 8.631 ms                  | 41.358 ms                 |
| Backward                  | 6.581 ms                  | 13.673 ms                 |
| Optimize                  | 5.942 ms                  | 11.078 ms                 |
| BarrierTimeBeforeRank0    | 5.059 ms                  | 66.694 ms                 |
| AfterBackward             | 65.007 ms                 | 247.442 ms                |
| BlockToStepN              | 229.507 ms                | 452.749 ms                |
| OneStep                   | 339.545 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:10.318821  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1199
W20240118 23:51:10.377063  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=150, pq.top=148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.078 ms                 | 17.214 ms                 |
| ProcessBack:UpdateCache   | 9.070 ms                  | 15.892 ms                 |
| ProcessBack:UpsertPq      | 29.309 ms                 | 64.784 ms                 |
| ProcessOneStep            | 64.925 ms                 | 91.185 ms                 |
| BlockToStepN              | 229.386 ms                | 452.555 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:11.255900  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:51:11.318015  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=1293
W20240118 23:51:11.377269  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=151
W20240118 23:51:12.270231  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:51:12.319697  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=262
W20240118 23:51:12.377169  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=150
W20240118 23:51:13.295053  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:51:13.319011  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4107
W20240118 23:51:13.399618  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=158, pq.top=157
W20240118 23:51:14.305426  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:51:14.319003  8032 parallel_pq_v2.h:76] insert failed, size(hashtable)=3626
W20240118 23:51:14.399331  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.669 ms                  | 58.848 ms                 |
| Forward                   | 8.525 ms                  | 32.173 ms                 |
| Backward                  | 6.570 ms                  | 10.390 ms                 |
| Optimize                  | 5.921 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.453 ms                  | 65.612 ms                 |
| AfterBackward             | 64.660 ms                 | 91.218 ms                 |
| BlockToStepN              | 249.989 ms                | 442.354 ms                |
| OneStep                   | 350.316 ms                | 539.179 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:15.328922  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1825
W20240118 23:51:15.399245  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=160
W20240118 23:51:15.466312  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.078 ms                 | 17.214 ms                 |
| ProcessBack:UpdateCache   | 8.943 ms                  | 15.892 ms                 |
| ProcessBack:UpsertPq      | 29.309 ms                 | 64.784 ms                 |
| ProcessOneStep            | 64.484 ms                 | 91.185 ms                 |
| BlockToStepN              | 249.820 ms                | 442.221 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:16.328326  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=194
W20240118 23:51:16.399123  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=162
W20240118 23:51:16.645058  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:51:17.328033  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1519
W20240118 23:51:17.399391  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=167, pq.top=164
W20240118 23:51:17.908629  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:51:18.328037  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1984
W20240118 23:51:18.399199  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240118 23:51:18.914929  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:51:19.328007  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=1166
W20240118 23:51:19.399118  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=172, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.699 ms                  | 58.848 ms                 |
| Forward                   | 8.541 ms                  | 32.173 ms                 |
| Backward                  | 6.549 ms                  | 10.390 ms                 |
| Optimize                  | 5.918 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.453 ms                  | 65.612 ms                 |
| AfterBackward             | 64.122 ms                 | 91.218 ms                 |
| BlockToStepN              | 252.083 ms                | 442.354 ms                |
| OneStep                   | 361.342 ms                | 539.179 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:20.263291  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:51:20.328033  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=6051
W20240118 23:51:20.399327  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=174, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.048 ms                 | 17.214 ms                 |
| ProcessBack:UpdateCache   | 8.824 ms                  | 15.892 ms                 |
| ProcessBack:UpsertPq      | 29.309 ms                 | 64.784 ms                 |
| ProcessOneStep            | 63.983 ms                 | 91.185 ms                 |
| BlockToStepN              | 253.195 ms                | 442.221 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:21.282130  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:51:21.328094  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=796
W20240118 23:51:21.399169  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=176, pq.top=175
W20240118 23:51:22.303426  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:51:22.328012  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=1206
W20240118 23:51:22.399214  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=178
E20240118 23:51:23.328071  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1463
W20240118 23:51:23.399437  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=180
W20240118 23:51:23.577142  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:51:24.328007  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3372
W20240118 23:51:24.417819  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=181
W20240118 23:51:24.608460  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.699 ms                  | 58.848 ms                 |
| Forward                   | 8.509 ms                  | 32.173 ms                 |
| Backward                  | 6.547 ms                  | 10.390 ms                 |
| Optimize                  | 5.903 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.316 ms                  | 65.612 ms                 |
| AfterBackward             | 63.712 ms                 | 91.218 ms                 |
| BlockToStepN              | 255.210 ms                | 442.354 ms                |
| OneStep                   | 363.222 ms                | 562.914 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:25.329804  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1380
W20240118 23:51:25.417251  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=186, pq.top=184
W20240118 23:51:25.625227  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.048 ms                 | 16.047 ms                 |
| ProcessBack:UpdateCache   | 8.752 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 29.309 ms                 | 62.961 ms                 |
| ProcessOneStep            | 63.153 ms                 | 91.185 ms                 |
| BlockToStepN              | 255.980 ms                | 442.221 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:26.329155  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=700
W20240118 23:51:26.417470  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=187
W20240118 23:51:26.644448  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:51:27.329027  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1891
W20240118 23:51:27.493834  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=190
W20240118 23:51:27.789673  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:51:28.329007  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=3435
W20240118 23:51:28.493117  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=192
W20240118 23:51:28.821333  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:51:29.329556  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=2012
W20240118 23:51:29.512173  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=196
W20240118 23:51:29.908684  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.649 ms                  | 58.848 ms                 |
| Forward                   | 8.491 ms                  | 32.173 ms                 |
| Backward                  | 6.545 ms                  | 10.390 ms                 |
| Optimize                  | 5.916 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.491 ms                  | 70.155 ms                 |
| AfterBackward             | 58.610 ms                 | 91.218 ms                 |
| BlockToStepN              | 258.722 ms                | 442.354 ms                |
| OneStep                   | 366.672 ms                | 562.914 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:30.329021  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=972
W20240118 23:51:30.512145  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=194
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.740 ms                 | 16.047 ms                 |
| ProcessBack:UpdateCache   | 8.752 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 28.549 ms                 | 62.961 ms                 |
| ProcessOneStep            | 57.575 ms                 | 91.185 ms                 |
| BlockToStepN              | 261.340 ms                | 452.555 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:30.921309  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 5] 200 steps, total: 40.550, sample: 0.779, forward: 0.838, backward: 0.770, update: 0.570
[proc 1] 200 steps, total: 40.549, sample: 0.708, forward: 0.842, backward: 0.717, update: 0.592
[proc 7] 200 steps, total: 40.550, sample: 0.678, forward: 0.748, backward: 0.696, update: 0.504
[proc 4] 200 steps, total: 40.550, sample: 0.777, forward: 0.835, backward: 0.782, update: 0.626
[proc 3] 200 steps, total: 40.550, sample: 0.694, forward: 0.812, backward: 0.670, update: 0.577
[proc 6] 200 steps, total: 40.550, sample: 0.624, forward: 0.795, backward: 0.693, update: 0.526
[proc 2] 200 steps, total: 40.550, sample: 0.682, forward: 0.764, backward: 0.664, update: 0.528
[proc 0] 200 steps, total: 40.549, sample: 0.807, forward: 0.829, backward: 0.626, update: 0.576
E20240118 23:51:31.338884  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1487
W20240118 23:51:31.588730  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=202, pq.top=200
W20240118 23:51:31.961884  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:51:32.338150  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=5914
W20240118 23:51:32.588443  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=204, pq.top=203
W20240118 23:51:32.968192  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:51:33.338044  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=70
W20240118 23:51:33.588387  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=206, pq.top=204
W20240118 23:51:33.981431  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:51:34.339933  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=166
W20240118 23:51:34.639091  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=209, pq.top=206
W20240118 23:51:35.039094  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.642 ms                  | 58.848 ms                 |
| Forward                   | 8.491 ms                  | 32.173 ms                 |
| Backward                  | 6.512 ms                  | 10.390 ms                 |
| Optimize                  | 5.903 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.567 ms                  | 70.155 ms                 |
| AfterBackward             | 56.728 ms                 | 91.218 ms                 |
| BlockToStepN              | 262.510 ms                | 490.978 ms                |
| OneStep                   | 372.165 ms                | 693.826 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:35.340034  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=193
W20240118 23:51:35.639354  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.543 ms                 | 16.047 ms                 |
| ProcessBack:UpdateCache   | 8.788 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 28.165 ms                 | 62.961 ms                 |
| ProcessOneStep            | 56.536 ms                 | 91.185 ms                 |
| BlockToStepN              | 262.382 ms                | 490.810 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:36.049281  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:51:36.340198  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=91
W20240118 23:51:36.639014  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=211
W20240118 23:51:37.049535  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240118 23:51:37.340056  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=7238
W20240118 23:51:37.774302  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=214
W20240118 23:51:38.083271  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:51:38.341696  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=107
W20240118 23:51:38.787284  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=216
W20240118 23:51:39.243078  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
E20240118 23:51:39.341010  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=4459
W20240118 23:51:39.787263  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.627 ms                  | 58.848 ms                 |
| Forward                   | 8.441 ms                  | 32.173 ms                 |
| Backward                  | 6.494 ms                  | 10.390 ms                 |
| Optimize                  | 5.917 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.640 ms                  | 70.155 ms                 |
| AfterBackward             | 55.944 ms                 | 91.218 ms                 |
| BlockToStepN              | 261.686 ms                | 588.700 ms                |
| OneStep                   | 369.553 ms                | 819.809 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:40.341058  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240118 23:51:40.362622  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
W20240118 23:51:40.787339  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.492 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.771 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.197 ms                 | 62.245 ms                 |
| ProcessOneStep            | 55.894 ms                 | 91.185 ms                 |
| BlockToStepN              | 261.573 ms                | 588.548 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:41.343025  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1497
W20240118 23:51:41.787077  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
E20240118 23:51:42.368424  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2157
W20240118 23:51:42.787109  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
E20240118 23:51:43.373745  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3044
W20240118 23:51:43.787068  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
E20240118 23:51:44.377135  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3876
W20240118 23:51:44.787125  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.627 ms                  | 58.848 ms                 |
| Forward                   | 8.441 ms                  | 32.173 ms                 |
| Backward                  | 6.494 ms                  | 10.390 ms                 |
| Optimize                  | 5.917 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.640 ms                  | 70.155 ms                 |
| AfterBackward             | 55.944 ms                 | 91.218 ms                 |
| BlockToStepN              | 261.686 ms                | 588.700 ms                |
| OneStep                   | 369.553 ms                | 819.809 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:45.107517  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:51:45.379899  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=472
W20240118 23:51:45.787250  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.492 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.771 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.239 ms                 | 62.245 ms                 |
| ProcessOneStep            | 56.047 ms                 | 91.185 ms                 |
| BlockToStepN              | 261.573 ms                | 701.110 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:46.381369  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2003
W20240118 23:51:46.787490  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=225
E20240118 23:51:47.381505  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3715
W20240118 23:51:47.787025  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=225
E20240118 23:51:48.404373  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=5340
W20240118 23:51:48.787053  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=225
W20240118 23:51:49.280558  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:51:49.404011  8032 parallel_pq_v2.h:76] insert failed, size(hashtable)=281
W20240118 23:51:49.859295  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=229, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.637 ms                  | 58.848 ms                 |
| Forward                   | 8.456 ms                  | 32.173 ms                 |
| Backward                  | 6.495 ms                  | 10.390 ms                 |
| Optimize                  | 5.917 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 5.682 ms                  | 70.155 ms                 |
| AfterBackward             | 56.338 ms                 | 91.218 ms                 |
| BlockToStepN              | 262.271 ms                | 3.203 s                   |
| OneStep                   | 370.910 ms                | 3.282 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:50.282451  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:51:50.404022  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2879
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.543 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.788 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.481 ms                 | 62.245 ms                 |
| ProcessOneStep            | 56.679 ms                 | 91.185 ms                 |
| BlockToStepN              | 261.340 ms                | 3.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:50.859213  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=231
W20240118 23:51:51.321210  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240118 23:51:51.404016  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1593
W20240118 23:51:51.928895  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=239
E20240118 23:51:52.404008  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=1097
W20240118 23:51:52.405504  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
W20240118 23:51:52.928269  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=241
E20240118 23:51:53.405086  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4224
W20240118 23:51:53.410734  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:51:53.942150  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=246, pq.top=244
E20240118 23:51:54.405535  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2007
W20240118 23:51:54.676394  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:51:54.958973  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.611 ms                  | 58.848 ms                 |
| Forward                   | 8.435 ms                  | 32.173 ms                 |
| Backward                  | 6.488 ms                  | 10.390 ms                 |
| Optimize                  | 5.917 ms                  | 10.879 ms                 |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 70.155 ms                 |
| AfterBackward             | 57.620 ms                 | 100.553 ms                |
| BlockToStepN              | 256.780 ms                | 3.203 s                   |
| OneStep                   | 363.222 ms                | 3.282 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:51:55.405033  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=718
W20240118 23:51:55.689568  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.665 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.882 ms                  | 15.856 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.961 ms                 |
| ProcessOneStep            | 57.818 ms                 | 91.185 ms                 |
| BlockToStepN              | 255.062 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:51:55.986680  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=252
E20240118 23:51:56.405012  8032 parallel_pq_v2.h:76] insert failed, size(hashtable)=2794
W20240118 23:51:56.696256  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:51:57.017693  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=256
E20240118 23:51:57.406052  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=762
W20240118 23:51:57.736662  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:51:58.076342  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=262
E20240118 23:51:58.406517  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3209
W20240118 23:51:58.891001  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:51:59.076512  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=268, pq.top=265
E20240118 23:51:59.406008  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=325
W20240118 23:51:59.897842  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.578 ms                  | 57.901 ms                 |
| Forward                   | 8.402 ms                  | 21.623 ms                 |
| Backward                  | 6.480 ms                  | 9.893 ms                  |
| Optimize                  | 5.922 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.682 ms                  | 66.694 ms                 |
| AfterBackward             | 56.932 ms                 | 91.218 ms                 |
| BlockToStepN              | 249.786 ms                | 1.341 s                   |
| OneStep                   | 349.472 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:00.076367  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=268
E20240118 23:52:00.406013  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2345
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.688 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.866 ms                  | 15.856 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.961 ms                 |
| ProcessOneStep            | 56.762 ms                 | 91.185 ms                 |
| BlockToStepN              | 246.203 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:00.939695  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:52:01.076732  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=274
E20240118 23:52:01.406016  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1804
W20240118 23:52:02.076643  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=277
W20240118 23:52:02.083381  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:52:02.406008  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=821
W20240118 23:52:03.076385  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=281
W20240118 23:52:03.283463  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:52:03.406885  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=796
W20240118 23:52:04.076301  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=284
W20240118 23:52:04.283334  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:52:04.406016  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=910
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.569 ms                  | 58.810 ms                 |
| Forward                   | 8.376 ms                  | 21.623 ms                 |
| Backward                  | 6.465 ms                  | 9.893 ms                  |
| Optimize                  | 5.891 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.874 ms                  | 66.694 ms                 |
| AfterBackward             | 56.098 ms                 | 91.218 ms                 |
| BlockToStepN              | 231.976 ms                | 1.341 s                   |
| OneStep                   | 339.545 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:05.076431  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=287
W20240118 23:52:05.298539  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:52:05.407532  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.714 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.799 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.808 ms                 |
| ProcessOneStep            | 55.991 ms                 | 91.185 ms                 |
| BlockToStepN              | 231.865 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:06.076519  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=290
W20240118 23:52:06.308773  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:52:06.410074  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1595
W20240118 23:52:07.076601  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=293
W20240118 23:52:07.311908  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:52:07.410022  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1516
W20240118 23:52:08.076566  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=298, pq.top=296
W20240118 23:52:08.314942  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:52:08.410009  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1222
[proc 7] 300 steps, total: 37.687, sample: 0.848, forward: 0.841, backward: 0.726, update: 0.586
[proc 3] 300 steps, total: 37.687, sample: 0.906, forward: 0.849, backward: 0.696, update: 0.570
[proc 1] 300 steps, total: 37.687, sample: 0.794, forward: 0.835, backward: 0.749, update: 0.568
[proc 2] 300 steps, total: 37.687, sample: 0.763, forward: 0.767, backward: 0.766, update: 0.537
[proc 6] 300 steps, total: 37.687, sample: 0.798, forward: 0.820, backward: 0.708, update: 0.565
[proc 5] 300 steps, total: 37.687, sample: 0.824, forward: 0.839, backward: 0.702, update: 0.586
[proc 4] 300 steps, total: 37.687, sample: 0.770, forward: 0.790, backward: 0.728, update: 0.619
[proc 0] 300 steps, total: 37.687, sample: 0.928, forward: 0.805, backward: 0.611, update: 0.555
W20240118 23:52:09.076413  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=297
E20240118 23:52:09.415117  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1373
W20240118 23:52:09.465992  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.543 ms                  | 58.810 ms                 |
| Forward                   | 8.402 ms                  | 21.623 ms                 |
| Backward                  | 6.460 ms                  | 9.893 ms                  |
| Optimize                  | 5.891 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.874 ms                  | 66.694 ms                 |
| AfterBackward             | 55.771 ms                 | 91.218 ms                 |
| BlockToStepN              | 231.423 ms                | 1.341 s                   |
| OneStep                   | 339.545 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:10.076053  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=304, pq.top=302
E20240118 23:52:10.415016  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1947
W20240118 23:52:10.482110  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.740 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.712 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.808 ms                 |
| ProcessOneStep            | 55.466 ms                 | 91.185 ms                 |
| BlockToStepN              | 231.293 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:11.076241  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=305
E20240118 23:52:11.416138  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2498
W20240118 23:52:11.484267  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:52:12.076336  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=310, pq.top=308
E20240118 23:52:12.416076  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1949
W20240118 23:52:12.500447  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:52:13.076254  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=309
E20240118 23:52:13.417438  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1480
W20240118 23:52:13.503931  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:52:14.076180  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=316, pq.top=314
E20240118 23:52:14.417107  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=681
W20240118 23:52:14.510648  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.543 ms                  | 58.810 ms                 |
| Forward                   | 8.412 ms                  | 21.623 ms                 |
| Backward                  | 6.463 ms                  | 9.893 ms                  |
| Optimize                  | 5.890 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.874 ms                  | 66.694 ms                 |
| AfterBackward             | 55.420 ms                 | 91.218 ms                 |
| BlockToStepN              | 235.699 ms                | 1.341 s                   |
| OneStep                   | 339.545 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:15.076732  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=316
E20240118 23:52:15.417063  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1968
W20240118 23:52:15.532625  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.944 ms                 |
| ProcessBack:UpdateCache   | 8.650 ms                  | 13.661 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.808 ms                 |
| ProcessOneStep            | 55.343 ms                 | 91.185 ms                 |
| BlockToStepN              | 235.687 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:16.076241  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=319
E20240118 23:52:16.417030  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1286
W20240118 23:52:16.534432  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:52:17.076277  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=324, pq.top=320
E20240118 23:52:17.418004  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1137
W20240118 23:52:17.679601  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:52:18.201953  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=321
E20240118 23:52:18.419853  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1786
W20240118 23:52:18.681234  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:52:19.201128  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=324
E20240118 23:52:19.419730  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=891
W20240118 23:52:19.682302  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.532 ms                  | 58.810 ms                 |
| Forward                   | 8.435 ms                  | 21.623 ms                 |
| Backward                  | 6.465 ms                  | 9.893 ms                  |
| Optimize                  | 5.891 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.872 ms                  | 66.694 ms                 |
| AfterBackward             | 55.368 ms                 | 91.218 ms                 |
| BlockToStepN              | 244.086 ms                | 1.341 s                   |
| OneStep                   | 340.875 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:20.201828  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=330
E20240118 23:52:20.419777  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=616
W20240118 23:52:20.789021  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.617 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.245 ms                 |
| ProcessOneStep            | 55.292 ms                 | 91.185 ms                 |
| BlockToStepN              | 243.934 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:21.201426  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=332
E20240118 23:52:21.419718  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2096
W20240118 23:52:21.829507  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:52:22.201865  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=335
E20240118 23:52:22.419205  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=842
W20240118 23:52:23.102872  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:52:23.204808  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=336
E20240118 23:52:23.422408  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1939
W20240118 23:52:24.204527  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=342, pq.top=340
W20240118 23:52:24.215144  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:52:24.425305  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=980
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.532 ms                  | 58.810 ms                 |
| Forward                   | 8.435 ms                  | 21.623 ms                 |
| Backward                  | 6.482 ms                  | 9.893 ms                  |
| Optimize                  | 5.903 ms                  | 10.809 ms                 |
| BarrierTimeBeforeRank0    | 5.872 ms                  | 66.694 ms                 |
| AfterBackward             | 55.203 ms                 | 91.218 ms                 |
| BlockToStepN              | 245.490 ms                | 1.341 s                   |
| OneStep                   | 342.380 ms                | 2.409 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:25.204743  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=342
E20240118 23:52:25.432929  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2394
W20240118 23:52:25.442919  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.592 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.677 ms                 | 62.245 ms                 |
| ProcessOneStep            | 55.132 ms                 | 91.185 ms                 |
| BlockToStepN              | 245.383 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:26.221832  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=348, pq.top=347
E20240118 23:52:26.432363  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1675
W20240118 23:52:26.530767  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:52:27.221119  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=350, pq.top=348
E20240118 23:52:27.432008  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=278
W20240118 23:52:27.717808  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:52:28.221637  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=351
E20240118 23:52:28.432410  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1844
W20240118 23:52:28.742396  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:52:29.221171  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=352
E20240118 23:52:29.433671  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4557
W20240118 23:52:29.765872  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.533 ms                  | 57.901 ms                 |
| Forward                   | 8.402 ms                  | 18.907 ms                 |
| Backward                  | 6.479 ms                  | 9.375 ms                  |
| Optimize                  | 5.885 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 5.551 ms                  | 65.612 ms                 |
| AfterBackward             | 55.158 ms                 | 90.710 ms                 |
| BlockToStepN              | 249.732 ms                | 733.940 ms                |
| OneStep                   | 349.190 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:30.249593  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=358, pq.top=354
E20240118 23:52:30.433020  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1504
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.551 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.245 ms                 |
| ProcessOneStep            | 55.067 ms                 | 90.666 ms                 |
| BlockToStepN              | 249.616 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:30.902647  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:52:31.312387  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=357
E20240118 23:52:31.439189  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1554
W20240118 23:52:31.941190  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:52:32.312120  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=362
E20240118 23:52:32.439010  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=1216
W20240118 23:52:33.162086  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:52:33.312899  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=364
E20240118 23:52:33.439494  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1851
W20240118 23:52:34.214186  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:52:34.351701  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=369, pq.top=368
E20240118 23:52:34.448952  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=910
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.527 ms                  | 57.901 ms                 |
| Forward                   | 8.376 ms                  | 18.907 ms                 |
| Backward                  | 6.479 ms                  | 9.375 ms                  |
| Optimize                  | 5.878 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 5.567 ms                  | 65.612 ms                 |
| AfterBackward             | 54.995 ms                 | 90.710 ms                 |
| BlockToStepN              | 249.989 ms                | 733.940 ms                |
| OneStep                   | 349.472 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:35.351732  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=367
E20240118 23:52:35.452369  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1884
W20240118 23:52:35.558395  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.366 ms                 |
| ProcessBack:UpdateCache   | 8.551 ms                  | 13.597 ms                 |
| ProcessBack:UpsertPq      | 28.672 ms                 | 62.245 ms                 |
| ProcessOneStep            | 54.924 ms                 | 90.666 ms                 |
| BlockToStepN              | 250.541 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:36.426517  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=374, pq.top=372
E20240118 23:52:36.452085  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=675
W20240118 23:52:36.692943  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:52:37.426476  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=374
E20240118 23:52:37.452083  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1866
W20240118 23:52:37.917181  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:52:38.426312  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=377
E20240118 23:52:38.452169  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=505
W20240118 23:52:38.923143  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:52:39.426930  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=378
E20240118 23:52:39.464211  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1421
W20240118 23:52:40.007704  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.518 ms                  | 57.901 ms                 |
| Forward                   | 8.364 ms                  | 18.907 ms                 |
| Backward                  | 6.476 ms                  | 9.375 ms                  |
| Optimize                  | 5.853 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 5.872 ms                  | 65.612 ms                 |
| AfterBackward             | 54.619 ms                 | 90.710 ms                 |
| BlockToStepN              | 251.253 ms                | 733.940 ms                |
| OneStep                   | 350.316 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:40.426179  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=381
E20240118 23:52:40.464025  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3945
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.497 ms                  | 13.228 ms                 |
| ProcessBack:UpsertPq      | 28.605 ms                 | 60.525 ms                 |
| ProcessOneStep            | 54.546 ms                 | 90.666 ms                 |
| BlockToStepN              | 251.117 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:41.209169  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:52:41.426470  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=386, pq.top=385
E20240118 23:52:41.464015  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1184
W20240118 23:52:42.305667  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:52:42.426494  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=386
E20240118 23:52:42.470037  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
W20240118 23:52:43.306903  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:52:43.426134  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=390
E20240118 23:52:43.470021  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=986
W20240118 23:52:44.426265  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=392
W20240118 23:52:44.440963  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:52:44.471866  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4590
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.510 ms                  | 57.901 ms                 |
| Forward                   | 8.334 ms                  | 18.907 ms                 |
| Backward                  | 6.463 ms                  | 9.375 ms                  |
| Optimize                  | 5.831 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 6.269 ms                  | 65.612 ms                 |
| AfterBackward             | 54.448 ms                 | 90.710 ms                 |
| BlockToStepN              | 252.413 ms                | 733.940 ms                |
| OneStep                   | 351.071 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:45.426335  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=396, pq.top=393
W20240118 23:52:45.456768  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:52:45.476616  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=672
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.447 ms                  | 13.228 ms                 |
| ProcessBack:UpsertPq      | 28.605 ms                 | 60.525 ms                 |
| ProcessOneStep            | 54.367 ms                 | 90.666 ms                 |
| BlockToStepN              | 252.497 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:46.426970  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=398, pq.top=397
E20240118 23:52:46.476068  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1996
W20240118 23:52:46.492575  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
[proc 3] 400 steps, total: 38.568, sample: 0.722, forward: 0.787, backward: 0.729, update: 0.516
[proc 0] 400 steps, total: 38.568, sample: 0.806, forward: 0.802, backward: 0.634, update: 0.527
[proc 2] 400 steps, total: 38.568, sample: 0.619, forward: 0.788, backward: 0.700, update: 0.567
[proc 7] 400 steps, total: 38.568, sample: 0.789, forward: 0.830, backward: 0.724, update: 0.572
[proc 6] 400 steps, total: 38.568, sample: 0.779, forward: 0.826, backward: 0.693, update: 0.564
[proc 5] 400 steps, total: 38.568, sample: 0.832, forward: 0.837, backward: 0.786, update: 0.563
[proc 4] 400 steps, total: 38.568, sample: 0.799, forward: 0.808, backward: 0.766, update: 0.652
[proc 1] 400 steps, total: 38.568, sample: 0.687, forward: 0.848, backward: 0.703, update: 0.571
W20240118 23:52:47.453333  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=399
E20240118 23:52:47.477449  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240118 23:52:47.511915  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:52:48.453900  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=402
E20240118 23:52:48.488781  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1125
W20240118 23:52:48.670508  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:52:49.453150  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=403
E20240118 23:52:49.488060  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1908
W20240118 23:52:49.689980  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.503 ms                  | 57.901 ms                 |
| Forward                   | 8.314 ms                  | 18.907 ms                 |
| Backward                  | 6.458 ms                  | 9.375 ms                  |
| Optimize                  | 5.810 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 6.413 ms                  | 65.612 ms                 |
| AfterBackward             | 54.310 ms                 | 90.710 ms                 |
| BlockToStepN              | 254.580 ms                | 733.940 ms                |
| OneStep                   | 357.587 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:50.453089  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=400
E20240118 23:52:50.489713  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1641
W20240118 23:52:50.701026  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.424 ms                  | 13.228 ms                 |
| ProcessBack:UpsertPq      | 28.582 ms                 | 60.525 ms                 |
| ProcessOneStep            | 54.247 ms                 | 90.666 ms                 |
| BlockToStepN              | 255.062 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:51.453347  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=409, pq.top=407
E20240118 23:52:51.489051  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3485
W20240118 23:52:51.845311  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:52:52.453601  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=412, pq.top=410
E20240118 23:52:52.490576  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
W20240118 23:52:52.849674  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:52:53.453310  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=411
E20240118 23:52:53.493288  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1888
W20240118 23:52:53.943436  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:52:54.453754  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=415
E20240118 23:52:54.503422  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=773
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.495 ms                  | 57.901 ms                 |
| Forward                   | 8.304 ms                  | 18.907 ms                 |
| Backward                  | 6.458 ms                  | 9.375 ms                  |
| Optimize                  | 5.786 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 6.469 ms                  | 65.612 ms                 |
| AfterBackward             | 54.161 ms                 | 90.710 ms                 |
| BlockToStepN              | 257.070 ms                | 733.940 ms                |
| OneStep                   | 360.015 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:55.191998  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:52:55.453061  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=418
E20240118 23:52:55.505236  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1322
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.380 ms                  | 13.228 ms                 |
| ProcessBack:UpsertPq      | 28.565 ms                 | 60.525 ms                 |
| ProcessOneStep            | 54.076 ms                 | 90.666 ms                 |
| BlockToStepN              | 256.918 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:52:56.453646  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=420
W20240118 23:52:56.478072  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:52:56.506152  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4753
W20240118 23:52:57.453346  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=423
E20240118 23:52:57.509781  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1559
W20240118 23:52:57.589552  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:52:58.479295  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=423
E20240118 23:52:58.510221  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240118 23:52:58.926328  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:52:59.479306  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=421
E20240118 23:52:59.510285  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=825
W20240118 23:52:59.931704  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.490 ms                  | 57.901 ms                 |
| Forward                   | 8.278 ms                  | 18.907 ms                 |
| Backward                  | 6.455 ms                  | 9.375 ms                  |
| Optimize                  | 5.771 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 6.653 ms                  | 65.612 ms                 |
| AfterBackward             | 54.076 ms                 | 90.710 ms                 |
| BlockToStepN              | 257.590 ms                | 733.940 ms                |
| OneStep                   | 362.752 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:00.479707  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=427
E20240118 23:53:00.528918  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=775
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.183 ms                 |
| ProcessBack:UpdateCache   | 8.322 ms                  | 13.095 ms                 |
| ProcessBack:UpsertPq      | 28.549 ms                 | 59.732 ms                 |
| ProcessOneStep            | 54.018 ms                 | 90.666 ms                 |
| BlockToStepN              | 258.602 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:01.087308  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:53:01.528012  7609 parallel_pq_v2.h:76] insert failed, size(hashtable)=682
W20240118 23:53:01.561210  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=434, pq.top=432
W20240118 23:53:02.283797  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:53:02.536255  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1158
W20240118 23:53:02.561960  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=436, pq.top=434
W20240118 23:53:03.283802  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:53:03.551532  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1920
W20240118 23:53:03.561815  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=437
W20240118 23:53:04.386612  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:53:04.551890  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=696
W20240118 23:53:04.561789  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=438
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.487 ms                  | 57.901 ms                 |
| Forward                   | 8.252 ms                  | 18.907 ms                 |
| Backward                  | 6.447 ms                  | 9.375 ms                  |
| Optimize                  | 5.752 ms                  | 10.773 ms                 |
| BarrierTimeBeforeRank0    | 7.051 ms                  | 65.612 ms                 |
| AfterBackward             | 54.001 ms                 | 90.710 ms                 |
| BlockToStepN              | 260.656 ms                | 733.940 ms                |
| OneStep                   | 364.220 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
E20240118 23:53:05.552719  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1733
W20240118 23:53:05.562167  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=442
W20240118 23:53:05.668660  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.746 ms                 | 15.183 ms                 |
| ProcessBack:UpdateCache   | 8.301 ms                  | 13.095 ms                 |
| ProcessBack:UpsertPq      | 28.547 ms                 | 59.732 ms                 |
| ProcessOneStep            | 53.936 ms                 | 90.666 ms                 |
| BlockToStepN              | 260.537 ms                | 733.779 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:53:06.552949  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1184
W20240118 23:53:06.562901  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=444
W20240118 23:53:06.756451  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:53:07.552062  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1093
W20240118 23:53:07.562714  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=448, pq.top=447
W20240118 23:53:07.765925  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:53:08.552017  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2462
W20240118 23:53:08.623420  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=448
W20240118 23:53:08.990005  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:53:09.558645  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=693
W20240118 23:53:09.624038  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=453, pq.top=451
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.477 ms                  | 57.707 ms                 |
| Forward                   | 8.252 ms                  | 14.192 ms                 |
| Backward                  | 6.449 ms                  | 9.342 ms                  |
| Optimize                  | 5.741 ms                  | 10.509 ms                 |
| BarrierTimeBeforeRank0    | 7.083 ms                  | 64.145 ms                 |
| AfterBackward             | 53.952 ms                 | 90.206 ms                 |
| BlockToStepN              | 261.686 ms                | 701.288 ms                |
| OneStep                   | 365.866 ms                | 824.423 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:10.351699  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:53:10.558049  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=837
W20240118 23:53:10.624157  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.684 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.254 ms                  | 13.095 ms                 |
| ProcessBack:UpsertPq      | 28.453 ms                 | 59.732 ms                 |
| ProcessOneStep            | 53.906 ms                 | 90.157 ms                 |
| BlockToStepN              | 261.573 ms                | 701.110 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:11.352476  8454 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:53:11.558008  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=692
W20240118 23:53:11.624169  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=455
E20240118 23:53:12.558293  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1803
W20240118 23:53:12.573055  8454 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:53:12.696354  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=460, pq.top=458
E20240118 23:53:13.562906  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=718
W20240118 23:53:13.696038  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=461
W20240118 23:53:13.794227  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:53:14.563038  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1161
W20240118 23:53:14.736686  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=465, pq.top=463
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.477 ms                  | 57.732 ms                 |
| Forward                   | 8.232 ms                  | 14.192 ms                 |
| Backward                  | 6.447 ms                  | 9.342 ms                  |
| Optimize                  | 5.741 ms                  | 10.509 ms                 |
| BarrierTimeBeforeRank0    | 7.088 ms                  | 64.145 ms                 |
| AfterBackward             | 53.886 ms                 | 90.206 ms                 |
| BlockToStepN              | 262.086 ms                | 701.288 ms                |
| OneStep                   | 367.592 ms                | 824.423 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:15.181581  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:53:15.566320  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1951
W20240118 23:53:15.737242  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.613 ms                 | 15.278 ms                 |
| ProcessBack:UpdateCache   | 8.292 ms                  | 13.095 ms                 |
| ProcessBack:UpsertPq      | 28.249 ms                 | 59.732 ms                 |
| ProcessOneStep            | 53.832 ms                 | 90.157 ms                 |
| BlockToStepN              | 262.104 ms                | 701.110 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:16.337565  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:53:16.567662  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=678
W20240118 23:53:16.737257  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=465
W20240118 23:53:17.342439  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:53:17.580060  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1402
W20240118 23:53:17.841784  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=472, pq.top=471
E20240118 23:53:18.580529  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2203
W20240118 23:53:18.601576  8454 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:53:18.841979  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=474, pq.top=473
E20240118 23:53:19.581620  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=4630
W20240118 23:53:19.605171  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:53:19.842007  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=476, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.484 ms                  | 57.732 ms                 |
| Forward                   | 8.220 ms                  | 14.192 ms                 |
| Backward                  | 6.449 ms                  | 9.342 ms                  |
| Optimize                  | 5.741 ms                  | 10.509 ms                 |
| BarrierTimeBeforeRank0    | 7.119 ms                  | 64.145 ms                 |
| AfterBackward             | 53.862 ms                 | 90.206 ms                 |
| BlockToStepN              | 262.271 ms                | 701.288 ms                |
| OneStep                   | 369.193 ms                | 824.423 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:53:20.593319  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=916
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.613 ms                 | 15.183 ms                 |
| ProcessBack:UpdateCache   | 8.254 ms                  | 13.001 ms                 |
| ProcessBack:UpsertPq      | 28.249 ms                 | 57.571 ms                 |
| ProcessOneStep            | 53.753 ms                 | 90.157 ms                 |
| BlockToStepN              | 262.118 ms                | 701.110 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:20.841580  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=478, pq.top=477
W20240118 23:53:20.872123  8454 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:53:21.593047  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2107
W20240118 23:53:21.841363  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=478
W20240118 23:53:22.095206  8454 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:53:22.593047  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=915
W20240118 23:53:22.901940  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=482
W20240118 23:53:23.156847  8454 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:53:23.593011  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=3563
W20240118 23:53:23.901291  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=482
W20240118 23:53:24.378103  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:53:24.595147  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=928
W20240118 23:53:24.902091  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=489, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.481 ms                  | 57.732 ms                 |
| Forward                   | 8.201 ms                  | 14.192 ms                 |
| Backward                  | 6.438 ms                  | 9.342 ms                  |
| Optimize                  | 5.745 ms                  | 10.509 ms                 |
| BarrierTimeBeforeRank0    | 7.119 ms                  | 64.145 ms                 |
| AfterBackward             | 53.707 ms                 | 90.206 ms                 |
| BlockToStepN              | 262.552 ms                | 701.288 ms                |
| OneStep                   | 369.427 ms                | 824.423 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:25.406307  8454 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:53:25.596024  8454 parallel_pq_v2.h:76] insert failed, size(hashtable)=840
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.494 ms                 | 15.183 ms                 |
| ProcessBack:UpdateCache   | 8.295 ms                  | 13.001 ms                 |
| ProcessBack:UpsertPq      | 28.017 ms                 | 57.571 ms                 |
| ProcessOneStep            | 53.650 ms                 | 90.157 ms                 |
| BlockToStepN              | 262.375 ms                | 701.110 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:53:25.956487  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=492, pq.top=490
W20240118 23:53:26.417974  8454 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:53:26.596015  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=1606
W20240118 23:53:26.957074  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=494, pq.top=493
W20240118 23:53:27.595628  8454 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:53:27.596017  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=2378
W20240118 23:53:27.957957  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=496, pq.top=490
W20240118 23:53:28.595674  8454 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:53:28.596020  8453 parallel_pq_v2.h:76] insert failed, size(hashtable)=498
W20240118 23:53:28.957686  7609 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=497
[proc 4] 500 steps, total: 42.242, sample: 0.775, forward: 0.783, backward: 0.756, update: 0.592
[proc 5] 500 steps, total: 42.242, sample: 0.924, forward: 0.815, backward: 0.727, update: 0.559
[proc 1] 500 steps, total: 42.242, sample: 0.827, forward: 0.822, backward: 0.683, update: 0.558
[proc 2] 500 steps, total: 42.242, sample: 0.898, forward: 0.845, backward: 0.698, update: 0.651
[proc 6] 500 steps, total: 42.242, sample: 0.850, forward: 0.817, backward: 0.725, update: 0.541
[proc 7] 500 steps, total: 42.242, sample: 0.695, forward: 0.793, backward: 0.752, update: 0.535
[proc 3] 500 steps, total: 42.242, sample: 0.819, forward: 0.786, backward: 0.738, update: 0.540
[proc 0] 500 steps, total: 42.242, sample: 0.858, forward: 0.769, backward: 0.624, update: 0.539
Successfully xmh. training takes 192.63628387451172 seconds
before call kg_cache_controller.StopThreads()
W20240118 23:53:29.583274  7609 grad_async_v2.h:71] call StopThreads. PID = 7002
W20240118 23:53:29.583309  7609 grad_base.h:210] before processOneStepNegThread_.join();
W20240118 23:53:29.583796  7609 grad_base.h:212] after processOneStepNegThread_.join();
W20240118 23:53:29.583822  7609 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240118 23:53:29.592321  7609 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fd5e0b6d390>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.481 ms                  | 57.732 ms                 |
| Forward                   | 8.194 ms                  | 14.192 ms                 |
| Backward                  | 6.430 ms                  | 9.342 ms                  |
| Optimize                  | 5.727 ms                  | 10.509 ms                 |
| BarrierTimeBeforeRank0    | 7.102 ms                  | 64.145 ms                 |
| AfterBackward             | 53.434 ms                 | 90.206 ms                 |
| BlockToStepN              | 266.329 ms                | 701.288 ms                |
| OneStep                   | 370.321 ms                | 824.423 ms                |
+---------------------------+---------------------------+---------------------------+
