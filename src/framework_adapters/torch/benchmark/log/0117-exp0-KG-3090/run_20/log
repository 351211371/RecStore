WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240119 01:13:19.351707 26569 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_0', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [26569 sampler.py:454] Start PreSampling
WARNING [26569 sampler.py:532] Before construct renumbering_dict
WARNING [26569 sampler.py:555] PreSampling done
W20240119 01:13:21.954723 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240119 01:13:21.955020 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240119 01:13:21.955068 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240119 01:13:21.955103 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240119 01:13:21.955142 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240119 01:13:21.955169 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240119 01:13:21.955211 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240119 01:13:21.955255 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240119 01:13:21.955292 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240119 01:13:21.955335 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240119 01:13:21.955384 26569 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240119 01:13:21.955421 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240119 01:13:21.955446 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240119 01:13:21.955583 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240119 01:13:21.955615 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240119 01:13:21.955646 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240119 01:13:21.955677 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240119 01:13:21.955709 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240119 01:13:21.955754 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240119 01:13:21.955798 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240119 01:13:21.955827 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240119 01:13:21.955857 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240119 01:13:21.955883 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240119 01:13:21.955910 26569 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240119 01:13:21.955933 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240119 01:13:21.955964 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240119 01:13:21.956029 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240119 01:13:21.956089 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240119 01:13:21.956125 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240119 01:13:21.956153 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240119 01:13:21.956195 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240119 01:13:21.956233 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240119 01:13:21.956266 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240119 01:13:21.956307 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240119 01:13:21.956341 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240119 01:13:21.956368 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240119 01:13:21.956398 26569 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240119 01:13:21.956421 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240119 01:13:21.956450 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240119 01:13:21.956504 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240119 01:13:21.956537 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240119 01:13:21.956565 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240119 01:13:21.956598 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240119 01:13:21.956625 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240119 01:13:21.956660 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240119 01:13:21.956689 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240119 01:13:21.956724 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240119 01:13:21.956764 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240119 01:13:21.956791 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240119 01:13:21.956832 26569 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240119 01:13:21.956856 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240119 01:13:21.956878 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240119 01:13:21.956959 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240119 01:13:21.956993 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240119 01:13:21.957026 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240119 01:13:21.957054 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240119 01:13:21.957098 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240119 01:13:21.957139 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240119 01:13:21.957172 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240119 01:13:21.957203 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240119 01:13:21.957230 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240119 01:13:21.957266 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240119 01:13:21.957293 26569 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240119 01:13:21.957316 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240119 01:13:21.957340 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240119 01:13:21.957393 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240119 01:13:21.957434 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240119 01:13:21.957468 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240119 01:13:21.957494 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240119 01:13:21.957527 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240119 01:13:21.957561 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240119 01:13:21.957593 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240119 01:13:21.957624 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240119 01:13:21.957654 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240119 01:13:21.957687 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240119 01:13:21.957715 26569 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240119 01:13:21.957736 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240119 01:13:21.957765 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240119 01:13:21.957818 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240119 01:13:21.957846 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240119 01:13:21.957875 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240119 01:13:21.957902 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240119 01:13:21.957929 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240119 01:13:21.957957 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240119 01:13:21.957991 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240119 01:13:21.958025 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240119 01:13:21.958060 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240119 01:13:21.958096 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240119 01:13:21.958124 26569 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240119 01:13:21.958146 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240119 01:13:21.958168 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240119 01:13:21.958223 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240119 01:13:21.958257 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240119 01:13:21.958285 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240119 01:13:21.958313 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240119 01:13:21.958344 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240119 01:13:21.958386 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240119 01:13:21.958422 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240119 01:13:21.958453 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240119 01:13:21.958487 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240119 01:13:21.958515 26569 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240119 01:13:21.958550 26569 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240119 01:13:21.958573 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240119 01:13:21.958595 26569 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240119 01:13:22.157366 26569 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240119 01:13:22.157524 26569 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1512,  2044,  2784,  ...,  7928, 11203,  6352]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.841 seconds
[Rank1] pid = 26958
[Rank2] pid = 27022
[Rank3] pid = 27089
[Rank4] pid = 27090
[Rank5] pid = 27217
[Rank6] pid = 27218
INFO [26569 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26958 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [27022 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [27089 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [27090 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [27218 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [27217 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [27220 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [27022 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27090 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27089 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26958 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27217 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26569 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27220 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27218 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240119 01:13:25.783062 27221 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240119 01:13:25.783890 27023 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240119 01:13:25.783911 27092 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240119 01:13:25.783911 27285 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240119 01:13:25.783913 27410 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240119 01:13:25.783921 26959 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240119 01:13:25.783929 27091 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240119 01:13:25.783936 27219 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240119 01:13:25.819356 27410 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x1000054aa000
W20240119 01:13:25.819416 27285 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x10000556f000
W20240119 01:13:25.819474 27219 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x100005638000
W20240119 01:13:25.819514 27410 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x100005703000
W20240119 01:13:25.819531 27285 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x1000057c8000
W20240119 01:13:25.819576 27410 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 400]0x10000588d000
W20240119 01:13:25.819586 27285 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 400]0x10000f125000
W20240119 01:13:25.819602 27219 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x1000189bd000
W20240119 01:13:25.819618 27410 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x100018a82000
W20240119 01:13:25.819622 27285 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10002231a000
W20240119 01:13:25.819631 27221 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x10002bbb2000
W20240119 01:13:25.819643 27023 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x10002bc77000
W20240119 01:13:25.819665 27219 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 400]0x10002bd3c000
W20240119 01:13:25.819669 27410 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240119 01:13:25.819670 27285 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240119 01:13:25.819680 27092 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x1000355d4000
W20240119 01:13:25.819695 26959 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x100035699000
W20240119 01:13:25.819712 27219 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10003575e000
W20240119 01:13:25.819726 27221 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x10003f0bb000
W20240119 01:13:25.819728 27091 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x10003eff6000
W20240119 01:13:25.819756 27219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240119 01:13:25.819788 27023 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x10003f180000
W20240119 01:13:25.819789 27221 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x10003f245000
W20240119 01:13:25.819818 27092 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x100048add000
W20240119 01:13:25.819826 27221 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100048ba2000
W20240119 01:13:25.819836 26959 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x10005243a000
W20240119 01:13:25.819852 27091 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1000524ff000
W20240119 01:13:25.819855 27023 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x1000525c4000
W20240119 01:13:25.819867 27221 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240119 01:13:25.819882 27092 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 400]0x10005be5c000
W20240119 01:13:25.819897 26959 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x1000656f4000
W20240119 01:13:25.819911 27023 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10006ef8c000
W20240119 01:13:25.819916 27091 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x100078824000
W20240119 01:13:25.819939 27092 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1000820bc000
W20240119 01:13:25.819948 27023 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240119 01:13:25.819957 26959 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10008b954000
W20240119 01:13:25.819968 27091 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x1000951ec000
W20240119 01:13:25.819985 27092 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240119 01:13:25.820001 26959 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240119 01:13:25.820003 27091 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240119 01:13:25.822238 27410 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240119 01:13:25.822422 27092 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240119 01:13:25.822432 27023 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240119 01:13:25.822448 27221 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240119 01:13:25.822458 27285 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240119 01:13:25.822476 27219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240119 01:13:25.822608 26959 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240119 01:13:25.822619 27091 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [27218 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [27220 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [27090 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [26958 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [27217 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [27089 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [27022 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 27220
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [26569 DistTensor.py:56] The tensor name already exists in the kvstore
I20240119 01:13:25.999789 27221 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999828 27092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999855 27410 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999879 27219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999904 27091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999928 27023 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:25.999953 26959 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:13:26.000000 27285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 01:13:26.001049 27221 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1
        }
W20240119 01:13:26.001168 27221 grad_base.h:172] Init GradProcessingBase done
I20240119 01:13:26.004812 27221 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240119 01:13:26.004949 27221 kg_controller.h:78] after init GradAsyncProcessingV2
I20240119 01:13:26.004961 27221 kg_controller.h:84] Construct KGCacheController done
I20240119 01:13:26.710227 27221 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240119 01:13:27.826771 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:13:27.828665 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240119 01:13:27.880715 26959 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240119 01:13:27.885344 27410 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.888131 27285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.902560 27023 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.902702 27091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.902778 27219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.911542 27221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:13:27.928427 27092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240119 01:13:29.947029 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 01:13:29.998301 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:13:30.947008 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=3376
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.995 ms                  | 67.439 ms                 |
| Forward                   | 8.438 ms                  | 553.626 ms                |
| Backward                  | 7.550 ms                  | 210.341 ms                |
| Optimize                  | 5.332 ms                  | 51.156 ms                 |
| BarrierTimeBeforeRank0    | 2.871 ms                  | 125.301 ms                |
| AfterBackward             | 59.262 ms                 | 1.122 s                   |
| BlockToStepN              | 82.706 us                 | 365.785 us                |
| OneStep                   | 85.045 ms                 | 2.067 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:31.024324 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240119 01:13:31.081141 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.110 ms                 | 298.908 ms                |
| ProcessBack:UpdateCache   | 8.747 ms                  | 766.057 ms                |
| ProcessBack:UpsertPq      | 32.863 ms                 | 52.143 ms                 |
| ProcessOneStep            | 59.218 ms                 | 1.121 s                   |
| BlockToStepN              | 12.465 us                 | 192.897 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:13:31.947162 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=7095
W20240119 01:13:32.024015 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240119 01:13:32.186736 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
E20240119 01:13:32.947013 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=448
W20240119 01:13:33.024016 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240119 01:13:33.226864 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240119 01:13:33.947041 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4193
W20240119 01:13:34.096268 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240119 01:13:34.230669 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
E20240119 01:13:34.947063 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=971
W20240119 01:13:35.220067 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240119 01:13:35.276810 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240119 01:13:35.947039 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4154
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.221 ms                  | 67.439 ms                 |
| Forward                   | 8.516 ms                  | 553.626 ms                |
| Backward                  | 7.616 ms                  | 210.341 ms                |
| Optimize                  | 5.070 ms                  | 51.156 ms                 |
| BarrierTimeBeforeRank0    | 4.464 ms                  | 125.301 ms                |
| AfterBackward             | 59.634 ms                 | 1.122 s                   |
| BlockToStepN              | 4.211 ms                  | 556.963 ms                |
| OneStep                   | 100.954 ms                | 2.067 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:36.220029 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240119 01:13:36.309777 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.856 ms                 | 298.049 ms                |
| ProcessBack:UpdateCache   | 9.108 ms                  | 766.053 ms                |
| ProcessBack:UpsertPq      | 32.887 ms                 | 48.583 ms                 |
| ProcessOneStep            | 59.585 ms                 | 1.121 s                   |
| BlockToStepN              | 7.108 ms                  | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:13:36.947019 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=3828
W20240119 01:13:37.304174 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240119 01:13:37.379624 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
E20240119 01:13:37.947788 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240119 01:13:38.304055 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=44, pq.top=44
W20240119 01:13:38.821242 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 01:13:38.947058 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1055
W20240119 01:13:39.408016 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=48, pq.top=48
W20240119 01:13:39.865214 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240119 01:13:39.947106 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4201
W20240119 01:13:40.453931 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240119 01:13:40.923454 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240119 01:13:40.947002 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1707
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.185 ms                  | 50.631 ms                 |
| Forward                   | 8.657 ms                  | 20.470 ms                 |
| Backward                  | 7.362 ms                  | 15.115 ms                 |
| Optimize                  | 5.280 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 60.044 ms                 |
| AfterBackward             | 56.845 ms                 | 114.199 ms                |
| BlockToStepN              | 16.614 ms                 | 556.963 ms                |
| OneStep                   | 149.764 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:41.453085 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=60, pq.top=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.785 ms                 | 298.049 ms                |
| ProcessBack:UpdateCache   | 9.203 ms                  | 766.053 ms                |
| ProcessBack:UpsertPq      | 32.075 ms                 | 52.143 ms                 |
| ProcessOneStep            | 56.010 ms                 | 114.161 ms                |
| BlockToStepN              | 25.231 ms                 | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:41.938433 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:13:41.947302 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1409
W20240119 01:13:42.486272 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240119 01:13:42.947029 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 01:13:42.947793 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=786
W20240119 01:13:43.540771 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=70
E20240119 01:13:43.947173 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4229
W20240119 01:13:43.958683 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 01:13:44.540109 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240119 01:13:44.949362 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=4042
W20240119 01:13:44.964452 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:13:45.540064 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=78, pq.top=78
E20240119 01:13:45.949021 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=3431
W20240119 01:13:45.964704 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.151 ms                  | 55.473 ms                 |
| Forward                   | 8.657 ms                  | 20.470 ms                 |
| Backward                  | 7.190 ms                  | 15.115 ms                 |
| Optimize                  | 5.194 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.139 ms                  | 60.044 ms                 |
| AfterBackward             | 54.700 ms                 | 114.199 ms                |
| BlockToStepN              | 68.754 ms                 | 556.963 ms                |
| OneStep                   | 188.580 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:46.577301 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=82, pq.top=82
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.579 ms                 | 17.852 ms                 |
| ProcessBack:UpdateCache   | 9.051 ms                  | 22.989 ms                 |
| ProcessBack:UpsertPq      | 29.697 ms                 | 48.583 ms                 |
| ProcessOneStep            | 54.021 ms                 | 114.161 ms                |
| BlockToStepN              | 77.526 ms                 | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:13:46.949056 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1738
W20240119 01:13:46.965667 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:13:47.660415 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=86, pq.top=86
E20240119 01:13:47.949038 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=2632
W20240119 01:13:47.980203 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:13:48.660028 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
E20240119 01:13:48.949707 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=955
W20240119 01:13:49.097827 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:13:49.660116 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=92, pq.top=92
E20240119 01:13:49.950415 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1564
W20240119 01:13:50.111212 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:13:50.660145 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
E20240119 01:13:50.952610 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1021
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.221 ms                  | 55.473 ms                 |
| Forward                   | 8.781 ms                  | 20.470 ms                 |
| Backward                  | 7.190 ms                  | 15.115 ms                 |
| Optimize                  | 5.194 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 53.331 ms                 | 114.199 ms                |
| BlockToStepN              | 103.019 ms                | 556.963 ms                |
| OneStep                   | 205.953 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:51.132738 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:13:51.660207 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=98, pq.top=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.580 ms                 | 17.852 ms                 |
| ProcessBack:UpdateCache   | 8.737 ms                  | 22.989 ms                 |
| ProcessBack:UpsertPq      | 28.421 ms                 | 48.583 ms                 |
| ProcessOneStep            | 52.786 ms                 | 114.161 ms                |
| BlockToStepN              | 103.644 ms                | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:13:51.952904 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=605
W20240119 01:13:52.145802 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 7] 100 steps, total: 24.624, sample: 0.731, forward: 1.245, backward: 1.006, update: 0.548
[proc 3] 100 steps, total: 24.607, sample: 0.829, forward: 1.413, backward: 0.935, update: 0.565
[proc 6] 100 steps, total: 24.622, sample: 0.835, forward: 1.414, backward: 0.909, update: 0.593
[proc 2] 100 steps, total: 24.608, sample: 0.786, forward: 1.327, backward: 0.901, update: 0.532
[proc 4] 100 steps, total: 24.581, sample: 0.819, forward: 1.516, backward: 0.993, update: 0.575
[proc 1] 100 steps, total: 24.629, sample: 0.854, forward: 1.429, backward: 0.884, update: 0.592
[proc 5] 100 steps, total: 24.607, sample: 0.801, forward: 1.423, backward: 0.926, update: 0.608
-------Step 0-------
tensor([ 2471,     8,  3504,   102, 10515, 10943,  1961,  6682, 14033, 10014]) tensor([ 2784, 11469,  5480, 13170, 10078,  1822,  6930,  4663,   946,  1314])
-------Step 1-------
tensor([ 2471,     8,  3504,   102, 10515, 10943,  1961,  6682, 14033, 10014]) tensor([12063, 12676, 14230, 13492,  1155,  2700,  8900,  1016,  3111, 12335])
-------Step 2-------
tensor([ 4798,  6379,  6290, 13686,  8537, 13616,  8286,     1,  4492,  3038]) tensor([ 5524,  6884,  4393,  6744,  3043, 14470,   343,  2046, 12918,  4568])
-------Step 3-------
tensor([ 4798,  6379,  6290, 13686,  8537, 13616,  8286,     1,  4492,  3038]) tensor([11320,   395,  7677, 14942,  8407,  9494, 11201,   836,  4751,  4914])
-------Step 4-------
tensor([10721,    50,   138,  3236,  6706, 13674,   101, 13190,  5058,   141]) tensor([ 3887,  8860, 12371,  2417,  1695,  6686,   595,  8660,  6838, 13970])
-------Step 5-------
tensor([10721,    50,   138,  3236,  6706, 13674,   101, 13190,  5058,   141]) tensor([ 7011,  7335,  2727, 14054,  9579, 13104, 13893,  5128,  3008, 11469])
-------Step 6-------
tensor([ 2498,  5702, 14586,  3724,   125,  8032, 10706,  1922, 14804,  1104]) tensor([10648,  5228, 13830,  7014,  1121, 11902, 14648,  8660, 10329, 14176])
-------Step 7-------
tensor([ 2498,  5702, 14586,  3724,   125,  8032, 10706,  1922, 14804,  1104]) tensor([ 5022,  7180,  7517, 12298,  8242,   153,  4782,  1658,  2828,  4784])
-------Step 8-------
tensor([ 2261, 10812, 10541, 14127,  5058,  3120,  7443,  4806,  2956,  4574]) tensor([  270,   347, 11620, 14443,  6226,  6450, 11294,   767,    42,  5679])
-------Step 9-------
tensor([ 2261, 10812, 10541, 14127,  5058,  3120,  7443,  4806,  2956,  4574]) tensor([   34, 11422, 11835,  9432,  5507,  8402,  1206, 11573,  7585,  8678])
[proc 0] 100 steps, total: 24.598, sample: 0.884, forward: 1.427, backward: 0.948, update: 0.591
W20240119 01:13:52.660048 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240119 01:13:52.952131 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=782
W20240119 01:13:53.188439 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:13:53.706162 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
E20240119 01:13:53.957574 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1917
W20240119 01:13:54.436446 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:13:54.706086 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=106, pq.top=106
E20240119 01:13:54.957892 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=671
W20240119 01:13:55.519696 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:13:55.706202 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
E20240119 01:13:55.957144 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.287 ms                  | 55.473 ms                 |
| Forward                   | 8.781 ms                  | 20.470 ms                 |
| Backward                  | 7.186 ms                  | 15.115 ms                 |
| Optimize                  | 5.239 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 60.044 ms                 |
| AfterBackward             | 52.441 ms                 | 114.199 ms                |
| BlockToStepN              | 116.792 ms                | 556.963 ms                |
| OneStep                   | 221.643 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:56.667009 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.364 ms                 | 17.852 ms                 |
| ProcessBack:UpdateCache   | 8.579 ms                  | 22.989 ms                 |
| ProcessBack:UpsertPq      | 27.928 ms                 | 48.583 ms                 |
| ProcessOneStep            | 52.398 ms                 | 114.161 ms                |
| BlockToStepN              | 125.612 ms                | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:13:56.767444 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=112, pq.top=112
E20240119 01:13:56.957125 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1601
W20240119 01:13:57.767032 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240119 01:13:57.783846 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 01:13:57.957855 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=573
W20240119 01:13:58.767088 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240119 01:13:58.824700 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:13:58.957015 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=3763
W20240119 01:13:59.767222 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=120
E20240119 01:13:59.959375 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1575
W20240119 01:14:00.035001 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:14:00.767261 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=122, pq.top=122
E20240119 01:14:00.963768 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.311 ms                  | 55.473 ms                 |
| Forward                   | 8.692 ms                  | 20.470 ms                 |
| Backward                  | 7.150 ms                  | 15.115 ms                 |
| Optimize                  | 5.245 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 66.032 ms                 |
| AfterBackward             | 52.278 ms                 | 114.199 ms                |
| BlockToStepN              | 133.535 ms                | 556.963 ms                |
| OneStep                   | 234.669 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:01.207909 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.265 ms                 | 17.852 ms                 |
| ProcessBack:UpdateCache   | 8.368 ms                  | 22.989 ms                 |
| ProcessBack:UpsertPq      | 27.812 ms                 | 48.583 ms                 |
| ProcessOneStep            | 52.210 ms                 | 114.161 ms                |
| BlockToStepN              | 134.463 ms                | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:01.767068 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240119 01:14:01.963013 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1885
W20240119 01:14:02.397509 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:14:02.767262 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=128, pq.top=128
E20240119 01:14:02.963043 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1568
W20240119 01:14:03.451382 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 01:14:03.767158 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=130
E20240119 01:14:03.963088 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4617
W20240119 01:14:04.685714 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:14:04.801241 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
E20240119 01:14:04.963013 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1990
W20240119 01:14:05.716161 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:14:05.837764 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=136
E20240119 01:14:05.969184 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=948
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.311 ms                  | 55.473 ms                 |
| Forward                   | 8.587 ms                  | 20.470 ms                 |
| Backward                  | 7.095 ms                  | 15.115 ms                 |
| Optimize                  | 5.259 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.118 ms                  | 66.032 ms                 |
| AfterBackward             | 52.138 ms                 | 114.199 ms                |
| BlockToStepN              | 154.682 ms                | 556.963 ms                |
| OneStep                   | 255.681 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.310 ms                 | 17.628 ms                 |
| ProcessBack:UpdateCache   | 8.250 ms                  | 22.360 ms                 |
| ProcessBack:UpsertPq      | 27.831 ms                 | 48.583 ms                 |
| ProcessOneStep            | 52.096 ms                 | 114.161 ms                |
| BlockToStepN              | 162.464 ms                | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:06.763219 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:14:06.870584 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
E20240119 01:14:06.970083 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1184
W20240119 01:14:07.870277 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240119 01:14:07.893205 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:14:07.971740 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=4462
W20240119 01:14:08.870020 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=144, pq.top=144
E20240119 01:14:08.971028 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2006
W20240119 01:14:09.037901 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 01:14:09.870282 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=146, pq.top=146
E20240119 01:14:09.971014 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=20
W20240119 01:14:10.038072 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:14:10.870056 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
E20240119 01:14:10.975337 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1010
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.329 ms                  | 55.473 ms                 |
| Forward                   | 8.610 ms                  | 20.470 ms                 |
| Backward                  | 7.115 ms                  | 15.115 ms                 |
| Optimize                  | 5.304 ms                  | 11.328 ms                 |
| BarrierTimeBeforeRank0    | 6.118 ms                  | 66.032 ms                 |
| AfterBackward             | 52.138 ms                 | 114.199 ms                |
| BlockToStepN              | 179.751 ms                | 556.963 ms                |
| OneStep                   | 277.026 ms                | 813.319 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:11.066651 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.364 ms                 | 17.628 ms                 |
| ProcessBack:UpdateCache   | 8.214 ms                  | 22.360 ms                 |
| ProcessBack:UpsertPq      | 28.027 ms                 | 54.519 ms                 |
| ProcessOneStep            | 52.176 ms                 | 87.100 ms                 |
| BlockToStepN              | 181.074 ms                | 556.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:11.893275 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
E20240119 01:14:11.975119 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=981
W20240119 01:14:12.169111 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:14:12.968961 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=155
E20240119 01:14:12.975446 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=307
W20240119 01:14:13.210572 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:14:13.975020 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=3072
W20240119 01:14:14.006680 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240119 01:14:14.266594 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:14:14.975008 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2130
W20240119 01:14:15.056120 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240119 01:14:15.371896 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:14:15.978578 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1089
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.356 ms                  | 55.415 ms                 |
| Forward                   | 8.541 ms                  | 13.316 ms                 |
| Backward                  | 7.096 ms                  | 13.696 ms                 |
| Optimize                  | 5.280 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 60.044 ms                 |
| AfterBackward             | 52.230 ms                 | 87.144 ms                 |
| BlockToStepN              | 205.767 ms                | 433.674 ms                |
| OneStep                   | 298.282 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:16.056253 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240119 01:14:16.399453 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.439 ms                 | 17.628 ms                 |
| ProcessBack:UpdateCache   | 8.124 ms                  | 22.360 ms                 |
| ProcessBack:UpsertPq      | 28.027 ms                 | 54.519 ms                 |
| ProcessOneStep            | 52.176 ms                 | 87.100 ms                 |
| BlockToStepN              | 208.904 ms                | 433.517 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:16.985762 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1376
W20240119 01:14:17.056010 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240119 01:14:17.473718 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:14:17.985047 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=373
W20240119 01:14:18.056308 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240119 01:14:18.727111 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:14:18.985019 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1106
W20240119 01:14:19.056054 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240119 01:14:19.740409 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:14:19.989391 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1718
W20240119 01:14:20.056509 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240119 01:14:20.856602 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:14:20.994021 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=284
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.399 ms                  | 55.473 ms                 |
| Forward                   | 8.537 ms                  | 13.316 ms                 |
| Backward                  | 7.096 ms                  | 13.696 ms                 |
| Optimize                  | 5.264 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 52.127 ms                 | 87.144 ms                 |
| BlockToStepN              | 216.708 ms                | 433.674 ms                |
| OneStep                   | 312.985 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:21.056316 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=176, pq.top=176
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.523 ms                 | 16.051 ms                 |
| ProcessBack:UpdateCache   | 8.067 ms                  | 15.884 ms                 |
| ProcessBack:UpsertPq      | 28.075 ms                 | 52.143 ms                 |
| ProcessOneStep            | 52.079 ms                 | 87.100 ms                 |
| BlockToStepN              | 216.985 ms                | 433.517 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:21.994032 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1904
W20240119 01:14:22.056321 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
W20240119 01:14:22.062286 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:14:22.994019 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=397
W20240119 01:14:23.056054 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240119 01:14:23.352145 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:14:23.997692 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1307
W20240119 01:14:24.158643 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240119 01:14:24.434836 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 01:14:25.008534 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=303
W20240119 01:14:25.158262 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240119 01:14:25.502722 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.401 ms                  | 55.473 ms                 |
| Forward                   | 8.482 ms                  | 13.316 ms                 |
| Backward                  | 7.096 ms                  | 13.696 ms                 |
| Optimize                  | 5.280 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 60.044 ms                 |
| AfterBackward             | 52.079 ms                 | 87.144 ms                 |
| BlockToStepN              | 219.186 ms                | 433.674 ms                |
| OneStep                   | 318.004 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:26.023540 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=776
W20240119 01:14:26.158236 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240119 01:14:26.610858 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.310 ms                 | 16.051 ms                 |
| ProcessBack:UpdateCache   | 8.046 ms                  | 15.884 ms                 |
| ProcessBack:UpsertPq      | 27.881 ms                 | 52.143 ms                 |
| ProcessOneStep            | 51.999 ms                 | 87.100 ms                 |
| BlockToStepN              | 221.562 ms                | 433.517 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:27.023010 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=3059
W20240119 01:14:27.158263 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240119 01:14:27.845942 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:14:28.023576 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=771
W20240119 01:14:28.158423 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=194
E20240119 01:14:29.023016 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1775
W20240119 01:14:29.074771 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:14:29.164108 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240119 01:14:30.023113 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=855
W20240119 01:14:30.164418 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240119 01:14:30.192766 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 0] 200 steps, total: 38.210, sample: 0.752, forward: 0.804, backward: 0.704, update: 0.542
[proc 2] 200 steps, total: 38.211, sample: 0.800, forward: 0.908, backward: 0.652, update: 0.541
[proc 7] 200 steps, total: 38.212, sample: 0.741, forward: 0.787, backward: 0.674, update: 0.511
[proc 3] 200 steps, total: 38.211, sample: 0.671, forward: 0.809, backward: 0.738, update: 0.537
[proc 5] 200 steps, total: 38.211, sample: 0.741, forward: 0.873, backward: 0.757, update: 0.565
[proc 1] 200 steps, total: 38.211, sample: 0.557, forward: 0.814, backward: 0.678, update: 0.528
[proc 4] 200 steps, total: 38.211, sample: 0.830, forward: 0.812, backward: 0.743, update: 0.526
[proc 6] 200 steps, total: 38.211, sample: 0.728, forward: 0.834, backward: 0.681, update: 0.562
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.399 ms                  | 55.473 ms                 |
| Forward                   | 8.386 ms                  | 13.316 ms                 |
| Backward                  | 7.092 ms                  | 13.696 ms                 |
| Optimize                  | 5.314 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.475 ms                  | 60.044 ms                 |
| AfterBackward             | 51.968 ms                 | 87.144 ms                 |
| BlockToStepN              | 228.818 ms                | 433.674 ms                |
| OneStep                   | 332.475 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:31.026295 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1501
W20240119 01:14:31.174955 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240119 01:14:31.338425 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.286 ms                 | 16.051 ms                 |
| ProcessBack:UpdateCache   | 8.073 ms                  | 15.884 ms                 |
| ProcessBack:UpsertPq      | 27.785 ms                 | 52.143 ms                 |
| ProcessOneStep            | 51.901 ms                 | 87.100 ms                 |
| BlockToStepN              | 228.178 ms                | 433.517 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:32.027321 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1514
W20240119 01:14:32.174322 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240119 01:14:32.488013 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:14:33.073248 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=552
W20240119 01:14:33.174234 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240119 01:14:33.555699 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:14:34.073017 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4010
W20240119 01:14:34.174183 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240119 01:14:34.558921 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:14:35.075064 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1500
W20240119 01:14:35.181082 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240119 01:14:35.578603 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.389 ms                  | 55.473 ms                 |
| Forward                   | 8.369 ms                  | 13.316 ms                 |
| Backward                  | 7.090 ms                  | 13.696 ms                 |
| Optimize                  | 5.304 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 51.736 ms                 | 87.144 ms                 |
| BlockToStepN              | 230.661 ms                | 433.674 ms                |
| OneStep                   | 336.373 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:36.081044 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=476
W20240119 01:14:36.181376 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.286 ms                 | 16.051 ms                 |
| ProcessBack:UpdateCache   | 8.175 ms                  | 15.884 ms                 |
| ProcessBack:UpsertPq      | 27.746 ms                 | 52.143 ms                 |
| ProcessOneStep            | 51.678 ms                 | 87.100 ms                 |
| BlockToStepN              | 231.514 ms                | 433.517 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:36.770614 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 01:14:37.084476 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1316
W20240119 01:14:37.181344 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240119 01:14:38.034785 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 01:14:38.084008 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=3096
W20240119 01:14:38.181188 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240119 01:14:39.052309 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:14:39.084486 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=564
W20240119 01:14:39.181252 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=222
E20240119 01:14:40.092173 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1044
W20240119 01:14:40.181219 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240119 01:14:40.273701 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.389 ms                  | 55.473 ms                 |
| Forward                   | 8.386 ms                  | 13.316 ms                 |
| Backward                  | 7.086 ms                  | 13.696 ms                 |
| Optimize                  | 5.304 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 51.640 ms                 | 87.144 ms                 |
| BlockToStepN              | 235.927 ms                | 471.058 ms                |
| OneStep                   | 345.389 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:41.092010 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=3266
W20240119 01:14:41.181031 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240119 01:14:41.383344 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.127 ms                 | 15.884 ms                 |
| ProcessBack:UpdateCache   | 8.216 ms                  | 15.485 ms                 |
| ProcessBack:UpsertPq      | 27.511 ms                 | 51.349 ms                 |
| ProcessOneStep            | 51.602 ms                 | 87.100 ms                 |
| BlockToStepN              | 236.625 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:42.094266 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1994
W20240119 01:14:42.216123 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240119 01:14:42.591746 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:14:43.095662 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4905
W20240119 01:14:43.216470 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240119 01:14:43.604085 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:14:44.106750 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=725
W20240119 01:14:44.216241 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240119 01:14:44.728116 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:14:45.106011 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=3860
W20240119 01:14:45.216398 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240119 01:14:45.869740 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.382 ms                  | 55.473 ms                 |
| Forward                   | 8.386 ms                  | 13.316 ms                 |
| Backward                  | 7.095 ms                  | 13.696 ms                 |
| Optimize                  | 5.304 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 51.638 ms                 | 87.144 ms                 |
| BlockToStepN              | 241.162 ms                | 471.058 ms                |
| OneStep                   | 348.419 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:46.118781 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=963
W20240119 01:14:46.216008 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.156 ms                 | 15.884 ms                 |
| ProcessBack:UpdateCache   | 8.211 ms                  | 15.485 ms                 |
| ProcessBack:UpsertPq      | 27.489 ms                 | 51.349 ms                 |
| ProcessOneStep            | 51.567 ms                 | 87.100 ms                 |
| BlockToStepN              | 245.255 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:47.122352 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1451
W20240119 01:14:47.216535 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240119 01:14:47.316510 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:14:48.122012 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4809
W20240119 01:14:48.216266 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240119 01:14:48.464184 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 01:14:49.135906 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1489
W20240119 01:14:49.315742 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240119 01:14:49.638180 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:14:50.135213 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=670
W20240119 01:14:50.315125 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240119 01:14:50.742686 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.389 ms                  | 55.415 ms                 |
| Forward                   | 8.386 ms                  | 13.090 ms                 |
| Backward                  | 7.096 ms                  | 12.286 ms                 |
| Optimize                  | 5.304 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 58.896 ms                 |
| AfterBackward             | 51.638 ms                 | 82.909 ms                 |
| BlockToStepN              | 245.596 ms                | 476.292 ms                |
| OneStep                   | 350.034 ms                | 672.997 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:51.135059 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1918
W20240119 01:14:51.315465 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=252, pq.top=252
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.156 ms                 | 15.884 ms                 |
| ProcessBack:UpdateCache   | 8.170 ms                  | 15.485 ms                 |
| ProcessBack:UpsertPq      | 27.511 ms                 | 51.349 ms                 |
| ProcessOneStep            | 51.602 ms                 | 82.864 ms                 |
| BlockToStepN              | 245.720 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:51.949594 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:14:52.139160 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=903
W20240119 01:14:52.315351 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=254
W20240119 01:14:52.953763 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:14:53.143385 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1083
W20240119 01:14:53.315477 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=256
E20240119 01:14:54.143009 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2059
W20240119 01:14:54.149789 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:14:54.315110 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240119 01:14:55.151449 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1107
W20240119 01:14:55.315603 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240119 01:14:55.499897 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.414 ms                  | 55.415 ms                 |
| Forward                   | 8.347 ms                  | 13.090 ms                 |
| Backward                  | 7.115 ms                  | 12.286 ms                 |
| Optimize                  | 5.305 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 58.896 ms                 |
| AfterBackward             | 51.664 ms                 | 82.909 ms                 |
| BlockToStepN              | 254.330 ms                | 471.058 ms                |
| OneStep                   | 355.724 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:14:56.151749 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=843
W20240119 01:14:56.315130 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.156 ms                 | 15.884 ms                 |
| ProcessBack:UpdateCache   | 8.106 ms                  | 15.485 ms                 |
| ProcessBack:UpsertPq      | 27.552 ms                 | 51.349 ms                 |
| ProcessOneStep            | 51.666 ms                 | 82.864 ms                 |
| BlockToStepN              | 255.476 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:14:56.842671 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 01:14:57.153939 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1325
W20240119 01:14:57.354848 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240119 01:14:58.019955 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:14:58.156080 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=712
W20240119 01:14:58.354049 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=268, pq.top=268
E20240119 01:14:59.179101 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2198
W20240119 01:14:59.215394 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:14:59.354188 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
E20240119 01:15:00.192047 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=907
W20240119 01:15:00.354514 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240119 01:15:00.538791 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.415 ms                  | 55.415 ms                 |
| Forward                   | 8.323 ms                  | 13.090 ms                 |
| Backward                  | 7.111 ms                  | 12.286 ms                 |
| Optimize                  | 5.314 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 58.896 ms                 |
| AfterBackward             | 51.799 ms                 | 82.909 ms                 |
| BlockToStepN              | 256.378 ms                | 471.058 ms                |
| OneStep                   | 358.355 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:01.192832 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=745
W20240119 01:15:01.438710 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.156 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.046 ms                  | 15.392 ms                 |
| ProcessBack:UpsertPq      | 27.623 ms                 | 50.356 ms                 |
| ProcessOneStep            | 51.699 ms                 | 82.864 ms                 |
| BlockToStepN              | 256.591 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:01.842536 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 01:15:02.194427 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1661
W20240119 01:15:02.438510 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=278, pq.top=278
W20240119 01:15:02.858667 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:03.204366 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=576
W20240119 01:15:03.438112 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240119 01:15:03.899574 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:15:04.206737 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1139
W20240119 01:15:04.469301 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240119 01:15:04.917474 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:15:05.220019 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 01:15:05.469079 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240119 01:15:05.969614 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.446 ms                  | 55.415 ms                 |
| Forward                   | 8.300 ms                  | 13.090 ms                 |
| Backward                  | 7.111 ms                  | 12.286 ms                 |
| Optimize                  | 5.314 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 58.896 ms                 |
| AfterBackward             | 51.799 ms                 | 82.909 ms                 |
| BlockToStepN              | 260.107 ms                | 471.058 ms                |
| OneStep                   | 360.442 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:06.222566 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=663
W20240119 01:15:06.469681 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.156 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.035 ms                  | 15.392 ms                 |
| ProcessBack:UpsertPq      | 27.623 ms                 | 50.356 ms                 |
| ProcessOneStep            | 51.722 ms                 | 82.864 ms                 |
| BlockToStepN              | 260.563 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:06.995391 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:07.222227 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=941
W20240119 01:15:07.469858 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240119 01:15:08.160580 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:15:08.222101 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4636
W20240119 01:15:08.469506 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=292
E20240119 01:15:09.222009 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1113
W20240119 01:15:09.438854 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 01:15:09.564962 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
E20240119 01:15:10.238662 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2182
W20240119 01:15:10.564144 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240119 01:15:10.711305 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.446 ms                  | 55.415 ms                 |
| Forward                   | 8.296 ms                  | 13.090 ms                 |
| Backward                  | 7.101 ms                  | 12.286 ms                 |
| Optimize                  | 5.314 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.118 ms                  | 58.896 ms                 |
| AfterBackward             | 51.912 ms                 | 82.909 ms                 |
| BlockToStepN              | 261.577 ms                | 471.058 ms                |
| OneStep                   | 363.562 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:11.238112 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4487
W20240119 01:15:11.564987 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.265 ms                 | 15.779 ms                 |
| ProcessBack:UpdateCache   | 8.035 ms                  | 15.392 ms                 |
| ProcessBack:UpsertPq      | 27.785 ms                 | 50.356 ms                 |
| ProcessOneStep            | 51.901 ms                 | 82.864 ms                 |
| BlockToStepN              | 264.686 ms                | 470.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:11.720588 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 5] 300 steps, total: 41.219, sample: 0.726, forward: 0.864, backward: 0.741, update: 0.531
[proc 2] 300 steps, total: 41.219, sample: 0.781, forward: 0.836, backward: 0.690, update: 0.501
[proc 1] 300 steps, total: 41.219, sample: 0.749, forward: 0.823, backward: 0.676, update: 0.540
[proc 6] 300 steps, total: 41.219, sample: 0.717, forward: 0.848, backward: 0.750, update: 0.543
[proc 7] 300 steps, total: 41.219, sample: 0.735, forward: 0.804, backward: 0.790, update: 0.535
[proc 3] 300 steps, total: 41.219, sample: 0.769, forward: 0.803, backward: 0.701, update: 0.532
[proc 4] 300 steps, total: 41.219, sample: 0.769, forward: 0.833, backward: 0.738, update: 0.526
[proc 0] 300 steps, total: 41.219, sample: 0.861, forward: 0.792, backward: 0.735, update: 0.522
E20240119 01:15:12.239365 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1310
W20240119 01:15:12.564061 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240119 01:15:12.740154 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:15:13.241900 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=649
W20240119 01:15:13.564776 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240119 01:15:13.917662 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:15:14.241958 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1969
W20240119 01:15:14.564036 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240119 01:15:15.166764 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:15.241010 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=4143
W20240119 01:15:15.564604 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.446 ms                  | 55.415 ms                 |
| Forward                   | 8.277 ms                  | 13.090 ms                 |
| Backward                  | 7.111 ms                  | 12.286 ms                 |
| Optimize                  | 5.336 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 58.896 ms                 |
| AfterBackward             | 51.912 ms                 | 82.909 ms                 |
| BlockToStepN              | 263.949 ms                | 471.058 ms                |
| OneStep                   | 364.906 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:16.197691 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:15:16.241020 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4806
W20240119 01:15:16.564354 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.283 ms                 | 15.779 ms                 |
| ProcessBack:UpdateCache   | 8.027 ms                  | 15.392 ms                 |
| ProcessBack:UpsertPq      | 27.831 ms                 | 50.356 ms                 |
| ProcessOneStep            | 51.866 ms                 | 82.864 ms                 |
| BlockToStepN              | 264.686 ms                | 476.141 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:17.198518 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:15:17.241031 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=794
W20240119 01:15:17.599850 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240119 01:15:18.242274 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1642
W20240119 01:15:18.252975 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:15:18.599385 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=316, pq.top=316
E20240119 01:15:19.242019 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1946
W20240119 01:15:19.279078 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 01:15:19.599210 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=318
E20240119 01:15:20.242012 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4417
W20240119 01:15:20.285820 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 01:15:20.636691 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.446 ms                  | 55.415 ms                 |
| Forward                   | 8.277 ms                  | 13.090 ms                 |
| Backward                  | 7.111 ms                  | 12.286 ms                 |
| Optimize                  | 5.344 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 58.896 ms                 |
| AfterBackward             | 51.975 ms                 | 87.144 ms                 |
| BlockToStepN              | 267.088 ms                | 476.292 ms                |
| OneStep                   | 370.598 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:21.243183 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1492
W20240119 01:15:21.347693 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:15:21.636386 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.350 ms                 | 15.779 ms                 |
| ProcessBack:UpdateCache   | 8.038 ms                  | 15.392 ms                 |
| ProcessBack:UpsertPq      | 28.014 ms                 | 52.143 ms                 |
| ProcessOneStep            | 51.936 ms                 | 87.100 ms                 |
| BlockToStepN              | 266.954 ms                | 476.141 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:22.244315 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1995
W20240119 01:15:22.370070 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 01:15:22.636529 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
E20240119 01:15:23.257907 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1916
W20240119 01:15:23.373939 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:15:23.637055 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
E20240119 01:15:24.257771 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=4180
W20240119 01:15:24.385396 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:15:24.637035 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240119 01:15:25.257020 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=3728
W20240119 01:15:25.637421 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240119 01:15:25.791949 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.448 ms                  | 55.415 ms                 |
| Forward                   | 8.296 ms                  | 13.090 ms                 |
| Backward                  | 7.114 ms                  | 12.286 ms                 |
| Optimize                  | 5.349 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.139 ms                  | 58.896 ms                 |
| AfterBackward             | 52.010 ms                 | 87.144 ms                 |
| BlockToStepN              | 267.920 ms                | 498.129 ms                |
| OneStep                   | 375.543 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:26.272861 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1894
W20240119 01:15:26.637229 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.508 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.035 ms                  | 15.210 ms                 |
| ProcessBack:UpsertPq      | 28.116 ms                 | 51.349 ms                 |
| ProcessOneStep            | 51.936 ms                 | 87.100 ms                 |
| BlockToStepN              | 267.782 ms                | 497.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:26.804519 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:15:27.276314 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2181
W20240119 01:15:27.637209 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240119 01:15:27.818522 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:15:28.276007 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4243
W20240119 01:15:28.688661 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240119 01:15:29.065074 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:29.277004 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=602
W20240119 01:15:29.688496 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240119 01:15:30.079492 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:15:30.276105 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=569
W20240119 01:15:30.688769 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=342, pq.top=342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 55.415 ms                 |
| Forward                   | 8.301 ms                  | 13.090 ms                 |
| Backward                  | 7.111 ms                  | 12.286 ms                 |
| Optimize                  | 5.359 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 60.044 ms                 |
| AfterBackward             | 52.030 ms                 | 87.144 ms                 |
| BlockToStepN              | 268.738 ms                | 498.129 ms                |
| OneStep                   | 376.766 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:31.260010 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:15:31.276825 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4267
W20240119 01:15:31.688971 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=344, pq.top=344
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.549 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.052 ms                  | 15.210 ms                 |
| ProcessBack:UpsertPq      | 28.287 ms                 | 55.267 ms                 |
| ProcessOneStep            | 51.977 ms                 | 87.100 ms                 |
| BlockToStepN              | 268.941 ms                | 497.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:32.269368 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:15:32.276010 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=851
W20240119 01:15:32.688467 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=347
E20240119 01:15:33.277614 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1373
W20240119 01:15:33.437733 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:15:33.688133 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240119 01:15:34.278400 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4337
W20240119 01:15:34.640079 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 01:15:34.765770 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=352, pq.top=352
E20240119 01:15:35.279079 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=342
W20240119 01:15:35.690901 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:15:35.770555 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=354, pq.top=354
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 54.413 ms                 |
| Forward                   | 8.277 ms                  | 12.972 ms                 |
| Backward                  | 7.102 ms                  | 11.245 ms                 |
| Optimize                  | 5.381 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 5.794 ms                  | 58.896 ms                 |
| AfterBackward             | 52.095 ms                 | 84.537 ms                 |
| BlockToStepN              | 272.549 ms                | 476.292 ms                |
| OneStep                   | 377.883 ms                | 595.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:36.279008 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4039
W20240119 01:15:36.691607 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.549 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.038 ms                  | 15.210 ms                 |
| ProcessBack:UpsertPq      | 28.372 ms                 | 55.267 ms                 |
| ProcessOneStep            | 52.073 ms                 | 84.475 ms                 |
| BlockToStepN              | 272.453 ms                | 476.141 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:36.770301 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=356, pq.top=356
E20240119 01:15:37.297524 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1209
W20240119 01:15:37.770128 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240119 01:15:37.799991 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:38.297010 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2873
W20240119 01:15:38.789175 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240119 01:15:38.809957 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:15:39.297451 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4569
W20240119 01:15:39.789405 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240119 01:15:39.877823 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:15:40.297009 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=4172
W20240119 01:15:40.789523 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240119 01:15:41.018177 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 54.413 ms                 |
| Forward                   | 8.269 ms                  | 12.972 ms                 |
| Backward                  | 7.096 ms                  | 11.245 ms                 |
| Optimize                  | 5.386 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 5.815 ms                  | 58.896 ms                 |
| AfterBackward             | 52.138 ms                 | 84.537 ms                 |
| BlockToStepN              | 276.330 ms                | 498.129 ms                |
| OneStep                   | 378.084 ms                | 617.065 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:41.300276 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1565
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.549 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.034 ms                  | 15.210 ms                 |
| ProcessBack:UpsertPq      | 28.384 ms                 | 55.267 ms                 |
| ProcessOneStep            | 52.103 ms                 | 84.475 ms                 |
| BlockToStepN              | 276.221 ms                | 497.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:41.789559 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240119 01:15:42.054445 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:15:42.310823 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=911
W20240119 01:15:42.789225 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240119 01:15:43.078001 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 01:15:43.310098 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1521
W20240119 01:15:43.789211 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240119 01:15:44.086302 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 01:15:44.330067 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1137
W20240119 01:15:44.789045 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240119 01:15:45.090029 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 01:15:45.330021 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=898
W20240119 01:15:45.789255 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 54.413 ms                 |
| Forward                   | 8.203 ms                  | 12.972 ms                 |
| Backward                  | 7.092 ms                  | 11.245 ms                 |
| Optimize                  | 5.381 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 58.896 ms                 |
| AfterBackward             | 52.178 ms                 | 84.537 ms                 |
| BlockToStepN              | 277.863 ms                | 525.724 ms                |
| OneStep                   | 379.536 ms                | 629.570 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:46.102604 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:15:46.330668 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1807
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.549 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 8.027 ms                  | 14.675 ms                 |
| ProcessBack:UpsertPq      | 28.384 ms                 | 54.949 ms                 |
| ProcessOneStep            | 52.141 ms                 | 84.475 ms                 |
| BlockToStepN              | 277.730 ms                | 525.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:46.789757 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240119 01:15:47.289299 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:15:47.331935 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=3702
W20240119 01:15:47.789811 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240119 01:15:48.370085 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1584
W20240119 01:15:48.502171 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:15:48.789670 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240119 01:15:49.370020 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2023
W20240119 01:15:49.506058 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:15:49.843245 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=384
E20240119 01:15:50.373546 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=302
W20240119 01:15:50.788869 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:15:50.907002 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 54.413 ms                 |
| Forward                   | 8.210 ms                  | 12.972 ms                 |
| Backward                  | 7.096 ms                  | 11.245 ms                 |
| Optimize                  | 5.359 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.066 ms                  | 58.896 ms                 |
| AfterBackward             | 52.178 ms                 | 84.537 ms                 |
| BlockToStepN              | 279.901 ms                | 527.659 ms                |
| OneStep                   | 381.924 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:15:51.373023 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=3435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.536 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 8.034 ms                  | 14.675 ms                 |
| ProcessBack:UpsertPq      | 28.393 ms                 | 54.949 ms                 |
| ProcessOneStep            | 52.145 ms                 | 84.475 ms                 |
| BlockToStepN              | 279.787 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:51.805074 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 01:15:51.906949 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=388, pq.top=388
E20240119 01:15:52.373030 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1288
W20240119 01:15:52.907255 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240119 01:15:53.053104 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:15:53.374745 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1320
W20240119 01:15:53.908123 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
W20240119 01:15:54.058982 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:15:54.374009 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4120
W20240119 01:15:54.924018 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240119 01:15:55.181496 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:15:55.401798 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=890
W20240119 01:15:55.924098 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.455 ms                  | 54.413 ms                 |
| Forward                   | 8.246 ms                  | 12.972 ms                 |
| Backward                  | 7.095 ms                  | 11.245 ms                 |
| Optimize                  | 5.370 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.000 ms                  | 58.896 ms                 |
| AfterBackward             | 52.197 ms                 | 84.537 ms                 |
| BlockToStepN              | 280.780 ms                | 527.659 ms                |
| OneStep                   | 383.332 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:56.260422 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:15:56.401021 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=601
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.579 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 8.038 ms                  | 14.675 ms                 |
| ProcessBack:UpsertPq      | 28.480 ms                 | 54.949 ms                 |
| ProcessOneStep            | 52.161 ms                 | 84.475 ms                 |
| BlockToStepN              | 280.682 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:15:56.924015 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=399, pq.top=399
W20240119 01:15:57.269516 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 01:15:57.410158 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=816
[proc 2] 400 steps, total: 45.754, sample: 0.673, forward: 0.856, backward: 0.669, update: 0.515
[proc 7] 400 steps, total: 45.754, sample: 0.750, forward: 0.784, backward: 0.756, update: 0.503
[proc 6] 400 steps, total: 45.754, sample: 0.735, forward: 0.816, backward: 0.720, update: 0.510
[proc 1] 400 steps, total: 45.754, sample: 0.664, forward: 0.827, backward: 0.679, update: 0.529
[proc 3] 400 steps, total: 45.754, sample: 0.754, forward: 0.853, backward: 0.733, update: 0.539
[proc 5] 400 steps, total: 45.754, sample: 0.716, forward: 0.831, backward: 0.699, update: 0.520
[proc 4] 400 steps, total: 45.754, sample: 0.779, forward: 0.803, backward: 0.735, update: 0.526
[proc 0] 400 steps, total: 45.754, sample: 0.798, forward: 0.814, backward: 0.705, update: 0.557
W20240119 01:15:57.924221 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240119 01:15:58.424646 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=757
W20240119 01:15:58.696074 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:15:58.924153 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240119 01:15:59.424176 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1140
W20240119 01:15:59.924168 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240119 01:15:59.954175 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:16:00.425252 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2200
W20240119 01:16:00.959668 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=408
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.455 ms                  | 55.473 ms                 |
| Forward                   | 8.251 ms                  | 13.090 ms                 |
| Backward                  | 7.092 ms                  | 11.245 ms                 |
| Optimize                  | 5.372 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.066 ms                  | 58.896 ms                 |
| AfterBackward             | 52.230 ms                 | 84.537 ms                 |
| BlockToStepN              | 282.525 ms                | 527.659 ms                |
| OneStep                   | 386.630 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:01.279136 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:16:01.425014 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=587
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.624 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.038 ms                  | 14.675 ms                 |
| ProcessBack:UpsertPq      | 28.562 ms                 | 54.949 ms                 |
| ProcessOneStep            | 52.176 ms                 | 84.475 ms                 |
| BlockToStepN              | 282.392 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:01.959508 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240119 01:16:02.288113 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:16:02.425626 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=614
W20240119 01:16:02.959677 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=412, pq.top=412
E20240119 01:16:03.452858 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2038
W20240119 01:16:03.465813 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:16:03.979504 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=415, pq.top=415
E20240119 01:16:04.457465 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240119 01:16:04.471395 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:16:04.979813 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240119 01:16:05.461741 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1573
W20240119 01:16:05.637881 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:16:05.979801 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.466 ms                  | 55.473 ms                 |
| Forward                   | 8.243 ms                  | 13.090 ms                 |
| Backward                  | 7.090 ms                  | 11.245 ms                 |
| Optimize                  | 5.381 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 66.032 ms                 |
| AfterBackward             | 52.154 ms                 | 84.537 ms                 |
| BlockToStepN              | 283.130 ms                | 527.659 ms                |
| OneStep                   | 387.367 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 01:16:06.463817 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.624 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 8.030 ms                  | 14.675 ms                 |
| ProcessBack:UpsertPq      | 28.562 ms                 | 54.949 ms                 |
| ProcessOneStep            | 52.096 ms                 | 84.475 ms                 |
| BlockToStepN              | 282.998 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:06.902061 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 01:16:06.979791 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=422, pq.top=422
E20240119 01:16:07.463963 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=231
W20240119 01:16:07.902724 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:16:07.979303 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=424
E20240119 01:16:08.474176 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2212
W20240119 01:16:08.979241 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240119 01:16:09.049371 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 01:16:09.478204 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1939
W20240119 01:16:10.052743 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240119 01:16:10.069880 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 01:16:10.478013 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.468 ms                  | 55.473 ms                 |
| Forward                   | 8.243 ms                  | 13.090 ms                 |
| Backward                  | 7.086 ms                  | 11.245 ms                 |
| Optimize                  | 5.382 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 66.032 ms                 |
| AfterBackward             | 52.127 ms                 | 84.537 ms                 |
| BlockToStepN              | 284.099 ms                | 527.659 ms                |
| OneStep                   | 392.104 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:11.074443 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:16:11.160104 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240119 01:16:11.493088 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1706
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.624 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 8.001 ms                  | 14.536 ms                 |
| ProcessBack:UpsertPq      | 28.530 ms                 | 54.519 ms                 |
| ProcessOneStep            | 52.079 ms                 | 84.475 ms                 |
| BlockToStepN              | 287.450 ms                | 544.018 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:12.082865 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:16:12.160933 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240119 01:16:12.497777 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2428
W20240119 01:16:13.160684 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240119 01:16:13.272395 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 01:16:13.497015 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1103
W20240119 01:16:14.160554 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240119 01:16:14.275923 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 01:16:14.497066 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1602
W20240119 01:16:15.160856 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240119 01:16:15.377837 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:16:15.513866 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.463 ms                  | 55.473 ms                 |
| Forward                   | 8.243 ms                  | 13.090 ms                 |
| Backward                  | 7.086 ms                  | 11.245 ms                 |
| Optimize                  | 5.373 ms                  | 11.155 ms                 |
| BarrierTimeBeforeRank0    | 6.118 ms                  | 66.032 ms                 |
| AfterBackward             | 52.050 ms                 | 84.537 ms                 |
| BlockToStepN              | 287.767 ms                | 544.201 ms                |
| OneStep                   | 392.570 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:16.160034 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=442, pq.top=442
W20240119 01:16:16.384932 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 01:16:16.513016 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1482
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.579 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 7.993 ms                  | 14.536 ms                 |
| ProcessBack:UpsertPq      | 28.421 ms                 | 54.519 ms                 |
| ProcessOneStep            | 51.977 ms                 | 84.475 ms                 |
| BlockToStepN              | 287.584 ms                | 544.018 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:17.160616 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=444, pq.top=444
E20240119 01:16:17.513033 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1504
W20240119 01:16:17.570883 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:16:18.160732 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240119 01:16:18.521562 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240119 01:16:18.895094 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:16:19.160540 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
E20240119 01:16:19.521083 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4605
W20240119 01:16:19.903712 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 01:16:20.161036 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240119 01:16:20.521507 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.454 ms                  | 55.415 ms                 |
| Forward                   | 8.269 ms                  | 12.972 ms                 |
| Backward                  | 7.092 ms                  | 10.894 ms                 |
| Optimize                  | 5.372 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.118 ms                  | 60.044 ms                 |
| AfterBackward             | 52.026 ms                 | 82.909 ms                 |
| BlockToStepN              | 288.602 ms                | 527.659 ms                |
| OneStep                   | 392.721 ms                | 649.964 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:21.109256 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:16:21.227700 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=454
E20240119 01:16:21.522995 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1631
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.524 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 7.993 ms                  | 14.536 ms                 |
| ProcessBack:UpsertPq      | 28.287 ms                 | 54.519 ms                 |
| ProcessOneStep            | 51.967 ms                 | 82.864 ms                 |
| BlockToStepN              | 288.481 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:22.115023 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 01:16:22.227417 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=456
E20240119 01:16:22.522024 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1749
W20240119 01:16:23.195784 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 01:16:23.310786 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240119 01:16:23.522035 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1512
W20240119 01:16:24.311108 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240119 01:16:24.496641 28153 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 01:16:24.522042 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4211
W20240119 01:16:25.311530 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=462
E20240119 01:16:25.522022 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1818
W20240119 01:16:25.574205 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.454 ms                  | 55.415 ms                 |
| Forward                   | 8.246 ms                  | 12.972 ms                 |
| Backward                  | 7.092 ms                  | 10.894 ms                 |
| Optimize                  | 5.370 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.175 ms                  | 60.044 ms                 |
| AfterBackward             | 51.975 ms                 | 82.909 ms                 |
| BlockToStepN              | 291.526 ms                | 527.659 ms                |
| OneStep                   | 395.456 ms                | 649.964 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:26.311656 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240119 01:16:26.522009 27668 parallel_pq_v2.h:76] insert failed, size(hashtable)=4253
W20240119 01:16:26.593297 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.523 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 7.997 ms                  | 14.536 ms                 |
| ProcessBack:UpsertPq      | 28.287 ms                 | 54.519 ms                 |
| ProcessOneStep            | 51.936 ms                 | 82.864 ms                 |
| BlockToStepN              | 293.002 ms                | 527.504 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:27.311913 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240119 01:16:27.522012 27221 parallel_pq_v2.h:76] insert failed, size(hashtable)=3733
W20240119 01:16:28.083581 28153 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 01:16:28.311710 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
E20240119 01:16:28.539386 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2197
W20240119 01:16:29.103121 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 01:16:29.311522 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=470, pq.top=470
E20240119 01:16:29.539670 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2210
W20240119 01:16:30.121732 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 01:16:30.311511 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=472, pq.top=472
E20240119 01:16:30.539024 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=684
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.453 ms                  | 55.415 ms                 |
| Forward                   | 8.210 ms                  | 12.972 ms                 |
| Backward                  | 7.092 ms                  | 10.894 ms                 |
| Optimize                  | 5.370 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.395 ms                  | 60.044 ms                 |
| AfterBackward             | 52.010 ms                 | 82.909 ms                 |
| BlockToStepN              | 293.503 ms                | 534.813 ms                |
| OneStep                   | 396.367 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:31.210479 28153 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 01:16:31.359591 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
E20240119 01:16:31.539065 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=959
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.524 ms                 | 14.568 ms                 |
| ProcessBack:UpdateCache   | 7.990 ms                  | 14.536 ms                 |
| ProcessBack:UpsertPq      | 28.287 ms                 | 54.519 ms                 |
| ProcessOneStep            | 51.967 ms                 | 82.864 ms                 |
| BlockToStepN              | 293.207 ms                | 534.690 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:32.242170 28153 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 01:16:32.360023 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240119 01:16:32.571399 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1805
W20240119 01:16:33.361352 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240119 01:16:33.397794 28153 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 01:16:33.573376 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1004
W20240119 01:16:34.362092 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
E20240119 01:16:34.573009 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2081
W20240119 01:16:34.579319 28153 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 01:16:35.362218 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=484
E20240119 01:16:35.581714 28153 parallel_pq_v2.h:76] insert failed, size(hashtable)=516
W20240119 01:16:35.982534 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.462 ms                  | 55.602 ms                 |
| Forward                   | 8.251 ms                  | 12.972 ms                 |
| Backward                  | 7.090 ms                  | 10.894 ms                 |
| Optimize                  | 5.386 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.139 ms                  | 60.044 ms                 |
| AfterBackward             | 52.079 ms                 | 82.909 ms                 |
| BlockToStepN              | 294.241 ms                | 534.813 ms                |
| OneStep                   | 397.051 ms                | 650.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:36.465862 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=487, pq.top=487
E20240119 01:16:36.581032 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=679
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.584 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 7.998 ms                  | 14.423 ms                 |
| ProcessBack:UpsertPq      | 28.448 ms                 | 54.354 ms                 |
| ProcessOneStep            | 52.038 ms                 | 82.864 ms                 |
| BlockToStepN              | 294.015 ms                | 534.690 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:37.311031 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:16:37.465662 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=489, pq.top=489
E20240119 01:16:37.581691 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1518
W20240119 01:16:38.466064 28153 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 01:16:38.577818 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=492, pq.top=492
E20240119 01:16:38.581923 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=359
W20240119 01:16:39.578198 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
E20240119 01:16:39.618196 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1536
W20240119 01:16:39.779330 28153 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 01:16:40.579025 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240119 01:16:40.619091 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=1177
W20240119 01:16:40.796042 28153 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.467 ms                  | 56.738 ms                 |
| Forward                   | 8.251 ms                  | 12.972 ms                 |
| Backward                  | 7.092 ms                  | 10.894 ms                 |
| Optimize                  | 5.382 ms                  | 11.123 ms                 |
| BarrierTimeBeforeRank0    | 6.139 ms                  | 60.044 ms                 |
| AfterBackward             | 52.050 ms                 | 82.909 ms                 |
| BlockToStepN              | 294.242 ms                | 544.201 ms                |
| OneStep                   | 397.282 ms                | 663.073 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:41.579033 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240119 01:16:41.619011 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=4424
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.565 ms                 | 14.525 ms                 |
| ProcessBack:UpdateCache   | 8.000 ms                  | 14.423 ms                 |
| ProcessBack:UpsertPq      | 28.408 ms                 | 54.354 ms                 |
| ProcessOneStep            | 51.977 ms                 | 82.864 ms                 |
| BlockToStepN              | 294.131 ms                | 544.018 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 01:16:42.141089 28153 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 01:16:42.581351 27221 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240119 01:16:42.619031 28152 parallel_pq_v2.h:76] insert failed, size(hashtable)=575
[proc 7] 500 steps, total: 45.125, sample: 0.682, forward: 0.761, backward: 0.755, update: 0.514
[proc 0] 500 steps, total: 45.125, sample: 0.938, forward: 0.802, backward: 0.696, update: 0.567
[proc 6] 500 steps, total: 45.125, sample: 0.808, forward: 0.825, backward: 0.721, update: 0.536
[proc 2] 500 steps, total: 45.125, sample: 0.754, forward: 0.823, backward: 0.647, update: 0.510
[proc 5] 500 steps, total: 45.125, sample: 0.811, forward: 0.884, backward: 0.725, update: 0.564
[proc 4] 500 steps, total: 45.125, sample: 0.802, forward: 0.822, backward: 0.723, update: 0.543
[proc 3] 500 steps, total: 45.125, sample: 0.789, forward: 0.852, backward: 0.720, update: 0.552
[proc 1] 500 steps, total: 45.125, sample: 0.720, forward: 0.839, backward: 0.698, update: 0.532
Successfully xmh. training takes 194.9095766544342 seconds
before call kg_cache_controller.StopThreads()
W20240119 01:16:42.821138 27221 grad_async_v2.h:71] call StopThreads. PID = 26569
W20240119 01:16:42.821174 27221 grad_base.h:210] before processOneStepNegThread_.join();
W20240119 01:16:42.821529 27221 grad_base.h:212] after processOneStepNegThread_.join();
W20240119 01:16:42.821540 27221 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240119 01:16:42.841219 27221 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f9661b04550>
