WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 14:58:32.780702 60370 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_Freebase_14', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [60370 sampler.py:454] Start PreSampling
WARNING [60370 sampler.py:532] Before construct renumbering_dict
WARNING [60370 sampler.py:555] PreSampling done
W20240125 15:29:25.593533 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 15:29:25.593873 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 15:29:25.593942 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 15:29:25.593987 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 15:29:25.594027 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 15:29:25.594064 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 15:29:25.594106 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 15:29:25.594152 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 15:29:25.594187 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 15:29:25.594223 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 15:29:25.594272 60370 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 15:29:25.594305 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 15:29:25.594342 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 15:29:25.594574 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 15:29:25.594630 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 15:29:25.594663 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 15:29:25.594724 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 15:29:25.594759 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 15:29:25.594794 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 15:29:25.594821 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 15:29:25.594849 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 15:29:25.594885 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 15:29:25.594931 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 15:29:25.594964 60370 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 15:29:25.594991 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 15:29:25.595023 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 15:29:25.595116 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 15:29:25.595155 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 15:29:25.595187 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 15:29:25.595225 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 15:29:25.595253 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 15:29:25.595296 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 15:29:25.595335 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 15:29:25.595363 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 15:29:25.595393 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 15:29:25.595435 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 15:29:25.595471 60370 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 15:29:25.595502 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 15:29:25.595532 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 15:29:25.595640 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 15:29:25.595698 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 15:29:25.595733 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 15:29:25.595767 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 15:29:25.595803 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 15:29:25.595836 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 15:29:25.595871 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 15:29:25.595907 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 15:29:25.595949 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 15:29:25.595985 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 15:29:25.596014 60370 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 15:29:25.596041 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 15:29:25.596064 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 15:29:25.596148 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 15:29:25.596220 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 15:29:25.596262 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 15:29:25.596293 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 15:29:25.596335 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 15:29:25.596371 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 15:29:25.596410 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 15:29:25.596447 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 15:29:25.596478 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 15:29:25.596513 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 15:29:25.596544 60370 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 15:29:25.596568 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 15:29:25.596599 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 15:29:25.596671 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 15:29:25.596719 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 15:29:25.596758 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 15:29:25.596804 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 15:29:25.596861 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 15:29:25.596894 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 15:29:25.596933 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 15:29:25.596989 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 15:29:25.597024 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 15:29:25.597064 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 15:29:25.597096 60370 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 15:29:25.597122 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 15:29:25.597148 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 15:29:25.597226 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 15:29:25.597290 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 15:29:25.597326 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 15:29:25.597368 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 15:29:25.597410 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 15:29:25.597455 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 15:29:25.597489 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 15:29:25.597532 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 15:29:25.597561 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 15:29:25.597595 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 15:29:25.597630 60370 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 15:29:25.597676 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 15:29:25.597700 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 15:29:25.597783 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 15:29:25.597831 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 15:29:25.597867 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 15:29:25.597900 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 15:29:25.597934 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 15:29:25.597966 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 15:29:25.598004 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 15:29:25.598038 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 15:29:25.598075 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 15:29:25.598109 60370 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 15:29:25.598145 60370 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 15:29:25.598170 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 15:29:25.598194 60370 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 15:29:26.519577 60370 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 15:29:26.519883 60370 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302795,  4302843,  4302888,  ..., 63227822, 22186575, 23998370]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2577.258 seconds
[Rank1] pid = 64583
[Rank2] pid = 64697
[Rank3] pid = 64858
[Rank4] pid = 65054
[Rank5] pid = 65249
[Rank6] pid = 65447
INFO [60370 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [64583 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [64697 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [64858 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [65054 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [514 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [65249 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [65447 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [514 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65249 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65447 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64858 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65054 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64697 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60370 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64583 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [60370 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [64858 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [65447 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [514 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [65249 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [65054 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [64583 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [64697 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 15:42:04.209865 64698 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210031 64877 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210134 65078 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210240 65457 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210335   547 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210418   529 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.210516 65269 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:04.211042 64584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 15:42:16.194991   547 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 15:42:17.146086 65269 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:19.529740 64698 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:19.927145 65457 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:20.976094 64584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:21.253504 64877 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:22.564301   529 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 15:42:23.592470 65078 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.671 ms                 | 28.671 ms                 |
| bucket keys               | 224.862 ms                | 224.862 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.715 ms                 | 28.671 ms                 |
| bucket keys               | 3.000 ms                  | 224.862 ms                |
| forward: a2a keys         | 16.423 ms                 | 1.891 s                   |
| forward: search cache     | 507.366 us                | 34.907 ms                 |
| forward: a2a values       | 8.285 ms                  | 54.343 ms                 |
| forward: join             | 3.484 ms                  | 4.507 ms                  |
| Forward                   | 109.698 ms                | 2.827 s                   |
| back: aggr dram keys      | 56.671 ms                 | 1.086 s                   |
| back: set dram grad       | 4.003 ms                  | 11.112 ms                 |
| back: a2a grad            | 21.009 ms                 | 56.340 ms                 |
| back: grad sum & grad cache  | 8.808 ms                  | 285.529 ms                |
| Backward                  | 413.534 ms                | 1.731 s                   |
| Optimize                  | 33.758 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 68.738 us                 | 178.739 us                |
| BlockToStepN              | 177.988 us                | 507.973 us                |
| OneStep                   | 567.066 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.038 ms                 | 430.489 ms                |
| bucket keys               | 2.885 ms                  | 224.862 ms                |
| forward: a2a keys         | 10.202 ms                 | 1.891 s                   |
| forward: search cache     | 503.364 us                | 34.907 ms                 |
| forward: a2a values       | 8.285 ms                  | 54.343 ms                 |
| forward: join             | 3.413 ms                  | 4.507 ms                  |
| Forward                   | 82.791 ms                 | 2.827 s                   |
| back: aggr dram keys      | 74.766 ms                 | 1.086 s                   |
| back: set dram grad       | 4.003 ms                  | 11.112 ms                 |
| back: a2a grad            | 30.078 ms                 | 59.711 ms                 |
| back: grad sum & grad cache  | 8.808 ms                  | 285.529 ms                |
| Backward                  | 410.593 ms                | 1.731 s                   |
| Optimize                  | 34.084 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 74.592 us                 | 178.739 us                |
| BlockToStepN              | 101.405 us                | 507.973 us                |
| OneStep                   | 537.866 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.189 ms                  | 430.489 ms                |
| bucket keys               | 2.842 ms                  | 224.862 ms                |
| forward: a2a keys         | 6.074 ms                  | 1.891 s                   |
| forward: search cache     | 489.524 us                | 34.907 ms                 |
| forward: a2a values       | 8.285 ms                  | 63.566 ms                 |
| forward: join             | 3.344 ms                  | 4.507 ms                  |
| Forward                   | 77.357 ms                 | 2.827 s                   |
| back: aggr dram keys      | 77.697 ms                 | 1.086 s                   |
| back: set dram grad       | 4.003 ms                  | 11.112 ms                 |
| back: a2a grad            | 30.078 ms                 | 71.789 ms                 |
| back: grad sum & grad cache  | 8.808 ms                  | 285.529 ms                |
| Backward                  | 438.268 ms                | 1.731 s                   |
| Optimize                  | 40.514 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 74.592 us                 | 178.739 us                |
| BlockToStepN              | 90.991 us                 | 507.973 us                |
| OneStep                   | 566.296 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.359 ms                  | 430.489 ms                |
| bucket keys               | 2.842 ms                  | 3.230 ms                  |
| forward: a2a keys         | 5.008 ms                  | 70.014 ms                 |
| forward: search cache     | 493.299 us                | 533.920 us                |
| forward: a2a values       | 8.285 ms                  | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 77.357 ms                 | 2.827 s                   |
| back: aggr dram keys      | 77.697 ms                 | 214.074 ms                |
| back: set dram grad       | 4.003 ms                  | 10.470 ms                 |
| back: a2a grad            | 30.613 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 8.808 ms                  | 227.642 ms                |
| Backward                  | 439.193 ms                | 1.731 s                   |
| Optimize                  | 33.952 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 72.091 us                 | 178.739 us                |
| BlockToStepN              | 92.313 us                 | 17.892 ms                 |
| OneStep                   | 567.066 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.340 ms                  | 430.489 ms                |
| bucket keys               | 2.832 ms                  | 3.230 ms                  |
| forward: a2a keys         | 4.901 ms                  | 70.014 ms                 |
| forward: search cache     | 490.800 us                | 557.807 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 77.350 ms                 | 2.827 s                   |
| back: aggr dram keys      | 77.697 ms                 | 214.074 ms                |
| back: set dram grad       | 4.003 ms                  | 10.755 ms                 |
| back: a2a grad            | 30.810 ms                 | 94.103 ms                 |
| back: grad sum & grad cache  | 9.182 ms                  | 281.416 ms                |
| Backward                  | 451.279 ms                | 1.731 s                   |
| Optimize                  | 34.084 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 71.236 us                 | 178.739 us                |
| BlockToStepN              | 92.353 us                 | 34.330 ms                 |
| OneStep                   | 570.493 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.232 ms                  | 430.489 ms                |
| bucket keys               | 2.808 ms                  | 3.230 ms                  |
| forward: a2a keys         | 4.728 ms                  | 70.014 ms                 |
| forward: search cache     | 490.800 us                | 563.881 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 77.350 ms                 | 2.827 s                   |
| back: aggr dram keys      | 82.108 ms                 | 214.074 ms                |
| back: set dram grad       | 4.003 ms                  | 10.802 ms                 |
| back: a2a grad            | 30.943 ms                 | 94.103 ms                 |
| back: grad sum & grad cache  | 9.182 ms                  | 281.416 ms                |
| Backward                  | 451.279 ms                | 1.731 s                   |
| Optimize                  | 34.594 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 68.738 us                 | 178.739 us                |
| BlockToStepN              | 92.353 us                 | 34.330 ms                 |
| OneStep                   | 579.840 ms                | 4.670 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.440 ms                  | 395.367 ms                |
| bucket keys               | 2.808 ms                  | 3.294 ms                  |
| forward: a2a keys         | 4.795 ms                  | 70.014 ms                 |
| forward: search cache     | 492.277 us                | 760.064 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 77.019 ms                 | 133.965 ms                |
| back: aggr dram keys      | 82.108 ms                 | 214.074 ms                |
| back: set dram grad       | 4.003 ms                  | 11.208 ms                 |
| back: a2a grad            | 30.943 ms                 | 94.103 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 281.416 ms                |
| Backward                  | 449.757 ms                | 523.583 ms                |
| Optimize                  | 34.537 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 68.738 us                 | 116.849 us                |
| BlockToStepN              | 93.055 us                 | 34.330 ms                 |
| OneStep                   | 579.840 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.522 ms                  | 395.367 ms                |
| bucket keys               | 2.808 ms                  | 3.294 ms                  |
| forward: a2a keys         | 5.001 ms                  | 189.414 ms                |
| forward: search cache     | 492.277 us                | 760.064 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 77.019 ms                 | 253.154 ms                |
| back: aggr dram keys      | 82.108 ms                 | 214.074 ms                |
| back: set dram grad       | 4.003 ms                  | 11.208 ms                 |
| back: a2a grad            | 30.943 ms                 | 94.103 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 281.416 ms                |
| Backward                  | 444.413 ms                | 523.583 ms                |
| Optimize                  | 34.228 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 68.216 us                 | 116.849 us                |
| BlockToStepN              | 95.270 us                 | 34.330 ms                 |
| OneStep                   | 579.840 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.584 ms                  | 395.367 ms                |
| bucket keys               | 2.808 ms                  | 7.015 ms                  |
| forward: a2a keys         | 4.901 ms                  | 189.414 ms                |
| forward: search cache     | 492.634 us                | 760.064 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.094 ms                  |
| Forward                   | 75.551 ms                 | 253.154 ms                |
| back: aggr dram keys      | 82.108 ms                 | 214.074 ms                |
| back: set dram grad       | 4.159 ms                  | 11.395 ms                 |
| back: a2a grad            | 30.943 ms                 | 94.103 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 281.416 ms                |
| Backward                  | 442.262 ms                | 567.471 ms                |
| Optimize                  | 34.471 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 60.510 us                 | 116.849 us                |
| BlockToStepN              | 94.988 us                 | 34.330 ms                 |
| OneStep                   | 572.372 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.640 ms                  | 395.367 ms                |
| bucket keys               | 2.808 ms                  | 3.294 ms                  |
| forward: a2a keys         | 4.740 ms                  | 189.414 ms                |
| forward: search cache     | 493.767 us                | 636.038 us                |
| forward: a2a values       | 21.531 ms                 | 54.343 ms                 |
| forward: join             | 3.344 ms                  | 4.071 ms                  |
| Forward                   | 75.551 ms                 | 254.397 ms                |
| back: aggr dram keys      | 105.228 ms                | 202.559 ms                |
| back: set dram grad       | 4.159 ms                  | 11.208 ms                 |
| back: a2a grad            | 30.810 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 234.694 ms                |
| Backward                  | 444.413 ms                | 567.471 ms                |
| Optimize                  | 34.351 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 58.312 us                 | 116.849 us                |
| BlockToStepN              | 93.858 us                 | 34.330 ms                 |
| OneStep                   | 572.372 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.584 ms                  | 395.367 ms                |
| bucket keys               | 2.774 ms                  | 3.294 ms                  |
| forward: a2a keys         | 4.585 ms                  | 189.414 ms                |
| forward: search cache     | 494.054 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 56.125 ms                 |
| forward: join             | 3.344 ms                  | 4.071 ms                  |
| Forward                   | 75.342 ms                 | 254.397 ms                |
| back: aggr dram keys      | 106.590 ms                | 202.559 ms                |
| back: set dram grad       | 8.568 ms                  | 11.898 ms                 |
| back: a2a grad            | 30.876 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 234.694 ms                |
| Backward                  | 445.532 ms                | 591.638 ms                |
| Optimize                  | 34.228 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 58.312 us                 | 116.849 us                |
| BlockToStepN              | 93.055 us                 | 37.510 ms                 |
| OneStep                   | 576.374 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.359 ms                  | 395.367 ms                |
| bucket keys               | 2.743 ms                  | 3.294 ms                  |
| forward: a2a keys         | 4.694 ms                  | 189.414 ms                |
| forward: search cache     | 494.030 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 56.125 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 75.133 ms                 | 254.397 ms                |
| back: aggr dram keys      | 108.700 ms                | 202.559 ms                |
| back: set dram grad       | 8.619 ms                  | 11.906 ms                 |
| back: a2a grad            | 31.019 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 445.532 ms                | 630.042 ms                |
| Optimize                  | 34.346 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.509 us                 | 116.849 us                |
| BlockToStepN              | 93.055 us                 | 37.510 ms                 |
| OneStep                   | 580.284 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank7] pid = 514
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([  494375,    73021,   402027, 13107760,    73049,    73083,   494385,
           73126,    73180,    73220]) tensor([ 5304938,  9563985, 62382661, 63674561, 23359510,   436462, 21309616,
        63652948, 39898763, 39169919])
-------Step 1-------
tensor([  494375,    73021,   402027, 13107760,    73049,    73083,   494385,
           73126,    73180,    73220]) tensor([82520900, 35656466, 56995991, 39667841, 40652437, 14320100, 53809374,
          601448, 18713965, 34798361])
-------Step 2-------
tensor([   17336,   308622,   373271, 17624402,   188936,   188980,   189016,
          189058,   189081,   189114]) tensor([57500360, 24494000,  1486419, 22410405, 27554525, 18406905,  7676789,
        47172806, 72896482, 22974207])
-------Step 3-------
tensor([   17336,   308622,   373271, 17624402,   188936,   188980,   189016,
          189058,   189081,   189114]) tensor([23316624, 81810887, 75061109, 55403432, 83083465, 80108240, 80149233,
        29341133, 79558185, 12740708])
-------Step 4-------
tensor([  317210,   317228,   317241, 85608452,   317261,   317281,   317301,
          317315,   317341, 27775697]) tensor([75813147, 62918855, 58719550, 43248694,   144819,  4380226, 28559653,
        40923059, 74877464, 12365982])
-------Step 5-------
tensor([  317210,   317228,   317241, 85608452,   317261,   317281,   317301,
          317315,   317341, 27775697]) tensor([53347027, 50090980, 51031009,    16837, 71938999, 45242533, 36270077,
         1577857, 63473542, 39542526])
-------Step 6-------
tensor([ 7299740,  5764948,   358552, 41126549,   358577,   358593, 79332465,
        46196345,   358614,   358634]) tensor([30723374,   119767, 39602364, 15795801, 16592276, 44829734, 13734184,
        51201869, 68818838, 42925410])
-------Step 7-------
tensor([ 7299740,  5764948,   358552, 41126549,   358577,   358593, 79332465,
        46196345,   358614,   358634]) tensor([29802402, 10796504, 43246109,  9404608, 60986399, 44064026,  4320574,
        17713202, 45460800, 78207043])
-------Step 8-------
tensor([  396592,   396610, 80866048,   396640,   327951,   327970, 15608577,
          396659,   396678,   379090]) tensor([19952049, 37844116, 70968217,  5152311, 57968290,  6780368,  5903737,
        16411783, 51692455,  6337524])
-------Step 9-------
tensor([  396592,   396610, 80866048,   396640,   327951,   327970, 15608577,
          396659,   396678,   379090]) tensor([76988602, 24265375, 49172991, 60434358, 51482347, 71719783, 58292457,
        17216614, 19987496,  6887440])
before start barrier
start train
[proc 0] 100 steps, total: 66.015, sample: 2.535, forward: 11.286, backward: 46.850, update: 3.824
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 67.325, sample: 1.389, forward: 13.109, backward: 27.302, update: 0.464
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 69.049, sample: 3.285, forward: 11.206, backward: 27.436, update: 0.473
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 68.652, sample: 1.598, forward: 12.855, backward: 27.144, update: 0.458
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 64.987, sample: 1.702, forward: 12.772, backward: 27.110, update: 0.466
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 72.384, sample: 1.763, forward: 12.665, backward: 27.371, update: 0.441
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 71.433, sample: 1.827, forward: 12.636, backward: 27.090, update: 0.493
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 67.603, sample: 1.772, forward: 12.764, backward: 28.060, update: 0.426
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.992 ms                  | 395.367 ms                |
| bucket keys               | 2.744 ms                  | 3.294 ms                  |
| forward: a2a keys         | 4.513 ms                  | 189.414 ms                |
| forward: search cache     | 494.030 us                | 636.038 us                |
| forward: a2a values       | 24.654 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 75.133 ms                 | 254.397 ms                |
| back: aggr dram keys      | 108.700 ms                | 202.559 ms                |
| back: set dram grad       | 8.619 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.019 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 447.959 ms                | 630.042 ms                |
| Optimize                  | 34.380 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.054 us                 | 116.849 us                |
| BlockToStepN              | 94.251 us                 | 44.041 ms                 |
| OneStep                   | 588.425 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.525 ms                  | 395.367 ms                |
| bucket keys               | 2.744 ms                  | 7.015 ms                  |
| forward: a2a keys         | 4.394 ms                  | 189.414 ms                |
| forward: search cache     | 495.145 us                | 760.064 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 74.902 ms                 | 254.397 ms                |
| back: aggr dram keys      | 108.700 ms                | 202.559 ms                |
| back: set dram grad       | 8.619 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.019 ms                 | 89.734 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 444.413 ms                | 630.042 ms                |
| Optimize                  | 34.512 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.362 us                 | 116.849 us                |
| BlockToStepN              | 95.902 us                 | 44.041 ms                 |
| OneStep                   | 588.476 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.685 ms                  | 395.367 ms                |
| bucket keys               | 2.744 ms                  | 7.015 ms                  |
| forward: a2a keys         | 4.164 ms                  | 189.414 ms                |
| forward: search cache     | 495.172 us                | 760.064 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 72.050 ms                 | 254.397 ms                |
| back: aggr dram keys      | 106.590 ms                | 202.559 ms                |
| back: set dram grad       | 8.619 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.019 ms                 | 89.734 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 442.930 ms                | 630.042 ms                |
| Optimize                  | 34.471 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.509 us                 | 139.659 us                |
| BlockToStepN              | 95.285 us                 | 44.041 ms                 |
| OneStep                   | 580.284 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.009 ms                  | 395.367 ms                |
| bucket keys               | 2.763 ms                  | 3.352 ms                  |
| forward: a2a keys         | 4.010 ms                  | 167.602 ms                |
| forward: search cache     | 494.259 us                | 686.245 us                |
| forward: a2a values       | 24.632 ms                 | 63.566 ms                 |
| forward: join             | 3.319 ms                  | 4.009 ms                  |
| Forward                   | 71.951 ms                 | 254.397 ms                |
| back: aggr dram keys      | 104.331 ms                | 182.860 ms                |
| back: set dram grad       | 8.660 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.019 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 240.074 ms                |
| Backward                  | 440.694 ms                | 630.042 ms                |
| Optimize                  | 34.429 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.282 us                 | 139.659 us                |
| BlockToStepN              | 94.251 us                 | 44.041 ms                 |
| OneStep                   | 576.374 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.301 ms                  | 395.367 ms                |
| bucket keys               | 2.744 ms                  | 3.352 ms                  |
| forward: a2a keys         | 3.951 ms                  | 167.602 ms                |
| forward: search cache     | 494.272 us                | 686.245 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.009 ms                  |
| Forward                   | 71.951 ms                 | 254.397 ms                |
| back: aggr dram keys      | 104.331 ms                | 182.860 ms                |
| back: set dram grad       | 8.660 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.295 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 240.074 ms                |
| Backward                  | 441.479 ms                | 630.042 ms                |
| Optimize                  | 34.429 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.054 us                 | 139.659 us                |
| BlockToStepN              | 93.055 us                 | 44.041 ms                 |
| OneStep                   | 577.470 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.304 ms                  | 395.367 ms                |
| bucket keys               | 2.744 ms                  | 3.352 ms                  |
| forward: a2a keys         | 3.877 ms                  | 167.602 ms                |
| forward: search cache     | 493.767 us                | 686.245 us                |
| forward: a2a values       | 24.654 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 71.951 ms                 | 254.397 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.660 ms                  | 12.713 ms                 |
| back: a2a grad            | 31.347 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 243.630 ms                |
| Backward                  | 441.479 ms                | 630.042 ms                |
| Optimize                  | 34.389 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 56.874 us                 | 139.659 us                |
| BlockToStepN              | 92.582 us                 | 44.041 ms                 |
| OneStep                   | 576.374 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.332 ms                  | 389.345 ms                |
| bucket keys               | 2.743 ms                  | 3.352 ms                  |
| forward: a2a keys         | 3.829 ms                  | 167.602 ms                |
| forward: search cache     | 493.782 us                | 686.245 us                |
| forward: a2a values       | 24.654 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 71.003 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.692 ms                  | 14.536 ms                 |
| back: a2a grad            | 31.347 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 243.630 ms                |
| Backward                  | 441.564 ms                | 591.638 ms                |
| Optimize                  | 34.434 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.054 us                 | 116.849 us                |
| BlockToStepN              | 92.531 us                 | 37.510 ms                 |
| OneStep                   | 579.266 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.332 ms                  | 389.345 ms                |
| bucket keys               | 2.743 ms                  | 3.352 ms                  |
| forward: a2a keys         | 3.792 ms                  | 167.602 ms                |
| forward: search cache     | 493.782 us                | 686.245 us                |
| forward: a2a values       | 24.654 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 68.810 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.747 ms                  | 17.049 ms                 |
| back: a2a grad            | 31.295 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 442.930 ms                | 591.638 ms                |
| Optimize                  | 34.463 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.115 us                 | 139.659 us                |
| BlockToStepN              | 92.434 us                 | 37.510 ms                 |
| OneStep                   | 579.840 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.481 ms                  | 389.345 ms                |
| bucket keys               | 2.743 ms                  | 3.352 ms                  |
| forward: a2a keys         | 3.809 ms                  | 167.602 ms                |
| forward: search cache     | 493.698 us                | 686.245 us                |
| forward: a2a values       | 24.632 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 68.700 ms                 | 253.154 ms                |
| back: aggr dram keys      | 104.629 ms                | 182.860 ms                |
| back: set dram grad       | 8.866 ms                  | 18.479 ms                 |
| back: a2a grad            | 31.347 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 273.177 ms                |
| Backward                  | 445.286 ms                | 591.638 ms                |
| Optimize                  | 34.463 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.115 us                 | 139.659 us                |
| BlockToStepN              | 93.024 us                 | 44.041 ms                 |
| OneStep                   | 584.468 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.481 ms                  | 389.345 ms                |
| bucket keys               | 2.743 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.792 ms                  | 70.229 ms                 |
| forward: search cache     | 493.526 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 68.126 ms                 | 253.154 ms                |
| back: aggr dram keys      | 104.541 ms                | 182.856 ms                |
| back: set dram grad       | 8.849 ms                  | 17.867 ms                 |
| back: a2a grad            | 31.370 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 10.458 ms                 | 254.711 ms                |
| Backward                  | 445.286 ms                | 591.638 ms                |
| Optimize                  | 34.434 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.115 us                 | 139.659 us                |
| BlockToStepN              | 92.898 us                 | 44.041 ms                 |
| OneStep                   | 580.284 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.548 ms                  | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.757 ms                  | 70.229 ms                 |
| forward: search cache     | 493.368 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 67.759 ms                 | 253.154 ms                |
| back: aggr dram keys      | 104.541 ms                | 182.856 ms                |
| back: set dram grad       | 8.866 ms                  | 17.867 ms                 |
| back: a2a grad            | 31.370 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 254.711 ms                |
| Backward                  | 445.331 ms                | 591.638 ms                |
| Optimize                  | 34.434 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.237 us                 | 139.659 us                |
| BlockToStepN              | 92.531 us                 | 44.041 ms                 |
| OneStep                   | 580.284 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 389.345 ms                |
| bucket keys               | 2.743 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.785 ms                  | 70.229 ms                 |
| forward: search cache     | 493.368 us                | 636.038 us                |
| forward: a2a values       | 24.654 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 67.741 ms                 | 253.154 ms                |
| back: aggr dram keys      | 104.541 ms                | 182.856 ms                |
| back: set dram grad       | 8.866 ms                  | 17.867 ms                 |
| back: a2a grad            | 31.370 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 254.711 ms                |
| Backward                  | 445.532 ms                | 591.638 ms                |
| Optimize                  | 34.434 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.054 us                 | 139.659 us                |
| BlockToStepN              | 92.582 us                 | 44.041 ms                 |
| OneStep                   | 579.840 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 59.360, sample: 1.425, forward: 9.324, backward: 25.840, update: 0.408
[proc 6] 200 steps, total: 59.361, sample: 1.607, forward: 9.160, backward: 25.551, update: 0.430
[proc 5] 200 steps, total: 59.360, sample: 1.680, forward: 9.096, backward: 25.524, update: 0.483
[proc 4] 200 steps, total: 59.360, sample: 1.761, forward: 8.984, backward: 25.583, update: 0.429
[proc 1] 200 steps, total: 59.360, sample: 1.763, forward: 9.038, backward: 26.441, update: 0.378
[proc 2] 200 steps, total: 59.361, sample: 2.432, forward: 8.380, backward: 25.852, update: 0.384
[proc 3] 200 steps, total: 59.361, sample: 1.423, forward: 9.390, backward: 25.763, update: 0.411
[proc 0] 200 steps, total: 59.361, sample: 3.017, forward: 7.237, backward: 45.110, update: 3.638
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.038 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.757 ms                  | 70.229 ms                 |
| forward: search cache     | 493.271 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 67.581 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.899 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.394 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 254.711 ms                |
| Backward                  | 447.959 ms                | 591.638 ms                |
| Optimize                  | 34.471 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.998 us                 | 139.659 us                |
| BlockToStepN              | 92.434 us                 | 44.041 ms                 |
| OneStep                   | 582.748 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.047 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.688 ms                  | 70.229 ms                 |
| forward: search cache     | 492.771 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 67.500 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.902 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.394 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 254.711 ms                |
| Backward                  | 449.345 ms                | 591.638 ms                |
| Optimize                  | 34.475 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 57.120 us                 | 139.659 us                |
| BlockToStepN              | 92.369 us                 | 44.041 ms                 |
| OneStep                   | 582.748 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.047 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.688 ms                  | 70.229 ms                 |
| forward: search cache     | 492.600 us                | 636.038 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.094 ms                  |
| Forward                   | 67.475 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.412 ms                | 182.860 ms                |
| back: set dram grad       | 8.907 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.394 ms                 | 88.345 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 254.711 ms                |
| Backward                  | 449.345 ms                | 591.638 ms                |
| Optimize                  | 34.486 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.998 us                 | 139.659 us                |
| BlockToStepN              | 92.369 us                 | 44.041 ms                 |
| OneStep                   | 580.284 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.175 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.688 ms                  | 70.014 ms                 |
| forward: search cache     | 492.439 us                | 594.316 us                |
| forward: a2a values       | 24.632 ms                 | 64.793 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 67.500 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.246 ms                | 182.856 ms                |
| back: set dram grad       | 8.902 ms                  | 18.479 ms                 |
| back: a2a grad            | 31.394 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 448.105 ms                | 591.638 ms                |
| Optimize                  | 34.512 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.972 us                 | 139.659 us                |
| BlockToStepN              | 92.313 us                 | 44.041 ms                 |
| OneStep                   | 579.840 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.494 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.672 ms                  | 70.014 ms                 |
| forward: search cache     | 492.277 us                | 594.316 us                |
| forward: a2a values       | 24.632 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 67.564 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.412 ms                | 182.856 ms                |
| back: set dram grad       | 8.902 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.433 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 448.859 ms                | 591.638 ms                |
| Optimize                  | 34.525 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.874 us                 | 139.659 us                |
| BlockToStepN              | 92.353 us                 | 44.041 ms                 |
| OneStep                   | 582.748 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.175 ms                 | 389.345 ms                |
| bucket keys               | 2.740 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.658 ms                  | 70.014 ms                 |
| forward: search cache     | 492.277 us                | 594.316 us                |
| forward: a2a values       | 24.632 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.071 ms                  |
| Forward                   | 67.476 ms                 | 253.154 ms                |
| back: aggr dram keys      | 105.412 ms                | 182.856 ms                |
| back: set dram grad       | 8.902 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.394 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 447.959 ms                | 591.638 ms                |
| Optimize                  | 34.537 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.874 us                 | 139.659 us                |
| BlockToStepN              | 92.353 us                 | 52.799 ms                 |
| OneStep                   | 579.877 ms                | 984.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.494 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.577 ms                  | 70.014 ms                 |
| forward: search cache     | 492.237 us                | 594.316 us                |
| forward: a2a values       | 24.552 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.174 ms                  |
| Forward                   | 67.365 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.246 ms                | 182.860 ms                |
| back: set dram grad       | 8.907 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.435 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 445.632 ms                | 587.847 ms                |
| Optimize                  | 34.537 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.825 us                 | 116.849 us                |
| BlockToStepN              | 92.209 us                 | 44.041 ms                 |
| OneStep                   | 579.877 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.494 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.571 ms                  | 70.014 ms                 |
| forward: search cache     | 491.824 us                | 594.316 us                |
| forward: a2a values       | 24.552 ms                 | 65.233 ms                 |
| forward: join             | 3.319 ms                  | 4.209 ms                  |
| Forward                   | 67.365 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.913 ms                  | 20.343 ms                 |
| back: a2a grad            | 31.706 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 447.959 ms                | 587.847 ms                |
| Optimize                  | 34.536 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.747 us                 | 116.849 us                |
| BlockToStepN              | 92.209 us                 | 44.041 ms                 |
| OneStep                   | 579.877 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.294 ms                  |
| forward: a2a keys         | 3.528 ms                  | 70.014 ms                 |
| forward: search cache     | 490.878 us                | 594.316 us                |
| forward: a2a values       | 24.552 ms                 | 65.233 ms                 |
| forward: join             | 3.267 ms                  | 4.209 ms                  |
| Forward                   | 66.798 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.228 ms                | 182.860 ms                |
| back: set dram grad       | 8.918 ms                  | 20.343 ms                 |
| back: a2a grad            | 31.706 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 445.532 ms                | 587.847 ms                |
| Optimize                  | 34.559 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.747 us                 | 116.849 us                |
| BlockToStepN              | 92.313 us                 | 44.041 ms                 |
| OneStep                   | 579.510 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.474 ms                  | 64.904 ms                 |
| forward: search cache     | 490.904 us                | 566.637 us                |
| forward: a2a values       | 24.550 ms                 | 64.793 ms                 |
| forward: join             | 3.267 ms                  | 4.194 ms                  |
| Forward                   | 66.674 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.926 ms                | 182.856 ms                |
| back: set dram grad       | 8.921 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.706 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 445.532 ms                | 587.847 ms                |
| Optimize                  | 34.604 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.825 us                 | 116.849 us                |
| BlockToStepN              | 92.369 us                 | 44.041 ms                 |
| OneStep                   | 579.266 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.424 ms                  | 64.904 ms                 |
| forward: search cache     | 490.904 us                | 566.637 us                |
| forward: a2a values       | 24.532 ms                 | 64.793 ms                 |
| forward: join             | 3.267 ms                  | 4.194 ms                  |
| Forward                   | 66.477 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.754 ms                | 188.179 ms                |
| back: set dram grad       | 8.921 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.706 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 445.632 ms                | 587.847 ms                |
| Optimize                  | 34.622 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.764 us                 | 116.849 us                |
| BlockToStepN              | 92.353 us                 | 44.041 ms                 |
| OneStep                   | 577.470 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.662 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.410 ms                  | 64.904 ms                 |
| forward: search cache     | 491.362 us                | 566.637 us                |
| forward: a2a values       | 24.550 ms                 | 65.233 ms                 |
| forward: join             | 3.267 ms                  | 4.194 ms                  |
| Forward                   | 66.477 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.754 ms                | 188.179 ms                |
| back: set dram grad       | 8.918 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.706 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 445.632 ms                | 587.847 ms                |
| Optimize                  | 34.636 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.764 us                 | 116.849 us                |
| BlockToStepN              | 92.366 us                 | 51.009 ms                 |
| OneStep                   | 576.293 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 58.660, sample: 1.546, forward: 8.257, backward: 26.649, update: 0.374
[proc 6] 300 steps, total: 58.661, sample: 1.183, forward: 8.648, backward: 25.539, update: 0.423
[proc 5] 300 steps, total: 58.661, sample: 1.381, forward: 8.401, backward: 25.571, update: 0.434
[proc 7] 300 steps, total: 58.661, sample: 1.314, forward: 8.467, backward: 25.820, update: 0.445
[proc 0] 300 steps, total: 58.660, sample: 2.302, forward: 7.056, backward: 44.958, update: 3.819
[proc 3] 300 steps, total: 58.660, sample: 1.214, forward: 8.575, backward: 25.825, update: 0.413
[proc 2] 300 steps, total: 58.660, sample: 1.724, forward: 8.075, backward: 25.903, update: 0.373
[proc 4] 300 steps, total: 58.661, sample: 1.207, forward: 8.586, backward: 25.589, update: 0.411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.682 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.258 ms                  |
| forward: a2a keys         | 3.424 ms                  | 64.904 ms                 |
| forward: search cache     | 491.362 us                | 566.637 us                |
| forward: a2a values       | 24.550 ms                 | 65.233 ms                 |
| forward: join             | 3.267 ms                  | 4.196 ms                  |
| Forward                   | 66.674 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.228 ms                | 188.179 ms                |
| back: set dram grad       | 8.919 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.706 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 446.253 ms                | 587.847 ms                |
| Optimize                  | 34.693 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.706 us                 | 116.849 us                |
| BlockToStepN              | 92.369 us                 | 51.009 ms                 |
| OneStep                   | 576.293 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.682 ms                 | 277.919 ms                |
| bucket keys               | 2.740 ms                  | 3.258 ms                  |
| forward: a2a keys         | 3.374 ms                  | 64.904 ms                 |
| forward: search cache     | 490.891 us                | 566.637 us                |
| forward: a2a values       | 24.550 ms                 | 65.233 ms                 |
| forward: join             | 3.267 ms                  | 4.204 ms                  |
| Forward                   | 66.484 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.926 ms                | 188.179 ms                |
| back: set dram grad       | 8.913 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.706 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 446.253 ms                | 587.847 ms                |
| Optimize                  | 34.729 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.747 us                 | 116.849 us                |
| BlockToStepN              | 92.366 us                 | 51.009 ms                 |
| OneStep                   | 576.374 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.682 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.258 ms                  |
| forward: a2a keys         | 3.368 ms                  | 64.904 ms                 |
| forward: search cache     | 491.635 us                | 566.637 us                |
| forward: a2a values       | 24.550 ms                 | 65.233 ms                 |
| forward: join             | 3.267 ms                  | 4.209 ms                  |
| Forward                   | 66.484 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.926 ms                | 188.179 ms                |
| back: set dram grad       | 8.908 ms                  | 18.629 ms                 |
| back: a2a grad            | 31.778 ms                 | 83.028 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 253.898 ms                |
| Backward                  | 446.966 ms                | 587.847 ms                |
| Optimize                  | 34.757 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.825 us                 | 116.849 us                |
| BlockToStepN              | 92.353 us                 | 51.009 ms                 |
| OneStep                   | 577.470 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.828 ms                 | 277.919 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.410 ms                  | 63.178 ms                 |
| forward: search cache     | 491.762 us                | 564.352 us                |
| forward: a2a values       | 22.943 ms                 | 64.793 ms                 |
| forward: join             | 3.267 ms                  | 4.204 ms                  |
| Forward                   | 66.477 ms                 | 231.753 ms                |
| back: aggr dram keys      | 104.926 ms                | 182.860 ms                |
| back: set dram grad       | 8.918 ms                  | 19.290 ms                 |
| back: a2a grad            | 31.433 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 446.966 ms                | 587.847 ms                |
| Optimize                  | 34.778 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.862 us                 | 119.879 us                |
| BlockToStepN              | 92.353 us                 | 51.009 ms                 |
| OneStep                   | 577.470 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.828 ms                 | 277.919 ms                |
| bucket keys               | 2.740 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.485 ms                  | 63.178 ms                 |
| forward: search cache     | 491.362 us                | 564.352 us                |
| forward: a2a values       | 20.362 ms                 | 64.793 ms                 |
| forward: join             | 3.267 ms                  | 4.204 ms                  |
| Forward                   | 66.451 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.246 ms                | 182.860 ms                |
| back: set dram grad       | 8.918 ms                  | 19.290 ms                 |
| back: a2a grad            | 31.019 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 445.365 ms                | 587.847 ms                |
| Optimize                  | 34.837 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.874 us                 | 119.879 us                |
| BlockToStepN              | 92.209 us                 | 51.009 ms                 |
| OneStep                   | 576.092 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.828 ms                 | 277.919 ms                |
| bucket keys               | 2.740 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.540 ms                  | 63.178 ms                 |
| forward: search cache     | 491.226 us                | 566.637 us                |
| forward: a2a values       | 20.307 ms                 | 64.793 ms                 |
| forward: join             | 3.267 ms                  | 4.204 ms                  |
| Forward                   | 66.451 ms                 | 231.753 ms                |
| back: aggr dram keys      | 105.412 ms                | 182.860 ms                |
| back: set dram grad       | 8.919 ms                  | 19.770 ms                 |
| back: a2a grad            | 30.707 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 444.413 ms                | 587.847 ms                |
| Optimize                  | 34.867 ms                 | 79.256 ms                 |
| BarrierTimeBeforeRank0    | 56.825 us                 | 119.879 us                |
| BlockToStepN              | 92.313 us                 | 51.009 ms                 |
| OneStep                   | 575.333 ms                | 945.671 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.553 ms                  | 64.904 ms                 |
| forward: search cache     | 491.362 us                | 566.637 us                |
| forward: a2a values       | 20.157 ms                 | 65.233 ms                 |
| forward: join             | 3.301 ms                  | 4.209 ms                  |
| Forward                   | 66.412 ms                 | 176.117 ms                |
| back: aggr dram keys      | 106.194 ms                | 186.430 ms                |
| back: set dram grad       | 8.913 ms                  | 19.770 ms                 |
| back: a2a grad            | 30.407 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 444.200 ms                | 576.712 ms                |
| Optimize                  | 34.931 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.772 us                 | 116.849 us                |
| BlockToStepN              | 92.072 us                 | 44.041 ms                 |
| OneStep                   | 575.333 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.596 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.568 ms                  | 64.904 ms                 |
| forward: search cache     | 491.769 us                | 566.637 us                |
| forward: a2a values       | 20.242 ms                 | 65.233 ms                 |
| forward: join             | 3.350 ms                  | 4.481 ms                  |
| Forward                   | 66.477 ms                 | 176.117 ms                |
| back: aggr dram keys      | 106.239 ms                | 186.430 ms                |
| back: set dram grad       | 8.913 ms                  | 19.770 ms                 |
| back: a2a grad            | 30.230 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 442.956 ms                | 576.712 ms                |
| Optimize                  | 34.960 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.772 us                 | 116.849 us                |
| BlockToStepN              | 92.066 us                 | 44.041 ms                 |
| OneStep                   | 574.858 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.596 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.553 ms                  | 64.904 ms                 |
| forward: search cache     | 492.242 us                | 594.316 us                |
| forward: a2a values       | 20.020 ms                 | 65.233 ms                 |
| forward: join             | 3.375 ms                  | 4.664 ms                  |
| Forward                   | 66.392 ms                 | 176.117 ms                |
| back: aggr dram keys      | 106.562 ms                | 186.430 ms                |
| back: set dram grad       | 8.913 ms                  | 19.770 ms                 |
| back: a2a grad            | 30.098 ms                 | 82.762 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 243.630 ms                |
| Backward                  | 442.717 ms                | 576.712 ms                |
| Optimize                  | 35.022 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.836 us                 | 119.879 us                |
| BlockToStepN              | 92.209 us                 | 44.041 ms                 |
| OneStep                   | 574.858 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.245 ms                  |
| forward: a2a keys         | 3.530 ms                  | 63.178 ms                 |
| forward: search cache     | 492.277 us                | 588.359 us                |
| forward: a2a values       | 19.004 ms                 | 64.793 ms                 |
| forward: join             | 3.390 ms                  | 4.703 ms                  |
| Forward                   | 66.279 ms                 | 176.117 ms                |
| back: aggr dram keys      | 106.786 ms                | 185.695 ms                |
| back: set dram grad       | 8.913 ms                  | 19.290 ms                 |
| back: a2a grad            | 29.904 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 240.074 ms                |
| Backward                  | 440.795 ms                | 576.712 ms                |
| Optimize                  | 35.097 ms                 | 75.782 ms                 |
| BarrierTimeBeforeRank0    | 56.862 us                 | 119.879 us                |
| BlockToStepN              | 91.979 us                 | 44.041 ms                 |
| OneStep                   | 574.166 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.635 ms                 | 260.163 ms                |
| bucket keys               | 2.740 ms                  | 3.245 ms                  |
| forward: a2a keys         | 3.553 ms                  | 64.904 ms                 |
| forward: search cache     | 492.277 us                | 588.359 us                |
| forward: a2a values       | 17.415 ms                 | 64.793 ms                 |
| forward: join             | 3.396 ms                  | 4.703 ms                  |
| Forward                   | 66.186 ms                 | 176.117 ms                |
| back: aggr dram keys      | 107.360 ms                | 185.695 ms                |
| back: set dram grad       | 8.936 ms                  | 19.290 ms                 |
| back: a2a grad            | 29.025 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 240.074 ms                |
| Backward                  | 440.319 ms                | 576.712 ms                |
| Optimize                  | 35.209 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 56.998 us                 | 119.879 us                |
| BlockToStepN              | 91.965 us                 | 44.041 ms                 |
| OneStep                   | 572.952 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 57.455, sample: 2.114, forward: 7.165, backward: 42.594, update: 5.153
[proc 4] 400 steps, total: 57.455, sample: 1.164, forward: 8.501, backward: 29.239, update: 0.435
[proc 1] 400 steps, total: 57.455, sample: 1.405, forward: 8.264, backward: 30.109, update: 0.392
[proc 6] 400 steps, total: 57.455, sample: 1.280, forward: 8.449, backward: 29.133, update: 0.424
[proc 2] 400 steps, total: 57.455, sample: 1.475, forward: 8.216, backward: 29.472, update: 0.375
[proc 3] 400 steps, total: 57.455, sample: 1.206, forward: 8.479, backward: 29.399, update: 0.410
[proc 7] 400 steps, total: 57.455, sample: 1.150, forward: 8.546, backward: 29.339, update: 0.405
[proc 5] 400 steps, total: 57.455, sample: 1.257, forward: 8.405, backward: 29.139, update: 0.428
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.494 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.245 ms                  |
| forward: a2a keys         | 3.556 ms                  | 64.904 ms                 |
| forward: search cache     | 492.439 us                | 588.359 us                |
| forward: a2a values       | 14.863 ms                 | 64.793 ms                 |
| forward: join             | 3.412 ms                  | 4.752 ms                  |
| Forward                   | 66.186 ms                 | 176.117 ms                |
| back: aggr dram keys      | 107.757 ms                | 185.695 ms                |
| back: set dram grad       | 8.961 ms                  | 19.770 ms                 |
| back: a2a grad            | 28.430 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 240.074 ms                |
| Backward                  | 439.662 ms                | 576.712 ms                |
| Optimize                  | 35.262 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.114 us                 | 119.879 us                |
| BlockToStepN              | 91.979 us                 | 44.041 ms                 |
| OneStep                   | 572.465 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.293 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.245 ms                  |
| forward: a2a keys         | 3.556 ms                  | 64.904 ms                 |
| forward: search cache     | 492.600 us                | 588.359 us                |
| forward: a2a values       | 14.720 ms                 | 64.793 ms                 |
| forward: join             | 3.426 ms                  | 4.752 ms                  |
| Forward                   | 66.014 ms                 | 176.117 ms                |
| back: aggr dram keys      | 107.798 ms                | 185.695 ms                |
| back: set dram grad       | 8.984 ms                  | 19.770 ms                 |
| back: a2a grad            | 28.135 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 240.074 ms                |
| Backward                  | 438.847 ms                | 576.712 ms                |
| Optimize                  | 35.339 ms                 | 79.731 ms                 |
| BarrierTimeBeforeRank0    | 57.165 us                 | 119.879 us                |
| BlockToStepN              | 91.962 us                 | 44.041 ms                 |
| OneStep                   | 572.201 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.175 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.553 ms                  | 64.904 ms                 |
| forward: search cache     | 492.771 us                | 588.359 us                |
| forward: a2a values       | 14.426 ms                 | 64.793 ms                 |
| forward: join             | 3.432 ms                  | 4.752 ms                  |
| Forward                   | 65.951 ms                 | 176.117 ms                |
| back: aggr dram keys      | 107.917 ms                | 185.695 ms                |
| back: set dram grad       | 9.000 ms                  | 19.770 ms                 |
| back: a2a grad            | 27.719 ms                 | 82.695 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 240.074 ms                |
| Backward                  | 438.268 ms                | 576.712 ms                |
| Optimize                  | 35.368 ms                 | 84.897 ms                 |
| BarrierTimeBeforeRank0    | 57.237 us                 | 119.879 us                |
| BlockToStepN              | 91.942 us                 | 44.041 ms                 |
| OneStep                   | 571.769 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.038 ms                 | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.245 ms                  |
| forward: a2a keys         | 3.556 ms                  | 64.904 ms                 |
| forward: search cache     | 493.325 us                | 578.900 us                |
| forward: a2a values       | 13.436 ms                 | 64.288 ms                 |
| forward: join             | 3.442 ms                  | 4.759 ms                  |
| Forward                   | 65.912 ms                 | 176.117 ms                |
| back: aggr dram keys      | 108.110 ms                | 182.860 ms                |
| back: set dram grad       | 9.007 ms                  | 19.770 ms                 |
| back: a2a grad            | 26.402 ms                 | 81.682 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 238.347 ms                |
| Backward                  | 437.634 ms                | 576.712 ms                |
| Optimize                  | 35.468 ms                 | 84.897 ms                 |
| BarrierTimeBeforeRank0    | 57.282 us                 | 119.879 us                |
| BlockToStepN              | 91.866 us                 | 44.041 ms                 |
| OneStep                   | 570.433 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.553 ms                  | 64.904 ms                 |
| forward: search cache     | 493.299 us                | 578.900 us                |
| forward: a2a values       | 12.722 ms                 | 64.288 ms                 |
| forward: join             | 3.449 ms                  | 4.764 ms                  |
| Forward                   | 65.791 ms                 | 176.117 ms                |
| back: aggr dram keys      | 108.826 ms                | 186.430 ms                |
| back: set dram grad       | 9.022 ms                  | 19.770 ms                 |
| back: a2a grad            | 25.008 ms                 | 81.682 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 238.347 ms                |
| Backward                  | 436.977 ms                | 576.712 ms                |
| Optimize                  | 35.576 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 57.290 us                 | 139.659 us                |
| BlockToStepN              | 91.866 us                 | 44.041 ms                 |
| OneStep                   | 569.587 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 260.163 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.538 ms                  | 64.904 ms                 |
| forward: search cache     | 493.271 us                | 578.900 us                |
| forward: a2a values       | 12.061 ms                 | 64.288 ms                 |
| forward: join             | 3.457 ms                  | 4.764 ms                  |
| Forward                   | 65.707 ms                 | 176.117 ms                |
| back: aggr dram keys      | 109.061 ms                | 186.430 ms                |
| back: set dram grad       | 9.031 ms                  | 19.902 ms                 |
| back: a2a grad            | 23.514 ms                 | 81.682 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 238.347 ms                |
| Backward                  | 435.427 ms                | 576.712 ms                |
| Optimize                  | 35.641 ms                 | 92.964 ms                 |
| BarrierTimeBeforeRank0    | 57.362 us                 | 139.659 us                |
| BlockToStepN              | 91.751 us                 | 44.041 ms                 |
| OneStep                   | 568.544 ms                | 856.118 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.692 ms                  | 244.033 ms                |
| bucket keys               | 2.738 ms                  | 3.250 ms                  |
| forward: a2a keys         | 3.540 ms                  | 64.904 ms                 |
| forward: search cache     | 493.387 us                | 578.900 us                |
| forward: a2a values       | 10.923 ms                 | 64.288 ms                 |
| forward: join             | 3.461 ms                  | 4.764 ms                  |
| Forward                   | 65.620 ms                 | 141.713 ms                |
| back: aggr dram keys      | 109.316 ms                | 186.430 ms                |
| back: set dram grad       | 9.042 ms                  | 19.902 ms                 |
| back: a2a grad            | 23.034 ms                 | 81.682 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 238.347 ms                |
| Backward                  | 434.642 ms                | 567.471 ms                |
| Optimize                  | 35.774 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 57.374 us                 | 119.879 us                |
| BlockToStepN              | 91.505 us                 | 43.432 ms                 |
| OneStep                   | 567.066 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.540 ms                  | 244.033 ms                |
| bucket keys               | 2.738 ms                  | 3.258 ms                  |
| forward: a2a keys         | 3.559 ms                  | 68.192 ms                 |
| forward: search cache     | 493.387 us                | 578.900 us                |
| forward: a2a values       | 10.628 ms                 | 64.288 ms                 |
| forward: join             | 3.464 ms                  | 4.764 ms                  |
| Forward                   | 65.572 ms                 | 141.713 ms                |
| back: aggr dram keys      | 109.498 ms                | 186.430 ms                |
| back: set dram grad       | 9.047 ms                  | 19.902 ms                 |
| back: a2a grad            | 22.022 ms                 | 81.682 ms                 |
| back: grad sum & grad cache  | 16.836 ms                 | 238.347 ms                |
| Backward                  | 433.817 ms                | 567.471 ms                |
| Optimize                  | 36.199 ms                 | 88.083 ms                 |
| BarrierTimeBeforeRank0    | 57.362 us                 | 119.879 us                |
| BlockToStepN              | 91.500 us                 | 43.432 ms                 |
| OneStep                   | 566.609 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.481 ms                  | 244.033 ms                |
| bucket keys               | 2.738 ms                  | 3.255 ms                  |
| forward: a2a keys         | 3.568 ms                  | 68.192 ms                 |
| forward: search cache     | 493.767 us                | 576.162 us                |
| forward: a2a values       | 10.494 ms                 | 63.566 ms                 |
| forward: join             | 3.469 ms                  | 4.764 ms                  |
| Forward                   | 65.300 ms                 | 141.713 ms                |
| back: aggr dram keys      | 109.586 ms                | 185.695 ms                |
| back: set dram grad       | 9.057 ms                  | 19.770 ms                 |
| back: a2a grad            | 21.575 ms                 | 81.229 ms                 |
| back: grad sum & grad cache  | 45.556 ms                 | 234.694 ms                |
| Backward                  | 432.465 ms                | 567.471 ms                |
| Optimize                  | 36.731 ms                 | 88.822 ms                 |
| BarrierTimeBeforeRank0    | 57.372 us                 | 119.879 us                |
| BlockToStepN              | 91.357 us                 | 43.432 ms                 |
| OneStep                   | 565.860 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.304 ms                  | 244.033 ms                |
| bucket keys               | 2.740 ms                  | 3.255 ms                  |
| forward: a2a keys         | 3.577 ms                  | 68.192 ms                 |
| forward: search cache     | 493.932 us                | 576.162 us                |
| forward: a2a values       | 10.365 ms                 | 63.566 ms                 |
| forward: join             | 3.475 ms                  | 4.764 ms                  |
| Forward                   | 65.164 ms                 | 141.713 ms                |
| back: aggr dram keys      | 110.253 ms                | 186.430 ms                |
| back: set dram grad       | 9.065 ms                  | 19.902 ms                 |
| back: a2a grad            | 21.152 ms                 | 81.229 ms                 |
| back: grad sum & grad cache  | 45.556 ms                 | 234.694 ms                |
| Backward                  | 431.546 ms                | 567.471 ms                |
| Optimize                  | 37.887 ms                 | 88.822 ms                 |
| BarrierTimeBeforeRank0    | 57.390 us                 | 119.879 us                |
| BlockToStepN              | 91.357 us                 | 43.432 ms                 |
| OneStep                   | 565.713 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.319 ms                  | 244.033 ms                |
| bucket keys               | 2.742 ms                  | 3.255 ms                  |
| forward: a2a keys         | 3.593 ms                  | 69.308 ms                 |
| forward: search cache     | 494.156 us                | 578.900 us                |
| forward: a2a values       | 10.375 ms                 | 63.566 ms                 |
| forward: join             | 3.479 ms                  | 4.764 ms                  |
| Forward                   | 65.160 ms                 | 174.915 ms                |
| back: aggr dram keys      | 110.603 ms                | 186.430 ms                |
| back: set dram grad       | 9.069 ms                  | 19.902 ms                 |
| back: a2a grad            | 20.280 ms                 | 81.229 ms                 |
| back: grad sum & grad cache  | 45.556 ms                 | 234.694 ms                |
| Backward                  | 430.862 ms                | 567.471 ms                |
| Optimize                  | 38.500 ms                 | 88.822 ms                 |
| BarrierTimeBeforeRank0    | 57.427 us                 | 119.879 us                |
| BlockToStepN              | 91.206 us                 | 43.432 ms                 |
| OneStep                   | 564.255 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 500 steps, total: 52.724, sample: 1.266, forward: 7.252, backward: 32.690, update: 0.420
[proc 2] 500 steps, total: 52.724, sample: 1.276, forward: 7.245, backward: 32.842, update: 0.379
[proc 5] 500 steps, total: 52.724, sample: 1.259, forward: 7.259, backward: 32.652, update: 0.433
[proc 4] 500 steps, total: 52.724, sample: 1.105, forward: 7.453, backward: 32.726, update: 0.465
[proc 7] 500 steps, total: 52.724, sample: 1.184, forward: 7.434, backward: 32.552, update: 0.430
[proc 1] 500 steps, total: 52.724, sample: 1.350, forward: 7.217, backward: 33.467, update: 0.378
[proc 3] 500 steps, total: 52.724, sample: 1.168, forward: 7.358, backward: 32.693, update: 0.416
[proc 0] 500 steps, total: 52.724, sample: 1.765, forward: 6.418, backward: 38.055, update: 6.179
Successfully xmh. training takes 294.21648025512695 seconds
before call kg_cache_controller.StopThreads()
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
INFO [60370 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.304 ms                  | 244.033 ms                |
| bucket keys               | 2.743 ms                  | 3.255 ms                  |
| forward: a2a keys         | 3.586 ms                  | 69.308 ms                 |
| forward: search cache     | 494.488 us                | 578.900 us                |
| forward: a2a values       | 10.365 ms                 | 63.566 ms                 |
| forward: join             | 3.480 ms                  | 4.764 ms                  |
| Forward                   | 64.865 ms                 | 174.915 ms                |
| back: aggr dram keys      | 110.717 ms                | 186.430 ms                |
| back: set dram grad       | 9.071 ms                  | 19.902 ms                 |
| back: a2a grad            | 19.785 ms                 | 81.229 ms                 |
| back: grad sum & grad cache  | 45.556 ms                 | 234.694 ms                |
| Backward                  | 430.096 ms                | 567.471 ms                |
| Optimize                  | 38.803 ms                 | 88.822 ms                 |
| BarrierTimeBeforeRank0    | 57.427 us                 | 122.462 us                |
| BlockToStepN              | 91.206 us                 | 43.432 ms                 |
| OneStep                   | 562.976 ms                | 839.762 ms                |
+---------------------------+---------------------------+---------------------------+
