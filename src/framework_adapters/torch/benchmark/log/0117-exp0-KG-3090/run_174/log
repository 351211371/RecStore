WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 10:50:47.227437 61606 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_Freebase_9', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [61606 sampler.py:454] Start PreSampling
WARNING [61606 sampler.py:532] Before construct renumbering_dict
WARNING [61606 sampler.py:555] PreSampling done
W20240125 11:17:57.813819 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 11:17:57.814198 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 11:17:57.814260 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 11:17:57.814324 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 11:17:57.814394 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 11:17:57.814433 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 11:17:57.814486 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 11:17:57.814538 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 11:17:57.814599 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 11:17:57.814656 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 11:17:57.814728 61606 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 11:17:57.814767 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 11:17:57.814797 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 11:17:57.815073 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 11:17:57.815152 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 11:17:57.815217 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 11:17:57.815275 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 11:17:57.815305 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 11:17:57.815337 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 11:17:57.815378 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 11:17:57.815430 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 11:17:57.815483 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 11:17:57.815536 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 11:17:57.815577 61606 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 11:17:57.815608 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 11:17:57.815629 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 11:17:57.815739 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 11:17:57.815804 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 11:17:57.815848 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 11:17:57.815881 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 11:17:57.815915 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 11:17:57.815981 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 11:17:57.816011 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 11:17:57.816042 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 11:17:57.816097 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 11:17:57.816128 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 11:17:57.816162 61606 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 11:17:57.816190 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 11:17:57.816213 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 11:17:57.816309 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 11:17:57.816363 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 11:17:57.816395 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 11:17:57.816423 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 11:17:57.816457 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 11:17:57.816505 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 11:17:57.816535 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 11:17:57.816603 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 11:17:57.816654 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 11:17:57.816684 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 11:17:57.816740 61606 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 11:17:57.816766 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 11:17:57.816824 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 11:17:57.816921 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 11:17:57.816977 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 11:17:57.817013 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 11:17:57.817077 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 11:17:57.817149 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 11:17:57.817195 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 11:17:57.817256 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 11:17:57.817313 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 11:17:57.817359 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 11:17:57.817392 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 11:17:57.817445 61606 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 11:17:57.817471 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 11:17:57.817495 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 11:17:57.817600 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 11:17:57.817657 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 11:17:57.817689 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 11:17:57.817718 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 11:17:57.817791 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 11:17:57.817842 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 11:17:57.817891 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 11:17:57.817955 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 11:17:57.818008 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 11:17:57.818043 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 11:17:57.818087 61606 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 11:17:57.818116 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 11:17:57.818140 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 11:17:57.818209 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 11:17:57.818248 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 11:17:57.818279 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 11:17:57.818306 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 11:17:57.818347 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 11:17:57.818377 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 11:17:57.818441 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 11:17:57.818497 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 11:17:57.818562 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 11:17:57.818614 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 11:17:57.818646 61606 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 11:17:57.818687 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 11:17:57.818711 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 11:17:57.818785 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 11:17:57.818850 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 11:17:57.818883 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 11:17:57.818914 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 11:17:57.818969 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 11:17:57.819038 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 11:17:57.819085 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 11:17:57.819124 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 11:17:57.819155 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 11:17:57.819211 61606 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 11:17:57.819242 61606 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 11:17:57.819267 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 11:17:57.819314 61606 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 11:17:58.833197 61606 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 11:17:58.833530 61606 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302712,  4302758,   116746,  ..., 72988003, 15247492, 36821611]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2349.183 seconds
[Rank1] pid = 29480
[Rank2] pid = 29602
[Rank3] pid = 29701
[Rank4] pid = 29800
[Rank5] pid = 29897
[Rank6] pid = 29995
INFO [61606 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [29480 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29602 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [29701 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29800 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [29897 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29480 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29800 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29701 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29602 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30086 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [29995 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [29897 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29995 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [30086 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [61606 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [61606 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29701 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29897 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29995 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29480 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29602 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29800 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [30086 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 11:30:27.807993 30089 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808173 29997 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808311 29898 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808444 29485 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808570 30152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808686 29603 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.808864 29702 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 11:30:27.809023 29801 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240125 11:30:40.457908 30089 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 11:30:41.156275 29898 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:44.193490 29997 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:44.540102 29603 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:45.590667 29485 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:45.855846 29702 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:47.503218 29801 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 11:30:47.937872 30152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.556 ms                  | 11.596 ms                 |
| bucket keys               | 2.348 ms                  | 276.569 ms                |
| forward: a2a keys         | 3.978 ms                  | 1.835 s                   |
| forward: search cache     | 531.775 us                | 34.568 ms                 |
| forward: a2a values       | 4.178 ms                  | 34.356 ms                 |
| forward: join             | 1.859 ms                  | 2.370 ms                  |
| Forward                   | 44.544 ms                 | 2.832 s                   |
| back: aggr dram keys      | 81.684 ms                 | 1.355 s                   |
| back: set dram grad       | 7.163 ms                  | 7.747 ms                  |
| back: a2a grad            | 15.036 ms                 | 35.024 ms                 |
| back: grad sum & grad cache  | 4.994 ms                  | 97.123 ms                 |
| Backward                  | 1.798 s                   | 1.798 s                   |
| Optimize                  | 67.459 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 83.156 us                 | 83.156 us                 |
| BlockToStepN              | 120.318 us                | 120.318 us                |
| OneStep                   | 4.711 s                   | 4.711 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.816 ms                  | 61.114 ms                 |
| bucket keys               | 2.354 ms                  | 276.569 ms                |
| forward: a2a keys         | 3.978 ms                  | 1.835 s                   |
| forward: search cache     | 494.038 us                | 34.568 ms                 |
| forward: a2a values       | 14.178 ms                 | 46.805 ms                 |
| forward: join             | 1.859 ms                  | 2.411 ms                  |
| Forward                   | 49.748 ms                 | 2.832 s                   |
| back: aggr dram keys      | 82.709 ms                 | 1.355 s                   |
| back: set dram grad       | 6.524 ms                  | 8.645 ms                  |
| back: a2a grad            | 18.453 ms                 | 53.657 ms                 |
| back: grad sum & grad cache  | 5.470 ms                  | 97.123 ms                 |
| Backward                  | 294.535 ms                | 1.798 s                   |
| Optimize                  | 21.223 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 83.156 us                 | 185.012 us                |
| BlockToStepN              | 95.466 us                 | 7.545 ms                  |
| OneStep                   | 385.604 ms                | 4.711 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.976 ms                  | 61.114 ms                 |
| bucket keys               | 2.354 ms                  | 3.121 ms                  |
| forward: a2a keys         | 3.115 ms                  | 41.286 ms                 |
| forward: search cache     | 487.648 us                | 690.202 us                |
| forward: a2a values       | 14.178 ms                 | 34.356 ms                 |
| forward: join             | 1.859 ms                  | 2.600 ms                  |
| Forward                   | 45.910 ms                 | 2.832 s                   |
| back: aggr dram keys      | 81.684 ms                 | 144.856 ms                |
| back: set dram grad       | 6.259 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.453 ms                 | 44.779 ms                 |
| back: grad sum & grad cache  | 5.470 ms                  | 97.123 ms                 |
| Backward                  | 282.104 ms                | 1.798 s                   |
| Optimize                  | 21.469 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 82.686 us                 | 185.012 us                |
| BlockToStepN              | 85.362 us                 | 14.090 ms                 |
| OneStep                   | 381.601 ms                | 4.711 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.968 ms                  | 65.443 ms                 |
| bucket keys               | 2.397 ms                  | 3.144 ms                  |
| forward: a2a keys         | 3.051 ms                  | 42.857 ms                 |
| forward: search cache     | 499.216 us                | 693.285 us                |
| forward: a2a values       | 14.178 ms                 | 34.356 ms                 |
| forward: join             | 1.859 ms                  | 2.607 ms                  |
| Forward                   | 45.910 ms                 | 2.832 s                   |
| back: aggr dram keys      | 82.709 ms                 | 144.856 ms                |
| back: set dram grad       | 6.252 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.931 ms                 | 54.202 ms                 |
| back: grad sum & grad cache  | 5.597 ms                  | 128.464 ms                |
| Backward                  | 282.104 ms                | 1.798 s                   |
| Optimize                  | 21.555 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 78.815 us                 | 185.012 us                |
| BlockToStepN              | 78.363 us                 | 14.090 ms                 |
| OneStep                   | 381.601 ms                | 4.711 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.608 ms                  | 61.114 ms                 |
| bucket keys               | 2.361 ms                  | 45.029 ms                 |
| forward: a2a keys         | 3.031 ms                  | 42.857 ms                 |
| forward: search cache     | 505.666 us                | 693.285 us                |
| forward: a2a values       | 14.182 ms                 | 46.805 ms                 |
| forward: join             | 1.859 ms                  | 2.607 ms                  |
| Forward                   | 45.503 ms                 | 89.439 ms                 |
| back: aggr dram keys      | 83.384 ms                 | 144.856 ms                |
| back: set dram grad       | 5.965 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.937 ms                 | 56.706 ms                 |
| back: grad sum & grad cache  | 5.597 ms                  | 143.049 ms                |
| Backward                  | 286.445 ms                | 408.090 ms                |
| Optimize                  | 21.444 ms                 | 49.262 ms                 |
| BarrierTimeBeforeRank0    | 69.773 us                 | 130.661 us                |
| BlockToStepN              | 78.363 us                 | 11.865 ms                 |
| OneStep                   | 382.836 ms                | 488.358 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.194 ms                  | 61.114 ms                 |
| bucket keys               | 2.350 ms                  | 45.029 ms                 |
| forward: a2a keys         | 3.016 ms                  | 80.216 ms                 |
| forward: search cache     | 505.742 us                | 693.285 us                |
| forward: a2a values       | 14.182 ms                 | 46.805 ms                 |
| forward: join             | 1.859 ms                  | 2.607 ms                  |
| Forward                   | 44.824 ms                 | 169.260 ms                |
| back: aggr dram keys      | 83.763 ms                 | 147.065 ms                |
| back: set dram grad       | 5.965 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.931 ms                 | 77.164 ms                 |
| back: grad sum & grad cache  | 5.597 ms                  | 143.049 ms                |
| Backward                  | 288.497 ms                | 408.090 ms                |
| Optimize                  | 21.469 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 66.823 us                 | 130.661 us                |
| BlockToStepN              | 79.653 us                 | 28.471 ms                 |
| OneStep                   | 385.348 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.894 ms                  | 61.114 ms                 |
| bucket keys               | 2.350 ms                  | 3.144 ms                  |
| forward: a2a keys         | 2.922 ms                  | 51.542 ms                 |
| forward: search cache     | 501.679 us                | 693.121 us                |
| forward: a2a values       | 14.182 ms                 | 44.957 ms                 |
| forward: join             | 1.859 ms                  | 2.603 ms                  |
| Forward                   | 44.469 ms                 | 169.260 ms                |
| back: aggr dram keys      | 83.430 ms                 | 147.065 ms                |
| back: set dram grad       | 6.067 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.910 ms                 | 56.706 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 293.947 ms                | 408.090 ms                |
| Optimize                  | 21.469 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 62.308 us                 | 130.661 us                |
| BlockToStepN              | 78.363 us                 | 41.143 ms                 |
| OneStep                   | 386.540 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.194 ms                  | 61.114 ms                 |
| bucket keys               | 2.343 ms                  | 3.144 ms                  |
| forward: a2a keys         | 2.985 ms                  | 51.542 ms                 |
| forward: search cache     | 505.742 us                | 693.121 us                |
| forward: a2a values       | 14.178 ms                 | 44.957 ms                 |
| forward: join             | 1.859 ms                  | 2.603 ms                  |
| Forward                   | 44.824 ms                 | 169.260 ms                |
| back: aggr dram keys      | 83.357 ms                 | 147.065 ms                |
| back: set dram grad       | 6.025 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.768 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 288.497 ms                | 435.275 ms                |
| Optimize                  | 21.451 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 61.819 us                 | 179.411 us                |
| BlockToStepN              | 80.932 us                 | 41.143 ms                 |
| OneStep                   | 385.604 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 45.305, sample: 0.900, forward: 8.260, backward: 22.271, update: 0.264
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 43.658, sample: 0.862, forward: 8.299, backward: 22.153, update: 0.294
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 50.703, sample: 0.890, forward: 8.317, backward: 22.179, update: 0.261
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 46.967, sample: 0.801, forward: 8.371, backward: 22.146, update: 0.279
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 46.621, sample: 0.761, forward: 8.377, backward: 22.371, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 50.005, sample: 0.844, forward: 8.298, backward: 22.152, update: 0.310
[Rank7] pid = 30086
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([443897, 435331, 443907, 435341, 435348, 435357, 443919, 435368, 435378,
        435386]) tensor([ 5333104, 12994045, 40100350, 68287122, 23966808,   173017, 23929799,
        41795565, 61971025, 42925834])
-------Step 1-------
tensor([443897, 435331, 443907, 435341, 435348, 435357, 443919, 435368, 435378,
        435386]) tensor([18554067, 43125482, 47256859,  4884759, 81010053,  7149144,  5702356,
        16813073, 71379581,  6758446])
-------Step 2-------
tensor([  446355,   446367, 29065660,   446379,   446388,   444093,   446400,
          446409,   446420,   446431]) tensor([83260147, 85346674, 54726567,  8325704, 29227267,    15588, 55345099,
        38264937, 18460167, 73064446])
-------Step 3-------
tensor([  446355,   446367, 29065660,   446379,   446388,   444093,   446400,
          446409,   446420,   446431]) tensor([46153629, 29970036, 62207517, 16914743,   233044, 23968792, 60087518,
        39025029, 52267417, 62410940])
-------Step 4-------
tensor([10974107,    59920,   202696,    64389,   457428,   457436,   457444,
          457452,   457462,   457471]) tensor([37385980, 23821425, 84734828, 34720226, 29118240, 17756425,  8460693,
        71610829, 48853598, 34141436])
-------Step 5-------
tensor([10974107,    59920,   202696,    64389,   457428,   457436,   457444,
          457452,   457462,   457471]) tensor([82039358, 32443913, 53021465,  6319265, 67940565, 51100786,  5506412,
        71166691, 77378447, 39038468])
-------Step 6-------
tensor([  469613,    61248,   469623,   469635, 33123887,   469646,   469655,
          212753,   469666,   463721]) tensor([63639562, 67202177, 83744783,  1338789, 75965572, 81266549, 46033643,
        27701979, 82455862, 78141431])
-------Step 7-------
tensor([  469613,    61248,   469623,   469635, 33123887,   469646,   469655,
          212753,   469666,   463721]) tensor([34378571, 56788597, 51684870, 35186949, 83723220,   186614, 80967133,
        79929276, 85714896, 57441738])
-------Step 8-------
tensor([41686892,   480930,   480943,   480955,   480966,   480978,   480992,
          481004,   481016, 29592651]) tensor([51406816, 68774097, 80858262, 46282707,    95787,  4344633, 30024724,
        38471586, 50896646, 12466337])
-------Step 9-------
tensor([41686892,   480930,   480943,   480955,   480966,   480978,   480992,
          481004,   481016, 29592651]) tensor([80205750, 35334526, 11948994, 26392123, 66899897, 18159835, 61738202,
        63115609, 82597519, 26836916])
before start barrier
start train
[proc 0] 100 steps, total: 43.223, sample: 1.024, forward: 7.873, backward: 31.546, update: 2.291
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 45.570, sample: 0.779, forward: 8.417, backward: 22.633, update: 0.346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.867 ms                  | 65.443 ms                 |
| bucket keys               | 2.340 ms                  | 3.144 ms                  |
| forward: a2a keys         | 3.020 ms                  | 51.542 ms                 |
| forward: search cache     | 501.478 us                | 693.121 us                |
| forward: a2a values       | 14.178 ms                 | 44.957 ms                 |
| forward: join             | 1.859 ms                  | 2.603 ms                  |
| Forward                   | 44.954 ms                 | 169.260 ms                |
| back: aggr dram keys      | 82.709 ms                 | 151.001 ms                |
| back: set dram grad       | 5.965 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.799 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 286.064 ms                | 435.275 ms                |
| Optimize                  | 21.407 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 61.924 us                 | 179.411 us                |
| BlockToStepN              | 80.932 us                 | 41.143 ms                 |
| OneStep                   | 382.374 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.576 ms                  | 65.443 ms                 |
| bucket keys               | 2.337 ms                  | 18.270 ms                 |
| forward: a2a keys         | 3.047 ms                  | 51.542 ms                 |
| forward: search cache     | 500.952 us                | 693.121 us                |
| forward: a2a values       | 14.178 ms                 | 44.957 ms                 |
| forward: join             | 1.859 ms                  | 2.603 ms                  |
| Forward                   | 44.921 ms                 | 169.260 ms                |
| back: aggr dram keys      | 82.151 ms                 | 151.001 ms                |
| back: set dram grad       | 5.930 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.799 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 285.089 ms                | 435.275 ms                |
| Optimize                  | 21.382 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 61.148 us                 | 179.411 us                |
| BlockToStepN              | 81.688 us                 | 41.143 ms                 |
| OneStep                   | 375.589 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.400 ms                  | 65.443 ms                 |
| bucket keys               | 2.330 ms                  | 3.376 ms                  |
| forward: a2a keys         | 3.082 ms                  | 51.542 ms                 |
| forward: search cache     | 500.813 us                | 690.202 us                |
| forward: a2a values       | 14.178 ms                 | 42.368 ms                 |
| forward: join             | 2.125 ms                  | 2.603 ms                  |
| Forward                   | 45.149 ms                 | 169.260 ms                |
| back: aggr dram keys      | 82.079 ms                 | 147.065 ms                |
| back: set dram grad       | 5.865 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.826 ms                 | 64.945 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 285.089 ms                | 435.275 ms                |
| Optimize                  | 21.373 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 60.426 us                 | 179.411 us                |
| BlockToStepN              | 79.926 us                 | 41.143 ms                 |
| OneStep                   | 381.601 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.223 ms                  | 65.443 ms                 |
| bucket keys               | 2.330 ms                  | 18.270 ms                 |
| forward: a2a keys         | 3.092 ms                  | 54.255 ms                 |
| forward: search cache     | 501.183 us                | 690.202 us                |
| forward: a2a values       | 14.182 ms                 | 44.957 ms                 |
| forward: join             | 2.125 ms                  | 2.603 ms                  |
| Forward                   | 45.408 ms                 | 169.260 ms                |
| back: aggr dram keys      | 82.079 ms                 | 147.065 ms                |
| back: set dram grad       | 5.865 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.826 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 288.306 ms                | 435.275 ms                |
| Optimize                  | 21.384 ms                 | 67.459 ms                 |
| BarrierTimeBeforeRank0    | 60.299 us                 | 179.411 us                |
| BlockToStepN              | 80.932 us                 | 41.143 ms                 |
| OneStep                   | 385.348 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.226 ms                  | 61.114 ms                 |
| bucket keys               | 2.337 ms                  | 18.270 ms                 |
| forward: a2a keys         | 3.085 ms                  | 64.533 ms                 |
| forward: search cache     | 501.273 us                | 690.202 us                |
| forward: a2a values       | 14.182 ms                 | 44.957 ms                 |
| forward: join             | 2.125 ms                  | 2.607 ms                  |
| Forward                   | 45.539 ms                 | 112.949 ms                |
| back: aggr dram keys      | 82.246 ms                 | 151.001 ms                |
| back: set dram grad       | 5.822 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.826 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 288.306 ms                | 428.672 ms                |
| Optimize                  | 21.407 ms                 | 49.262 ms                 |
| BarrierTimeBeforeRank0    | 60.426 us                 | 130.661 us                |
| BlockToStepN              | 81.770 us                 | 40.380 ms                 |
| OneStep                   | 383.778 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.226 ms                  | 61.114 ms                 |
| bucket keys               | 2.330 ms                  | 18.270 ms                 |
| forward: a2a keys         | 3.103 ms                  | 67.605 ms                 |
| forward: search cache     | 500.952 us                | 690.202 us                |
| forward: a2a values       | 14.182 ms                 | 44.957 ms                 |
| forward: join             | 2.125 ms                  | 2.607 ms                  |
| Forward                   | 45.503 ms                 | 112.949 ms                |
| back: aggr dram keys      | 82.079 ms                 | 151.001 ms                |
| back: set dram grad       | 5.832 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.841 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 139.194 ms                |
| Backward                  | 288.497 ms                | 428.672 ms                |
| Optimize                  | 21.384 ms                 | 49.262 ms                 |
| BarrierTimeBeforeRank0    | 61.148 us                 | 130.661 us                |
| BlockToStepN              | 82.360 us                 | 41.143 ms                 |
| OneStep                   | 385.537 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.258 ms                  | 61.114 ms                 |
| bucket keys               | 2.340 ms                  | 3.376 ms                  |
| forward: a2a keys         | 3.115 ms                  | 64.533 ms                 |
| forward: search cache     | 501.478 us                | 693.121 us                |
| forward: a2a values       | 14.182 ms                 | 44.957 ms                 |
| forward: join             | 2.125 ms                  | 2.617 ms                  |
| Forward                   | 45.734 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.900 ms                 | 151.001 ms                |
| back: set dram grad       | 5.832 ms                  | 8.493 ms                  |
| back: a2a grad            | 18.841 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 287.039 ms                | 428.672 ms                |
| Optimize                  | 21.434 ms                 | 49.262 ms                 |
| BarrierTimeBeforeRank0    | 61.451 us                 | 130.661 us                |
| BlockToStepN              | 82.595 us                 | 41.143 ms                 |
| OneStep                   | 383.778 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.135 ms                  | 61.114 ms                 |
| bucket keys               | 2.337 ms                  | 3.376 ms                  |
| forward: a2a keys         | 3.126 ms                  | 64.533 ms                 |
| forward: search cache     | 500.898 us                | 693.121 us                |
| forward: a2a values       | 14.200 ms                 | 46.805 ms                 |
| forward: join             | 2.125 ms                  | 2.617 ms                  |
| Forward                   | 45.936 ms                 | 141.939 ms                |
| back: aggr dram keys      | 81.684 ms                 | 151.001 ms                |
| back: set dram grad       | 5.844 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.828 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 286.064 ms                | 428.672 ms                |
| Optimize                  | 21.407 ms                 | 49.262 ms                 |
| BarrierTimeBeforeRank0    | 60.703 us                 | 130.661 us                |
| BlockToStepN              | 82.676 us                 | 41.143 ms                 |
| OneStep                   | 382.374 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 38.700, sample: 0.823, forward: 5.636, backward: 20.506, update: 0.219
[proc 0] 200 steps, total: 38.700, sample: 0.870, forward: 5.316, backward: 29.753, update: 2.246
[proc 5] 200 steps, total: 38.700, sample: 0.787, forward: 5.641, backward: 20.443, update: 0.255
[proc 6] 200 steps, total: 38.700, sample: 0.786, forward: 5.690, backward: 20.407, update: 0.238
[proc 3] 200 steps, total: 38.700, sample: 0.853, forward: 5.630, backward: 20.497, update: 0.220
[proc 1] 200 steps, total: 38.700, sample: 0.842, forward: 5.624, backward: 20.940, update: 0.240
[proc 4] 200 steps, total: 38.700, sample: 0.896, forward: 5.582, backward: 20.412, update: 0.247
[proc 2] 200 steps, total: 38.700, sample: 0.832, forward: 5.589, backward: 20.599, update: 0.227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.002 ms                  | 61.114 ms                 |
| bucket keys               | 2.340 ms                  | 3.376 ms                  |
| forward: a2a keys         | 3.139 ms                  | 64.533 ms                 |
| forward: search cache     | 500.813 us                | 693.121 us                |
| forward: a2a values       | 14.200 ms                 | 46.805 ms                 |
| forward: join             | 2.125 ms                  | 2.644 ms                  |
| Forward                   | 46.060 ms                 | 141.939 ms                |
| back: aggr dram keys      | 81.684 ms                 | 151.001 ms                |
| back: set dram grad       | 5.809 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.847 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 286.113 ms                | 428.672 ms                |
| Optimize                  | 21.407 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.875 us                 | 130.661 us                |
| BlockToStepN              | 82.360 us                 | 41.143 ms                 |
| OneStep                   | 380.097 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.977 ms                  | 61.114 ms                 |
| bucket keys               | 2.343 ms                  | 3.376 ms                  |
| forward: a2a keys         | 3.139 ms                  | 64.533 ms                 |
| forward: search cache     | 500.813 us                | 693.121 us                |
| forward: a2a values       | 14.200 ms                 | 54.156 ms                 |
| forward: join             | 2.125 ms                  | 2.673 ms                  |
| Forward                   | 46.060 ms                 | 141.939 ms                |
| back: aggr dram keys      | 81.865 ms                 | 151.001 ms                |
| back: set dram grad       | 5.809 ms                  | 8.645 ms                  |
| back: a2a grad            | 18.847 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 135.080 ms                |
| Backward                  | 287.039 ms                | 428.672 ms                |
| Optimize                  | 21.434 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 61.105 us                 | 130.661 us                |
| BlockToStepN              | 82.282 us                 | 41.143 ms                 |
| OneStep                   | 381.601 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.002 ms                  | 61.114 ms                 |
| bucket keys               | 2.347 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.126 ms                  | 54.255 ms                 |
| forward: search cache     | 500.740 us                | 693.121 us                |
| forward: a2a values       | 14.200 ms                 | 54.156 ms                 |
| forward: join             | 2.125 ms                  | 2.644 ms                  |
| Forward                   | 46.060 ms                 | 141.939 ms                |
| back: aggr dram keys      | 81.899 ms                 | 151.001 ms                |
| back: set dram grad       | 5.793 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.842 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 286.113 ms                | 428.672 ms                |
| Optimize                  | 21.454 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 61.148 us                 | 130.661 us                |
| BlockToStepN              | 81.770 us                 | 41.316 ms                 |
| OneStep                   | 380.097 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.051 ms                  | 61.114 ms                 |
| bucket keys               | 2.345 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.124 ms                  | 54.255 ms                 |
| forward: search cache     | 500.813 us                | 693.121 us                |
| forward: a2a values       | 14.220 ms                 | 60.761 ms                 |
| forward: join             | 2.125 ms                  | 2.644 ms                  |
| Forward                   | 46.033 ms                 | 141.939 ms                |
| back: aggr dram keys      | 82.079 ms                 | 152.558 ms                |
| back: set dram grad       | 5.773 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.842 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 286.064 ms                | 428.672 ms                |
| Optimize                  | 21.450 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 61.105 us                 | 130.661 us                |
| BlockToStepN              | 81.770 us                 | 41.316 ms                 |
| OneStep                   | 379.017 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.977 ms                  | 57.290 ms                 |
| bucket keys               | 2.343 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.126 ms                  | 54.255 ms                 |
| forward: search cache     | 501.183 us                | 693.121 us                |
| forward: a2a values       | 14.222 ms                 | 60.960 ms                 |
| forward: join             | 2.125 ms                  | 2.644 ms                  |
| Forward                   | 46.033 ms                 | 112.949 ms                |
| back: aggr dram keys      | 82.027 ms                 | 152.558 ms                |
| back: set dram grad       | 5.756 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.826 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 286.113 ms                | 411.346 ms                |
| Optimize                  | 21.444 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.875 us                 | 120.827 us                |
| BlockToStepN              | 82.282 us                 | 41.393 ms                 |
| OneStep                   | 379.017 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.881 ms                  | 58.746 ms                 |
| bucket keys               | 2.343 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.139 ms                  | 57.291 ms                 |
| forward: search cache     | 501.593 us                | 693.285 us                |
| forward: a2a values       | 14.222 ms                 | 60.960 ms                 |
| forward: join             | 2.125 ms                  | 2.673 ms                  |
| Forward                   | 46.086 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.899 ms                 | 163.843 ms                |
| back: set dram grad       | 5.735 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.801 ms                 | 76.523 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 285.405 ms                | 411.346 ms                |
| Optimize                  | 21.442 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.875 us                 | 120.827 us                |
| BlockToStepN              | 82.488 us                 | 41.393 ms                 |
| OneStep                   | 379.017 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.816 ms                  | 58.746 ms                 |
| bucket keys               | 2.343 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.169 ms                  | 54.255 ms                 |
| forward: search cache     | 501.478 us                | 693.121 us                |
| forward: a2a values       | 14.222 ms                 | 60.960 ms                 |
| forward: join             | 2.125 ms                  | 2.644 ms                  |
| Forward                   | 46.160 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.696 ms                 | 152.558 ms                |
| back: set dram grad       | 5.741 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.828 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 286.064 ms                | 411.346 ms                |
| Optimize                  | 21.442 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.587 us                 | 120.827 us                |
| BlockToStepN              | 82.488 us                 | 41.393 ms                 |
| OneStep                   | 380.097 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.840 ms                  | 58.746 ms                 |
| bucket keys               | 2.343 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.187 ms                  | 54.255 ms                 |
| forward: search cache     | 501.273 us                | 693.285 us                |
| forward: a2a values       | 14.200 ms                 | 60.960 ms                 |
| forward: join             | 2.125 ms                  | 2.666 ms                  |
| Forward                   | 46.145 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.606 ms                 | 152.558 ms                |
| back: set dram grad       | 5.732 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.828 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 285.753 ms                | 411.346 ms                |
| Optimize                  | 21.444 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.556 us                 | 120.827 us                |
| BlockToStepN              | 82.465 us                 | 41.393 ms                 |
| OneStep                   | 378.564 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 38.454, sample: 0.697, forward: 5.543, backward: 20.685, update: 0.215
[proc 0] 300 steps, total: 38.454, sample: 0.791, forward: 5.225, backward: 29.734, update: 2.256
[proc 2] 300 steps, total: 38.454, sample: 0.699, forward: 5.554, backward: 20.780, update: 0.226
[proc 5] 300 steps, total: 38.454, sample: 0.667, forward: 5.547, backward: 20.614, update: 0.252
[proc 4] 300 steps, total: 38.454, sample: 0.755, forward: 5.461, backward: 20.649, update: 0.245
[proc 6] 300 steps, total: 38.454, sample: 0.678, forward: 5.546, backward: 20.604, update: 0.234
[proc 3] 300 steps, total: 38.454, sample: 0.676, forward: 5.613, backward: 20.649, update: 0.220
[proc 1] 300 steps, total: 38.454, sample: 0.709, forward: 5.561, backward: 21.161, update: 0.240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.873 ms                  | 58.746 ms                 |
| bucket keys               | 2.343 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.205 ms                  | 54.255 ms                 |
| forward: search cache     | 501.258 us                | 693.285 us                |
| forward: a2a values       | 14.220 ms                 | 60.960 ms                 |
| forward: join             | 2.121 ms                  | 2.673 ms                  |
| Forward                   | 46.129 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.504 ms                 | 152.558 ms                |
| back: set dram grad       | 5.720 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.828 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 285.599 ms                | 411.346 ms                |
| Optimize                  | 21.450 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.529 us                 | 120.827 us                |
| BlockToStepN              | 82.465 us                 | 41.393 ms                 |
| OneStep                   | 378.412 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.873 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.187 ms                  | 54.255 ms                 |
| forward: search cache     | 500.952 us                | 694.525 us                |
| forward: a2a values       | 14.220 ms                 | 60.960 ms                 |
| forward: join             | 2.121 ms                  | 2.673 ms                  |
| Forward                   | 45.989 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.830 ms                 | 153.774 ms                |
| back: set dram grad       | 5.682 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.828 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 286.113 ms                | 411.346 ms                |
| Optimize                  | 21.451 ms                 | 63.988 ms                 |
| BarrierTimeBeforeRank0    | 60.434 us                 | 120.827 us                |
| BlockToStepN              | 82.360 us                 | 41.393 ms                 |
| OneStep                   | 378.379 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.816 ms                  | 58.746 ms                 |
| bucket keys               | 2.333 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.187 ms                  | 54.255 ms                 |
| forward: search cache     | 500.740 us                | 693.285 us                |
| forward: a2a values       | 14.220 ms                 | 60.761 ms                 |
| forward: join             | 2.121 ms                  | 2.666 ms                  |
| Forward                   | 45.920 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.899 ms                 | 153.774 ms                |
| back: set dram grad       | 5.682 ms                  | 8.494 ms                  |
| back: a2a grad            | 18.801 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 286.445 ms                | 428.672 ms                |
| Optimize                  | 21.454 ms                 | 63.988 ms                 |
| BarrierTimeBeforeRank0    | 60.429 us                 | 120.827 us                |
| BlockToStepN              | 82.282 us                 | 41.393 ms                 |
| OneStep                   | 378.634 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.782 ms                  | 57.290 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.219 ms                  | 54.255 ms                 |
| forward: search cache     | 501.183 us                | 694.525 us                |
| forward: a2a values       | 14.220 ms                 | 60.761 ms                 |
| forward: join             | 2.121 ms                  | 2.666 ms                  |
| Forward                   | 46.033 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.882 ms                 | 163.658 ms                |
| back: set dram grad       | 5.682 ms                  | 8.494 ms                  |
| back: a2a grad            | 18.826 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 287.039 ms                | 428.672 ms                |
| Optimize                  | 21.468 ms                 | 63.988 ms                 |
| BarrierTimeBeforeRank0    | 60.434 us                 | 120.827 us                |
| BlockToStepN              | 82.488 us                 | 41.393 ms                 |
| OneStep                   | 378.564 ms                | 544.537 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.729 ms                  | 57.290 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.243 ms                  | 57.291 ms                 |
| forward: search cache     | 500.952 us                | 694.525 us                |
| forward: a2a values       | 14.220 ms                 | 60.761 ms                 |
| forward: join             | 2.121 ms                  | 2.666 ms                  |
| Forward                   | 46.129 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.893 ms                 | 163.658 ms                |
| back: set dram grad       | 5.670 ms                  | 8.498 ms                  |
| back: a2a grad            | 18.826 ms                 | 73.414 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.800 ms                |
| Backward                  | 287.039 ms                | 411.346 ms                |
| Optimize                  | 21.470 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.426 us                 | 109.735 us                |
| BlockToStepN              | 82.676 us                 | 41.316 ms                 |
| OneStep                   | 378.634 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.758 ms                  | 58.746 ms                 |
| bucket keys               | 2.340 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.238 ms                  | 54.255 ms                 |
| forward: search cache     | 501.577 us                | 693.693 us                |
| forward: a2a values       | 14.220 ms                 | 54.156 ms                 |
| forward: join             | 2.121 ms                  | 2.666 ms                  |
| Forward                   | 46.145 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.893 ms                 | 153.774 ms                |
| back: set dram grad       | 5.665 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.801 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 287.039 ms                | 411.346 ms                |
| Optimize                  | 21.491 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.434 us                 | 109.735 us                |
| BlockToStepN              | 82.941 us                 | 41.393 ms                 |
| OneStep                   | 378.634 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.774 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.180 ms                  | 54.255 ms                 |
| forward: search cache     | 500.952 us                | 693.693 us                |
| forward: a2a values       | 14.220 ms                 | 54.156 ms                 |
| forward: join             | 2.121 ms                  | 2.666 ms                  |
| Forward                   | 46.033 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.882 ms                 | 153.774 ms                |
| back: set dram grad       | 5.665 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.815 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 286.064 ms                | 411.346 ms                |
| Optimize                  | 21.482 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.513 us                 | 109.735 us                |
| BlockToStepN              | 82.676 us                 | 41.393 ms                 |
| OneStep                   | 377.308 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 38.120, sample: 0.767, forward: 5.129, backward: 29.680, update: 2.237
[proc 5] 400 steps, total: 38.120, sample: 0.659, forward: 5.464, backward: 20.444, update: 0.252
[proc 1] 400 steps, total: 38.120, sample: 0.695, forward: 5.451, backward: 20.966, update: 0.241
[proc 4] 400 steps, total: 38.120, sample: 0.704, forward: 5.355, backward: 20.528, update: 0.241
[proc 7] 400 steps, total: 38.120, sample: 0.734, forward: 5.332, backward: 20.615, update: 0.217
[proc 6] 400 steps, total: 38.120, sample: 0.664, forward: 5.509, backward: 20.398, update: 0.234
[proc 2] 400 steps, total: 38.120, sample: 0.676, forward: 5.428, backward: 20.635, update: 0.232
[proc 3] 400 steps, total: 38.120, sample: 0.751, forward: 5.324, backward: 20.635, update: 0.220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.774 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.183 ms                  | 54.255 ms                 |
| forward: search cache     | 501.207 us                | 693.693 us                |
| forward: a2a values       | 14.222 ms                 | 54.156 ms                 |
| forward: join             | 2.125 ms                  | 2.673 ms                  |
| Forward                   | 46.033 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.893 ms                 | 163.658 ms                |
| back: set dram grad       | 5.663 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.815 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 286.064 ms                | 411.346 ms                |
| Optimize                  | 21.482 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.529 us                 | 109.735 us                |
| BlockToStepN              | 82.676 us                 | 41.591 ms                 |
| OneStep                   | 377.730 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.778 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.182 ms                  |
| forward: a2a keys         | 3.183 ms                  | 54.255 ms                 |
| forward: search cache     | 501.593 us                | 693.693 us                |
| forward: a2a values       | 14.222 ms                 | 54.156 ms                 |
| forward: join             | 2.125 ms                  | 2.690 ms                  |
| Forward                   | 46.086 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.899 ms                 | 163.658 ms                |
| back: set dram grad       | 5.670 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.800 ms                 | 71.198 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 133.324 ms                |
| Backward                  | 286.445 ms                | 411.346 ms                |
| Optimize                  | 21.482 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.513 us                 | 109.735 us                |
| BlockToStepN              | 82.681 us                 | 41.591 ms                 |
| OneStep                   | 377.730 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.715 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.211 ms                  | 54.255 ms                 |
| forward: search cache     | 501.273 us                | 693.285 us                |
| forward: a2a values       | 14.222 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 46.129 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.899 ms                 | 153.774 ms                |
| back: set dram grad       | 5.663 ms                  | 8.527 ms                  |
| back: a2a grad            | 18.815 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 132.720 ms                |
| Backward                  | 287.931 ms                | 411.346 ms                |
| Optimize                  | 21.492 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.513 us                 | 109.735 us                |
| BlockToStepN              | 82.681 us                 | 45.091 ms                 |
| OneStep                   | 378.412 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.669 ms                  | 58.746 ms                 |
| bucket keys               | 2.338 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.215 ms                  | 57.291 ms                 |
| forward: search cache     | 500.952 us                | 693.285 us                |
| forward: a2a values       | 14.222 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 46.094 ms                 | 114.459 ms                |
| back: aggr dram keys      | 81.899 ms                 | 153.774 ms                |
| back: set dram grad       | 5.662 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.841 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 132.720 ms                |
| Backward                  | 287.931 ms                | 411.346 ms                |
| Optimize                  | 21.505 ms                 | 61.300 ms                 |
| BarrierTimeBeforeRank0    | 60.426 us                 | 109.735 us                |
| BlockToStepN              | 82.595 us                 | 46.100 ms                 |
| OneStep                   | 378.564 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.698 ms                  | 57.290 ms                 |
| bucket keys               | 2.337 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.211 ms                  | 57.291 ms                 |
| forward: search cache     | 501.183 us                | 693.285 us                |
| forward: a2a values       | 14.211 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 46.086 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.899 ms                 | 153.774 ms                |
| back: set dram grad       | 5.656 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.841 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 132.720 ms                |
| Backward                  | 287.256 ms                | 411.346 ms                |
| Optimize                  | 21.505 ms                 | 52.127 ms                 |
| BarrierTimeBeforeRank0    | 60.299 us                 | 104.634 us                |
| BlockToStepN              | 82.681 us                 | 45.091 ms                 |
| OneStep                   | 378.379 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.704 ms                  | 57.290 ms                 |
| bucket keys               | 2.337 ms                  | 3.171 ms                  |
| forward: a2a keys         | 3.195 ms                  | 57.291 ms                 |
| forward: search cache     | 500.697 us                | 693.285 us                |
| forward: a2a values       | 14.220 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 45.985 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.899 ms                 | 153.774 ms                |
| back: set dram grad       | 5.654 ms                  | 8.552 ms                  |
| back: a2a grad            | 18.848 ms                 | 70.597 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 132.720 ms                |
| Backward                  | 287.256 ms                | 411.346 ms                |
| Optimize                  | 21.514 ms                 | 52.127 ms                 |
| BarrierTimeBeforeRank0    | 60.299 us                 | 104.634 us                |
| BlockToStepN              | 82.839 us                 | 45.091 ms                 |
| OneStep                   | 377.308 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.715 ms                  | 57.290 ms                 |
| bucket keys               | 2.337 ms                  | 3.166 ms                  |
| forward: a2a keys         | 3.205 ms                  | 54.255 ms                 |
| forward: search cache     | 500.660 us                | 693.285 us                |
| forward: a2a values       | 14.222 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 45.908 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.893 ms                 | 152.558 ms                |
| back: set dram grad       | 5.654 ms                  | 8.527 ms                  |
| back: a2a grad            | 18.848 ms                 | 69.481 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 131.353 ms                |
| Backward                  | 286.323 ms                | 411.346 ms                |
| Optimize                  | 21.518 ms                 | 52.127 ms                 |
| BarrierTimeBeforeRank0    | 60.221 us                 | 104.634 us                |
| BlockToStepN              | 82.723 us                 | 45.091 ms                 |
| OneStep                   | 377.308 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.665 ms                  | 57.290 ms                 |
| bucket keys               | 2.334 ms                  | 3.166 ms                  |
| forward: a2a keys         | 3.238 ms                  | 54.255 ms                 |
| forward: search cache     | 500.604 us                | 693.285 us                |
| forward: a2a values       | 14.220 ms                 | 53.187 ms                 |
| forward: join             | 2.125 ms                  | 2.680 ms                  |
| Forward                   | 45.885 ms                 | 112.949 ms                |
| back: aggr dram keys      | 81.893 ms                 | 152.558 ms                |
| back: set dram grad       | 5.653 ms                  | 8.527 ms                  |
| back: a2a grad            | 18.848 ms                 | 69.481 ms                 |
| back: grad sum & grad cache  | 7.716 ms                  | 132.720 ms                |
| Backward                  | 286.445 ms                | 411.346 ms                |
| Optimize                  | 21.521 ms                 | 52.127 ms                 |
| BarrierTimeBeforeRank0    | 60.184 us                 | 104.634 us                |
| BlockToStepN              | 83.072 us                 | 45.091 ms                 |
| OneStep                   | 377.730 ms                | 534.956 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 38.049, sample: 0.662, forward: 5.374, backward: 20.520, update: 0.221
[proc 1] 500 steps, total: 38.049, sample: 0.672, forward: 5.339, backward: 20.929, update: 0.250
[proc 6] 500 steps, total: 38.049, sample: 0.658, forward: 5.331, backward: 20.447, update: 0.230
[proc 2] 500 steps, total: 38.049, sample: 0.696, forward: 5.287, backward: 20.592, update: 0.227
[proc 0] 500 steps, total: 38.049, sample: 0.735, forward: 5.070, backward: 29.545, update: 2.223
[proc 4] 500 steps, total: 38.049, sample: 0.699, forward: 5.331, backward: 20.417, update: 0.242
[proc 5] 500 steps, total: 38.049, sample: 0.651, forward: 5.326, backward: 20.446, update: 0.248
[proc 7] 500 steps, total: 38.049, sample: 0.663, forward: 5.328, backward: 20.549, update: 0.217
Successfully xmh. training takes 196.5471739768982 seconds
before call kg_cache_controller.StopThreads()
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
INFO [61606 controller_process.py:380] call rank0 to StopThreads
