WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 18:47:08.700829 41062 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_87', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41062 sampler.py:454] Start PreSampling
WARNING [41062 sampler.py:532] Before construct renumbering_dict
WARNING [41062 sampler.py:555] PreSampling done
W20240124 19:00:31.435282 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 19:00:31.435492 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 19:00:31.435523 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 19:00:31.435549 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 19:00:31.435568 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 19:00:31.435593 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 19:00:31.435616 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 19:00:31.435653 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 19:00:31.435673 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 19:00:31.435694 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 19:00:31.435719 41062 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 19:00:31.435739 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 19:00:31.435756 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 19:00:31.435889 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 19:00:31.435917 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 19:00:31.435935 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 19:00:31.435971 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 19:00:31.435988 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 19:00:31.436007 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 19:00:31.436031 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 19:00:31.436050 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 19:00:31.436070 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 19:00:31.436097 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 19:00:31.436115 41062 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 19:00:31.436128 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 19:00:31.436151 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 19:00:31.436192 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 19:00:31.436213 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 19:00:31.436229 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 19:00:31.436249 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 19:00:31.436268 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 19:00:31.436286 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 19:00:31.436318 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 19:00:31.436338 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 19:00:31.436360 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 19:00:31.436383 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 19:00:31.436403 41062 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 19:00:31.436419 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 19:00:31.436432 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 19:00:31.436477 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 19:00:31.436504 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 19:00:31.436523 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 19:00:31.436540 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 19:00:31.436564 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 19:00:31.436580 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 19:00:31.436605 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 19:00:31.436625 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 19:00:31.436650 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 19:00:31.436667 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 19:00:31.436689 41062 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 19:00:31.436703 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 19:00:31.436717 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 19:00:31.436753 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 19:00:31.436782 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 19:00:31.436816 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 19:00:31.436838 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 19:00:31.436865 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 19:00:31.436882 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 19:00:31.436904 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 19:00:31.436926 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 19:00:31.436959 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 19:00:31.436982 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 19:00:31.437000 41062 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 19:00:31.437014 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 19:00:31.437031 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 19:00:31.437074 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 19:00:31.437095 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 19:00:31.437112 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 19:00:31.437131 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 19:00:31.437150 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 19:00:31.437172 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 19:00:31.437194 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 19:00:31.437213 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 19:00:31.437240 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 19:00:31.437259 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 19:00:31.437280 41062 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 19:00:31.437294 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 19:00:31.437314 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 19:00:31.437351 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 19:00:31.437377 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 19:00:31.437395 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 19:00:31.437412 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 19:00:31.437434 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 19:00:31.437456 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 19:00:31.437472 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 19:00:31.437491 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 19:00:31.437512 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 19:00:31.437530 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 19:00:31.437548 41062 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 19:00:31.437566 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 19:00:31.437579 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 19:00:31.437613 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 19:00:31.437637 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 19:00:31.437656 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 19:00:31.437680 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 19:00:31.437700 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 19:00:31.437721 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 19:00:31.437743 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 19:00:31.437764 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 19:00:31.437791 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 19:00:31.437808 41062 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 19:00:31.437826 41062 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 19:00:31.437839 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 19:00:31.437852 41062 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 19:00:31.776582 41062 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 19:00:31.776762 41062 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302714,  4302734,  4302765,  ..., 56345177, 17498597, 29313196]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 979.583 seconds
[Rank1] pid = 8383
[Rank2] pid = 8532
[Rank3] pid = 8614
[Rank4] pid = 8693
[Rank5] pid = 8768
[Rank6] pid = 8858
INFO [41062 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [8383 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [8532 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [8614 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [8693 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [8768 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [8941 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [8858 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [8768 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8858 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8693 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8941 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41062 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8614 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8532 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8383 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 19:03:36.664234  8774 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 19:03:36.666580  8533 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 19:03:36.668972  8942 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240124 19:03:36.669062  8859 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240124 19:03:36.669100  8615 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 19:03:36.669373  8695 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 19:03:36.669386  8399 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 19:03:36.690055  8964 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 19:03:36.811290  8774 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x102027243000 781.2 kB
W20240124 19:03:36.811825  8774 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x102027314000 781.2 kB
W20240124 19:03:36.811988  8533 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020273db000 781.2 kB
W20240124 19:03:36.811995  8859 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x1020274a0000 781.2 kB
W20240124 19:03:36.812041  8774 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x102027565000 152.6 MB
W20240124 19:03:36.812072  8695 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102030dfd000 781.2 kB
W20240124 19:03:36.812090  8615 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x102030ec2000 781.2 kB
W20240124 19:03:36.812125  8399 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x102030f87000 781.2 kB
W20240124 19:03:36.812140  8942 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x10203104c000 781.2 kB
W20240124 19:03:36.812146  8964 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x102031111000 781.2 kB
W20240124 19:03:36.812209  8774 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x1020311d6000 152.6 MB
W20240124 19:03:36.812543  8774 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 19:03:36.812741  8964 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10203aa6e000 781.2 kB
W20240124 19:03:36.812947  8399 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x10203ab33000 781.2 kB
W20240124 19:03:36.813491  8964 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10203abf8000 152.6 MB
W20240124 19:03:36.813601  8964 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10204dded000 152.6 MB
W20240124 19:03:36.813585  8615 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x102044490000 781.2 kB
W20240124 19:03:36.813599  8399 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x102044555000 152.6 MB
W20240124 19:03:36.813655  8533 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x102057685000 781.2 kB
W20240124 19:03:36.813676  8964 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 19:03:36.813670  8695 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10205774a000 781.2 kB
W20240124 19:03:36.813755  8399 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10205780f000 152.6 MB
W20240124 19:03:36.813853  8942 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x1020610a7000 781.2 kB
W20240124 19:03:36.813903  8859 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10206116c000 781.2 kB
W20240124 19:03:36.813926  8399 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 19:03:36.814110  8695 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x102061231000 152.6 MB
W20240124 19:03:36.814256  8859 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10206aac9000 152.6 MB
W20240124 19:03:36.814267  8942 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x102074361000 152.6 MB
W20240124 19:03:36.814278  8695 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10207dbf9000 152.6 MB
W20240124 19:03:36.814308  8533 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102087491000 152.6 MB
W20240124 19:03:36.814322  8615 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x102090d29000 152.6 MB
W20240124 19:03:36.814399  8859 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10209a5c1000 152.6 MB
W20240124 19:03:36.814420  8942 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x1020a3e59000 152.6 MB
W20240124 19:03:36.814460  8533 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 19:03:36.814471  8615 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 19:03:36.814621  8942 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 19:03:36.814630  8533 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 19:03:36.814836  8615 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 19:03:36.814862  8859 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 19:03:36.814888  8695 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 19:03:36.817314  8774 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 19:03:36.820719  8964 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 19:03:36.821681  8399 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 19:03:36.822548  8942 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 19:03:36.822587  8533 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 19:03:36.822764  8615 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 19:03:36.822839  8859 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 19:03:36.822885  8695 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [8941 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [8768 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8693 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8858 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [8614 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 8941
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [41062 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [8383 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8532 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 19:04:25.172468  8533 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172554  8399 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172627  8774 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172773  8615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172902  8964 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172935  8942 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.172976  8695 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 19:04:25.173017  8859 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 19:04:25.175851  8964 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 19:04:25.176071  8964 grad_base.h:172] Init GradProcessingBase done
I20240124 19:04:34.483594  8964 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 19:04:34.483759  8964 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 19:04:34.483767  8964 kg_controller.h:84] Construct KGCacheController done
I20240124 19:04:35.272588  8964 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 19:04:53.019605 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 19:04:53.019969 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 19:04:54.560495 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 19:04:54.560631 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 19:04:55.887190 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 19:04:55.887349 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 19:04:57.527513 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 19:04:57.539054 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 19:04:57.563305  8942 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
W20240124 19:04:59.046078 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 19:04:59.057952 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 19:04:59.088714  8774 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 19:04:59.151540  8533 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 19:04:59.418797  8615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 19:05:01.931409 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 19:05:01.942896 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 19:05:01.971369  8859 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 19:05:02.749979  8964 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 19:05:02.942013 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240124 19:05:03.359676 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
I20240124 19:05:03.402660  8695 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 19:05:06.872524 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 19:05:06.884651 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 19:05:06.944371  8399 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 19:05:09.293754  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 19:05:09.585255  8964 grad_async_v2.h:236] pq is empty
W20240124 19:05:09.588680 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 19:05:09.970427  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.187 ms                 | 29.708 ms                 |
| Forward                   | 10.057 ms                 | 940.700 ms                |
| Backward                  | 6.864 ms                  | 180.894 ms                |
| Optimize                  | 1.803 ms                  | 3.629 ms                  |
| BarrierTimeBeforeRank0    | 26.860 us                 | 137.571 ms                |
| AfterBackward             | 91.716 ms                 | 1.364 s                   |
| BlockToStepN              | 163.965 us                | 22.017 ms                 |
| OneStep                   | 140.807 ms                | 2.637 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.498 ms                  | 344.931 ms                |
| ProcessBack:UpdateCache   | 11.695 ms                 | 720.869 ms                |
| ProcessBack:UpsertPq      | 71.103 ms                 | 289.489 ms                |
| ProcessOneStep            | 91.683 ms                 | 1.363 s                   |
| BlockToStepN              | 111.634 us                | 21.893 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:10.293012  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=508
W20240124 19:05:10.771498 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
W20240124 19:05:11.198702  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
E20240124 19:05:11.293030 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=966
W20240124 19:05:11.793375 11138 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240124 19:05:12.229935  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240124 19:05:12.293028 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=32962
W20240124 19:05:12.819253 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
W20240124 19:05:13.229032  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=20
E20240124 19:05:13.293009 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1389
W20240124 19:05:13.531764 11137 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240124 19:05:13.851181 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240124 19:05:14.233839  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240124 19:05:14.293006 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=39950
W20240124 19:05:14.956753 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.066 ms                 | 116.110 ms                |
| Forward                   | 5.354 ms                  | 940.700 ms                |
| Backward                  | 5.117 ms                  | 180.894 ms                |
| Optimize                  | 2.052 ms                  | 4.109 ms                  |
| BarrierTimeBeforeRank0    | 59.343 us                 | 137.571 ms                |
| AfterBackward             | 82.990 ms                 | 1.364 s                   |
| BlockToStepN              | 43.194 ms                 | 173.061 ms                |
| OneStep                   | 190.926 ms                | 2.637 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:05:15.233062  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.368 ms                  | 344.336 ms                |
| ProcessBack:UpdateCache   | 9.776 ms                  | 720.803 ms                |
| ProcessBack:UpsertPq      | 32.115 ms                 | 199.054 ms                |
| ProcessOneStep            | 82.938 ms                 | 1.363 s                   |
| BlockToStepN              | 50.640 ms                 | 172.959 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:15.293008 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=57008
W20240124 19:05:16.034330 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
W20240124 19:05:16.233024  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=37, pq.top=37
E20240124 19:05:16.293009  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=186
W20240124 19:05:17.162683 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
W20240124 19:05:17.233042  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=42, pq.top=42
E20240124 19:05:17.293012 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=171
W20240124 19:05:18.194691 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
E20240124 19:05:18.293068 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=11361
W20240124 19:05:18.302076  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240124 19:05:19.259927 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240124 19:05:19.293009 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=17759
W20240124 19:05:19.302057  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.482 ms                  | 92.254 ms                 |
| Forward                   | 5.227 ms                  | 23.391 ms                 |
| Backward                  | 5.196 ms                  | 8.673 ms                  |
| Optimize                  | 2.234 ms                  | 4.400 ms                  |
| BarrierTimeBeforeRank0    | 4.129 ms                  | 46.144 ms                 |
| AfterBackward             | 82.990 ms                 | 189.981 ms                |
| BlockToStepN              | 60.888 ms                 | 209.844 ms                |
| OneStep                   | 204.983 ms                | 402.590 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.365 ms                  | 344.336 ms                |
| ProcessBack:UpdateCache   | 10.261 ms                 | 720.803 ms                |
| ProcessBack:UpsertPq      | 31.038 ms                 | 199.054 ms                |
| ProcessOneStep            | 82.938 ms                 | 189.923 ms                |
| BlockToStepN              | 60.780 ms                 | 209.662 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:20.308164 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=2063
W20240124 19:05:20.325125  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240124 19:05:20.330906 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 19:05:21.308013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=7903
W20240124 19:05:21.372530  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240124 19:05:21.613337 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240124 19:05:22.308017 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1549
W20240124 19:05:22.654901 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
W20240124 19:05:22.979540  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
E20240124 19:05:23.308019 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=56336
W20240124 19:05:23.759891 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 19:05:23.979157  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=66, pq.top=66
E20240124 19:05:24.308017 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=34053
W20240124 19:05:24.794859 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
W20240124 19:05:25.157840  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.320 ms                  | 100.535 ms                |
| Forward                   | 5.237 ms                  | 23.391 ms                 |
| Backward                  | 5.266 ms                  | 8.673 ms                  |
| Optimize                  | 2.238 ms                  | 4.682 ms                  |
| BarrierTimeBeforeRank0    | 1.161 ms                  | 46.144 ms                 |
| AfterBackward             | 89.929 ms                 | 1.364 s                   |
| BlockToStepN              | 54.289 ms                 | 209.844 ms                |
| OneStep                   | 216.651 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.470 ms                  | 344.336 ms                |
| ProcessBack:UpdateCache   | 10.264 ms                 | 720.803 ms                |
| ProcessBack:UpsertPq      | 34.671 ms                 | 289.489 ms                |
| ProcessOneStep            | 89.895 ms                 | 1.363 s                   |
| BlockToStepN              | 60.408 ms                 | 209.662 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:25.308013 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=148
W20240124 19:05:25.999992 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 19:05:26.308012 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=188
W20240124 19:05:27.145078 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240124 19:05:27.308015 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240124 19:05:27.742419  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240124 19:05:28.187319 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240124 19:05:28.308010  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=8387
W20240124 19:05:28.742096  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240124 19:05:29.233520 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 19:05:29.320240 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 19:05:29.747812  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=88, pq.top=88
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.486 ms                  | 107.419 ms                |
| Forward                   | 5.334 ms                  | 23.391 ms                 |
| Backward                  | 5.344 ms                  | 8.673 ms                  |
| Optimize                  | 2.274 ms                  | 7.765 ms                  |
| BarrierTimeBeforeRank0    | 57.782 us                 | 73.452 ms                 |
| AfterBackward             | 86.086 ms                 | 1.442 s                   |
| BlockToStepN              | 59.149 ms                 | 209.844 ms                |
| OneStep                   | 203.519 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.365 ms                  | 26.929 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 16.462 ms                 |
| ProcessBack:UpsertPq      | 33.614 ms                 | 201.813 ms                |
| ProcessOneStep            | 86.041 ms                 | 1.442 s                   |
| BlockToStepN              | 60.408 ms                 | 209.662 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 19:05:30.301571 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240124 19:05:30.320004 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=3008
E20240124 19:05:31.320010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=52
W20240124 19:05:31.371824 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240124 19:05:31.587388  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240124 19:05:32.320014 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=76482
W20240124 19:05:32.385193 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 19:05:32.680495  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 30.887, sample: 1.210, forward: 1.379, backward: 0.795, update: 0.250
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 35.296, sample: 1.341, forward: 1.429, backward: 0.844, update: 0.239
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 33.440, sample: 1.160, forward: 1.450, backward: 0.848, update: 0.248
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 33.770, sample: 1.459, forward: 1.424, backward: 0.783, update: 0.231
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.915, sample: 1.241, forward: 1.589, backward: 0.736, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.456, sample: 1.326, forward: 1.411, backward: 0.772, update: 0.232
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.707, sample: 1.246, forward: 1.473, backward: 0.802, update: 0.235
train_sampler.Prefill()
-------Step 0-------
tensor([ 11579,   8323, 264176,   8340,   8371,   8391,  11622,   8419,   8440,
          8470]) tensor([ 5742041,  9348498, 52334359, 57365603, 21448040,   369319, 19956888,
        57259979, 51804432,  1755502])
-------Step 1-------
tensor([ 11579,   8323, 264176,   8340,   8371,   8391,  11622,   8419,   8440,
          8470]) tensor([44446009, 43812749, 41511542,   239770,  1102877, 53596541, 47272501,
         1203275, 69869709, 29823326])
-------Step 2-------
tensor([   60100,    60127,    60151,    60179,    60194, 55725651, 79575945,
           60217, 42066134,    60240]) tensor([64173227, 44513098, 23780680, 11547724, 29879139, 43749063, 59433775,
        40272205, 78109729, 18541627])
-------Step 3-------
tensor([   60100,    60127,    60151,    60179,    60194, 55725651, 79575945,
           60217, 42066134,    60240]) tensor([83851265, 68099142, 49516474, 44402415, 10337805, 66140926, 83160527,
        10346100, 75396337,   350360])
-------Step 4-------
tensor([  219711,   113385,   113405,  4349926,   113428,   113454,   113469,
        19369348,   113489,   113514]) tensor([28214752, 25433523, 77649082, 42823300,  7809798, 11051439, 41828616,
        12485191, 75861537, 85189980])
-------Step 5-------
tensor([  219711,   113385,   113405,  4349926,   113428,   113454,   113469,
        19369348,   113489,   113514]) tensor([ 1029714, 55150795,  5771471, 42083657, 35005144, 77254051, 39330812,
        25581286, 68580108, 46745443])
-------Step 6-------
tensor([244743, 167805, 167822,  65132,  65172, 167837,  65221, 167858, 167876,
         13886]) tensor([14879032, 76585988, 25519167, 52477184, 24065964, 51887365, 19041910,
        22880044, 25341259, 66359693])
-------Step 7-------
tensor([244743, 167805, 167822,  65132,  65172, 167837,  65221, 167858, 167876,
         13886]) tensor([43106507, 36450699, 57344910, 69707612, 33753187,  2002444, 50270906,
        83297892, 79506953, 76627305])
-------Step 8-------
tensor([  220941,  7146944,   220960,   270124, 10657865,   220985, 23980733,
           82993,    83026,   221007]) tensor([ 1193402, 35589875, 62038271,  6153613, 51196834, 39243927,  5996105,
        57605741, 62083869, 54011486])
-------Step 9-------
tensor([  220941,  7146944,   220960,   270124, 10657865,   220985, 23980733,
           82993,    83026,   221007]) tensor([75736846, 26631470, 13379913, 79845775,  7784468, 36682737, 51870396,
        61894991, 20036632, 21076712])
before start barrier
start train
[proc 0] 100 steps, total: 30.109, sample: 1.780, forward: 1.509, backward: 0.719, update: 0.269
E20240124 19:05:33.320034  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240124 19:05:33.385084 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 19:05:33.680171  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240124 19:05:34.320009  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=125
W20240124 19:05:34.403914 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 19:05:34.680089  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.320 ms                  | 107.419 ms                |
| Forward                   | 5.406 ms                  | 23.391 ms                 |
| Backward                  | 5.406 ms                  | 8.673 ms                  |
| Optimize                  | 2.322 ms                  | 7.765 ms                  |
| BarrierTimeBeforeRank0    | 59.343 us                 | 73.452 ms                 |
| AfterBackward             | 80.431 ms                 | 1.442 s                   |
| BlockToStepN              | 60.888 ms                 | 274.929 ms                |
| OneStep                   | 200.412 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.459 ms                  | 26.929 ms                 |
| ProcessBack:UpdateCache   | 9.753 ms                  | 16.462 ms                 |
| ProcessBack:UpsertPq      | 32.115 ms                 | 201.813 ms                |
| ProcessOneStep            | 80.384 ms                 | 1.442 s                   |
| BlockToStepN              | 61.077 ms                 | 301.109 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:35.320013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=76755
W20240124 19:05:35.406713 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 19:05:35.680037  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240124 19:05:36.320010 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=75470
W20240124 19:05:36.406872 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 19:05:36.680017  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240124 19:05:37.320009 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=80557
W20240124 19:05:37.412788 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 19:05:37.688582  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240124 19:05:38.320008 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=83789
W20240124 19:05:38.473719 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 19:05:38.688041  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=123, pq.top=123
E20240124 19:05:39.323499 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=66274
W20240124 19:05:39.473484 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 19:05:39.688349  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.486 ms                  | 107.419 ms                |
| Forward                   | 5.385 ms                  | 23.391 ms                 |
| Backward                  | 5.462 ms                  | 8.673 ms                  |
| Optimize                  | 2.345 ms                  | 7.765 ms                  |
| BarrierTimeBeforeRank0    | 285.500 us                | 84.879 ms                 |
| AfterBackward             | 77.653 ms                 | 1.442 s                   |
| BlockToStepN              | 66.451 ms                 | 311.201 ms                |
| OneStep                   | 203.519 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.470 ms                  | 22.056 ms                 |
| ProcessBack:UpdateCache   | 9.540 ms                  | 15.249 ms                 |
| ProcessBack:UpsertPq      | 31.740 ms                 | 199.664 ms                |
| ProcessOneStep            | 77.613 ms                 | 1.442 s                   |
| BlockToStepN              | 66.183 ms                 | 311.069 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:40.323014 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=71787
W20240124 19:05:40.479257 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 19:05:40.688063  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=131, pq.top=131
E20240124 19:05:41.379812 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=3304
W20240124 19:05:41.499529 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 19:05:41.688294  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240124 19:05:42.379014 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=44775
W20240124 19:05:42.510782 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 19:05:42.700954  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
E20240124 19:05:43.379012 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=2161
W20240124 19:05:43.532876 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 19:05:43.713336  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240124 19:05:44.379010 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=57853
W20240124 19:05:44.548221 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 19:05:44.713299  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.486 ms                  | 116.110 ms                |
| Forward                   | 5.425 ms                  | 43.312 ms                 |
| Backward                  | 5.485 ms                  | 10.888 ms                 |
| Optimize                  | 2.386 ms                  | 7.765 ms                  |
| BarrierTimeBeforeRank0    | 285.500 us                | 84.879 ms                 |
| AfterBackward             | 77.068 ms                 | 1.442 s                   |
| BlockToStepN              | 69.025 ms                 | 357.820 ms                |
| OneStep                   | 210.170 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.498 ms                  | 22.056 ms                 |
| ProcessBack:UpdateCache   | 9.492 ms                  | 15.249 ms                 |
| ProcessBack:UpsertPq      | 31.740 ms                 | 199.664 ms                |
| ProcessOneStep            | 76.733 ms                 | 1.442 s                   |
| BlockToStepN              | 68.849 ms                 | 357.679 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:45.379014 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=24724
W20240124 19:05:45.636432 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 19:05:45.713382  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240124 19:05:46.379016  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=10261
W20240124 19:05:46.654923 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 19:05:46.713248  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=156
E20240124 19:05:47.379011  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=3671
W20240124 19:05:47.654561 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 19:05:47.756585  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240124 19:05:48.379009 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=9159
W20240124 19:05:48.666873 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 19:05:48.756294  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240124 19:05:49.421182 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 19:05:49.678339 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 19:05:49.854473  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.082 ms                 | 140.145 ms                |
| Forward                   | 5.425 ms                  | 23.391 ms                 |
| Backward                  | 5.506 ms                  | 10.192 ms                 |
| Optimize                  | 2.386 ms                  | 6.565 ms                  |
| BarrierTimeBeforeRank0    | 75.448 us                 | 73.452 ms                 |
| AfterBackward             | 77.068 ms                 | 1.364 s                   |
| BlockToStepN              | 76.513 ms                 | 311.715 ms                |
| OneStep                   | 216.651 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.484 ms                  | 22.056 ms                 |
| ProcessBack:UpdateCache   | 9.300 ms                  | 15.249 ms                 |
| ProcessBack:UpsertPq      | 31.038 ms                 | 199.664 ms                |
| ProcessOneStep            | 76.733 ms                 | 1.363 s                   |
| BlockToStepN              | 71.156 ms                 | 311.576 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:50.421034 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=20637
W20240124 19:05:50.699796 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 19:05:50.854684  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240124 19:05:51.421010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=65005
W20240124 19:05:51.753661 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 19:05:51.879835  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240124 19:05:52.421008 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=4464
W20240124 19:05:52.770267 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
W20240124 19:05:53.343657  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240124 19:05:53.421010 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=48031
W20240124 19:05:53.790422 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240124 19:05:54.421008  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=10006
W20240124 19:05:54.460500  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240124 19:05:54.812471 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.540 ms                 | 149.432 ms                |
| Forward                   | 5.425 ms                  | 23.391 ms                 |
| Backward                  | 5.554 ms                  | 10.192 ms                 |
| Optimize                  | 2.382 ms                  | 6.565 ms                  |
| BarrierTimeBeforeRank0    | 53.964 us                 | 73.452 ms                 |
| AfterBackward             | 77.068 ms                 | 1.364 s                   |
| BlockToStepN              | 76.579 ms                 | 311.715 ms                |
| OneStep                   | 216.651 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.503 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.257 ms                  | 15.155 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 199.054 ms                |
| ProcessOneStep            | 77.018 ms                 | 1.363 s                   |
| BlockToStepN              | 76.462 ms                 | 311.576 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:05:55.421012 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=20433
W20240124 19:05:55.460522  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240124 19:05:55.894040 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240124 19:05:56.421010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1618
W20240124 19:05:56.463413  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=198, pq.top=198
W20240124 19:05:56.935065 11138 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
[proc 6] 200 steps, total: 24.377, sample: 1.399, forward: 0.542, backward: 0.560, update: 0.240
[proc 5] 200 steps, total: 24.377, sample: 1.910, forward: 0.516, backward: 0.572, update: 0.234
[proc 2] 200 steps, total: 24.376, sample: 1.436, forward: 0.487, backward: 0.511, update: 0.235
[proc 3] 200 steps, total: 24.377, sample: 1.832, forward: 0.483, backward: 0.667, update: 0.228
[proc 1] 200 steps, total: 24.376, sample: 1.303, forward: 0.557, backward: 0.619, update: 0.233
[proc 7] 200 steps, total: 24.377, sample: 1.519, forward: 0.519, backward: 0.689, update: 0.250
[proc 4] 200 steps, total: 24.376, sample: 1.463, forward: 0.520, backward: 0.569, update: 0.260
[proc 0] 200 steps, total: 24.375, sample: 3.933, forward: 0.575, backward: 0.588, update: 0.252
E20240124 19:05:57.421013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=112823
W20240124 19:05:57.522318  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240124 19:05:57.952739 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 19:05:58.421010 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=55131
W20240124 19:05:58.523963  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240124 19:05:58.980047 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240124 19:05:59.421015 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=5044
W20240124 19:05:59.523077  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240124 19:05:59.990548 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.647 ms                 | 400.979 ms                |
| Forward                   | 5.391 ms                  | 23.391 ms                 |
| Backward                  | 5.556 ms                  | 10.192 ms                 |
| Optimize                  | 2.372 ms                  | 6.565 ms                  |
| BarrierTimeBeforeRank0    | 39.382 us                 | 73.452 ms                 |
| AfterBackward             | 76.567 ms                 | 1.364 s                   |
| BlockToStepN              | 82.327 ms                 | 311.997 ms                |
| OneStep                   | 216.776 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.514 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.223 ms                  | 15.155 ms                 |
| ProcessBack:UpsertPq      | 30.724 ms                 | 199.054 ms                |
| ProcessOneStep            | 76.551 ms                 | 1.363 s                   |
| BlockToStepN              | 82.191 ms                 | 311.857 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:00.421011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=29860
W20240124 19:06:00.523432  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240124 19:06:01.019533 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240124 19:06:01.421011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=32219
W20240124 19:06:01.618095  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240124 19:06:02.049643 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 19:06:02.421015 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=18646
W20240124 19:06:02.618633  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240124 19:06:03.064903 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 19:06:03.421015 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=61945
W20240124 19:06:03.618234  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240124 19:06:04.108551 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 19:06:04.421011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=41150
W20240124 19:06:04.829587  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240124 19:06:05.122488 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.022 ms                 | 400.979 ms                |
| Forward                   | 5.406 ms                  | 23.391 ms                 |
| Backward                  | 5.581 ms                  | 10.192 ms                 |
| Optimize                  | 2.386 ms                  | 6.565 ms                  |
| BarrierTimeBeforeRank0    | 38.348 us                 | 73.452 ms                 |
| AfterBackward             | 77.179 ms                 | 1.364 s                   |
| BlockToStepN              | 84.479 ms                 | 427.822 ms                |
| OneStep                   | 218.654 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.529 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.213 ms                  | 14.411 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 175.861 ms                |
| ProcessOneStep            | 77.018 ms                 | 1.363 s                   |
| BlockToStepN              | 82.191 ms                 | 427.653 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:05.421013 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=19356
W20240124 19:06:05.836647  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240124 19:06:06.124707 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 19:06:06.421015 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=85094
W20240124 19:06:06.836156  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240124 19:06:07.143754 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240124 19:06:07.421018 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=119616
W20240124 19:06:07.836468  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240124 19:06:08.244004 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 19:06:08.431528 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=85028
W20240124 19:06:08.836321  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240124 19:06:09.270193 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 19:06:09.431015  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=728
W20240124 19:06:09.836781  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=246, pq.top=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.235 ms                 | 509.983 ms                |
| Forward                   | 5.450 ms                  | 23.391 ms                 |
| Backward                  | 5.632 ms                  | 10.192 ms                 |
| Optimize                  | 2.424 ms                  | 6.565 ms                  |
| BarrierTimeBeforeRank0    | 38.857 us                 | 73.452 ms                 |
| AfterBackward             | 77.201 ms                 | 1.364 s                   |
| BlockToStepN              | 84.479 ms                 | 451.193 ms                |
| OneStep                   | 218.654 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:10.272938 11138 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.563 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.213 ms                  | 14.411 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 175.861 ms                |
| ProcessOneStep            | 77.157 ms                 | 1.363 s                   |
| BlockToStepN              | 84.341 ms                 | 451.008 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:10.431013 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=561
W20240124 19:06:10.991705  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240124 19:06:11.313854 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240124 19:06:11.431010  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=12408
W20240124 19:06:11.991353  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=254
E20240124 19:06:12.431006 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=1402
W20240124 19:06:12.434067 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
W20240124 19:06:12.991086  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240124 19:06:13.431010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=124752
W20240124 19:06:13.639240 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
E20240124 19:06:14.431011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=6538
W20240124 19:06:14.602598  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240124 19:06:14.753801 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.471 ms                 | 453.479 ms                |
| Forward                   | 5.422 ms                  | 15.739 ms                 |
| Backward                  | 5.621 ms                  | 9.245 ms                  |
| Optimize                  | 2.411 ms                  | 6.200 ms                  |
| BarrierTimeBeforeRank0    | 38.245 us                 | 70.252 ms                 |
| AfterBackward             | 77.435 ms                 | 1.245 s                   |
| BlockToStepN              | 82.327 ms                 | 427.822 ms                |
| OneStep                   | 218.654 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.548 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.159 ms                  | 14.411 ms                 |
| ProcessBack:UpsertPq      | 30.928 ms                 | 175.861 ms                |
| ProcessOneStep            | 77.396 ms                 | 1.245 s                   |
| BlockToStepN              | 84.341 ms                 | 427.653 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:15.431010  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=13083
W20240124 19:06:15.602619  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240124 19:06:15.842123 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 19:06:16.431025 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=106793
W20240124 19:06:16.602334  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240124 19:06:16.997074 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 19:06:17.431011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=116456
W20240124 19:06:17.698704  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240124 19:06:18.045038 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240124 19:06:18.431020 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=7084
W20240124 19:06:18.860764  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240124 19:06:19.063712 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240124 19:06:19.431010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=46902
W20240124 19:06:20.071394  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.487 ms                 | 509.983 ms                |
| Forward                   | 5.406 ms                  | 15.739 ms                 |
| Backward                  | 5.567 ms                  | 9.245 ms                  |
| Optimize                  | 2.390 ms                  | 6.200 ms                  |
| BarrierTimeBeforeRank0    | 37.909 us                 | 70.252 ms                 |
| AfterBackward             | 77.435 ms                 | 1.245 s                   |
| BlockToStepN              | 84.479 ms                 | 427.822 ms                |
| OneStep                   | 220.204 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:20.212098 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.567 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.159 ms                  | 14.349 ms                 |
| ProcessBack:UpsertPq      | 30.880 ms                 | 169.052 ms                |
| ProcessOneStep            | 77.396 ms                 | 1.245 s                   |
| BlockToStepN              | 85.103 ms                 | 427.653 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:20.431016 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=73591
W20240124 19:06:21.071794  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240124 19:06:21.286788 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240124 19:06:21.431013  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=10065
W20240124 19:06:22.071368  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240124 19:06:22.372818 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 19:06:22.431008 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=13213
W20240124 19:06:23.140713  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240124 19:06:23.403045 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 19:06:23.431006 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=60540
[proc 7] 300 steps, total: 26.680, sample: 1.045, forward: 0.537, backward: 0.601, update: 0.267
[proc 6] 300 steps, total: 26.681, sample: 1.268, forward: 0.531, backward: 0.594, update: 0.270
[proc 5] 300 steps, total: 26.681, sample: 1.243, forward: 0.505, backward: 0.584, update: 0.236
[proc 3] 300 steps, total: 26.681, sample: 1.401, forward: 0.531, backward: 0.606, update: 0.268
[proc 2] 300 steps, total: 26.681, sample: 1.106, forward: 0.498, backward: 0.538, update: 0.252
[proc 4] 300 steps, total: 26.681, sample: 1.143, forward: 0.533, backward: 0.551, update: 0.236
[proc 1] 300 steps, total: 26.681, sample: 1.402, forward: 0.537, backward: 0.620, update: 0.251
[proc 0] 300 steps, total: 26.680, sample: 5.473, forward: 0.564, backward: 0.545, update: 0.256
W20240124 19:06:24.140519  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240124 19:06:24.431010 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=172994
W20240124 19:06:24.489727 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.198 ms                 | 518.762 ms                |
| Forward                   | 5.399 ms                  | 15.739 ms                 |
| Backward                  | 5.554 ms                  | 9.245 ms                  |
| Optimize                  | 2.382 ms                  | 6.200 ms                  |
| BarrierTimeBeforeRank0    | 37.180 us                 | 70.252 ms                 |
| AfterBackward             | 77.695 ms                 | 1.245 s                   |
| BlockToStepN              | 85.253 ms                 | 443.810 ms                |
| OneStep                   | 221.502 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.590 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.132 ms                  | 14.349 ms                 |
| ProcessBack:UpsertPq      | 30.928 ms                 | 169.052 ms                |
| ProcessOneStep            | 77.654 ms                 | 1.245 s                   |
| BlockToStepN              | 84.341 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:25.393658  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
E20240124 19:06:25.431006 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=184310
W20240124 19:06:25.528945 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240124 19:06:26.431030 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=9021
W20240124 19:06:26.594080 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 19:06:26.723006  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240124 19:06:27.431015 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=83139
W20240124 19:06:27.660310 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
W20240124 19:06:27.722445  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=317, pq.top=317
E20240124 19:06:28.431015 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=267733
W20240124 19:06:28.760136  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240124 19:06:28.895112 11138 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240124 19:06:29.431013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=37682
W20240124 19:06:29.908710 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 19:06:29.939806  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.217 ms                 | 518.762 ms                |
| Forward                   | 5.353 ms                  | 15.739 ms                 |
| Backward                  | 5.520 ms                  | 9.245 ms                  |
| Optimize                  | 2.367 ms                  | 6.200 ms                  |
| BarrierTimeBeforeRank0    | 37.116 us                 | 70.252 ms                 |
| AfterBackward             | 77.882 ms                 | 1.245 s                   |
| BlockToStepN              | 84.479 ms                 | 443.810 ms                |
| OneStep                   | 218.482 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.590 ms                  | 16.852 ms                 |
| ProcessBack:UpdateCache   | 9.065 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 30.697 ms                 | 160.683 ms                |
| ProcessOneStep            | 77.838 ms                 | 1.245 s                   |
| BlockToStepN              | 84.341 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:30.440140 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=4441
W20240124 19:06:30.927464 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 19:06:30.988191  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=330
E20240124 19:06:31.440007 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=92933
W20240124 19:06:31.947780 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 19:06:31.988757  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
E20240124 19:06:32.440018 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=10707
W20240124 19:06:32.964320 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240124 19:06:32.988680  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240124 19:06:33.440008 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=223199
W20240124 19:06:34.252079  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240124 19:06:34.340989 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 19:06:34.440023  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.390 ms                 | 518.762 ms                |
| Forward                   | 5.354 ms                  | 15.739 ms                 |
| Backward                  | 5.475 ms                  | 9.245 ms                  |
| Optimize                  | 2.382 ms                  | 6.200 ms                  |
| BarrierTimeBeforeRank0    | 36.712 us                 | 70.252 ms                 |
| AfterBackward             | 77.967 ms                 | 1.245 s                   |
| BlockToStepN              | 78.653 ms                 | 443.810 ms                |
| OneStep                   | 217.586 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.630 ms                  | 16.852 ms                 |
| ProcessBack:UpdateCache   | 9.065 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 30.839 ms                 | 169.052 ms                |
| ProcessOneStep            | 77.916 ms                 | 1.245 s                   |
| BlockToStepN              | 78.509 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:35.318598  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240124 19:06:35.342442 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 19:06:35.440135 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=31590
W20240124 19:06:36.361064 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 19:06:36.419203  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240124 19:06:36.440007 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=134330
W20240124 19:06:37.375784 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 19:06:37.440013 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=16571
W20240124 19:06:37.760713  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240124 19:06:38.383181 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 19:06:38.440011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=18955
W20240124 19:06:38.864244  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240124 19:06:39.408526 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240124 19:06:39.440536 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=37758
W20240124 19:06:39.864315  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.543 ms                 | 509.983 ms                |
| Forward                   | 5.381 ms                  | 14.329 ms                 |
| Backward                  | 5.410 ms                  | 8.673 ms                  |
| Optimize                  | 2.411 ms                  | 5.227 ms                  |
| BarrierTimeBeforeRank0    | 36.662 us                 | 69.255 ms                 |
| AfterBackward             | 78.971 ms                 | 992.425 ms                |
| BlockToStepN              | 76.513 ms                 | 432.974 ms                |
| OneStep                   | 217.586 ms                | 1.065 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.657 ms                  | 18.170 ms                 |
| ProcessBack:UpdateCache   | 9.059 ms                  | 14.349 ms                 |
| ProcessBack:UpsertPq      | 31.070 ms                 | 169.052 ms                |
| ProcessOneStep            | 78.947 ms                 | 992.373 ms                |
| BlockToStepN              | 76.385 ms                 | 432.801 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:40.440008 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=131871
W20240124 19:06:40.484897 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
W20240124 19:06:40.865074  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240124 19:06:41.440094 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=26575
W20240124 19:06:41.509634 11138 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240124 19:06:41.865080  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240124 19:06:42.440013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=159183
W20240124 19:06:42.653991 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
W20240124 19:06:43.001868  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240124 19:06:43.440011 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=28990
W20240124 19:06:43.750269 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
W20240124 19:06:44.176362  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240124 19:06:44.440011  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=6718
W20240124 19:06:44.849084 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.414 ms                 | 509.983 ms                |
| Forward                   | 5.373 ms                  | 14.329 ms                 |
| Backward                  | 5.344 ms                  | 8.673 ms                  |
| Optimize                  | 2.386 ms                  | 5.227 ms                  |
| BarrierTimeBeforeRank0    | 36.393 us                 | 69.255 ms                 |
| AfterBackward             | 78.971 ms                 | 992.425 ms                |
| BlockToStepN              | 81.441 ms                 | 443.810 ms                |
| OneStep                   | 218.482 ms                | 1.065 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:45.220173  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.668 ms                  | 17.557 ms                 |
| ProcessBack:UpdateCache   | 9.003 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 31.170 ms                 | 160.683 ms                |
| ProcessOneStep            | 78.947 ms                 | 992.373 ms                |
| BlockToStepN              | 81.284 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:45.440068  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
W20240124 19:06:46.048230 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 19:06:46.243429  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
E20240124 19:06:46.440013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=99634
W20240124 19:06:47.124758 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240124 19:06:47.329257  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=399, pq.top=399
E20240124 19:06:47.440011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=285
[proc 3] 400 steps, total: 23.578, sample: 1.123, forward: 0.509, backward: 0.594, update: 0.256
[proc 2] 400 steps, total: 23.578, sample: 1.124, forward: 0.519, backward: 0.517, update: 0.256
[proc 4] 400 steps, total: 23.577, sample: 1.063, forward: 0.513, backward: 0.615, update: 0.241
[proc 6] 400 steps, total: 23.578, sample: 1.150, forward: 0.564, backward: 0.576, update: 0.268
[proc 0] 400 steps, total: 23.577, sample: 3.869, forward: 0.548, backward: 0.472, update: 0.244
[proc 5] 400 steps, total: 23.578, sample: 1.051, forward: 0.532, backward: 0.661, update: 0.229
[proc 1] 400 steps, total: 23.578, sample: 1.181, forward: 0.533, backward: 0.592, update: 0.242
[proc 7] 400 steps, total: 23.578, sample: 1.052, forward: 0.549, backward: 0.558, update: 0.263
W20240124 19:06:48.193652 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
E20240124 19:06:48.440933 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=52529
W20240124 19:06:49.222872  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240124 19:06:49.228888 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 19:06:49.440011 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=58029
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.489 ms                 | 509.983 ms                |
| Forward                   | 5.355 ms                  | 14.329 ms                 |
| Backward                  | 5.320 ms                  | 8.673 ms                  |
| Optimize                  | 2.373 ms                  | 5.227 ms                  |
| BarrierTimeBeforeRank0    | 36.013 us                 | 69.255 ms                 |
| AfterBackward             | 78.971 ms                 | 1.245 s                   |
| BlockToStepN              | 81.441 ms                 | 443.810 ms                |
| OneStep                   | 217.304 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:06:50.222075  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240124 19:06:50.240413 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.665 ms                  | 17.557 ms                 |
| ProcessBack:UpdateCache   | 8.986 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 30.978 ms                 | 169.052 ms                |
| ProcessOneStep            | 78.926 ms                 | 1.245 s                   |
| BlockToStepN              | 82.191 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:50.440012  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=194
W20240124 19:06:51.249569  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=414
E20240124 19:06:51.440013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=278771
W20240124 19:06:51.460422 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
E20240124 19:06:52.440014 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=32631
W20240124 19:06:52.477885 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end0
E20240124 19:06:53.552573  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240124 19:06:53.585341 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 19:06:53.710000  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
E20240124 19:06:54.552011  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=4282
W20240124 19:06:54.639972 11138 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240124 19:06:54.824132  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.412 ms                 | 509.983 ms                |
| Forward                   | 5.343 ms                  | 14.329 ms                 |
| Backward                  | 5.291 ms                  | 8.673 ms                  |
| Optimize                  | 2.373 ms                  | 5.227 ms                  |
| BarrierTimeBeforeRank0    | 36.393 us                 | 69.255 ms                 |
| AfterBackward             | 78.435 ms                 | 1.364 s                   |
| BlockToStepN              | 76.513 ms                 | 443.810 ms                |
| OneStep                   | 214.632 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.664 ms                  | 16.852 ms                 |
| ProcessBack:UpdateCache   | 8.953 ms                  | 13.987 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 169.052 ms                |
| ProcessOneStep            | 78.651 ms                 | 1.363 s                   |
| BlockToStepN              | 76.385 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:06:55.552016 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=3844
W20240124 19:06:55.697232 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
W20240124 19:06:55.956748  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240124 19:06:56.552012  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=1183
W20240124 19:06:56.796437 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
W20240124 19:06:56.957249  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=438
E20240124 19:06:57.552009 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=52142
W20240124 19:06:57.972528 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
W20240124 19:06:58.032387  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=442, pq.top=442
E20240124 19:06:58.552011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=190137
W20240124 19:06:59.074563 11138 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
W20240124 19:06:59.108521  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
E20240124 19:06:59.552011 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=355737
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.198 ms                 | 485.637 ms                |
| Forward                   | 5.343 ms                  | 14.085 ms                 |
| Backward                  | 5.235 ms                  | 8.243 ms                  |
| Optimize                  | 2.352 ms                  | 4.987 ms                  |
| BarrierTimeBeforeRank0    | 35.896 us                 | 68.034 ms                 |
| AfterBackward             | 78.435 ms                 | 1.245 s                   |
| BlockToStepN              | 76.579 ms                 | 432.974 ms                |
| OneStep                   | 214.632 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 19:07:00.236454 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.681 ms                  | 20.681 ms                 |
| ProcessBack:UpdateCache   | 8.939 ms                  | 13.987 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 169.052 ms                |
| ProcessOneStep            | 78.384 ms                 | 1.245 s                   |
| BlockToStepN              | 76.462 ms                 | 432.801 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 19:07:00.396842  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240124 19:07:00.552047 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=52714
W20240124 19:07:01.397203  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240124 19:07:01.552357 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=127228
W20240124 19:07:01.742709 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 19:07:02.453557  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240124 19:07:02.552011  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=10551
W20240124 19:07:02.766137 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240124 19:07:03.453889  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240124 19:07:03.552008 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=160155
W20240124 19:07:03.810586 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 19:07:04.453155  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=465, pq.top=465
E20240124 19:07:04.552013 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=68281
W20240124 19:07:04.826545 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.217 ms                 | 485.637 ms                |
| Forward                   | 5.353 ms                  | 14.085 ms                 |
| Backward                  | 5.234 ms                  | 8.243 ms                  |
| Optimize                  | 2.346 ms                  | 4.987 ms                  |
| BarrierTimeBeforeRank0    | 35.838 us                 | 68.034 ms                 |
| AfterBackward             | 78.971 ms                 | 1.245 s                   |
| BlockToStepN              | 78.653 ms                 | 443.810 ms                |
| OneStep                   | 215.976 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.689 ms                  | 22.056 ms                 |
| ProcessBack:UpdateCache   | 8.905 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 30.809 ms                 | 175.861 ms                |
| ProcessOneStep            | 78.947 ms                 | 1.245 s                   |
| BlockToStepN              | 78.509 ms                 | 443.672 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 19:07:05.453606  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=469
E20240124 19:07:05.552011 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=63183
W20240124 19:07:05.826999 11138 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 19:07:06.453511  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
E20240124 19:07:06.553189 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=58670
W20240124 19:07:06.882694 11138 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 19:07:07.490715  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
E20240124 19:07:07.553011 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=240011
W20240124 19:07:07.966800 11138 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
W20240124 19:07:08.490618  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=483, pq.top=483
E20240124 19:07:08.553014 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=56462
W20240124 19:07:08.996421 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 19:07:09.553010  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=1968
W20240124 19:07:09.611707  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240124 19:07:10.059739 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.163 ms                 | 485.637 ms                |
| Forward                   | 5.373 ms                  | 14.085 ms                 |
| Backward                  | 5.208 ms                  | 8.243 ms                  |
| Optimize                  | 2.346 ms                  | 4.987 ms                  |
| BarrierTimeBeforeRank0    | 35.444 us                 | 68.034 ms                 |
| AfterBackward             | 79.484 ms                 | 1.245 s                   |
| BlockToStepN              | 76.579 ms                 | 451.193 ms                |
| OneStep                   | 216.651 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.699 ms                  | 20.681 ms                 |
| ProcessBack:UpdateCache   | 8.921 ms                  | 13.987 ms                 |
| ProcessBack:UpsertPq      | 30.880 ms                 | 175.861 ms                |
| ProcessOneStep            | 79.429 ms                 | 1.245 s                   |
| BlockToStepN              | 76.462 ms                 | 451.008 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 19:07:10.553014 11137 parallel_pq_v2.h:76] insert failed, size(hashtable)=57085
W20240124 19:07:10.955897  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240124 19:07:11.097141 11138 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 19:07:11.553015  8964 parallel_pq_v2.h:76] insert failed, size(hashtable)=6274
W20240124 19:07:11.993103  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240124 19:07:12.115381 11138 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 19:07:12.553016 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=71498
W20240124 19:07:13.104858  8964 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240124 19:07:13.182413 11138 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 19:07:13.553015 11138 parallel_pq_v2.h:76] insert failed, size(hashtable)=245590
[proc 1] 500 steps, total: 26.198, sample: 1.146, forward: 0.511, backward: 0.597, update: 0.235
[proc 4] 500 steps, total: 26.198, sample: 1.080, forward: 0.514, backward: 0.618, update: 0.232
[proc 7] 500 steps, total: 26.198, sample: 0.931, forward: 0.529, backward: 0.603, update: 0.248
[proc 2] 500 steps, total: 26.198, sample: 0.969, forward: 0.509, backward: 0.542, update: 0.253
[proc 5] 500 steps, total: 26.198, sample: 1.021, forward: 0.538, backward: 0.652, update: 0.249
[proc 0] 500 steps, total: 26.198, sample: 2.896, forward: 0.537, backward: 0.482, update: 0.233
[proc 3] 500 steps, total: 26.198, sample: 1.056, forward: 0.590, backward: 0.697, update: 0.249
[proc 6] 500 steps, total: 26.198, sample: 1.057, forward: 0.608, backward: 0.585, update: 0.247
Successfully xmh. training takes 130.94219779968262 seconds
before call kg_cache_controller.StopThreads()
W20240124 19:07:13.692198  8964 grad_async_v2.h:71] call StopThreads. PID = 41062
W20240124 19:07:13.692240  8964 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 19:07:13.692626  8964 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 19:07:13.692642  8964 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240124 19:07:14.092378  8964 grad_async_v2.h:91] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.163 ms                 | 485.637 ms                |
| Forward                   | 5.374 ms                  | 14.085 ms                 |
| Backward                  | 5.196 ms                  | 8.243 ms                  |
| Optimize                  | 2.345 ms                  | 4.987 ms                  |
| BarrierTimeBeforeRank0    | 35.058 us                 | 68.034 ms                 |
| AfterBackward             | 79.484 ms                 | 1.245 s                   |
| BlockToStepN              | 76.579 ms                 | 494.068 ms                |
| OneStep                   | 216.776 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.702 ms                  | 20.681 ms                 |
| ProcessBack:UpdateCache   | 8.940 ms                  | 13.987 ms                 |
| ProcessBack:UpsertPq      | 30.880 ms                 | 192.275 ms                |
| ProcessOneStep            | 79.429 ms                 | 1.245 s                   |
| BlockToStepN              | 76.462 ms                 | 493.927 ms                |
+---------------------------+---------------------------+---------------------------+
