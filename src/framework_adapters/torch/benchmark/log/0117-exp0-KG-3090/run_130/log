WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 15:29:38.476035 23494 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_77', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23494 sampler.py:454] Start PreSampling
WARNING [23494 sampler.py:532] Before construct renumbering_dict
WARNING [23494 sampler.py:555] PreSampling done
W20240124 15:42:17.582466 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 15:42:17.582684 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 15:42:17.582717 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 15:42:17.582753 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 15:42:17.582778 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 15:42:17.582805 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 15:42:17.582834 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 15:42:17.582870 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 15:42:17.582892 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 15:42:17.582911 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 15:42:17.582935 23494 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 15:42:17.582957 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 15:42:17.582974 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 15:42:17.583119 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 15:42:17.583142 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 15:42:17.583161 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 15:42:17.583197 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 15:42:17.583215 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 15:42:17.583237 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 15:42:17.583263 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 15:42:17.583281 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 15:42:17.583302 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 15:42:17.583323 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 15:42:17.583340 23494 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 15:42:17.583355 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 15:42:17.583377 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 15:42:17.583415 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 15:42:17.583446 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 15:42:17.583467 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 15:42:17.583489 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 15:42:17.583510 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 15:42:17.583552 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 15:42:17.583576 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 15:42:17.583599 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 15:42:17.583621 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 15:42:17.583638 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 15:42:17.583657 23494 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 15:42:17.583674 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 15:42:17.583688 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 15:42:17.583727 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 15:42:17.583747 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 15:42:17.583770 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 15:42:17.583796 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 15:42:17.583819 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 15:42:17.583840 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 15:42:17.583858 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 15:42:17.583882 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 15:42:17.583911 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 15:42:17.583930 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 15:42:17.583948 23494 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 15:42:17.583964 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 15:42:17.583982 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 15:42:17.584022 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 15:42:17.584053 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 15:42:17.584075 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 15:42:17.584101 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 15:42:17.584129 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 15:42:17.584149 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 15:42:17.584174 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 15:42:17.584200 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 15:42:17.584218 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 15:42:17.584236 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 15:42:17.584264 23494 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 15:42:17.584280 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 15:42:17.584300 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 15:42:17.584337 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 15:42:17.584360 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 15:42:17.584379 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 15:42:17.584411 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 15:42:17.584429 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 15:42:17.584448 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 15:42:17.584466 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 15:42:17.584486 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 15:42:17.584504 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 15:42:17.584525 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 15:42:17.584542 23494 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 15:42:17.584556 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 15:42:17.584570 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 15:42:17.584600 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 15:42:17.584621 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 15:42:17.584638 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 15:42:17.584656 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 15:42:17.584684 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 15:42:17.584722 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 15:42:17.584739 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 15:42:17.584760 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 15:42:17.584789 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 15:42:17.584813 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 15:42:17.584831 23494 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 15:42:17.584857 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 15:42:17.584874 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 15:42:17.584913 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 15:42:17.584935 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 15:42:17.584956 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 15:42:17.584973 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 15:42:17.585008 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 15:42:17.585028 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 15:42:17.585054 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 15:42:17.585072 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 15:42:17.585096 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 15:42:17.585125 23494 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 15:42:17.585146 23494 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 15:42:17.585160 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 15:42:17.585175 23494 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 15:42:17.964743 23494 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 15:42:17.964926 23494 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302745,  4302767,    57115,  ..., 61947941, 17866997, 28430797]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 937.372 seconds
[Rank1] pid = 49955
[Rank2] pid = 50056
[Rank3] pid = 50203
[Rank4] pid = 50321
[Rank5] pid = 50402
[Rank6] pid = 50485
INFO [23494 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [49955 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [50056 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [50203 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [50321 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [50485 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [50402 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [50569 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [50485 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50321 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50402 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50569 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50203 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [23494 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50056 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49955 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 15:45:23.796136 50570 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 15:45:23.796701 50486 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240124 15:45:23.796737 50323 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 15:45:23.796783 50205 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 15:45:23.796898 50633 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240124 15:45:23.797049 50403 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 15:45:23.797171 50057 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 15:45:23.798750 49956 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 15:45:23.954228 50323 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102027251000 781.2 kB
W20240124 15:45:23.954237 50486 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x102027316000 781.2 kB
W20240124 15:45:23.954282 50403 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020273db000 781.2 kB
W20240124 15:45:23.954316 50205 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1020274a0000 781.2 kB
W20240124 15:45:23.954411 50633 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027565000 781.2 kB
W20240124 15:45:23.954419 50570 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10202762a000 781.2 kB
W20240124 15:45:23.954495 50057 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020276ef000 781.2 kB
W20240124 15:45:23.954505 49956 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020277b4000 781.2 kB
W20240124 15:45:23.954630 50633 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x102027879000 781.2 kB
W20240124 15:45:23.954654 50323 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10202793e000 781.2 kB
W20240124 15:45:23.954663 50403 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x102027a03000 781.2 kB
W20240124 15:45:23.954684 50486 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x102027ac8000 781.2 kB
W20240124 15:45:23.954708 50205 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x102027b8d000 781.2 kB
W20240124 15:45:23.954715 50570 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102027c52000 781.2 kB
W20240124 15:45:23.954752 50633 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x102027d17000 152.6 MB
W20240124 15:45:23.954856 50486 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x1020315af000 152.6 MB
W20240124 15:45:23.954947 50057 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x10203ae47000 781.2 kB
W20240124 15:45:23.954986 50323 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x10203af0c000 152.6 MB
W20240124 15:45:23.954998 50486 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x1020447a4000 152.6 MB
W20240124 15:45:23.955014 50403 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10204e03c000 152.6 MB
W20240124 15:45:23.955127 50323 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1020578d4000 152.6 MB
W20240124 15:45:23.955149 50403 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10206116c000 152.6 MB
W20240124 15:45:23.955185 50633 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10206aa04000 152.6 MB
W20240124 15:45:23.955227 50486 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 15:45:23.955263 50633 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 15:45:23.955279 50205 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10207429c000 152.6 MB
W20240124 15:45:23.955371 50570 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10207db34000 152.6 MB
W20240124 15:45:23.955397 50323 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 15:45:23.955402 50057 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1020873cc000 152.6 MB
W20240124 15:45:23.955399 50403 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 15:45:23.955416 50205 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x102090c64000 152.6 MB
W20240124 15:45:23.956923 50205 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 15:45:23.957403 50057 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10209a4fc000 152.6 MB
W20240124 15:45:23.957414 50570 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1020a3d94000 152.6 MB
W20240124 15:45:23.957542 50057 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 15:45:23.958469 50570 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 15:45:23.958846 49956 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x1020ad62c000 781.2 kB
W20240124 15:45:23.959028 49956 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 15:45:23.959152 49956 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 15:45:23.959290 49956 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 15:45:23.960494 50633 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 15:45:23.960570 50486 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 15:45:23.961678 50323 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 15:45:23.961895 50403 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 15:45:23.963208 50205 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 15:45:23.964499 50057 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 15:45:23.964943 50570 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 15:45:23.966640 49956 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [50321 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [50485 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [50569 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [50056 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [49955 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
[Rank7] pid = 50569
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [50402 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [23494 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [50203 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 15:46:11.782207 50205 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782629 50570 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782675 50403 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782714 50633 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782748 50057 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782778 50486 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782812 49956 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 15:46:11.782838 50323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 15:46:11.784215 50570 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 15:46:11.784318 50570 grad_base.h:172] Init GradProcessingBase done
I20240124 15:46:21.274744 50570 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 15:46:21.274971 50570 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 15:46:21.274979 50570 kg_controller.h:84] Construct KGCacheController done
I20240124 15:46:22.049042 50570 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 15:46:39.149741 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 15:46:39.150138 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:46:40.474417 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 15:46:40.474529 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:46:41.621840 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 15:46:41.621968 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:46:43.339504 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:46:43.344370 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 15:46:43.375413 50403 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 15:46:43.963533 50633 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 15:46:44.799212 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:46:44.806516 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 15:46:44.837152 50486 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 15:46:45.842953 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:46:45.847883 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 15:46:45.877014 49956 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 15:46:46.626914 50057 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 15:46:47.128376 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:46:47.133412 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 15:46:47.171353 50205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 15:46:48.273697 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:46:48.278342 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 15:46:48.312291 50323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 15:46:48.609243 50570 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 15:46:50.983997 50570 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 15:46:51.007253 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 15:46:51.075343 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.001 ms                 | 65.019 ms                 |
| Forward                   | 4.085 ms                  | 886.939 ms                |
| Backward                  | 3.960 ms                  | 236.466 ms                |
| Optimize                  | 1.213 ms                  | 1.688 ms                  |
| BarrierTimeBeforeRank0    | 63.719 us                 | 66.469 ms                 |
| AfterBackward             | 46.270 ms                 | 1.189 s                   |
| BlockToStepN              | 59.099 ms                 | 91.891 ms                 |
| OneStep                   | 136.005 ms                | 2.464 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 15:46:51.983019 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=3995
W20240124 15:46:52.007015 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.932 ms                  | 406.675 ms                |
| ProcessBack:UpdateCache   | 10.184 ms                 | 751.428 ms                |
| ProcessBack:UpsertPq      | 13.572 ms                 | 32.912 ms                 |
| ProcessOneStep            | 46.236 ms                 | 1.188 s                   |
| BlockToStepN              | 6.844 ms                  | 91.813 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:46:52.078198 52500 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
E20240124 15:46:52.983011 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=66
W20240124 15:46:53.127063 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240124 15:46:53.655951 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
E20240124 15:46:53.983053 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:46:54.161276 52500 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
W20240124 15:46:54.673494 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=30, pq.top=30
E20240124 15:46:54.983016 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240124 15:46:55.194319 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
W20240124 15:46:55.874586 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=35, pq.top=35
E20240124 15:46:55.983026 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240124 15:46:56.317243 52500 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.024 ms                  | 65.019 ms                 |
| Forward                   | 3.977 ms                  | 886.939 ms                |
| Backward                  | 4.140 ms                  | 236.466 ms                |
| Optimize                  | 1.266 ms                  | 3.597 ms                  |
| BarrierTimeBeforeRank0    | 2.865 ms                  | 75.038 ms                 |
| AfterBackward             | 40.379 ms                 | 1.189 s                   |
| BlockToStepN              | 6.897 ms                  | 91.891 ms                 |
| OneStep                   | 98.721 ms                 | 2.464 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 15:46:56.983031 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.549 ms                  | 406.109 ms                |
| ProcessBack:UpdateCache   | 9.825 ms                  | 751.388 ms                |
| ProcessBack:UpsertPq      | 16.387 ms                 | 43.976 ms                 |
| ProcessOneStep            | 44.210 ms                 | 1.188 s                   |
| BlockToStepN              | 11.701 ms                 | 91.813 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:46:57.423067 52500 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
W20240124 15:46:57.695220 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=46, pq.top=46
E20240124 15:46:57.983017 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=16986
W20240124 15:46:58.465057 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240124 15:46:58.731276 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240124 15:46:58.983016 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=1893
W20240124 15:46:59.506897 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240124 15:46:59.771353 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
E20240124 15:46:59.983008 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
W20240124 15:47:00.520102 52500 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
W20240124 15:47:00.771133 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240124 15:47:00.983011 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=7461
W20240124 15:47:01.536244 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.304 ms                  | 60.265 ms                 |
| Forward                   | 4.277 ms                  | 9.573 ms                  |
| Backward                  | 4.076 ms                  | 20.006 ms                 |
| Optimize                  | 1.738 ms                  | 3.597 ms                  |
| BarrierTimeBeforeRank0    | 258.612 us                | 66.469 ms                 |
| AfterBackward             | 39.844 ms                 | 872.920 ms                |
| BlockToStepN              | 6.897 ms                  | 72.053 ms                 |
| OneStep                   | 88.962 ms                 | 889.747 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:01.800920 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240124 15:47:01.983009 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.527 ms                  | 58.695 ms                 |
| ProcessBack:UpdateCache   | 9.512 ms                  | 54.450 ms                 |
| ProcessBack:UpsertPq      | 12.547 ms                 | 43.976 ms                 |
| ProcessOneStep            | 39.804 ms                 | 872.870 ms                |
| BlockToStepN              | 6.844 ms                  | 71.924 ms                 |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 15.677, sample: 0.649, forward: 1.316, backward: 0.602, update: 0.127
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 15.132, sample: 1.059, forward: 1.302, backward: 0.613, update: 0.133
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 13.991, sample: 0.639, forward: 1.242, backward: 0.621, update: 0.117
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 17.467, sample: 0.633, forward: 1.322, backward: 0.697, update: 0.124
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.427, sample: 0.775, forward: 1.317, backward: 0.615, update: 0.129
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.340, sample: 0.820, forward: 1.226, backward: 0.718, update: 0.165
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.928, sample: 0.769, forward: 1.210, backward: 0.681, update: 0.124
train_sampler.Prefill()
-------Step 0-------
tensor([305015, 305064, 263484, 305092, 305131, 305162, 305050, 305193, 305229,
        305256]) tensor([ 4662511, 11644162, 58780890, 49889142, 18024782,   362001, 17424219,
        53399903, 46631996, 54394439])
-------Step 1-------
tensor([305015, 305064, 263484, 305092, 305131, 305162, 305050, 305193, 305229,
        305256]) tensor([21955825, 28174907, 59332789,  5346455, 76931613,  6632508,  5935430,
        11549428, 72346535,  6443705])
-------Step 2-------
tensor([  151496,   339005, 22066419,   339031,   151537,   305538,   339062,
          339091,   339129, 52372273]) tensor([80869007, 76795523, 40441029, 10806824, 39639137, 65696892, 40831243,
        40074399, 22467050, 83917459])
-------Step 3-------
tensor([  151496,   339005, 22066419,   339031,   151537,   305538,   339062,
          339091,   339129, 52372273]) tensor([55614501, 37933838, 45085250, 21919051,   533067, 19718631, 61225737,
        37710044, 40458527, 46947283])
-------Step 4-------
tensor([   13066,   372578, 52642774,    23612,   372601,   372628,   372658,
          372692,   372724,   372758]) tensor([47559222, 29766482,  1394079, 27240358, 22233176, 22124889,  8746693,
        55042039, 71761738, 31835032])
-------Step 5-------
tensor([   13066,   372578, 52642774,    23612,   372601,   372628,   372658,
          372692,   372724,   372758]) tensor([70538736, 41078976, 73678424,  5606048, 51670776, 40824451,  5770770,
        58878190, 69308432, 49839290])
-------Step 6-------
tensor([  406487,   406515,   406537,   406572, 44169689,   406616,   406652,
          105443,   406676,   316845]) tensor([47284340, 74791909, 71470098,  1559234, 58614757, 73969491, 62384573,
        21900125, 70496673, 76368516])
-------Step 7-------
tensor([  406487,   406515,   406537,   406572, 44169689,   406616,   406652,
          105443,   406676,   316845]) tensor([46145619, 41883902, 41269779, 43354307, 82224303,   396395, 77943471,
        71648532, 77923084, 70203392])
-------Step 8-------
tensor([34894939,   439445,   439473,   439496,   439526,   439554,   439583,
          439609,   439640, 22310881]) tensor([76613785, 50458665, 68244658, 34550235,    71858,  4351933, 22931008,
        48827072, 64076153,  7763555])
-------Step 9-------
tensor([34894939,   439445,   439473,   439496,   439526,   439554,   439583,
          439609,   439640, 22310881]) tensor([66346634, 25898256,  8108466, 37610212, 50492070, 21244339, 83397449,
        72936832, 71800150, 38341921])
before start barrier
start train
[proc 0] 100 steps, total: 13.695, sample: 0.942, forward: 1.341, backward: 0.679, update: 0.194
W20240124 15:47:02.539288 52500 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
W20240124 15:47:02.823729 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
E20240124 15:47:02.983011 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=15279
W20240124 15:47:03.545315 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 15:47:03.823179 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240124 15:47:03.983011 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=10162
W20240124 15:47:04.590461 52500 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
W20240124 15:47:04.842162 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=132, pq.top=132
E20240124 15:47:04.983530 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:47:05.603320 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 15:47:05.928534 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240124 15:47:05.988029 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 15:47:06.702440 52500 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.530 ms                  | 56.075 ms                 |
| Forward                   | 4.390 ms                  | 7.761 ms                  |
| Backward                  | 4.207 ms                  | 33.577 ms                 |
| Optimize                  | 1.433 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 81.732 us                 | 64.551 ms                 |
| AfterBackward             | 40.001 ms                 | 837.495 ms                |
| BlockToStepN              | 11.788 ms                 | 70.265 ms                 |
| OneStep                   | 83.875 ms                 | 863.534 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:06.966023 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=156
E20240124 15:47:06.988009 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=3261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.520 ms                  | 53.007 ms                 |
| ProcessBack:UpdateCache   | 9.704 ms                  | 53.341 ms                 |
| ProcessBack:UpsertPq      | 11.393 ms                 | 42.505 ms                 |
| ProcessOneStep            | 39.804 ms                 | 837.423 ms                |
| BlockToStepN              | 6.844 ms                  | 70.198 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:07.703073 52500 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
E20240124 15:47:07.988013 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=10259
W20240124 15:47:07.989915 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240124 15:47:08.722405 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
E20240124 15:47:08.988013 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=18694
W20240124 15:47:09.089496 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240124 15:47:09.792817 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 15:47:09.988009 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=14109
W20240124 15:47:10.111048 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240124 15:47:10.872576 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 15:47:10.988015 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=6031
W20240124 15:47:11.320845 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 5] 200 steps, total: 9.164, sample: 0.494, forward: 0.398, backward: 0.466, update: 0.136
[proc 2] 200 steps, total: 9.165, sample: 0.579, forward: 0.393, backward: 0.433, update: 0.136
[proc 3] 200 steps, total: 9.165, sample: 0.532, forward: 0.383, backward: 0.422, update: 0.130
[proc 1] 200 steps, total: 9.165, sample: 0.548, forward: 0.392, backward: 0.457, update: 0.138
[proc 6] 200 steps, total: 9.165, sample: 0.503, forward: 0.393, backward: 0.485, update: 0.130
[proc 7] 200 steps, total: 9.165, sample: 0.549, forward: 0.397, backward: 0.449, update: 0.126
[proc 4] 200 steps, total: 9.165, sample: 0.558, forward: 0.384, backward: 0.410, update: 0.123
[proc 0] 200 steps, total: 9.164, sample: 0.840, forward: 0.463, backward: 0.553, update: 0.146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.411 ms                  | 65.019 ms                 |
| Forward                   | 4.458 ms                  | 11.264 ms                 |
| Backward                  | 4.302 ms                  | 35.634 ms                 |
| Optimize                  | 1.438 ms                  | 3.597 ms                  |
| BarrierTimeBeforeRank0    | 51.145 us                 | 64.551 ms                 |
| AfterBackward             | 40.315 ms                 | 837.495 ms                |
| BlockToStepN              | 14.080 ms                 | 72.053 ms                 |
| OneStep                   | 84.750 ms                 | 863.534 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:11.890288 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 15:47:11.988016 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.523 ms                  | 39.436 ms                 |
| ProcessBack:UpdateCache   | 9.757 ms                  | 19.899 ms                 |
| ProcessBack:UpsertPq      | 11.445 ms                 | 47.240 ms                 |
| ProcessOneStep            | 40.282 ms                 | 837.423 ms                |
| BlockToStepN              | 13.971 ms                 | 71.924 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:12.401924 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240124 15:47:12.902901 52500 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
E20240124 15:47:12.988009 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=723
W20240124 15:47:13.663255 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240124 15:47:13.907166 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240124 15:47:13.988116 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=2650
W20240124 15:47:14.709417 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240124 15:47:14.917695 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 15:47:14.988072 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=33767
W20240124 15:47:15.710911 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240124 15:47:15.936764 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240124 15:47:15.988009 50570 parallel_pq_v2.h:76] insert failed, size(hashtable)=7012
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.696 ms                  | 114.925 ms                |
| Forward                   | 4.476 ms                  | 14.040 ms                 |
| Backward                  | 4.304 ms                  | 35.634 ms                 |
| Optimize                  | 1.420 ms                  | 7.329 ms                  |
| BarrierTimeBeforeRank0    | 43.534 us                 | 64.551 ms                 |
| AfterBackward             | 39.844 ms                 | 837.495 ms                |
| BlockToStepN              | 14.080 ms                 | 72.053 ms                 |
| OneStep                   | 86.353 ms                 | 863.534 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:16.884243 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240124 15:47:16.946767 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240124 15:47:16.988010 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.528 ms                  | 27.837 ms                 |
| ProcessBack:UpdateCache   | 9.778 ms                  | 19.814 ms                 |
| ProcessBack:UpsertPq      | 11.087 ms                 | 44.476 ms                 |
| ProcessOneStep            | 39.804 ms                 | 837.423 ms                |
| BlockToStepN              | 13.971 ms                 | 71.924 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:17.900025 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240124 15:47:17.962152 52500 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240124 15:47:17.990339 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:47:18.913224 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240124 15:47:18.981531 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240124 15:47:18.990005 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=13189
W20240124 15:47:19.844419 51588 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
E20240124 15:47:19.990015 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=2231
W20240124 15:47:20.019671 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 15:47:20.070554 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
E20240124 15:47:20.990010 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=14586
W20240124 15:47:21.061220 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
W20240124 15:47:21.120272 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.516 ms                  | 169.650 ms                |
| Forward                   | 4.445 ms                  | 11.264 ms                 |
| Backward                  | 4.224 ms                  | 33.577 ms                 |
| Optimize                  | 1.422 ms                  | 4.567 ms                  |
| BarrierTimeBeforeRank0    | 40.985 us                 | 45.537 ms                 |
| AfterBackward             | 39.844 ms                 | 697.932 ms                |
| BlockToStepN              | 14.213 ms                 | 72.053 ms                 |
| OneStep                   | 87.625 ms                 | 738.437 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 15:47:21.990010 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=2197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.575 ms                  | 27.735 ms                 |
| ProcessBack:UpdateCache   | 9.880 ms                  | 19.814 ms                 |
| ProcessBack:UpsertPq      | 11.044 ms                 | 44.378 ms                 |
| ProcessOneStep            | 39.952 ms                 | 697.865 ms                |
| BlockToStepN              | 14.076 ms                 | 71.924 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:22.089715 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
[proc 6] 300 steps, total: 10.646, sample: 0.570, forward: 0.461, backward: 0.433, update: 0.138
[proc 4] 300 steps, total: 10.645, sample: 0.572, forward: 0.405, backward: 0.420, update: 0.135
[proc 3] 300 steps, total: 10.646, sample: 0.566, forward: 0.408, backward: 0.473, update: 0.139
[proc 5] 300 steps, total: 10.646, sample: 0.624, forward: 0.409, backward: 0.450, update: 0.141
[proc 7] 300 steps, total: 10.646, sample: 0.608, forward: 0.416, backward: 0.408, update: 0.136
[proc 2] 300 steps, total: 10.646, sample: 0.551, forward: 0.431, backward: 0.465, update: 0.138
[proc 1] 300 steps, total: 10.646, sample: 0.578, forward: 0.404, backward: 0.436, update: 0.140
[proc 0] 300 steps, total: 10.645, sample: 2.440, forward: 0.459, backward: 0.448, update: 0.148
W20240124 15:47:22.195896 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240124 15:47:22.990010 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=10093
W20240124 15:47:23.092521 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
W20240124 15:47:23.317761 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240124 15:47:23.990017 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=25508
W20240124 15:47:24.147745 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 15:47:24.334453 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240124 15:47:24.990057 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1382
W20240124 15:47:25.197628 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240124 15:47:25.334275 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240124 15:47:25.991710 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 15:47:26.224486 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 15:47:26.379478 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=339
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.810 ms                  | 181.998 ms                |
| Forward                   | 4.465 ms                  | 11.264 ms                 |
| Backward                  | 4.210 ms                  | 33.577 ms                 |
| Optimize                  | 1.392 ms                  | 4.567 ms                  |
| BarrierTimeBeforeRank0    | 39.506 us                 | 45.537 ms                 |
| AfterBackward             | 39.858 ms                 | 697.932 ms                |
| BlockToStepN              | 15.750 ms                 | 91.891 ms                 |
| OneStep                   | 88.698 ms                 | 738.437 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 15:47:26.992223 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.636 ms                  | 23.462 ms                 |
| ProcessBack:UpdateCache   | 9.906 ms                  | 13.588 ms                 |
| ProcessBack:UpsertPq      | 10.870 ms                 | 44.476 ms                 |
| ProcessOneStep            | 39.952 ms                 | 697.865 ms                |
| BlockToStepN              | 15.636 ms                 | 91.813 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:27.230326 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240124 15:47:27.408248 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240124 15:47:27.992014 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=6533
W20240124 15:47:28.284528 52500 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
W20240124 15:47:28.590600 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240124 15:47:28.992015 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240124 15:47:29.285220 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 15:47:29.603431 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240124 15:47:30.001919 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=5078
W20240124 15:47:30.326341 52500 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240124 15:47:30.726469 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240124 15:47:31.001021 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=18366
W20240124 15:47:31.396696 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240124 15:47:31.762204 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=383
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.366 ms                  | 191.308 ms                |
| Forward                   | 4.453 ms                  | 10.370 ms                 |
| Backward                  | 4.154 ms                  | 20.006 ms                 |
| Optimize                  | 1.366 ms                  | 3.597 ms                  |
| BarrierTimeBeforeRank0    | 37.625 us                 | 43.029 ms                 |
| AfterBackward             | 40.164 ms                 | 544.722 ms                |
| BlockToStepN              | 16.854 ms                 | 99.084 ms                 |
| OneStep                   | 89.627 ms                 | 579.934 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 15:47:32.001009 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1028
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.688 ms                  | 23.277 ms                 |
| ProcessBack:UpdateCache   | 9.955 ms                  | 15.119 ms                 |
| ProcessBack:UpsertPq      | 11.099 ms                 | 44.476 ms                 |
| ProcessOneStep            | 40.119 ms                 | 544.652 ms                |
| BlockToStepN              | 16.744 ms                 | 98.961 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:32.433867 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240124 15:47:32.766165 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
E20240124 15:47:33.001021 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=3643
W20240124 15:47:33.500368 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
[proc 1] 400 steps, total: 11.441, sample: 0.644, forward: 0.390, backward: 0.461, update: 0.136
[proc 6] 400 steps, total: 11.441, sample: 0.519, forward: 0.406, backward: 0.451, update: 0.144
[proc 2] 400 steps, total: 11.441, sample: 0.552, forward: 0.398, backward: 0.445, update: 0.137
[proc 5] 400 steps, total: 11.441, sample: 0.512, forward: 0.388, backward: 0.453, update: 0.128
[proc 7] 400 steps, total: 11.441, sample: 0.572, forward: 0.404, backward: 0.441, update: 0.129
[proc 4] 400 steps, total: 11.441, sample: 0.525, forward: 0.385, backward: 0.435, update: 0.129
[proc 3] 400 steps, total: 11.441, sample: 0.693, forward: 0.426, backward: 0.439, update: 0.139
[proc 0] 400 steps, total: 11.441, sample: 2.329, forward: 0.443, backward: 0.395, update: 0.130
W20240124 15:47:33.798545 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240124 15:47:34.001017 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=9745
W20240124 15:47:34.511111 52500 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 15:47:34.926119 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240124 15:47:35.001014 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=776
W20240124 15:47:35.534946 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 15:47:35.926273 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240124 15:47:36.001020 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=24579
W20240124 15:47:36.599500 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.823 ms                  | 204.892 ms                |
| Forward                   | 4.447 ms                  | 10.370 ms                 |
| Backward                  | 4.089 ms                  | 20.006 ms                 |
| Optimize                  | 1.366 ms                  | 3.597 ms                  |
| BarrierTimeBeforeRank0    | 35.283 us                 | 43.029 ms                 |
| AfterBackward             | 40.379 ms                 | 616.732 ms                |
| BlockToStepN              | 19.418 ms                 | 100.461 ms                |
| OneStep                   | 90.447 ms                 | 633.382 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:36.929596 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=425, pq.top=425
E20240124 15:47:37.001010 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=19595
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.733 ms                  | 23.277 ms                 |
| ProcessBack:UpdateCache   | 10.008 ms                 | 15.119 ms                 |
| ProcessBack:UpsertPq      | 11.236 ms                 | 44.476 ms                 |
| ProcessOneStep            | 40.317 ms                 | 616.680 ms                |
| BlockToStepN              | 19.439 ms                 | 100.322 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:37.602264 52500 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240124 15:47:37.929071 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
E20240124 15:47:38.001013 52499 parallel_pq_v2.h:76] insert failed, size(hashtable)=10136
W20240124 15:47:38.662215 52500 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240124 15:47:38.929322 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=441
E20240124 15:47:39.001046 50570 parallel_pq_v2.h:76] insert failed, size(hashtable)=35
W20240124 15:47:39.702489 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 15:47:39.929247 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240124 15:47:40.001022 50570 parallel_pq_v2.h:76] insert failed, size(hashtable)=307
W20240124 15:47:40.757400 52500 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
W20240124 15:47:40.929729 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240124 15:47:41.001008 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=12174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.983 ms                  | 209.962 ms                |
| Forward                   | 4.447 ms                  | 9.573 ms                  |
| Backward                  | 4.051 ms                  | 12.443 ms                 |
| Optimize                  | 1.357 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 33.135 us                 | 43.029 ms                 |
| AfterBackward             | 40.466 ms                 | 544.722 ms                |
| BlockToStepN              | 20.187 ms                 | 107.025 ms                |
| OneStep                   | 92.217 ms                 | 579.934 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:41.799961 52500 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 15:47:42.001024 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=2224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.762 ms                  | 16.530 ms                 |
| ProcessBack:UpdateCache   | 10.065 ms                 | 13.588 ms                 |
| ProcessBack:UpsertPq      | 11.206 ms                 | 44.476 ms                 |
| ProcessOneStep            | 40.427 ms                 | 544.652 ms                |
| BlockToStepN              | 20.086 ms                 | 106.900 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 15:47:42.211988 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240124 15:47:42.823181 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 15:47:43.001034 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=27828
W20240124 15:47:43.238641 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=476, pq.top=476
W20240124 15:47:43.836673 52500 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 15:47:44.001013 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=4627
W20240124 15:47:44.269822 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240124 15:47:44.863871 52500 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240124 15:47:45.001014 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=4027
W20240124 15:47:45.269575 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240124 15:47:45.986318 52500 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 15:47:46.001019 52500 parallel_pq_v2.h:76] insert failed, size(hashtable)=1830
W20240124 15:47:46.375139 50570 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=498, pq.top=498
[proc 7] 500 steps, total: 13.008, sample: 0.525, forward: 0.372, backward: 0.434, update: 0.121
[proc 3] 500 steps, total: 13.008, sample: 0.753, forward: 0.416, backward: 0.408, update: 0.141
[proc 2] 500 steps, total: 13.008, sample: 0.450, forward: 0.375, backward: 0.420, update: 0.135
[proc 4] 500 steps, total: 13.008, sample: 0.588, forward: 0.390, backward: 0.435, update: 0.128
[proc 0] 500 steps, total: 13.008, sample: 2.076, forward: 0.428, backward: 0.374, update: 0.134
[proc 5] 500 steps, total: 13.008, sample: 0.605, forward: 0.368, backward: 0.499, update: 0.128
[proc 6] 500 steps, total: 13.008, sample: 0.504, forward: 0.388, backward: 0.400, update: 0.127
[proc 1] 500 steps, total: 13.008, sample: 0.547, forward: 0.413, backward: 0.430, update: 0.127
Successfully xmh. training takes 57.95419669151306 seconds
before call kg_cache_controller.StopThreads()
W20240124 15:47:46.563524 50570 grad_async_v2.h:71] call StopThreads. PID = 23494
W20240124 15:47:46.563560 50570 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 15:47:46.563984 50570 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 15:47:46.563994 50570 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240124 15:47:46.609412 50570 grad_async_v2.h:91] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.301 ms                  | 209.962 ms                |
| Forward                   | 4.441 ms                  | 9.573 ms                  |
| Backward                  | 4.026 ms                  | 12.443 ms                 |
| Optimize                  | 1.356 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 32.086 us                 | 43.029 ms                 |
| AfterBackward             | 40.498 ms                 | 616.732 ms                |
| BlockToStepN              | 20.857 ms                 | 122.224 ms                |
| OneStep                   | 92.575 ms                 | 633.382 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.805 ms                  | 16.530 ms                 |
| ProcessBack:UpdateCache   | 10.120 ms                 | 13.540 ms                 |
| ProcessBack:UpsertPq      | 11.433 ms                 | 44.476 ms                 |
| ProcessOneStep            | 40.465 ms                 | 616.680 ms                |
| BlockToStepN              | 20.770 ms                 | 122.108 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
