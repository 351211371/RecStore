WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 20:16:41.202453  8644 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_91', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [8644 sampler.py:454] Start PreSampling
WARNING [8644 sampler.py:532] Before construct renumbering_dict
WARNING [8644 sampler.py:555] PreSampling done
W20240124 20:29:53.007028  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 20:29:53.007221  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 20:29:53.007246  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 20:29:53.007274  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 20:29:53.007297  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 20:29:53.007318  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 20:29:53.007337  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 20:29:53.007369  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 20:29:53.007386  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 20:29:53.007404  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 20:29:53.007431  8644 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 20:29:53.007449  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 20:29:53.007464  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 20:29:53.007563  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 20:29:53.007586  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 20:29:53.007603  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 20:29:53.007642  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 20:29:53.007659  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 20:29:53.007678  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 20:29:53.007694  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 20:29:53.007711  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 20:29:53.007727  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 20:29:53.007755  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 20:29:53.007771  8644 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 20:29:53.007786  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 20:29:53.007804  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 20:29:53.007840  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 20:29:53.007869  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 20:29:53.007891  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 20:29:53.007910  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 20:29:53.007931  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 20:29:53.007964  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 20:29:53.007983  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 20:29:53.008005  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 20:29:53.008025  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 20:29:53.008049  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 20:29:53.008069  8644 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 20:29:53.008083  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 20:29:53.008105  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 20:29:53.008144  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 20:29:53.008168  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 20:29:53.008198  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 20:29:53.008220  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 20:29:53.008242  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 20:29:53.008266  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 20:29:53.008291  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 20:29:53.008311  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 20:29:53.008333  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 20:29:53.008356  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 20:29:53.008373  8644 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 20:29:53.008386  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 20:29:53.008399  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 20:29:53.008436  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 20:29:53.008460  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 20:29:53.008478  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 20:29:53.008496  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 20:29:53.008518  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 20:29:53.008541  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 20:29:53.008563  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 20:29:53.008584  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 20:29:53.008600  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 20:29:53.008625  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 20:29:53.008641  8644 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 20:29:53.008654  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 20:29:53.008673  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 20:29:53.008708  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 20:29:53.008728  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 20:29:53.008747  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 20:29:53.008773  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 20:29:53.008790  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 20:29:53.008827  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 20:29:53.008867  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 20:29:53.008889  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 20:29:53.008906  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 20:29:53.008927  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 20:29:53.008947  8644 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 20:29:53.008961  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 20:29:53.008975  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 20:29:53.009011  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 20:29:53.009035  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 20:29:53.009052  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 20:29:53.009074  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 20:29:53.009092  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 20:29:53.009124  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 20:29:53.009142  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 20:29:53.009166  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 20:29:53.009192  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 20:29:53.009217  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 20:29:53.009241  8644 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 20:29:53.009260  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 20:29:53.009274  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 20:29:53.009315  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 20:29:53.009335  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 20:29:53.009359  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 20:29:53.009382  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 20:29:53.009405  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 20:29:53.009423  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 20:29:53.009446  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 20:29:53.009472  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 20:29:53.009493  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 20:29:53.009521  8644 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 20:29:53.009543  8644 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 20:29:53.009557  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 20:29:53.009570  8644 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 20:29:53.444348  8644 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 20:29:53.444520  8644 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302715,  4302727,  4302769,  ..., 58865906, 24126758, 24625806]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 969.534 seconds
[Rank1] pid = 33250
[Rank2] pid = 33352
[Rank3] pid = 33435
[Rank4] pid = 33515
[Rank5] pid = 33592
[Rank6] pid = 33671
INFO [8644 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [33250 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [33352 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [33435 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [33592 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [33671 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [33755 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [33515 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [33592 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33435 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33755 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33671 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33515 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8644 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33250 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33352 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [8644 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33755 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33592 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33435 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33250 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33352 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33671 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33515 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 20:33:07.893738 33516 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.893864 33593 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.893991 33436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.894145 33819 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.894376 33353 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.894552 33672 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.894671 33251 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 20:33:07.894855 33756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 20:33:14.695973 33819 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 20:33:15.483933 33593 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:16.796402 33353 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:16.925791 33672 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:17.618219 33436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:17.915690 33756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:18.120292 33251 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 20:33:18.312989 33516 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.336 ms                  | 20.745 ms                 |
| bucket keys               | 1.632 ms                  | 133.371 ms                |
| forward: a2a keys         | 5.897 ms                  | 1.323 s                   |
| forward: search cache     | 294.146 us                | 20.151 ms                 |
| forward: a2a values       | 10.095 ms                 | 63.409 ms                 |
| forward: join             | 1.592 ms                  | 2.846 ms                  |
| Forward                   | 53.514 ms                 | 2.096 s                   |
| back: aggr dram keys      | 69.248 ms                 | 1.115 s                   |
| back: set dram grad       | 4.536 ms                  | 9.090 ms                  |
| back: a2a grad            | 9.383 ms                  | 49.593 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 128.944 ms                |
| Backward                  | 291.604 ms                | 1.493 s                   |
| Optimize                  | 33.007 ms                 | 36.416 ms                 |
| BarrierTimeBeforeRank0    | 46.476 us                 | 54.431 us                 |
| BlockToStepN              | 67.381 us                 | 8.316 ms                  |
| OneStep                   | 393.580 ms                | 3.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.558 ms                 | 171.689 ms                |
| bucket keys               | 1.625 ms                  | 133.371 ms                |
| forward: a2a keys         | 5.175 ms                  | 1.323 s                   |
| forward: search cache     | 321.574 us                | 20.151 ms                 |
| forward: a2a values       | 10.095 ms                 | 63.409 ms                 |
| forward: join             | 1.592 ms                  | 2.846 ms                  |
| Forward                   | 51.595 ms                 | 2.096 s                   |
| back: aggr dram keys      | 48.564 ms                 | 1.115 s                   |
| back: set dram grad       | 1.558 ms                  | 9.090 ms                  |
| back: a2a grad            | 24.361 ms                 | 49.593 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 128.944 ms                |
| Backward                  | 228.515 ms                | 1.493 s                   |
| Optimize                  | 24.824 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 46.476 us                 | 70.896 us                 |
| BlockToStepN              | 48.406 us                 | 12.350 ms                 |
| OneStep                   | 328.161 ms                | 3.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.802 ms                  | 171.689 ms                |
| bucket keys               | 1.632 ms                  | 4.888 ms                  |
| forward: a2a keys         | 5.339 ms                  | 129.157 ms                |
| forward: search cache     | 318.614 us                | 873.936 us                |
| forward: a2a values       | 15.415 ms                 | 29.422 ms                 |
| forward: join             | 1.594 ms                  | 2.846 ms                  |
| Forward                   | 53.514 ms                 | 2.096 s                   |
| back: aggr dram keys      | 48.564 ms                 | 96.909 ms                 |
| back: set dram grad       | 1.558 ms                  | 7.622 ms                  |
| back: a2a grad            | 24.361 ms                 | 36.576 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 121.304 ms                |
| Backward                  | 228.926 ms                | 1.493 s                   |
| Optimize                  | 23.581 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 47.980 us                 | 72.881 us                 |
| BlockToStepN              | 48.406 us                 | 15.751 ms                 |
| OneStep                   | 328.037 ms                | 3.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.007 ms                  | 171.689 ms                |
| bucket keys               | 1.731 ms                  | 4.888 ms                  |
| forward: a2a keys         | 5.344 ms                  | 129.157 ms                |
| forward: search cache     | 323.707 us                | 873.936 us                |
| forward: a2a values       | 17.527 ms                 | 36.230 ms                 |
| forward: join             | 1.777 ms                  | 2.905 ms                  |
| Forward                   | 56.749 ms                 | 2.096 s                   |
| back: aggr dram keys      | 48.564 ms                 | 96.909 ms                 |
| back: set dram grad       | 3.519 ms                  | 7.622 ms                  |
| back: a2a grad            | 23.983 ms                 | 36.576 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 121.304 ms                |
| Backward                  | 224.481 ms                | 1.493 s                   |
| Optimize                  | 21.085 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 42.906 us                 | 72.881 us                 |
| BlockToStepN              | 48.192 us                 | 15.751 ms                 |
| OneStep                   | 318.454 ms                | 3.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.367 ms                  | 92.877 ms                 |
| bucket keys               | 1.743 ms                  | 9.805 ms                  |
| forward: a2a keys         | 5.652 ms                  | 132.017 ms                |
| forward: search cache     | 328.119 us                | 873.936 us                |
| forward: a2a values       | 17.527 ms                 | 36.230 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 56.749 ms                 | 184.330 ms                |
| back: aggr dram keys      | 47.030 ms                 | 96.909 ms                 |
| back: set dram grad       | 1.558 ms                  | 7.622 ms                  |
| back: a2a grad            | 23.455 ms                 | 36.576 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 131.392 ms                |
| Backward                  | 221.705 ms                | 291.604 ms                |
| Optimize                  | 21.089 ms                 | 48.094 ms                 |
| BarrierTimeBeforeRank0    | 41.302 us                 | 72.092 us                 |
| BlockToStepN              | 48.192 us                 | 12.350 ms                 |
| OneStep                   | 314.829 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.489 ms                  | 104.454 ms                |
| bucket keys               | 1.773 ms                  | 4.888 ms                  |
| forward: a2a keys         | 5.379 ms                  | 129.157 ms                |
| forward: search cache     | 329.384 us                | 843.536 us                |
| forward: a2a values       | 17.527 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 56.749 ms                 | 184.330 ms                |
| back: aggr dram keys      | 48.564 ms                 | 89.316 ms                 |
| back: set dram grad       | 3.440 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.581 ms                 | 48.449 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 128.944 ms                |
| Backward                  | 221.536 ms                | 291.604 ms                |
| Optimize                  | 21.022 ms                 | 48.094 ms                 |
| BarrierTimeBeforeRank0    | 41.086 us                 | 72.881 us                 |
| BlockToStepN              | 47.420 us                 | 15.751 ms                 |
| OneStep                   | 318.454 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.489 ms                  | 104.454 ms                |
| bucket keys               | 1.762 ms                  | 4.888 ms                  |
| forward: a2a keys         | 5.890 ms                  | 129.157 ms                |
| forward: search cache     | 326.252 us                | 843.536 us                |
| forward: a2a values       | 17.527 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 3.574 ms                  |
| Forward                   | 55.932 ms                 | 184.330 ms                |
| back: aggr dram keys      | 47.030 ms                 | 89.316 ms                 |
| back: set dram grad       | 1.558 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.581 ms                 | 48.449 ms                 |
| back: grad sum & grad cache  | 9.700 ms                  | 128.944 ms                |
| Backward                  | 221.536 ms                | 291.604 ms                |
| Optimize                  | 21.285 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 40.765 us                 | 91.107 us                 |
| BlockToStepN              | 46.735 us                 | 15.751 ms                 |
| OneStep                   | 317.877 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 40.314, sample: 1.098, forward: 9.464, backward: 14.183, update: 0.375
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 39.526, sample: 1.826, forward: 8.680, backward: 13.977, update: 0.315
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 37.392, sample: 1.611, forward: 8.863, backward: 14.233, update: 0.314
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 36.890, sample: 1.905, forward: 8.620, backward: 14.717, update: 0.287
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 38.214, sample: 1.761, forward: 8.762, backward: 14.211, update: 0.325
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 38.084, sample: 1.913, forward: 8.622, backward: 14.000, update: 0.338
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 36.697, sample: 1.946, forward: 8.543, backward: 13.964, update: 0.335
[Rank7] pid = 33755
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([  5658,  16780, 134877,  16815,  16860,  16903,   5675,  16942,  17004,
         17053]) tensor([ 5342606,  9534886, 45553917, 45691792, 16026223,   349797, 16576699,
        46701291, 40669637,  1776135])
-------Step 1-------
tensor([  5658,  16780, 134877,  16815,  16860,  16903,   5675,  16942,  17004,
         17053]) tensor([36909867, 34830045, 36008930,   456686,  1102751, 60053305, 57777329,
         1200793, 63946134, 26414953])
-------Step 2-------
tensor([  118510,   118559,   118585,   118639,   118684, 43913717, 85958141,
          118731, 52231391,   118772]) tensor([64023809, 51627105, 20710040, 12075051, 27363306, 34785360, 49088312,
        37070175, 73488513, 13457832])
-------Step 3-------
tensor([  118510,   118559,   118585,   118639,   118684, 43913717, 85958141,
          118731, 52231391,   118772]) tensor([73962716, 55629632, 43517530, 52995990, 11351611, 58656145, 66546895,
        12485152, 83394578,   281051])
-------Step 4-------
tensor([  103672,   220534,   220575,  4339734,   220610,   220651,   220678,
        20393023,   220721,   220752]) tensor([23078281, 27276503, 82838627, 36510494,  8251621, 11699551, 33613916,
        16016539, 59190762, 79672622])
-------Step 5-------
tensor([  103672,   220534,   220575,  4339734,   220610,   220651,   220678,
        20393023,   220721,   220752]) tensor([  930932, 56976821,  6092165, 36501501, 29061495, 79845145, 30671565,
        30491911, 68226869, 55216230])
-------Step 6-------
tensor([114043, 318867, 318914,  33096,  33113, 318966,  33142, 319005, 319050,
         15275]) tensor([10201358, 80441716, 23092471, 46802400, 20668769, 64616094, 21608123,
        18302514, 21392904, 60159735])
-------Step 7-------
tensor([114043, 318867, 318914,  33096,  33113, 318966,  33142, 319005, 319050,
         15275]) tensor([36021502, 29893525, 71723068, 59228513, 42853568,  2026743, 39975372,
        83965383, 75757325, 73915548])
-------Step 8-------
tensor([  397250,  6343425,   397270,   124629,  8884285,   397292, 18345475,
           42320,    42348,   397313]) tensor([ 1247510, 29274891, 69188796,  5934034, 47665171, 49289288,  5515596,
        53926904, 75787898, 42875058])
-------Step 9-------
tensor([  397250,  6343425,   397270,   124629,  8884285,   397292, 18345475,
           42320,    42348,   397313]) tensor([65461757, 34477528, 10693538, 83539729,  6872173, 29044861, 54496832,
        76279368, 19422966, 24667094])
before start barrier
start train
[proc 0] 100 steps, total: 37.094, sample: 1.475, forward: 8.536, backward: 24.148, update: 2.329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.428 ms                  | 116.559 ms                |
| bucket keys               | 1.760 ms                  | 4.888 ms                  |
| forward: a2a keys         | 6.042 ms                  | 129.157 ms                |
| forward: search cache     | 323.047 us                | 843.536 us                |
| forward: a2a values       | 17.527 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 3.574 ms                  |
| Forward                   | 56.406 ms                 | 184.330 ms                |
| back: aggr dram keys      | 47.030 ms                 | 99.960 ms                 |
| back: set dram grad       | 1.558 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.581 ms                 | 48.449 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 128.944 ms                |
| Backward                  | 222.673 ms                | 291.604 ms                |
| Optimize                  | 21.992 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 40.722 us                 | 91.107 us                 |
| BlockToStepN              | 45.874 us                 | 15.751 ms                 |
| OneStep                   | 318.616 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.261 ms                  | 116.559 ms                |
| bucket keys               | 1.744 ms                  | 4.888 ms                  |
| forward: a2a keys         | 6.199 ms                  | 129.157 ms                |
| forward: search cache     | 321.739 us                | 843.536 us                |
| forward: a2a values       | 17.527 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 3.574 ms                  |
| Forward                   | 56.659 ms                 | 184.330 ms                |
| back: aggr dram keys      | 47.030 ms                 | 99.960 ms                 |
| back: set dram grad       | 1.558 ms                  | 7.570 ms                  |
| back: a2a grad            | 23.674 ms                 | 48.449 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 128.944 ms                |
| Backward                  | 223.252 ms                | 291.604 ms                |
| Optimize                  | 23.602 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 39.967 us                 | 91.107 us                 |
| BlockToStepN              | 45.749 us                 | 15.751 ms                 |
| OneStep                   | 318.616 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.233 ms                  | 116.559 ms                |
| bucket keys               | 1.721 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.094 ms                  | 126.406 ms                |
| forward: search cache     | 318.701 us                | 678.016 us                |
| forward: a2a values       | 17.562 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 56.659 ms                 | 184.330 ms                |
| back: aggr dram keys      | 47.030 ms                 | 96.909 ms                 |
| back: set dram grad       | 1.558 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.608 ms                 | 45.133 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 128.944 ms                |
| Backward                  | 222.673 ms                | 291.604 ms                |
| Optimize                  | 23.707 ms                 | 50.897 ms                 |
| BarrierTimeBeforeRank0    | 39.909 us                 | 91.107 us                 |
| BlockToStepN              | 45.404 us                 | 15.751 ms                 |
| OneStep                   | 317.877 ms                | 531.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.361 ms                  | 104.454 ms                |
| bucket keys               | 1.721 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.070 ms                  | 126.406 ms                |
| forward: search cache     | 317.270 us                | 678.016 us                |
| forward: a2a values       | 17.562 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 55.666 ms                 | 180.651 ms                |
| back: aggr dram keys      | 47.030 ms                 | 96.909 ms                 |
| back: set dram grad       | 1.558 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.608 ms                 | 45.133 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 128.944 ms                |
| Backward                  | 221.894 ms                | 290.744 ms                |
| Optimize                  | 23.771 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 39.967 us                 | 91.107 us                 |
| BlockToStepN              | 45.874 us                 | 15.372 ms                 |
| OneStep                   | 314.624 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.093 ms                  | 104.454 ms                |
| bucket keys               | 1.722 ms                  | 4.888 ms                  |
| forward: a2a keys         | 6.073 ms                  | 126.406 ms                |
| forward: search cache     | 314.369 us                | 678.016 us                |
| forward: a2a values       | 17.734 ms                 | 43.321 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 55.500 ms                 | 180.651 ms                |
| back: aggr dram keys      | 47.030 ms                 | 96.909 ms                 |
| back: set dram grad       | 1.558 ms                  | 5.995 ms                  |
| back: a2a grad            | 23.674 ms                 | 45.133 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 128.944 ms                |
| Backward                  | 221.983 ms                | 290.744 ms                |
| Optimize                  | 23.839 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 40.030 us                 | 91.107 us                 |
| BlockToStepN              | 45.555 us                 | 15.372 ms                 |
| OneStep                   | 314.624 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.750 ms                  | 104.454 ms                |
| bucket keys               | 1.722 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.073 ms                  | 124.238 ms                |
| forward: search cache     | 304.539 us                | 643.732 us                |
| forward: a2a values       | 17.594 ms                 | 42.543 ms                 |
| forward: join             | 1.777 ms                  | 2.938 ms                  |
| Forward                   | 54.888 ms                 | 180.651 ms                |
| back: aggr dram keys      | 47.030 ms                 | 89.316 ms                 |
| back: set dram grad       | 2.024 ms                  | 5.857 ms                  |
| back: a2a grad            | 22.819 ms                 | 44.631 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 121.304 ms                |
| Backward                  | 221.705 ms                | 290.744 ms                |
| Optimize                  | 23.927 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 39.601 us                 | 91.107 us                 |
| BlockToStepN              | 45.555 us                 | 15.372 ms                 |
| OneStep                   | 313.091 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 32.248, sample: 1.610, forward: 6.202, backward: 12.623, update: 0.357
[proc 6] 200 steps, total: 32.247, sample: 1.428, forward: 6.411, backward: 12.620, update: 0.348
[proc 0] 200 steps, total: 32.247, sample: 1.331, forward: 6.058, backward: 22.151, update: 2.541
[proc 2] 200 steps, total: 32.247, sample: 1.732, forward: 6.040, backward: 12.924, update: 0.297
[proc 3] 200 steps, total: 32.248, sample: 1.525, forward: 6.322, backward: 12.814, update: 0.296
[proc 1] 200 steps, total: 32.247, sample: 1.805, forward: 6.017, backward: 13.334, update: 0.292
[proc 4] 200 steps, total: 32.247, sample: 1.848, forward: 5.938, backward: 12.632, update: 0.326
[proc 7] 200 steps, total: 32.248, sample: 0.812, forward: 7.020, backward: 12.871, update: 0.361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.936 ms                  | 116.559 ms                |
| bucket keys               | 1.717 ms                  | 4.888 ms                  |
| forward: a2a keys         | 6.070 ms                  | 124.238 ms                |
| forward: search cache     | 302.727 us                | 678.016 us                |
| forward: a2a values       | 16.936 ms                 | 42.543 ms                 |
| forward: join             | 2.015 ms                  | 3.686 ms                  |
| Forward                   | 53.909 ms                 | 180.651 ms                |
| back: aggr dram keys      | 47.030 ms                 | 89.316 ms                 |
| back: set dram grad       | 3.365 ms                  | 5.857 ms                  |
| back: a2a grad            | 20.933 ms                 | 44.631 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 121.304 ms                |
| Backward                  | 220.943 ms                | 290.744 ms                |
| Optimize                  | 24.066 ms                 | 49.192 ms                 |
| BarrierTimeBeforeRank0    | 39.157 us                 | 91.107 us                 |
| BlockToStepN              | 45.555 us                 | 15.751 ms                 |
| OneStep                   | 310.768 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.012 ms                  | 116.559 ms                |
| bucket keys               | 1.716 ms                  | 4.888 ms                  |
| forward: a2a keys         | 6.094 ms                  | 124.238 ms                |
| forward: search cache     | 302.581 us                | 838.928 us                |
| forward: a2a values       | 15.712 ms                 | 42.543 ms                 |
| forward: join             | 2.015 ms                  | 4.246 ms                  |
| Forward                   | 53.456 ms                 | 180.651 ms                |
| back: aggr dram keys      | 49.045 ms                 | 89.316 ms                 |
| back: set dram grad       | 3.365 ms                  | 5.857 ms                  |
| back: a2a grad            | 20.210 ms                 | 44.631 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 121.304 ms                |
| Backward                  | 218.634 ms                | 290.744 ms                |
| Optimize                  | 24.188 ms                 | 50.897 ms                 |
| BarrierTimeBeforeRank0    | 38.555 us                 | 92.604 us                 |
| BlockToStepN              | 45.555 us                 | 15.751 ms                 |
| OneStep                   | 309.682 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.717 ms                  | 116.559 ms                |
| bucket keys               | 1.714 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.151 ms                  | 113.460 ms                |
| forward: search cache     | 299.657 us                | 701.045 us                |
| forward: a2a values       | 14.697 ms                 | 39.617 ms                 |
| forward: join             | 2.059 ms                  | 3.805 ms                  |
| Forward                   | 53.423 ms                 | 180.651 ms                |
| back: aggr dram keys      | 49.045 ms                 | 86.832 ms                 |
| back: set dram grad       | 3.440 ms                  | 5.808 ms                  |
| back: a2a grad            | 19.065 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 120.842 ms                |
| Backward                  | 217.887 ms                | 290.744 ms                |
| Optimize                  | 24.302 ms                 | 51.013 ms                 |
| BarrierTimeBeforeRank0    | 38.383 us                 | 92.604 us                 |
| BlockToStepN              | 44.587 us                 | 15.751 ms                 |
| OneStep                   | 307.582 ms                | 516.017 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.456 ms                  | 104.454 ms                |
| bucket keys               | 1.712 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.110 ms                  | 113.460 ms                |
| forward: search cache     | 298.286 us                | 701.045 us                |
| forward: a2a values       | 12.846 ms                 | 39.617 ms                 |
| forward: join             | 2.075 ms                  | 4.246 ms                  |
| Forward                   | 52.912 ms                 | 177.688 ms                |
| back: aggr dram keys      | 49.207 ms                 | 86.832 ms                 |
| back: set dram grad       | 3.534 ms                  | 5.808 ms                  |
| back: a2a grad            | 18.356 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 120.842 ms                |
| Backward                  | 216.257 ms                | 275.153 ms                |
| Optimize                  | 24.462 ms                 | 50.897 ms                 |
| BarrierTimeBeforeRank0    | 37.758 us                 | 91.107 us                 |
| BlockToStepN              | 43.807 us                 | 15.751 ms                 |
| OneStep                   | 305.331 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.520 ms                  | 104.454 ms                |
| bucket keys               | 1.711 ms                  | 4.822 ms                  |
| forward: a2a keys         | 6.070 ms                  | 113.460 ms                |
| forward: search cache     | 297.909 us                | 701.045 us                |
| forward: a2a values       | 11.622 ms                 | 39.617 ms                 |
| forward: join             | 2.088 ms                  | 4.246 ms                  |
| Forward                   | 52.497 ms                 | 177.688 ms                |
| back: aggr dram keys      | 51.603 ms                 | 86.832 ms                 |
| back: set dram grad       | 3.601 ms                  | 5.857 ms                  |
| back: a2a grad            | 17.336 ms                 | 44.631 ms                 |
| back: grad sum & grad cache  | 24.164 ms                 | 120.842 ms                |
| Backward                  | 215.302 ms                | 275.153 ms                |
| Optimize                  | 24.576 ms                 | 50.897 ms                 |
| BarrierTimeBeforeRank0    | 37.527 us                 | 94.854 us                 |
| BlockToStepN              | 42.923 us                 | 15.752 ms                 |
| OneStep                   | 303.877 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.447 ms                  | 104.454 ms                |
| bucket keys               | 1.712 ms                  | 4.740 ms                  |
| forward: a2a keys         | 6.004 ms                  | 101.195 ms                |
| forward: search cache     | 297.843 us                | 678.016 us                |
| forward: a2a values       | 10.067 ms                 | 36.230 ms                 |
| forward: join             | 2.097 ms                  | 4.231 ms                  |
| Forward                   | 51.865 ms                 | 177.688 ms                |
| back: aggr dram keys      | 52.474 ms                 | 86.757 ms                 |
| back: set dram grad       | 3.666 ms                  | 5.808 ms                  |
| back: a2a grad            | 15.542 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 23.229 ms                 | 117.705 ms                |
| Backward                  | 212.665 ms                | 275.153 ms                |
| Optimize                  | 24.719 ms                 | 50.897 ms                 |
| BarrierTimeBeforeRank0    | 37.143 us                 | 94.854 us                 |
| BlockToStepN              | 42.510 us                 | 15.752 ms                 |
| OneStep                   | 301.030 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 28.090, sample: 1.088, forward: 5.155, backward: 14.318, update: 0.359
[proc 6] 300 steps, total: 28.090, sample: 0.961, forward: 5.292, backward: 14.219, update: 0.382
[proc 7] 300 steps, total: 28.089, sample: 0.676, forward: 5.556, backward: 14.306, update: 0.409
[proc 1] 300 steps, total: 28.089, sample: 1.285, forward: 4.989, backward: 14.612, update: 0.285
[proc 4] 300 steps, total: 28.089, sample: 1.280, forward: 4.985, backward: 14.158, update: 0.381
[proc 0] 300 steps, total: 28.090, sample: 1.020, forward: 4.923, backward: 18.385, update: 3.585
[proc 5] 300 steps, total: 28.090, sample: 1.028, forward: 5.241, backward: 14.161, update: 0.338
[proc 2] 300 steps, total: 28.090, sample: 1.147, forward: 5.106, backward: 14.329, update: 0.349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.345 ms                  | 104.454 ms                |
| bucket keys               | 1.721 ms                  | 4.740 ms                  |
| forward: a2a keys         | 5.903 ms                  | 101.195 ms                |
| forward: search cache     | 298.674 us                | 701.045 us                |
| forward: a2a values       | 10.034 ms                 | 36.230 ms                 |
| forward: join             | 2.109 ms                  | 4.231 ms                  |
| Forward                   | 51.724 ms                 | 177.688 ms                |
| back: aggr dram keys      | 52.968 ms                 | 86.757 ms                 |
| back: set dram grad       | 3.713 ms                  | 5.857 ms                  |
| back: a2a grad            | 13.631 ms                 | 44.631 ms                 |
| back: grad sum & grad cache  | 22.917 ms                 | 117.705 ms                |
| Backward                  | 210.918 ms                | 275.153 ms                |
| Optimize                  | 24.973 ms                 | 54.855 ms                 |
| BarrierTimeBeforeRank0    | 37.527 us                 | 94.854 us                 |
| BlockToStepN              | 42.097 us                 | 15.752 ms                 |
| OneStep                   | 299.590 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.229 ms                  | 104.454 ms                |
| bucket keys               | 1.729 ms                  | 3.938 ms                  |
| forward: a2a keys         | 5.874 ms                  | 94.142 ms                 |
| forward: search cache     | 300.868 us                | 678.016 us                |
| forward: a2a values       | 9.977 ms                  | 33.969 ms                 |
| forward: join             | 2.117 ms                  | 4.177 ms                  |
| Forward                   | 51.362 ms                 | 177.688 ms                |
| back: aggr dram keys      | 53.117 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.768 ms                  | 5.857 ms                  |
| back: a2a grad            | 13.243 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 22.917 ms                 | 116.572 ms                |
| Backward                  | 209.705 ms                | 275.153 ms                |
| Optimize                  | 25.740 ms                 | 54.855 ms                 |
| BarrierTimeBeforeRank0    | 37.591 us                 | 94.854 us                 |
| BlockToStepN              | 41.797 us                 | 18.020 ms                 |
| OneStep                   | 298.454 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.229 ms                  | 104.454 ms                |
| bucket keys               | 1.739 ms                  | 3.938 ms                  |
| forward: a2a keys         | 5.777 ms                  | 94.142 ms                 |
| forward: search cache     | 304.539 us                | 678.016 us                |
| forward: a2a values       | 9.911 ms                  | 34.501 ms                 |
| forward: join             | 2.125 ms                  | 4.177 ms                  |
| Forward                   | 50.479 ms                 | 177.688 ms                |
| back: aggr dram keys      | 52.968 ms                 | 86.757 ms                 |
| back: set dram grad       | 3.792 ms                  | 5.995 ms                  |
| back: a2a grad            | 12.805 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 22.473 ms                 | 116.572 ms                |
| Backward                  | 208.755 ms                | 275.153 ms                |
| Optimize                  | 27.216 ms                 | 54.855 ms                 |
| BarrierTimeBeforeRank0    | 37.705 us                 | 213.594 us                |
| BlockToStepN              | 40.334 us                 | 18.020 ms                 |
| OneStep                   | 296.739 ms                | 514.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.200 ms                  | 100.366 ms                |
| bucket keys               | 1.744 ms                  | 3.938 ms                  |
| forward: a2a keys         | 5.714 ms                  | 94.142 ms                 |
| forward: search cache     | 306.221 us                | 701.045 us                |
| forward: a2a values       | 9.825 ms                  | 34.501 ms                 |
| forward: join             | 2.133 ms                  | 4.231 ms                  |
| Forward                   | 49.846 ms                 | 173.188 ms                |
| back: aggr dram keys      | 52.968 ms                 | 86.757 ms                 |
| back: set dram grad       | 3.831 ms                  | 6.005 ms                  |
| back: a2a grad            | 12.655 ms                 | 42.910 ms                 |
| back: grad sum & grad cache  | 22.473 ms                 | 116.572 ms                |
| Backward                  | 207.182 ms                | 273.056 ms                |
| Optimize                  | 27.904 ms                 | 54.855 ms                 |
| BarrierTimeBeforeRank0    | 37.653 us                 | 96.712 us                 |
| BlockToStepN              | 39.918 us                 | 15.752 ms                 |
| OneStep                   | 294.913 ms                | 506.614 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.151 ms                  | 100.366 ms                |
| bucket keys               | 1.739 ms                  | 3.632 ms                  |
| forward: a2a keys         | 5.645 ms                  | 91.462 ms                 |
| forward: search cache     | 315.002 us                | 678.016 us                |
| forward: a2a values       | 8.660 ms                  | 33.969 ms                 |
| forward: join             | 2.147 ms                  | 4.177 ms                  |
| Forward                   | 49.236 ms                 | 173.188 ms                |
| back: aggr dram keys      | 53.046 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.853 ms                  | 5.995 ms                  |
| back: a2a grad            | 12.616 ms                 | 42.583 ms                 |
| back: grad sum & grad cache  | 22.473 ms                 | 116.355 ms                |
| Backward                  | 205.655 ms                | 273.056 ms                |
| Optimize                  | 28.437 ms                 | 55.073 ms                 |
| BarrierTimeBeforeRank0    | 37.409 us                 | 96.712 us                 |
| BlockToStepN              | 40.000 us                 | 15.752 ms                 |
| OneStep                   | 293.576 ms                | 506.614 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 26.236, sample: 0.955, forward: 4.426, backward: 14.499, update: 0.391
[proc 6] 400 steps, total: 26.237, sample: 0.762, forward: 4.620, backward: 14.514, update: 0.377
[proc 0] 400 steps, total: 26.236, sample: 0.818, forward: 4.347, backward: 16.919, update: 3.974
[proc 1] 400 steps, total: 26.237, sample: 0.996, forward: 4.437, backward: 14.914, update: 0.254
[proc 3] 400 steps, total: 26.237, sample: 0.833, forward: 4.543, backward: 14.587, update: 0.334
[proc 2] 400 steps, total: 26.236, sample: 0.890, forward: 4.506, backward: 14.600, update: 0.356
[proc 5] 400 steps, total: 26.236, sample: 0.747, forward: 4.629, backward: 14.508, update: 0.416
[proc 7] 400 steps, total: 26.237, sample: 0.592, forward: 4.779, backward: 14.634, update: 0.416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.903 ms                  | 100.366 ms                |
| bucket keys               | 1.738 ms                  | 3.938 ms                  |
| forward: a2a keys         | 5.537 ms                  | 91.462 ms                 |
| forward: search cache     | 316.463 us                | 678.016 us                |
| forward: a2a values       | 8.612 ms                  | 33.969 ms                 |
| forward: join             | 2.163 ms                  | 4.177 ms                  |
| Forward                   | 48.928 ms                 | 173.188 ms                |
| back: aggr dram keys      | 52.970 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.883 ms                  | 7.253 ms                  |
| back: a2a grad            | 12.573 ms                 | 42.583 ms                 |
| back: grad sum & grad cache  | 22.287 ms                 | 116.355 ms                |
| Backward                  | 202.523 ms                | 273.056 ms                |
| Optimize                  | 29.145 ms                 | 55.073 ms                 |
| BarrierTimeBeforeRank0    | 37.179 us                 | 96.712 us                 |
| BlockToStepN              | 40.032 us                 | 15.752 ms                 |
| OneStep                   | 291.958 ms                | 506.614 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.992 ms                  | 100.366 ms                |
| bucket keys               | 1.735 ms                  | 3.938 ms                  |
| forward: a2a keys         | 5.391 ms                  | 91.462 ms                 |
| forward: search cache     | 315.227 us                | 678.016 us                |
| forward: a2a values       | 8.612 ms                  | 33.969 ms                 |
| forward: join             | 2.166 ms                  | 4.177 ms                  |
| Forward                   | 48.720 ms                 | 173.188 ms                |
| back: aggr dram keys      | 52.971 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.892 ms                  | 7.253 ms                  |
| back: a2a grad            | 12.453 ms                 | 42.583 ms                 |
| back: grad sum & grad cache  | 22.287 ms                 | 116.355 ms                |
| Backward                  | 200.351 ms                | 273.056 ms                |
| Optimize                  | 30.885 ms                 | 55.073 ms                 |
| BarrierTimeBeforeRank0    | 37.041 us                 | 96.712 us                 |
| BlockToStepN              | 39.918 us                 | 15.752 ms                 |
| OneStep                   | 289.906 ms                | 506.614 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.903 ms                  | 100.366 ms                |
| bucket keys               | 1.731 ms                  | 3.632 ms                  |
| forward: a2a keys         | 5.379 ms                  | 86.332 ms                 |
| forward: search cache     | 309.400 us                | 643.732 us                |
| forward: a2a values       | 8.612 ms                  | 33.934 ms                 |
| forward: join             | 2.169 ms                  | 3.959 ms                  |
| Forward                   | 48.399 ms                 | 173.188 ms                |
| back: aggr dram keys      | 52.970 ms                 | 85.210 ms                 |
| back: set dram grad       | 3.919 ms                  | 6.005 ms                  |
| back: a2a grad            | 12.404 ms                 | 41.968 ms                 |
| back: grad sum & grad cache  | 22.287 ms                 | 116.150 ms                |
| Backward                  | 197.469 ms                | 273.056 ms                |
| Optimize                  | 33.301 ms                 | 55.073 ms                 |
| BarrierTimeBeforeRank0    | 36.976 us                 | 96.712 us                 |
| BlockToStepN              | 38.694 us                 | 15.752 ms                 |
| OneStep                   | 287.504 ms                | 506.614 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.735 ms                  | 95.616 ms                 |
| bucket keys               | 1.728 ms                  | 3.632 ms                  |
| forward: a2a keys         | 5.341 ms                  | 86.332 ms                 |
| forward: search cache     | 305.149 us                | 643.732 us                |
| forward: a2a values       | 8.655 ms                  | 33.934 ms                 |
| forward: join             | 2.172 ms                  | 3.959 ms                  |
| Forward                   | 48.118 ms                 | 172.788 ms                |
| back: aggr dram keys      | 53.046 ms                 | 86.757 ms                 |
| back: set dram grad       | 3.939 ms                  | 7.497 ms                  |
| back: a2a grad            | 12.403 ms                 | 41.968 ms                 |
| back: grad sum & grad cache  | 20.644 ms                 | 116.150 ms                |
| Backward                  | 194.756 ms                | 271.264 ms                |
| Optimize                  | 34.584 ms                 | 54.968 ms                 |
| BarrierTimeBeforeRank0    | 36.727 us                 | 94.854 us                 |
| BlockToStepN              | 38.619 us                 | 15.751 ms                 |
| OneStep                   | 287.172 ms                | 505.099 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.712 ms                  | 95.616 ms                 |
| bucket keys               | 1.725 ms                  | 3.122 ms                  |
| forward: a2a keys         | 5.291 ms                  | 78.892 ms                 |
| forward: search cache     | 303.819 us                | 609.157 us                |
| forward: a2a values       | 8.655 ms                  | 32.404 ms                 |
| forward: join             | 2.174 ms                  | 3.805 ms                  |
| Forward                   | 47.960 ms                 | 172.788 ms                |
| back: aggr dram keys      | 53.052 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.954 ms                  | 7.544 ms                  |
| back: a2a grad            | 12.287 ms                 | 38.516 ms                 |
| back: grad sum & grad cache  | 20.644 ms                 | 115.975 ms                |
| Backward                  | 191.380 ms                | 271.264 ms                |
| Optimize                  | 34.922 ms                 | 55.206 ms                 |
| BarrierTimeBeforeRank0    | 36.604 us                 | 94.854 us                 |
| BlockToStepN              | 38.633 us                 | 15.751 ms                 |
| OneStep                   | 284.573 ms                | 505.099 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 26.045, sample: 0.857, forward: 4.380, backward: 14.553, update: 0.388
[proc 7] 500 steps, total: 26.044, sample: 0.618, forward: 4.587, backward: 14.695, update: 0.429
[proc 2] 500 steps, total: 26.044, sample: 0.793, forward: 4.451, backward: 14.658, update: 0.388
[proc 6] 500 steps, total: 26.045, sample: 0.723, forward: 4.521, backward: 14.594, update: 0.392
[proc 5] 500 steps, total: 26.044, sample: 0.697, forward: 4.550, backward: 14.553, update: 0.431
[proc 0] 500 steps, total: 26.045, sample: 0.872, forward: 4.128, backward: 16.956, update: 3.970
[proc 3] 500 steps, total: 26.044, sample: 0.770, forward: 4.454, backward: 14.661, update: 0.361
[proc 1] 500 steps, total: 26.044, sample: 0.844, forward: 4.423, backward: 14.956, update: 0.251
Successfully xmh. training takes 149.71381306648254 seconds
before call kg_cache_controller.StopThreads()
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
INFO [8644 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.728 ms                  | 95.616 ms                 |
| bucket keys               | 1.724 ms                  | 3.122 ms                  |
| forward: a2a keys         | 5.204 ms                  | 78.892 ms                 |
| forward: search cache     | 301.672 us                | 609.157 us                |
| forward: a2a values       | 8.660 ms                  | 32.404 ms                 |
| forward: join             | 2.175 ms                  | 3.805 ms                  |
| Forward                   | 47.793 ms                 | 172.788 ms                |
| back: aggr dram keys      | 53.204 ms                 | 86.602 ms                 |
| back: set dram grad       | 3.967 ms                  | 7.570 ms                  |
| back: a2a grad            | 12.254 ms                 | 38.623 ms                 |
| back: grad sum & grad cache  | 20.644 ms                 | 115.975 ms                |
| Backward                  | 190.580 ms                | 271.264 ms                |
| Optimize                  | 35.564 ms                 | 55.206 ms                 |
| BarrierTimeBeforeRank0    | 36.424 us                 | 213.594 us                |
| BlockToStepN              | 38.619 us                 | 15.751 ms                 |
| OneStep                   | 283.832 ms                | 505.099 ms                |
+---------------------------+---------------------------+---------------------------+
