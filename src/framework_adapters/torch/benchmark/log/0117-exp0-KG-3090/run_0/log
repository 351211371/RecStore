WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240118 23:20:55.425701  7504 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_138', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [7504 sampler.py:454] Start PreSampling
WARNING [7504 sampler.py:532] Before construct renumbering_dict
WARNING [7504 sampler.py:555] PreSampling done
W20240118 23:20:57.880388  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240118 23:20:57.880672  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240118 23:20:57.880723  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240118 23:20:57.880759  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240118 23:20:57.880815  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240118 23:20:57.880848  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240118 23:20:57.880878  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240118 23:20:57.880920  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240118 23:20:57.880951  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240118 23:20:57.880978  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240118 23:20:57.881014  7504 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240118 23:20:57.881036  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240118 23:20:57.881057  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240118 23:20:57.881196  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240118 23:20:57.881222  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240118 23:20:57.881242  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240118 23:20:57.881268  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240118 23:20:57.881289  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240118 23:20:57.881327  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240118 23:20:57.881353  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240118 23:20:57.881402  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240118 23:20:57.881423  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240118 23:20:57.881443  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240118 23:20:57.881475  7504 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240118 23:20:57.881494  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240118 23:20:57.881510  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240118 23:20:57.881553  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240118 23:20:57.881582  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240118 23:20:57.881608  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240118 23:20:57.881628  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240118 23:20:57.881652  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240118 23:20:57.881698  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240118 23:20:57.881724  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240118 23:20:57.881744  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240118 23:20:57.881767  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240118 23:20:57.881799  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240118 23:20:57.881834  7504 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240118 23:20:57.881850  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240118 23:20:57.881866  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240118 23:20:57.881906  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240118 23:20:57.881937  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240118 23:20:57.881971  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240118 23:20:57.882009  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240118 23:20:57.882028  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240118 23:20:57.882054  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240118 23:20:57.882074  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240118 23:20:57.882094  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240118 23:20:57.882118  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240118 23:20:57.882145  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240118 23:20:57.882179  7504 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240118 23:20:57.882195  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240118 23:20:57.882211  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240118 23:20:57.882270  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240118 23:20:57.882295  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240118 23:20:57.882321  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240118 23:20:57.882341  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240118 23:20:57.882369  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240118 23:20:57.882395  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240118 23:20:57.882416  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240118 23:20:57.882441  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240118 23:20:57.882467  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240118 23:20:57.882486  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240118 23:20:57.882505  7504 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240118 23:20:57.882522  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240118 23:20:57.882544  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240118 23:20:57.882586  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240118 23:20:57.882632  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240118 23:20:57.882654  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240118 23:20:57.882674  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240118 23:20:57.882694  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240118 23:20:57.882721  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240118 23:20:57.882741  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240118 23:20:57.882761  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240118 23:20:57.882782  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240118 23:20:57.882809  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240118 23:20:57.882829  7504 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240118 23:20:57.882846  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240118 23:20:57.882862  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240118 23:20:57.882901  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240118 23:20:57.882927  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240118 23:20:57.882949  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240118 23:20:57.882970  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240118 23:20:57.882992  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240118 23:20:57.883011  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240118 23:20:57.883046  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240118 23:20:57.883067  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240118 23:20:57.883096  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240118 23:20:57.883118  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240118 23:20:57.883138  7504 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240118 23:20:57.883155  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240118 23:20:57.883172  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240118 23:20:57.883212  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240118 23:20:57.883235  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240118 23:20:57.883256  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240118 23:20:57.883284  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240118 23:20:57.883306  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240118 23:20:57.883332  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240118 23:20:57.883361  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240118 23:20:57.883385  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240118 23:20:57.883409  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240118 23:20:57.883430  7504 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240118 23:20:57.883453  7504 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240118 23:20:57.883469  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240118 23:20:57.883491  7504 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240118 23:20:58.100606  7504 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240118 23:20:58.100765  7504 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([1503, 2057, 2760,  ..., 7969, 8300, 8401]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.712 seconds
[Rank1] pid = 7861
[Rank2] pid = 7925
[Rank3] pid = 7990
[Rank4] pid = 7996
[Rank5] pid = 8123
[Rank6] pid = 8124
INFO [7504 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [7861 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [7925 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [7990 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [7996 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [8123 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [7925 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7861 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8124 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [8189 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [8123 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8189 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8124 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7996 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7504 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7990 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240118 23:21:01.469774  8190 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240118 23:21:01.470041  7926 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240118 23:21:01.470316  7862 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240118 23:21:01.470546  8315 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240118 23:21:01.470573  8126 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240118 23:21:01.470588  8125 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240118 23:21:01.471015  7997 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240118 23:21:01.471021  8060 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240118 23:21:01.508285  8315 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x1000054a8000
W20240118 23:21:01.508458  8125 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x100005579000
W20240118 23:21:01.508473  8315 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x10000563e000
W20240118 23:21:01.508497  8126 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x100005703000
W20240118 23:21:01.508544  8315 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 400]0x1000057c8000
W20240118 23:21:01.508584  8315 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10000f125000
W20240118 23:21:01.508572  7862 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x10000f060000
W20240118 23:21:01.508594  8190 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1000189bd000
W20240118 23:21:01.508610  7997 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100018a82000
W20240118 23:21:01.508622  8125 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x100018b47000
W20240118 23:21:01.508620  8315 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240118 23:21:01.508642  8060 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x100018c0c000
W20240118 23:21:01.508659  7926 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x100018cd1000
W20240118 23:21:01.508678  8126 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x100018d96000
W20240118 23:21:01.508690  8125 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 400]0x100018e5b000
W20240118 23:21:01.508700  8190 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1000226f3000
W20240118 23:21:01.508728  8125 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x1000227b8000
W20240118 23:21:01.508749  7862 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x10002c050000
W20240118 23:21:01.508755  8126 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 400]0x10002c115000
W20240118 23:21:01.508757  8190 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x1000359ad000
W20240118 23:21:01.508771  8125 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240118 23:21:01.508791  7997 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x10003f245000
W20240118 23:21:01.508809  8190 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10003f30a000
W20240118 23:21:01.508826  8126 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x100048ba2000
W20240118 23:21:01.508833  7862 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x10005243a000
W20240118 23:21:01.508853  7926 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x10005bcd2000
W20240118 23:21:01.508859  8060 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x10005bd97000
W20240118 23:21:01.508857  8190 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240118 23:21:01.508872  8126 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240118 23:21:01.508896  7997 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x10005be5c000
W20240118 23:21:01.508903  7862 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1000656f4000
W20240118 23:21:01.508929  7926 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x10006ef8c000
W20240118 23:21:01.508949  8060 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 400]0x100078824000
W20240118 23:21:01.508944  7862 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240118 23:21:01.508956  7997 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x1000820bc000
W20240118 23:21:01.508985  7926 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10008b954000
W20240118 23:21:01.509006  8060 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1000951ec000
W20240118 23:21:01.509012  7997 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240118 23:21:01.509023  7926 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240118 23:21:01.509037  8060 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240118 23:21:01.511482  8315 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240118 23:21:01.511734  8190 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240118 23:21:01.511751  7997 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240118 23:21:01.511763  7862 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240118 23:21:01.511778  8125 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240118 23:21:01.511788  8126 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240118 23:21:01.511941  7926 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240118 23:21:01.511986  8060 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [8124 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [8189 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [7996 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [7990 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [7861 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [7925 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 8189
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [7504 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [8123 DistTensor.py:56] The tensor name already exists in the kvstore
I20240118 23:21:01.682811  8126 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682847  8125 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682875  7997 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682901  8190 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682926  7926 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682950  8315 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.682974  8060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240118 23:21:01.683003  7862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240118 23:21:01.683926  8190 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1
        }
W20240118 23:21:01.684043  8190 grad_base.h:172] Init GradProcessingBase done
I20240118 23:21:01.687558  8190 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240118 23:21:01.687672  8190 kg_controller.h:78] after init GradAsyncProcessingV2
I20240118 23:21:01.687677  8190 kg_controller.h:84] Construct KGCacheController done
I20240118 23:21:02.386615  8190 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240118 23:21:03.468369  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:21:03.468930  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240118 23:21:03.522436  7862 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240118 23:21:03.552980  8125 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.553529  8126 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.554531  8315 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.554772  7926 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.563948  8190 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.573316  7997 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:21:03.581364  8060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240118 23:21:05.536082  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240118 23:21:05.592670  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=0
W20240118 23:21:05.614210  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:21:06.536171  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=6522
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.301 ms                  | 60.588 ms                 |
| Forward                   | 11.363 ms                 | 524.094 ms                |
| Backward                  | 15.153 ms                 | 240.235 ms                |
| Optimize                  | 4.769 ms                  | 38.969 ms                 |
| BarrierTimeBeforeRank0    | 3.096 ms                  | 95.380 ms                 |
| AfterBackward             | 59.997 ms                 | 1.110 s                   |
| BlockToStepN              | 68.506 us                 | 18.372 ms                 |
| OneStep                   | 101.394 ms                | 2.031 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:06.783072  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
W20240118 23:21:06.927466  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=11, pq.top=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.579 ms                 | 303.235 ms                |
| ProcessBack:UpdateCache   | 9.289 ms                  | 742.325 ms                |
| ProcessBack:UpsertPq      | 35.164 ms                 | 56.116 ms                 |
| ProcessOneStep            | 63.000 ms                 | 1.109 s                   |
| BlockToStepN              | 11.059 us                 | 17.815 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:07.536012  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=4295
W20240118 23:21:07.787452  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240118 23:21:07.927013  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
E20240118 23:21:08.536067  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2190
W20240118 23:21:08.927008  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240118 23:21:08.955464  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
E20240118 23:21:09.536020  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=3058
W20240118 23:21:10.026262  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=22, pq.top=22
W20240118 23:21:10.043344  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
E20240118 23:21:10.536008  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=88
W20240118 23:21:11.186761  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
W20240118 23:21:11.196666  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
E20240118 23:21:11.536016  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=40
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.570 ms                  | 68.282 ms                 |
| Forward                   | 11.363 ms                 | 524.094 ms                |
| Backward                  | 15.153 ms                 | 240.235 ms                |
| Optimize                  | 6.171 ms                  | 38.969 ms                 |
| BarrierTimeBeforeRank0    | 2.722 ms                  | 95.380 ms                 |
| AfterBackward             | 61.215 ms                 | 1.110 s                   |
| BlockToStepN              | 27.904 ms                 | 523.817 ms                |
| OneStep                   | 159.385 ms                | 2.031 s                   |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:12.197583  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
W20240118 23:21:12.327987  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=32, pq.top=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.731 ms                 | 302.959 ms                |
| ProcessBack:UpdateCache   | 9.856 ms                  | 742.087 ms                |
| ProcessBack:UpsertPq      | 35.184 ms                 | 71.761 ms                 |
| ProcessOneStep            | 61.678 ms                 | 1.109 s                   |
| BlockToStepN              | 27.712 ms                 | 523.576 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:12.536042  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1058
W20240118 23:21:13.242440  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:21:13.361313  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=38, pq.top=38
E20240118 23:21:13.536013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=771
W20240118 23:21:14.249454  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240118 23:21:14.482674  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=44, pq.top=44
E20240118 23:21:14.536041  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1566
W20240118 23:21:15.264003  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:21:15.495813  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240118 23:21:15.536031  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1138
W20240118 23:21:16.271178  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:21:16.495010  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=53, pq.top=53
E20240118 23:21:16.536026  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=4239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.354 ms                  | 65.202 ms                 |
| Forward                   | 10.791 ms                 | 25.317 ms                 |
| Backward                  | 15.321 ms                 | 20.553 ms                 |
| Optimize                  | 5.496 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 5.111 ms                  | 48.025 ms                 |
| AfterBackward             | 59.997 ms                 | 251.288 ms                |
| BlockToStepN              | 58.764 ms                 | 392.937 ms                |
| OneStep                   | 188.224 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:17.294312  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.309 ms                 | 302.959 ms                |
| ProcessBack:UpdateCache   | 9.251 ms                  | 742.087 ms                |
| ProcessBack:UpsertPq      | 33.141 ms                 | 71.761 ms                 |
| ProcessOneStep            | 58.352 ms                 | 251.240 ms                |
| BlockToStepN              | 60.556 ms                 | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:17.495059  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240118 23:21:17.536008  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=4023
W20240118 23:21:18.375689  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:21:18.495047  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
E20240118 23:21:18.536921  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=1188
W20240118 23:21:19.466475  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:21:19.536016  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=5778
W20240118 23:21:19.581210  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240118 23:21:20.517325  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:21:20.536013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=4223
W20240118 23:21:20.611793  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240118 23:21:21.541055  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2011
W20240118 23:21:21.580821  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.301 ms                  | 65.202 ms                 |
| Forward                   | 10.780 ms                 | 25.317 ms                 |
| Backward                  | 15.276 ms                 | 20.553 ms                 |
| Optimize                  | 5.488 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 5.514 ms                  | 52.158 ms                 |
| AfterBackward             | 56.812 ms                 | 251.288 ms                |
| BlockToStepN              | 92.757 ms                 | 392.937 ms                |
| OneStep                   | 213.475 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:21.717401  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.178 ms                 | 302.959 ms                |
| ProcessBack:UpdateCache   | 8.938 ms                  | 742.087 ms                |
| ProcessBack:UpsertPq      | 31.683 ms                 | 71.761 ms                 |
| ProcessOneStep            | 56.768 ms                 | 251.240 ms                |
| BlockToStepN              | 95.601 ms                 | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:22.541015  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=804
W20240118 23:21:22.668160  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:21:22.759363  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=77, pq.top=77
E20240118 23:21:23.542423  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240118 23:21:23.759011  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240118 23:21:23.765717  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:21:24.543081  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1261
W20240118 23:21:24.759070  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=84, pq.top=84
W20240118 23:21:24.768719  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:21:25.543102  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2182
W20240118 23:21:25.759122  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240118 23:21:25.868160  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:21:26.543013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3774
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.265 ms                  | 65.202 ms                 |
| Forward                   | 10.788 ms                 | 25.317 ms                 |
| Backward                  | 15.325 ms                 | 23.246 ms                 |
| Optimize                  | 5.491 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 4.722 ms                  | 67.806 ms                 |
| AfterBackward             | 56.534 ms                 | 251.288 ms                |
| BlockToStepN              | 111.832 ms                | 392.937 ms                |
| OneStep                   | 241.937 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:26.759126  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=90, pq.top=90
W20240118 23:21:26.876387  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.163 ms                 | 16.782 ms                 |
| ProcessBack:UpdateCache   | 8.808 ms                  | 15.258 ms                 |
| ProcessBack:UpsertPq      | 31.362 ms                 | 65.456 ms                 |
| ProcessOneStep            | 56.441 ms                 | 251.240 ms                |
| BlockToStepN              | 118.893 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:27.543040  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1718
W20240118 23:21:27.765256  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=94, pq.top=94
W20240118 23:21:27.974504  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:21:28.544435  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1911
W20240118 23:21:28.765101  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240118 23:21:28.991145  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:21:29.544029  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=954
[proc 7] 100 steps, total: 26.089, sample: 0.732, forward: 1.316, backward: 1.806, update: 0.583
[proc 1] 100 steps, total: 26.122, sample: 0.759, forward: 1.288, backward: 1.706, update: 0.587
[proc 4] 100 steps, total: 26.062, sample: 0.740, forward: 1.282, backward: 1.737, update: 0.562
[proc 5] 100 steps, total: 26.090, sample: 0.744, forward: 1.282, backward: 1.734, update: 0.575
[proc 3] 100 steps, total: 26.070, sample: 0.821, forward: 1.487, backward: 1.706, update: 0.592
[proc 6] 100 steps, total: 26.091, sample: 0.774, forward: 1.361, backward: 1.771, update: 0.586
[proc 2] 100 steps, total: 26.089, sample: 0.783, forward: 1.339, backward: 1.742, update: 0.567
-------Step 0-------
tensor([ 2465,     3,  3560,    84, 13749, 13988,  1893,  9040, 11584, 13307]) tensor([ 2760,  8308,  5488, 10029, 10462,  1721,  5147,  6170,   940,  1303])
-------Step 1-------
tensor([ 2465,     3,  3560,    84, 13749, 13988,  1893,  9040, 11584, 13307]) tensor([ 8842, 12962, 11924, 10614,  1168,  3205,  8405,  1082,  3124, 11631])
-------Step 2-------
tensor([ 4661,  8481,  4819, 10790,  8039, 10675,  8213,    19,  5879,  2554]) tensor([ 7388,  5338,  5641,  9038,  2978, 12425,   314,  2282, 12623,  3570])
-------Step 3-------
tensor([ 4661,  8481,  4819, 10790,  8039, 10675,  8213,    19,  5879,  2554]) tensor([14213,   395, 10582, 12909,  8402,  7051,  8159,   866,  3700,  4844])
-------Step 4-------
tensor([13866,    45,   178,  4001,  6494, 10975,   101, 10105,  6702,    91]) tensor([ 3836, 12245, 12742,  2085,  1773,  6943,   598, 11973,  5152, 14155])
-------Step 5-------
tensor([13866,    45,   178,  4001,  6494, 10975,   101, 10105,  6702,    91]) tensor([ 5238,  5435,  2711, 11679,  9547,  9876, 13793,  5351,  3671,  8308])
-------Step 6-------
tensor([ 2181,  4346, 12575,  3729,    86,  5896,  7935,  2125, 12825,  1027]) tensor([13821,  5025, 13930,  7220,  1146, 14511, 12253, 11973, 13600, 13993])
-------Step 7-------
tensor([ 2181,  4346, 12575,  3729,    86,  5896,  7935,  2125, 12825,  1027]) tensor([ 3911,  7453,  7101, 14859,  6037,   183,  6349,  1599,  3457,  4534])
-------Step 8-------
tensor([ 2621,  7826,  7596, 13966,  6702,  3041,  7714,  3760,  3601,  4782]) tensor([  300,   298, 12023, 14329,  6016,  6264, 14220,   747,     1,  7624])
-------Step 9-------
tensor([ 2621,  7826,  7596, 13966,  6702,  3041,  7714,  3760,  3601,  4782]) tensor([   50, 14244, 12221,  9750,  4247, 11406,  1222, 11752,  5759, 11943])
[proc 0] 100 steps, total: 26.080, sample: 0.932, forward: 1.352, backward: 1.771, update: 0.611
W20240118 23:21:29.765069  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240118 23:21:30.007674  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:21:30.544602  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1852
W20240118 23:21:30.765105  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240118 23:21:31.191634  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:21:31.544013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=6137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.279 ms                  | 65.202 ms                 |
| Forward                   | 10.696 ms                 | 25.317 ms                 |
| Backward                  | 15.272 ms                 | 23.246 ms                 |
| Optimize                  | 5.474 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 4.728 ms                  | 67.806 ms                 |
| AfterBackward             | 56.128 ms                 | 251.288 ms                |
| BlockToStepN              | 126.608 ms                | 392.937 ms                |
| OneStep                   | 258.066 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:31.765182  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240118 23:21:32.206857  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.178 ms                 | 16.782 ms                 |
| ProcessBack:UpdateCache   | 8.718 ms                  | 15.258 ms                 |
| ProcessBack:UpsertPq      | 31.198 ms                 | 65.456 ms                 |
| ProcessOneStep            | 56.084 ms                 | 251.240 ms                |
| BlockToStepN              | 126.519 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:32.545212  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=824
W20240118 23:21:32.806265  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240118 23:21:33.219942  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:21:33.545017  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=4118
W20240118 23:21:33.806198  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240118 23:21:34.221719  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:21:34.545033  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=5611
W20240118 23:21:34.806108  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240118 23:21:35.224208  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:21:35.547797  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=6316
W20240118 23:21:35.843099  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240118 23:21:36.243901  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:21:36.547432  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=935
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.266 ms                  | 65.202 ms                 |
| Forward                   | 10.534 ms                 | 25.317 ms                 |
| Backward                  | 15.255 ms                 | 23.246 ms                 |
| Optimize                  | 5.434 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 5.144 ms                  | 67.806 ms                 |
| AfterBackward             | 56.128 ms                 | 251.288 ms                |
| BlockToStepN              | 145.525 ms                | 392.937 ms                |
| OneStep                   | 266.584 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:36.843070  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240118 23:21:37.262184  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.082 ms                 | 19.953 ms                 |
| ProcessBack:UpdateCache   | 8.652 ms                  | 15.256 ms                 |
| ProcessBack:UpsertPq      | 30.794 ms                 | 62.914 ms                 |
| ProcessOneStep            | 55.891 ms                 | 251.240 ms                |
| BlockToStepN              | 146.240 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:37.548244  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=3564
W20240118 23:21:37.883322  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240118 23:21:38.312068  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:21:38.553977  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1823
W20240118 23:21:38.883013  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240118 23:21:39.318500  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:21:39.553069  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=3219
W20240118 23:21:39.883100  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240118 23:21:40.342315  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:21:40.553191  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2349
W20240118 23:21:40.883162  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240118 23:21:41.356896  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:21:41.553015  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3037
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.273 ms                  | 65.202 ms                 |
| Forward                   | 10.598 ms                 | 25.317 ms                 |
| Backward                  | 15.260 ms                 | 23.246 ms                 |
| Optimize                  | 5.434 ms                  | 13.982 ms                 |
| BarrierTimeBeforeRank0    | 5.333 ms                  | 67.806 ms                 |
| AfterBackward             | 55.835 ms                 | 251.288 ms                |
| BlockToStepN              | 149.320 ms                | 392.937 ms                |
| OneStep                   | 270.835 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:41.988476  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240118 23:21:42.374681  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.984 ms                 | 19.953 ms                 |
| ProcessBack:UpdateCache   | 8.649 ms                  | 15.256 ms                 |
| ProcessBack:UpsertPq      | 30.765 ms                 | 62.914 ms                 |
| ProcessOneStep            | 55.732 ms                 | 251.240 ms                |
| BlockToStepN              | 150.357 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:42.553020  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=463
W20240118 23:21:42.988131  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240118 23:21:43.463424  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:21:43.553010  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=2465
W20240118 23:21:43.988166  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240118 23:21:44.470682  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:21:44.553009  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=637
W20240118 23:21:44.988181  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240118 23:21:45.483361  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:21:45.553007  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1340
W20240118 23:21:45.988040  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240118 23:21:46.498332  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:21:46.553020  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.279 ms                  | 60.588 ms                 |
| Forward                   | 10.492 ms                 | 15.332 ms                 |
| Backward                  | 15.276 ms                 | 20.553 ms                 |
| Optimize                  | 5.431 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 5.111 ms                  | 56.486 ms                 |
| AfterBackward             | 55.835 ms                 | 104.628 ms                |
| BlockToStepN              | 157.048 ms                | 387.396 ms                |
| OneStep                   | 276.845 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:47.067063  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=158, pq.top=158
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.962 ms                 | 19.953 ms                 |
| ProcessBack:UpdateCache   | 8.571 ms                  | 15.256 ms                 |
| ProcessBack:UpsertPq      | 30.571 ms                 | 62.914 ms                 |
| ProcessOneStep            | 55.732 ms                 | 104.551 ms                |
| BlockToStepN              | 156.664 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:47.537659  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:21:47.553028  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=4270
W20240118 23:21:48.067142  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240118 23:21:48.553133  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1469
W20240118 23:21:48.553876  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:21:49.125173  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240118 23:21:49.553071  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2090
W20240118 23:21:49.636094  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:21:50.176155  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
E20240118 23:21:50.557641  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2315
W20240118 23:21:50.662011  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:21:51.176347  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
E20240118 23:21:51.557016  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=5179
W20240118 23:21:51.675277  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.301 ms                  | 60.588 ms                 |
| Forward                   | 10.534 ms                 | 15.332 ms                 |
| Backward                  | 15.325 ms                 | 20.553 ms                 |
| Optimize                  | 5.417 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 5.111 ms                  | 56.486 ms                 |
| AfterBackward             | 55.683 ms                 | 104.628 ms                |
| BlockToStepN              | 161.131 ms                | 387.396 ms                |
| OneStep                   | 280.546 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:52.261965  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.847 ms                 | 20.262 ms                 |
| ProcessBack:UpdateCache   | 8.576 ms                  | 15.256 ms                 |
| ProcessBack:UpsertPq      | 30.571 ms                 | 62.914 ms                 |
| ProcessOneStep            | 55.629 ms                 | 104.551 ms                |
| BlockToStepN              | 161.011 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:21:52.557016  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=6556
W20240118 23:21:52.751323  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:21:53.261198  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240118 23:21:53.557161  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=742
W20240118 23:21:53.782454  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:21:54.261097  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
E20240118 23:21:54.557106  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1726
W20240118 23:21:54.792551  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:21:55.261406  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=184
E20240118 23:21:55.563798  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2604
W20240118 23:21:55.914860  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:21:56.373885  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=188
E20240118 23:21:56.563017  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3593
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.279 ms                  | 60.588 ms                 |
| Forward                   | 10.476 ms                 | 15.332 ms                 |
| Backward                  | 15.366 ms                 | 20.553 ms                 |
| Optimize                  | 5.431 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 4.728 ms                  | 56.486 ms                 |
| AfterBackward             | 55.454 ms                 | 104.628 ms                |
| BlockToStepN              | 167.784 ms                | 387.396 ms                |
| OneStep                   | 282.870 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:56.937065  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.824 ms                 | 19.953 ms                 |
| ProcessBack:UpdateCache   | 8.484 ms                  | 14.407 ms                 |
| ProcessBack:UpsertPq      | 30.479 ms                 | 61.412 ms                 |
| ProcessOneStep            | 55.386 ms                 | 104.551 ms                |
| BlockToStepN              | 167.570 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:21:57.501986  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=192
E20240118 23:21:57.564110  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1047
W20240118 23:21:58.013842  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:21:58.501030  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240118 23:21:58.585644  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2482
W20240118 23:21:59.042439  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
[proc 5] 200 steps, total: 29.493, sample: 0.738, forward: 0.796, backward: 1.552, update: 0.550
[proc 2] 200 steps, total: 29.493, sample: 0.736, forward: 0.807, backward: 1.506, update: 0.516
[proc 4] 200 steps, total: 29.493, sample: 0.815, forward: 0.792, backward: 1.555, update: 0.538
[proc 6] 200 steps, total: 29.493, sample: 0.685, forward: 0.826, backward: 1.527, update: 0.509
[proc 7] 200 steps, total: 29.494, sample: 0.790, forward: 0.787, backward: 1.540, update: 0.537
[proc 0] 200 steps, total: 29.493, sample: 0.754, forward: 0.768, backward: 1.540, update: 0.527
[proc 3] 200 steps, total: 29.493, sample: 0.648, forward: 0.842, backward: 1.512, update: 0.525
[proc 1] 200 steps, total: 29.493, sample: 0.622, forward: 0.776, backward: 1.521, update: 0.547
W20240118 23:21:59.501412  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240118 23:21:59.585013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3040
W20240118 23:22:00.091101  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
W20240118 23:22:00.501319  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
E20240118 23:22:00.585014  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3590
W20240118 23:22:01.197844  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
W20240118 23:22:01.529243  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=216, pq.top=216
E20240118 23:22:01.585096  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=2237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.255 ms                  | 60.588 ms                 |
| Forward                   | 10.450 ms                 | 15.332 ms                 |
| Backward                  | 15.362 ms                 | 20.553 ms                 |
| Optimize                  | 5.412 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 4.705 ms                  | 56.486 ms                 |
| AfterBackward             | 55.361 ms                 | 104.628 ms                |
| BlockToStepN              | 156.758 ms                | 387.396 ms                |
| OneStep                   | 276.845 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:02.229482  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.858 ms                 | 19.953 ms                 |
| ProcessBack:UpdateCache   | 8.470 ms                  | 14.407 ms                 |
| ProcessBack:UpsertPq      | 30.451 ms                 | 61.412 ms                 |
| ProcessOneStep            | 55.283 ms                 | 104.551 ms                |
| BlockToStepN              | 156.614 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:02.529309  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=220, pq.top=220
E20240118 23:22:02.585044  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=916
W20240118 23:22:03.248405  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:22:03.585803  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=3363
W20240118 23:22:03.631887  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240118 23:22:04.292392  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:22:04.585079  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2788
W20240118 23:22:04.675580  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240118 23:22:05.301019  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:22:05.585352  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3519
W20240118 23:22:05.675371  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240118 23:22:06.435472  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:22:06.585024  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=611
W20240118 23:22:06.675272  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=234, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.230 ms                  | 60.588 ms                 |
| Forward                   | 10.450 ms                 | 15.332 ms                 |
| Backward                  | 15.362 ms                 | 20.553 ms                 |
| Optimize                  | 5.381 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 4.705 ms                  | 56.486 ms                 |
| AfterBackward             | 55.028 ms                 | 104.628 ms                |
| BlockToStepN              | 159.170 ms                | 387.396 ms                |
| OneStep                   | 277.685 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.728 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.443 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 29.809 ms                 | 60.951 ms                 |
| ProcessOneStep            | 54.950 ms                 | 104.551 ms                |
| BlockToStepN              | 159.710 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:07.436591  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:22:07.585172  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=987
W20240118 23:22:07.738634  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240118 23:22:08.445605  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:22:08.585047  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1212
W20240118 23:22:08.787622  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240118 23:22:09.565896  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:22:09.585238  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2838
W20240118 23:22:09.787474  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240118 23:22:10.578423  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:22:10.585916  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3624
W20240118 23:22:10.787308  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240118 23:22:11.585474  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3334
W20240118 23:22:11.597607  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 60.588 ms                 |
| Forward                   | 10.492 ms                 | 15.332 ms                 |
| Backward                  | 15.338 ms                 | 20.553 ms                 |
| Optimize                  | 5.388 ms                  | 11.730 ms                 |
| BarrierTimeBeforeRank0    | 4.634 ms                  | 56.486 ms                 |
| AfterBackward             | 54.842 ms                 | 104.628 ms                |
| BlockToStepN              | 164.054 ms                | 387.396 ms                |
| OneStep                   | 282.227 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:11.787518  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=250, pq.top=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.644 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.405 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 29.326 ms                 | 60.951 ms                 |
| ProcessOneStep            | 54.745 ms                 | 94.969 ms                 |
| BlockToStepN              | 164.938 ms                | 348.120 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:12.585058  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=297
W20240118 23:22:12.614523  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:22:12.787123  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240118 23:22:13.585022  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1396
W20240118 23:22:13.632658  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:22:13.787078  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=256
E20240118 23:22:14.587538  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2829
W20240118 23:22:14.638506  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:22:14.787158  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240118 23:22:15.587013  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2447
W20240118 23:22:15.642668  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:22:15.787748  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=262, pq.top=262
E20240118 23:22:16.588862  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1444
W20240118 23:22:16.649140  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.226 ms                  | 59.382 ms                 |
| Forward                   | 10.534 ms                 | 14.877 ms                 |
| Backward                  | 15.339 ms                 | 19.565 ms                 |
| Optimize                  | 5.377 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.627 ms                  | 54.421 ms                 |
| AfterBackward             | 54.513 ms                 | 95.025 ms                 |
| BlockToStepN              | 171.314 ms                | 348.239 ms                |
| OneStep                   | 285.564 ms                | 491.549 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:16.787174  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.573 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.389 ms                  | 14.192 ms                 |
| ProcessBack:UpsertPq      | 29.039 ms                 | 60.951 ms                 |
| ProcessOneStep            | 54.429 ms                 | 94.969 ms                 |
| BlockToStepN              | 171.839 ms                | 348.120 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:17.591452  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1256
W20240118 23:22:17.723292  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:22:17.811426  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=268, pq.top=268
E20240118 23:22:18.591018  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1760
W20240118 23:22:18.727035  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:22:18.811578  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=270
E20240118 23:22:19.599722  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=723
W20240118 23:22:19.735666  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:22:19.821516  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
E20240118 23:22:20.600165  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=384
W20240118 23:22:20.818827  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:22:20.931402  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=276
E20240118 23:22:21.602648  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3016
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.230 ms                  | 59.382 ms                 |
| Forward                   | 10.534 ms                 | 14.877 ms                 |
| Backward                  | 15.297 ms                 | 19.565 ms                 |
| Optimize                  | 5.340 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.705 ms                  | 56.486 ms                 |
| AfterBackward             | 54.356 ms                 | 95.025 ms                 |
| BlockToStepN              | 175.768 ms                | 387.396 ms                |
| OneStep                   | 286.960 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:21.931353  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=278, pq.top=278
W20240118 23:22:21.978036  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.573 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.328 ms                  | 14.072 ms                 |
| ProcessBack:UpsertPq      | 29.006 ms                 | 59.422 ms                 |
| ProcessOneStep            | 54.316 ms                 | 94.969 ms                 |
| BlockToStepN              | 175.649 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:22.602692  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=684
W20240118 23:22:22.931216  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240118 23:22:23.196228  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:22:23.602011  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=1595
W20240118 23:22:23.931151  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240118 23:22:24.301385  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:22:24.603052  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1307
W20240118 23:22:24.931169  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240118 23:22:25.525763  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:22:25.608940  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3357
W20240118 23:22:25.991082  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240118 23:22:26.589198  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:22:26.608121  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3044
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.248 ms                  | 59.382 ms                 |
| Forward                   | 10.548 ms                 | 14.877 ms                 |
| Backward                  | 15.276 ms                 | 19.644 ms                 |
| Optimize                  | 5.341 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.722 ms                  | 56.486 ms                 |
| AfterBackward             | 54.169 ms                 | 95.025 ms                 |
| BlockToStepN              | 178.755 ms                | 387.396 ms                |
| OneStep                   | 289.120 ms                | 495.837 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:27.064229  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.570 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.295 ms                  | 14.072 ms                 |
| ProcessBack:UpsertPq      | 28.964 ms                 | 59.422 ms                 |
| ProcessOneStep            | 54.128 ms                 | 94.969 ms                 |
| BlockToStepN              | 179.026 ms                | 387.275 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:27.609208  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1299
W20240118 23:22:27.735493  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:22:28.064977  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=294, pq.top=294
E20240118 23:22:28.609045  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=519
W20240118 23:22:28.769407  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:22:29.064416  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
E20240118 23:22:29.609035  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1928
W20240118 23:22:29.786007  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:22:30.159329  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 4] 300 steps, total: 31.237, sample: 0.721, forward: 0.796, backward: 1.541, update: 0.511
[proc 1] 300 steps, total: 31.237, sample: 0.721, forward: 0.780, backward: 1.504, update: 0.523
[proc 0] 300 steps, total: 31.237, sample: 0.854, forward: 0.789, backward: 1.541, update: 0.525
[proc 7] 300 steps, total: 31.237, sample: 0.725, forward: 0.796, backward: 1.520, update: 0.527
[proc 6] 300 steps, total: 31.237, sample: 0.746, forward: 0.823, backward: 1.518, update: 0.522
[proc 5] 300 steps, total: 31.237, sample: 0.708, forward: 0.801, backward: 1.550, update: 0.520
[proc 3] 300 steps, total: 31.237, sample: 0.792, forward: 0.816, backward: 1.500, update: 0.506
[proc 2] 300 steps, total: 31.237, sample: 0.759, forward: 0.808, backward: 1.490, update: 0.502
E20240118 23:22:30.609259  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=664
W20240118 23:22:30.787505  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:22:31.170048  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240118 23:22:31.609524  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.255 ms                  | 59.382 ms                 |
| Forward                   | 10.492 ms                 | 14.877 ms                 |
| Backward                  | 15.261 ms                 | 19.644 ms                 |
| Optimize                  | 5.330 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.722 ms                  | 56.486 ms                 |
| AfterBackward             | 54.038 ms                 | 95.025 ms                 |
| BlockToStepN              | 180.220 ms                | 392.937 ms                |
| OneStep                   | 292.186 ms                | 504.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:31.933478  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:22:32.170231  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.559 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.255 ms                  | 14.072 ms                 |
| ProcessBack:UpsertPq      | 28.964 ms                 | 59.422 ms                 |
| ProcessOneStep            | 53.992 ms                 | 94.969 ms                 |
| BlockToStepN              | 180.651 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:32.616879  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=859
W20240118 23:22:32.957315  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:22:33.251770  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=308, pq.top=308
E20240118 23:22:33.616029  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=268
W20240118 23:22:33.968501  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:22:34.251103  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=310, pq.top=310
E20240118 23:22:34.619469  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1477
W20240118 23:22:35.104698  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:22:35.251513  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
E20240118 23:22:35.620813  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=625
W20240118 23:22:36.251442  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240118 23:22:36.340198  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:22:36.620061  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1049
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.266 ms                  | 59.382 ms                 |
| Forward                   | 10.492 ms                 | 14.877 ms                 |
| Backward                  | 15.260 ms                 | 20.541 ms                 |
| Optimize                  | 5.325 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.640 ms                  | 56.486 ms                 |
| AfterBackward             | 53.803 ms                 | 95.025 ms                 |
| BlockToStepN              | 184.379 ms                | 392.937 ms                |
| OneStep                   | 293.007 ms                | 504.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:37.297819  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.548 ms                 | 18.938 ms                 |
| ProcessBack:UpdateCache   | 8.241 ms                  | 14.072 ms                 |
| ProcessBack:UpsertPq      | 28.872 ms                 | 59.422 ms                 |
| ProcessOneStep            | 53.714 ms                 | 94.969 ms                 |
| BlockToStepN              | 184.793 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:37.620012  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2190
W20240118 23:22:37.621068  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:22:38.297160  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=320, pq.top=320
E20240118 23:22:38.622743  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1000
W20240118 23:22:38.859725  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:22:39.297580  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=322, pq.top=322
E20240118 23:22:39.622010  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1141
W20240118 23:22:40.103360  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:22:40.297377  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
E20240118 23:22:40.622195  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=480
W20240118 23:22:41.297201  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240118 23:22:41.341712  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:22:41.623915  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=967
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.258 ms                  | 59.382 ms                 |
| Forward                   | 10.548 ms                 | 14.877 ms                 |
| Backward                  | 15.260 ms                 | 20.541 ms                 |
| Optimize                  | 5.308 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.722 ms                  | 56.486 ms                 |
| AfterBackward             | 53.537 ms                 | 95.025 ms                 |
| BlockToStepN              | 188.547 ms                | 392.937 ms                |
| OneStep                   | 295.134 ms                | 504.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:42.297704  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=330
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.538 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.191 ms                  | 13.650 ms                 |
| ProcessBack:UpsertPq      | 28.789 ms                 | 56.116 ms                 |
| ProcessOneStep            | 53.455 ms                 | 94.969 ms                 |
| BlockToStepN              | 188.965 ms                | 392.819 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:42.609951  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:22:42.627595  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3074
W20240118 23:22:43.297202  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=332
E20240118 23:22:43.627008  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=955
W20240118 23:22:43.632448  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:22:44.297648  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=334, pq.top=334
E20240118 23:22:44.627838  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1315
W20240118 23:22:44.801105  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:22:45.297025  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=336, pq.top=336
E20240118 23:22:45.636332  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=806
W20240118 23:22:45.818957  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:22:46.347242  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240118 23:22:46.636811  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2945
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.257 ms                  | 59.382 ms                 |
| Forward                   | 10.550 ms                 | 14.877 ms                 |
| Backward                  | 15.269 ms                 | 20.553 ms                 |
| Optimize                  | 5.306 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.627 ms                  | 56.486 ms                 |
| AfterBackward             | 53.471 ms                 | 95.025 ms                 |
| BlockToStepN              | 190.040 ms                | 422.605 ms                |
| OneStep                   | 301.615 ms                | 513.939 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:47.139739  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:22:47.347112  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.504 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.214 ms                  | 13.650 ms                 |
| ProcessBack:UpsertPq      | 28.723 ms                 | 56.116 ms                 |
| ProcessOneStep            | 53.455 ms                 | 94.969 ms                 |
| BlockToStepN              | 189.922 ms                | 422.457 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:22:47.639788  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3045
W20240118 23:22:48.139552  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:22:48.347117  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240118 23:22:48.643765  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240118 23:22:49.148366  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:22:49.347117  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=345
E20240118 23:22:49.649386  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=352
W20240118 23:22:50.347790  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240118 23:22:50.362735  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:22:50.653019  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1337
W20240118 23:22:51.347395  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=350, pq.top=350
E20240118 23:22:51.658201  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1705
W20240118 23:22:51.677522  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.266 ms                  | 59.382 ms                 |
| Forward                   | 10.548 ms                 | 14.877 ms                 |
| Backward                  | 15.269 ms                 | 20.553 ms                 |
| Optimize                  | 5.306 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.537 ms                  | 56.486 ms                 |
| AfterBackward             | 53.629 ms                 | 95.025 ms                 |
| BlockToStepN              | 192.733 ms                | 422.605 ms                |
| OneStep                   | 303.884 ms                | 522.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.214 ms                  | 13.650 ms                 |
| ProcessBack:UpsertPq      | 28.848 ms                 | 56.116 ms                 |
| ProcessOneStep            | 53.500 ms                 | 92.488 ms                 |
| BlockToStepN              | 192.622 ms                | 416.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:52.434530  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240118 23:22:52.658743  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1581
W20240118 23:22:52.854763  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240118 23:22:53.454722  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240118 23:22:53.658586  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1086
W20240118 23:22:53.866333  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:22:54.454726  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240118 23:22:54.658017  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1531
W20240118 23:22:54.870263  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:22:55.454021  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240118 23:22:55.660507  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3164
W20240118 23:22:56.094511  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:22:56.454257  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240118 23:22:56.660009  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.271 ms                  | 57.689 ms                 |
| Forward                   | 10.523 ms                 | 14.441 ms                 |
| Backward                  | 15.276 ms                 | 20.541 ms                 |
| Optimize                  | 5.292 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.532 ms                  | 54.421 ms                 |
| AfterBackward             | 53.254 ms                 | 92.536 ms                 |
| BlockToStepN              | 195.281 ms                | 421.221 ms                |
| OneStep                   | 305.912 ms                | 514.311 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:57.112445  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.164 ms                  | 13.650 ms                 |
| ProcessBack:UpsertPq      | 28.789 ms                 | 56.116 ms                 |
| ProcessOneStep            | 53.214 ms                 | 92.488 ms                 |
| BlockToStepN              | 195.154 ms                | 421.105 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:22:57.454418  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
E20240118 23:22:57.660068  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=509
W20240118 23:22:58.129585  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:22:58.533860  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240118 23:22:58.660116  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1011
W20240118 23:22:59.311210  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:22:59.533479  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=368, pq.top=368
E20240118 23:22:59.665414  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1450
W20240118 23:23:00.315109  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:23:00.534140  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=370, pq.top=370
E20240118 23:23:00.665009  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=4469
W20240118 23:23:01.534391  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240118 23:23:01.554862  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:23:01.665009  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=4126
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.271 ms                  | 57.689 ms                 |
| Forward                   | 10.525 ms                 | 14.441 ms                 |
| Backward                  | 15.269 ms                 | 20.541 ms                 |
| Optimize                  | 5.291 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.509 ms                  | 54.421 ms                 |
| AfterBackward             | 53.101 ms                 | 92.536 ms                 |
| BlockToStepN              | 198.112 ms                | 422.605 ms                |
| OneStep                   | 307.753 ms                | 522.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.129 ms                  | 13.650 ms                 |
| ProcessBack:UpsertPq      | 28.723 ms                 | 56.116 ms                 |
| ProcessOneStep            | 53.019 ms                 | 92.488 ms                 |
| BlockToStepN              | 198.274 ms                | 422.457 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:02.534179  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240118 23:23:02.566373  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:23:02.665653  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=836
W20240118 23:23:03.534539  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=377
E20240118 23:23:03.665053  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1468
W20240118 23:23:03.697010  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:23:04.534664  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240118 23:23:04.669802  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240118 23:23:04.704458  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:23:05.534314  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240118 23:23:05.669009  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=4454
W20240118 23:23:05.714483  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:23:06.534809  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=383
E20240118 23:23:06.670640  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3088
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.273 ms                  | 57.689 ms                 |
| Forward                   | 10.525 ms                 | 14.441 ms                 |
| Backward                  | 15.266 ms                 | 20.541 ms                 |
| Optimize                  | 5.286 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.508 ms                  | 54.421 ms                 |
| AfterBackward             | 52.892 ms                 | 92.536 ms                 |
| BlockToStepN              | 203.338 ms                | 442.321 ms                |
| OneStep                   | 311.619 ms                | 538.938 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:06.735358  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.104 ms                  | 13.599 ms                 |
| ProcessBack:UpsertPq      | 28.723 ms                 | 55.245 ms                 |
| ProcessOneStep            | 52.817 ms                 | 92.488 ms                 |
| BlockToStepN              | 203.210 ms                | 442.162 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:07.534885  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240118 23:23:07.688164  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3471
W20240118 23:23:07.756937  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:23:08.650220  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=388, pq.top=388
E20240118 23:23:08.697153  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=535
W20240118 23:23:08.913069  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240118 23:23:09.650636  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=390, pq.top=390
E20240118 23:23:09.698222  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=597
W20240118 23:23:10.065652  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:23:10.698011  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=4290
W20240118 23:23:10.729015  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
W20240118 23:23:11.077849  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.279 ms                  | 57.689 ms                 |
| Forward                   | 10.492 ms                 | 14.441 ms                 |
| Backward                  | 15.269 ms                 | 20.541 ms                 |
| Optimize                  | 5.269 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.508 ms                  | 54.421 ms                 |
| AfterBackward             | 52.723 ms                 | 92.536 ms                 |
| BlockToStepN              | 207.170 ms                | 478.986 ms                |
| OneStep                   | 314.991 ms                | 577.635 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:11.699492  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=809
W20240118 23:23:11.729579  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240118 23:23:12.086102  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.068 ms                  | 13.599 ms                 |
| ProcessBack:UpsertPq      | 28.669 ms                 | 55.245 ms                 |
| ProcessOneStep            | 52.671 ms                 | 92.488 ms                 |
| BlockToStepN              | 207.082 ms                | 478.831 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:12.702703  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1173
W20240118 23:23:12.729254  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240118 23:23:13.089056  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:23:13.709575  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=923
W20240118 23:23:13.729930  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=398, pq.top=398
W20240118 23:23:14.095933  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:23:14.712026  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=750
W20240118 23:23:14.729164  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 6] 400 steps, total: 44.632, sample: 0.722, forward: 0.825, backward: 1.524, update: 0.511
[proc 5] 400 steps, total: 44.632, sample: 0.709, forward: 0.788, backward: 1.527, update: 0.521
[proc 1] 400 steps, total: 44.632, sample: 0.631, forward: 0.800, backward: 1.498, update: 0.549
[proc 4] 400 steps, total: 44.632, sample: 0.716, forward: 0.806, backward: 1.546, update: 0.498
[proc 2] 400 steps, total: 44.632, sample: 0.648, forward: 0.815, backward: 1.501, update: 0.509
[proc 7] 400 steps, total: 44.632, sample: 0.801, forward: 0.795, backward: 1.514, update: 0.523
[proc 0] 400 steps, total: 44.632, sample: 0.801, forward: 0.773, backward: 1.554, update: 0.529
[proc 3] 400 steps, total: 44.632, sample: 0.701, forward: 0.848, backward: 1.477, update: 0.549
W20240118 23:23:15.112798  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240118 23:23:15.729600  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=402, pq.top=402
E20240118 23:23:15.737274  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1132
W20240118 23:23:16.114822  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.291 ms                  | 57.689 ms                 |
| Forward                   | 10.489 ms                 | 14.441 ms                 |
| Backward                  | 15.260 ms                 | 20.541 ms                 |
| Optimize                  | 5.280 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.508 ms                  | 54.421 ms                 |
| AfterBackward             | 52.582 ms                 | 92.536 ms                 |
| BlockToStepN              | 208.419 ms                | 490.070 ms                |
| OneStep                   | 316.041 ms                | 587.172 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:16.730304  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=404, pq.top=404
E20240118 23:23:16.737040  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=804
W20240118 23:23:17.298015  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.496 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.055 ms                  | 13.599 ms                 |
| ProcessBack:UpsertPq      | 28.621 ms                 | 55.245 ms                 |
| ProcessOneStep            | 52.480 ms                 | 92.488 ms                 |
| BlockToStepN              | 208.367 ms                | 489.927 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:17.730276  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=406, pq.top=406
E20240118 23:23:17.750617  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1580
W20240118 23:23:18.321677  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:23:18.755270  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3265
W20240118 23:23:18.795974  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240118 23:23:19.343202  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:23:19.755038  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1680
W20240118 23:23:19.918602  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240118 23:23:20.357733  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:23:20.755741  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2192
W20240118 23:23:20.918954  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240118 23:23:21.373781  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.294 ms                  | 57.689 ms                 |
| Forward                   | 10.523 ms                 | 14.441 ms                 |
| Backward                  | 15.260 ms                 | 20.541 ms                 |
| Optimize                  | 5.285 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.508 ms                  | 54.421 ms                 |
| AfterBackward             | 52.454 ms                 | 92.536 ms                 |
| BlockToStepN              | 209.751 ms                | 491.088 ms                |
| OneStep                   | 318.197 ms                | 587.172 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:21.755012  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2688
W20240118 23:23:21.918309  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=415, pq.top=415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.468 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.055 ms                  | 13.599 ms                 |
| ProcessBack:UpsertPq      | 28.506 ms                 | 55.245 ms                 |
| ProcessOneStep            | 52.387 ms                 | 92.488 ms                 |
| BlockToStepN              | 209.630 ms                | 490.944 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:22.524192  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240118 23:23:22.755081  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=813
W20240118 23:23:22.918514  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240118 23:23:23.756489  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1507
W20240118 23:23:23.839463  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:23:23.952056  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=420, pq.top=420
E20240118 23:23:24.771298  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1738
W20240118 23:23:24.860381  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240118 23:23:24.952612  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=422, pq.top=422
E20240118 23:23:25.781208  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=599
W20240118 23:23:25.944288  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:23:26.025691  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=425, pq.top=425
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.296 ms                  | 57.689 ms                 |
| Forward                   | 10.529 ms                 | 14.441 ms                 |
| Backward                  | 15.261 ms                 | 20.541 ms                 |
| Optimize                  | 5.285 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.366 ms                  | 54.421 ms                 |
| AfterBackward             | 52.248 ms                 | 92.536 ms                 |
| BlockToStepN              | 213.016 ms                | 491.088 ms                |
| OneStep                   | 320.775 ms                | 587.172 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:26.783880  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1396
W20240118 23:23:26.960201  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240118 23:23:27.025678  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.375 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.054 ms                  | 13.409 ms                 |
| ProcessBack:UpsertPq      | 28.403 ms                 | 54.959 ms                 |
| ProcessOneStep            | 52.190 ms                 | 92.488 ms                 |
| BlockToStepN              | 213.323 ms                | 494.848 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:27.784353  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=2999
W20240118 23:23:28.025101  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240118 23:23:28.227702  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:23:28.784014  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3210
W20240118 23:23:29.025826  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240118 23:23:29.344173  9039 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240118 23:23:29.784019  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1622
W20240118 23:23:30.025669  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240118 23:23:30.348345  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:23:30.797111  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1379
W20240118 23:23:31.025751  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240118 23:23:31.359194  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.299 ms                  | 57.689 ms                 |
| Forward                   | 10.529 ms                 | 14.441 ms                 |
| Backward                  | 15.261 ms                 | 20.541 ms                 |
| Optimize                  | 5.286 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.260 ms                  | 54.421 ms                 |
| AfterBackward             | 52.157 ms                 | 92.536 ms                 |
| BlockToStepN              | 216.745 ms                | 494.980 ms                |
| OneStep                   | 325.932 ms                | 602.055 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:31.797009  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=2561
W20240118 23:23:32.025832  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240118 23:23:32.366451  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.375 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.042 ms                  | 13.409 ms                 |
| ProcessBack:UpsertPq      | 28.362 ms                 | 54.959 ms                 |
| ProcessOneStep            | 52.070 ms                 | 92.488 ms                 |
| BlockToStepN              | 216.779 ms                | 494.848 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:32.809159  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=776
W20240118 23:23:33.025816  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240118 23:23:33.430590  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:23:33.810747  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1000
W20240118 23:23:34.025388  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240118 23:23:34.456426  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:23:34.810046  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1027
W20240118 23:23:35.044790  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240118 23:23:35.467433  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:23:35.820155  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1921
W20240118 23:23:36.044579  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=446
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.296 ms                  | 57.689 ms                 |
| Forward                   | 10.509 ms                 | 14.441 ms                 |
| Backward                  | 15.260 ms                 | 20.541 ms                 |
| Optimize                  | 5.288 ms                  | 11.540 ms                 |
| BarrierTimeBeforeRank0    | 4.260 ms                  | 54.421 ms                 |
| AfterBackward             | 52.037 ms                 | 92.536 ms                 |
| BlockToStepN              | 219.171 ms                | 495.784 ms                |
| OneStep                   | 329.982 ms                | 618.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:36.773707  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:23:36.840340  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3209
W20240118 23:23:37.045118  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=448, pq.top=448
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.344 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.054 ms                  | 13.409 ms                 |
| ProcessBack:UpsertPq      | 28.193 ms                 | 54.959 ms                 |
| ProcessOneStep            | 51.970 ms                 | 92.488 ms                 |
| BlockToStepN              | 220.221 ms                | 496.726 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:37.840029  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1109
W20240118 23:23:38.045581  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240118 23:23:38.140096  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:23:38.844543  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1210
W20240118 23:23:39.059038  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240118 23:23:39.377197  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:23:39.853073  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1621
W20240118 23:23:40.059916  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=454
W20240118 23:23:40.385342  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:23:40.855397  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3128
W20240118 23:23:41.059803  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=456
W20240118 23:23:41.555642  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.296 ms                  | 56.411 ms                 |
| Forward                   | 10.509 ms                 | 13.931 ms                 |
| Backward                  | 15.258 ms                 | 20.340 ms                 |
| Optimize                  | 5.289 ms                  | 10.466 ms                 |
| BarrierTimeBeforeRank0    | 4.508 ms                  | 52.729 ms                 |
| AfterBackward             | 51.832 ms                 | 89.448 ms                 |
| BlockToStepN              | 222.365 ms                | 513.211 ms                |
| OneStep                   | 331.750 ms                | 626.909 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:41.856276  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=942
W20240118 23:23:42.121909  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.242 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.054 ms                  | 13.409 ms                 |
| ProcessBack:UpsertPq      | 28.106 ms                 | 54.959 ms                 |
| ProcessOneStep            | 51.776 ms                 | 89.411 ms                 |
| BlockToStepN              | 223.366 ms                | 513.077 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:42.575354  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:23:42.869241  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1010
W20240118 23:23:43.121752  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240118 23:23:43.589690  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:23:43.869098  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1326
W20240118 23:23:44.194347  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240118 23:23:44.591616  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:23:44.872344  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1283
W20240118 23:23:45.194857  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240118 23:23:45.875334  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1713
W20240118 23:23:45.914608  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240118 23:23:46.194702  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.296 ms                  | 56.411 ms                 |
| Forward                   | 10.504 ms                 | 13.931 ms                 |
| Backward                  | 15.258 ms                 | 20.340 ms                 |
| Optimize                  | 5.286 ms                  | 10.466 ms                 |
| BarrierTimeBeforeRank0    | 4.366 ms                  | 52.729 ms                 |
| AfterBackward             | 51.707 ms                 | 89.448 ms                 |
| BlockToStepN              | 229.190 ms                | 513.211 ms                |
| OneStep                   | 333.459 ms                | 626.909 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:46.897763  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1380
W20240118 23:23:47.020401  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240118 23:23:47.194952  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.212 ms                 | 18.562 ms                 |
| ProcessBack:UpdateCache   | 8.060 ms                  | 13.409 ms                 |
| ProcessBack:UpsertPq      | 27.958 ms                 | 54.959 ms                 |
| ProcessOneStep            | 51.628 ms                 | 89.411 ms                 |
| BlockToStepN              | 229.331 ms                | 523.576 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:47.920580  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1396
W20240118 23:23:48.022131  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240118 23:23:48.195241  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=470, pq.top=470
E20240118 23:23:48.920007  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3085
W20240118 23:23:49.195348  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=472, pq.top=472
W20240118 23:23:49.369374  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240118 23:23:49.921370  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=3033
W20240118 23:23:50.195030  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240118 23:23:50.380404  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240118 23:23:50.921064  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=4181
W20240118 23:23:51.195339  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=476, pq.top=476
W20240118 23:23:51.398567  9039 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.298 ms                  | 56.411 ms                 |
| Forward                   | 10.504 ms                 | 14.441 ms                 |
| Backward                  | 15.252 ms                 | 20.340 ms                 |
| Optimize                  | 5.285 ms                  | 10.466 ms                 |
| BarrierTimeBeforeRank0    | 4.388 ms                  | 52.729 ms                 |
| AfterBackward             | 51.676 ms                 | 89.448 ms                 |
| BlockToStepN              | 234.551 ms                | 523.817 ms                |
| OneStep                   | 337.386 ms                | 630.503 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:23:51.921010  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=3292
W20240118 23:23:52.196069  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=478, pq.top=478
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.207 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.065 ms                  | 13.385 ms                 |
| ProcessBack:UpsertPq      | 27.925 ms                 | 54.811 ms                 |
| ProcessOneStep            | 51.548 ms                 | 89.411 ms                 |
| BlockToStepN              | 235.585 ms                | 523.576 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:52.406244  9039 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240118 23:23:52.921010  8498 parallel_pq_v2.h:76] insert failed, size(hashtable)=317
W20240118 23:23:53.196295  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240118 23:23:53.416371  9039 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240118 23:23:53.921090  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=500
W20240118 23:23:54.197209  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
W20240118 23:23:54.770007  9039 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240118 23:23:54.921015  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=325
W20240118 23:23:55.197108  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240118 23:23:55.779047  9039 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240118 23:23:55.923250  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=278
W20240118 23:23:56.197038  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.299 ms                  | 56.411 ms                 |
| Forward                   | 10.509 ms                 | 14.441 ms                 |
| Backward                  | 15.255 ms                 | 20.340 ms                 |
| Optimize                  | 5.286 ms                  | 10.466 ms                 |
| BarrierTimeBeforeRank0    | 4.366 ms                  | 52.729 ms                 |
| AfterBackward             | 51.519 ms                 | 89.448 ms                 |
| BlockToStepN              | 237.981 ms                | 523.817 ms                |
| OneStep                   | 340.420 ms                | 630.503 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:56.785848  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240118 23:23:56.923126  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=756
W20240118 23:23:57.197901  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.188 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.065 ms                  | 13.599 ms                 |
| ProcessBack:UpsertPq      | 27.810 ms                 | 54.959 ms                 |
| ProcessOneStep            | 51.477 ms                 | 89.411 ms                 |
| BlockToStepN              | 237.878 ms                | 523.576 ms                |
+---------------------------+---------------------------+---------------------------+
W20240118 23:23:57.801702  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240118 23:23:57.923995  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=731
W20240118 23:23:58.267421  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240118 23:23:58.923034  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=780
W20240118 23:23:59.140894  9039 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240118 23:23:59.267393  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
E20240118 23:23:59.927006  9038 parallel_pq_v2.h:76] insert failed, size(hashtable)=1750
W20240118 23:24:00.140607  9039 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240118 23:24:00.268115  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240118 23:24:00.926010  8190 parallel_pq_v2.h:76] insert failed, size(hashtable)=3818
W20240118 23:24:01.268088  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240118 23:24:01.380271  9039 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.303 ms                  | 56.411 ms                 |
| Forward                   | 10.504 ms                 | 14.541 ms                 |
| Backward                  | 15.252 ms                 | 20.340 ms                 |
| Optimize                  | 5.276 ms                  | 10.466 ms                 |
| BarrierTimeBeforeRank0    | 4.366 ms                  | 52.729 ms                 |
| AfterBackward             | 51.519 ms                 | 89.448 ms                 |
| BlockToStepN              | 239.522 ms                | 523.817 ms                |
| OneStep                   | 348.376 ms                | 630.503 ms                |
+---------------------------+---------------------------+---------------------------+
E20240118 23:24:01.926898  9039 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240118 23:24:02.269495  8190 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
W20240118 23:24:02.386359  9039 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.207 ms                 | 18.536 ms                 |
| ProcessBack:UpdateCache   | 8.077 ms                  | 14.407 ms                 |
| ProcessBack:UpsertPq      | 27.908 ms                 | 55.169 ms                 |
| ProcessOneStep            | 51.482 ms                 | 89.411 ms                 |
| BlockToStepN              | 240.284 ms                | 523.576 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 47.823, sample: 0.771, forward: 0.823, backward: 1.477, update: 0.522
[proc 7] 500 steps, total: 47.823, sample: 0.730, forward: 0.789, backward: 1.538, update: 0.523
[proc 0] 500 steps, total: 47.823, sample: 0.890, forward: 0.798, backward: 1.526, update: 0.557
[proc 1] 500 steps, total: 47.823, sample: 0.711, forward: 0.762, backward: 1.488, update: 0.518
[proc 5] 500 steps, total: 47.823, sample: 0.745, forward: 0.780, backward: 1.529, update: 0.515
[proc 4] 500 steps, total: 47.823, sample: 0.745, forward: 0.791, backward: 1.543, update: 0.505
[proc 6] 500 steps, total: 47.823, sample: 0.754, forward: 0.814, backward: 1.501, update: 0.509
[proc 2] 500 steps, total: 47.823, sample: 0.702, forward: 0.794, backward: 1.487, update: 0.489
Successfully xmh. training takes 179.26527762413025 seconds
before call kg_cache_controller.StopThreads()
W20240118 23:24:02.829201  8190 grad_async_v2.h:71] call StopThreads. PID = 7504
W20240118 23:24:02.829233  8190 grad_base.h:210] before processOneStepNegThread_.join();
W20240118 23:24:02.829546  8190 grad_base.h:212] after processOneStepNegThread_.join();
W20240118 23:24:02.829560  8190 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240118 23:24:02.841013  8190 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f0ad6c40cd0>
