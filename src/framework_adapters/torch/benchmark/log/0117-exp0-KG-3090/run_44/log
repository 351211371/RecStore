WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 11:08:59.855978 35139 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_94', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [35139 sampler.py:454] Start PreSampling
WARNING [35139 sampler.py:532] Before construct renumbering_dict
WARNING [35139 sampler.py:555] PreSampling done
W20240124 11:09:02.989441 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 11:09:02.989737 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 11:09:02.989791 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 11:09:02.989832 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 11:09:02.989864 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 11:09:02.989892 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 11:09:02.989924 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 11:09:02.989965 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 11:09:02.990002 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 11:09:02.990042 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 11:09:02.990092 35139 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 11:09:02.990130 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 11:09:02.990165 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 11:09:02.990334 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 11:09:02.990381 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 11:09:02.990413 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 11:09:02.990442 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 11:09:02.990485 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 11:09:02.990518 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 11:09:02.990556 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 11:09:02.990582 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 11:09:02.990623 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 11:09:02.990650 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 11:09:02.990676 35139 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 11:09:02.990697 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 11:09:02.990716 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 11:09:02.990809 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 11:09:02.990852 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 11:09:02.990876 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 11:09:02.990906 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 11:09:02.990953 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 11:09:02.990983 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 11:09:02.991014 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 11:09:02.991035 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 11:09:02.991061 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 11:09:02.991092 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 11:09:02.991118 35139 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 11:09:02.991137 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 11:09:02.991158 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 11:09:02.991207 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 11:09:02.991245 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 11:09:02.991276 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 11:09:02.991302 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 11:09:02.991335 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 11:09:02.991364 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 11:09:02.991396 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 11:09:02.991418 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 11:09:02.991453 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 11:09:02.991482 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 11:09:02.991508 35139 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 11:09:02.991528 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 11:09:02.991552 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 11:09:02.991612 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 11:09:02.991657 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 11:09:02.991681 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 11:09:02.991709 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 11:09:02.991731 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 11:09:02.991762 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 11:09:02.991788 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 11:09:02.991813 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 11:09:02.991845 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 11:09:02.991883 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 11:09:02.991916 35139 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 11:09:02.991940 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 11:09:02.991962 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 11:09:02.992026 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 11:09:02.992054 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 11:09:02.992089 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 11:09:02.992117 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 11:09:02.992141 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 11:09:02.992172 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 11:09:02.992202 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 11:09:02.992233 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 11:09:02.992259 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 11:09:02.992290 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 11:09:02.992323 35139 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 11:09:02.992345 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 11:09:02.992367 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 11:09:02.992419 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 11:09:02.992447 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 11:09:02.992471 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 11:09:02.992497 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 11:09:02.992529 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 11:09:02.992566 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 11:09:02.992590 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 11:09:02.992620 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 11:09:02.992643 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 11:09:02.992678 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 11:09:02.992705 35139 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 11:09:02.992731 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 11:09:02.992758 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 11:09:02.992821 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 11:09:02.992862 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 11:09:02.992887 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 11:09:02.992911 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 11:09:02.992944 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 11:09:02.992971 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 11:09:02.992998 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 11:09:02.993026 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 11:09:02.993052 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 11:09:02.993074 35139 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 11:09:02.993098 35139 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 11:09:02.993117 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 11:09:02.993144 35139 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 11:09:03.207731 35139 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100003dc2000 22.81 MB
W20240124 11:09:03.207921 35139 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1494,  1950,  2552,  ..., 10386, 10456,  6864]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.389 seconds
[Rank1] pid = 35685
[Rank2] pid = 35749
[Rank3] pid = 35813
[Rank4] pid = 35877
[Rank5] pid = 35942
[Rank6] pid = 35945
INFO [35139 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [35685 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [35749 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [35813 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [35877 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [35942 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [36071 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [35945 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [35945 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36071 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35139 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35749 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35877 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35813 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35942 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35685 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [36071 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35685 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35877 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35749 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35813 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35139 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35945 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35942 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 11:09:06.695552 36072 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695685 35814 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695756 35686 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695825 36008 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695876 35943 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695925 35750 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.695974 36135 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:06.696020 35878 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 11:09:07.516036 35750 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 11:09:07.516089 36072 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.516356 36008 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.517971 36135 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.518005 35878 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.520237 35814 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.520956 35686 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 11:09:07.522437 35943 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.655 ms                  | 16.172 ms                 |
| bucket keys               | 1.872 ms                  | 158.832 ms                |
| forward: a2a keys         | 5.901 ms                  | 1.455 s                   |
| forward: search cache     | 336.726 us                | 21.650 ms                 |
| forward: a2a values       | 5.684 ms                  | 23.335 ms                 |
| forward: join             | 1.134 ms                  | 1.672 ms                  |
| Forward                   | 35.580 ms                 | 2.174 s                   |
| back: aggr dram keys      | 31.016 ms                 | 983.368 ms                |
| back: set dram grad       | 1.432 ms                  | 3.814 ms                  |
| back: a2a grad            | 7.776 ms                  | 14.042 ms                 |
| back: grad sum & grad cache  | 6.672 ms                  | 11.902 ms                 |
| Backward                  | 91.405 ms                 | 1.196 s                   |
| Optimize                  | 10.343 ms                 | 14.841 ms                 |
| BarrierTimeBeforeRank0    | 63.604 us                 | 151.686 us                |
| BlockToStepN              | 17.860 us                 | 27.470 us                 |
| OneStep                   | 143.793 ms                | 3.386 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.184 ms                  | 24.066 ms                 |
| bucket keys               | 1.872 ms                  | 8.434 ms                  |
| forward: a2a keys         | 3.279 ms                  | 12.624 ms                 |
| forward: search cache     | 357.511 us                | 3.836 ms                  |
| forward: a2a values       | 5.425 ms                  | 9.434 ms                  |
| forward: join             | 1.127 ms                  | 3.000 ms                  |
| Forward                   | 34.203 ms                 | 2.174 s                   |
| back: aggr dram keys      | 29.162 ms                 | 46.309 ms                 |
| back: set dram grad       | 1.362 ms                  | 2.672 ms                  |
| back: a2a grad            | 7.924 ms                  | 15.182 ms                 |
| back: grad sum & grad cache  | 6.863 ms                  | 11.342 ms                 |
| Backward                  | 91.376 ms                 | 1.196 s                   |
| Optimize                  | 10.276 ms                 | 20.709 ms                 |
| BarrierTimeBeforeRank0    | 71.194 us                 | 151.686 us                |
| BlockToStepN              | 24.977 us                 | 892.559 us                |
| OneStep                   | 143.793 ms                | 3.386 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.260 ms                  | 21.754 ms                 |
| bucket keys               | 1.910 ms                  | 7.247 ms                  |
| forward: a2a keys         | 2.917 ms                  | 10.163 ms                 |
| forward: search cache     | 380.265 us                | 2.987 ms                  |
| forward: a2a values       | 5.378 ms                  | 9.434 ms                  |
| forward: join             | 1.107 ms                  | 2.812 ms                  |
| Forward                   | 32.001 ms                 | 47.282 ms                 |
| back: aggr dram keys      | 29.250 ms                 | 40.598 ms                 |
| back: set dram grad       | 1.362 ms                  | 3.814 ms                  |
| back: a2a grad            | 7.748 ms                  | 14.042 ms                 |
| back: grad sum & grad cache  | 7.082 ms                  | 11.902 ms                 |
| Backward                  | 90.463 ms                 | 121.082 ms                |
| Optimize                  | 10.379 ms                 | 18.639 ms                 |
| BarrierTimeBeforeRank0    | 69.739 us                 | 175.152 us                |
| BlockToStepN              | 25.280 us                 | 892.559 us                |
| OneStep                   | 140.032 ms                | 163.898 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 17.382, sample: 0.321, forward: 5.452, backward: 9.892, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 17.377, sample: 0.308, forward: 5.474, backward: 9.905, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 17.384, sample: 0.318, forward: 5.461, backward: 9.916, update: 0.264
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 17.383, sample: 0.281, forward: 5.489, backward: 9.870, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.380, sample: 0.346, forward: 5.451, backward: 9.890, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 17.382, sample: 0.332, forward: 5.463, backward: 9.858, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.379, sample: 0.325, forward: 5.459, backward: 9.907, update: 0.285
[Rank7] pid = 36071
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
train_sampler.Prefill()
-------Step 0-------
tensor([  105,   154,  5615,   119,  9896, 11307,  1730,  6487, 13344,  9525]) tensor([ 2552, 13396,  6883, 14229,    75,  1716,  1235,  6205,  1033, 14693])
-------Step 1-------
tensor([  105,   154,  5615,   119,  9896, 11307,  1730,  6487, 13344,  9525]) tensor([  935,   223, 14899,  2367,  1787, 11744, 11774,  8174,  4792, 13488])
-------Step 2-------
tensor([8785, 8967, 4852, 4972,  169, 9755, 8452, 7944, 9571, 1660]) tensor([ 4716,  6030,  4916, 10038,   302, 10165, 11011, 10753, 11069,  8051])
-------Step 3-------
tensor([8785, 8967, 4852, 4972,  169, 9755, 8452, 7944, 9571, 1660]) tensor([ 7131,  7999,  7057,  9761,  5929,  1425,   565,  3019, 10328,  2475])
-------Step 4-------
tensor([  154, 13095, 14118,  4858,  7265,  4352,    36,  6063,   148,  1795]) tensor([1217, 1944,  585, 3269, 4043, 2900, 6487, 7989, 7093, 2243])
-------Step 5-------
tensor([  154, 13095, 14118,  4858,  7265,  4352,    36,  6063,   148,  1795]) tensor([14487,  7675,   527,  2220,  4215,  1531,  1543,  2069,  5323,  5583])
-------Step 6-------
tensor([ 2554,  9670,    57,    76,  9970,  3887,  7012,  9378, 14157,   130]) tensor([ 8967,  3922, 11571,  7207,  8287,  7690,  6555,  7125,  8384, 12863])
-------Step 7-------
tensor([ 2554,  9670,    57,    76,  9970,  3887,  7012,  9378, 14157,   130]) tensor([10639,   777,  5496,  7894,  1960,  1413,  6059,  4757, 12382,  1438])
-------Step 8-------
tensor([ 4607,  8699,  7915, 10376,    67,    73, 10770, 13267,    10,  2964]) tensor([ 5224,  6779,  4279,  6382,  3668, 13973,  7875,  2010, 11351,  4226])
-------Step 9-------
tensor([ 4607,  8699,  7915, 10376,    67,    73, 10770, 13267,    10,  2964]) tensor([10007,  3770, 10671, 12221, 12246,   794, 14446,  8174,  1466, 10706])
before start barrier
start train
[proc 0] 100 steps, total: 17.384, sample: 0.423, forward: 5.384, backward: 10.352, update: 1.077
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.184 ms                  | 21.754 ms                 |
| bucket keys               | 1.983 ms                  | 7.247 ms                  |
| forward: a2a keys         | 2.860 ms                  | 10.163 ms                 |
| forward: search cache     | 429.537 us                | 2.987 ms                  |
| forward: a2a values       | 5.266 ms                  | 11.162 ms                 |
| forward: join             | 1.152 ms                  | 2.812 ms                  |
| Forward                   | 31.315 ms                 | 47.282 ms                 |
| back: aggr dram keys      | 30.580 ms                 | 42.274 ms                 |
| back: set dram grad       | 1.355 ms                  | 3.814 ms                  |
| back: a2a grad            | 7.695 ms                  | 15.182 ms                 |
| back: grad sum & grad cache  | 7.058 ms                  | 13.410 ms                 |
| Backward                  | 90.463 ms                 | 121.082 ms                |
| Optimize                  | 10.343 ms                 | 18.639 ms                 |
| BarrierTimeBeforeRank0    | 71.515 us                 | 175.152 us                |
| BlockToStepN              | 26.801 us                 | 892.559 us                |
| OneStep                   | 137.962 ms                | 171.516 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.148 ms                  | 24.066 ms                 |
| bucket keys               | 1.947 ms                  | 4.470 ms                  |
| forward: a2a keys         | 2.829 ms                  | 12.624 ms                 |
| forward: search cache     | 423.224 us                | 861.969 us                |
| forward: a2a values       | 5.242 ms                  | 9.462 ms                  |
| forward: join             | 1.138 ms                  | 2.720 ms                  |
| Forward                   | 31.178 ms                 | 55.208 ms                 |
| back: aggr dram keys      | 31.016 ms                 | 40.598 ms                 |
| back: set dram grad       | 1.340 ms                  | 3.328 ms                  |
| back: a2a grad            | 7.490 ms                  | 14.645 ms                 |
| back: grad sum & grad cache  | 7.082 ms                  | 13.436 ms                 |
| Backward                  | 89.372 ms                 | 121.082 ms                |
| Optimize                  | 10.374 ms                 | 18.639 ms                 |
| BarrierTimeBeforeRank0    | 70.861 us                 | 175.152 us                |
| BlockToStepN              | 29.317 us                 | 892.559 us                |
| OneStep                   | 136.513 ms                | 171.516 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.076 ms                  | 21.796 ms                 |
| bucket keys               | 1.891 ms                  | 4.470 ms                  |
| forward: a2a keys         | 2.917 ms                  | 24.657 ms                 |
| forward: search cache     | 387.168 us                | 842.800 us                |
| forward: a2a values       | 5.090 ms                  | 9.462 ms                  |
| forward: join             | 1.113 ms                  | 2.720 ms                  |
| Forward                   | 31.290 ms                 | 55.208 ms                 |
| back: aggr dram keys      | 31.090 ms                 | 40.139 ms                 |
| back: set dram grad       | 1.329 ms                  | 2.936 ms                  |
| back: a2a grad            | 7.462 ms                  | 14.042 ms                 |
| back: grad sum & grad cache  | 6.863 ms                  | 13.436 ms                 |
| Backward                  | 89.317 ms                 | 118.952 ms                |
| Optimize                  | 10.332 ms                 | 17.302 ms                 |
| BarrierTimeBeforeRank0    | 68.775 us                 | 155.809 us                |
| BlockToStepN              | 30.182 us                 | 999.496 us                |
| OneStep                   | 136.720 ms                | 169.520 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 14.058, sample: 0.332, forward: 3.556, backward: 8.552, update: 0.303
[proc 4] 200 steps, total: 14.058, sample: 0.375, forward: 3.514, backward: 8.555, update: 0.292
[proc 1] 200 steps, total: 14.058, sample: 0.359, forward: 3.526, backward: 8.628, update: 0.288
[proc 7] 200 steps, total: 14.058, sample: 0.349, forward: 3.528, backward: 8.550, update: 0.279
[proc 2] 200 steps, total: 14.058, sample: 0.338, forward: 3.538, backward: 8.569, update: 0.286
[proc 5] 200 steps, total: 14.058, sample: 0.341, forward: 3.533, backward: 8.596, update: 0.287
[proc 6] 200 steps, total: 14.058, sample: 0.398, forward: 3.511, backward: 8.491, update: 0.302
[proc 0] 200 steps, total: 14.058, sample: 0.450, forward: 3.454, backward: 9.008, update: 1.005
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.094 ms                  | 24.119 ms                 |
| bucket keys               | 1.910 ms                  | 4.470 ms                  |
| forward: a2a keys         | 2.981 ms                  | 26.913 ms                 |
| forward: search cache     | 382.957 us                | 842.800 us                |
| forward: a2a values       | 5.129 ms                  | 9.462 ms                  |
| forward: join             | 1.113 ms                  | 2.720 ms                  |
| Forward                   | 32.026 ms                 | 57.624 ms                 |
| back: aggr dram keys      | 31.016 ms                 | 40.598 ms                 |
| back: set dram grad       | 1.325 ms                  | 3.328 ms                  |
| back: a2a grad            | 7.471 ms                  | 14.042 ms                 |
| back: grad sum & grad cache  | 6.776 ms                  | 13.436 ms                 |
| Backward                  | 89.586 ms                 | 118.952 ms                |
| Optimize                  | 10.328 ms                 | 18.639 ms                 |
| BarrierTimeBeforeRank0    | 68.609 us                 | 155.809 us                |
| BlockToStepN              | 31.599 us                 | 999.496 us                |
| OneStep                   | 138.127 ms                | 171.516 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.094 ms                  | 24.652 ms                 |
| bucket keys               | 2.175 ms                  | 4.470 ms                  |
| forward: a2a keys         | 2.975 ms                  | 25.930 ms                 |
| forward: search cache     | 395.836 us                | 861.969 us                |
| forward: a2a values       | 5.130 ms                  | 9.462 ms                  |
| forward: join             | 1.131 ms                  | 2.719 ms                  |
| Forward                   | 32.496 ms                 | 57.624 ms                 |
| back: aggr dram keys      | 31.090 ms                 | 40.139 ms                 |
| back: set dram grad       | 1.324 ms                  | 2.998 ms                  |
| back: a2a grad            | 7.449 ms                  | 13.517 ms                 |
| back: grad sum & grad cache  | 6.776 ms                  | 13.410 ms                 |
| Backward                  | 89.331 ms                 | 114.828 ms                |
| Optimize                  | 10.298 ms                 | 17.302 ms                 |
| BarrierTimeBeforeRank0    | 68.233 us                 | 152.715 us                |
| BlockToStepN              | 32.858 us                 | 892.559 us                |
| OneStep                   | 138.755 ms                | 170.054 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.061 ms                  | 24.652 ms                 |
| bucket keys               | 2.147 ms                  | 4.470 ms                  |
| forward: a2a keys         | 3.017 ms                  | 25.528 ms                 |
| forward: search cache     | 388.689 us                | 842.800 us                |
| forward: a2a values       | 5.093 ms                  | 9.462 ms                  |
| forward: join             | 1.122 ms                  | 2.566 ms                  |
| Forward                   | 32.672 ms                 | 57.624 ms                 |
| back: aggr dram keys      | 31.016 ms                 | 40.139 ms                 |
| back: set dram grad       | 1.321 ms                  | 2.936 ms                  |
| back: a2a grad            | 7.427 ms                  | 13.485 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 13.410 ms                 |
| Backward                  | 89.020 ms                 | 114.828 ms                |
| Optimize                  | 10.309 ms                 | 17.302 ms                 |
| BarrierTimeBeforeRank0    | 66.859 us                 | 152.715 us                |
| BlockToStepN              | 32.290 us                 | 892.559 us                |
| OneStep                   | 139.007 ms                | 170.054 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 14.271, sample: 0.266, forward: 3.908, backward: 8.470, update: 0.278
[proc 5] 300 steps, total: 14.271, sample: 0.284, forward: 3.888, backward: 8.456, update: 0.252
[proc 6] 300 steps, total: 14.271, sample: 0.344, forward: 3.850, backward: 8.401, update: 0.272
[proc 7] 300 steps, total: 14.271, sample: 0.340, forward: 3.838, backward: 8.446, update: 0.262
[proc 4] 300 steps, total: 14.271, sample: 0.379, forward: 3.817, backward: 8.424, update: 0.300
[proc 3] 300 steps, total: 14.271, sample: 0.375, forward: 3.816, backward: 8.425, update: 0.311
[proc 2] 300 steps, total: 14.271, sample: 0.318, forward: 3.864, backward: 8.481, update: 0.270
[proc 0] 300 steps, total: 14.271, sample: 0.442, forward: 3.788, backward: 8.869, update: 1.039
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.047 ms                  | 24.652 ms                 |
| bucket keys               | 1.971 ms                  | 4.470 ms                  |
| forward: a2a keys         | 3.038 ms                  | 25.528 ms                 |
| forward: search cache     | 383.471 us                | 842.800 us                |
| forward: a2a values       | 5.053 ms                  | 9.462 ms                  |
| forward: join             | 1.120 ms                  | 2.719 ms                  |
| Forward                   | 33.115 ms                 | 57.624 ms                 |
| back: aggr dram keys      | 30.800 ms                 | 40.139 ms                 |
| back: set dram grad       | 1.320 ms                  | 2.936 ms                  |
| back: a2a grad            | 7.394 ms                  | 13.485 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 13.410 ms                 |
| Backward                  | 88.926 ms                 | 114.828 ms                |
| Optimize                  | 10.227 ms                 | 17.302 ms                 |
| BarrierTimeBeforeRank0    | 66.437 us                 | 152.715 us                |
| BlockToStepN              | 32.641 us                 | 892.559 us                |
| OneStep                   | 139.573 ms                | 170.054 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.021 ms                  | 24.646 ms                 |
| bucket keys               | 1.909 ms                  | 4.377 ms                  |
| forward: a2a keys         | 3.078 ms                  | 25.528 ms                 |
| forward: search cache     | 374.376 us                | 842.800 us                |
| forward: a2a values       | 5.021 ms                  | 9.462 ms                  |
| forward: join             | 1.110 ms                  | 2.566 ms                  |
| Forward                   | 33.459 ms                 | 57.624 ms                 |
| back: aggr dram keys      | 31.016 ms                 | 39.735 ms                 |
| back: set dram grad       | 1.316 ms                  | 2.825 ms                  |
| back: a2a grad            | 7.405 ms                  | 13.425 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 13.121 ms                 |
| Backward                  | 88.615 ms                 | 114.275 ms                |
| Optimize                  | 10.158 ms                 | 17.174 ms                 |
| BarrierTimeBeforeRank0    | 65.774 us                 | 151.686 us                |
| BlockToStepN              | 32.641 us                 | 669.921 us                |
| OneStep                   | 139.328 ms                | 169.520 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.953 ms                  | 24.646 ms                 |
| bucket keys               | 1.869 ms                  | 4.199 ms                  |
| forward: a2a keys         | 3.146 ms                  | 26.913 ms                 |
| forward: search cache     | 359.863 us                | 836.910 us                |
| forward: a2a values       | 5.010 ms                  | 9.434 ms                  |
| forward: join             | 1.104 ms                  | 2.494 ms                  |
| Forward                   | 33.686 ms                 | 58.902 ms                 |
| back: aggr dram keys      | 31.016 ms                 | 39.601 ms                 |
| back: set dram grad       | 1.315 ms                  | 2.672 ms                  |
| back: a2a grad            | 7.394 ms                  | 13.414 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 13.022 ms                 |
| Backward                  | 88.556 ms                 | 114.275 ms                |
| Optimize                  | 10.057 ms                 | 17.174 ms                 |
| BarrierTimeBeforeRank0    | 64.381 us                 | 151.686 us                |
| BlockToStepN              | 32.867 us                 | 669.921 us                |
| OneStep                   | 139.573 ms                | 169.520 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 13.959, sample: 0.390, forward: 3.743, backward: 8.411, update: 0.292
[proc 5] 400 steps, total: 13.959, sample: 0.323, forward: 3.810, backward: 8.368, update: 0.242
[proc 4] 400 steps, total: 13.959, sample: 0.327, forward: 3.800, backward: 8.370, update: 0.254
[proc 1] 400 steps, total: 13.959, sample: 0.378, forward: 3.750, backward: 8.395, update: 0.294
[proc 7] 400 steps, total: 13.959, sample: 0.293, forward: 3.845, backward: 8.371, update: 0.247
[proc 0] 400 steps, total: 13.959, sample: 0.358, forward: 3.783, backward: 8.814, update: 0.883
[proc 3] 400 steps, total: 13.959, sample: 0.294, forward: 3.825, backward: 8.383, update: 0.249
[proc 6] 400 steps, total: 13.959, sample: 0.374, forward: 3.753, backward: 8.362, update: 0.286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.979 ms                  | 25.215 ms                 |
| bucket keys               | 1.902 ms                  | 4.199 ms                  |
| forward: a2a keys         | 3.196 ms                  | 26.461 ms                 |
| forward: search cache     | 362.480 us                | 833.772 us                |
| forward: a2a values       | 5.012 ms                  | 9.343 ms                  |
| forward: join             | 1.106 ms                  | 2.368 ms                  |
| Forward                   | 33.706 ms                 | 58.902 ms                 |
| back: aggr dram keys      | 31.058 ms                 | 39.735 ms                 |
| back: set dram grad       | 1.314 ms                  | 2.672 ms                  |
| back: a2a grad            | 7.370 ms                  | 13.022 ms                 |
| back: grad sum & grad cache  | 6.729 ms                  | 12.764 ms                 |
| Backward                  | 88.556 ms                 | 114.828 ms                |
| Optimize                  | 10.063 ms                 | 17.174 ms                 |
| BarrierTimeBeforeRank0    | 64.381 us                 | 151.686 us                |
| BlockToStepN              | 32.979 us                 | 892.559 us                |
| OneStep                   | 139.734 ms                | 171.516 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.979 ms                  | 24.652 ms                 |
| bucket keys               | 1.891 ms                  | 4.377 ms                  |
| forward: a2a keys         | 3.233 ms                  | 27.395 ms                 |
| forward: search cache     | 358.443 us                | 833.772 us                |
| forward: a2a values       | 5.014 ms                  | 9.343 ms                  |
| forward: join             | 1.103 ms                  | 2.368 ms                  |
| Forward                   | 33.974 ms                 | 59.690 ms                 |
| back: aggr dram keys      | 31.058 ms                 | 39.735 ms                 |
| back: set dram grad       | 1.313 ms                  | 2.672 ms                  |
| back: a2a grad            | 7.379 ms                  | 13.022 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 12.764 ms                 |
| Backward                  | 88.517 ms                 | 114.275 ms                |
| Optimize                  | 10.063 ms                 | 17.174 ms                 |
| BarrierTimeBeforeRank0    | 65.400 us                 | 144.514 us                |
| BlockToStepN              | 32.779 us                 | 669.921 us                |
| OneStep                   | 139.612 ms                | 171.244 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 14.180, sample: 0.274, forward: 3.785, backward: 8.517, update: 0.223
[proc 6] 500 steps, total: 14.180, sample: 0.330, forward: 3.723, backward: 8.500, update: 0.273
[proc 7] 500 steps, total: 14.180, sample: 0.413, forward: 3.677, backward: 8.481, update: 0.310
[proc 1] 500 steps, total: 14.180, sample: 0.317, forward: 3.737, backward: 8.527, update: 0.279
[proc 0] 500 steps, total: 14.180, sample: 0.436, forward: 3.644, backward: 8.921, update: 1.042
[proc 4] 500 steps, total: 14.180, sample: 0.372, forward: 3.721, backward: 8.479, update: 0.305
[proc 5] 500 steps, total: 14.180, sample: 0.310, forward: 3.764, backward: 8.511, update: 0.280
[proc 3] 500 steps, total: 14.181, sample: 0.384, forward: 3.700, backward: 8.474, update: 0.310
Successfully xmh. training takes 73.85400009155273 seconds
before call kg_cache_controller.StopThreads()
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
INFO [35139 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.953 ms                  | 24.652 ms                 |
| bucket keys               | 1.907 ms                  | 4.199 ms                  |
| forward: a2a keys         | 3.193 ms                  | 27.205 ms                 |
| forward: search cache     | 361.426 us                | 812.069 us                |
| forward: a2a values       | 5.005 ms                  | 9.285 ms                  |
| forward: join             | 1.103 ms                  | 2.070 ms                  |
| Forward                   | 33.706 ms                 | 59.690 ms                 |
| back: aggr dram keys      | 31.132 ms                 | 39.735 ms                 |
| back: set dram grad       | 1.312 ms                  | 2.607 ms                  |
| back: a2a grad            | 7.380 ms                  | 12.974 ms                 |
| back: grad sum & grad cache  | 6.743 ms                  | 12.341 ms                 |
| Backward                  | 88.455 ms                 | 114.275 ms                |
| Optimize                  | 10.037 ms                 | 17.174 ms                 |
| BarrierTimeBeforeRank0    | 64.488 us                 | 144.514 us                |
| BlockToStepN              | 32.718 us                 | 669.921 us                |
| OneStep                   | 139.475 ms                | 171.244 ms                |
+---------------------------+---------------------------+---------------------------+
