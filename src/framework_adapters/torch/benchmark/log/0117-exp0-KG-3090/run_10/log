WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240119 00:16:53.363502 54971 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_FB15k_0', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [54971 sampler.py:454] Start PreSampling
WARNING [54971 sampler.py:532] Before construct renumbering_dict
WARNING [54971 sampler.py:555] PreSampling done
W20240119 00:16:55.854351 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240119 00:16:55.854544 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240119 00:16:55.854578 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240119 00:16:55.854606 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240119 00:16:55.854631 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240119 00:16:55.854655 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240119 00:16:55.854681 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240119 00:16:55.854704 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240119 00:16:55.854727 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240119 00:16:55.854758 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240119 00:16:55.854799 54971 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240119 00:16:55.854820 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240119 00:16:55.854849 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240119 00:16:55.854972 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240119 00:16:55.855006 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240119 00:16:55.855032 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240119 00:16:55.855069 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240119 00:16:55.855091 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240119 00:16:55.855126 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240119 00:16:55.855161 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240119 00:16:55.855192 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240119 00:16:55.855226 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240119 00:16:55.855257 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240119 00:16:55.855279 54971 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240119 00:16:55.855297 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240119 00:16:55.855316 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240119 00:16:55.855368 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240119 00:16:55.855398 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240119 00:16:55.855430 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240119 00:16:55.855451 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240119 00:16:55.855479 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240119 00:16:55.855515 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240119 00:16:55.855537 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240119 00:16:55.855562 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240119 00:16:55.855587 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240119 00:16:55.855608 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240119 00:16:55.855633 54971 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240119 00:16:55.855649 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240119 00:16:55.855669 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240119 00:16:55.855712 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240119 00:16:55.855734 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240119 00:16:55.855757 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240119 00:16:55.855782 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240119 00:16:55.855803 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240119 00:16:55.855837 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240119 00:16:55.855862 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240119 00:16:55.855887 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240119 00:16:55.855914 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240119 00:16:55.855937 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240119 00:16:55.855957 54971 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240119 00:16:55.855976 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240119 00:16:55.855993 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240119 00:16:55.856038 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240119 00:16:55.856070 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240119 00:16:55.856091 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240119 00:16:55.856122 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240119 00:16:55.856149 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240119 00:16:55.856191 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240119 00:16:55.856218 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240119 00:16:55.856249 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240119 00:16:55.856272 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240119 00:16:55.856304 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240119 00:16:55.856325 54971 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240119 00:16:55.856344 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240119 00:16:55.856367 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240119 00:16:55.856415 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240119 00:16:55.856444 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240119 00:16:55.856470 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240119 00:16:55.856499 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240119 00:16:55.856528 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240119 00:16:55.856564 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240119 00:16:55.856591 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240119 00:16:55.856616 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240119 00:16:55.856637 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240119 00:16:55.856665 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240119 00:16:55.856685 54971 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240119 00:16:55.856704 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240119 00:16:55.856721 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240119 00:16:55.856766 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240119 00:16:55.856812 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240119 00:16:55.856846 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240119 00:16:55.856878 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240119 00:16:55.856906 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240119 00:16:55.856928 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240119 00:16:55.856956 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240119 00:16:55.856989 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240119 00:16:55.857024 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240119 00:16:55.857045 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240119 00:16:55.857071 54971 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240119 00:16:55.857091 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240119 00:16:55.857112 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240119 00:16:55.857162 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240119 00:16:55.857190 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240119 00:16:55.857213 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240119 00:16:55.857235 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240119 00:16:55.857256 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240119 00:16:55.857290 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240119 00:16:55.857321 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240119 00:16:55.857350 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240119 00:16:55.857380 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240119 00:16:55.857404 54971 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240119 00:16:55.857424 54971 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240119 00:16:55.857441 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240119 00:16:55.857458 54971 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240119 00:16:56.088682 54971 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240119 00:16:56.088863 54971 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([1500, 2044, 2790,  ..., 8878, 8246, 8308]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.761 seconds
[Rank1] pid = 55360
[Rank2] pid = 55424
[Rank3] pid = 55425
[Rank4] pid = 55553
[Rank5] pid = 55585
[Rank6] pid = 55681
INFO [54971 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [55360 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [55424 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [55585 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [55425 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [55553 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [55424 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [54971 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55585 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55681 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [55688 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [55425 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55688 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55681 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55553 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240119 00:16:59.460656 55689 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240119 00:16:59.461599 55426 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240119 00:16:59.461920 55618 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240119 00:16:59.462137 55484 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240119 00:16:59.462270 55718 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240119 00:16:59.462311 55723 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240119 00:16:59.462531 55554 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
INFO [55360 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240119 00:16:59.471766 55361 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240119 00:16:59.501312 55723 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x1000054ac000
W20240119 00:16:59.501442 55718 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x100005579000
W20240119 00:16:59.501479 55426 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x10000563e000
W20240119 00:16:59.501487 55484 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100005703000
W20240119 00:16:59.501499 55723 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x1000057c8000
W20240119 00:16:59.501567 55723 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 400]0x10000588d000
W20240119 00:16:59.501577 55689 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x10000f125000
W20240119 00:16:59.501606 55718 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x10000f2af000
W20240119 00:16:59.501598 55554 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x10000f1ea000
W20240119 00:16:59.501616 55723 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10000f374000
W20240119 00:16:59.501646 55426 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100018c0c000
W20240119 00:16:59.501657 55718 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 400]0x100018cd1000
W20240119 00:16:59.501668 55723 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240119 00:16:59.501691 55484 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x10002262e000
W20240119 00:16:59.501701 55689 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1000227b8000
W20240119 00:16:59.501691 55618 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x100022569000
W20240119 00:16:59.501716 55718 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10002287d000
W20240119 00:16:59.501701 55361 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1000226f3000
W20240119 00:16:59.501736 55426 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x10002c115000
W20240119 00:16:59.501760 55689 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x1000359ad000
W20240119 00:16:59.501754 55718 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240119 00:16:59.501775 55484 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x10003f245000
W20240119 00:16:59.501793 55554 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x100048add000
W20240119 00:16:59.501801 55689 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100048ba2000
W20240119 00:16:59.501816 55426 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10005243a000
W20240119 00:16:59.501835 55484 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10005bcd2000
W20240119 00:16:59.501858 55554 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 400]0x10006556a000
W20240119 00:16:59.501874 55426 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240119 00:16:59.501881 55484 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240119 00:16:59.501897 55554 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10006ee02000
W20240119 00:16:59.501889 55689 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240119 00:16:59.501910 55361 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x10007869a000
W20240119 00:16:59.501917 55618 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x10007875f000
W20240119 00:16:59.501943 55554 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240119 00:16:59.501992 55618 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 400]0x100078824000
W20240119 00:16:59.502010 55361 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x1000820bc000
W20240119 00:16:59.502058 55618 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10008b954000
W20240119 00:16:59.502076 55361 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1000951ec000
W20240119 00:16:59.502116 55618 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240119 00:16:59.502144 55361 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240119 00:16:59.504772 55723 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240119 00:16:59.504913 55718 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240119 00:16:59.504949 55689 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240119 00:16:59.505004 55484 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240119 00:16:59.505007 55426 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240119 00:16:59.505071 55554 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240119 00:16:59.505075 55361 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240119 00:16:59.505234 55618 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [55553 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [55681 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [55688 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
[Rank7] pid = 55688
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [55425 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [54971 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [55424 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [55360 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [55585 DistTensor.py:56] The tensor name already exists in the kvstore
I20240119 00:16:59.697551 55618 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697589 55361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697618 55723 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697647 55718 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697677 55484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697723 55554 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697755 55689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 00:16:59.697788 55426 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 00:16:59.698920 55689 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1
        }
W20240119 00:16:59.699031 55689 grad_base.h:172] Init GradProcessingBase done
I20240119 00:16:59.703444 55689 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240119 00:16:59.703562 55689 kg_controller.h:78] after init GradAsyncProcessingV2
I20240119 00:16:59.703568 55689 kg_controller.h:84] Construct KGCacheController done
I20240119 00:17:00.442834 55689 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240119 00:17:01.525388 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 00:17:01.525844 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240119 00:17:01.585278 55484 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240119 00:17:01.592989 55689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.603657 55426 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.608018 55718 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.608628 55554 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.614811 55361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.624150 55723 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 00:17:01.625571 55618 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240119 00:17:03.671222 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240119 00:17:03.745064 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=0
W20240119 00:17:03.755004 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 00:17:04.671617 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.066 ms                  | 6.396 ms                  |
| Forward                   | 7.974 ms                  | 456.018 ms                |
| Backward                  | 5.020 ms                  | 157.753 ms                |
| Optimize                  | 8.407 ms                  | 38.968 ms                 |
| BarrierTimeBeforeRank0    | 3.014 ms                  | 237.771 ms                |
| AfterBackward             | 64.777 ms                 | 1.226 s                   |
| BlockToStepN              | 10.280 ms                 | 211.203 ms                |
| OneStep                   | 213.308 ms                | 2.126 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:04.778268 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240119 00:17:04.892681 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.768 ms                 | 380.641 ms                |
| ProcessBack:UpdateCache   | 9.543 ms                  | 769.135 ms                |
| ProcessBack:UpsertPq      | 38.345 ms                 | 73.099 ms                 |
| ProcessOneStep            | 65.553 ms                 | 1.226 s                   |
| BlockToStepN              | 10.170 ms                 | 210.947 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:05.671008 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=808
W20240119 00:17:05.841076 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240119 00:17:05.892012 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=12
E20240119 00:17:06.671020 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=2388
W20240119 00:17:06.862275 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
W20240119 00:17:06.926594 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=18, pq.top=17
E20240119 00:17:07.671063 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1375
W20240119 00:17:07.987637 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=22
W20240119 00:17:08.005892 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240119 00:17:08.671025 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4862
W20240119 00:17:09.066332 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=28, pq.top=27
W20240119 00:17:09.150324 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
E20240119 00:17:09.671006 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=5231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.432 ms                  | 59.610 ms                 |
| Forward                   | 8.252 ms                  | 456.018 ms                |
| Backward                  | 4.986 ms                  | 157.753 ms                |
| Optimize                  | 5.452 ms                  | 38.968 ms                 |
| BarrierTimeBeforeRank0    | 6.829 ms                  | 237.771 ms                |
| AfterBackward             | 68.660 ms                 | 1.226 s                   |
| BlockToStepN              | 78.586 ms                 | 211.203 ms                |
| OneStep                   | 213.308 ms                | 2.126 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:10.242466 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.112 ms                 | 376.809 ms                |
| ProcessBack:UpdateCache   | 9.398 ms                  | 765.861 ms                |
| ProcessBack:UpsertPq      | 40.016 ms                 | 62.868 ms                 |
| ProcessOneStep            | 68.618 ms                 | 1.226 s                   |
| BlockToStepN              | 68.167 ms                 | 210.947 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:10.890580 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=415
W20240119 00:17:10.943713 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240119 00:17:11.257035 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 00:17:11.888023 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2413
W20240119 00:17:11.943051 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=40, pq.top=39
W20240119 00:17:12.307819 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
E20240119 00:17:12.888006 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=10964
W20240119 00:17:12.970238 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=44, pq.top=43
W20240119 00:17:13.331849 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
E20240119 00:17:13.888013 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=5903
W20240119 00:17:14.018537 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=50, pq.top=49
W20240119 00:17:14.347046 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.357 ms                  | 55.180 ms                 |
| Forward                   | 8.064 ms                  | 16.022 ms                 |
| Backward                  | 5.026 ms                  | 7.093 ms                  |
| Optimize                  | 5.436 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 8.785 ms                  | 74.408 ms                 |
| AfterBackward             | 67.973 ms                 | 1.051 s                   |
| BlockToStepN              | 47.094 ms                 | 252.924 ms                |
| OneStep                   | 187.774 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:14.888007 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2496
W20240119 00:17:15.082908 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=56, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.554 ms                 | 376.809 ms                |
| ProcessBack:UpdateCache   | 9.347 ms                  | 765.861 ms                |
| ProcessBack:UpsertPq      | 39.287 ms                 | 62.868 ms                 |
| ProcessOneStep            | 67.128 ms                 | 1.051 s                   |
| BlockToStepN              | 38.627 ms                 | 252.795 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:15.494980 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240119 00:17:15.888027 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2854
W20240119 00:17:16.120872 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=60, pq.top=59
W20240119 00:17:16.611140 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240119 00:17:16.888010 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=8335
W20240119 00:17:17.242347 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=64, pq.top=63
W20240119 00:17:17.717608 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
E20240119 00:17:17.888010 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2107
W20240119 00:17:18.242075 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=69
E20240119 00:17:18.888041 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1037
W20240119 00:17:18.911538 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240119 00:17:19.250523 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=74, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.357 ms                  | 58.471 ms                 |
| Forward                   | 8.210 ms                  | 16.022 ms                 |
| Backward                  | 5.002 ms                  | 7.093 ms                  |
| Optimize                  | 5.392 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 74.408 ms                 |
| AfterBackward             | 67.083 ms                 | 1.051 s                   |
| BlockToStepN              | 38.732 ms                 | 351.743 ms                |
| OneStep                   | 177.502 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:19.888016 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=104
W20240119 00:17:19.946188 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
W20240119 00:17:20.250041 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=78
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.554 ms                 | 14.240 ms                 |
| ProcessBack:UpdateCache   | 9.328 ms                  | 11.610 ms                 |
| ProcessBack:UpsertPq      | 39.287 ms                 | 56.543 ms                 |
| ProcessOneStep            | 67.128 ms                 | 1.051 s                   |
| BlockToStepN              | 40.602 ms                 | 351.601 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:20.888013 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=512
W20240119 00:17:21.280671 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
W20240119 00:17:22.481070 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
E20240119 00:17:22.844978 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 00:17:22.897440 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=84, pq.top=84
W20240119 00:17:23.575263 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240119 00:17:23.844012 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3889
W20240119 00:17:24.080788 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=92
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.369 ms                  | 58.471 ms                 |
| Forward                   | 8.000 ms                  | 16.022 ms                 |
| Backward                  | 4.958 ms                  | 7.093 ms                  |
| Optimize                  | 5.412 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 74.408 ms                 |
| AfterBackward             | 66.293 ms                 | 1.226 s                   |
| BlockToStepN              | 33.164 ms                 | 388.621 ms                |
| OneStep                   | 165.807 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:24.844053 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4227
W20240119 00:17:24.872643 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
W20240119 00:17:25.080201 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=96, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.441 ms                 | 14.352 ms                 |
| ProcessBack:UpdateCache   | 9.285 ms                  | 11.610 ms                 |
| ProcessBack:UpsertPq      | 39.179 ms                 | 56.543 ms                 |
| ProcessOneStep            | 66.313 ms                 | 1.226 s                   |
| BlockToStepN              | 34.214 ms                 | 388.485 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:25.844020 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=13399
W20240119 00:17:26.042953 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240119 00:17:26.844020 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=595
W20240119 00:17:26.846861 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=98, pq.top=98
W20240119 00:17:27.054019 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 3] 100 steps, total: 25.550, sample: 0.949, forward: 1.361, backward: 0.827, update: 0.627
[proc 6] 100 steps, total: 25.511, sample: 0.886, forward: 1.475, backward: 0.792, update: 0.659
[proc 5] 100 steps, total: 25.509, sample: 0.807, forward: 1.450, backward: 0.775, update: 0.600
[proc 4] 100 steps, total: 25.526, sample: 0.864, forward: 1.395, backward: 0.884, update: 0.668
[proc 2] 100 steps, total: 25.532, sample: 0.739, forward: 1.281, backward: 0.722, update: 0.625
[proc 1] 100 steps, total: 25.520, sample: 0.902, forward: 1.582, backward: 0.830, update: 0.694
-------Step 0-------
tensor([ 2622,    24,  3548,    38, 10488, 13765,  1897,  9133, 11361, 13233]) tensor([ 2790,  8369,  6061, 13049, 10279,  1824,  5094,  6137,   944,  1314])
-------Step 1-------
tensor([ 2622,    24,  3548,    38, 10488, 13765,  1897,  9133, 11361, 13233]) tensor([11805, 13627, 14324, 13447,  1167,  2623,  8477,  1034,  2630, 11944])
-------Step 2-------
tensor([ 3690,  6517,  5955, 13687,  8228, 13619,  8220,    12,  5745,  2595]) tensor([ 7178,  6775,  5741,  8811,  3048, 12259,   350,  2261, 13054,  3603])
-------Step 3-------
tensor([ 3690,  6517,  5955, 13687,  8228, 13619,  8220,    12,  5745,  2595]) tensor([11677,   401, 10304, 14895,  8647,  7035, 10591,   898,  3741,  4869])
-------Step 4-------
tensor([11078,    43,    70,  4044,  5236, 10869,    32, 13163,  4975,   171]) tensor([ 3918, 11936, 14831,  2355,  1801,  9097,   605, 11655,  6596, 11500])
-------Step 5-------
tensor([11078,    43,    70,  4044,  5236, 10869,    32, 13163,  4975,   171]) tensor([ 5305,  5503,  2927, 11567,  9847,  9972, 13920,  6871,  3102,  8369])
-------Step 6-------
tensor([ 2234,  5473, 14564,  4003,    73,  5830, 10451,  2057, 12938,  1046]) tensor([10606,  4034, 11694,  9524,  1125, 12280, 14523, 11655, 13561, 14080])
-------Step 7-------
tensor([ 2234,  5473, 14564,  4003,    73,  5830, 10451,  2057, 12938,  1046]) tensor([ 3934,  9825,  7137, 14744,  6117,   176,  6304,  1625,  2877,  4444])
-------Step 8-------
tensor([ 2584,  7870,  7691, 14261,  4975,  3145, 10173,  4569,  3051,  6106]) tensor([  291,   300, 14396, 14436,  6301,  4804, 13968,   775,    31,  5614])
-------Step 9-------
tensor([ 2584,  7870,  7691, 14261,  4975,  3145, 10173,  4569,  3051,  6106]) tensor([   45, 11769, 14515, 13000,  4271, 11244,  1186, 12932,  7385,  8851])
[proc 0] 100 steps, total: 25.542, sample: 0.966, forward: 1.272, backward: 0.645, update: 0.582
[proc 7] 100 steps, total: 25.528, sample: 0.742, forward: 1.413, backward: 0.661, update: 0.635
E20240119 00:17:27.844014 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=812
W20240119 00:17:27.846114 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240119 00:17:28.295682 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240119 00:17:28.844127 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4867
W20240119 00:17:28.846186 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=108
W20240119 00:17:29.366133 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.357 ms                  | 59.610 ms                 |
| Forward                   | 8.000 ms                  | 16.022 ms                 |
| Backward                  | 4.959 ms                  | 7.093 ms                  |
| Optimize                  | 5.436 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 74.408 ms                 |
| AfterBackward             | 65.733 ms                 | 1.300 s                   |
| BlockToStepN              | 35.751 ms                 | 388.621 ms                |
| OneStep                   | 169.958 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:29.844475 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240119 00:17:30.394143 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.555 ms                 |
| ProcessBack:UpdateCache   | 9.233 ms                  | 11.610 ms                 |
| ProcessBack:UpsertPq      | 38.102 ms                 | 56.543 ms                 |
| ProcessOneStep            | 65.680 ms                 | 1.300 s                   |
| BlockToStepN              | 35.634 ms                 | 388.485 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:31.109786 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 00:17:31.161211 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240119 00:17:31.443207 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240119 00:17:32.109017 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=5919
W20240119 00:17:32.256281 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240119 00:17:32.445324 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
E20240119 00:17:33.109012 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=2519
W20240119 00:17:33.256120 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=124
W20240119 00:17:33.691634 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.328 ms                  | 59.610 ms                 |
| Forward                   | 7.952 ms                  | 16.022 ms                 |
| Backward                  | 4.939 ms                  | 7.093 ms                  |
| Optimize                  | 5.417 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 74.408 ms                 |
| AfterBackward             | 65.029 ms                 | 1.613 s                   |
| BlockToStepN              | 35.751 ms                 | 388.621 ms                |
| OneStep                   | 170.174 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:34.872064 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240119 00:17:34.890169 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 00:17:35.144992 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=126, pq.top=126
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.091 ms                 | 17.596 ms                 |
| ProcessBack:UpdateCache   | 9.215 ms                  | 11.606 ms                 |
| ProcessBack:UpsertPq      | 37.710 ms                 | 54.547 ms                 |
| ProcessOneStep            | 64.983 ms                 | 1.667 s                   |
| BlockToStepN              | 33.074 ms                 | 388.485 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:35.878515 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end2
E20240119 00:17:35.890007 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=3566
W20240119 00:17:36.239135 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=134, pq.top=133
E20240119 00:17:36.890024 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=6970
W20240119 00:17:36.949517 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 00:17:37.890046 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=14003
W20240119 00:17:38.081085 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
W20240119 00:17:38.789734 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
E20240119 00:17:38.890008 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=3162
W20240119 00:17:39.101186 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.297 ms                  | 60.394 ms                 |
| Forward                   | 7.923 ms                  | 16.022 ms                 |
| Backward                  | 4.940 ms                  | 7.093 ms                  |
| Optimize                  | 5.392 ms                  | 11.803 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 74.408 ms                 |
| AfterBackward             | 65.422 ms                 | 1.667 s                   |
| BlockToStepN              | 28.572 ms                 | 388.621 ms                |
| OneStep                   | 167.312 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:39.855955 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=146
E20240119 00:17:39.890012 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1104
W20240119 00:17:40.310971 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.105 ms                 | 17.596 ms                 |
| ProcessBack:UpdateCache   | 9.213 ms                  | 11.606 ms                 |
| ProcessBack:UpsertPq      | 37.661 ms                 | 54.547 ms                 |
| ProcessOneStep            | 64.983 ms                 | 1.667 s                   |
| BlockToStepN              | 28.081 ms                 | 388.485 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:40.890038 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=284
W20240119 00:17:41.333562 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240119 00:17:41.890018 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2681
W20240119 00:17:42.012432 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=154
W20240119 00:17:42.343197 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 00:17:42.890027 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3212
W20240119 00:17:43.021623 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=159
W20240119 00:17:43.417735 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
E20240119 00:17:43.890033 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3589
W20240119 00:17:44.021396 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=167, pq.top=166
W20240119 00:17:44.448110 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.239 ms                  | 59.610 ms                 |
| Forward                   | 7.923 ms                  | 12.148 ms                 |
| Backward                  | 4.959 ms                  | 6.772 ms                  |
| Optimize                  | 5.437 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.059 ms                 | 70.835 ms                 |
| AfterBackward             | 65.164 ms                 | 1.613 s                   |
| BlockToStepN              | 28.250 ms                 | 371.567 ms                |
| OneStep                   | 165.807 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:44.890018 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=8359
W20240119 00:17:45.021287 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.111 ms                 | 17.596 ms                 |
| ProcessBack:UpdateCache   | 9.215 ms                  | 11.606 ms                 |
| ProcessBack:UpsertPq      | 37.661 ms                 | 55.486 ms                 |
| ProcessOneStep            | 65.113 ms                 | 1.613 s                   |
| BlockToStepN              | 28.081 ms                 | 388.485 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:17:45.479506 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240119 00:17:45.890090 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=5832
W20240119 00:17:46.021358 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240119 00:17:46.494393 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240119 00:17:46.890058 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3992
W20240119 00:17:47.068184 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=180
W20240119 00:17:47.740541 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240119 00:17:47.890008 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3955
W20240119 00:17:48.068117 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=186, pq.top=185
W20240119 00:17:48.798496 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240119 00:17:48.890010 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=3615
W20240119 00:17:49.148510 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.281 ms                  | 59.610 ms                 |
| Forward                   | 7.923 ms                  | 12.148 ms                 |
| Backward                  | 5.000 ms                  | 6.772 ms                  |
| Optimize                  | 5.435 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.038 ms                 | 70.835 ms                 |
| AfterBackward             | 64.802 ms                 | 1.613 s                   |
| BlockToStepN              | 28.809 ms                 | 405.177 ms                |
| OneStep                   | 165.549 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:49.890110 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3293
W20240119 00:17:49.980667 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:17:50.148339 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.555 ms                 |
| ProcessBack:UpdateCache   | 9.203 ms                  | 11.138 ms                 |
| ProcessBack:UpsertPq      | 37.455 ms                 | 54.547 ms                 |
| ProcessOneStep            | 64.677 ms                 | 1.613 s                   |
| BlockToStepN              | 28.681 ms                 | 405.039 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:50.890007 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=1835
[proc 4] 200 steps, total: 23.929, sample: 0.819, forward: 0.792, backward: 0.650, update: 0.569
[proc 0] 200 steps, total: 23.929, sample: 0.791, forward: 0.771, backward: 0.501, update: 0.527
[proc 5] 200 steps, total: 23.930, sample: 0.739, forward: 0.830, backward: 0.678, update: 0.570
[proc 2] 200 steps, total: 23.930, sample: 0.832, forward: 0.857, backward: 0.619, update: 0.582
[proc 3] 200 steps, total: 23.930, sample: 0.611, forward: 0.748, backward: 0.666, update: 0.562
[proc 1] 200 steps, total: 23.929, sample: 0.710, forward: 0.860, backward: 0.603, update: 0.597
[proc 7] 200 steps, total: 23.929, sample: 0.864, forward: 0.867, backward: 0.527, update: 0.691
[proc 6] 200 steps, total: 23.930, sample: 0.777, forward: 0.838, backward: 0.671, update: 0.583
W20240119 00:17:51.081213 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240119 00:17:51.190204 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=201
E20240119 00:17:51.890137 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=1050
W20240119 00:17:52.097342 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240119 00:17:52.258334 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=207
E20240119 00:17:52.890194 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=68
W20240119 00:17:53.218214 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
W20240119 00:17:53.258370 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=210
E20240119 00:17:53.890308 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=384
W20240119 00:17:54.250147 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240119 00:17:54.258201 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.233 ms                  | 59.610 ms                 |
| Forward                   | 7.833 ms                  | 12.148 ms                 |
| Backward                  | 4.962 ms                  | 6.772 ms                  |
| Optimize                  | 5.340 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.654 ms                 | 70.835 ms                 |
| AfterBackward             | 64.204 ms                 | 1.613 s                   |
| BlockToStepN              | 29.374 ms                 | 405.177 ms                |
| OneStep                   | 159.699 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:54.890626 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4919
W20240119 00:17:55.257002 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:17:55.384174 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=212, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.555 ms                 |
| ProcessBack:UpdateCache   | 9.169 ms                  | 11.138 ms                 |
| ProcessBack:UpsertPq      | 36.378 ms                 | 54.547 ms                 |
| ProcessOneStep            | 64.139 ms                 | 1.613 s                   |
| BlockToStepN              | 30.119 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:55.893988 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1701
W20240119 00:17:56.384021 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=212, pq.top=211
W20240119 00:17:56.399207 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 00:17:56.893572 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3517
W20240119 00:17:57.421826 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=218
W20240119 00:17:57.490363 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240119 00:17:57.893488 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=271
W20240119 00:17:58.500440 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=225, pq.top=224
W20240119 00:17:58.505482 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240119 00:17:58.893013 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=1247
W20240119 00:17:59.500452 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=229
W20240119 00:17:59.586860 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.206 ms                  | 59.610 ms                 |
| Forward                   | 7.788 ms                  | 12.148 ms                 |
| Backward                  | 5.000 ms                  | 6.772 ms                  |
| Optimize                  | 5.265 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.707 ms                 | 70.835 ms                 |
| AfterBackward             | 63.449 ms                 | 1.613 s                   |
| BlockToStepN              | 36.201 ms                 | 796.936 ms                |
| OneStep                   | 165.549 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:17:59.893009 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=661
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.539 ms                 |
| ProcessBack:UpdateCache   | 9.097 ms                  | 10.924 ms                 |
| ProcessBack:UpsertPq      | 35.397 ms                 | 54.500 ms                 |
| ProcessOneStep            | 63.257 ms                 | 1.613 s                   |
| BlockToStepN              | 38.627 ms                 | 796.775 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:00.511549 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=234
W20240119 00:18:00.719087 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 00:18:00.893014 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1374
W20240119 00:18:01.511493 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=238
W20240119 00:18:01.721624 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 00:18:01.893023 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1972
W20240119 00:18:02.521903 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=242
W20240119 00:18:02.732175 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:18:02.893366 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1548
W20240119 00:18:03.546324 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=246
W20240119 00:18:03.740408 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 00:18:03.893131 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1016
W20240119 00:18:04.546535 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=250, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.208 ms                  | 58.471 ms                 |
| Forward                   | 7.744 ms                  | 11.919 ms                 |
| Backward                  | 5.002 ms                  | 6.631 ms                  |
| Optimize                  | 5.206 ms                  | 9.989 ms                  |
| BarrierTimeBeforeRank0    | 10.727 ms                 | 68.216 ms                 |
| AfterBackward             | 62.924 ms                 | 1.591 s                   |
| BlockToStepN              | 44.996 ms                 | 796.936 ms                |
| OneStep                   | 171.655 ms                | 1.971 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:04.893014 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2198
W20240119 00:18:04.898557 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.539 ms                 |
| ProcessBack:UpdateCache   | 9.046 ms                  | 10.924 ms                 |
| ProcessBack:UpsertPq      | 34.374 ms                 | 54.500 ms                 |
| ProcessOneStep            | 62.755 ms                 | 1.591 s                   |
| BlockToStepN              | 46.973 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:05.546473 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=253
E20240119 00:18:05.893014 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=4337
W20240119 00:18:06.072825 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:18:06.546581 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=256
E20240119 00:18:06.893586 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=915
W20240119 00:18:07.079006 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 00:18:07.546638 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=259
E20240119 00:18:07.896437 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1933
W20240119 00:18:08.245599 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 00:18:08.633024 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=263
E20240119 00:18:08.897505 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4027
W20240119 00:18:09.265894 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:18:09.633774 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=266
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.241 ms                  | 58.471 ms                 |
| Forward                   | 7.758 ms                  | 11.919 ms                 |
| Backward                  | 4.982 ms                  | 6.772 ms                  |
| Optimize                  | 5.231 ms                  | 9.989 ms                  |
| BarrierTimeBeforeRank0    | 10.727 ms                 | 68.216 ms                 |
| AfterBackward             | 62.179 ms                 | 1.591 s                   |
| BlockToStepN              | 49.523 ms                 | 683.152 ms                |
| OneStep                   | 178.307 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:09.897193 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3912
W20240119 00:18:10.285145 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.539 ms                 |
| ProcessBack:UpdateCache   | 8.980 ms                  | 10.924 ms                 |
| ProcessBack:UpsertPq      | 33.765 ms                 | 54.500 ms                 |
| ProcessOneStep            | 62.066 ms                 | 1.591 s                   |
| BlockToStepN              | 51.610 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:10.670814 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=269
E20240119 00:18:10.897938 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1813
W20240119 00:18:11.290825 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:18:11.703830 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=272
E20240119 00:18:11.898187 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1364
W20240119 00:18:12.305145 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 00:18:12.726564 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=275
E20240119 00:18:12.899591 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1406
W20240119 00:18:13.311369 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:18:13.726027 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=278
E20240119 00:18:13.899370 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1483
W20240119 00:18:14.319620 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.292 ms                  | 58.471 ms                 |
| Forward                   | 7.788 ms                  | 11.919 ms                 |
| Backward                  | 4.964 ms                  | 6.772 ms                  |
| Optimize                  | 5.230 ms                  | 9.989 ms                  |
| BarrierTimeBeforeRank0    | 10.707 ms                 | 68.216 ms                 |
| AfterBackward             | 61.547 ms                 | 1.591 s                   |
| BlockToStepN              | 54.942 ms                 | 683.152 ms                |
| OneStep                   | 184.193 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:14.735075 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=282, pq.top=281
E20240119 00:18:14.901453 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1529
W20240119 00:18:15.356242 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.517 ms                 |
| ProcessBack:UpdateCache   | 8.914 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 33.106 ms                 | 54.408 ms                 |
| ProcessOneStep            | 61.483 ms                 | 1.591 s                   |
| BlockToStepN              | 55.538 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:15.735512 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
E20240119 00:18:15.901082 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=439
W20240119 00:18:16.499452 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 00:18:16.735056 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=287, pq.top=286
E20240119 00:18:16.901010 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2255
W20240119 00:18:17.550328 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 00:18:17.735146 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=290, pq.top=289
E20240119 00:18:17.901156 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1585
W20240119 00:18:18.654449 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 00:18:18.741492 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=293, pq.top=292
E20240119 00:18:18.901979 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1416
W20240119 00:18:19.657423 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.321 ms                  | 58.471 ms                 |
| Forward                   | 7.795 ms                  | 11.919 ms                 |
| Backward                  | 4.962 ms                  | 6.772 ms                  |
| Optimize                  | 5.230 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.589 ms                 | 68.462 ms                 |
| AfterBackward             | 60.772 ms                 | 1.591 s                   |
| BlockToStepN              | 64.907 ms                 | 683.152 ms                |
| OneStep                   | 190.725 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:19.741132 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=295
E20240119 00:18:19.906291 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1737
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.517 ms                 |
| ProcessBack:UpdateCache   | 8.814 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 32.867 ms                 | 54.408 ms                 |
| ProcessOneStep            | 60.501 ms                 | 1.591 s                   |
| BlockToStepN              | 65.099 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:20.697147 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 00:18:20.835654 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=298
E20240119 00:18:20.907265 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=955
[proc 4] 300 steps, total: 30.268, sample: 0.948, forward: 0.884, backward: 0.666, update: 0.656
[proc 3] 300 steps, total: 30.268, sample: 0.903, forward: 0.830, backward: 0.641, update: 0.617
[proc 5] 300 steps, total: 30.268, sample: 0.708, forward: 0.815, backward: 0.636, update: 0.545
[proc 2] 300 steps, total: 30.268, sample: 0.795, forward: 0.815, backward: 0.580, update: 0.541
[proc 6] 300 steps, total: 30.268, sample: 0.767, forward: 0.816, backward: 0.637, update: 0.616
[proc 1] 300 steps, total: 30.268, sample: 0.817, forward: 0.853, backward: 0.602, update: 0.561
[proc 7] 300 steps, total: 30.268, sample: 0.776, forward: 0.798, backward: 0.482, update: 0.600
[proc 0] 300 steps, total: 30.268, sample: 0.798, forward: 0.745, backward: 0.491, update: 0.550
W20240119 00:18:21.706739 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:18:21.835269 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=302, pq.top=301
E20240119 00:18:21.914994 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1184
W20240119 00:18:22.745186 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 00:18:22.835685 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=304
E20240119 00:18:22.914515 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1074
W20240119 00:18:23.835844 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=306
W20240119 00:18:23.845445 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 00:18:23.914008 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.353 ms                  | 58.471 ms                 |
| Forward                   | 7.821 ms                  | 11.919 ms                 |
| Backward                  | 4.986 ms                  | 7.093 ms                  |
| Optimize                  | 5.232 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.654 ms                 | 68.462 ms                 |
| AfterBackward             | 59.717 ms                 | 1.591 s                   |
| BlockToStepN              | 73.760 ms                 | 683.152 ms                |
| OneStep                   | 197.498 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:24.835712 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=310, pq.top=309
E20240119 00:18:24.914014 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1707
W20240119 00:18:24.984380 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.120 ms                 | 17.517 ms                 |
| ProcessBack:UpdateCache   | 8.752 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 32.664 ms                 | 54.408 ms                 |
| ProcessOneStep            | 59.483 ms                 | 1.591 s                   |
| BlockToStepN              | 75.277 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:25.835770 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=312
E20240119 00:18:25.914011 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1256
W20240119 00:18:25.996093 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:18:26.914398 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4251
W20240119 00:18:26.959614 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=316, pq.top=315
W20240119 00:18:27.258582 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 00:18:27.917765 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1321
W20240119 00:18:27.959395 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=317
W20240119 00:18:28.404978 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 00:18:28.917160 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=800
W20240119 00:18:28.959316 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=320
W20240119 00:18:29.545416 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.358 ms                  | 58.471 ms                 |
| Forward                   | 7.821 ms                  | 11.919 ms                 |
| Backward                  | 4.986 ms                  | 7.093 ms                  |
| Optimize                  | 5.231 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.707 ms                 | 68.686 ms                 |
| AfterBackward             | 59.047 ms                 | 1.591 s                   |
| BlockToStepN              | 78.586 ms                 | 683.152 ms                |
| OneStep                   | 204.705 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:29.918081 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1534
W20240119 00:18:30.080600 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=324, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.116 ms                 | 17.517 ms                 |
| ProcessBack:UpdateCache   | 8.711 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 32.451 ms                 | 54.408 ms                 |
| ProcessOneStep            | 58.941 ms                 | 1.591 s                   |
| BlockToStepN              | 79.113 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:30.756212 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 00:18:30.918047 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=817
W20240119 00:18:31.080701 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=325
W20240119 00:18:31.871881 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 00:18:31.918009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=4141
W20240119 00:18:32.080449 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=328
E20240119 00:18:32.919515 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=827
W20240119 00:18:33.080545 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=331, pq.top=330
W20240119 00:18:33.126926 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 00:18:33.919018 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=3850
W20240119 00:18:34.080479 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=334, pq.top=333
W20240119 00:18:34.252058 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.372 ms                  | 58.471 ms                 |
| Forward                   | 7.827 ms                  | 11.919 ms                 |
| Backward                  | 4.984 ms                  | 7.093 ms                  |
| Optimize                  | 5.265 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.589 ms                 | 68.686 ms                 |
| AfterBackward             | 58.144 ms                 | 1.591 s                   |
| BlockToStepN              | 89.593 ms                 | 683.152 ms                |
| OneStep                   | 215.365 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:34.921336 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1112
W20240119 00:18:35.080231 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=336, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.111 ms                 | 17.410 ms                 |
| ProcessBack:UpdateCache   | 8.637 ms                  | 10.675 ms                 |
| ProcessBack:UpsertPq      | 32.381 ms                 | 54.058 ms                 |
| ProcessOneStep            | 57.796 ms                 | 1.591 s                   |
| BlockToStepN              | 89.500 ms                 | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:35.505707 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 00:18:35.926226 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1932
W20240119 00:18:36.080308 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=338
W20240119 00:18:36.722622 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 00:18:36.926102 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=879
W20240119 00:18:37.080579 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=340
W20240119 00:18:37.925148 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:18:37.926009 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2835
W20240119 00:18:38.080087 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=344, pq.top=343
E20240119 00:18:38.931816 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1299
W20240119 00:18:39.080543 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=346, pq.top=345
W20240119 00:18:39.117612 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.386 ms                  | 58.471 ms                 |
| Forward                   | 7.822 ms                  | 11.919 ms                 |
| Backward                  | 4.982 ms                  | 7.093 ms                  |
| Optimize                  | 5.265 ms                  | 10.627 ms                 |
| BarrierTimeBeforeRank0    | 10.410 ms                 | 68.686 ms                 |
| AfterBackward             | 57.605 ms                 | 1.591 s                   |
| BlockToStepN              | 103.179 ms                | 683.152 ms                |
| OneStep                   | 222.405 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:39.932650 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=413
W20240119 00:18:40.080523 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=348
W20240119 00:18:40.209595 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.094 ms                 | 17.410 ms                 |
| ProcessBack:UpdateCache   | 8.581 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 32.282 ms                 | 54.058 ms                 |
| ProcessOneStep            | 57.192 ms                 | 1.591 s                   |
| BlockToStepN              | 105.212 ms                | 683.003 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:40.932577 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2089
W20240119 00:18:41.080443 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=352, pq.top=351
W20240119 00:18:41.360991 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 00:18:41.932008 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=667
W20240119 00:18:42.080888 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=354, pq.top=353
W20240119 00:18:42.598321 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 00:18:42.932008 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3403
W20240119 00:18:43.080682 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=356
W20240119 00:18:43.615896 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 00:18:43.940447 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4079
W20240119 00:18:44.080479 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=360, pq.top=359
W20240119 00:18:44.624641 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.394 ms                  | 58.343 ms                 |
| Forward                   | 7.831 ms                  | 11.830 ms                 |
| Backward                  | 4.975 ms                  | 6.772 ms                  |
| Optimize                  | 5.272 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.331 ms                 | 68.462 ms                 |
| AfterBackward             | 55.997 ms                 | 1.300 s                   |
| BlockToStepN              | 111.382 ms                | 405.177 ms                |
| OneStep                   | 229.914 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:44.941370 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1965
W20240119 00:18:45.101023 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.094 ms                 | 17.410 ms                 |
| ProcessBack:UpdateCache   | 8.538 ms                  | 10.819 ms                 |
| ProcessBack:UpsertPq      | 32.236 ms                 | 54.058 ms                 |
| ProcessOneStep            | 55.959 ms                 | 1.300 s                   |
| BlockToStepN              | 111.271 ms                | 405.039 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:45.866551 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 00:18:45.941016 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=4559
W20240119 00:18:46.101856 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=364
E20240119 00:18:46.941861 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1068
W20240119 00:18:47.050136 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:18:47.168912 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=368, pq.top=367
E20240119 00:18:47.941009 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=3681
W20240119 00:18:48.157728 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 00:18:48.238008 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=370
E20240119 00:18:48.941231 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1926
W20240119 00:18:49.237655 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=372
W20240119 00:18:49.251506 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.405 ms                  | 58.343 ms                 |
| Forward                   | 7.843 ms                  | 11.830 ms                 |
| Backward                  | 4.975 ms                  | 6.772 ms                  |
| Optimize                  | 5.275 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.322 ms                 | 68.462 ms                 |
| AfterBackward             | 55.218 ms                 | 1.300 s                   |
| BlockToStepN              | 117.872 ms                | 405.177 ms                |
| OneStep                   | 239.170 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:49.941781 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1002
W20240119 00:18:50.263329 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:18:50.292028 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.086 ms                 | 17.384 ms                 |
| ProcessBack:UpdateCache   | 8.484 ms                  | 10.743 ms                 |
| ProcessBack:UpsertPq      | 32.146 ms                 | 53.548 ms                 |
| ProcessOneStep            | 55.139 ms                 | 1.300 s                   |
| BlockToStepN              | 118.194 ms                | 405.039 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:50.941473 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1929
W20240119 00:18:51.292268 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=378, pq.top=377
W20240119 00:18:51.419438 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 00:18:51.941007 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=209
W20240119 00:18:52.326117 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=380
W20240119 00:18:52.421944 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 00:18:52.942483 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1239
W20240119 00:18:53.326054 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=382
W20240119 00:18:53.490012 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:18:53.943136 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3981
W20240119 00:18:54.434952 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=386, pq.top=385
W20240119 00:18:54.687446 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.410 ms                  | 58.343 ms                 |
| Forward                   | 7.841 ms                  | 11.830 ms                 |
| Backward                  | 4.975 ms                  | 6.772 ms                  |
| Optimize                  | 5.277 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.316 ms                 | 68.462 ms                 |
| AfterBackward             | 54.999 ms                 | 1.300 s                   |
| BlockToStepN              | 125.950 ms                | 405.177 ms                |
| OneStep                   | 252.850 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:18:54.943051 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1061
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.075 ms                 | 17.384 ms                 |
| ProcessBack:UpdateCache   | 8.429 ms                  | 10.743 ms                 |
| ProcessBack:UpsertPq      | 32.111 ms                 | 53.548 ms                 |
| ProcessOneStep            | 54.934 ms                 | 1.300 s                   |
| BlockToStepN              | 128.301 ms                | 405.039 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:55.506037 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=388
W20240119 00:18:55.756260 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 00:18:55.954232 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=789
W20240119 00:18:56.506959 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=390
W20240119 00:18:56.757740 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 00:18:56.969108 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1443
W20240119 00:18:57.506932 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=392
W20240119 00:18:57.778218 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:18:57.969038 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1446
W20240119 00:18:58.578521 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=396, pq.top=395
W20240119 00:18:58.912792 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 00:18:58.969009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=1795
W20240119 00:18:59.578102 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=398, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.418 ms                  | 58.471 ms                 |
| Forward                   | 7.843 ms                  | 11.830 ms                 |
| Backward                  | 4.984 ms                  | 6.772 ms                  |
| Optimize                  | 5.277 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.111 ms                 | 68.462 ms                 |
| AfterBackward             | 54.619 ms                 | 1.300 s                   |
| BlockToStepN              | 135.721 ms                | 426.124 ms                |
| OneStep                   | 265.827 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:18:59.919126 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 00:18:59.969041 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=611
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.056 ms                 | 17.384 ms                 |
| ProcessBack:UpdateCache   | 8.357 ms                  | 10.743 ms                 |
| ProcessBack:UpsertPq      | 32.046 ms                 | 53.548 ms                 |
| ProcessOneStep            | 54.557 ms                 | 1.300 s                   |
| BlockToStepN              | 136.044 ms                | 425.918 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:00.578948 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=400, pq.top=399
[proc 6] 400 steps, total: 39.316, sample: 0.703, forward: 0.721, backward: 0.639, update: 0.528
[proc 5] 400 steps, total: 39.316, sample: 0.767, forward: 0.847, backward: 0.682, update: 0.595
[proc 2] 400 steps, total: 39.316, sample: 0.715, forward: 0.859, backward: 0.558, update: 0.573
[proc 7] 400 steps, total: 39.316, sample: 0.864, forward: 0.822, backward: 0.551, update: 0.586
[proc 3] 400 steps, total: 39.316, sample: 0.605, forward: 0.738, backward: 0.644, update: 0.510
[proc 1] 400 steps, total: 39.316, sample: 0.698, forward: 0.845, backward: 0.588, update: 0.600
[proc 4] 400 steps, total: 39.316, sample: 0.722, forward: 0.775, backward: 0.667, update: 0.555
[proc 0] 400 steps, total: 39.316, sample: 0.852, forward: 0.786, backward: 0.492, update: 0.528
E20240119 00:19:00.972728 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1404
W20240119 00:19:01.039278 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:19:01.578483 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=402
E20240119 00:19:01.972014 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=3976
W20240119 00:19:02.255539 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 00:19:02.578446 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=404
E20240119 00:19:02.977277 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1432
W20240119 00:19:03.472370 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:19:03.582752 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=407
E20240119 00:19:03.977008 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=4274
W20240119 00:19:04.491300 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 00:19:04.582634 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=410, pq.top=409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.418 ms                  | 58.471 ms                 |
| Forward                   | 7.841 ms                  | 11.830 ms                 |
| Backward                  | 4.982 ms                  | 6.772 ms                  |
| Optimize                  | 5.291 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.111 ms                 | 68.462 ms                 |
| AfterBackward             | 54.492 ms                 | 1.300 s                   |
| BlockToStepN              | 140.402 ms                | 426.124 ms                |
| OneStep                   | 274.049 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:19:04.979197 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.035 ms                 | 17.384 ms                 |
| ProcessBack:UpdateCache   | 8.335 ms                  | 10.743 ms                 |
| ProcessBack:UpsertPq      | 31.991 ms                 | 53.548 ms                 |
| ProcessOneStep            | 54.421 ms                 | 1.300 s                   |
| BlockToStepN              | 140.653 ms                | 425.918 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:05.582659 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=412, pq.top=411
W20240119 00:19:05.768455 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 00:19:05.984922 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=791
W20240119 00:19:06.583029 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=413
W20240119 00:19:06.784080 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 00:19:06.984365 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1320
W20240119 00:19:07.583834 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=416
W20240119 00:19:07.806800 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240119 00:19:07.988415 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=678
W20240119 00:19:08.583429 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=418
W20240119 00:19:08.809252 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 00:19:08.988015 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1130
W20240119 00:19:09.583139 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.428 ms                  | 58.471 ms                 |
| Forward                   | 7.846 ms                  | 11.919 ms                 |
| Backward                  | 4.971 ms                  | 6.772 ms                  |
| Optimize                  | 5.296 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.038 ms                 | 68.462 ms                 |
| AfterBackward             | 54.543 ms                 | 1.300 s                   |
| BlockToStepN              | 148.867 ms                | 463.790 ms                |
| OneStep                   | 278.284 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:19:10.005921 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2041
W20240119 00:19:10.026237 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.061 ms                 | 17.384 ms                 |
| ProcessBack:UpdateCache   | 8.370 ms                  | 12.080 ms                 |
| ProcessBack:UpsertPq      | 31.985 ms                 | 54.058 ms                 |
| ProcessOneStep            | 54.545 ms                 | 1.300 s                   |
| BlockToStepN              | 149.408 ms                | 463.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:10.583774 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=423
E20240119 00:19:11.006105 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1535
W20240119 00:19:11.185958 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:19:11.584003 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=426, pq.top=425
E20240119 00:19:12.017535 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=830
W20240119 00:19:12.225929 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:19:12.635982 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=428
E20240119 00:19:13.018932 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=621
W20240119 00:19:13.284871 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 00:19:13.654222 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=430
E20240119 00:19:14.018057 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=856
W20240119 00:19:14.294595 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 00:19:14.654909 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=434, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.423 ms                  | 58.471 ms                 |
| Forward                   | 7.833 ms                  | 11.919 ms                 |
| Backward                  | 4.966 ms                  | 6.772 ms                  |
| Optimize                  | 5.294 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 10.038 ms                 | 68.462 ms                 |
| AfterBackward             | 54.483 ms                 | 1.300 s                   |
| BlockToStepN              | 157.880 ms                | 463.790 ms                |
| OneStep                   | 283.995 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
E20240119 00:19:15.018608 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.060 ms                 | 16.936 ms                 |
| ProcessBack:UpdateCache   | 8.352 ms                  | 11.991 ms                 |
| ProcessBack:UpsertPq      | 31.897 ms                 | 53.681 ms                 |
| ProcessOneStep            | 54.436 ms                 | 1.300 s                   |
| BlockToStepN              | 157.745 ms                | 463.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:15.516548 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:19:15.654505 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=436, pq.top=435
E20240119 00:19:16.018013 55994 parallel_pq_v2.h:76] insert failed, size(hashtable)=4370
W20240119 00:19:16.528762 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:19:16.655262 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=437
E20240119 00:19:17.020289 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1118
W20240119 00:19:17.576000 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 00:19:17.719516 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=440
E20240119 00:19:18.020022 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=3779
W20240119 00:19:18.719194 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=442
W20240119 00:19:18.765679 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 00:19:19.020053 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.418 ms                  | 58.471 ms                 |
| Forward                   | 7.831 ms                  | 11.919 ms                 |
| Backward                  | 4.971 ms                  | 6.772 ms                  |
| Optimize                  | 5.303 ms                  | 10.404 ms                 |
| BarrierTimeBeforeRank0    | 9.923 ms                  | 68.462 ms                 |
| AfterBackward             | 54.341 ms                 | 1.300 s                   |
| BlockToStepN              | 176.139 ms                | 463.790 ms                |
| OneStep                   | 295.312 ms                | 1.645 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:19.719913 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=445
W20240119 00:19:19.847012 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 00:19:20.035512 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=574
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.056 ms                 | 16.936 ms                 |
| ProcessBack:UpdateCache   | 8.385 ms                  | 11.991 ms                 |
| ProcessBack:UpsertPq      | 31.876 ms                 | 53.681 ms                 |
| ProcessOneStep            | 54.191 ms                 | 1.300 s                   |
| BlockToStepN              | 176.763 ms                | 463.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:20.719743 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=448
E20240119 00:19:21.042088 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1568
W20240119 00:19:21.134721 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 00:19:21.719063 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=450
E20240119 00:19:22.050849 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1285
W20240119 00:19:22.200134 56419 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 00:19:22.720127 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=453
E20240119 00:19:23.050009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=4168
W20240119 00:19:23.283114 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:19:23.721101 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=455
E20240119 00:19:24.056993 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1329
W20240119 00:19:24.513865 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.428 ms                  | 58.376 ms                 |
| Forward                   | 7.833 ms                  | 11.830 ms                 |
| Backward                  | 4.975 ms                  | 6.631 ms                  |
| Optimize                  | 5.306 ms                  | 10.121 ms                 |
| BarrierTimeBeforeRank0    | 10.038 ms                 | 68.216 ms                 |
| AfterBackward             | 54.114 ms                 | 1.226 s                   |
| BlockToStepN              | 179.697 ms                | 453.835 ms                |
| OneStep                   | 299.963 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:24.721225 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=458
E20240119 00:19:25.072520 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=278
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.054 ms                 | 16.936 ms                 |
| ProcessBack:UpdateCache   | 8.385 ms                  | 11.991 ms                 |
| ProcessBack:UpsertPq      | 31.810 ms                 | 53.681 ms                 |
| ProcessOneStep            | 54.042 ms                 | 1.226 s                   |
| BlockToStepN              | 182.380 ms                | 453.702 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:25.721542 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=460
W20240119 00:19:25.830593 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 00:19:26.074155 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1111
W20240119 00:19:26.740799 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=463
E20240119 00:19:27.074273 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1942
W20240119 00:19:27.094354 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 00:19:27.740510 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=465
E20240119 00:19:28.074009 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2150
W20240119 00:19:28.094568 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 00:19:28.740139 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=467
E20240119 00:19:29.086871 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=385
W20240119 00:19:29.337286 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.435 ms                  | 58.376 ms                 |
| Forward                   | 7.843 ms                  | 11.830 ms                 |
| Backward                  | 4.980 ms                  | 6.631 ms                  |
| Optimize                  | 5.306 ms                  | 10.121 ms                 |
| BarrierTimeBeforeRank0    | 10.038 ms                 | 68.216 ms                 |
| AfterBackward             | 54.017 ms                 | 1.226 s                   |
| BlockToStepN              | 191.412 ms                | 453.835 ms                |
| OneStep                   | 306.695 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:29.740842 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=470, pq.top=469
E20240119 00:19:30.086361 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=801
W20240119 00:19:30.346797 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.054 ms                 | 16.936 ms                 |
| ProcessBack:UpdateCache   | 8.352 ms                  | 11.991 ms                 |
| ProcessBack:UpsertPq      | 31.730 ms                 | 53.681 ms                 |
| ProcessOneStep            | 53.942 ms                 | 1.226 s                   |
| BlockToStepN              | 191.779 ms                | 453.702 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:30.773021 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=472
E20240119 00:19:31.088410 56419 parallel_pq_v2.h:76] insert failed, size(hashtable)=3952
W20240119 00:19:31.389988 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 00:19:31.898264 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=476, pq.top=475
E20240119 00:19:32.089383 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1238
W20240119 00:19:32.607609 56419 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 00:19:32.899231 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=478, pq.top=477
E20240119 00:19:33.090613 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2524
W20240119 00:19:33.617405 56419 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 00:19:33.900067 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=480
E20240119 00:19:34.101775 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=620
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.439 ms                  | 58.376 ms                 |
| Forward                   | 7.849 ms                  | 11.830 ms                 |
| Backward                  | 4.984 ms                  | 6.631 ms                  |
| Optimize                  | 5.324 ms                  | 10.121 ms                 |
| BarrierTimeBeforeRank0    | 9.923 ms                  | 68.216 ms                 |
| AfterBackward             | 53.967 ms                 | 1.226 s                   |
| BlockToStepN              | 195.779 ms                | 462.201 ms                |
| OneStep                   | 311.219 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:34.774215 56419 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 00:19:34.901046 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=483
E20240119 00:19:35.101122 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1616
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.054 ms                 | 16.020 ms                 |
| ProcessBack:UpdateCache   | 8.319 ms                  | 11.610 ms                 |
| ProcessBack:UpsertPq      | 31.709 ms                 | 53.548 ms                 |
| ProcessOneStep            | 53.904 ms                 | 1.226 s                   |
| BlockToStepN              | 202.376 ms                | 462.061 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:35.785113 56419 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 00:19:35.901974 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=485
E20240119 00:19:36.101286 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=1415
W20240119 00:19:36.901989 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=487
E20240119 00:19:37.101055 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2151
W20240119 00:19:37.176367 56419 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 00:19:37.901758 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=490, pq.top=489
E20240119 00:19:38.101007 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=1327
W20240119 00:19:38.348531 56419 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 00:19:38.901155 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=492
E20240119 00:19:39.102034 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=2314
W20240119 00:19:39.580327 56419 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.440 ms                  | 58.376 ms                 |
| Forward                   | 7.849 ms                  | 11.830 ms                 |
| Backward                  | 4.986 ms                  | 6.631 ms                  |
| Optimize                  | 5.327 ms                  | 10.121 ms                 |
| BarrierTimeBeforeRank0    | 10.111 ms                 | 68.216 ms                 |
| AfterBackward             | 53.937 ms                 | 1.226 s                   |
| BlockToStepN              | 205.903 ms                | 462.201 ms                |
| OneStep                   | 319.465 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:39.901495 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=494
E20240119 00:19:40.104422 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=4030
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.043 ms                 | 16.020 ms                 |
| ProcessBack:UpdateCache   | 8.305 ms                  | 11.610 ms                 |
| ProcessBack:UpsertPq      | 31.700 ms                 | 53.548 ms                 |
| ProcessOneStep            | 53.861 ms                 | 1.226 s                   |
| BlockToStepN              | 205.948 ms                | 462.061 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 00:19:40.586130 56419 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 00:19:40.901983 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=496
E20240119 00:19:41.104033 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=586
W20240119 00:19:41.891985 56419 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 00:19:41.972467 55689 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=499
E20240119 00:19:42.104985 56418 parallel_pq_v2.h:76] insert failed, size(hashtable)=904
[proc 3] 500 steps, total: 41.639, sample: 0.752, forward: 0.814, backward: 0.585, update: 0.613
[proc 4] 500 steps, total: 41.639, sample: 0.864, forward: 0.841, backward: 0.669, update: 0.666
[proc 0] 500 steps, total: 41.639, sample: 0.955, forward: 0.787, backward: 0.488, update: 0.530
[proc 6] 500 steps, total: 41.639, sample: 0.817, forward: 0.774, backward: 0.670, update: 0.573
[proc 2] 500 steps, total: 41.639, sample: 0.710, forward: 0.764, backward: 0.646, update: 0.519
[proc 5] 500 steps, total: 41.639, sample: 0.852, forward: 0.838, backward: 0.708, update: 0.582
[proc 7] 500 steps, total: 41.639, sample: 0.715, forward: 0.762, backward: 0.606, update: 0.535
[proc 1] 500 steps, total: 41.639, sample: 0.809, forward: 0.901, backward: 0.592, update: 0.579
Successfully xmh. training takes 160.69525408744812 seconds
before call kg_cache_controller.StopThreads()
W20240119 00:19:42.288246 55689 grad_async_v2.h:71] call StopThreads. PID = 54971
W20240119 00:19:42.288280 55689 grad_base.h:210] before processOneStepNegThread_.join();
W20240119 00:19:42.288678 55689 grad_base.h:212] after processOneStepNegThread_.join();
W20240119 00:19:42.288691 55689 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240119 00:19:42.300521 55689 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fa7640ed590>
W20240119 00:19:45.492657 54971 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
