WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240118 23:24:17.156845 20534 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_139', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='None', use_my_emb=False, cache_ratio=0.1, shuffle=False, backwardMode='CppSync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [20534 sampler.py:454] Start PreSampling
WARNING [20534 sampler.py:532] Before construct renumbering_dict
WARNING [20534 sampler.py:555] PreSampling done
W20240118 23:24:19.703941 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240118 23:24:19.704128 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240118 23:24:19.704162 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240118 23:24:19.704191 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240118 23:24:19.704221 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240118 23:24:19.704254 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240118 23:24:19.704290 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240118 23:24:19.704322 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240118 23:24:19.704356 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240118 23:24:19.704386 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240118 23:24:19.704421 20534 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240118 23:24:19.704447 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240118 23:24:19.704478 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240118 23:24:19.704596 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240118 23:24:19.704633 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240118 23:24:19.704660 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240118 23:24:19.704686 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240118 23:24:19.704713 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240118 23:24:19.704763 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240118 23:24:19.704790 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240118 23:24:19.704830 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240118 23:24:19.704864 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240118 23:24:19.704898 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240118 23:24:19.704931 20534 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240118 23:24:19.704954 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240118 23:24:19.704977 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240118 23:24:19.705041 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240118 23:24:19.705075 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240118 23:24:19.705113 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240118 23:24:19.705145 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240118 23:24:19.705178 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240118 23:24:19.705207 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240118 23:24:19.705235 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240118 23:24:19.705267 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240118 23:24:19.705292 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240118 23:24:19.705328 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240118 23:24:19.705354 20534 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240118 23:24:19.705376 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240118 23:24:19.705399 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240118 23:24:19.705456 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240118 23:24:19.705484 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240118 23:24:19.705514 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240118 23:24:19.705550 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240118 23:24:19.705578 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240118 23:24:19.705621 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240118 23:24:19.705658 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240118 23:24:19.705691 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240118 23:24:19.705720 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240118 23:24:19.705747 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240118 23:24:19.705776 20534 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240118 23:24:19.705799 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240118 23:24:19.705827 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240118 23:24:19.705883 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240118 23:24:19.705917 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240118 23:24:19.705945 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240118 23:24:19.705971 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240118 23:24:19.705996 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240118 23:24:19.706029 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240118 23:24:19.706063 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240118 23:24:19.706090 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240118 23:24:19.706126 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240118 23:24:19.706159 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240118 23:24:19.706187 20534 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240118 23:24:19.706208 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240118 23:24:19.706230 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240118 23:24:19.706283 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240118 23:24:19.706318 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240118 23:24:19.706347 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240118 23:24:19.706385 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240118 23:24:19.706419 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240118 23:24:19.706456 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240118 23:24:19.706483 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240118 23:24:19.706524 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240118 23:24:19.706560 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240118 23:24:19.706588 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240118 23:24:19.706617 20534 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240118 23:24:19.706640 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240118 23:24:19.706668 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240118 23:24:19.706720 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240118 23:24:19.706749 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240118 23:24:19.706780 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240118 23:24:19.706811 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240118 23:24:19.706840 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240118 23:24:19.706867 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240118 23:24:19.706907 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240118 23:24:19.706943 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240118 23:24:19.706977 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240118 23:24:19.707005 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240118 23:24:19.707036 20534 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240118 23:24:19.707057 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240118 23:24:19.707079 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240118 23:24:19.707139 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240118 23:24:19.707175 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240118 23:24:19.707203 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240118 23:24:19.707235 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240118 23:24:19.707263 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240118 23:24:19.707296 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240118 23:24:19.707326 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240118 23:24:19.707358 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240118 23:24:19.707391 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240118 23:24:19.707420 20534 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240118 23:24:19.707448 20534 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240118 23:24:19.707469 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240118 23:24:19.707499 20534 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1488,  2008,  2784,  ...,  8128, 10526,  8058]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.849 seconds
[Rank1] pid = 20933
[Rank2] pid = 20997
[Rank3] pid = 21061
[Rank4] pid = 21125
[Rank5] pid = 21189
[Rank6] pid = 21190
INFO [20534 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20933 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20997 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [21061 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [21125 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [21190 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [21189 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [21257 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [21257 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21189 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21125 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20997 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21190 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20534 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20933 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21061 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
I20240118 23:24:23.448788 20934 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240118 23:24:23.452491 21191 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.452533 21328 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.453086 21258 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.456970 21126 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.457242 20998 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.481703 21062 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240118 23:24:23.491940 21254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.131 ms                  | 28.526 ms                 |
| Forward                   | 15.510 ms                 | 32.421 ms                 |
| Backward                  | 11.271 ms                 | 46.186 ms                 |
| Optimize                  | 13.325 ms                 | 20.210 ms                 |
| OneStep                   | 55.420 ms                 | 88.352 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 2] 100 steps, total: 6.277, sample: 0.495, forward: 1.696, backward: 0.490, update: 1.337
[Rank7] pid = 21257
-------Step 0-------
tensor([ 2495,    34,  4282,    70, 11020, 13757,  1912,  7003, 11480, 10354]) tensor([ 2784,  8343,  5573, 12909, 13200,  1784,  6592,  6095,   956,  1316])
-------Step 1-------
tensor([ 2495,    34,  4282,    70, 11020, 13757,  1912,  7003, 11480, 10354]) tensor([11353, 13260, 14217, 13446,  1155,  2711,  8633,  1040,  3055, 11468])
-------Step 2-------
tensor([ 3713,  6701,  5993, 13609,  8115, 13548,  8523,    17,  4585,  3029]) tensor([ 5805,  6731,  4529,  6908,  3148, 14517,   355,  2057, 12874,  4302])
-------Step 3-------
tensor([ 3713,  6701,  5993, 13609,  8115, 13548,  8523,    17,  4585,  3029]) tensor([11656,   385,  8055, 14803,  8910,  8896, 10334,   843,  4497,  4986])
-------Step 4-------
tensor([11058,    76,   109,  4058,  6484, 13703,    57, 12888,  5225,   136]) tensor([ 4046,  9274, 14819,  2349,  1768,  8901,   626,  9095,  6341, 11543])
-------Step 5-------
tensor([11058,    76,   109,  4058,  6484, 13703,    57, 12888,  5225,   136]) tensor([ 5295,  5492,  2761, 14096, 10165,  9945, 13739,  6698,  3046,  8343])
-------Step 6-------
tensor([ 2187,  5306, 14513,  3755,    79,  7661, 10113,  1933, 12893,  1088]) tensor([11134,  4119, 13966,  9335,  1136, 12207, 14422,  9095, 13520, 14332])
-------Step 7-------
tensor([ 2187,  5306, 14513,  3755,    79,  7661, 10113,  1933, 12893,  1088]) tensor([ 3864,  9671,  7309, 14689,  6105,   155,  6272,  1651,  2885,  4597])
-------Step 8-------
tensor([ 2262,  7847,  7724, 14323,  5225,  3018, 10058,  4607,  2985,  5939]) tensor([  292,   315, 14380, 14268,  6150,  4827, 13964,   760,    15,  5908])
-------Step 9-------
tensor([ 2262,  7847,  7724, 14323,  5225,  3018, 10058,  4607,  2985,  5939]) tensor([   75, 11754, 14504, 12827,  5195,  8687,  1210, 12034,  7137,  8936])
[proc 0] 100 steps, total: 6.281, sample: 0.495, forward: 1.701, backward: 0.610, update: 1.386
[proc 3] 100 steps, total: 6.252, sample: 0.525, forward: 1.639, backward: 0.566, update: 1.412
[proc 1] 100 steps, total: 6.285, sample: 0.475, forward: 1.670, backward: 0.623, update: 1.297
[proc 7] 100 steps, total: 6.282, sample: 0.433, forward: 1.723, backward: 0.554, update: 1.318
[proc 5] 100 steps, total: 6.282, sample: 0.482, forward: 1.707, backward: 0.555, update: 1.342
[proc 6] 100 steps, total: 6.242, sample: 0.499, forward: 1.649, backward: 0.531, update: 1.448
[proc 4] 100 steps, total: 6.277, sample: 0.474, forward: 1.639, backward: 0.579, update: 1.504
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.149 ms                  | 30.298 ms                 |
| Forward                   | 15.414 ms                 | 23.511 ms                 |
| Backward                  | 11.207 ms                 | 12.840 ms                 |
| Optimize                  | 13.275 ms                 | 20.210 ms                 |
| OneStep                   | 53.102 ms                 | 87.738 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 5.658, sample: 0.466, forward: 1.321, backward: 0.276, update: 1.282
[proc 5] 200 steps, total: 5.658, sample: 0.504, forward: 1.345, backward: 0.259, update: 1.305
[proc 7] 200 steps, total: 5.658, sample: 0.501, forward: 1.301, backward: 0.198, update: 1.289
[proc 1] 200 steps, total: 5.658, sample: 0.392, forward: 1.355, backward: 0.273, update: 1.245
[proc 6] 200 steps, total: 5.658, sample: 0.483, forward: 1.240, backward: 0.273, update: 1.388
[proc 3] 200 steps, total: 5.658, sample: 0.432, forward: 1.287, backward: 0.294, update: 1.355
[proc 0] 200 steps, total: 5.658, sample: 0.399, forward: 1.312, backward: 0.295, update: 1.338
[proc 4] 200 steps, total: 5.658, sample: 0.526, forward: 1.348, backward: 0.286, update: 1.455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.214 ms                  | 32.300 ms                 |
| Forward                   | 15.393 ms                 | 23.511 ms                 |
| Backward                  | 11.191 ms                 | 12.840 ms                 |
| Optimize                  | 13.312 ms                 | 20.210 ms                 |
| OneStep                   | 53.102 ms                 | 87.738 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 5.697, sample: 0.479, forward: 1.370, backward: 0.294, update: 1.344
[proc 4] 300 steps, total: 5.697, sample: 0.507, forward: 1.289, backward: 0.274, update: 1.447
[proc 3] 300 steps, total: 5.697, sample: 0.519, forward: 1.262, backward: 0.272, update: 1.359
[proc 5] 300 steps, total: 5.697, sample: 0.503, forward: 1.336, backward: 0.235, update: 1.295
[proc 1] 300 steps, total: 5.697, sample: 0.487, forward: 1.291, backward: 0.274, update: 1.249
[proc 7] 300 steps, total: 5.697, sample: 0.518, forward: 1.409, backward: 0.224, update: 1.304
[proc 0] 300 steps, total: 5.697, sample: 0.522, forward: 1.321, backward: 0.285, update: 1.323
[proc 6] 300 steps, total: 5.697, sample: 0.500, forward: 1.202, backward: 0.278, update: 1.378
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.232 ms                  | 35.287 ms                 |
| Forward                   | 15.393 ms                 | 23.511 ms                 |
| Backward                  | 11.183 ms                 | 12.840 ms                 |
| Optimize                  | 13.316 ms                 | 20.210 ms                 |
| OneStep                   | 53.503 ms                 | 87.738 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 7] 400 steps, total: 5.522, sample: 0.520, forward: 1.340, backward: 0.282, update: 1.281
[proc 5] 400 steps, total: 5.522, sample: 0.466, forward: 1.308, backward: 0.275, update: 1.292
[proc 2] 400 steps, total: 5.522, sample: 0.460, forward: 1.393, backward: 0.268, update: 1.298
[proc 3] 400 steps, total: 5.522, sample: 0.410, forward: 1.242, backward: 0.277, update: 1.327
[proc 0] 400 steps, total: 5.522, sample: 0.438, forward: 1.362, backward: 0.285, update: 1.363
[proc 1] 400 steps, total: 5.522, sample: 0.416, forward: 1.300, backward: 0.276, update: 1.236
[proc 6] 400 steps, total: 5.522, sample: 0.508, forward: 1.223, backward: 0.277, update: 1.389
[proc 4] 400 steps, total: 5.523, sample: 0.459, forward: 1.278, backward: 0.273, update: 1.427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.215 ms                  | 32.300 ms                 |
| Forward                   | 15.361 ms                 | 24.206 ms                 |
| Backward                  | 11.180 ms                 | 12.840 ms                 |
| Optimize                  | 13.316 ms                 | 20.210 ms                 |
| OneStep                   | 53.209 ms                 | 84.504 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 5.669, sample: 0.489, forward: 1.297, backward: 0.278, update: 1.230
[proc 5] 500 steps, total: 5.669, sample: 0.507, forward: 1.353, backward: 0.278, update: 1.282
[proc 6] 500 steps, total: 5.669, sample: 0.502, forward: 1.204, backward: 0.279, update: 1.374
[proc 7] 500 steps, total: 5.669, sample: 0.473, forward: 1.345, backward: 0.282, update: 1.287
[proc 4] 500 steps, total: 5.669, sample: 0.531, forward: 1.225, backward: 0.276, update: 1.432
[proc 0] 500 steps, total: 5.669, sample: 0.497, forward: 1.311, backward: 0.272, update: 1.322
[proc 3] 500 steps, total: 5.669, sample: 0.518, forward: 1.260, backward: 0.287, update: 1.330
Successfully xmh. training takes 28.82915163040161 seconds
before call kg_cache_controller.StopThreads()
[proc 2] 500 steps, total: 5.669, sample: 0.510, forward: 1.322, backward: 0.280, update: 1.275
KGCacheControllerWrapperDummy.StopThreads
