WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 00:16:45.819368 17008 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_Freebase_12', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [17008 sampler.py:454] Start PreSampling
WARNING [17008 sampler.py:532] Before construct renumbering_dict
WARNING [17008 sampler.py:555] PreSampling done
W20240125 00:30:26.901691 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 00:30:26.901911 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 00:30:26.901943 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 00:30:26.901971 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 00:30:26.902000 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 00:30:26.902024 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 00:30:26.902047 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 00:30:26.902086 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 00:30:26.902108 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 00:30:26.902129 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 00:30:26.902160 17008 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 00:30:26.902180 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 00:30:26.902196 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 00:30:26.902333 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 00:30:26.902369 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 00:30:26.902392 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 00:30:26.902426 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 00:30:26.902448 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 00:30:26.902473 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 00:30:26.902498 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 00:30:26.902514 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 00:30:26.902537 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 00:30:26.902560 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 00:30:26.902578 17008 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 00:30:26.902593 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 00:30:26.902608 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 00:30:26.902654 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 00:30:26.902684 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 00:30:26.902701 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 00:30:26.902724 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 00:30:26.902743 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 00:30:26.902762 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 00:30:26.902781 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 00:30:26.902803 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 00:30:26.902822 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 00:30:26.902848 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 00:30:26.902864 17008 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 00:30:26.902879 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 00:30:26.902899 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 00:30:26.902941 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 00:30:26.902964 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 00:30:26.902985 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 00:30:26.903004 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 00:30:26.903021 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 00:30:26.903038 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 00:30:26.903057 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 00:30:26.903079 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 00:30:26.903096 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 00:30:26.903115 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 00:30:26.903131 17008 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 00:30:26.903144 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 00:30:26.903162 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 00:30:26.903196 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 00:30:26.903228 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 00:30:26.903245 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 00:30:26.903264 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 00:30:26.903281 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 00:30:26.903297 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 00:30:26.903321 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 00:30:26.903338 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 00:30:26.903358 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 00:30:26.903379 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 00:30:26.903398 17008 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 00:30:26.903412 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 00:30:26.903427 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 00:30:26.903470 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 00:30:26.903494 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 00:30:26.903517 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 00:30:26.903534 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 00:30:26.903551 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 00:30:26.903574 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 00:30:26.903592 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 00:30:26.903615 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 00:30:26.903635 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 00:30:26.903651 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 00:30:26.903672 17008 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 00:30:26.903687 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 00:30:26.903700 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 00:30:26.903733 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 00:30:26.903757 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 00:30:26.903774 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 00:30:26.903792 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 00:30:26.903817 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 00:30:26.903839 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 00:30:26.903858 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 00:30:26.903875 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 00:30:26.903894 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 00:30:26.903913 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 00:30:26.903930 17008 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 00:30:26.903949 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 00:30:26.903965 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 00:30:26.903999 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 00:30:26.904026 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 00:30:26.904043 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 00:30:26.904067 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 00:30:26.904089 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 00:30:26.904115 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 00:30:26.904134 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 00:30:26.904153 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 00:30:26.904175 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 00:30:26.904192 17008 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 00:30:26.904208 17008 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 00:30:26.904222 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 00:30:26.904234 17008 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 00:30:27.241259 17008 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 00:30:27.241425 17008 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302771,  4302794,  4302814,  ..., 58809040, 16042976, 24425669]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 998.615 seconds
[Rank1] pid = 31135
[Rank2] pid = 31236
[Rank3] pid = 31308
[Rank4] pid = 31388
[Rank5] pid = 31473
[Rank6] pid = 31557
INFO [17008 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [31135 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [31236 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [31308 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [31388 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [31473 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [31641 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [31557 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [31557 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31473 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31641 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31388 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31308 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31236 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31135 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [31557 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [17008 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [31308 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31135 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31236 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31473 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31641 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31388 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [17008 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 00:33:33.300657 31309 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.301509 31559 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.301724 31237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.301826 31389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.301915 31642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.302028 31705 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.302138 31136 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:33.302242 31475 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 00:33:39.344599 31705 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 00:33:39.812975 31475 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:40.763476 31237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:41.296257 31559 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:41.888003 31136 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:42.643221 31389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:42.814399 31309 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 00:33:43.000231 31642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.877 ms                 | 27.877 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.708 ms                 | 130.265 ms                |
| Forward                   | 8.235 ms                  | 510.407 ms                |
| Backward                  | 95.499 ms                 | 273.061 ms                |
| Optimize                  | 2.588 ms                  | 36.255 ms                 |
| BarrierTimeBeforeRank0    | 56.604 ms                 | 83.560 ms                 |
| BlockToStepN              | 41.698 us                 | 11.534 ms                 |
| OneStep                   | 181.470 ms                | 856.394 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.486 ms                  | 106.603 ms                |
| Forward                   | 8.246 ms                  | 14.520 ms                 |
| Backward                  | 89.417 ms                 | 273.061 ms                |
| Optimize                  | 2.579 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 53.988 ms                 | 80.925 ms                 |
| BlockToStepN              | 33.690 us                 | 4.232 ms                  |
| OneStep                   | 169.343 ms                | 298.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.347 ms                  | 106.603 ms                |
| Forward                   | 8.399 ms                  | 24.494 ms                 |
| Backward                  | 87.608 ms                 | 273.061 ms                |
| Optimize                  | 2.618 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 23.021 ms                 | 199.528 ms                |
| BlockToStepN              | 31.255 us                 | 13.095 ms                 |
| OneStep                   | 150.556 ms                | 654.480 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.690, sample: 1.197, forward: 2.090, backward: 11.190, update: 0.285
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.206, sample: 0.884, forward: 2.014, backward: 9.106, update: 0.215
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.615, sample: 0.933, forward: 2.062, backward: 9.666, update: 0.274
[Rank7] pid = 31641
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([  504233,    78685,   385077, 17846300,    78725,    78759,   504247,
           78810,    78855,    78913]) tensor([ 5302691,  9601327, 63600470, 65898887, 24097455,   257025, 21483010,
        68801682, 40396803, 54398848])
-------Step 1-------
tensor([  504233,    78685,   385077, 17846300,    78725,    78759,   504247,
           78810,    78855,    78913]) tensor([84782612, 22702645, 58410016, 55086221, 40699485, 15759118, 55614912,
          598067, 18902569, 54378248])
-------Step 2-------
tensor([   24119,   397052,   396564, 12843869,   160958,   160991,   161036,
          161081,   161112,   161166]) tensor([61739700, 25712985,  1337578, 36612635, 18986127, 19378167,  8392614,
        49419793, 74824200, 33789958])
-------Step 3-------
tensor([   24119,   397052,   396564, 12843869,   160958,   160991,   161036,
          161081,   161112,   161166]) tensor([22932705, 80911688, 83432292, 57007445, 83584625, 83931515, 58942480,
        30590711, 82131959, 13818092])
-------Step 4-------
tensor([  243407,   243439,   243480, 84401906,   243518,   243549,   243587,
          243626,   243686, 30035480]) tensor([77590941, 64689693, 62983780, 44320888,   189871,  4331994, 29772225,
        41021122, 78084563, 12486945])
-------Step 5-------
tensor([  243407,   243439,   243480, 84401906,   243518,   243549,   243587,
          243626,   243686, 30035480]) tensor([53935398, 51485981, 53192895,    21626, 74574100, 62216888, 48571351,
         1355045, 76827755, 25138683])
-------Step 6-------
tensor([ 7709011,  5802481,   326465, 42239479,   326508,   326554, 83270408,
        47458771,   326612,   326651]) tensor([31948436,   155452, 39591843, 20483473, 25776731, 43314039, 20748342,
        76137581, 79788207, 43897621])
-------Step 7-------
tensor([ 7709011,  5802481,   326465, 42239479,   326508,   326554, 83270408,
        47458771,   326612,   326651]) tensor([19169064, 10697181, 42558240, 13013691, 38496461, 43989358,  4314920,
        18740619, 46445691, 55766638])
-------Step 8-------
tensor([  387085,   387104, 84598158,   387123,   421273,   421294, 15066963,
          387138,   387152,   398992]) tensor([28673602, 36442796, 74684645,  5300329, 80242933,  6044313,  5722525,
        16706369, 64800357,  5600792])
-------Step 9-------
tensor([  387085,   387104, 84598158,   387123,   421273,   421294, 15066963,
          387138,   387152,   398992]) tensor([54068780, 31203531, 40200158, 80257918, 40079906, 75298371, 60686197,
        18431412, 20047122,  7996658])
before start barrier
start train
[proc 0] 100 steps, total: 16.502, sample: 1.273, forward: 1.376, backward: 9.326, update: 0.263
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 16.859, sample: 0.863, forward: 1.992, backward: 9.166, update: 0.278
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 16.688, sample: 1.023, forward: 2.069, backward: 10.129, update: 0.262
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.739, sample: 0.785, forward: 2.022, backward: 9.392, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 20.158, sample: 0.708, forward: 1.917, backward: 9.099, update: 0.274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.306 ms                  | 106.603 ms                |
| Forward                   | 8.494 ms                  | 24.494 ms                 |
| Backward                  | 87.743 ms                 | 273.061 ms                |
| Optimize                  | 2.617 ms                  | 7.964 ms                  |
| BarrierTimeBeforeRank0    | 31.985 ms                 | 199.528 ms                |
| BlockToStepN              | 31.255 us                 | 13.095 ms                 |
| OneStep                   | 150.556 ms                | 654.480 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.245 ms                  | 83.504 ms                 |
| Forward                   | 8.370 ms                  | 15.871 ms                 |
| Backward                  | 88.285 ms                 | 187.498 ms                |
| Optimize                  | 2.647 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 50.200 ms                 | 174.695 ms                |
| BlockToStepN              | 32.021 us                 | 11.534 ms                 |
| OneStep                   | 160.579 ms                | 371.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.991 ms                  | 83.504 ms                 |
| Forward                   | 8.352 ms                  | 15.871 ms                 |
| Backward                  | 90.688 ms                 | 187.498 ms                |
| Optimize                  | 2.636 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 51.607 ms                 | 199.528 ms                |
| BlockToStepN              | 30.655 us                 | 11.534 ms                 |
| OneStep                   | 161.637 ms                | 532.896 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 17.611, sample: 0.835, forward: 1.304, backward: 9.199, update: 0.230
[proc 4] 200 steps, total: 17.611, sample: 0.827, forward: 1.259, backward: 9.047, update: 0.229
[proc 3] 200 steps, total: 17.611, sample: 1.117, forward: 1.340, backward: 9.319, update: 0.271
[proc 0] 200 steps, total: 17.611, sample: 0.839, forward: 0.867, backward: 10.391, update: 0.242
[proc 6] 200 steps, total: 17.611, sample: 1.055, forward: 1.324, backward: 9.540, update: 0.204
[proc 7] 200 steps, total: 17.611, sample: 0.602, forward: 1.238, backward: 9.223, update: 0.242
[proc 1] 200 steps, total: 17.611, sample: 0.808, forward: 1.298, backward: 9.744, update: 0.197
[proc 2] 200 steps, total: 17.611, sample: 1.265, forward: 1.451, backward: 12.792, update: 0.243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.991 ms                  | 83.504 ms                 |
| Forward                   | 8.415 ms                  | 24.348 ms                 |
| Backward                  | 92.420 ms                 | 262.165 ms                |
| Optimize                  | 2.673 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 47.416 ms                 | 199.528 ms                |
| BlockToStepN              | 30.264 us                 | 11.534 ms                 |
| OneStep                   | 161.600 ms                | 532.896 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.121 ms                  | 83.504 ms                 |
| Forward                   | 8.535 ms                  | 24.348 ms                 |
| Backward                  | 94.106 ms                 | 262.165 ms                |
| Optimize                  | 2.697 ms                  | 4.734 ms                  |
| BarrierTimeBeforeRank0    | 33.559 ms                 | 199.528 ms                |
| BlockToStepN              | 30.264 us                 | 12.504 ms                 |
| OneStep                   | 161.400 ms                | 532.896 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.486 ms                  | 80.842 ms                 |
| Forward                   | 8.569 ms                  | 15.871 ms                 |
| Backward                  | 95.302 ms                 | 187.498 ms                |
| Optimize                  | 2.692 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 25.289 ms                 | 174.695 ms                |
| BlockToStepN              | 30.655 us                 | 12.504 ms                 |
| OneStep                   | 161.637 ms                | 371.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.168 ms                  | 80.842 ms                 |
| Forward                   | 8.513 ms                  | 15.871 ms                 |
| Backward                  | 94.942 ms                 | 221.117 ms                |
| Optimize                  | 2.692 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 39.825 ms                 | 174.695 ms                |
| BlockToStepN              | 31.244 us                 | 13.095 ms                 |
| OneStep                   | 161.472 ms                | 371.752 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 16.978, sample: 0.522, forward: 1.196, backward: 9.773, update: 0.233
[proc 0] 300 steps, total: 16.978, sample: 0.905, forward: 0.975, backward: 12.308, update: 0.245
[proc 7] 300 steps, total: 16.978, sample: 0.554, forward: 1.178, backward: 8.624, update: 0.255
[proc 3] 300 steps, total: 16.978, sample: 0.748, forward: 1.266, backward: 9.387, update: 0.227
[proc 4] 300 steps, total: 16.978, sample: 0.517, forward: 1.222, backward: 9.373, update: 0.221
[proc 2] 300 steps, total: 16.978, sample: 0.571, forward: 1.192, backward: 9.209, update: 0.234
[proc 5] 300 steps, total: 16.978, sample: 0.660, forward: 1.274, backward: 9.337, update: 0.226
[proc 6] 300 steps, total: 16.978, sample: 0.808, forward: 1.432, backward: 11.111, update: 0.210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.967 ms                  | 80.842 ms                 |
| Forward                   | 8.513 ms                  | 24.348 ms                 |
| Backward                  | 95.463 ms                 | 221.117 ms                |
| Optimize                  | 2.686 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 46.563 ms                 | 195.691 ms                |
| BlockToStepN              | 30.655 us                 | 13.095 ms                 |
| OneStep                   | 161.802 ms                | 371.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.861 ms                  | 78.729 ms                 |
| Forward                   | 8.537 ms                  | 15.871 ms                 |
| Backward                  | 95.464 ms                 | 187.498 ms                |
| Optimize                  | 2.684 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 47.251 ms                 | 174.695 ms                |
| BlockToStepN              | 29.899 us                 | 13.095 ms                 |
| OneStep                   | 161.472 ms                | 325.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.904 ms                  | 78.729 ms                 |
| Forward                   | 8.624 ms                  | 15.871 ms                 |
| Backward                  | 94.664 ms                 | 187.498 ms                |
| Optimize                  | 2.679 ms                  | 4.533 ms                  |
| BarrierTimeBeforeRank0    | 40.315 ms                 | 174.695 ms                |
| BlockToStepN              | 29.899 us                 | 13.690 ms                 |
| OneStep                   | 160.443 ms                | 325.131 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 15.259, sample: 0.627, forward: 1.154, backward: 8.989, update: 0.213
[proc 2] 400 steps, total: 15.259, sample: 0.605, forward: 1.245, backward: 9.042, update: 0.224
[proc 3] 400 steps, total: 15.259, sample: 0.733, forward: 1.618, backward: 9.917, update: 0.244
[proc 7] 400 steps, total: 15.259, sample: 0.603, forward: 1.238, backward: 9.295, update: 0.255
[proc 5] 400 steps, total: 15.259, sample: 0.534, forward: 1.203, backward: 9.332, update: 0.216
[proc 0] 400 steps, total: 15.259, sample: 0.775, forward: 0.912, backward: 9.228, update: 0.234
[proc 6] 400 steps, total: 15.259, sample: 0.703, forward: 1.499, backward: 11.395, update: 0.260
[proc 1] 400 steps, total: 15.259, sample: 0.708, forward: 1.428, backward: 9.605, update: 0.246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.904 ms                  | 78.729 ms                 |
| Forward                   | 8.668 ms                  | 15.871 ms                 |
| Backward                  | 93.779 ms                 | 221.117 ms                |
| Optimize                  | 2.664 ms                  | 4.649 ms                  |
| BarrierTimeBeforeRank0    | 34.086 ms                 | 174.695 ms                |
| BlockToStepN              | 30.130 us                 | 13.690 ms                 |
| OneStep                   | 159.827 ms                | 325.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.867 ms                  | 76.930 ms                 |
| Forward                   | 8.715 ms                  | 16.336 ms                 |
| Backward                  | 93.900 ms                 | 187.498 ms                |
| Optimize                  | 2.681 ms                  | 4.734 ms                  |
| BarrierTimeBeforeRank0    | 31.497 ms                 | 174.104 ms                |
| BlockToStepN              | 29.900 us                 | 13.690 ms                 |
| OneStep                   | 158.783 ms                | 315.114 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 500 steps, total: 13.603, sample: 0.498, forward: 1.370, backward: 9.087, update: 0.216
[proc 6] 500 steps, total: 13.603, sample: 0.663, forward: 1.519, backward: 9.530, update: 0.224
[proc 4] 500 steps, total: 13.603, sample: 0.681, forward: 1.304, backward: 8.887, update: 0.220
[proc 3] 500 steps, total: 13.603, sample: 0.901, forward: 1.596, backward: 9.770, update: 0.237
[proc 5] 500 steps, total: 13.603, sample: 0.682, forward: 1.417, backward: 9.280, update: 0.256
[proc 2] 500 steps, total: 13.603, sample: 0.712, forward: 1.463, backward: 9.389, update: 0.230
[proc 1] 500 steps, total: 13.603, sample: 0.797, forward: 1.498, backward: 9.330, update: 0.247
[proc 0] 500 steps, total: 13.604, sample: 0.714, forward: 0.969, backward: 9.434, update: 0.275
Successfully xmh. training takes 79.95484161376953 seconds
before call kg_cache_controller.StopThreads()
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
INFO [17008 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.904 ms                  | 76.930 ms                 |
| Forward                   | 8.758 ms                  | 16.336 ms                 |
| Backward                  | 93.758 ms                 | 187.498 ms                |
| Optimize                  | 2.693 ms                  | 4.893 ms                  |
| BarrierTimeBeforeRank0    | 26.706 ms                 | 174.104 ms                |
| BlockToStepN              | 29.012 us                 | 13.690 ms                 |
| OneStep                   | 157.316 ms                | 315.114 ms                |
+---------------------------+---------------------------+---------------------------+
