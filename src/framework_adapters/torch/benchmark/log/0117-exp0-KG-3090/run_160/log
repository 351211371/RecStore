WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 01:21:17.093875 12868 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_Freebase_15', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [12868 sampler.py:454] Start PreSampling
WARNING [12868 sampler.py:532] Before construct renumbering_dict
WARNING [12868 sampler.py:555] PreSampling done
W20240125 01:34:43.635982 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 01:34:43.636193 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 01:34:43.636224 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 01:34:43.636253 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 01:34:43.636281 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 01:34:43.636312 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 01:34:43.636337 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 01:34:43.636363 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 01:34:43.636391 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 01:34:43.636412 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 01:34:43.636440 12868 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 01:34:43.636459 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 01:34:43.636477 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 01:34:43.636616 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 01:34:43.636643 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 01:34:43.636662 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 01:34:43.636696 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 01:34:43.636716 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 01:34:43.636741 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 01:34:43.636763 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 01:34:43.636781 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 01:34:43.636816 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 01:34:43.636844 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 01:34:43.636866 12868 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 01:34:43.636881 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 01:34:43.636894 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 01:34:43.636940 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 01:34:43.636963 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 01:34:43.636979 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 01:34:43.636999 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 01:34:43.637019 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 01:34:43.637045 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 01:34:43.637063 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 01:34:43.637085 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 01:34:43.637104 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 01:34:43.637126 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 01:34:43.637142 12868 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 01:34:43.637158 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 01:34:43.637171 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 01:34:43.637213 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 01:34:43.637243 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 01:34:43.637264 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 01:34:43.637284 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 01:34:43.637302 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 01:34:43.637328 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 01:34:43.637347 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 01:34:43.637364 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 01:34:43.637382 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 01:34:43.637399 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 01:34:43.637418 12868 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 01:34:43.637432 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 01:34:43.637445 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 01:34:43.637483 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 01:34:43.637512 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 01:34:43.637538 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 01:34:43.637555 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 01:34:43.637578 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 01:34:43.637598 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 01:34:43.637617 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 01:34:43.637635 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 01:34:43.637657 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 01:34:43.637681 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 01:34:43.637698 12868 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 01:34:43.637714 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 01:34:43.637727 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 01:34:43.637763 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 01:34:43.637782 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 01:34:43.637800 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 01:34:43.637816 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 01:34:43.637835 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 01:34:43.637852 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 01:34:43.637872 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 01:34:43.637889 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 01:34:43.637912 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 01:34:43.637933 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 01:34:43.637950 12868 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 01:34:43.637964 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 01:34:43.637977 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 01:34:43.638010 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 01:34:43.638027 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 01:34:43.638049 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 01:34:43.638068 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 01:34:43.638087 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 01:34:43.638104 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 01:34:43.638120 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 01:34:43.638139 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 01:34:43.638159 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 01:34:43.638181 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 01:34:43.638199 12868 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 01:34:43.638221 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 01:34:43.638234 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 01:34:43.638273 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 01:34:43.638293 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 01:34:43.638310 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 01:34:43.638326 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 01:34:43.638343 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 01:34:43.638363 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 01:34:43.638386 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 01:34:43.638403 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 01:34:43.638422 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 01:34:43.638443 12868 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 01:34:43.638464 12868 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 01:34:43.638478 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 01:34:43.638492 12868 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 01:34:43.977035 12868 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 01:34:43.977205 12868 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302706,  4302788,  4302811,  ..., 51110863, 18381351, 28465600]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1031.997 seconds
[Rank1] pid = 27609
[Rank2] pid = 27711
[Rank3] pid = 27799
[Rank4] pid = 27892
[Rank5] pid = 27976
[Rank6] pid = 28058
INFO [12868 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [27609 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [27799 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [27711 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [27976 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [27892 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [28142 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [28058 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [28142 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28058 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27976 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27892 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27711 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27799 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12868 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27609 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 01:38:40.485442 28206 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240125 01:38:40.487042 28143 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240125 01:38:40.487649 27712 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240125 01:38:40.487669 27610 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240125 01:38:40.487772 27977 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240125 01:38:40.487778 28060 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240125 01:38:40.487784 27800 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240125 01:38:40.487864 27893 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240125 01:38:40.636298 27977 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x10202724d000 781.2 kB
W20240125 01:38:40.636719 28206 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027316000 781.2 kB
W20240125 01:38:40.636730 28060 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x1020273db000 781.2 kB
W20240125 01:38:40.636816 27977 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x1020274a0000 781.2 kB
W20240125 01:38:40.636868 27800 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x102027565000 781.2 kB
W20240125 01:38:40.636891 28143 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10202762a000 781.2 kB
W20240125 01:38:40.636967 27893 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102027879000 781.2 kB
W20240125 01:38:40.636961 27712 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020277b4000 781.2 kB
W20240125 01:38:40.636952 27610 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020276ef000 781.2 kB
W20240125 01:38:40.637030 27977 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10202793e000 152.6 MB
W20240125 01:38:40.637120 27977 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x1020311d6000 152.6 MB
W20240125 01:38:40.637208 27977 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 01:38:40.638000 28206 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x10203aa6e000 781.2 kB
W20240125 01:38:40.638063 28143 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10203abf8000 781.2 kB
W20240125 01:38:40.638060 27800 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10203ab33000 781.2 kB
W20240125 01:38:40.638128 27893 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10203acbf000 781.2 kB
W20240125 01:38:40.638164 28206 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10203ad84000 152.6 MB
W20240125 01:38:40.638172 28143 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10204461c000 152.6 MB
W20240125 01:38:40.638203 27977 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 01:38:40.638198 28060 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10204deb4000 781.2 kB
W20240125 01:38:40.638228 27800 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10204df79000 152.6 MB
W20240125 01:38:40.638242 28143 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x102057811000 152.6 MB
W20240125 01:38:40.638288 27893 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x10206116e000 152.6 MB
W20240125 01:38:40.638284 27712 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x1020610a9000 781.2 kB
W20240125 01:38:40.638339 28206 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10206aa06000 152.6 MB
W20240125 01:38:40.638348 27800 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10207429e000 152.6 MB
W20240125 01:38:40.638387 28060 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10207db36000 152.6 MB
W20240125 01:38:40.638401 27893 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1020873ce000 152.6 MB
W20240125 01:38:40.638434 28206 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 01:38:40.638476 27712 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102090d2b000 152.6 MB
W20240125 01:38:40.638463 27610 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102090c66000 781.2 kB
W20240125 01:38:40.638504 28060 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10209a5c3000 152.6 MB
W20240125 01:38:40.638564 27712 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020a3e5b000 152.6 MB
W20240125 01:38:40.638612 28060 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 01:38:40.638727 27610 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x1020ad6f3000 152.6 MB
W20240125 01:38:40.638757 27800 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 01:38:40.638875 27610 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1020b6f8b000 152.6 MB
W20240125 01:38:40.639175 27893 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 01:38:40.639271 28143 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 01:38:40.640300 27712 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 01:38:40.640306 27610 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 01:38:40.643538 28206 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 01:38:40.643834 28060 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 01:38:40.643858 27800 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 01:38:40.643983 27893 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 01:38:40.644515 28143 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 01:38:40.644519 27712 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 01:38:40.644532 27610 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [28058 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [27976 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [28142 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 28142
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [12868 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [27609 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [27799 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [27711 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [27892 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 01:39:30.297428 27893 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.297973 27800 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298027 28143 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298069 27610 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298100 28060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298154 27977 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298207 28206 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 01:39:30.298242 27712 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240125 01:39:30.300096 28143 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 01:39:30.300271 28143 grad_base.h:172] Init GradProcessingBase done
I20240125 01:39:42.473803 28143 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 01:39:42.474009 28143 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 01:39:42.474015 28143 kg_controller.h:84] Construct KGCacheController done
I20240125 01:39:43.382843 28143 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 01:40:13.007462 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:40:13.008162 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:14.100837 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:40:14.100970 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:15.555723 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:40:15.555847 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:16.614089 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:40:16.614573 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:18.680955 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:40:18.681306 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:21.137357 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:40:21.154501 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 01:40:21.264870 28206 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
W20240125 01:40:24.652981 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:40:24.672367 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 01:40:24.801174 27977 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 01:40:25.672869 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:25.678388 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
I20240125 01:40:25.722774 28060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 01:40:27.305591 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:40:27.323601 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 01:40:27.441198 27800 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 01:40:28.144181 27893 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 01:40:28.324812 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:28.351091 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
I20240125 01:40:29.012938 27712 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 01:40:29.325779 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:30.331558 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:40:30.348534 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 01:40:30.456283 27610 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 01:40:31.613847 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:40:31.642143 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 01:40:31.706182 28143 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 01:40:32.653390 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:32.655208 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.466 ms                 | 21.466 ms                 |
| Forward                   | 1.522 s                   | 1.522 s                   |
| Backward                  | 302.338 ms                | 302.338 ms                |
| Optimize                  | 101.414 ms                | 101.414 ms                |
| BarrierTimeBeforeRank0    | 110.413 us                | 110.413 us                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:35.439425 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 01:40:35.755674 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 01:40:35.988279 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:40:36.107036 29439 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
E20240125 01:40:36.440829 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=881
W20240125 01:40:36.781347 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240125 01:40:37.160723 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 01:40:37.385056 28143 grad_async_v2.h:236] pq is empty
E20240125 01:40:37.450838 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:37.970537 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240125 01:40:38.193414 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 27.580 ms                 | 695.927 ms                |
| ProcessBack:UpdateCache   | 29.028 ms                 | 1.073 s                   |
| ProcessBack:UpsertPq      | 204.334 ms                | 381.071 ms                |
| ProcessOneStep            | 421.896 ms                | 2.101 s                   |
| BlockToStepN              | 141.225 ms                | 217.205 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:38.457126 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240125 01:40:38.501093 28143 grad_async_v2.h:236] pq is empty
W20240125 01:40:39.346706 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240125 01:40:39.401826 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 01:40:39.457007 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=54852
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.941 ms                 | 340.604 ms                |
| Forward                   | 21.460 ms                 | 1.522 s                   |
| Backward                  | 11.791 ms                 | 302.338 ms                |
| Optimize                  | 2.274 ms                  | 101.414 ms                |
| BarrierTimeBeforeRank0    | 67.986 us                 | 92.392 ms                 |
| AfterBackward             | 270.813 ms                | 2.101 s                   |
| BlockToStepN              | 16.189 ms                 | 220.852 ms                |
| OneStep                   | 560.339 ms                | 4.279 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:40.457010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=26820
W20240125 01:40:40.571915 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:40:40.571979 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
E20240125 01:40:41.460886 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=44922
W20240125 01:40:41.699821 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
W20240125 01:40:41.798159 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=12, pq.top=11
E20240125 01:40:42.460822 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:42.852595 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240125 01:40:42.869436 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.373 ms                 | 695.927 ms                |
| ProcessBack:UpdateCache   | 18.614 ms                 | 1.073 s                   |
| ProcessBack:UpsertPq      | 120.759 ms                | 420.683 ms                |
| ProcessOneStep            | 200.221 ms                | 2.101 s                   |
| BlockToStepN              | 35.358 ms                 | 361.907 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:43.460017 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=434
W20240125 01:40:43.869022 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240125 01:40:43.973222 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
E20240125 01:40:44.460012 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=7747
W20240125 01:40:45.008986 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 01:40:45.073180 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.315 ms                 | 340.604 ms                |
| Forward                   | 19.519 ms                 | 1.522 s                   |
| Backward                  | 8.233 ms                  | 302.338 ms                |
| Optimize                  | 2.445 ms                  | 101.414 ms                |
| BarrierTimeBeforeRank0    | 60.397 us                 | 92.392 ms                 |
| AfterBackward             | 200.316 ms                | 2.101 s                   |
| BlockToStepN              | 35.481 ms                 | 362.065 ms                |
| OneStep                   | 501.376 ms                | 4.279 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:45.464823 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=60135
W20240125 01:40:46.193596 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240125 01:40:46.224268 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=23
E20240125 01:40:46.471571 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5484
W20240125 01:40:47.206223 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240125 01:40:47.236928 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240125 01:40:47.471009 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=14361
W20240125 01:40:48.240904 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240125 01:40:48.324110 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.025 ms                 | 694.065 ms                |
| ProcessBack:UpdateCache   | 18.614 ms                 | 1.059 s                   |
| ProcessBack:UpsertPq      | 70.583 ms                 | 410.667 ms                |
| ProcessOneStep            | 155.920 ms                | 2.101 s                   |
| BlockToStepN              | 35.358 ms                 | 361.907 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:48.472884 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=38145
W20240125 01:40:49.245970 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240125 01:40:49.324043 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
E20240125 01:40:49.498850 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2900
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.466 ms                 | 340.604 ms                |
| Forward                   | 12.144 ms                 | 1.522 s                   |
| Backward                  | 8.233 ms                  | 302.338 ms                |
| Optimize                  | 2.445 ms                  | 101.414 ms                |
| BarrierTimeBeforeRank0    | 67.986 us                 | 92.392 ms                 |
| AfterBackward             | 155.965 ms                | 2.101 s                   |
| BlockToStepN              | 52.274 ms                 | 362.065 ms                |
| OneStep                   | 484.088 ms                | 4.279 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:40:50.324056 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=33, pq.top=33
E20240125 01:40:50.503093 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:50.544407 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
W20240125 01:40:51.330442 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=36
E20240125 01:40:51.503132 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240125 01:40:51.650527 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end7
E20240125 01:40:52.504817 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:40:52.627609 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240125 01:40:52.723776 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.169 ms                 | 694.065 ms                |
| ProcessBack:UpdateCache   | 17.561 ms                 | 1.059 s                   |
| ProcessBack:UpsertPq      | 69.980 ms                 | 410.667 ms                |
| ProcessOneStep            | 146.857 ms                | 2.101 s                   |
| BlockToStepN              | 100.414 ms                | 361.907 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:53.504010 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=6938
W20240125 01:40:53.627034 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240125 01:40:53.972981 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
E20240125 01:40:54.504012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=52944
W20240125 01:40:54.777351 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=44, pq.top=44
W20240125 01:40:55.189157 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.466 ms                 | 340.604 ms                |
| Forward                   | 6.588 ms                  | 1.522 s                   |
| Backward                  | 7.848 ms                  | 302.338 ms                |
| Optimize                  | 2.416 ms                  | 101.414 ms                |
| BarrierTimeBeforeRank0    | 67.986 us                 | 174.271 ms                |
| AfterBackward             | 151.539 ms                | 2.101 s                   |
| BlockToStepN              | 104.406 ms                | 362.065 ms                |
| OneStep                   | 462.343 ms                | 4.279 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:55.504012 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=55620
W20240125 01:40:56.125608 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240125 01:40:56.190461 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end7
E20240125 01:40:56.507117 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3559
W20240125 01:40:57.131341 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240125 01:40:57.527560 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5815
W20240125 01:40:57.853346 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240125 01:40:58.136863 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.162 ms                 | 694.065 ms                |
| ProcessBack:UpdateCache   | 17.114 ms                 | 1.059 s                   |
| ProcessBack:UpsertPq      | 83.913 ms                 | 410.667 ms                |
| ProcessOneStep            | 155.920 ms                | 464.036 ms                |
| BlockToStepN              | 118.224 ms                | 344.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:40:58.527010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5503
W20240125 01:40:59.033003 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240125 01:40:59.527182 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=121
W20240125 01:40:59.937808 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.291 ms                 | 331.020 ms                |
| Forward                   | 6.437 ms                  | 158.186 ms                |
| Backward                  | 5.389 ms                  | 30.619 ms                 |
| Optimize                  | 2.416 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 67.986 us                 | 92.392 ms                 |
| AfterBackward             | 152.932 ms                | 464.162 ms                |
| BlockToStepN              | 118.456 ms                | 344.821 ms                |
| OneStep                   | 468.061 ms                | 954.517 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:00.443435 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
E20240125 01:41:00.528118 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=39
W20240125 01:41:01.495448 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240125 01:41:01.530483 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240125 01:41:02.530020 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=437
W20240125 01:41:02.554955 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
W20240125 01:41:02.957577 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=58, pq.top=58
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.169 ms                 | 694.065 ms                |
| ProcessBack:UpdateCache   | 17.093 ms                 | 1.059 s                   |
| ProcessBack:UpsertPq      | 83.913 ms                 | 410.667 ms                |
| ProcessOneStep            | 155.920 ms                | 1.996 s                   |
| BlockToStepN              | 104.255 ms                | 344.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:03.548833 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=50751
W20240125 01:41:03.650766 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 01:41:03.957079 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=60, pq.top=60
E20240125 01:41:04.548015 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=65520
W20240125 01:41:04.718647 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:41:05.133116 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.291 ms                 | 331.020 ms                |
| Forward                   | 6.588 ms                  | 158.186 ms                |
| Backward                  | 5.388 ms                  | 30.619 ms                 |
| Optimize                  | 2.416 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 67.986 us                 | 92.392 ms                 |
| AfterBackward             | 152.932 ms                | 1.996 s                   |
| BlockToStepN              | 140.051 ms                | 344.821 ms                |
| OneStep                   | 462.343 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:05.548038 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=6430
W20240125 01:41:05.759557 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 01:41:06.133019 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240125 01:41:06.552837 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=10738
W20240125 01:41:06.810640 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 01:41:07.137785 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=67, pq.top=67
E20240125 01:41:07.556809 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2723
W20240125 01:41:07.875098 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:41:08.255055 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.162 ms                 | 694.065 ms                |
| ProcessBack:UpdateCache   | 16.901 ms                 | 1.059 s                   |
| ProcessBack:UpsertPq      | 74.884 ms                 | 410.667 ms                |
| ProcessOneStep            | 146.857 ms                | 1.996 s                   |
| BlockToStepN              | 141.777 ms                | 361.907 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:08.556835 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:41:08.952855 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 01:41:09.255015 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
E20240125 01:41:09.556016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=725
W20240125 01:41:09.985738 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 20.662 ms                 | 340.604 ms                |
| Forward                   | 5.833 ms                  | 158.186 ms                |
| Backward                  | 5.246 ms                  | 30.619 ms                 |
| Optimize                  | 2.340 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 60.397 us                 | 92.392 ms                 |
| AfterBackward             | 146.942 ms                | 1.996 s                   |
| BlockToStepN              | 153.302 ms                | 362.065 ms                |
| OneStep                   | 467.998 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:10.367516 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240125 01:41:10.556011 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=21026
W20240125 01:41:11.015239 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 01:41:11.564813 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=26004
W20240125 01:41:11.573081 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240125 01:41:12.111768 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:41:12.572897 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=10675
W20240125 01:41:12.573153 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240125 01:41:13.114503 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.162 ms                 | 141.048 ms                |
| ProcessBack:UpdateCache   | 15.177 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 71.439 ms                 | 381.071 ms                |
| ProcessOneStep            | 146.857 ms                | 1.996 s                   |
| BlockToStepN              | 161.332 ms                | 437.358 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:13.572012 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
W20240125 01:41:13.573640 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240125 01:41:14.115705 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:41:14.593025 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=73460
W20240125 01:41:14.780675 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240125 01:41:15.162815 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.466 ms                 | 340.604 ms                |
| Forward                   | 6.316 ms                  | 158.186 ms                |
| Backward                  | 5.246 ms                  | 30.619 ms                 |
| Optimize                  | 2.325 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 58.581 us                 | 92.392 ms                 |
| AfterBackward             | 146.942 ms                | 1.996 s                   |
| BlockToStepN              | 153.302 ms                | 667.008 ms                |
| OneStep                   | 467.998 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:15.593012 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=6912
W20240125 01:41:16.100615 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240125 01:41:16.208513 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 01:41:16.593379 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
W20240125 01:41:17.461380 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:41:17.596817 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=9218
W20240125 01:41:17.720196 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.068 ms                 | 141.048 ms                |
| ProcessBack:UpdateCache   | 15.177 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 74.692 ms                 | 381.071 ms                |
| ProcessOneStep            | 149.064 ms                | 1.996 s                   |
| BlockToStepN              | 161.332 ms                | 666.859 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:18.596015 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=706
W20240125 01:41:18.598145 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:41:18.720074 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
E20240125 01:41:19.596025 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=34400
W20240125 01:41:19.641420 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:41:20.267525 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.905 ms                 | 632.526 ms                |
| Forward                   | 5.781 ms                  | 158.186 ms                |
| Backward                  | 5.109 ms                  | 30.619 ms                 |
| Optimize                  | 2.298 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 45.519 us                 | 108.865 ms                |
| AfterBackward             | 152.261 ms                | 1.996 s                   |
| BlockToStepN              | 153.302 ms                | 667.008 ms                |
| OneStep                   | 462.343 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:20.596827 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=58380
W20240125 01:41:20.683806 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 01:41:21.269884 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
E20240125 01:41:21.596057 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=4267
W20240125 01:41:21.690999 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
W20240125 01:41:22.269209 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240125 01:41:22.600857 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=59941
W20240125 01:41:22.763370 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.248 ms                 | 141.048 ms                |
| ProcessBack:UpdateCache   | 15.006 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 74.884 ms                 | 381.071 ms                |
| ProcessOneStep            | 151.233 ms                | 1.996 s                   |
| BlockToStepN              | 161.332 ms                | 666.859 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:23.489100 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=99, pq.top=99
E20240125 01:41:23.607812 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=29914
W20240125 01:41:23.800367 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 58.336, sample: 2.263, forward: 1.960, backward: 1.251, update: 0.348
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.914, sample: 1.853, forward: 1.756, backward: 1.191, update: 0.317
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.602, sample: 1.826, forward: 1.977, backward: 1.157, update: 0.310
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 62.793, sample: 2.964, forward: 1.925, backward: 1.122, update: 0.304
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 59.257, sample: 2.387, forward: 1.741, backward: 1.174, update: 0.276
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 56.617, sample: 1.681, forward: 1.878, backward: 1.093, update: 0.289
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 55.045, sample: 2.223, forward: 1.969, backward: 1.218, update: 0.377
train_sampler.Prefill()
-------Step 0-------
tensor([  6247,  20236, 259646,  20287,  20329,  20375,   6266,  20431,  20481,
         20542]) tensor([ 5346564, 12275967, 56969271, 49574418, 20062454,   156333, 19119230,
        60964768, 46692450,  1842971])
-------Step 1-------
tensor([  6247,  20236, 259646,  20287,  20329,  20375,   6266,  20431,  20481,
         20542]) tensor([47638245, 38015158, 40872763,   409352,  1099860, 51604960, 46236381,
         1190596, 71789673, 33679234])
-------Step 2-------
tensor([  148765,   148810,   148861,   148913,   148968, 47856491, 76613175,
          149005, 42069253,   149065]) tensor([64618798, 46357119, 23803989,  9918060, 33316437, 37950551, 53335919,
        45576201, 81284696, 16167662])
-------Step 3-------
tensor([  148765,   148810,   148861,   148913,   148968, 47856491, 76613175,
          149005, 42069253,   149065]) tensor([78720370, 60023296, 48668724, 44344970, 13453280, 72400290, 72104230,
        13533121, 75775141,   151027])
-------Step 4-------
tensor([   93225,   276457,   276516,  4337876,   276574,   276627,   276680,
        16185883,   276750,   276799]) tensor([29313641, 24568660, 75030077, 40289391, 10334298, 15441870, 39210511,
        13638227, 64981521, 84476207])
-------Step 5-------
tensor([   93225,   276457,   276516,  4337876,   276574,   276627,   276680,
        16185883,   276750,   276799]) tensor([  951986, 55854761,  6306681, 41435633, 39140476, 78607321, 36526687,
        24018360, 60610625, 46637326])
-------Step 6-------
tensor([104002, 389966, 389990,  35295,  35320, 390015,  35340, 390041, 390070,
         20928]) tensor([11696432, 77893089, 25788092, 57021150, 26170806, 48041663, 19997387,
        23411040, 25236218, 68322571])
-------Step 7-------
tensor([104002, 389966, 389990,  35295,  35320, 390015,  35340, 390041, 390070,
         20928]) tensor([46424751, 40504172, 53404408, 71521316, 32762880,  2030378, 53736600,
        83635962, 84996487, 66922479])
-------Step 8-------
tensor([  446882,  6280741,   446902,   114792,  8120734,   446924, 22685755,
           45043,    45064,   446949]) tensor([ 1252648, 39674639, 63784770,  5918475, 58205630, 37285047,  5069713,
        64749392, 60205991, 56877096])
-------Step 9-------
tensor([  446882,  6280741,   446902,   114792,  8120734,   446924, 22685755,
           45043,    45064,   446949]) tensor([64705492, 25818037, 12634735, 82333804,  7047904, 37968654, 52587021,
        63280634, 23574793, 21302019])
before start barrier
start train
[proc 0] 100 steps, total: 52.352, sample: 6.017, forward: 2.787, backward: 1.109, update: 0.574
W20240125 01:41:24.489110 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240125 01:41:24.620811 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=35184
W20240125 01:41:24.826792 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.154 ms                 | 632.526 ms                |
| Forward                   | 6.316 ms                  | 158.186 ms                |
| Backward                  | 5.093 ms                  | 30.619 ms                 |
| Optimize                  | 2.299 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 41.991 us                 | 108.865 ms                |
| AfterBackward             | 151.539 ms                | 1.996 s                   |
| BlockToStepN              | 166.548 ms                | 667.008 ms                |
| OneStep                   | 468.061 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:25.620013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=68
W20240125 01:41:25.838869 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 01:41:26.276999 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240125 01:41:26.690860 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:41:26.838068 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 01:41:27.276185 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=105, pq.top=105
E20240125 01:41:27.699748 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=77702
W20240125 01:41:27.880384 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240125 01:41:28.276221 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.574 ms                 | 141.048 ms                |
| ProcessBack:UpdateCache   | 14.410 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 73.018 ms                 | 381.071 ms                |
| ProcessOneStep            | 149.992 ms                | 1.996 s                   |
| BlockToStepN              | 161.332 ms                | 666.859 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:28.700858 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=68905
W20240125 01:41:28.902743 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 01:41:29.341938 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
E20240125 01:41:29.700184 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=70867
W20240125 01:41:29.938079 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.087 ms                 | 635.407 ms                |
| Forward                   | 6.461 ms                  | 158.186 ms                |
| Backward                  | 5.093 ms                  | 30.619 ms                 |
| Optimize                  | 2.325 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 43.913 us                 | 108.865 ms                |
| AfterBackward             | 150.080 ms                | 1.996 s                   |
| BlockToStepN              | 161.529 ms                | 688.495 ms                |
| OneStep                   | 468.061 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:30.341084 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240125 01:41:30.700830 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=72266
W20240125 01:41:31.037318 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:41:31.341224 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240125 01:41:31.700011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=83067
W20240125 01:41:32.092041 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 01:41:32.341472 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240125 01:41:32.700428 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=61629
W20240125 01:41:33.137490 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240125 01:41:33.341070 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.973 ms                 | 141.048 ms                |
| ProcessBack:UpdateCache   | 14.790 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 73.018 ms                 | 381.071 ms                |
| ProcessOneStep            | 149.992 ms                | 1.996 s                   |
| BlockToStepN              | 166.352 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:33.700011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=677
W20240125 01:41:34.206020 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 01:41:34.341159 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240125 01:41:34.708861 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=43506
W20240125 01:41:35.210368 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.087 ms                 | 635.407 ms                |
| Forward                   | 6.080 ms                  | 158.186 ms                |
| Backward                  | 5.030 ms                  | 30.619 ms                 |
| Optimize                  | 2.323 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 44.623 us                 | 108.865 ms                |
| AfterBackward             | 149.112 ms                | 1.996 s                   |
| BlockToStepN              | 166.548 ms                | 688.495 ms                |
| OneStep                   | 468.061 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:35.400565 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
E20240125 01:41:35.708850 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=59436
W20240125 01:41:36.263952 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:41:36.400127 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=123, pq.top=123
E20240125 01:41:36.708014 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=62248
W20240125 01:41:37.400141 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240125 01:41:37.446447 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 01:41:37.731041 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.643 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.790 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 77.314 ms                 | 374.899 ms                |
| ProcessOneStep            | 151.478 ms                | 1.996 s                   |
| BlockToStepN              | 168.551 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:38.400214 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240125 01:41:38.480783 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 01:41:38.731011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3912
W20240125 01:41:39.499001 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
W20240125 01:41:39.557300 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=130
E20240125 01:41:39.731014 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=4260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.409 ms                 | 635.407 ms                |
| Forward                   | 5.774 ms                  | 158.186 ms                |
| Backward                  | 5.030 ms                  | 30.619 ms                 |
| Optimize                  | 2.299 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 41.991 us                 | 108.865 ms                |
| AfterBackward             | 151.296 ms                | 1.996 s                   |
| BlockToStepN              | 168.731 ms                | 688.495 ms                |
| OneStep                   | 476.349 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:40.557269 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
E20240125 01:41:40.731011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=349
W20240125 01:41:40.759284 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240125 01:41:41.573945 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=134, pq.top=133
E20240125 01:41:41.742794 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=4483
W20240125 01:41:41.760190 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240125 01:41:42.584354 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240125 01:41:42.748862 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=47039
W20240125 01:41:42.953181 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.428 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.790 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 75.725 ms                 | 374.899 ms                |
| ProcessOneStep            | 151.478 ms                | 1.996 s                   |
| BlockToStepN              | 168.551 ms                | 693.705 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:43.584025 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=137
E20240125 01:41:43.752887 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=43264
W20240125 01:41:44.101145 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 01:41:44.584009 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
E20240125 01:41:44.752120 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240125 01:41:45.289389 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.406 ms                 | 635.407 ms                |
| Forward                   | 5.944 ms                  | 158.186 ms                |
| Backward                  | 5.030 ms                  | 30.619 ms                 |
| Optimize                  | 2.289 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 38.971 us                 | 108.865 ms                |
| AfterBackward             | 151.296 ms                | 1.996 s                   |
| BlockToStepN              | 168.731 ms                | 693.887 ms                |
| OneStep                   | 476.349 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:45.584196 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=141, pq.top=141
E20240125 01:41:45.756817 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=61932
W20240125 01:41:46.334744 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240125 01:41:46.756011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=138
W20240125 01:41:46.766450 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240125 01:41:47.379371 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 01:41:47.760857 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=101379
W20240125 01:41:47.781181 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.885 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.790 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 75.725 ms                 | 374.899 ms                |
| ProcessOneStep            | 149.992 ms                | 1.996 s                   |
| BlockToStepN              | 169.106 ms                | 693.705 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:48.426586 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:41:48.760020 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=61532
W20240125 01:41:48.902884 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240125 01:41:49.509097 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 01:41:49.763168 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=70701
W20240125 01:41:50.035030 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=150, pq.top=150
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.087 ms                 | 635.407 ms                |
| Forward                   | 5.833 ms                  | 158.186 ms                |
| Backward                  | 5.030 ms                  | 30.619 ms                 |
| Optimize                  | 2.278 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 36.999 us                 | 113.164 ms                |
| AfterBackward             | 151.296 ms                | 1.996 s                   |
| BlockToStepN              | 169.281 ms                | 693.887 ms                |
| OneStep                   | 477.065 ms                | 2.133 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:50.529558 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:41:50.784947 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=3796
W20240125 01:41:51.035233 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240125 01:41:51.562923 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:41:51.784011 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=4709
W20240125 01:41:52.035126 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240125 01:41:52.609146 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 01:41:52.784009 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=23370
W20240125 01:41:53.035182 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.126 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.541 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 75.725 ms                 | 374.899 ms                |
| ProcessOneStep            | 151.233 ms                | 464.036 ms                |
| BlockToStepN              | 174.334 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:41:53.724540 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:41:53.784008 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=714
W20240125 01:41:54.040594 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240125 01:41:54.752230 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 01:41:54.784005 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2940
W20240125 01:41:55.049432 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.406 ms                 | 632.526 ms                |
| Forward                   | 5.757 ms                  | 33.683 ms                 |
| Backward                  | 5.093 ms                  | 31.629 ms                 |
| Optimize                  | 2.274 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.999 us                 | 108.865 ms                |
| AfterBackward             | 151.313 ms                | 464.162 ms                |
| BlockToStepN              | 183.794 ms                | 688.495 ms                |
| OneStep                   | 477.065 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:55.784010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=11761
W20240125 01:41:55.903409 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:41:56.049353 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240125 01:41:56.792829 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=10342
W20240125 01:41:56.955770 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:41:57.049213 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=163, pq.top=163
E20240125 01:41:57.794858 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=337
W20240125 01:41:58.191449 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 01:41:58.369658 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.574 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 381.071 ms                |
| ProcessOneStep            | 152.872 ms                | 491.021 ms                |
| BlockToStepN              | 174.334 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:41:58.794010 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=62241
W20240125 01:41:59.194258 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 01:41:59.804814 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2320
W20240125 01:42:00.066924 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.406 ms                 | 632.526 ms                |
| Forward                   | 5.613 ms                  | 33.683 ms                 |
| Backward                  | 5.246 ms                  | 31.629 ms                 |
| Optimize                  | 2.274 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.128 us                 | 108.865 ms                |
| AfterBackward             | 153.188 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 688.495 ms                |
| OneStep                   | 484.088 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:00.327737 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:42:00.890501 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:42:01.363996 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 01:42:01.409035 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
E20240125 01:42:01.890019 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=7932
W20240125 01:42:02.401677 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 01:42:02.409322 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
E20240125 01:42:02.896813 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=4287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.254 ms                 | 133.448 ms                |
| ProcessBack:UpdateCache   | 14.410 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 80.383 ms                 | 381.071 ms                |
| ProcessOneStep            | 152.872 ms                | 491.021 ms                |
| BlockToStepN              | 169.106 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:03.409394 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240125 01:42:03.426177 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 01:42:03.896206 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3938
W20240125 01:42:04.496596 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:42:04.798976 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=177, pq.top=177
E20240125 01:42:04.896839 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=17483
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.509 ms                 | 632.997 ms                |
| Forward                   | 5.757 ms                  | 43.238 ms                 |
| Backward                  | 5.109 ms                  | 31.629 ms                 |
| Optimize                  | 2.271 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.121 us                 | 108.865 ms                |
| AfterBackward             | 152.932 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 688.495 ms                |
| OneStep                   | 487.543 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:05.501952 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:42:05.900218 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1733
W20240125 01:42:05.976119 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240125 01:42:06.544056 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:42:06.901554 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=15191
W20240125 01:42:06.976276 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240125 01:42:07.588507 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 01:42:07.901016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=11455
W20240125 01:42:08.185669 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.023 ms                 | 113.520 ms                |
| ProcessBack:UpdateCache   | 14.410 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 374.899 ms                |
| ProcessOneStep            | 152.203 ms                | 491.021 ms                |
| BlockToStepN              | 174.334 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:08.612004 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 01:42:08.901010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=6023
W20240125 01:42:09.185133 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240125 01:42:09.621006 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:42:09.901011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=57103
W20240125 01:42:10.188405 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.039 ms                 | 635.407 ms                |
| Forward                   | 5.664 ms                  | 43.238 ms                 |
| Backward                  | 5.246 ms                  | 31.629 ms                 |
| Optimize                  | 2.258 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.128 us                 | 108.865 ms                |
| AfterBackward             | 151.539 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 688.495 ms                |
| OneStep                   | 487.543 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:42:10.940851 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=51290
W20240125 01:42:11.160827 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 01:42:11.374143 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=190, pq.top=190
E20240125 01:42:11.940016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=36977
W20240125 01:42:12.242771 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:42:12.434983 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=192
E20240125 01:42:12.940016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=38522
W20240125 01:42:13.358995 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.068 ms                 | 113.520 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 79.697 ms                 | 374.899 ms                |
| ProcessOneStep            | 152.203 ms                | 491.021 ms                |
| BlockToStepN              | 183.631 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:13.581775 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=194
E20240125 01:42:13.944857 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=18358
W20240125 01:42:14.407832 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:42:14.877110 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240125 01:42:15.059803 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=17979
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.509 ms                 | 635.407 ms                |
| Forward                   | 5.664 ms                  | 43.238 ms                 |
| Backward                  | 5.109 ms                  | 31.629 ms                 |
| Optimize                  | 2.261 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 108.865 ms                |
| AfterBackward             | 153.188 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 487.543 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:15.474090 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:42:16.064818 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:42:16.587358 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240125 01:42:16.896827 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:42:17.064023 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=40
[proc 6] 200 steps, total: 53.175, sample: 2.138, forward: 0.841, backward: 0.826, update: 0.279
[proc 2] 200 steps, total: 53.175, sample: 2.720, forward: 0.886, backward: 0.850, update: 0.254
[proc 5] 200 steps, total: 53.175, sample: 2.190, forward: 0.777, backward: 0.788, update: 0.272
[proc 7] 200 steps, total: 53.175, sample: 2.277, forward: 0.853, backward: 0.922, update: 0.252
[proc 4] 200 steps, total: 53.176, sample: 2.441, forward: 0.676, backward: 0.813, update: 0.289
[proc 1] 200 steps, total: 53.175, sample: 2.028, forward: 0.589, backward: 0.897, update: 0.291
[proc 3] 200 steps, total: 53.175, sample: 2.241, forward: 0.808, backward: 0.753, update: 0.269
[proc 0] 200 steps, total: 53.172, sample: 8.657, forward: 0.993, backward: 0.874, update: 0.384
W20240125 01:42:17.651954 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240125 01:42:17.958287 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240125 01:42:18.064817 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.855 ms                 | 113.520 ms                |
| ProcessBack:UpdateCache   | 14.365 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.461 ms                 | 374.899 ms                |
| ProcessOneStep            | 154.913 ms                | 491.021 ms                |
| BlockToStepN              | 174.334 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:18.651417 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=203, pq.top=203
E20240125 01:42:19.064013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=4321
W20240125 01:42:19.071674 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 01:42:19.661047 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240125 01:42:20.064208 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
W20240125 01:42:20.304737 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.509 ms                 | 640.359 ms                |
| Forward                   | 5.602 ms                  | 43.238 ms                 |
| Backward                  | 5.109 ms                  | 31.629 ms                 |
| Optimize                  | 2.255 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.128 us                 | 108.865 ms                |
| AfterBackward             | 156.372 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 487.543 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:20.731360 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=208
E20240125 01:42:21.064010 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=23537
W20240125 01:42:21.305174 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240125 01:42:21.731300 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240125 01:42:22.064831 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=58121
W20240125 01:42:22.575028 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240125 01:42:22.731148 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
E20240125 01:42:23.064069 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.885 ms                 | 113.520 ms                |
| ProcessBack:UpdateCache   | 14.541 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.461 ms                 | 374.899 ms                |
| ProcessOneStep            | 155.928 ms                | 491.021 ms                |
| BlockToStepN              | 174.334 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:23.998312 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240125 01:42:24.069456 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=27145
W20240125 01:42:24.493924 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240125 01:42:25.003794 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 01:42:25.069010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=738
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.605 ms                 | 660.923 ms                |
| Forward                   | 5.555 ms                  | 43.238 ms                 |
| Backward                  | 5.093 ms                  | 31.629 ms                 |
| Optimize                  | 2.248 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 34.518 us                 | 108.865 ms                |
| AfterBackward             | 155.979 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 487.543 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:25.524679 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240125 01:42:26.011962 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240125 01:42:26.069010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2860
W20240125 01:42:26.524214 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240125 01:42:27.069392 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=20827
W20240125 01:42:27.129840 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240125 01:42:27.640206 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=221
E20240125 01:42:28.069010 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=30930
W20240125 01:42:28.173492 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.023 ms                 | 113.520 ms                |
| ProcessBack:UpdateCache   | 14.541 ms                 | 47.363 ms                 |
| ProcessBack:UpsertPq      | 79.697 ms                 | 374.899 ms                |
| ProcessOneStep            | 154.913 ms                | 491.021 ms                |
| BlockToStepN              | 174.334 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:28.640679 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=225, pq.top=225
E20240125 01:42:29.069010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=9619
W20240125 01:42:29.279753 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240125 01:42:29.730846 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=229, pq.top=229
E20240125 01:42:30.075089 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=31071
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.077 ms                 | 660.923 ms                |
| Forward                   | 5.499 ms                  | 43.238 ms                 |
| Backward                  | 5.093 ms                  | 31.629 ms                 |
| Optimize                  | 2.256 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 34.111 us                 | 108.865 ms                |
| AfterBackward             | 153.257 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 477.065 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:30.468075 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240125 01:42:31.083554 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:42:31.258513 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240125 01:42:31.545848 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
E20240125 01:42:32.083010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1472
W20240125 01:42:32.581853 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 01:42:32.728713 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
E20240125 01:42:33.083009 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=48243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.803 ms                 | 107.345 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 74.884 ms                 | 329.977 ms                |
| ProcessOneStep            | 152.872 ms                | 491.021 ms                |
| BlockToStepN              | 183.631 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:33.588218 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240125 01:42:33.817409 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240125 01:42:34.083010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3005
W20240125 01:42:34.592980 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 01:42:34.938416 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
E20240125 01:42:35.083017 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=35021
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.605 ms                 | 660.923 ms                |
| Forward                   | 5.491 ms                  | 43.238 ms                 |
| Backward                  | 4.933 ms                  | 31.629 ms                 |
| Optimize                  | 2.255 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 34.174 us                 | 113.164 ms                |
| AfterBackward             | 153.222 ms                | 491.088 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 476.349 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:35.749791 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:42:35.953425 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
E20240125 01:42:36.088922 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=42292
W20240125 01:42:36.783937 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:42:36.965394 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
E20240125 01:42:37.088016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=59817
W20240125 01:42:37.830643 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 01:42:37.969978 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240125 01:42:38.088007 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=49424
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.821 ms                 | 107.345 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 76.519 ms                 | 329.977 ms                |
| ProcessOneStep            | 154.374 ms                | 491.021 ms                |
| BlockToStepN              | 183.631 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:38.882951 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:42:39.092845 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=35114
W20240125 01:42:39.479087 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240125 01:42:39.901013 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:42:40.092311 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.312 ms                 | 660.923 ms                |
| Forward                   | 5.464 ms                  | 43.238 ms                 |
| Backward                  | 4.732 ms                  | 31.629 ms                 |
| Optimize                  | 2.255 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 34.518 us                 | 113.164 ms                |
| AfterBackward             | 154.982 ms                | 491.088 ms                |
| BlockToStepN              | 183.794 ms                | 689.232 ms                |
| OneStep                   | 477.065 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:40.687330 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240125 01:42:41.017472 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:42:41.092013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2184
W20240125 01:42:41.697197 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=251, pq.top=251
E20240125 01:42:42.094635 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=75224
W20240125 01:42:42.127032 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
W20240125 01:42:42.697284 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240125 01:42:43.108817 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=82736
W20240125 01:42:43.175534 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.803 ms                 | 107.345 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 329.977 ms                |
| ProcessOneStep            | 155.920 ms                | 464.036 ms                |
| BlockToStepN              | 174.334 ms                | 688.336 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:43.861977 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=255
E20240125 01:42:44.108016 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=11107
W20240125 01:42:44.203382 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240125 01:42:44.861076 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240125 01:42:45.111335 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=84484
W20240125 01:42:45.220700 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.605 ms                 | 640.359 ms                |
| Forward                   | 5.491 ms                  | 33.683 ms                 |
| Backward                  | 4.732 ms                  | 30.619 ms                 |
| Optimize                  | 2.258 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.121 us                 | 108.865 ms                |
| AfterBackward             | 155.965 ms                | 464.162 ms                |
| BlockToStepN              | 183.794 ms                | 689.232 ms                |
| OneStep                   | 484.088 ms                | 1.206 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:45.880358 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240125 01:42:46.111474 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=63967
W20240125 01:42:46.252272 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 01:42:47.089215 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=262, pq.top=262
E20240125 01:42:47.111006 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5885
W20240125 01:42:47.284822 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 01:42:48.117343 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 01:42:48.264418 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240125 01:42:48.329828 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.855 ms                 | 107.345 ms                |
| ProcessBack:UpdateCache   | 14.506 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 329.977 ms                |
| ProcessOneStep            | 155.920 ms                | 464.036 ms                |
| BlockToStepN              | 174.334 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:42:49.124859 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=7544
W20240125 01:42:49.264631 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240125 01:42:49.369796 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:42:50.129925 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=29633
W20240125 01:42:50.264050 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.736 ms                 | 640.359 ms                |
| Forward                   | 5.464 ms                  | 33.683 ms                 |
| Backward                  | 4.732 ms                  | 30.619 ms                 |
| Optimize                  | 2.261 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 108.865 ms                |
| AfterBackward             | 155.965 ms                | 464.162 ms                |
| BlockToStepN              | 174.541 ms                | 689.232 ms                |
| OneStep                   | 477.065 ms                | 1.206 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:50.433492 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:42:51.129012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=81760
W20240125 01:42:51.410980 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240125 01:42:51.492095 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240125 01:42:52.129014 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=93467
W20240125 01:42:52.510952 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240125 01:42:52.552384 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=276
E20240125 01:42:53.129007 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=33874
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.821 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 14.287 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 79.352 ms                 | 318.918 ms                |
| ProcessOneStep            | 154.374 ms                | 464.036 ms                |
| BlockToStepN              | 183.631 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:53.552135 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240125 01:42:53.660092 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 01:42:54.132210 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=324
W20240125 01:42:54.704515 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 01:42:54.788558 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
E20240125 01:42:55.217567 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=55122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.077 ms                 | 640.359 ms                |
| Forward                   | 5.491 ms                  | 33.683 ms                 |
| Backward                  | 4.732 ms                  | 30.619 ms                 |
| Optimize                  | 2.255 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.121 us                 | 108.865 ms                |
| AfterBackward             | 154.427 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 689.232 ms                |
| OneStep                   | 480.663 ms                | 1.206 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:55.724917 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:42:55.788113 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240125 01:42:56.217182 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=75436
W20240125 01:42:56.764022 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:42:56.788662 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
E20240125 01:42:57.222445 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=67882
W20240125 01:42:57.772766 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 01:42:57.788062 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240125 01:42:58.224828 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=157956
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.737 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 14.287 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 78.063 ms                 | 318.918 ms                |
| ProcessOneStep            | 153.840 ms                | 464.036 ms                |
| BlockToStepN              | 183.631 ms                | 689.031 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:42:58.788065 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240125 01:42:58.851503 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:42:59.227155 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=65618
W20240125 01:42:59.852176 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 01:42:59.968487 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
E20240125 01:43:00.227012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=152324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.692 ms                 | 640.359 ms                |
| Forward                   | 5.455 ms                  | 33.683 ms                 |
| Backward                  | 4.737 ms                  | 30.619 ms                 |
| Optimize                  | 2.256 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 108.865 ms                |
| AfterBackward             | 154.427 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 693.887 ms                |
| OneStep                   | 480.663 ms                | 1.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:00.886755 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 01:43:00.985191 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240125 01:43:01.248030 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=40458
W20240125 01:43:02.100492 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:43:02.150527 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=291
E20240125 01:43:02.266476 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=659
W20240125 01:43:03.162987 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 01:43:03.168817 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=294, pq.top=294
E20240125 01:43:03.266012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=12815
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.821 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.854 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 79.352 ms                 | 329.977 ms                |
| ProcessOneStep            | 154.913 ms                | 464.036 ms                |
| BlockToStepN              | 183.631 ms                | 753.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:04.205256 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240125 01:43:04.268821 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=11553
W20240125 01:43:04.575066 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240125 01:43:05.255533 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240125 01:43:05.268004 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=42569
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.692 ms                 | 640.359 ms                |
| Forward                   | 5.464 ms                  | 33.683 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.254 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 108.865 ms                |
| AfterBackward             | 154.982 ms                | 464.162 ms                |
| BlockToStepN              | 174.541 ms                | 753.961 ms                |
| OneStep                   | 477.065 ms                | 1.244 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 48.396, sample: 1.673, forward: 0.699, backward: 0.782, update: 0.249
[proc 4] 300 steps, total: 48.395, sample: 1.834, forward: 0.802, backward: 0.783, update: 0.247
[proc 7] 300 steps, total: 48.396, sample: 1.875, forward: 0.691, backward: 0.884, update: 0.245
[proc 3] 300 steps, total: 48.395, sample: 1.789, forward: 0.703, backward: 0.751, update: 0.251
[proc 1] 300 steps, total: 48.396, sample: 1.698, forward: 0.641, backward: 0.849, update: 0.267
[proc 5] 300 steps, total: 48.396, sample: 1.725, forward: 0.712, backward: 0.869, update: 0.271
[proc 2] 300 steps, total: 48.396, sample: 2.471, forward: 0.708, backward: 0.773, update: 0.254
[proc 0] 300 steps, total: 48.395, sample: 6.201, forward: 0.819, backward: 0.725, update: 0.295
W20240125 01:43:05.803194 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=300
E20240125 01:43:06.268316 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=32
W20240125 01:43:06.474844 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
W20240125 01:43:06.883100 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240125 01:43:07.268010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=202572
W20240125 01:43:07.568428 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240125 01:43:07.902367 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
E20240125 01:43:08.270860 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=33702
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.855 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.666 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 79.352 ms                 | 329.977 ms                |
| ProcessOneStep            | 155.920 ms                | 464.036 ms                |
| BlockToStepN              | 174.334 ms                | 753.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:08.780596 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
W20240125 01:43:08.902701 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
E20240125 01:43:09.512701 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240125 01:43:09.798424 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240125 01:43:09.916092 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.509 ms                 | 640.359 ms                |
| Forward                   | 5.464 ms                  | 33.683 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.254 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.063 us                 | 108.865 ms                |
| AfterBackward             | 155.979 ms                | 485.660 ms                |
| BlockToStepN              | 183.794 ms                | 882.332 ms                |
| OneStep                   | 484.088 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:10.515992 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=8623
W20240125 01:43:10.916821 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240125 01:43:11.052835 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 01:43:11.515010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=42190
W20240125 01:43:11.919490 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=310, pq.top=310
W20240125 01:43:12.123059 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:43:12.515012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=36494
W20240125 01:43:13.112000 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240125 01:43:13.162307 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.855 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.689 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 79.352 ms                 | 374.651 ms                |
| ProcessOneStep            | 155.920 ms                | 485.588 ms                |
| BlockToStepN              | 183.631 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:13.515007 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=34843
W20240125 01:43:14.111513 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240125 01:43:14.239485 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 01:43:14.515008 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=60280
W20240125 01:43:15.111332 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240125 01:43:15.313540 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.466 ms                 | 640.359 ms                |
| Forward                   | 5.464 ms                  | 33.683 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.253 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.063 us                 | 108.865 ms                |
| AfterBackward             | 154.427 ms                | 485.660 ms                |
| BlockToStepN              | 190.106 ms                | 882.332 ms                |
| OneStep                   | 487.543 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:15.515023 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=15649
W20240125 01:43:16.199901 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240125 01:43:16.331658 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240125 01:43:16.515012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=18001
W20240125 01:43:17.269776 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=323, pq.top=323
E20240125 01:43:17.515362 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=24663
W20240125 01:43:17.527072 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
W20240125 01:43:18.305891 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.803 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.636 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 78.853 ms                 | 374.651 ms                |
| ProcessOneStep            | 153.504 ms                | 485.588 ms                |
| BlockToStepN              | 183.631 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:18.515013 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=132072
W20240125 01:43:18.596885 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240125 01:43:19.515046 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=17438
W20240125 01:43:19.879174 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240125 01:43:19.904852 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.406 ms                 | 640.359 ms                |
| Forward                   | 5.455 ms                  | 33.683 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.256 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 36.278 us                 | 108.865 ms                |
| AfterBackward             | 153.891 ms                | 485.660 ms                |
| BlockToStepN              | 190.106 ms                | 882.332 ms                |
| OneStep                   | 487.543 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:20.524827 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=11288
W20240125 01:43:20.880827 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240125 01:43:20.909487 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240125 01:43:21.524010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3829
W20240125 01:43:21.892918 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240125 01:43:22.039223 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240125 01:43:22.524011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=11077
W20240125 01:43:22.905261 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240125 01:43:23.271544 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.803 ms                 | 72.979 ms                 |
| ProcessBack:UpdateCache   | 13.666 ms                 | 46.133 ms                 |
| ProcessBack:UpsertPq      | 79.697 ms                 | 329.977 ms                |
| ProcessOneStep            | 153.840 ms                | 485.588 ms                |
| BlockToStepN              | 183.631 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:23.524010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=11314
W20240125 01:43:23.905704 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240125 01:43:24.465320 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240125 01:43:24.532832 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2822
W20240125 01:43:24.910763 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=337
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.778 ms                 | 640.359 ms                |
| Forward                   | 5.491 ms                  | 33.683 ms                 |
| Backward                  | 4.737 ms                  | 30.619 ms                 |
| Optimize                  | 2.258 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 36.999 us                 | 108.865 ms                |
| AfterBackward             | 154.982 ms                | 485.660 ms                |
| BlockToStepN              | 190.106 ms                | 882.332 ms                |
| OneStep                   | 484.088 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:25.532780 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=71618
W20240125 01:43:25.563298 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 01:43:26.014261 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240125 01:43:26.540817 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=55633
W20240125 01:43:26.668287 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240125 01:43:27.171543 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=341
E20240125 01:43:27.540022 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240125 01:43:27.961585 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240125 01:43:28.327241 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.855 ms                 | 72.979 ms                 |
| ProcessBack:UpdateCache   | 13.619 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.593 ms                 | 366.722 ms                |
| ProcessOneStep            | 155.928 ms                | 485.588 ms                |
| BlockToStepN              | 183.631 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:28.540815 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=24468
W20240125 01:43:29.094434 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
E20240125 01:43:29.540011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240125 01:43:29.755199 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=344, pq.top=343
W20240125 01:43:30.321452 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.087 ms                 | 640.359 ms                |
| Forward                   | 5.464 ms                  | 33.683 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.260 ms                  | 52.480 ms                 |
| BarrierTimeBeforeRank0    | 36.464 us                 | 108.865 ms                |
| AfterBackward             | 156.121 ms                | 485.660 ms                |
| BlockToStepN              | 183.794 ms                | 882.332 ms                |
| OneStep                   | 487.543 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:30.540011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=50184
W20240125 01:43:30.874069 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240125 01:43:31.368914 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
E20240125 01:43:31.540017 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=128126
W20240125 01:43:31.874440 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240125 01:43:32.540014 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=8030
W20240125 01:43:32.692049 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 01:43:32.874735 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.030 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.619 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.383 ms                 | 366.722 ms                |
| ProcessOneStep            | 156.053 ms                | 464.036 ms                |
| BlockToStepN              | 183.631 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:33.544828 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=80925
W20240125 01:43:33.764461 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
W20240125 01:43:34.216948 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240125 01:43:34.544014 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=45422
W20240125 01:43:34.790601 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 01:43:35.247332 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.974 ms                 | 635.407 ms                |
| Forward                   | 5.491 ms                  | 33.271 ms                 |
| Backward                  | 4.737 ms                  | 28.682 ms                 |
| Optimize                  | 2.260 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.372 us                 | 92.392 ms                 |
| AfterBackward             | 156.372 ms                | 464.162 ms                |
| BlockToStepN              | 183.794 ms                | 882.332 ms                |
| OneStep                   | 484.088 ms                | 1.401 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:35.549237 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=49427
W20240125 01:43:35.835388 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240125 01:43:36.278374 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240125 01:43:36.549014 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=72688
W20240125 01:43:36.847117 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
W20240125 01:43:37.365197 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240125 01:43:37.552870 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=56484
W20240125 01:43:37.871724 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 01:43:38.372843 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.068 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.619 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.121 ms                 | 366.722 ms                |
| ProcessOneStep            | 156.053 ms                | 464.036 ms                |
| BlockToStepN              | 188.536 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:38.552011 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=64304
W20240125 01:43:38.966434 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:43:39.372280 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
E20240125 01:43:39.552009 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=72237
W20240125 01:43:39.997634 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.409 ms                 | 635.407 ms                |
| Forward                   | 5.513 ms                  | 33.271 ms                 |
| Backward                  | 4.786 ms                  | 28.682 ms                 |
| Optimize                  | 2.271 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.372 us                 | 92.392 ms                 |
| AfterBackward             | 156.372 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 882.332 ms                |
| OneStep                   | 484.088 ms                | 1.401 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:40.372437 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240125 01:43:40.552855 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=56768
W20240125 01:43:41.039502 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:43:41.552016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=631
W20240125 01:43:41.586174 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=368, pq.top=367
W20240125 01:43:42.053078 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 01:43:42.586644 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=214334
W20240125 01:43:42.731724 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240125 01:43:43.322960 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.152 ms                 | 97.601 ms                 |
| ProcessBack:UpdateCache   | 13.636 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.383 ms                 | 366.722 ms                |
| ProcessOneStep            | 156.446 ms                | 464.036 ms                |
| BlockToStepN              | 188.536 ms                | 882.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:43.586014 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=12162
W20240125 01:43:43.731380 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240125 01:43:44.464154 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240125 01:43:44.591046 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=6035
W20240125 01:43:45.160763 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.109 ms                 | 635.407 ms                |
| Forward                   | 5.555 ms                  | 36.538 ms                 |
| Backward                  | 4.737 ms                  | 28.682 ms                 |
| Optimize                  | 2.268 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 92.392 ms                 |
| AfterBackward             | 157.728 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 882.332 ms                |
| OneStep                   | 484.088 ms                | 1.401 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:45.574002 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240125 01:43:45.596832 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=46648
W20240125 01:43:46.161054 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 01:43:46.596844 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=88273
W20240125 01:43:47.054993 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:43:47.304755 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=375
E20240125 01:43:47.744266 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=122798
W20240125 01:43:48.127861 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 01:43:48.304380 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.109 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.619 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.383 ms                 | 366.722 ms                |
| ProcessOneStep            | 157.676 ms                | 464.036 ms                |
| BlockToStepN              | 190.122 ms                | 916.261 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:48.744009 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=4097
W20240125 01:43:49.136960 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 01:43:49.305130 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240125 01:43:49.752837 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=72481
W20240125 01:43:50.236743 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.843 ms                 | 635.407 ms                |
| Forward                   | 5.607 ms                  | 36.538 ms                 |
| Backward                  | 4.737 ms                  | 31.629 ms                 |
| Optimize                  | 2.261 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 92.392 ms                 |
| AfterBackward             | 158.358 ms                | 464.162 ms                |
| BlockToStepN              | 190.301 ms                | 916.419 ms                |
| OneStep                   | 487.543 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:50.455482 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240125 01:43:50.752296 28619 parallel_pq_v2.h:76] insert failed, size(hashtable)=2694
W20240125 01:43:51.393512 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 01:43:51.490867 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=384
E20240125 01:43:51.768972 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=16923
W20240125 01:43:52.488543 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 01:43:52.768028 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=76683
W20240125 01:43:52.791397 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.109 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.636 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.593 ms                 | 366.722 ms                |
| ProcessOneStep            | 158.278 ms                | 464.036 ms                |
| BlockToStepN              | 189.248 ms                | 949.334 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:53.567534 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:43:53.768811 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=33858
W20240125 01:43:53.791374 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240125 01:43:54.667691 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 01:43:54.768010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=127319
W20240125 01:43:54.791570 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.544 ms                 | 635.407 ms                |
| Forward                   | 5.602 ms                  | 36.538 ms                 |
| Backward                  | 4.786 ms                  | 31.629 ms                 |
| Optimize                  | 2.268 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.121 us                 | 92.392 ms                 |
| AfterBackward             | 158.358 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 949.496 ms                |
| OneStep                   | 487.863 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:43:55.743094 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 01:43:55.771800 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=33852
W20240125 01:43:56.005800 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
E20240125 01:43:56.771013 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=19839
W20240125 01:43:56.771476 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 01:43:57.005355 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240125 01:43:57.771010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=26074
W20240125 01:43:57.834955 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 01:43:58.005923 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=395, pq.top=395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.139 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.780 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.794 ms                 | 374.651 ms                |
| ProcessOneStep            | 159.704 ms                | 464.036 ms                |
| BlockToStepN              | 189.959 ms                | 949.334 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:43:58.780818 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=2158
W20240125 01:43:58.891808 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 01:43:59.005389 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
E20240125 01:43:59.780010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=5696
W20240125 01:43:59.904875 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:44:00.021569 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=399, pq.top=399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.692 ms                 | 635.407 ms                |
| Forward                   | 5.620 ms                  | 36.538 ms                 |
| Backward                  | 4.899 ms                  | 31.629 ms                 |
| Optimize                  | 2.271 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 92.392 ms                 |
| AfterBackward             | 160.066 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 949.496 ms                |
| OneStep                   | 487.863 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 55.024, sample: 2.096, forward: 0.647, backward: 0.877, update: 0.248
[proc 1] 400 steps, total: 55.024, sample: 1.738, forward: 0.607, backward: 0.671, update: 0.250
[proc 0] 400 steps, total: 55.024, sample: 5.460, forward: 1.081, backward: 0.781, update: 0.379
[proc 4] 400 steps, total: 55.024, sample: 2.095, forward: 0.595, backward: 0.845, update: 0.254
[proc 5] 400 steps, total: 55.024, sample: 2.268, forward: 0.745, backward: 0.846, update: 0.241
[proc 7] 400 steps, total: 55.024, sample: 2.040, forward: 0.707, backward: 0.773, update: 0.252
[proc 2] 400 steps, total: 55.024, sample: 2.397, forward: 0.771, backward: 0.805, update: 0.268
[proc 6] 400 steps, total: 55.024, sample: 1.907, forward: 0.738, backward: 0.734, update: 0.265
E20240125 01:44:00.780237 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=1978
W20240125 01:44:00.958551 29440 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 01:44:01.023252 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240125 01:44:01.780011 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=17902
W20240125 01:44:02.021731 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 01:44:02.023391 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240125 01:44:02.780010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=125018
W20240125 01:44:03.025717 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240125 01:44:03.086005 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.109 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.840 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.383 ms                 | 374.651 ms                |
| ProcessOneStep            | 158.278 ms                | 464.036 ms                |
| BlockToStepN              | 189.959 ms                | 949.334 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:44:03.785235 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=4502
W20240125 01:44:04.025406 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240125 01:44:04.242476 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:44:04.785012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=53212
W20240125 01:44:05.286360 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.544 ms                 | 635.407 ms                |
| Forward                   | 5.613 ms                  | 36.538 ms                 |
| Backward                  | 4.737 ms                  | 31.629 ms                 |
| Optimize                  | 2.271 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 92.392 ms                 |
| AfterBackward             | 156.503 ms                | 464.162 ms                |
| BlockToStepN              | 190.301 ms                | 949.496 ms                |
| OneStep                   | 487.863 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:05.355391 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240125 01:44:05.785027 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=59342
W20240125 01:44:06.322429 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 01:44:06.374895 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=413
E20240125 01:44:06.785014 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=143696
W20240125 01:44:07.325778 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 01:44:07.377744 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=415, pq.top=415
E20240125 01:44:07.788822 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=230927
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.147 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.854 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 79.697 ms                 | 374.651 ms                |
| ProcessOneStep            | 156.446 ms                | 464.036 ms                |
| BlockToStepN              | 190.122 ms                | 949.334 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:08.551388 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 01:44:08.582257 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=418, pq.top=417
E20240125 01:44:08.788015 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=1539
W20240125 01:44:09.671002 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240125 01:44:09.788830 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=6378
W20240125 01:44:09.866727 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.076 ms                 | 635.407 ms                |
| Forward                   | 5.659 ms                  | 43.238 ms                 |
| Backward                  | 4.737 ms                  | 31.629 ms                 |
| Optimize                  | 2.278 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.063 us                 | 92.392 ms                 |
| AfterBackward             | 158.358 ms                | 464.162 ms                |
| BlockToStepN              | 190.301 ms                | 949.496 ms                |
| OneStep                   | 487.863 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:10.714201 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 01:44:10.796926 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=65200
W20240125 01:44:10.867321 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
E20240125 01:44:11.820894 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=84208
W20240125 01:44:11.868440 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240125 01:44:12.770915 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 01:44:12.823062 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=96465
W20240125 01:44:13.372216 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=422, pq.top=422
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.147 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.942 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 79.918 ms                 | 374.899 ms                |
| ProcessOneStep            | 158.278 ms                | 485.588 ms                |
| BlockToStepN              | 189.959 ms                | 986.798 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:13.801214 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 01:44:13.828873 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=3132
W20240125 01:44:14.676551 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=424
E20240125 01:44:14.828012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=11249
W20240125 01:44:14.860824 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.154 ms                 | 635.407 ms                |
| Forward                   | 5.620 ms                  | 43.238 ms                 |
| Backward                  | 4.732 ms                  | 31.629 ms                 |
| Optimize                  | 2.278 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 36.063 us                 | 92.392 ms                 |
| AfterBackward             | 159.799 ms                | 485.660 ms                |
| BlockToStepN              | 190.301 ms                | 986.955 ms                |
| OneStep                   | 491.511 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:44:15.837321 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=64362
W20240125 01:44:15.872820 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240125 01:44:16.129391 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
E20240125 01:44:16.837014 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=5506
W20240125 01:44:16.880034 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:44:17.137485 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=429
E20240125 01:44:17.852813 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=72913
W20240125 01:44:17.914114 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 01:44:18.353018 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.147 ms                 | 72.979 ms                 |
| ProcessBack:UpdateCache   | 13.780 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 80.794 ms                 | 374.651 ms                |
| ProcessOneStep            | 160.013 ms                | 485.588 ms                |
| BlockToStepN              | 189.959 ms                | 986.798 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:44:18.852016 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=123
W20240125 01:44:18.964534 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:44:19.353226 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240125 01:44:19.855796 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=64404
W20240125 01:44:20.033681 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.028 ms                 | 635.407 ms                |
| Forward                   | 5.620 ms                  | 43.238 ms                 |
| Backward                  | 4.727 ms                  | 31.629 ms                 |
| Optimize                  | 2.279 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 92.392 ms                 |
| AfterBackward             | 160.066 ms                | 485.660 ms                |
| BlockToStepN              | 190.301 ms                | 986.955 ms                |
| OneStep                   | 491.511 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:20.362298 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
E20240125 01:44:20.855013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=50342
W20240125 01:44:21.057163 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:44:21.480095 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
E20240125 01:44:21.855018 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=139950
W20240125 01:44:22.093459 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
W20240125 01:44:22.484903 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 01:44:22.855016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=46349
W20240125 01:44:23.235997 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.147 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.780 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 81.131 ms                 | 374.651 ms                |
| ProcessOneStep            | 160.013 ms                | 485.588 ms                |
| BlockToStepN              | 189.959 ms                | 986.798 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:23.485440 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=439
E20240125 01:44:23.855012 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=1853
W20240125 01:44:24.258795 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:44:24.634403 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
E20240125 01:44:24.855010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=39484
W20240125 01:44:25.311650 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.962 ms                 | 635.407 ms                |
| Forward                   | 5.620 ms                  | 43.238 ms                 |
| Backward                  | 4.673 ms                  | 31.629 ms                 |
| Optimize                  | 2.282 ms                  | 46.532 ms                 |
| BarrierTimeBeforeRank0    | 35.772 us                 | 92.392 ms                 |
| AfterBackward             | 159.799 ms                | 485.660 ms                |
| BlockToStepN              | 190.301 ms                | 986.955 ms                |
| OneStep                   | 491.625 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:25.634469 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240125 01:44:25.855018 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=41768
W20240125 01:44:26.346316 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:44:26.663163 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240125 01:44:26.855019 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=36393
W20240125 01:44:27.419791 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:44:27.663782 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
E20240125 01:44:27.855011 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=42995
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.111 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.780 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.461 ms                 | 374.651 ms                |
| ProcessOneStep            | 159.704 ms                | 485.588 ms                |
| BlockToStepN              | 189.248 ms                | 986.798 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:28.546056 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:44:28.663347 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240125 01:44:28.855011 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=43669
W20240125 01:44:29.547380 29440 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 01:44:29.664357 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=453, pq.top=453
E20240125 01:44:29.855027 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=61144
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.796 ms                 | 632.997 ms                |
| Forward                   | 5.620 ms                  | 36.538 ms                 |
| Backward                  | 4.786 ms                  | 30.619 ms                 |
| Optimize                  | 2.298 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 88.938 ms                 |
| AfterBackward             | 160.066 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 949.496 ms                |
| OneStep                   | 491.511 ms                | 1.572 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:30.571736 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 01:44:30.669365 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240125 01:44:30.860842 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=58106
W20240125 01:44:31.582064 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 01:44:31.825891 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240125 01:44:31.860013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=1472
W20240125 01:44:32.584920 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 01:44:32.826179 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240125 01:44:32.864315 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=256059
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.023 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.689 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 374.651 ms                |
| ProcessOneStep            | 157.676 ms                | 464.036 ms                |
| BlockToStepN              | 189.248 ms                | 949.334 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:33.766623 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 01:44:33.826614 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240125 01:44:33.904646 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=16532
W20240125 01:44:34.827173 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240125 01:44:34.916858 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=57715
W20240125 01:44:35.283022 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.484 ms                 | 632.997 ms                |
| Forward                   | 5.607 ms                  | 36.538 ms                 |
| Backward                  | 4.925 ms                  | 30.619 ms                 |
| Optimize                  | 2.306 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 88.938 ms                 |
| AfterBackward             | 158.358 ms                | 464.162 ms                |
| BlockToStepN              | 190.301 ms                | 986.955 ms                |
| OneStep                   | 487.864 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 01:44:36.003229 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=96042
W20240125 01:44:36.211802 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240125 01:44:36.315375 29440 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 01:44:37.003013 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=24289
W20240125 01:44:37.211026 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240125 01:44:37.875193 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 01:44:38.013563 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=1675
W20240125 01:44:38.211189 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.885 ms                 | 85.749 ms                 |
| ProcessBack:UpdateCache   | 13.775 ms                 | 46.764 ms                 |
| ProcessBack:UpsertPq      | 80.315 ms                 | 374.899 ms                |
| ProcessOneStep            | 159.256 ms                | 464.036 ms                |
| BlockToStepN              | 188.536 ms                | 991.782 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:38.978778 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:44:39.013010 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=74631
W20240125 01:44:39.776724 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
E20240125 01:44:40.013242 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=60036
W20240125 01:44:40.168669 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.624 ms                 | 632.997 ms                |
| Forward                   | 5.555 ms                  | 36.538 ms                 |
| Backward                  | 4.933 ms                  | 31.629 ms                 |
| Optimize                  | 2.312 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 88.938 ms                 |
| AfterBackward             | 160.066 ms                | 464.162 ms                |
| BlockToStepN              | 190.106 ms                | 991.938 ms                |
| OneStep                   | 491.511 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:40.793467 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
E20240125 01:44:41.013011 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=58862
W20240125 01:44:41.235592 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 01:44:41.793963 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
E20240125 01:44:42.016813 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=44672
W20240125 01:44:42.314777 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 01:44:42.892812 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240125 01:44:43.016016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=109269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.023 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.666 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 81.605 ms                 | 374.651 ms                |
| ProcessOneStep            | 160.938 ms                | 464.036 ms                |
| BlockToStepN              | 187.109 ms                | 991.782 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:43.479779 29440 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240125 01:44:43.909531 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
E20240125 01:44:44.035562 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=27249
W20240125 01:44:44.602703 29440 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 01:44:45.035010 28143 parallel_pq_v2.h:76] insert failed, size(hashtable)=816
W20240125 01:44:45.091464 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.448 ms                 | 632.997 ms                |
| Forward                   | 5.602 ms                  | 36.538 ms                 |
| Backward                  | 4.925 ms                  | 31.629 ms                 |
| Optimize                  | 2.325 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 36.094 us                 | 92.392 ms                 |
| AfterBackward             | 161.025 ms                | 464.162 ms                |
| BlockToStepN              | 187.286 ms                | 991.938 ms                |
| OneStep                   | 487.863 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:45.689535 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240125 01:44:46.037056 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=227020
W20240125 01:44:46.269136 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=483
W20240125 01:44:46.771765 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 01:44:47.037016 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=281018
W20240125 01:44:47.780280 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 01:44:48.037012 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=20713
W20240125 01:44:48.169301 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=487, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.023 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.666 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 81.605 ms                 | 374.651 ms                |
| ProcessOneStep            | 161.281 ms                | 464.036 ms                |
| BlockToStepN              | 187.109 ms                | 991.782 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 01:44:49.037034 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=67185
W20240125 01:44:49.168926 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 01:44:49.647564 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
E20240125 01:44:50.037012 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=11715
W20240125 01:44:50.219527 29440 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.484 ms                 | 632.997 ms                |
| Forward                   | 5.607 ms                  | 36.538 ms                 |
| Backward                  | 4.899 ms                  | 31.629 ms                 |
| Optimize                  | 2.321 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 35.986 us                 | 92.392 ms                 |
| AfterBackward             | 161.578 ms                | 464.162 ms                |
| BlockToStepN              | 188.725 ms                | 991.938 ms                |
| OneStep                   | 487.864 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:50.774828 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240125 01:44:51.037012 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=43170
W20240125 01:44:51.283484 29440 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 01:44:51.792737 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=492
E20240125 01:44:52.037014 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=38013
W20240125 01:44:52.324098 29440 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 01:44:52.792246 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240125 01:44:53.037070 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=66083
W20240125 01:44:53.339291 29440 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.030 ms                 | 73.794 ms                 |
| ProcessBack:UpdateCache   | 13.616 ms                 | 46.315 ms                 |
| ProcessBack:UpsertPq      | 81.605 ms                 | 374.899 ms                |
| ProcessOneStep            | 161.158 ms                | 464.036 ms                |
| BlockToStepN              | 187.109 ms                | 991.782 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 01:44:53.792202 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240125 01:44:54.037011 29439 parallel_pq_v2.h:76] insert failed, size(hashtable)=76642
W20240125 01:44:54.362241 29440 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 01:44:54.793314 28143 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
E20240125 01:44:55.037015 29440 parallel_pq_v2.h:76] insert failed, size(hashtable)=83014
[proc 6] 500 steps, total: 54.400, sample: 1.997, forward: 0.631, backward: 0.906, update: 0.259
[proc 7] 500 steps, total: 54.400, sample: 1.860, forward: 0.670, backward: 0.915, update: 0.268
[proc 0] 500 steps, total: 54.400, sample: 4.171, forward: 1.014, backward: 0.706, update: 0.707
[proc 4] 500 steps, total: 54.400, sample: 2.011, forward: 0.632, backward: 0.908, update: 0.382
[proc 2] 500 steps, total: 54.400, sample: 1.937, forward: 0.744, backward: 0.719, update: 0.264
[proc 5] 500 steps, total: 54.400, sample: 1.831, forward: 0.645, backward: 0.870, update: 0.248
[proc 3] 500 steps, total: 54.400, sample: 1.786, forward: 0.760, backward: 0.895, update: 0.267
[proc 1] 500 steps, total: 54.400, sample: 1.705, forward: 0.569, backward: 0.894, update: 0.294
Successfully xmh. training takes 263.34712743759155 seconds
before call kg_cache_controller.StopThreads()
W20240125 01:44:55.053295 28143 grad_async_v2.h:71] call StopThreads. PID = 12868
W20240125 01:44:55.053326 28143 grad_base.h:210] before processOneStepNegThread_.join();
W20240125 01:44:55.066968 28143 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 01:44:55.067025 28143 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240125 01:44:55.095620 28143 grad_async_v2.h:91] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.319 ms                 | 632.997 ms                |
| Forward                   | 5.613 ms                  | 36.538 ms                 |
| Backward                  | 4.737 ms                  | 31.629 ms                 |
| Optimize                  | 2.321 ms                  | 38.700 ms                 |
| BarrierTimeBeforeRank0    | 35.772 us                 | 92.392 ms                 |
| AfterBackward             | 161.025 ms                | 464.162 ms                |
| BlockToStepN              | 187.286 ms                | 991.938 ms                |
| OneStep                   | 487.864 ms                | 1.616 s                   |
+---------------------------+---------------------------+---------------------------+
