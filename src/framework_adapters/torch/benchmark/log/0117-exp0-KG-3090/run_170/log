WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 07:50:29.544272  6800 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_Freebase_5', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [6800 sampler.py:454] Start PreSampling
WARNING [6800 sampler.py:532] Before construct renumbering_dict
WARNING [6800 sampler.py:555] PreSampling done
W20240125 08:18:23.391741  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 08:18:23.392158  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 08:18:23.392220  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 08:18:23.392273  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 08:18:23.392319  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 08:18:23.392351  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 08:18:23.392398  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 08:18:23.392452  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 08:18:23.392485  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 08:18:23.392525  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 08:18:23.392580  6800 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 08:18:23.392618  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 08:18:23.392652  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 08:18:23.392903  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 08:18:23.392973  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 08:18:23.393013  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 08:18:23.393067  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 08:18:23.393100  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 08:18:23.393131  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 08:18:23.393157  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 08:18:23.393195  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 08:18:23.393224  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 08:18:23.393262  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 08:18:23.393301  6800 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 08:18:23.393328  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 08:18:23.393360  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 08:18:23.393450  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 08:18:23.393496  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 08:18:23.393529  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 08:18:23.393563  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 08:18:23.393599  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 08:18:23.393633  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 08:18:23.393669  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 08:18:23.393714  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 08:18:23.393752  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 08:18:23.393785  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 08:18:23.393815  6800 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 08:18:23.393841  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 08:18:23.393864  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 08:18:23.393941  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 08:18:23.393990  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 08:18:23.394048  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 08:18:23.394080  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 08:18:23.394110  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 08:18:23.394148  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 08:18:23.394177  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 08:18:23.394210  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 08:18:23.394250  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 08:18:23.394284  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 08:18:23.394320  6800 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 08:18:23.394345  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 08:18:23.394379  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 08:18:23.394449  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 08:18:23.394528  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 08:18:23.394577  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 08:18:23.394609  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 08:18:23.394649  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 08:18:23.394686  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 08:18:23.394723  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 08:18:23.394759  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 08:18:23.394789  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 08:18:23.394824  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 08:18:23.394855  6800 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 08:18:23.394881  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 08:18:23.394904  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 08:18:23.394976  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 08:18:23.395037  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 08:18:23.395082  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 08:18:23.395123  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 08:18:23.395169  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 08:18:23.395205  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 08:18:23.395236  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 08:18:23.395272  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 08:18:23.395308  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 08:18:23.395344  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 08:18:23.395383  6800 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 08:18:23.395409  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 08:18:23.395432  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 08:18:23.395511  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 08:18:23.395560  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 08:18:23.395592  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 08:18:23.395640  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 08:18:23.395680  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 08:18:23.395728  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 08:18:23.395767  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 08:18:23.395798  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 08:18:23.395834  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 08:18:23.395869  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 08:18:23.395900  6800 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 08:18:23.395939  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 08:18:23.395963  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 08:18:23.396049  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 08:18:23.396096  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 08:18:23.396131  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 08:18:23.396171  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 08:18:23.396226  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 08:18:23.396270  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 08:18:23.396301  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 08:18:23.396343  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 08:18:23.396382  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 08:18:23.396420  6800 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 08:18:23.396451  6800 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 08:18:23.396477  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 08:18:23.396508  6800 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 08:18:24.323482  6800 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 08:18:24.323763  6800 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302718,  4302762,    91924,  ..., 67258730, 23765016, 23338550]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2400.843 seconds
[Rank1] pid = 40191
[Rank2] pid = 40308
[Rank3] pid = 40400
[Rank4] pid = 40491
[Rank5] pid = 40590
[Rank6] pid = 40693
INFO [6800 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [40191 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [40308 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [40400 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [40491 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [40590 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [40191 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40308 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40400 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40491 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40791 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [40693 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [40590 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40791 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40693 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 08:30:47.356379 40796 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240125 08:30:47.356376 40193 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240125 08:30:47.356377 40404 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240125 08:30:47.356379 40311 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240125 08:30:47.356379 40694 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240125 08:30:47.356377 40591 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240125 08:30:47.356379 40492 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
INFO [6800 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 08:30:47.359941 40792 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240125 08:30:47.513661 40792 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x102027251000 781.2 kB
W20240125 08:30:47.513667 40694 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x102027316000 781.2 kB
W20240125 08:30:47.513674 40492 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x1020274a0000 781.2 kB
W20240125 08:30:47.513690 40796 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027565000 781.2 kB
W20240125 08:30:47.513669 40311 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020273db000 781.2 kB
W20240125 08:30:47.513715 40404 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x10202762a000 781.2 kB
W20240125 08:30:47.513728 40591 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020276ef000 781.2 kB
W20240125 08:30:47.513772 40193 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020277b4000 781.2 kB
W20240125 08:30:47.513919 40792 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102027879000 781.2 kB
W20240125 08:30:47.513938 40591 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10202793e000 781.2 kB
W20240125 08:30:47.513944 40796 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x102027a03000 781.2 kB
W20240125 08:30:47.513958 40492 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x102027ac8000 781.2 kB
W20240125 08:30:47.513962 40694 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x102027b8d000 781.2 kB
W20240125 08:30:47.513967 40193 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102027c52000 781.2 kB
W20240125 08:30:47.513981 40404 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x102027d17000 781.2 kB
W20240125 08:30:47.513995 40792 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x102027ddc000 152.6 MB
W20240125 08:30:47.514015 40311 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x102031674000 781.2 kB
W20240125 08:30:47.514045 40792 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x102031739000 152.6 MB
W20240125 08:30:47.514058 40591 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10203afd1000 152.6 MB
W20240125 08:30:47.514065 40492 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x102044869000 152.6 MB
W20240125 08:30:47.514084 40193 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10204e101000 152.6 MB
W20240125 08:30:47.514091 40404 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x102057999000 152.6 MB
W20240125 08:30:47.514096 40796 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x102061231000 152.6 MB
W20240125 08:30:47.514102 40792 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 08:30:47.514122 40694 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10206aac9000 152.6 MB
W20240125 08:30:47.514127 40311 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102074361000 152.6 MB
W20240125 08:30:47.514160 40591 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10207dbf9000 152.6 MB
W20240125 08:30:47.514168 40492 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x102087491000 152.6 MB
W20240125 08:30:47.514175 40193 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x102090d29000 152.6 MB
W20240125 08:30:47.514199 40404 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10209a5c1000 152.6 MB
W20240125 08:30:47.514205 40796 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x1020a3e59000 152.6 MB
W20240125 08:30:47.514233 40311 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020ad6f1000 152.6 MB
W20240125 08:30:47.514240 40694 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x1020b6f89000 152.6 MB
W20240125 08:30:47.514253 40591 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 08:30:47.514266 40492 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 08:30:47.514276 40193 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 08:30:47.514287 40796 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 08:30:47.514288 40404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 08:30:47.514298 40311 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 08:30:47.514307 40694 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 08:30:47.518627 40193 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 08:30:47.518627 40792 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 08:30:47.518633 40404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 08:30:47.518627 40591 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 08:30:47.518627 40492 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 08:30:47.518661 40311 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 08:30:47.518677 40796 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 08:30:47.518711 40694 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [40191 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 40791
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [6800 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [40400 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [40590 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [40693 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [40308 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [40491 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [40791 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 08:32:15.942909 40796 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943053 40404 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943131 40193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943207 40792 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943281 40694 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943356 40591 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.943437 40311 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 08:32:15.944209 40492 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240125 08:32:15.946426 40792 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 08:32:15.946610 40792 grad_base.h:172] Init GradProcessingBase done
I20240125 08:32:33.816007 40792 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 08:32:33.816423 40792 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 08:32:33.816450 40792 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240125 08:32:35.832758 40792 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 08:33:19.062237 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:33:19.063017 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:20.765193 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:33:20.781042 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 08:33:23.902902 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:33:23.903476 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 08:33:25.758399 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:33:25.759212 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 08:33:26.223882 40796 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
E20240125 08:33:26.759049 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
W20240125 08:33:26.775969 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 08:33:30.932904 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:33:30.942668 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 08:33:30.971526 40591 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 08:33:33.429706 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:33:33.443406 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 08:33:33.491025 40311 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 08:33:34.519541 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
E20240125 08:33:34.534317 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 08:33:34.583511 40694 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 08:33:35.553478 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 08:33:37.802721 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:33:37.823274 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 08:33:38.137497 40792 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 08:33:38.293979 40492 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 08:33:38.639026 40404 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 08:33:38.832927 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:38.983085 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
I20240125 08:33:39.293329 40193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 08:33:39.362200 42415 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
E20240125 08:33:39.836928 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 08:33:40.081405 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 56.521 ms                 | 56.521 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.350 s                   | 1.354 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 56.521 ms                 | 56.521 ms                 |
| Forward                   | 1.775 s                   | 1.775 s                   |
| Backward                  | 567.363 ms                | 567.363 ms                |
| Optimize                  | 105.067 ms                | 105.067 ms                |
| BarrierTimeBeforeRank0    | 165.581 ms                | 165.581 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:33:46.364956 41402 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:46.583328 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 08:33:46.701934 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 08:33:47.101130 40792 grad_async_v2.h:236] pq is empty
E20240125 08:33:47.364886 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=5197
W20240125 08:33:47.742805 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 08:33:48.034703 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=5, pq.top=5
E20240125 08:33:48.372829 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:48.839926 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240125 08:33:49.133479 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=6
E20240125 08:33:49.377354 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=864
W20240125 08:33:49.645113 40792 grad_async_v2.h:236] pq is empty
W20240125 08:33:49.971199 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240125 08:33:50.133016 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
E20240125 08:33:50.380856 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 15.581 ms                 | 1.354 s                   |
| ProcessBack:UpdateCache   | 22.945 ms                 | 3.027 s                   |
| ProcessBack:UpsertPq      | 93.689 ms                 | 197.463 ms                |
| ProcessOneStep            | 186.599 ms                | 4.605 s                   |
| BlockToStepN              | 93.585 ms                 | 198.213 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 40.821 ms                 | 253.165 ms                |
| Forward                   | 22.298 ms                 | 1.775 s                   |
| Backward                  | 6.807 ms                  | 567.363 ms                |
| Optimize                  | 2.525 ms                  | 105.067 ms                |
| BarrierTimeBeforeRank0    | 121.681 us                | 165.581 ms                |
| AfterBackward             | 183.729 ms                | 4.615 s                   |
| BlockToStepN              | 16.468 ms                 | 198.442 ms                |
| OneStep                   | 390.760 ms                | 7.428 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:33:51.133020 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240125 08:33:51.161156 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
E20240125 08:33:51.380028 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=764
W20240125 08:33:52.185902 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240125 08:33:52.388913 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=17529
W20240125 08:33:52.621876 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
W20240125 08:33:53.272909 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=19
E20240125 08:33:53.389180 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 08:33:54.152837 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240125 08:33:54.389508 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:55.351459 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
E20240125 08:33:55.389060 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.816 ms                 | 1.354 s                   |
| ProcessBack:UpdateCache   | 24.128 ms                 | 3.027 s                   |
| ProcessBack:UpsertPq      | 51.726 ms                 | 197.463 ms                |
| ProcessOneStep            | 111.451 ms                | 4.605 s                   |
| BlockToStepN              | 93.585 ms                 | 285.376 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 35.523 ms                 | 253.165 ms                |
| Forward                   | 16.805 ms                 | 1.775 s                   |
| Backward                  | 6.807 ms                  | 567.363 ms                |
| Optimize                  | 2.515 ms                  | 105.067 ms                |
| BarrierTimeBeforeRank0    | 94.193 us                 | 165.581 ms                |
| AfterBackward             | 111.550 ms                | 4.615 s                   |
| BlockToStepN              | 93.790 ms                 | 285.603 ms                |
| OneStep                   | 367.226 ms                | 7.428 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:33:56.478760 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 08:33:56.479568 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:33:56.617815 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=23
E20240125 08:33:57.496843 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1927
W20240125 08:33:57.542593 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240125 08:33:57.981163 40792 grad_async_v2.h:236] pq is empty
E20240125 08:33:58.496057 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240125 08:33:58.610222 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 08:33:59.345113 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
E20240125 08:33:59.503564 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=128
W20240125 08:33:59.713650 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240125 08:34:00.503482 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=2232
W20240125 08:34:00.656263 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240125 08:34:00.845798 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.900 ms                 | 1.350 s                   |
| ProcessBack:UpdateCache   | 22.945 ms                 | 3.018 s                   |
| ProcessBack:UpsertPq      | 64.623 ms                 | 399.155 ms                |
| ProcessOneStep            | 183.645 ms                | 4.605 s                   |
| BlockToStepN              | 12.650 ms                 | 285.376 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 35.523 ms                 | 253.165 ms                |
| Forward                   | 15.406 ms                 | 1.775 s                   |
| Backward                  | 6.950 ms                  | 567.363 ms                |
| Optimize                  | 2.585 ms                  | 105.067 ms                |
| BarrierTimeBeforeRank0    | 93.879 us                 | 298.952 ms                |
| AfterBackward             | 183.729 ms                | 4.615 s                   |
| BlockToStepN              | 16.468 ms                 | 285.603 ms                |
| OneStep                   | 380.472 ms                | 7.428 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:01.183331 40792 grad_async_v2.h:236] pq is empty
E20240125 08:34:01.504873 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=10801
W20240125 08:34:01.657673 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240125 08:34:01.872116 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240125 08:34:02.522264 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:02.744447 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240125 08:34:02.912597 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
E20240125 08:34:03.526618 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=626
W20240125 08:34:03.861886 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240125 08:34:04.020982 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
E20240125 08:34:04.526019 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=20128
W20240125 08:34:04.861057 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240125 08:34:05.056973 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
E20240125 08:34:05.526202 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=3160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.350 ms                 | 1.350 s                   |
| ProcessBack:UpdateCache   | 24.128 ms                 | 3.018 s                   |
| ProcessBack:UpsertPq      | 51.726 ms                 | 399.155 ms                |
| ProcessOneStep            | 120.717 ms                | 2.359 s                   |
| BlockToStepN              | 16.260 ms                 | 285.376 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:05.870970 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 33.264 ms                 | 151.194 ms                |
| Forward                   | 15.406 ms                 | 28.769 ms                 |
| Backward                  | 7.257 ms                  | 28.278 ms                 |
| Optimize                  | 2.688 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 129.243 us                | 165.581 ms                |
| AfterBackward             | 120.783 ms                | 2.359 s                   |
| BlockToStepN              | 20.029 ms                 | 211.504 ms                |
| OneStep                   | 344.864 ms                | 7.428 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:06.140501 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
E20240125 08:34:06.526017 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1514
W20240125 08:34:06.880941 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240125 08:34:07.402673 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
E20240125 08:34:07.526017 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=14032
W20240125 08:34:07.894161 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240125 08:34:08.500624 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240125 08:34:08.528007 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=38
E20240125 08:34:09.527016 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=1110
W20240125 08:34:09.556999 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 08:34:09.661914 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
E20240125 08:34:10.527016 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=8230
W20240125 08:34:10.572118 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 08:34:10.807394 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=66, pq.top=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.338 ms                 | 1.350 s                   |
| ProcessBack:UpdateCache   | 23.887 ms                 | 3.018 s                   |
| ProcessBack:UpsertPq      | 45.838 ms                 | 399.155 ms                |
| ProcessOneStep            | 112.476 ms                | 2.359 s                   |
| BlockToStepN              | 18.692 ms                 | 211.192 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.122 ms                 | 151.194 ms                |
| Forward                   | 12.678 ms                 | 44.428 ms                 |
| Backward                  | 7.271 ms                  | 28.278 ms                 |
| Optimize                  | 2.621 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 121.681 us                | 165.581 ms                |
| AfterBackward             | 112.612 ms                | 2.359 s                   |
| BlockToStepN              | 20.029 ms                 | 211.504 ms                |
| OneStep                   | 317.456 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:11.530673 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=6656
W20240125 08:34:11.618422 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240125 08:34:11.821444 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240125 08:34:12.536895 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=16450
W20240125 08:34:12.648209 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 08:34:13.097977 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
E20240125 08:34:13.544910 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:13.669909 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 08:34:14.112974 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=76
E20240125 08:34:14.544028 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=17352
W20240125 08:34:14.678964 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 08:34:15.125027 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240125 08:34:15.544857 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=7775
W20240125 08:34:15.687781 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.390 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 22.599 ms                 | 56.382 ms                 |
| ProcessBack:UpsertPq      | 47.302 ms                 | 387.995 ms                |
| ProcessOneStep            | 118.375 ms                | 2.359 s                   |
| BlockToStepN              | 29.451 ms                 | 225.533 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.788 ms                 | 151.194 ms                |
| Forward                   | 11.938 ms                 | 44.428 ms                 |
| Backward                  | 7.271 ms                  | 28.278 ms                 |
| Optimize                  | 2.612 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 129.243 us                | 165.581 ms                |
| AfterBackward             | 115.790 ms                | 2.359 s                   |
| BlockToStepN              | 26.676 ms                 | 225.735 ms                |
| OneStep                   | 327.928 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:16.125018 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240125 08:34:16.544014 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240125 08:34:16.698921 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 08:34:17.269276 40792 grad_async_v2.h:236] pq is empty
E20240125 08:34:17.544848 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=5556
W20240125 08:34:17.642505 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240125 08:34:17.730599 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 08:34:18.544190 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:18.751430 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
W20240125 08:34:19.013394 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=91
E20240125 08:34:19.544876 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:19.773463 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240125 08:34:20.314157 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
E20240125 08:34:20.544014 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=25432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.151 ms                 | 99.976 ms                 |
| ProcessBack:UpdateCache   | 22.538 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 51.002 ms                 | 387.995 ms                |
| ProcessOneStep            | 125.637 ms                | 2.359 s                   |
| BlockToStepN              | 28.316 ms                 | 225.533 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.922 ms                 | 152.774 ms                |
| Forward                   | 11.342 ms                 | 50.665 ms                 |
| Backward                  | 7.271 ms                  | 28.278 ms                 |
| Optimize                  | 2.593 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 112.415 us                | 165.581 ms                |
| AfterBackward             | 125.701 ms                | 2.359 s                   |
| BlockToStepN              | 28.550 ms                 | 225.735 ms                |
| OneStep                   | 328.000 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:21.061120 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240125 08:34:21.445689 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=98, pq.top=98
E20240125 08:34:21.544015 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=116
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 42.828, sample: 1.425, forward: 2.595, backward: 1.763, update: 0.358
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 51.150, sample: 1.344, forward: 2.314, backward: 1.512, update: 0.334
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 47.538, sample: 1.433, forward: 2.589, backward: 1.626, update: 0.334
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 43.482, sample: 1.703, forward: 2.605, backward: 1.527, update: 0.508
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 43.827, sample: 1.462, forward: 2.488, backward: 1.477, update: 0.358
train_sampler.Prefill()
-------Step 0-------
tensor([443166, 310006, 390757, 310029, 310051, 310075, 443180, 310099, 310118,
        310143]) tensor([ 5463339, 10012344, 40678961, 64454071, 15492604,   384182, 13928779,
        69467434, 38588938, 36864440])
-------Step 1-------
tensor([443166, 310006, 390757, 310029, 310051, 310075, 443180, 310099, 310118,
        310143]) tensor([20164653, 23343258, 76180674,  4961355, 81090239,  6798269,  5097338,
        11373489, 53871888,  7188408])
-------Step 2-------
tensor([   43208,   332902, 31912891,   332925,    43215,   443455,   332942,
          332978,   333005, 38161438]) tensor([83127517, 85148562, 53774565, 12545316, 33426986, 80453442, 32863899,
        43317212, 19373967, 62718855])
-------Step 3-------
tensor([   43208,   332902, 31912891,   332925,    43215,   443455,   332942,
          332978,   333005, 38161438]) tensor([67657631, 50085582, 62562983, 26300286,   171609, 16069767, 44420609,
        29665459, 51425963, 38838068])
-------Step 4-------
tensor([   24141,   355721, 38334422,    34146,   355743,   355764,   355781,
          355796,   355812,   355837]) tensor([62342455, 39466033,  1266903, 36169238, 27807141, 29390032,  8333917,
        45952620, 48997373, 25454579])
-------Step 5-------
tensor([   24141,   355721, 38334422,    34146,   355743,   355764,   355781,
          355796,   355812,   355837]) tensor([59796570, 31782627, 57806904,  5628573, 67915198, 51715003,  5480582,
        74200848, 78249799, 65455846])
-------Step 6-------
tensor([  378547,   378564,   378583,   378605, 54248788,   378628,   378647,
          202525,   378668,   457068]) tensor([39439764, 53237079, 83029997,  1606492, 74685834, 76633248, 51303336,
        18575175, 82998768, 83021314])
-------Step 7-------
tensor([  378547,   378564,   378583,   378605, 54248788,   378628,   378647,
          202525,   378668,   457068]) tensor([56314975, 33914684, 52169130, 57500424, 61185495,   499427, 56487627,
        75164439, 64688171, 80153806])
-------Step 8-------
tensor([26306218,   401250,   401271,   401285,   401300,   401321,   401333,
          401354,   401369, 32221081]) tensor([52106904, 41234263, 57813362, 27527389,   151660,  4343148, 28243369,
        63456848, 79348067,  9093466])
-------Step 9-------
tensor([26306218,   401250,   401271,   401285,   401300,   401321,   401333,
          401354,   401369, 32221081]) tensor([80309101, 21023623, 13909961, 26849843, 41925082, 27297047, 76204541,
        49117640, 82523503, 27313490])
before start barrier
start train
[proc 0] 100 steps, total: 43.984, sample: 3.561, forward: 3.046, backward: 1.550, update: 0.512
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 48.633, sample: 1.399, forward: 2.666, backward: 1.512, update: 0.430
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.905, sample: 1.513, forward: 2.689, backward: 1.591, update: 0.360
W20240125 08:34:22.241971 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 08:34:22.445112 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240125 08:34:22.544023 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240125 08:34:23.250744 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
E20240125 08:34:23.545532 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:23.620512 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240125 08:34:24.287937 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 08:34:24.547201 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=1771
W20240125 08:34:24.719424 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240125 08:34:25.384457 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240125 08:34:25.556875 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=20252
W20240125 08:34:25.719311 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=112, pq.top=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.151 ms                 | 99.976 ms                 |
| ProcessBack:UpdateCache   | 22.421 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 47.227 ms                 | 387.995 ms                |
| ProcessOneStep            | 120.717 ms                | 2.359 s                   |
| BlockToStepN              | 39.653 ms                 | 285.376 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 20.678 ms                 | 175.784 ms                |
| Forward                   | 10.716 ms                 | 50.665 ms                 |
| Backward                  | 7.271 ms                  | 28.278 ms                 |
| Optimize                  | 2.593 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 109.621 us                | 165.581 ms                |
| AfterBackward             | 120.783 ms                | 2.359 s                   |
| BlockToStepN              | 39.910 ms                 | 285.603 ms                |
| OneStep                   | 328.000 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:26.556865 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=16473
W20240125 08:34:26.587865 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240125 08:34:27.003466 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=116
E20240125 08:34:27.557945 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=550
W20240125 08:34:27.590979 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240125 08:34:28.340286 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
E20240125 08:34:28.558952 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=28053
W20240125 08:34:28.664022 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240125 08:34:29.558662 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=5614
W20240125 08:34:29.582571 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=124
W20240125 08:34:29.740412 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 08:34:30.558017 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=15880
W20240125 08:34:30.582147 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240125 08:34:30.763638 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.521 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 22.538 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 46.114 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.375 ms                | 2.359 s                   |
| BlockToStepN              | 46.601 ms                 | 294.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.244 ms                 | 175.784 ms                |
| Forward                   | 10.960 ms                 | 73.178 ms                 |
| Backward                  | 7.292 ms                  | 28.278 ms                 |
| Optimize                  | 2.621 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 96.130 us                 | 165.581 ms                |
| AfterBackward             | 118.492 ms                | 2.359 s                   |
| BlockToStepN              | 51.218 ms                 | 295.134 ms                |
| OneStep                   | 327.928 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:31.562031 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=24756
W20240125 08:34:31.768184 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 08:34:31.802521 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=131, pq.top=131
E20240125 08:34:32.618278 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=14401
W20240125 08:34:32.800863 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:34:33.501927 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240125 08:34:33.622316 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=9705
W20240125 08:34:33.814618 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 08:34:34.622014 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=820
W20240125 08:34:34.649756 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240125 08:34:34.912271 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:34:35.624895 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=2837
W20240125 08:34:35.847431 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.338 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 22.538 ms                 | 146.868 ms                |
| ProcessBack:UpsertPq      | 48.060 ms                 | 319.962 ms                |
| ProcessOneStep            | 120.681 ms                | 2.359 s                   |
| BlockToStepN              | 49.923 ms                 | 294.887 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:35.964466 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 20.678 ms                 | 175.784 ms                |
| Forward                   | 10.369 ms                 | 73.178 ms                 |
| Backward                  | 7.257 ms                  | 28.278 ms                 |
| Optimize                  | 2.587 ms                  | 97.722 ms                 |
| BarrierTimeBeforeRank0    | 98.844 us                 | 165.581 ms                |
| AfterBackward             | 120.747 ms                | 2.359 s                   |
| BlockToStepN              | 75.481 ms                 | 295.134 ms                |
| OneStep                   | 327.928 ms                | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:36.637265 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=7246
W20240125 08:34:36.904569 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240125 08:34:37.001024 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 08:34:37.640866 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=14168
W20240125 08:34:38.165693 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 08:34:38.506959 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
E20240125 08:34:38.640033 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=20133
W20240125 08:34:38.929495 40792 grad_async_v2.h:236] pq is empty
W20240125 08:34:39.246796 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240125 08:34:39.641736 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1719
W20240125 08:34:40.171366 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240125 08:34:40.496482 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
E20240125 08:34:40.642469 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.353 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 22.291 ms                 | 146.868 ms                |
| ProcessBack:UpsertPq      | 50.959 ms                 | 340.597 ms                |
| ProcessOneStep            | 123.553 ms                | 1.029 s                   |
| BlockToStepN              | 46.601 ms                 | 294.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.222 ms                 | 167.865 ms                |
| Forward                   | 9.974 ms                  | 50.665 ms                 |
| Backward                  | 7.271 ms                  | 25.758 ms                 |
| Optimize                  | 2.574 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 98.844 us                 | 147.265 ms                |
| AfterBackward             | 123.630 ms                | 1.029 s                   |
| BlockToStepN              | 51.218 ms                 | 295.134 ms                |
| OneStep                   | 338.464 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:41.252665 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=155
W20240125 08:34:41.609228 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 08:34:41.645987 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=23277
W20240125 08:34:42.357901 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=160
E20240125 08:34:42.645020 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=10648
W20240125 08:34:42.686878 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
W20240125 08:34:43.459821 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=163, pq.top=163
E20240125 08:34:43.645033 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=23061
W20240125 08:34:43.699705 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240125 08:34:44.645015 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=1806
W20240125 08:34:44.648214 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240125 08:34:44.713994 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:34:45.645017 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=47
W20240125 08:34:45.665848 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240125 08:34:45.722489 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.256 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 22.421 ms                 | 146.868 ms                |
| ProcessBack:UpsertPq      | 48.538 ms                 | 340.597 ms                |
| ProcessOneStep            | 118.375 ms                | 1.029 s                   |
| BlockToStepN              | 49.923 ms                 | 320.393 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 20.431 ms                 | 167.865 ms                |
| Forward                   | 9.645 ms                  | 50.665 ms                 |
| Backward                  | 7.257 ms                  | 25.758 ms                 |
| Optimize                  | 2.567 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 147.265 ms                |
| AfterBackward             | 118.492 ms                | 1.029 s                   |
| BlockToStepN              | 65.825 ms                 | 320.602 ms                |
| OneStep                   | 330.224 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:46.646797 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:46.725129 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:34:46.725598 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=174, pq.top=174
E20240125 08:34:47.646016 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=27727
W20240125 08:34:47.785684 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 08:34:48.108587 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240125 08:34:48.656908 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=14247
W20240125 08:34:48.803501 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 08:34:49.371901 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240125 08:34:49.656831 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=22056
W20240125 08:34:49.904784 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:34:50.657475 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 08:34:50.826776 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.110 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 22.272 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 47.584 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.214 ms                | 1.029 s                   |
| BlockToStepN              | 56.960 ms                 | 329.029 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:50.970486 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.554 ms                 | 178.935 ms                |
| Forward                   | 9.796 ms                  | 73.178 ms                 |
| Backward                  | 7.249 ms                  | 28.278 ms                 |
| Optimize                  | 2.555 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 147.265 ms                |
| AfterBackward             | 118.282 ms                | 1.029 s                   |
| BlockToStepN              | 62.796 ms                 | 329.260 ms                |
| OneStep                   | 327.928 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:34:51.695550 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=64388
W20240125 08:34:51.991957 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 08:34:52.050568 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=191, pq.top=191
E20240125 08:34:52.695250 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=30894
W20240125 08:34:53.006250 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 08:34:53.176208 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
E20240125 08:34:53.695012 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=8009
W20240125 08:34:54.143193 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:34:54.481359 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240125 08:34:54.700865 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=203
W20240125 08:34:55.295183 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 7] 200 steps, total: 33.348, sample: 1.217, forward: 0.878, backward: 0.955, update: 0.242
[proc 3] 200 steps, total: 33.356, sample: 1.310, forward: 0.931, backward: 1.113, update: 0.238
[proc 1] 200 steps, total: 33.356, sample: 1.555, forward: 0.731, backward: 1.003, update: 0.263
[proc 0] 200 steps, total: 33.354, sample: 3.244, forward: 1.401, backward: 0.958, update: 0.321
[proc 6] 200 steps, total: 33.356, sample: 1.160, forward: 0.895, backward: 0.839, update: 0.254
[proc 2] 200 steps, total: 33.354, sample: 1.572, forward: 0.845, backward: 1.108, update: 0.268
[proc 5] 200 steps, total: 33.356, sample: 1.273, forward: 0.950, backward: 0.872, update: 0.359
[proc 4] 200 steps, total: 33.357, sample: 1.407, forward: 0.913, backward: 1.138, update: 0.264
W20240125 08:34:55.681108 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=201
E20240125 08:34:55.701192 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=10055
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.835 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 22.291 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 48.060 ms                 | 319.962 ms                |
| ProcessOneStep            | 116.823 ms                | 1.029 s                   |
| BlockToStepN              | 62.574 ms                 | 334.711 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.016 ms                 | 178.935 ms                |
| Forward                   | 9.974 ms                  | 80.375 ms                 |
| Backward                  | 7.271 ms                  | 28.278 ms                 |
| Optimize                  | 2.559 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 107.419 us                | 147.265 ms                |
| AfterBackward             | 116.890 ms                | 1.029 s                   |
| BlockToStepN              | 65.825 ms                 | 337.347 ms                |
| OneStep                   | 327.928 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:34:56.376161 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 08:34:56.701014 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=24513
W20240125 08:34:56.988327 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=204, pq.top=204
W20240125 08:34:57.439822 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 08:34:57.701032 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=4312
W20240125 08:34:57.988723 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240125 08:34:58.515298 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 08:34:58.701016 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=21639
W20240125 08:34:59.133296 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240125 08:34:59.586869 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:34:59.707319 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=30420
W20240125 08:35:00.250066 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240125 08:35:00.608379 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:35:00.711087 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=2443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.971 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 22.272 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 48.529 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.375 ms                | 1.029 s                   |
| BlockToStepN              | 62.574 ms                 | 396.795 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.032 ms                 | 178.935 ms                |
| Forward                   | 9.985 ms                  | 80.375 ms                 |
| Backward                  | 7.304 ms                  | 39.296 ms                 |
| Optimize                  | 2.569 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 105.755 us                | 147.265 ms                |
| AfterBackward             | 118.982 ms                | 1.029 s                   |
| BlockToStepN              | 65.825 ms                 | 397.008 ms                |
| OneStep                   | 328.000 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:01.504319 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=216, pq.top=215
W20240125 08:35:01.620689 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:35:01.712878 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=4227
W20240125 08:35:02.554733 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=220, pq.top=219
W20240125 08:35:02.647261 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 08:35:02.711695 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=34828
W20240125 08:35:03.554960 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=223, pq.top=223
E20240125 08:35:03.711169 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=32583
W20240125 08:35:03.772850 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:35:04.684566 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240125 08:35:04.712839 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=20683
W20240125 08:35:04.781510 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:35:05.684110 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240125 08:35:05.785805 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:35:05.785970 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.252 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 22.132 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 47.302 ms                 | 281.269 ms                |
| ProcessOneStep            | 118.609 ms                | 1.029 s                   |
| BlockToStepN              | 72.399 ms                 | 396.795 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.925 ms                 | 178.935 ms                |
| Forward                   | 9.985 ms                  | 80.375 ms                 |
| Backward                  | 7.314 ms                  | 40.335 ms                 |
| Optimize                  | 2.578 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 98.844 us                 | 147.265 ms                |
| AfterBackward             | 118.982 ms                | 1.029 s                   |
| BlockToStepN              | 75.481 ms                 | 397.008 ms                |
| OneStep                   | 328.000 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:06.771970 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=233
E20240125 08:35:06.785015 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=284
W20240125 08:35:06.798792 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 08:35:07.785017 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=8484
W20240125 08:35:07.834470 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:35:07.835325 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240125 08:35:08.803787 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=27440
W20240125 08:35:08.876466 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 08:35:08.879755 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=240, pq.top=240
E20240125 08:35:09.881750 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=9521
W20240125 08:35:09.886837 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 08:35:10.079298 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.971 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 22.054 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 46.333 ms                 | 281.269 ms                |
| ProcessOneStep            | 118.375 ms                | 1.029 s                   |
| BlockToStepN              | 76.249 ms                 | 396.795 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:10.896914 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=64671
W20240125 08:35:10.964304 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.834 ms                 | 178.935 ms                |
| Forward                   | 9.502 ms                  | 80.375 ms                 |
| Backward                  | 7.451 ms                  | 40.335 ms                 |
| Optimize                  | 2.569 ms                  | 73.796 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 147.265 ms                |
| AfterBackward             | 118.492 ms                | 1.029 s                   |
| BlockToStepN              | 79.512 ms                 | 397.008 ms                |
| OneStep                   | 330.224 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:11.123414 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=246, pq.top=246
E20240125 08:35:11.896868 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=15590
W20240125 08:35:12.165267 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 08:35:12.653247 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=247
E20240125 08:35:12.896382 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=21507
W20240125 08:35:13.190651 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 08:35:13.814942 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=252, pq.top=252
E20240125 08:35:13.900010 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=4924
W20240125 08:35:14.287573 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:35:14.814888 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=255, pq.top=255
E20240125 08:35:14.900839 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=25217
W20240125 08:35:15.352866 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:35:15.829980 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.110 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 21.896 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 46.256 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.375 ms                | 479.175 ms                |
| BlockToStepN              | 79.893 ms                 | 396.795 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:15.900018 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=28773
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 175.784 ms                |
| Forward                   | 9.502 ms                  | 73.178 ms                 |
| Backward                  | 7.393 ms                  | 39.296 ms                 |
| Optimize                  | 2.567 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 147.040 ms                |
| AfterBackward             | 118.492 ms                | 479.248 ms                |
| BlockToStepN              | 80.088 ms                 | 397.008 ms                |
| OneStep                   | 333.876 ms                | 937.569 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:16.430652 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 08:35:16.903888 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=33183
W20240125 08:35:17.359616 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240125 08:35:17.507247 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240125 08:35:17.905215 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=69766
W20240125 08:35:18.528906 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
E20240125 08:35:18.906597 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=5643
W20240125 08:35:18.981092 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240125 08:35:19.613140 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240125 08:35:19.908964 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=9409
W20240125 08:35:20.229333 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240125 08:35:20.613895 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.134 ms                 | 98.370 ms                 |
| ProcessBack:UpdateCache   | 21.896 ms                 | 84.787 ms                 |
| ProcessBack:UpsertPq      | 47.584 ms                 | 324.100 ms                |
| ProcessOneStep            | 119.539 ms                | 517.493 ms                |
| BlockToStepN              | 79.893 ms                 | 396.795 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:20.908833 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=43174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.705 ms                 | 178.935 ms                |
| Forward                   | 9.689 ms                  | 73.178 ms                 |
| Backward                  | 7.442 ms                  | 39.296 ms                 |
| Optimize                  | 2.568 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 95.200 us                 | 147.040 ms                |
| AfterBackward             | 119.603 ms                | 517.565 ms                |
| BlockToStepN              | 81.287 ms                 | 397.008 ms                |
| OneStep                   | 336.059 ms                | 937.569 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:21.336077 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240125 08:35:21.843137 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:35:21.921206 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=27717
W20240125 08:35:22.336768 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240125 08:35:22.892107 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 08:35:22.921016 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=41081
W20240125 08:35:23.337653 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240125 08:35:23.906975 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 08:35:23.921012 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=663
W20240125 08:35:24.702255 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240125 08:35:24.921697 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=17003
W20240125 08:35:25.312863 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 08:35:25.715713 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.971 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 21.840 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 47.302 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.843 ms                | 517.493 ms                |
| BlockToStepN              | 79.893 ms                 | 572.795 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:25.923027 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=24519
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 178.935 ms                |
| Forward                   | 9.796 ms                  | 73.178 ms                 |
| Backward                  | 7.547 ms                  | 39.296 ms                 |
| Optimize                  | 2.567 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 95.200 us                 | 147.040 ms                |
| AfterBackward             | 118.918 ms                | 517.565 ms                |
| BlockToStepN              | 81.287 ms                 | 573.213 ms                |
| OneStep                   | 335.813 ms                | 937.569 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:26.344451 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 08:35:26.923013 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=5698
W20240125 08:35:26.970479 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240125 08:35:27.350966 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 08:35:27.924829 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=39941
W20240125 08:35:28.017581 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240125 08:35:28.373761 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:35:28.924021 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=3668
W20240125 08:35:29.019366 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240125 08:35:29.476433 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 08:35:29.924875 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=4738
W20240125 08:35:30.163028 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240125 08:35:30.526358 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.900 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 21.709 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 46.191 ms                 | 319.962 ms                |
| ProcessOneStep            | 116.823 ms                | 517.493 ms                |
| BlockToStepN              | 81.046 ms                 | 572.795 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:30.924593 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=25976
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.806 ms                 | 185.279 ms                |
| Forward                   | 9.974 ms                  | 73.178 ms                 |
| Backward                  | 7.889 ms                  | 40.335 ms                 |
| Optimize                  | 2.559 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 98.844 us                 | 147.040 ms                |
| AfterBackward             | 116.890 ms                | 517.565 ms                |
| BlockToStepN              | 82.430 ms                 | 573.213 ms                |
| OneStep                   | 333.876 ms                | 937.569 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 35.700, sample: 1.140, forward: 0.876, backward: 1.016, update: 0.262
[proc 0] 300 steps, total: 35.710, sample: 3.177, forward: 1.340, backward: 1.221, update: 0.265
[proc 6] 300 steps, total: 35.704, sample: 1.057, forward: 0.823, backward: 0.918, update: 0.239
[proc 1] 300 steps, total: 35.724, sample: 1.250, forward: 0.868, backward: 0.882, update: 0.244
[proc 7] 300 steps, total: 35.737, sample: 1.188, forward: 0.772, backward: 1.064, update: 0.246
[proc 4] 300 steps, total: 35.713, sample: 1.054, forward: 0.867, backward: 0.927, update: 0.238
[proc 5] 300 steps, total: 35.724, sample: 1.151, forward: 0.969, backward: 0.992, update: 0.268
[proc 3] 300 steps, total: 35.744, sample: 1.174, forward: 0.813, backward: 1.212, update: 0.251
W20240125 08:35:31.374708 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240125 08:35:31.546799 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:35:31.972086 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=75311
W20240125 08:35:32.456189 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240125 08:35:32.580085 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:35:32.972024 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240125 08:35:33.505558 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=306, pq.top=305
W20240125 08:35:33.620205 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 08:35:33.972019 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=26167
W20240125 08:35:34.632601 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:35:34.975870 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=4071
W20240125 08:35:35.030130 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240125 08:35:35.671649 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.501 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 21.709 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 46.709 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.214 ms                | 517.493 ms                |
| BlockToStepN              | 82.932 ms                 | 593.661 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:35.975018 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=28938
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.812 ms                 | 185.279 ms                |
| Forward                   | 9.796 ms                  | 73.178 ms                 |
| Backward                  | 7.989 ms                  | 40.335 ms                 |
| Optimize                  | 2.557 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 102.119 us                | 147.040 ms                |
| AfterBackward             | 118.282 ms                | 517.565 ms                |
| BlockToStepN              | 82.430 ms                 | 593.862 ms                |
| OneStep                   | 332.945 ms                | 948.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:36.249974 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240125 08:35:36.758773 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 08:35:36.976442 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=85936
W20240125 08:35:37.533958 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240125 08:35:37.801671 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:35:37.976518 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=23176
W20240125 08:35:38.644264 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240125 08:35:38.830878 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:35:38.976015 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=1796
W20240125 08:35:39.644629 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240125 08:35:39.860842 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:35:39.977699 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=2379
W20240125 08:35:40.853847 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240125 08:35:40.871582 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.945 ms                 | 91.447 ms                 |
| ProcessBack:UpdateCache   | 21.663 ms                 | 72.657 ms                 |
| ProcessBack:UpsertPq      | 47.126 ms                 | 319.962 ms                |
| ProcessOneStep            | 119.157 ms                | 517.493 ms                |
| BlockToStepN              | 82.932 ms                 | 593.661 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:40.977023 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=914
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.569 ms                 | 185.279 ms                |
| Forward                   | 9.689 ms                  | 73.178 ms                 |
| Backward                  | 8.061 ms                  | 40.335 ms                 |
| Optimize                  | 2.561 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 105.755 us                | 147.040 ms                |
| AfterBackward             | 119.222 ms                | 517.565 ms                |
| BlockToStepN              | 83.146 ms                 | 593.862 ms                |
| OneStep                   | 332.945 ms                | 948.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:41.853019 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240125 08:35:41.964627 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 08:35:41.982061 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=193
W20240125 08:35:42.858390 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240125 08:35:42.982939 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=34046
W20240125 08:35:42.998026 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:35:43.982034 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=36806
W20240125 08:35:44.013743 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240125 08:35:44.028932 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 08:35:44.982605 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=95716
W20240125 08:35:45.043740 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:35:45.186508 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=337
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.945 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 21.663 ms                 | 64.273 ms                 |
| ProcessBack:UpsertPq      | 46.825 ms                 | 311.712 ms                |
| ProcessOneStep            | 118.375 ms                | 517.493 ms                |
| BlockToStepN              | 84.971 ms                 | 593.661 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:45.988864 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=153303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 194.675 ms                |
| Forward                   | 9.796 ms                  | 73.178 ms                 |
| Backward                  | 8.128 ms                  | 40.335 ms                 |
| Optimize                  | 2.561 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 98.844 us                 | 147.040 ms                |
| AfterBackward             | 118.492 ms                | 517.565 ms                |
| BlockToStepN              | 91.207 ms                 | 593.862 ms                |
| OneStep                   | 334.017 ms                | 948.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:46.059880 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 08:35:46.422097 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=341
E20240125 08:35:46.988015 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=187454
W20240125 08:35:47.153620 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 08:35:47.423421 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240125 08:35:47.988014 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=15340
W20240125 08:35:48.424500 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240125 08:35:48.904141 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:35:48.988011 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=3197
W20240125 08:35:49.428905 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240125 08:35:49.976356 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:35:49.988016 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=41620
W20240125 08:35:50.499589 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.971 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 21.657 ms                 | 64.273 ms                 |
| ProcessBack:UpsertPq      | 46.256 ms                 | 311.712 ms                |
| ProcessOneStep            | 118.214 ms                | 517.493 ms                |
| BlockToStepN              | 90.964 ms                 | 615.671 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:50.988178 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=32710
W20240125 08:35:50.991822 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 194.675 ms                |
| Forward                   | 9.502 ms                  | 73.178 ms                 |
| Backward                  | 8.128 ms                  | 40.335 ms                 |
| Optimize                  | 2.555 ms                  | 65.724 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 147.040 ms                |
| AfterBackward             | 118.282 ms                | 517.565 ms                |
| BlockToStepN              | 91.207 ms                 | 615.897 ms                |
| OneStep                   | 333.876 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:51.499684 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
E20240125 08:35:51.988014 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=2947
W20240125 08:35:52.020987 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 08:35:52.688881 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=354, pq.top=353
E20240125 08:35:52.988013 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=2503
W20240125 08:35:53.023818 42416 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 08:35:53.688938 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240125 08:35:53.996847 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=39041
W20240125 08:35:54.031728 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 08:35:54.834296 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=360, pq.top=360
E20240125 08:35:54.996939 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=74271
W20240125 08:35:55.056625 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 08:35:55.858290 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.983 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 21.657 ms                 | 64.273 ms                 |
| ProcessBack:UpsertPq      | 47.302 ms                 | 311.712 ms                |
| ProcessOneStep            | 119.157 ms                | 479.175 ms                |
| BlockToStepN              | 84.609 ms                 | 593.661 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:35:55.996016 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=122739
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.172 ms                 | 187.145 ms                |
| Forward                   | 9.502 ms                  | 50.665 ms                 |
| Backward                  | 8.121 ms                  | 39.296 ms                 |
| Optimize                  | 2.555 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 105.755 us                | 121.417 ms                |
| AfterBackward             | 119.222 ms                | 479.248 ms                |
| BlockToStepN              | 85.196 ms                 | 593.862 ms                |
| OneStep                   | 333.876 ms                | 948.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:35:56.165762 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 08:35:56.858155 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240125 08:35:56.996017 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=158326
W20240125 08:35:57.190026 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:35:57.871188 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240125 08:35:57.996302 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=6513
W20240125 08:35:58.241585 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:35:58.996973 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=28282
W20240125 08:35:59.234320 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240125 08:35:59.299458 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 08:36:00.003676 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=90725
W20240125 08:36:00.370373 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 08:36:00.422977 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.134 ms                 | 87.757 ms                 |
| ProcessBack:UpdateCache   | 21.844 ms                 | 64.273 ms                 |
| ProcessBack:UpsertPq      | 47.126 ms                 | 319.962 ms                |
| ProcessOneStep            | 119.702 ms                | 479.175 ms                |
| BlockToStepN              | 84.971 ms                 | 615.671 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:01.009028 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=2189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.312 ms                 | 187.145 ms                |
| Forward                   | 9.247 ms                  | 50.665 ms                 |
| Backward                  | 8.217 ms                  | 39.296 ms                 |
| Optimize                  | 2.555 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 102.119 us                | 121.417 ms                |
| AfterBackward             | 119.812 ms                | 479.248 ms                |
| BlockToStepN              | 85.196 ms                 | 615.897 ms                |
| OneStep                   | 335.813 ms                | 1.034 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 08:36:01.407469 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:36:01.565608 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=376
E20240125 08:36:02.014145 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=5626
W20240125 08:36:02.412364 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:36:02.572980 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=376
E20240125 08:36:03.018561 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=27868
W20240125 08:36:03.469780 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 08:36:03.584141 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240125 08:36:04.018018 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=75601
W20240125 08:36:04.469391 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 08:36:04.650890 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=383
E20240125 08:36:05.020448 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=134609
W20240125 08:36:05.482918 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:36:05.817667 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.983 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 21.840 ms                 | 57.283 ms                 |
| ProcessBack:UpsertPq      | 46.421 ms                 | 311.712 ms                |
| ProcessOneStep            | 119.539 ms                | 479.175 ms                |
| BlockToStepN              | 90.964 ms                 | 632.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.172 ms                 | 187.145 ms                |
| Forward                   | 9.306 ms                  | 50.665 ms                 |
| Backward                  | 8.128 ms                  | 39.296 ms                 |
| Optimize                  | 2.553 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 101.317 us                | 121.417 ms                |
| AfterBackward             | 119.603 ms                | 479.248 ms                |
| BlockToStepN              | 92.352 ms                 | 632.776 ms                |
| OneStep                   | 335.813 ms                | 1.034 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:06.027544 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=186094
W20240125 08:36:06.559739 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:36:07.029263 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=2661
W20240125 08:36:07.091168 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240125 08:36:07.564313 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:36:08.030001 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=4734
W20240125 08:36:08.093968 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
W20240125 08:36:08.876616 42416 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 08:36:09.053073 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=11057
W20240125 08:36:09.615913 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240125 08:36:09.917855 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:36:10.053017 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=25152
W20240125 08:36:10.857167 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.102 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 21.955 ms                 | 57.491 ms                 |
| ProcessBack:UpsertPq      | 46.183 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.894 ms                | 517.493 ms                |
| BlockToStepN              | 92.164 ms                 | 658.599 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.043 ms                 | 187.145 ms                |
| Forward                   | 9.645 ms                  | 73.058 ms                 |
| Backward                  | 8.121 ms                  | 39.296 ms                 |
| Optimize                  | 2.551 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 102.119 us                | 121.417 ms                |
| AfterBackward             | 118.982 ms                | 517.565 ms                |
| BlockToStepN              | 92.352 ms                 | 658.815 ms                |
| OneStep                   | 336.059 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:11.060258 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=83848
W20240125 08:36:11.074689 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
[proc 2] 400 steps, total: 40.608, sample: 1.178, forward: 0.904, backward: 1.027, update: 0.321
[proc 7] 400 steps, total: 40.580, sample: 1.203, forward: 0.936, backward: 1.053, update: 0.249
[proc 0] 400 steps, total: 40.608, sample: 3.301, forward: 1.336, backward: 1.070, update: 0.268
[proc 3] 400 steps, total: 40.574, sample: 1.031, forward: 0.918, backward: 1.090, update: 0.269
[proc 5] 400 steps, total: 40.575, sample: 1.177, forward: 0.995, backward: 0.999, update: 0.247
[proc 6] 400 steps, total: 40.604, sample: 1.086, forward: 0.820, backward: 0.971, update: 0.249
[proc 4] 400 steps, total: 40.581, sample: 1.019, forward: 0.835, backward: 0.947, update: 0.261
[proc 1] 400 steps, total: 40.597, sample: 1.289, forward: 0.845, backward: 1.070, update: 0.288
W20240125 08:36:11.985038 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240125 08:36:12.075979 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=132412
W20240125 08:36:12.090986 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:36:13.075409 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=180112
W20240125 08:36:13.099836 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:36:13.169234 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=404, pq.top=404
E20240125 08:36:14.075014 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=216031
W20240125 08:36:14.113432 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:36:14.221122 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 08:36:15.080638 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=3959
W20240125 08:36:15.222573 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=408
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.983 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 22.021 ms                 | 57.491 ms                 |
| ProcessBack:UpsertPq      | 45.806 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.609 ms                | 517.493 ms                |
| BlockToStepN              | 93.585 ms                 | 658.599 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 187.145 ms                |
| Forward                   | 9.689 ms                  | 73.058 ms                 |
| Backward                  | 8.056 ms                  | 39.296 ms                 |
| Optimize                  | 2.545 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 107.419 us                | 121.417 ms                |
| AfterBackward             | 118.685 ms                | 517.565 ms                |
| BlockToStepN              | 93.790 ms                 | 658.815 ms                |
| OneStep                   | 336.873 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:16.080672 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=4267
W20240125 08:36:16.236044 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 08:36:16.509912 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=409, pq.top=408
E20240125 08:36:17.085016 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
W20240125 08:36:17.269927 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 08:36:17.510030 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240125 08:36:18.085021 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=9310
W20240125 08:36:18.338939 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:36:18.562003 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=414
E20240125 08:36:19.085036 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=17939
W20240125 08:36:19.362107 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:36:19.778209 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240125 08:36:20.101128 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=59016
W20240125 08:36:20.413901 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.098 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 22.021 ms                 | 57.491 ms                 |
| ProcessBack:UpsertPq      | 45.838 ms                 | 319.962 ms                |
| ProcessOneStep            | 119.157 ms                | 517.493 ms                |
| BlockToStepN              | 94.715 ms                 | 742.890 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:36:20.957945 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=420, pq.top=420
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.172 ms                 | 187.145 ms                |
| Forward                   | 9.645 ms                  | 73.058 ms                 |
| Backward                  | 8.121 ms                  | 39.296 ms                 |
| Optimize                  | 2.550 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 107.419 us                | 121.417 ms                |
| AfterBackward             | 119.222 ms                | 517.565 ms                |
| BlockToStepN              | 93.790 ms                 | 743.114 ms                |
| OneStep                   | 338.464 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:21.110244 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=94697
W20240125 08:36:21.536468 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:36:22.116833 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=139082
W20240125 08:36:22.143913 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240125 08:36:22.593204 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:36:23.116015 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=179180
W20240125 08:36:23.258396 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=426, pq.top=425
W20240125 08:36:23.644587 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:36:24.116019 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=215112
W20240125 08:36:24.263689 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240125 08:36:24.648829 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:36:25.118806 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=247809
W20240125 08:36:25.520942 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240125 08:36:25.847963 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.134 ms                 | 86.528 ms                 |
| ProcessBack:UpdateCache   | 21.942 ms                 | 57.283 ms                 |
| ProcessBack:UpsertPq      | 45.806 ms                 | 311.712 ms                |
| ProcessOneStep            | 119.539 ms                | 517.493 ms                |
| BlockToStepN              | 94.715 ms                 | 742.890 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 194.675 ms                |
| Forward                   | 9.318 ms                  | 73.058 ms                 |
| Backward                  | 8.128 ms                  | 39.296 ms                 |
| Optimize                  | 2.550 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 105.755 us                | 129.473 ms                |
| AfterBackward             | 119.603 ms                | 517.565 ms                |
| BlockToStepN              | 96.996 ms                 | 743.114 ms                |
| OneStep                   | 338.626 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:26.120394 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=277256
W20240125 08:36:26.526764 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240125 08:36:26.847569 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 08:36:27.128911 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=313482
W20240125 08:36:27.590118 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 08:36:28.131529 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=16560
W20240125 08:36:28.591867 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 08:36:29.132550 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=19089
W20240125 08:36:29.593320 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 08:36:30.133288 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=21151
W20240125 08:36:30.596810 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.110 ms                 | 86.528 ms                 |
| ProcessBack:UpdateCache   | 21.896 ms                 | 57.283 ms                 |
| ProcessBack:UpsertPq      | 45.451 ms                 | 311.712 ms                |
| ProcessOneStep            | 118.894 ms                | 517.493 ms                |
| BlockToStepN              | 93.585 ms                 | 742.890 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.028 ms                 | 194.675 ms                |
| Forward                   | 9.306 ms                  | 73.058 ms                 |
| Backward                  | 8.121 ms                  | 39.296 ms                 |
| Optimize                  | 2.551 ms                  | 64.940 ms                 |
| BarrierTimeBeforeRank0    | 107.419 us                | 129.473 ms                |
| AfterBackward             | 118.982 ms                | 517.565 ms                |
| BlockToStepN              | 93.790 ms                 | 743.114 ms                |
| OneStep                   | 338.464 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:31.133208 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=24785
W20240125 08:36:31.535960 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 08:36:32.187292 41402 parallel_pq_v2.h:76] insert failed, size(hashtable)=48
W20240125 08:36:32.216022 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=439
W20240125 08:36:32.553553 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 08:36:33.187022 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=42277
W20240125 08:36:33.220714 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240125 08:36:33.553227 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 08:36:34.187016 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=9129
W20240125 08:36:34.220489 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240125 08:36:34.913421 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 08:36:35.214419 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240125 08:36:35.243332 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=448, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.954 ms                 | 86.528 ms                 |
| ProcessBack:UpdateCache   | 21.806 ms                 | 57.283 ms                 |
| ProcessBack:UpsertPq      | 45.451 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.843 ms                | 517.493 ms                |
| BlockToStepN              | 94.715 ms                 | 755.156 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 08:36:35.945307 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.812 ms                 | 194.675 ms                |
| Forward                   | 9.247 ms                  | 62.386 ms                 |
| Backward                  | 8.128 ms                  | 33.500 ms                 |
| Optimize                  | 2.553 ms                  | 41.172 ms                 |
| BarrierTimeBeforeRank0    | 109.621 us                | 121.417 ms                |
| AfterBackward             | 118.918 ms                | 517.565 ms                |
| BlockToStepN              | 93.790 ms                 | 755.387 ms                |
| OneStep                   | 338.626 ms                | 1.836 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:36.216913 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=64275
W20240125 08:36:36.247536 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240125 08:36:36.962121 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 08:36:37.227569 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=104742
W20240125 08:36:37.488071 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240125 08:36:37.977844 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 08:36:38.227346 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=3886
W20240125 08:36:38.513718 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=456
E20240125 08:36:39.227034 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=29737
W20240125 08:36:39.268759 42416 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 08:36:39.674456 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=459
E20240125 08:36:40.230049 40792 parallel_pq_v2.h:76] insert failed, size(hashtable)=8404
W20240125 08:36:40.291596 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 08:36:40.770572 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=462
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.971 ms                 | 86.528 ms                 |
| ProcessBack:UpdateCache   | 21.921 ms                 | 57.283 ms                 |
| ProcessBack:UpsertPq      | 45.637 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.894 ms                | 479.175 ms                |
| BlockToStepN              | 94.715 ms                 | 742.890 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.674 ms                 | 194.675 ms                |
| Forward                   | 9.689 ms                  | 62.386 ms                 |
| Backward                  | 8.061 ms                  | 33.500 ms                 |
| Optimize                  | 2.551 ms                  | 41.172 ms                 |
| BarrierTimeBeforeRank0    | 109.621 us                | 121.417 ms                |
| AfterBackward             | 119.222 ms                | 479.248 ms                |
| BlockToStepN              | 96.996 ms                 | 743.114 ms                |
| OneStep                   | 338.980 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:41.239331 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=127541
W20240125 08:36:41.318549 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:36:41.772264 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240125 08:36:42.239019 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=16339
W20240125 08:36:42.572504 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:36:43.050388 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
E20240125 08:36:43.239022 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=67
W20240125 08:36:43.587551 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 08:36:44.240034 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=111240
W20240125 08:36:44.290510 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240125 08:36:44.655016 42416 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 08:36:45.241621 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=164552
W20240125 08:36:45.519061 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.983 ms                 | 86.528 ms                 |
| ProcessBack:UpdateCache   | 21.926 ms                 | 57.491 ms                 |
| ProcessBack:UpsertPq      | 45.451 ms                 | 319.962 ms                |
| ProcessOneStep            | 118.894 ms                | 479.175 ms                |
| BlockToStepN              | 97.104 ms                 | 742.890 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.630 ms                 | 194.675 ms                |
| Forward                   | 9.689 ms                  | 62.386 ms                 |
| Backward                  | 8.067 ms                  | 39.296 ms                 |
| Optimize                  | 2.549 ms                  | 41.172 ms                 |
| BarrierTimeBeforeRank0    | 107.419 us                | 121.417 ms                |
| AfterBackward             | 118.982 ms                | 479.248 ms                |
| BlockToStepN              | 97.312 ms                 | 743.114 ms                |
| OneStep                   | 340.263 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:46.241027 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=21196
W20240125 08:36:46.416867 42416 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 08:36:46.869716 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240125 08:36:47.243189 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=28744
W20240125 08:36:47.434473 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 08:36:48.096226 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
E20240125 08:36:48.244191 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=82551
W20240125 08:36:48.452328 42416 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
W20240125 08:36:49.210386 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
E20240125 08:36:49.246783 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=133167
W20240125 08:36:49.539196 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 08:36:50.250226 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=178798
W20240125 08:36:50.486899 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240125 08:36:50.642228 42416 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.106 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 22.021 ms                 | 62.886 ms                 |
| ProcessBack:UpsertPq      | 45.191 ms                 | 311.712 ms                |
| ProcessOneStep            | 118.894 ms                | 479.175 ms                |
| BlockToStepN              | 97.104 ms                 | 755.156 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.301 ms                 | 194.675 ms                |
| Forward                   | 9.796 ms                  | 62.386 ms                 |
| Backward                  | 8.121 ms                  | 39.296 ms                 |
| Optimize                  | 2.551 ms                  | 41.172 ms                 |
| BarrierTimeBeforeRank0    | 107.650 us                | 121.417 ms                |
| AfterBackward             | 118.982 ms                | 479.248 ms                |
| BlockToStepN              | 97.312 ms                 | 755.387 ms                |
| OneStep                   | 340.263 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 08:36:51.255357 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=202364
W20240125 08:36:51.586488 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240125 08:36:51.667631 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 08:36:52.260262 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=331
W20240125 08:36:52.683463 42416 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 08:36:52.764657 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=494, pq.top=494
E20240125 08:36:53.266052 42415 parallel_pq_v2.h:76] insert failed, size(hashtable)=267679
W20240125 08:36:53.691426 42416 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 08:36:53.765900 40792 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240125 08:36:54.266026 42416 parallel_pq_v2.h:76] insert failed, size(hashtable)=295531
W20240125 08:36:54.784154 42416 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 7] 500 steps, total: 43.205, sample: 1.107, forward: 0.822, backward: 1.018, update: 0.287
[proc 0] 500 steps, total: 43.205, sample: 2.884, forward: 1.406, backward: 1.117, update: 0.263
[proc 2] 500 steps, total: 43.205, sample: 1.266, forward: 0.826, backward: 1.023, update: 0.274
Successfully xmh. training takes 196.8641393184662 seconds
before call kg_cache_controller.StopThreads()
W20240125 08:36:55.001662 40792 grad_async_v2.h:71] call StopThreads. PID = 6800
W20240125 08:36:55.001704 40792 grad_base.h:210] before processOneStepNegThread_.join();
[proc 4] 500 steps, total: 43.206, sample: 1.223, forward: 0.934, backward: 1.169, update: 0.266
[proc 5] 500 steps, total: 43.208, sample: 1.178, forward: 0.827, backward: 1.110, update: 0.295
W20240125 08:36:55.003836 40792 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 08:36:55.003868 40792 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
[proc 1] 500 steps, total: 43.205, sample: 1.151, forward: 0.846, backward: 1.178, update: 0.276
[proc 3] 500 steps, total: 43.209, sample: 1.192, forward: 0.802, backward: 1.153, update: 0.260
[proc 6] 500 steps, total: 43.209, sample: 1.207, forward: 1.013, backward: 1.159, update: 0.238
W20240125 08:36:55.101579 40792 grad_async_v2.h:91] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.120 ms                 | 87.672 ms                 |
| ProcessBack:UpdateCache   | 22.012 ms                 | 62.886 ms                 |
| ProcessBack:UpsertPq      | 45.806 ms                 | 311.712 ms                |
| ProcessOneStep            | 119.539 ms                | 479.175 ms                |
| BlockToStepN              | 97.104 ms                 | 755.156 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.200 ms                 | 194.675 ms                |
| Forward                   | 9.535 ms                  | 62.386 ms                 |
| Backward                  | 8.061 ms                  | 39.296 ms                 |
| Optimize                  | 2.549 ms                  | 41.172 ms                 |
| BarrierTimeBeforeRank0    | 112.415 us                | 121.417 ms                |
| AfterBackward             | 119.603 ms                | 479.248 ms                |
| BlockToStepN              | 97.312 ms                 | 755.387 ms                |
| OneStep                   | 340.583 ms                | 1.556 s                   |
+---------------------------+---------------------------+---------------------------+
