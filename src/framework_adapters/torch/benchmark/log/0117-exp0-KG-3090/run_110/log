WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 13:25:21.430189 37486 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_15', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [37486 sampler.py:454] Start PreSampling
WARNING [37486 sampler.py:532] Before construct renumbering_dict
WARNING [37486 sampler.py:555] PreSampling done
W20240124 13:25:25.008220 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 13:25:25.008436 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 13:25:25.008476 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 13:25:25.008504 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 13:25:25.008533 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 13:25:25.008564 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 13:25:25.008594 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 13:25:25.008627 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 13:25:25.008653 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 13:25:25.008687 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 13:25:25.008718 37486 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 13:25:25.008740 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 13:25:25.008762 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 13:25:25.008896 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 13:25:25.008936 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 13:25:25.008970 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 13:25:25.008992 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 13:25:25.009033 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 13:25:25.009064 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 13:25:25.009097 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 13:25:25.009119 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 13:25:25.009143 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 13:25:25.009173 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 13:25:25.009207 37486 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 13:25:25.009227 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 13:25:25.009248 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 13:25:25.009295 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 13:25:25.009327 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 13:25:25.009361 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 13:25:25.009395 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 13:25:25.009420 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 13:25:25.009459 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 13:25:25.009491 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 13:25:25.009514 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 13:25:25.009541 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 13:25:25.009577 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 13:25:25.009606 37486 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 13:25:25.009625 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 13:25:25.009645 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 13:25:25.009699 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 13:25:25.009729 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 13:25:25.009755 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 13:25:25.009778 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 13:25:25.009807 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 13:25:25.009829 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 13:25:25.009861 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 13:25:25.009891 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 13:25:25.009922 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 13:25:25.009954 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 13:25:25.009985 37486 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 13:25:25.010004 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 13:25:25.010023 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 13:25:25.010068 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 13:25:25.010105 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 13:25:25.010128 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 13:25:25.010156 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 13:25:25.010185 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 13:25:25.010224 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 13:25:25.010262 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 13:25:25.010288 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 13:25:25.010310 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 13:25:25.010336 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 13:25:25.010368 37486 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 13:25:25.010391 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 13:25:25.010421 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 13:25:25.010476 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 13:25:25.010510 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 13:25:25.010540 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 13:25:25.010567 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 13:25:25.010598 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 13:25:25.010622 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 13:25:25.010648 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 13:25:25.010679 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 13:25:25.010708 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 13:25:25.010735 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 13:25:25.010759 37486 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 13:25:25.010778 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 13:25:25.010797 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 13:25:25.010843 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 13:25:25.010874 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 13:25:25.010905 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 13:25:25.010934 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 13:25:25.010965 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 13:25:25.011000 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 13:25:25.011023 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 13:25:25.011046 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 13:25:25.011083 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 13:25:25.011111 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 13:25:25.011134 37486 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 13:25:25.011158 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 13:25:25.011178 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 13:25:25.011224 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 13:25:25.011257 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 13:25:25.011282 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 13:25:25.011310 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 13:25:25.011337 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 13:25:25.011368 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 13:25:25.011392 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 13:25:25.011415 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 13:25:25.011443 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 13:25:25.011474 37486 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 13:25:25.011508 37486 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 13:25:25.011528 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 13:25:25.011545 37486 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 13:25:25.224821 37486 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100003dc2000 22.81 MB
W20240124 13:25:25.225014 37486 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([1513, 2042, 2739,  ..., 8116, 8101, 6685]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.831 seconds
[Rank1] pid = 37954
[Rank2] pid = 38018
[Rank3] pid = 38019
[Rank4] pid = 38083
[Rank5] pid = 38165
[Rank6] pid = 38212
INFO [37486 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [37954 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38018 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38019 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [38083 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [38165 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [38313 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [38212 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [38212 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38313 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37486 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38083 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37954 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38019 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38165 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38018 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 13:25:28.786540 38340 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240124 13:25:28.787417 38404 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240124 13:25:28.787498 38084 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240124 13:25:28.787544 38147 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240124 13:25:28.787578 38276 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240124 13:25:28.787602 37955 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240124 13:25:28.788210 38211 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240124 13:25:28.788640 38020 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240124 13:25:28.820147 38276 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x1000054a6000 781.2 kB
W20240124 13:25:28.820356 38276 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10000556d000 781.2 kB
W20240124 13:25:28.820422 38276 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x100005632000 152.6 MB
W20240124 13:25:28.820466 38276 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10000eeca000 152.6 MB
W20240124 13:25:28.820501 38276 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 13:25:28.820550 38211 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x100018762000 781.2 kB
W20240124 13:25:28.820730 38211 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x100018827000 781.2 kB
W20240124 13:25:28.820824 38211 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x1000188ec000 152.6 MB
W20240124 13:25:28.820907 38211 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x100022184000 152.6 MB
W20240124 13:25:28.820963 38211 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 13:25:28.821435 38276 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 13:25:28.821677 38404 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x10002ba20000 781.2 kB
W20240124 13:25:28.821826 38404 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x10002bae5000 781.2 kB
W20240124 13:25:28.821885 38404 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10002bbaa000 152.6 MB
W20240124 13:25:28.821916 38404 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x100035442000 152.6 MB
W20240124 13:25:28.821956 38404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 13:25:28.823009 38211 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 13:25:28.823246 38084 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x10003ece6000 781.2 kB
W20240124 13:25:28.823323 38340 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10003edab000 781.2 kB
W20240124 13:25:28.823402 38084 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10003ef37000 781.2 kB
W20240124 13:25:28.823387 38147 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x10003ee70000 781.2 kB
W20240124 13:25:28.823426 37955 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x10003effe000 781.2 kB
W20240124 13:25:28.823472 38340 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10003f188000 781.2 kB
W20240124 13:25:28.823467 38020 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x10003f0c3000 781.2 kB
W20240124 13:25:28.823493 38084 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10003f24d000 152.6 MB
W20240124 13:25:28.823503 38404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 13:25:28.823526 38340 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x100048ae5000 152.6 MB
W20240124 13:25:28.823550 38084 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10005237f000 152.6 MB
W20240124 13:25:28.823567 38340 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10005bc17000 152.6 MB
W20240124 13:25:28.823586 38147 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x1000654af000 781.2 kB
W20240124 13:25:28.823608 38340 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 13:25:28.823613 38084 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 13:25:28.823616 37955 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x100065574000 781.2 kB
W20240124 13:25:28.823648 38020 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x100065639000 781.2 kB
W20240124 13:25:28.823673 38147 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x1000656fe000 152.6 MB
W20240124 13:25:28.823720 38147 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10006ef96000 152.6 MB
W20240124 13:25:28.823729 37955 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10007882e000 152.6 MB
W20240124 13:25:28.823735 38020 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1000820c6000 152.6 MB
W20240124 13:25:28.823781 38147 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 13:25:28.823787 38020 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10008b95e000 152.6 MB
W20240124 13:25:28.823794 37955 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1000951f6000 152.6 MB
W20240124 13:25:28.823832 38020 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 13:25:28.823844 37955 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 13:25:28.825795 38340 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 13:25:28.825816 38147 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 13:25:28.825827 38020 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 13:25:28.825839 38084 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 13:25:28.825848 37955 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [38018 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [38165 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 38313
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [37486 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [38019 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [37954 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [38212 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [38313 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [38083 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 13:25:28.995029 38147 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995067 37955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995092 38404 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995111 38276 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995139 38211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995186 38020 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995231 38340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:25:28.995256 38084 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 13:25:28.996683 38340 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1
        }
W20240124 13:25:28.996788 38340 grad_base.h:172] Init GradProcessingBase done
I20240124 13:25:29.000317 38340 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 13:25:29.000408 38340 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 13:25:29.000413 38340 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 13:25:30.704311 38340 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 13:25:31.605646 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 13:25:31.606223 39222 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 13:25:31.636690 38404 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 13:25:31.640497 37955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.642401 38276 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.642879 38084 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.648363 38211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.658368 38020 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.658751 38147 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:25:31.660768 38340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.036 ms                  | 1.036 ms                  |
| Forward                   | 671.762 ms                | 671.762 ms                |
| Backward                  | 289.135 ms                | 289.135 ms                |
| Optimize                  | 36.409 ms                 | 36.409 ms                 |
| BarrierTimeBeforeRank0    | 144.855 us                | 144.855 us                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:34.146087 38777 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 13:25:34.173444 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 13:25:34.185734 39222 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 13:25:35.146450 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6693
W20240124 13:25:35.187500 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=18, pq.top=16
W20240124 13:25:35.202454 39222 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.699 ms                  | 433.347 ms                |
| ProcessBack:UpdateCache   | 8.692 ms                  | 1.041 s                   |
| ProcessBack:UpsertPq      | 18.248 ms                 | 25.986 ms                 |
| ProcessOneStep            | 36.786 ms                 | 1.512 s                   |
| BlockToStepN              | 127.107 us                | 18.283 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:36.146023 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6075
W20240124 13:25:36.187047 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=34
W20240124 13:25:36.208151 39222 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240124 13:25:37.146015 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6705
W20240124 13:25:37.209710 39222 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 13:25:37.211678 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=54, pq.top=53
E20240124 13:25:38.146008 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=7084
W20240124 13:25:38.214421 39222 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 13:25:38.229627 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.411 ms                  | 22.773 ms                 |
| Forward                   | 4.559 ms                  | 10.739 ms                 |
| Backward                  | 5.152 ms                  | 9.656 ms                  |
| Optimize                  | 1.547 ms                  | 10.674 ms                 |
| BarrierTimeBeforeRank0    | 62.889 us                 | 7.024 ms                  |
| AfterBackward             | 34.966 ms                 | 55.152 ms                 |
| BlockToStepN              | 3.217 ms                  | 28.468 ms                 |
| OneStep                   | 57.278 ms                 | 115.553 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:39.146018 38777 parallel_pq_v2.h:76] insert failed, size(hashtable)=265
W20240124 13:25:39.216403 39222 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 13:25:39.299273 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=88, pq.top=86
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 8.414, sample: 0.258, forward: 0.858, backward: 0.625, update: 0.167
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 8.410, sample: 0.293, forward: 0.931, backward: 0.813, update: 0.169
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 8.402, sample: 0.280, forward: 0.878, backward: 0.624, update: 0.163
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 8.392, sample: 0.291, forward: 1.052, backward: 0.665, update: 0.176
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 8.392, sample: 0.285, forward: 0.918, backward: 0.623, update: 0.171
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 8.410, sample: 0.299, forward: 0.944, backward: 0.642, update: 0.172
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 8.409, sample: 0.281, forward: 0.886, backward: 0.647, update: 0.170
train_sampler.Prefill()
-------Step 0-------
tensor([  134,   128,  4154,  3892, 13186, 11390,  1754,  8671, 11240, 13020]) tensor([ 2739,  8534,  5608,  9884,    91,  1762,  1119,  5862,   930, 11154])
-------Step 1-------
tensor([  134,   128,  4154,  3892, 13186, 11390,  1754,  8671, 11240, 13020]) tensor([ 1877,    61,   931, 14853,  1285,  7462, 14900,  1891,  6502,  1767])
-------Step 2-------
tensor([ 7630, 14762,    73,   124,   108,    15,  1601,  7267,   348,  5151]) tensor([ 1055,  7346,  3366,  8579,  8508,   984, 11242,   818, 12215,  8501])
-------Step 3-------
tensor([ 7630, 14762,    73,   124,   108,    15,  1601,  7267,   348,  5151]) tensor([12079,   144, 10491, 13433,  6450, 14736,  4100,  5654,  1582,  5351])
-------Step 4-------
tensor([ 6567,  5907,  5921,  7267,   160,  6954, 14607,    15,  5276,   105]) tensor([12242,  6837, 12449,  2021,  5431,  2393,  1938,  1964,  1226,  2728])
-------Step 5-------
tensor([ 6567,  5907,  5921,  7267,   160,  6954, 14607,    15,  5276,   105]) tensor([ 3649, 10942,  2373,  5865, 10581, 13452, 14414,  9273, 13244,  4770])
-------Step 6-------
tensor([  128, 14767,  9395,  6341, 10174,  4028,    37, 10225,   133,  1773]) tensor([1264, 1830,  652, 4010, 3913, 3512, 8671, 7403, 6410, 2439])
-------Step 7-------
tensor([  128, 14767,  9395,  6341, 10174,  4028,    37, 10225,   133,  1773]) tensor([ 5971,  5762,  9424, 14010,  7891,  3169, 11887, 11958,  7294, 10162])
-------Step 8-------
tensor([12602,  1961,    99,  4751, 11643,    88,  8803,    15,  1812,  2986]) tensor([ 5374, 12151,  2806,  8130, 11453, 11794,  9994,  2630, 14543,  6619])
-------Step 9-------
tensor([12602,  1961,    99,  4751, 11643,    88,  8803,    15,  1812,  2986]) tensor([ 1083,   353, 14924,  2329,  1735, 10783, 12561,  8619,  5307, 13497])
before start barrier
start train
[proc 0] 100 steps, total: 8.390, sample: 0.336, forward: 1.135, backward: 0.780, update: 0.217
E20240124 13:25:40.146023 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=8238
W20240124 13:25:40.218338 39222 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 13:25:40.303056 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.529 ms                  | 15.335 ms                 |
| ProcessBack:UpdateCache   | 8.829 ms                  | 18.653 ms                 |
| ProcessBack:UpsertPq      | 15.671 ms                 | 25.986 ms                 |
| ProcessOneStep            | 34.425 ms                 | 55.115 ms                 |
| BlockToStepN              | 4.558 ms                  | 28.388 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:41.146018 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=8266
W20240124 13:25:41.256904 39222 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 13:25:41.314428 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=119
E20240124 13:25:42.146008 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=7608
W20240124 13:25:42.257763 39222 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 13:25:42.350801 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=124
E20240124 13:25:43.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6836
W20240124 13:25:43.259802 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:25:43.389906 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.403 ms                  | 17.678 ms                 |
| Forward                   | 4.458 ms                  | 9.830 ms                  |
| Backward                  | 4.504 ms                  | 9.656 ms                  |
| Optimize                  | 1.547 ms                  | 7.958 ms                  |
| BarrierTimeBeforeRank0    | 724.515 us                | 12.517 ms                 |
| AfterBackward             | 35.183 ms                 | 52.961 ms                 |
| BlockToStepN              | 6.754 ms                  | 37.765 ms                 |
| OneStep                   | 59.408 ms                 | 115.553 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:44.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=9258
W20240124 13:25:44.263665 39222 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 13:25:44.437935 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
E20240124 13:25:45.146015 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=7449
W20240124 13:25:45.264916 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:25:45.437160 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=182
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.777 ms                  | 13.276 ms                 |
| ProcessBack:UpdateCache   | 9.733 ms                  | 16.967 ms                 |
| ProcessBack:UpsertPq      | 16.215 ms                 | 24.513 ms                 |
| ProcessOneStep            | 35.473 ms                 | 52.926 ms                 |
| BlockToStepN              | 7.030 ms                  | 37.701 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:46.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=3276
W20240124 13:25:46.285367 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:25:46.471124 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=200, pq.top=199
[proc 2] 200 steps, total: 6.424, sample: 0.303, forward: 0.412, backward: 0.442, update: 0.130
[proc 3] 200 steps, total: 6.424, sample: 0.300, forward: 0.432, backward: 0.526, update: 0.139
[proc 4] 200 steps, total: 6.424, sample: 0.320, forward: 0.417, backward: 0.446, update: 0.136
[proc 5] 200 steps, total: 6.424, sample: 0.279, forward: 0.408, backward: 0.468, update: 0.130
[proc 6] 200 steps, total: 6.424, sample: 0.306, forward: 0.419, backward: 0.448, update: 0.136
[proc 7] 200 steps, total: 6.424, sample: 0.349, forward: 0.455, backward: 0.431, update: 0.167
[proc 1] 200 steps, total: 6.424, sample: 0.306, forward: 0.427, backward: 0.454, update: 0.135
[proc 0] 200 steps, total: 6.424, sample: 0.321, forward: 0.423, backward: 0.457, update: 0.158
E20240124 13:25:47.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4030
W20240124 13:25:47.287358 39222 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 13:25:47.481407 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=214
E20240124 13:25:48.146010 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4074
W20240124 13:25:48.287392 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:25:48.544963 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.417 ms                  | 20.939 ms                 |
| Forward                   | 4.437 ms                  | 10.676 ms                 |
| Backward                  | 4.450 ms                  | 9.656 ms                  |
| Optimize                  | 1.535 ms                  | 7.958 ms                  |
| BarrierTimeBeforeRank0    | 950.747 us                | 14.790 ms                 |
| AfterBackward             | 35.276 ms                 | 52.961 ms                 |
| BlockToStepN              | 7.602 ms                  | 37.765 ms                 |
| OneStep                   | 61.522 ms                 | 115.553 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:49.146020 38777 parallel_pq_v2.h:76] insert failed, size(hashtable)=1637
W20240124 13:25:49.292992 39222 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 13:25:49.575728 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=246, pq.top=246
E20240124 13:25:50.146420 39222 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
W20240124 13:25:50.292846 39222 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 13:25:50.587358 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.775 ms                  | 14.426 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 16.903 ms                 |
| ProcessBack:UpsertPq      | 16.285 ms                 | 24.989 ms                 |
| ProcessOneStep            | 35.802 ms                 | 49.899 ms                 |
| BlockToStepN              | 7.971 ms                  | 37.701 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:51.146009 38340 parallel_pq_v2.h:76] insert failed, size(hashtable)=453
W20240124 13:25:51.306159 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:25:51.634302 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=274, pq.top=272
E20240124 13:25:52.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=3933
W20240124 13:25:52.308523 39222 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 13:25:52.685925 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=288, pq.top=287
E20240124 13:25:53.146011 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6436
W20240124 13:25:53.310393 39222 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
[proc 1] 300 steps, total: 7.108, sample: 0.273, forward: 0.403, backward: 0.428, update: 0.130
[proc 7] 300 steps, total: 7.108, sample: 0.245, forward: 0.377, backward: 0.393, update: 0.126
[proc 5] 300 steps, total: 7.108, sample: 0.274, forward: 0.404, backward: 0.485, update: 0.127
[proc 0] 300 steps, total: 7.108, sample: 0.346, forward: 0.440, backward: 0.429, update: 0.147
[proc 3] 300 steps, total: 7.108, sample: 0.297, forward: 0.409, backward: 0.483, update: 0.133
[proc 2] 300 steps, total: 7.108, sample: 0.295, forward: 0.426, backward: 0.416, update: 0.128
[proc 6] 300 steps, total: 7.108, sample: 0.286, forward: 0.401, backward: 0.455, update: 0.128
[proc 4] 300 steps, total: 7.108, sample: 0.285, forward: 0.407, backward: 0.494, update: 0.134
W20240124 13:25:53.710450 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=302, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.441 ms                  | 20.923 ms                 |
| Forward                   | 4.407 ms                  | 10.676 ms                 |
| Backward                  | 4.401 ms                  | 9.185 ms                  |
| Optimize                  | 1.523 ms                  | 7.917 ms                  |
| BarrierTimeBeforeRank0    | 1.023 ms                  | 18.549 ms                 |
| AfterBackward             | 35.648 ms                 | 49.939 ms                 |
| BlockToStepN              | 8.532 ms                  | 43.002 ms                 |
| OneStep                   | 63.834 ms                 | 108.822 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:54.146010 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=5786
W20240124 13:25:54.310221 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:25:54.735459 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=312
E20240124 13:25:55.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6205
W20240124 13:25:55.342016 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.796 ms                  | 13.276 ms                 |
| ProcessBack:UpdateCache   | 10.182 ms                 | 15.342 ms                 |
| ProcessBack:UpsertPq      | 16.418 ms                 | 25.246 ms                 |
| ProcessOneStep            | 35.946 ms                 | 52.926 ms                 |
| BlockToStepN              | 8.683 ms                  | 55.231 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 13:25:55.756593 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
E20240124 13:25:56.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=5851
W20240124 13:25:56.346823 39222 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 13:25:56.792129 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=339
E20240124 13:25:57.146008 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6140
W20240124 13:25:57.423977 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:25:57.818696 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=352, pq.top=352
E20240124 13:25:58.146018 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6355
W20240124 13:25:58.431054 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:25:58.818162 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.470 ms                  | 20.326 ms                 |
| Forward                   | 4.381 ms                  | 9.830 ms                  |
| Backward                  | 4.379 ms                  | 9.154 ms                  |
| Optimize                  | 1.514 ms                  | 7.492 ms                  |
| BarrierTimeBeforeRank0    | 1.268 ms                  | 18.224 ms                 |
| AfterBackward             | 36.809 ms                 | 52.961 ms                 |
| BlockToStepN              | 9.036 ms                  | 54.575 ms                 |
| OneStep                   | 66.008 ms                 | 119.607 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:25:59.146013 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=7533
W20240124 13:25:59.432134 39222 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 13:25:59.870133 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=376
E20240124 13:26:00.146015 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=6921
W20240124 13:26:00.447114 39222 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.821 ms                  | 12.263 ms                 |
| ProcessBack:UpdateCache   | 10.608 ms                 | 14.206 ms                 |
| ProcessBack:UpsertPq      | 16.674 ms                 | 25.935 ms                 |
| ProcessOneStep            | 36.626 ms                 | 52.926 ms                 |
| BlockToStepN              | 9.324 ms                  | 54.485 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 13:26:00.880347 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
E20240124 13:26:01.146010 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=7969
[proc 7] 400 steps, total: 7.851, sample: 0.286, forward: 0.379, backward: 0.447, update: 0.124
[proc 4] 400 steps, total: 7.851, sample: 0.284, forward: 0.422, backward: 0.448, update: 0.143
[proc 1] 400 steps, total: 7.851, sample: 0.258, forward: 0.408, backward: 0.439, update: 0.133
[proc 2] 400 steps, total: 7.851, sample: 0.262, forward: 0.405, backward: 0.422, update: 0.129
[proc 5] 400 steps, total: 7.851, sample: 0.280, forward: 0.419, backward: 0.430, update: 0.128
[proc 6] 400 steps, total: 7.851, sample: 0.269, forward: 0.404, backward: 0.454, update: 0.129
[proc 0] 400 steps, total: 7.851, sample: 0.374, forward: 0.413, backward: 0.437, update: 0.145
[proc 3] 400 steps, total: 7.851, sample: 0.297, forward: 0.409, backward: 0.483, update: 0.133
W20240124 13:26:01.448935 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:26:01.880596 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=406
E20240124 13:26:02.146008 38777 parallel_pq_v2.h:76] insert failed, size(hashtable)=911
W20240124 13:26:02.485878 39222 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 13:26:02.880519 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=418
E20240124 13:26:03.146097 39222 parallel_pq_v2.h:76] insert failed, size(hashtable)=52
W20240124 13:26:03.496054 39222 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 13:26:03.880106 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.488 ms                  | 20.939 ms                 |
| Forward                   | 4.368 ms                  | 9.830 ms                  |
| Backward                  | 4.378 ms                  | 9.732 ms                  |
| Optimize                  | 1.511 ms                  | 7.492 ms                  |
| BarrierTimeBeforeRank0    | 1.413 ms                  | 18.224 ms                 |
| AfterBackward             | 36.517 ms                 | 52.961 ms                 |
| BlockToStepN              | 10.000 ms                 | 55.327 ms                 |
| OneStep                   | 68.115 ms                 | 121.574 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:26:04.146010 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=5179
W20240124 13:26:04.501380 39222 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 13:26:04.884533 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=415
E20240124 13:26:05.146919 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=4111
W20240124 13:26:05.534252 39222 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.801 ms                  | 12.185 ms                 |
| ProcessBack:UpdateCache   | 10.366 ms                 | 13.832 ms                 |
| ProcessBack:UpsertPq      | 16.650 ms                 | 25.261 ms                 |
| ProcessOneStep            | 36.166 ms                 | 49.899 ms                 |
| BlockToStepN              | 10.260 ms                 | 59.221 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 13:26:05.884369 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=459
E20240124 13:26:06.146013 38340 parallel_pq_v2.h:76] insert failed, size(hashtable)=166
W20240124 13:26:06.536545 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:26:06.945175 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=472, pq.top=469
E20240124 13:26:07.148437 39221 parallel_pq_v2.h:76] insert failed, size(hashtable)=8866
W20240124 13:26:07.539305 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:26:07.958793 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
E20240124 13:26:08.148015 38340 parallel_pq_v2.h:76] insert failed, size(hashtable)=1335
W20240124 13:26:08.544770 39222 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 13:26:08.973467 38340 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.514 ms                  | 22.587 ms                 |
| Forward                   | 4.370 ms                  | 8.762 ms                  |
| Backward                  | 4.375 ms                  | 9.656 ms                  |
| Optimize                  | 1.515 ms                  | 7.363 ms                  |
| BarrierTimeBeforeRank0    | 1.437 ms                  | 18.130 ms                 |
| AfterBackward             | 36.517 ms                 | 58.369 ms                 |
| BlockToStepN              | 10.523 ms                 | 65.384 ms                 |
| OneStep                   | 68.807 ms                 | 133.982 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 13:26:09.148010 38777 parallel_pq_v2.h:76] insert failed, size(hashtable)=390
W20240124 13:26:09.564069 39222 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 7] 500 steps, total: 8.206, sample: 0.282, forward: 0.388, backward: 0.469, update: 0.123
[proc 0] 500 steps, total: 8.206, sample: 0.380, forward: 0.454, backward: 0.481, update: 0.160
[proc 1] 500 steps, total: 8.206, sample: 0.278, forward: 0.406, backward: 0.459, update: 0.133
[proc 6] 500 steps, total: 8.206, sample: 0.255, forward: 0.403, backward: 0.482, update: 0.127
[proc 3] 500 steps, total: 8.206, sample: 0.275, forward: 0.415, backward: 0.481, update: 0.134
[proc 5] 500 steps, total: 8.206, sample: 0.273, forward: 0.423, backward: 0.450, update: 0.131
[proc 2] 500 steps, total: 8.206, sample: 0.263, forward: 0.413, backward: 0.454, update: 0.129
[proc 4] 500 steps, total: 8.206, sample: 0.279, forward: 0.425, backward: 0.483, update: 0.133
Successfully xmh. training takes 37.979249715805054 seconds
before call kg_cache_controller.StopThreads()
W20240124 13:26:09.640094 38340 grad_async_v2.h:71] call StopThreads. PID = 37486
W20240124 13:26:09.640128 38340 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 13:26:09.640631 38340 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 13:26:09.640648 38340 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240124 13:26:09.653162 38340 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7ff321d1fc90>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.813 ms                  | 11.638 ms                 |
| ProcessBack:UpdateCache   | 10.274 ms                 | 14.206 ms                 |
| ProcessBack:UpsertPq      | 16.761 ms                 | 33.747 ms                 |
| ProcessOneStep            | 36.333 ms                 | 58.325 ms                 |
| BlockToStepN              | 10.681 ms                 | 65.276 ms                 |
+---------------------------+---------------------------+---------------------------+
