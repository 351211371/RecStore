WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240119 01:11:12.075640 21760 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_4', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [21760 sampler.py:454] Start PreSampling
WARNING [21760 sampler.py:532] Before construct renumbering_dict
WARNING [21760 sampler.py:555] PreSampling done
W20240119 01:11:14.531505 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240119 01:11:14.531673 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240119 01:11:14.531700 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240119 01:11:14.531728 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240119 01:11:14.531754 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240119 01:11:14.531777 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240119 01:11:14.531811 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240119 01:11:14.531842 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240119 01:11:14.531872 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240119 01:11:14.531914 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240119 01:11:14.531962 21760 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240119 01:11:14.531983 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240119 01:11:14.532001 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240119 01:11:14.532104 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240119 01:11:14.532135 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240119 01:11:14.532158 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240119 01:11:14.532186 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240119 01:11:14.532207 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240119 01:11:14.532248 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240119 01:11:14.532270 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240119 01:11:14.532295 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240119 01:11:14.532321 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240119 01:11:14.532341 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240119 01:11:14.532361 21760 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240119 01:11:14.532377 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240119 01:11:14.532397 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240119 01:11:14.532446 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240119 01:11:14.532480 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240119 01:11:14.532498 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240119 01:11:14.532517 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240119 01:11:14.532543 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240119 01:11:14.532569 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240119 01:11:14.532593 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240119 01:11:14.532619 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240119 01:11:14.532644 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240119 01:11:14.532670 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240119 01:11:14.532694 21760 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240119 01:11:14.532711 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240119 01:11:14.532733 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240119 01:11:14.532773 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240119 01:11:14.532809 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240119 01:11:14.532833 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240119 01:11:14.532853 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240119 01:11:14.532872 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240119 01:11:14.532897 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240119 01:11:14.532919 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240119 01:11:14.532945 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240119 01:11:14.532964 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240119 01:11:14.532984 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240119 01:11:14.533008 21760 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240119 01:11:14.533025 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240119 01:11:14.533041 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240119 01:11:14.533082 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240119 01:11:14.533114 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240119 01:11:14.533134 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240119 01:11:14.533155 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240119 01:11:14.533174 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240119 01:11:14.533205 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240119 01:11:14.533226 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240119 01:11:14.533250 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240119 01:11:14.533269 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240119 01:11:14.533289 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240119 01:11:14.533313 21760 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240119 01:11:14.533330 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240119 01:11:14.533352 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240119 01:11:14.533391 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240119 01:11:14.533425 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240119 01:11:14.533450 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240119 01:11:14.533469 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240119 01:11:14.533493 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240119 01:11:14.533514 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240119 01:11:14.533535 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240119 01:11:14.533553 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240119 01:11:14.533581 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240119 01:11:14.533603 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240119 01:11:14.533641 21760 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240119 01:11:14.533658 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240119 01:11:14.533679 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240119 01:11:14.533720 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240119 01:11:14.533742 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240119 01:11:14.533762 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240119 01:11:14.533787 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240119 01:11:14.533813 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240119 01:11:14.533855 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240119 01:11:14.533891 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240119 01:11:14.533921 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240119 01:11:14.533942 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240119 01:11:14.533963 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240119 01:11:14.533983 21760 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240119 01:11:14.533999 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240119 01:11:14.534014 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240119 01:11:14.534056 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240119 01:11:14.534083 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240119 01:11:14.534111 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240119 01:11:14.534132 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240119 01:11:14.534152 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240119 01:11:14.534183 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240119 01:11:14.534204 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240119 01:11:14.534229 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240119 01:11:14.534250 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240119 01:11:14.534269 21760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240119 01:11:14.534294 21760 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240119 01:11:14.534312 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240119 01:11:14.534333 21760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240119 01:11:14.724041 21760 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240119 01:11:14.724186 21760 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1514,  2055,  2843,  ...,  8114, 10498,  8136]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.685 seconds
[Rank1] pid = 22037
[Rank2] pid = 22101
[Rank3] pid = 22102
[Rank4] pid = 22230
[Rank5] pid = 22294
[Rank6] pid = 22363
INFO [21760 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [22037 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [22101 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [22102 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [22230 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22294 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [22101 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21760 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22363 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [22364 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [22102 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22230 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22294 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22363 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22364 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22037 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [22363 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22364 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22294 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21760 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22101 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22102 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22230 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22037 DistTensor.py:56] The tensor name already exists in the kvstore
I20240119 01:11:18.318639 22038 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318703 22141 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318758 22231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318817 22396 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318877 22103 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318933 22365 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.318989 22395 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:18.319038 22297 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 01:11:19.147384 22365 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240119 01:11:19.149231 22103 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.149523 22395 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.149886 22141 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.150823 22297 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.153385 22231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.173858 22038 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240119 01:11:19.193825 22396 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.982 ms                  | 3.446 ms                  |
| bucket keys               | 2.182 ms                  | 108.282 ms                |
| forward: a2a keys         | 2.901 ms                  | 1.322 s                   |
| forward: search cache     | 356.996 us                | 23.935 ms                 |
| forward: a2a values       | 11.672 ms                 | 55.972 ms                 |
| forward: join             | 1.536 ms                  | 4.824 ms                  |
| Forward                   | 49.764 ms                 | 1.909 s                   |
| back: aggr dram keys      | 45.142 ms                 | 980.928 ms                |
| back: set dram grad       | 1.709 ms                  | 2.584 ms                  |
| back: a2a grad            | 12.423 ms                 | 22.348 ms                 |
| back: grad sum & grad cache  | 15.886 ms                 | 30.235 ms                 |
| Backward                  | 148.036 ms                | 1.213 s                   |
| Optimize                  | 16.165 ms                 | 52.839 ms                 |
| BarrierTimeBeforeRank0    | 101.644 us                | 113.853 us                |
| BlockToStepN              | 16.467 us                 | 36.042 us                 |
| OneStep                   | 212.543 ms                | 3.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.540 ms                  | 34.602 ms                 |
| bucket keys               | 1.999 ms                  | 3.040 ms                  |
| forward: a2a keys         | 3.121 ms                  | 26.523 ms                 |
| forward: search cache     | 320.576 us                | 586.980 us                |
| forward: a2a values       | 9.876 ms                  | 16.889 ms                 |
| forward: join             | 1.578 ms                  | 3.044 ms                  |
| Forward                   | 47.435 ms                 | 1.909 s                   |
| back: aggr dram keys      | 38.142 ms                 | 105.446 ms                |
| back: set dram grad       | 1.603 ms                  | 2.580 ms                  |
| back: a2a grad            | 12.881 ms                 | 18.626 ms                 |
| back: grad sum & grad cache  | 15.886 ms                 | 26.266 ms                 |
| Backward                  | 135.339 ms                | 1.213 s                   |
| Optimize                  | 14.323 ms                 | 52.839 ms                 |
| BarrierTimeBeforeRank0    | 57.890 us                 | 6.743 ms                  |
| BlockToStepN              | 22.821 us                 | 169.480 us                |
| OneStep                   | 204.749 ms                | 3.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.720 ms                  | 33.575 ms                 |
| bucket keys               | 2.021 ms                  | 5.697 ms                  |
| forward: a2a keys         | 3.074 ms                  | 36.199 ms                 |
| forward: search cache     | 315.759 us                | 586.980 us                |
| forward: a2a values       | 9.876 ms                  | 16.889 ms                 |
| forward: join             | 1.579 ms                  | 4.824 ms                  |
| Forward                   | 48.354 ms                 | 79.698 ms                 |
| back: aggr dram keys      | 38.794 ms                 | 105.446 ms                |
| back: set dram grad       | 1.593 ms                  | 2.580 ms                  |
| back: a2a grad            | 12.655 ms                 | 18.626 ms                 |
| back: grad sum & grad cache  | 15.886 ms                 | 26.266 ms                 |
| Backward                  | 131.482 ms                | 219.290 ms                |
| Optimize                  | 14.365 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 55.719 us                 | 904.597 us                |
| BlockToStepN              | 19.756 us                 | 92.792 us                 |
| OneStep                   | 209.366 ms                | 295.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.791 ms                  | 34.602 ms                 |
| bucket keys               | 2.044 ms                  | 3.186 ms                  |
| forward: a2a keys         | 3.051 ms                  | 31.602 ms                 |
| forward: search cache     | 315.797 us                | 586.980 us                |
| forward: a2a values       | 9.876 ms                  | 15.232 ms                 |
| forward: join             | 1.565 ms                  | 3.044 ms                  |
| Forward                   | 48.160 ms                 | 79.698 ms                 |
| back: aggr dram keys      | 38.163 ms                 | 58.765 ms                 |
| back: set dram grad       | 1.574 ms                  | 2.391 ms                  |
| back: a2a grad            | 12.881 ms                 | 18.626 ms                 |
| back: grad sum & grad cache  | 15.943 ms                 | 25.591 ms                 |
| Backward                  | 131.482 ms                | 219.290 ms                |
| Optimize                  | 14.426 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 55.719 us                 | 904.597 us                |
| BlockToStepN              | 21.708 us                 | 92.792 us                 |
| OneStep                   | 209.762 ms                | 295.558 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 100 steps, total: 24.017, sample: 0.600, forward: 7.176, backward: 14.176, update: 0.870
[proc 5] 100 steps, total: 24.016, sample: 0.539, forward: 7.210, backward: 14.243, update: 0.785
[proc 4] 100 steps, total: 24.014, sample: 0.490, forward: 7.309, backward: 14.257, update: 0.617
[proc 6] 100 steps, total: 24.020, sample: 0.545, forward: 7.236, backward: 14.281, update: 0.776
[proc 1] 100 steps, total: 23.993, sample: 0.559, forward: 7.224, backward: 14.092, update: 0.755
[proc 2] 100 steps, total: 24.018, sample: 0.527, forward: 7.254, backward: 14.176, update: 0.631
[proc 7] 100 steps, total: 23.973, sample: 0.472, forward: 7.312, backward: 14.163, update: 0.665
[Rank7] pid = 22364
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
-------Step 0-------
tensor([ 2498,    21,  4111,    66, 11097, 13810,  1872,  6991, 13814, 10294]) tensor([ 2843,  8537,  5577, 12680, 12964,  1734,  7076,  4908,   959,  1313])
-------Step 1-------
tensor([ 2498,    21,  4111,    66, 11097, 13810,  1872,  6991, 13814, 10294]) tensor([11084, 13114, 11964, 13365,  1149,  2762,  7938,  1012,  2676, 11190])
-------Step 2-------
tensor([ 4341,  7231,  5689, 13468,  7740, 13403,  8604,    12,  4585,  2902]) tensor([ 6916,  6545,  4533,  6817,  3112, 14479,   323,  2013, 14370,  4276])
-------Step 3-------
tensor([ 4341,  7231,  5689, 13468,  7740, 13403,  8604,    12,  4585,  2902]) tensor([11726,   374,  9897, 14679,  9051,  8822, 10117,   887,  4456,  5088])
-------Step 4-------
tensor([11142,    40,   124,  3352,  5171, 13664,    68, 10079,  5293,   106]) tensor([ 4009, 11397, 14406,  2105,  1773,  8419,   620, 11175,  5253, 13922])
-------Step 5-------
tensor([11142,    40,   124,  3352,  5171, 13664,    68, 10079,  5293,   106]) tensor([ 5408,  5616,  2769, 14061, 10257, 10179, 13649,  6416,  3804,  8537])
-------Step 6-------
tensor([ 2246,  4430, 14384,  3767,   141,  8346,  7971,  1923, 13170,  1088]) tensor([11244,  4108, 11551,  8838,  1137, 12581, 14290, 11175, 10805, 13813])
-------Step 7-------
tensor([ 2246,  4430, 14384,  3767,   141,  8346,  7971,  1923, 13170,  1088]) tensor([ 3971,  9113,  6672, 12987,  7447,   147,  5039,  1641,  2860,  4227])
-------Step 8-------
tensor([ 2331,  8030,  9554, 14869,  5293,  2907,  9494,  4322,  3748,  5709]) tensor([  316,   334, 13992, 14180,  7158,  5792, 14033,   765,    36,  6018])
-------Step 9-------
tensor([ 2331,  8030,  9554, 14869,  5293,  2907,  9494,  4322,  3748,  5709]) tensor([   55, 12074, 14103, 12139,  5166,  8568,  1183, 11892,  5800,  9207])
[proc 0] 100 steps, total: 24.018, sample: 0.618, forward: 7.185, backward: 14.447, update: 1.596
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.847 ms                  | 34.825 ms                 |
| bucket keys               | 2.065 ms                  | 3.186 ms                  |
| forward: a2a keys         | 2.972 ms                  | 36.199 ms                 |
| forward: search cache     | 317.889 us                | 586.980 us                |
| forward: a2a values       | 9.764 ms                  | 15.657 ms                 |
| forward: join             | 1.578 ms                  | 3.044 ms                  |
| Forward                   | 47.979 ms                 | 81.699 ms                 |
| back: aggr dram keys      | 38.142 ms                 | 58.765 ms                 |
| back: set dram grad       | 1.554 ms                  | 2.449 ms                  |
| back: a2a grad            | 12.908 ms                 | 18.626 ms                 |
| back: grad sum & grad cache  | 15.943 ms                 | 25.591 ms                 |
| Backward                  | 131.189 ms                | 219.290 ms                |
| Optimize                  | 14.523 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 55.719 us                 | 904.597 us                |
| BlockToStepN              | 19.972 us                 | 92.792 us                 |
| OneStep                   | 207.641 ms                | 295.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.822 ms                  | 34.825 ms                 |
| bucket keys               | 2.073 ms                  | 3.186 ms                  |
| forward: a2a keys         | 3.021 ms                  | 36.199 ms                 |
| forward: search cache     | 318.427 us                | 586.980 us                |
| forward: a2a values       | 9.764 ms                  | 15.657 ms                 |
| forward: join             | 1.565 ms                  | 3.044 ms                  |
| Forward                   | 48.169 ms                 | 81.699 ms                 |
| back: aggr dram keys      | 38.158 ms                 | 58.765 ms                 |
| back: set dram grad       | 1.552 ms                  | 2.478 ms                  |
| back: a2a grad            | 12.908 ms                 | 18.626 ms                 |
| back: grad sum & grad cache  | 15.886 ms                 | 25.591 ms                 |
| Backward                  | 131.189 ms                | 219.290 ms                |
| Optimize                  | 14.510 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 54.575 us                 | 3.361 ms                  |
| BlockToStepN              | 19.907 us                 | 164.029 us                |
| OneStep                   | 209.762 ms                | 295.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.847 ms                  | 35.822 ms                 |
| bucket keys               | 2.080 ms                  | 3.186 ms                  |
| forward: a2a keys         | 3.053 ms                  | 36.811 ms                 |
| forward: search cache     | 320.412 us                | 569.128 us                |
| forward: a2a values       | 9.484 ms                  | 15.232 ms                 |
| forward: join             | 1.565 ms                  | 2.412 ms                  |
| Forward                   | 48.169 ms                 | 107.800 ms                |
| back: aggr dram keys      | 38.142 ms                 | 54.717 ms                 |
| back: set dram grad       | 1.539 ms                  | 2.449 ms                  |
| back: a2a grad            | 12.788 ms                 | 17.830 ms                 |
| back: grad sum & grad cache  | 15.886 ms                 | 25.000 ms                 |
| Backward                  | 131.482 ms                | 219.290 ms                |
| Optimize                  | 14.476 ms                 | 25.754 ms                 |
| BarrierTimeBeforeRank0    | 54.510 us                 | 3.361 ms                  |
| BlockToStepN              | 19.708 us                 | 169.480 us                |
| OneStep                   | 209.366 ms                | 295.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.812 ms                  | 35.434 ms                 |
| bucket keys               | 2.055 ms                  | 3.186 ms                  |
| forward: a2a keys         | 3.137 ms                  | 37.192 ms                 |
| forward: search cache     | 320.817 us                | 569.128 us                |
| forward: a2a values       | 9.196 ms                  | 15.232 ms                 |
| forward: join             | 1.566 ms                  | 2.412 ms                  |
| Forward                   | 48.383 ms                 | 84.161 ms                 |
| back: aggr dram keys      | 38.249 ms                 | 54.717 ms                 |
| back: set dram grad       | 1.551 ms                  | 2.478 ms                  |
| back: a2a grad            | 12.432 ms                 | 17.830 ms                 |
| back: grad sum & grad cache  | 15.943 ms                 | 25.000 ms                 |
| Backward                  | 131.577 ms                | 161.255 ms                |
| Optimize                  | 14.423 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 53.835 us                 | 3.472 ms                  |
| BlockToStepN              | 20.073 us                 | 164.029 us                |
| OneStep                   | 209.762 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.760 ms                  | 35.434 ms                 |
| bucket keys               | 2.049 ms                  | 3.125 ms                  |
| forward: a2a keys         | 3.259 ms                  | 38.655 ms                 |
| forward: search cache     | 321.160 us                | 566.160 us                |
| forward: a2a values       | 9.002 ms                  | 13.839 ms                 |
| forward: join             | 1.567 ms                  | 2.362 ms                  |
| Forward                   | 48.657 ms                 | 95.011 ms                 |
| back: aggr dram keys      | 38.249 ms                 | 52.957 ms                 |
| back: set dram grad       | 1.553 ms                  | 3.316 ms                  |
| back: a2a grad            | 12.337 ms                 | 16.801 ms                 |
| back: grad sum & grad cache  | 16.012 ms                 | 24.538 ms                 |
| Backward                  | 131.716 ms                | 161.255 ms                |
| Optimize                  | 14.409 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 53.328 us                 | 3.472 ms                  |
| BlockToStepN              | 21.708 us                 | 164.029 us                |
| OneStep                   | 210.262 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 21.091, sample: 0.419, forward: 5.774, backward: 13.182, update: 0.658
[proc 7] 200 steps, total: 21.091, sample: 0.519, forward: 5.656, backward: 13.077, update: 0.736
[proc 4] 200 steps, total: 21.091, sample: 0.566, forward: 5.624, backward: 13.155, update: 0.702
[proc 0] 200 steps, total: 21.091, sample: 0.501, forward: 5.700, backward: 13.383, update: 1.381
[proc 3] 200 steps, total: 21.091, sample: 0.503, forward: 5.670, backward: 13.073, update: 0.733
[proc 5] 200 steps, total: 21.091, sample: 0.518, forward: 5.660, backward: 13.100, update: 0.745
[proc 2] 200 steps, total: 21.091, sample: 0.538, forward: 5.633, backward: 13.063, update: 0.680
[proc 6] 200 steps, total: 21.091, sample: 0.509, forward: 5.671, backward: 13.146, update: 0.703
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.760 ms                  | 35.822 ms                 |
| bucket keys               | 2.055 ms                  | 3.186 ms                  |
| forward: a2a keys         | 3.259 ms                  | 38.655 ms                 |
| forward: search cache     | 321.427 us                | 569.128 us                |
| forward: a2a values       | 9.002 ms                  | 13.839 ms                 |
| forward: join             | 1.576 ms                  | 2.412 ms                  |
| Forward                   | 48.706 ms                 | 95.011 ms                 |
| back: aggr dram keys      | 38.733 ms                 | 52.957 ms                 |
| back: set dram grad       | 1.551 ms                  | 3.316 ms                  |
| back: a2a grad            | 12.253 ms                 | 16.801 ms                 |
| back: grad sum & grad cache  | 16.022 ms                 | 24.969 ms                 |
| Backward                  | 131.617 ms                | 161.255 ms                |
| Optimize                  | 14.413 ms                 | 25.754 ms                 |
| BarrierTimeBeforeRank0    | 52.868 us                 | 3.472 ms                  |
| BlockToStepN              | 21.675 us                 | 164.029 us                |
| OneStep                   | 211.015 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.747 ms                  | 35.822 ms                 |
| bucket keys               | 2.064 ms                  | 3.276 ms                  |
| forward: a2a keys         | 3.332 ms                  | 40.012 ms                 |
| forward: search cache     | 321.279 us                | 569.128 us                |
| forward: a2a values       | 9.042 ms                  | 13.839 ms                 |
| forward: join             | 1.578 ms                  | 2.412 ms                  |
| Forward                   | 49.297 ms                 | 101.594 ms                |
| back: aggr dram keys      | 38.158 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.547 ms                  | 3.306 ms                  |
| back: a2a grad            | 12.187 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.164 ms                 | 24.538 ms                 |
| Backward                  | 131.482 ms                | 161.255 ms                |
| Optimize                  | 14.371 ms                 | 25.754 ms                 |
| BarrierTimeBeforeRank0    | 52.610 us                 | 3.472 ms                  |
| BlockToStepN              | 21.948 us                 | 164.029 us                |
| OneStep                   | 210.460 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.712 ms                  | 35.434 ms                 |
| bucket keys               | 2.064 ms                  | 3.399 ms                  |
| forward: a2a keys         | 3.354 ms                  | 51.693 ms                 |
| forward: search cache     | 321.279 us                | 586.980 us                |
| forward: a2a values       | 9.057 ms                  | 13.839 ms                 |
| forward: join             | 1.582 ms                  | 2.422 ms                  |
| Forward                   | 49.297 ms                 | 101.601 ms                |
| back: aggr dram keys      | 38.784 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.552 ms                  | 3.306 ms                  |
| back: a2a grad            | 12.085 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.164 ms                 | 24.538 ms                 |
| Backward                  | 131.575 ms                | 161.255 ms                |
| Optimize                  | 14.356 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 51.498 us                 | 3.472 ms                  |
| BlockToStepN              | 23.300 us                 | 114.437 us                |
| OneStep                   | 211.319 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 35.434 ms                 |
| bucket keys               | 2.062 ms                  | 3.416 ms                  |
| forward: a2a keys         | 3.509 ms                  | 41.898 ms                 |
| forward: search cache     | 321.223 us                | 586.980 us                |
| forward: a2a values       | 9.071 ms                  | 13.839 ms                 |
| forward: join             | 1.592 ms                  | 2.660 ms                  |
| Forward                   | 49.641 ms                 | 101.601 ms                |
| back: aggr dram keys      | 38.616 ms                 | 51.703 ms                 |
| back: set dram grad       | 1.554 ms                  | 3.277 ms                  |
| back: a2a grad            | 12.088 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.219 ms                 | 24.383 ms                 |
| Backward                  | 131.575 ms                | 161.255 ms                |
| Optimize                  | 14.310 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 51.215 us                 | 3.478 ms                  |
| BlockToStepN              | 23.441 us                 | 164.029 us                |
| OneStep                   | 212.221 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 21.317, sample: 0.497, forward: 5.883, backward: 13.154, update: 0.680
[proc 6] 300 steps, total: 21.317, sample: 0.486, forward: 5.890, backward: 13.196, update: 0.625
[proc 0] 300 steps, total: 21.318, sample: 0.585, forward: 5.818, backward: 13.413, update: 1.373
[proc 4] 300 steps, total: 21.318, sample: 0.647, forward: 5.729, backward: 13.217, update: 0.743
[proc 7] 300 steps, total: 21.318, sample: 0.495, forward: 5.878, backward: 13.114, update: 0.685
[proc 3] 300 steps, total: 21.318, sample: 0.537, forward: 5.820, backward: 13.126, update: 0.679
[proc 2] 300 steps, total: 21.317, sample: 0.581, forward: 5.783, backward: 13.135, update: 0.682
[proc 1] 300 steps, total: 21.318, sample: 0.566, forward: 5.820, backward: 13.252, update: 0.712
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.682 ms                  | 35.434 ms                 |
| bucket keys               | 2.062 ms                  | 3.478 ms                  |
| forward: a2a keys         | 3.562 ms                  | 41.898 ms                 |
| forward: search cache     | 321.499 us                | 602.012 us                |
| forward: a2a values       | 9.071 ms                  | 13.839 ms                 |
| forward: join             | 1.593 ms                  | 2.676 ms                  |
| Forward                   | 49.828 ms                 | 101.601 ms                |
| back: aggr dram keys      | 38.386 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.555 ms                  | 3.277 ms                  |
| back: a2a grad            | 12.085 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.249 ms                 | 24.402 ms                 |
| Backward                  | 131.575 ms                | 161.255 ms                |
| Optimize                  | 14.251 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 50.483 us                 | 3.478 ms                  |
| BlockToStepN              | 23.881 us                 | 164.029 us                |
| OneStep                   | 212.221 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.701 ms                  | 35.434 ms                 |
| bucket keys               | 2.063 ms                  | 3.909 ms                  |
| forward: a2a keys         | 3.597 ms                  | 40.012 ms                 |
| forward: search cache     | 321.603 us                | 602.012 us                |
| forward: a2a values       | 8.994 ms                  | 13.798 ms                 |
| forward: join             | 1.598 ms                  | 2.676 ms                  |
| Forward                   | 49.828 ms                 | 101.601 ms                |
| back: aggr dram keys      | 38.311 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.554 ms                  | 3.277 ms                  |
| back: a2a grad            | 12.066 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.230 ms                 | 24.383 ms                 |
| Backward                  | 131.369 ms                | 161.255 ms                |
| Optimize                  | 14.269 ms                 | 25.754 ms                 |
| BarrierTimeBeforeRank0    | 49.797 us                 | 3.478 ms                  |
| BlockToStepN              | 23.662 us                 | 164.029 us                |
| OneStep                   | 212.221 ms                | 266.404 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.673 ms                  | 35.269 ms                 |
| bucket keys               | 2.057 ms                  | 3.909 ms                  |
| forward: a2a keys         | 3.531 ms                  | 40.012 ms                 |
| forward: search cache     | 321.794 us                | 602.012 us                |
| forward: a2a values       | 8.966 ms                  | 13.798 ms                 |
| forward: join             | 1.600 ms                  | 2.676 ms                  |
| Forward                   | 49.751 ms                 | 101.594 ms                |
| back: aggr dram keys      | 38.311 ms                 | 52.957 ms                 |
| back: set dram grad       | 1.558 ms                  | 3.277 ms                  |
| back: a2a grad            | 12.085 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.249 ms                 | 24.402 ms                 |
| Backward                  | 131.270 ms                | 161.255 ms                |
| Optimize                  | 14.187 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 49.543 us                 | 3.472 ms                  |
| BlockToStepN              | 23.689 us                 | 164.029 us                |
| OneStep                   | 211.227 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 35.269 ms                 |
| bucket keys               | 2.057 ms                  | 3.909 ms                  |
| forward: a2a keys         | 3.531 ms                  | 40.012 ms                 |
| forward: search cache     | 321.852 us                | 602.012 us                |
| forward: a2a values       | 8.960 ms                  | 13.839 ms                 |
| forward: join             | 1.601 ms                  | 2.676 ms                  |
| Forward                   | 49.764 ms                 | 101.594 ms                |
| back: aggr dram keys      | 38.397 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.558 ms                  | 3.235 ms                  |
| back: a2a grad            | 12.066 ms                 | 16.356 ms                 |
| back: grad sum & grad cache  | 16.249 ms                 | 24.383 ms                 |
| Backward                  | 131.367 ms                | 161.255 ms                |
| Optimize                  | 14.174 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 49.508 us                 | 3.472 ms                  |
| BlockToStepN              | 23.713 us                 | 164.029 us                |
| OneStep                   | 211.015 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 21.039, sample: 0.481, forward: 5.538, backward: 13.226, update: 0.677
[proc 4] 400 steps, total: 21.039, sample: 0.543, forward: 5.486, backward: 13.241, update: 0.744
[proc 0] 400 steps, total: 21.039, sample: 0.513, forward: 5.543, backward: 13.403, update: 1.460
[proc 7] 400 steps, total: 21.039, sample: 0.566, forward: 5.453, backward: 13.114, update: 0.741
[proc 5] 400 steps, total: 21.039, sample: 0.547, forward: 5.481, backward: 13.174, update: 0.719
[proc 2] 400 steps, total: 21.038, sample: 0.475, forward: 5.542, backward: 13.125, update: 0.666
[proc 3] 400 steps, total: 21.038, sample: 0.491, forward: 5.531, backward: 13.128, update: 0.667
[proc 1] 400 steps, total: 21.038, sample: 0.519, forward: 5.504, backward: 13.264, update: 0.735
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.682 ms                  | 35.269 ms                 |
| bucket keys               | 2.056 ms                  | 3.909 ms                  |
| forward: a2a keys         | 3.477 ms                  | 40.012 ms                 |
| forward: search cache     | 321.818 us                | 602.012 us                |
| forward: a2a values       | 8.934 ms                  | 13.839 ms                 |
| forward: join             | 1.602 ms                  | 2.676 ms                  |
| Forward                   | 49.710 ms                 | 101.594 ms                |
| back: aggr dram keys      | 38.386 ms                 | 52.690 ms                 |
| back: set dram grad       | 1.558 ms                  | 3.235 ms                  |
| back: a2a grad            | 11.983 ms                 | 16.356 ms                 |
| back: grad sum & grad cache  | 16.352 ms                 | 24.383 ms                 |
| Backward                  | 131.189 ms                | 161.255 ms                |
| Optimize                  | 14.237 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 49.886 us                 | 3.478 ms                  |
| BlockToStepN              | 23.641 us                 | 164.029 us                |
| OneStep                   | 211.056 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.675 ms                  | 35.434 ms                 |
| bucket keys               | 2.057 ms                  | 3.730 ms                  |
| forward: a2a keys         | 3.497 ms                  | 39.176 ms                 |
| forward: search cache     | 321.850 us                | 586.980 us                |
| forward: a2a values       | 8.934 ms                  | 13.798 ms                 |
| forward: join             | 1.601 ms                  | 2.676 ms                  |
| Forward                   | 49.641 ms                 | 101.594 ms                |
| back: aggr dram keys      | 38.616 ms                 | 51.841 ms                 |
| back: set dram grad       | 1.560 ms                  | 2.888 ms                  |
| back: a2a grad            | 11.990 ms                 | 16.356 ms                 |
| back: grad sum & grad cache  | 16.441 ms                 | 24.402 ms                 |
| Backward                  | 131.367 ms                | 161.255 ms                |
| Optimize                  | 14.257 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 49.941 us                 | 3.478 ms                  |
| BlockToStepN              | 23.689 us                 | 164.029 us                |
| OneStep                   | 211.015 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 35.269 ms                 |
| bucket keys               | 2.056 ms                  | 3.730 ms                  |
| forward: a2a keys         | 3.599 ms                  | 40.012 ms                 |
| forward: search cache     | 321.883 us                | 586.980 us                |
| forward: a2a values       | 8.934 ms                  | 13.798 ms                 |
| forward: join             | 1.602 ms                  | 2.721 ms                  |
| Forward                   | 49.822 ms                 | 98.764 ms                 |
| back: aggr dram keys      | 38.733 ms                 | 51.841 ms                 |
| back: set dram grad       | 1.560 ms                  | 2.888 ms                  |
| back: a2a grad            | 11.979 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.441 ms                 | 24.538 ms                 |
| Backward                  | 131.577 ms                | 161.010 ms                |
| Optimize                  | 14.169 ms                 | 24.056 ms                 |
| BarrierTimeBeforeRank0    | 49.508 us                 | 3.472 ms                  |
| BlockToStepN              | 24.125 us                 | 145.308 us                |
| OneStep                   | 211.142 ms                | 261.839 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.661 ms                  | 35.269 ms                 |
| bucket keys               | 2.053 ms                  | 3.730 ms                  |
| forward: a2a keys         | 3.656 ms                  | 40.012 ms                 |
| forward: search cache     | 321.775 us                | 586.980 us                |
| forward: a2a values       | 8.914 ms                  | 13.763 ms                 |
| forward: join             | 1.603 ms                  | 2.676 ms                  |
| Forward                   | 49.781 ms                 | 98.764 ms                 |
| back: aggr dram keys      | 38.802 ms                 | 51.841 ms                 |
| back: set dram grad       | 1.559 ms                  | 2.839 ms                  |
| back: a2a grad            | 11.962 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.441 ms                 | 24.402 ms                 |
| Backward                  | 131.577 ms                | 161.255 ms                |
| Optimize                  | 14.140 ms                 | 24.056 ms                 |
| BarrierTimeBeforeRank0    | 49.408 us                 | 3.472 ms                  |
| BlockToStepN              | 24.379 us                 | 145.308 us                |
| OneStep                   | 211.319 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 500 steps, total: 21.191, sample: 0.551, forward: 5.528, backward: 13.331, update: 0.699
[proc 0] 500 steps, total: 21.191, sample: 0.576, forward: 5.517, backward: 13.621, update: 1.364
[proc 7] 500 steps, total: 21.191, sample: 0.520, forward: 5.551, backward: 13.294, update: 0.766
[proc 6] 500 steps, total: 21.192, sample: 0.572, forward: 5.506, backward: 13.376, update: 0.706
Successfully xmh. training takes 108.65730261802673 seconds
before call kg_cache_controller.StopThreads()
[proc 4] 500 steps, total: 21.191, sample: 0.540, forward: 5.533, backward: 13.432, update: 0.663
[proc 1] 500 steps, total: 21.191, sample: 0.579, forward: 5.506, backward: 13.406, update: 0.714
[proc 2] 500 steps, total: 21.191, sample: 0.523, forward: 5.551, backward: 13.282, update: 0.715
[proc 3] 500 steps, total: 21.191, sample: 0.572, forward: 5.492, backward: 13.323, update: 0.744
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
INFO [21760 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.682 ms                  | 35.269 ms                 |
| bucket keys               | 2.052 ms                  | 3.821 ms                  |
| forward: a2a keys         | 3.599 ms                  | 40.012 ms                 |
| forward: search cache     | 321.786 us                | 586.980 us                |
| forward: a2a values       | 8.877 ms                  | 13.763 ms                 |
| forward: join             | 1.604 ms                  | 2.676 ms                  |
| Forward                   | 49.764 ms                 | 98.764 ms                 |
| back: aggr dram keys      | 38.803 ms                 | 52.495 ms                 |
| back: set dram grad       | 1.561 ms                  | 2.839 ms                  |
| back: a2a grad            | 11.962 ms                 | 16.637 ms                 |
| back: grad sum & grad cache  | 16.466 ms                 | 24.402 ms                 |
| Backward                  | 131.575 ms                | 162.163 ms                |
| Optimize                  | 14.143 ms                 | 24.800 ms                 |
| BarrierTimeBeforeRank0    | 49.407 us                 | 3.472 ms                  |
| BlockToStepN              | 24.379 us                 | 145.308 us                |
| OneStep                   | 211.015 ms                | 264.492 ms                |
+---------------------------+---------------------------+---------------------------+
