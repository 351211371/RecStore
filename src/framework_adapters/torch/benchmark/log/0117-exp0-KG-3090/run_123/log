WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 13:50:38.555984 44996 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_28', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [44996 sampler.py:454] Start PreSampling
WARNING [44996 sampler.py:532] Before construct renumbering_dict
WARNING [44996 sampler.py:555] PreSampling done
W20240124 13:50:41.418774 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 13:50:41.418972 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 13:50:41.419010 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 13:50:41.419045 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 13:50:41.419070 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 13:50:41.419101 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 13:50:41.419135 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 13:50:41.419180 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 13:50:41.419212 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 13:50:41.419247 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 13:50:41.419283 44996 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 13:50:41.419307 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 13:50:41.419333 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 13:50:41.419485 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 13:50:41.419530 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 13:50:41.419567 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 13:50:41.419600 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 13:50:41.419637 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 13:50:41.419672 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 13:50:41.419701 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 13:50:41.419734 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 13:50:41.419757 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 13:50:41.419785 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 13:50:41.419811 44996 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 13:50:41.419833 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 13:50:41.419855 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 13:50:41.419906 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 13:50:41.419942 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 13:50:41.419965 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 13:50:41.420001 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 13:50:41.420022 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 13:50:41.420050 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 13:50:41.420074 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 13:50:41.420100 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 13:50:41.420122 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 13:50:41.420157 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 13:50:41.420179 44996 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 13:50:41.420199 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 13:50:41.420217 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 13:50:41.420258 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 13:50:41.420289 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 13:50:41.420320 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 13:50:41.420342 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 13:50:41.420372 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 13:50:41.420403 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 13:50:41.420436 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 13:50:41.420460 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 13:50:41.420487 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 13:50:41.420511 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 13:50:41.420532 44996 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 13:50:41.420552 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 13:50:41.420575 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 13:50:41.420624 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 13:50:41.420671 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 13:50:41.420696 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 13:50:41.420727 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 13:50:41.420755 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 13:50:41.420786 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 13:50:41.420835 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 13:50:41.420866 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 13:50:41.420889 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 13:50:41.420923 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 13:50:41.420954 44996 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 13:50:41.420977 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 13:50:41.421002 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 13:50:41.421056 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 13:50:41.421088 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 13:50:41.421116 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 13:50:41.421147 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 13:50:41.421178 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 13:50:41.421202 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 13:50:41.421234 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 13:50:41.421258 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 13:50:41.421284 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 13:50:41.421309 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 13:50:41.421334 44996 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 13:50:41.421353 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 13:50:41.421375 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 13:50:41.421430 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 13:50:41.421463 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 13:50:41.421496 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 13:50:41.421522 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 13:50:41.421552 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 13:50:41.421576 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 13:50:41.421603 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 13:50:41.421627 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 13:50:41.421659 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 13:50:41.421694 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 13:50:41.421720 44996 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 13:50:41.421746 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 13:50:41.421772 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 13:50:41.421825 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 13:50:41.421859 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 13:50:41.421890 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 13:50:41.421919 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 13:50:41.421955 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 13:50:41.421983 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 13:50:41.422013 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 13:50:41.422046 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 13:50:41.422070 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 13:50:41.422101 44996 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 13:50:41.422124 44996 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 13:50:41.422143 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 13:50:41.422161 44996 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 13:50:41.632324 44996 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100003dc2000 22.81 MB
W20240124 13:50:41.632567 44996 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1503,  1885,  2407,  ...,  8116,  8795, 10360]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.110 seconds
[Rank1] pid = 45457
[Rank2] pid = 45485
[Rank3] pid = 45585
[Rank4] pid = 45586
[Rank5] pid = 45590
[Rank6] pid = 45777
INFO [44996 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [45457 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [45485 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [45585 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [45586 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [45586 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45777 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [45590 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [45778 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [45777 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45590 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45778 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45586 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45778 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45590 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45777 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45586 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [45586 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [45777 cache_common.py:137] TorchNativeStdEmb construct done
INFO [45778 cache_common.py:137] TorchNativeStdEmb construct done
INFO [45590 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [45590 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45777 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45778 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [45457 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44996 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45485 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45585 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44996 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45457 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45585 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [45485 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44996 cache_common.py:137] TorchNativeStdEmb construct done
INFO [45457 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [44996 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [45585 cache_common.py:137] TorchNativeStdEmb construct done
INFO [45485 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [45457 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45585 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45485 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 13:50:45.274682 45522 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.274801 45652 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.274909 45816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.275009 45651 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.275104 45779 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.275210 45807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.275339 45458 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:45.275434 45587 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 13:50:46.260409 45458 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 13:50:46.261660 45522 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.261927 45807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.263197 45652 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.263396 45816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.263432 45587 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.265144 45779 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 13:50:46.266855 45651 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.162 ms                  | 21.968 ms                 |
| Forward                   | 7.619 ms                  | 475.307 ms                |
| Backward                  | 71.607 ms                 | 249.188 ms                |
| Optimize                  | 1.979 ms                  | 32.835 ms                 |
| BarrierTimeBeforeRank0    | 501.175 us                | 57.541 ms                 |
| BlockToStepN              | 10.218 us                 | 766.009 us                |
| OneStep                   | 90.144 ms                 | 760.665 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.390 ms                  | 17.556 ms                 |
| Forward                   | 7.791 ms                  | 15.408 ms                 |
| Backward                  | 112.340 ms                | 242.023 ms                |
| Optimize                  | 2.017 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 280.423 us                | 57.541 ms                 |
| BlockToStepN              | 10.951 us                 | 640.333 us                |
| OneStep                   | 127.492 ms                | 277.367 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.435 ms                  | 17.556 ms                 |
| Forward                   | 7.812 ms                  | 15.408 ms                 |
| Backward                  | 140.517 ms                | 308.905 ms                |
| Optimize                  | 2.308 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 97.540 us                 | 60.895 ms                 |
| BlockToStepN              | 11.535 us                 | 640.333 us                |
| OneStep                   | 168.056 ms                | 372.139 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.449 ms                  | 17.556 ms                 |
| Forward                   | 7.771 ms                  | 15.408 ms                 |
| Backward                  | 171.499 ms                | 391.344 ms                |
| Optimize                  | 2.399 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 88.979 us                 | 65.262 ms                 |
| BlockToStepN              | 11.855 us                 | 640.333 us                |
| OneStep                   | 190.649 ms                | 445.819 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 21.746, sample: 0.247, forward: 1.084, backward: 15.929, update: 0.218
[Rank7] pid = 45778
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 2443,   148,  3625,   180, 11143, 14570,  1789,  8423, 11690, 12229]) tensor([ 2407,  8700,  5501, 10138, 10571,  1740,  1185,  7705,  1074, 11503])
-------Step 1-------
tensor([ 2443,   148,  3625,   180, 11143, 14570,  1789,  8423, 11690, 12229]) tensor([14867,  3240,  1965,  4180,  6640,   429,  4875, 12237, 14469,  5674])
-------Step 2-------
tensor([ 7025,  5521,  6089,  7344,   108,  9082, 14357,   153,  8183,    21]) tensor([11474,  6939, 12750,  1933,  6024,  2783,  2075,  1927,  1143,  2638])
-------Step 3-------
tensor([ 7025,  5521,  6089,  7344,   108,  9082, 14357,   153,  8183,    21]) tensor([11253,  4441, 14828,  8528, 14391,   774, 13983,  8889,  1330, 11987])
-------Step 4-------
tensor([10444,  1867,    86,  6083, 14850,    89,  9077,   153,  1972,  3286]) tensor([ 5413, 10008,  2712, 12618,  9399, 14864, 10198,  3569, 14395,  5593])
-------Step 5-------
tensor([10444,  1867,    86,  6083, 14850,    89,  9077,   153,  1972,  3286]) tensor([ 5319, 11738, 10073,  4864,  2297, 14239, 10876,  4707, 14681, 10427])
-------Step 6-------
tensor([ 3694,  8719,  4848, 13334,   132,    75,  8462, 13877,   123,  2655]) tensor([ 5696,  9091,  5239,  8149,  3061, 13197, 10047,  2142, 10072,  3723])
-------Step 7-------
tensor([ 3694,  8719,  4848, 13334,   132,    75,  8462, 13877,   123,  2655]) tensor([ 5655, 11044,  7635,  2796,  7116, 11766, 11184,  8619,  2824, 11089])
-------Step 8-------
tensor([11601,   163,  4198,  6244,  4725,    97, 14451,    51, 10889,   774]) tensor([ 1791,   119,   953, 13680,  1272,  8296,   124,  1730,  5189,  1744])
-------Step 9-------
tensor([11601,   163,  4198,  6244,  4725,    97, 14451,    51, 10889,   774]) tensor([  261, 13117, 13800, 13311,  5000,  4839, 14614,   853,   120,  5879])
before start barrier
start train
[proc 0] 100 steps, total: 21.743, sample: 0.353, forward: 1.267, backward: 18.847, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 21.745, sample: 0.245, forward: 1.074, backward: 16.990, update: 0.215
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 21.741, sample: 0.275, forward: 1.023, backward: 16.810, update: 0.217
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 21.746, sample: 0.240, forward: 1.084, backward: 16.651, update: 0.207
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 21.745, sample: 0.298, forward: 1.060, backward: 16.887, update: 0.225
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 21.748, sample: 0.267, forward: 1.048, backward: 15.344, update: 0.245
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 21.745, sample: 0.259, forward: 1.023, backward: 17.174, update: 0.223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.496 ms                  | 17.813 ms                 |
| Forward                   | 7.791 ms                  | 15.408 ms                 |
| Backward                  | 189.213 ms                | 502.249 ms                |
| Optimize                  | 2.417 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 88.979 us                 | 73.651 ms                 |
| BlockToStepN              | 12.055 us                 | 640.333 us                |
| OneStep                   | 220.305 ms                | 554.706 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.564 ms                  | 17.813 ms                 |
| Forward                   | 7.812 ms                  | 15.408 ms                 |
| Backward                  | 208.711 ms                | 502.249 ms                |
| Optimize                  | 2.518 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 73.651 ms                 |
| BlockToStepN              | 12.563 us                 | 640.333 us                |
| OneStep                   | 225.778 ms                | 554.706 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.532 ms                  | 17.813 ms                 |
| Forward                   | 7.812 ms                  | 17.059 ms                 |
| Backward                  | 224.642 ms                | 541.736 ms                |
| Optimize                  | 2.560 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.860 us                 | 73.651 ms                 |
| BlockToStepN              | 12.992 us                 | 640.333 us                |
| OneStep                   | 255.605 ms                | 645.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 17.813 ms                 |
| Forward                   | 7.771 ms                  | 17.059 ms                 |
| Backward                  | 243.266 ms                | 565.430 ms                |
| Optimize                  | 2.562 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 68.810 us                 | 73.651 ms                 |
| BlockToStepN              | 13.021 us                 | 640.333 us                |
| OneStep                   | 277.367 ms                | 645.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.585 ms                  | 17.813 ms                 |
| Forward                   | 7.812 ms                  | 17.059 ms                 |
| Backward                  | 251.747 ms                | 633.641 ms                |
| Optimize                  | 2.614 ms                  | 11.064 ms                 |
| BarrierTimeBeforeRank0    | 69.140 us                 | 103.807 ms                |
| BlockToStepN              | 13.310 us                 | 640.333 us                |
| OneStep                   | 295.291 ms                | 727.859 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 17.556 ms                 |
| Forward                   | 7.819 ms                  | 15.408 ms                 |
| Backward                  | 267.050 ms                | 701.334 ms                |
| Optimize                  | 2.641 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 69.140 us                 | 73.651 ms                 |
| BlockToStepN              | 13.434 us                 | 503.200 us                |
| OneStep                   | 304.215 ms                | 727.859 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 17.556 ms                 |
| Forward                   | 7.819 ms                  | 15.408 ms                 |
| Backward                  | 290.404 ms                | 779.389 ms                |
| Optimize                  | 2.653 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 70.728 us                 | 103.807 ms                |
| BlockToStepN              | 13.456 us                 | 503.200 us                |
| OneStep                   | 315.103 ms                | 793.134 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.634 ms                  | 17.556 ms                 |
| Forward                   | 7.821 ms                  | 15.408 ms                 |
| Backward                  | 297.532 ms                | 799.009 ms                |
| Optimize                  | 2.653 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 70.451 us                 | 107.688 ms                |
| BlockToStepN              | 13.552 us                 | 503.200 us                |
| OneStep                   | 329.542 ms                | 814.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.654 ms                  | 17.556 ms                 |
| Forward                   | 7.843 ms                  | 15.408 ms                 |
| Backward                  | 317.547 ms                | 829.020 ms                |
| Optimize                  | 2.658 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 69.140 us                 | 127.021 ms                |
| BlockToStepN              | 13.552 us                 | 503.200 us                |
| OneStep                   | 357.957 ms                | 848.709 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.657 ms                  | 17.813 ms                 |
| Forward                   | 7.870 ms                  | 15.408 ms                 |
| Backward                  | 335.205 ms                | 833.848 ms                |
| Optimize                  | 2.671 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 70.952 us                 | 168.823 ms                |
| BlockToStepN              | 14.055 us                 | 503.200 us                |
| OneStep                   | 366.344 ms                | 853.302 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.692 ms                  | 17.813 ms                 |
| Forward                   | 7.879 ms                  | 15.408 ms                 |
| Backward                  | 345.396 ms                | 833.848 ms                |
| Optimize                  | 2.671 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 70.952 us                 | 168.823 ms                |
| BlockToStepN              | 14.363 us                 | 503.200 us                |
| OneStep                   | 377.556 ms                | 853.302 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.808 ms                  | 17.813 ms                 |
| Forward                   | 7.907 ms                  | 15.408 ms                 |
| Backward                  | 352.293 ms                | 861.936 ms                |
| Optimize                  | 2.693 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.711 us                 | 168.823 ms                |
| BlockToStepN              | 15.004 us                 | 640.333 us                |
| OneStep                   | 388.157 ms                | 944.683 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.853 ms                  | 17.813 ms                 |
| Forward                   | 7.946 ms                  | 15.408 ms                 |
| Backward                  | 363.045 ms                | 906.934 ms                |
| Optimize                  | 2.705 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.860 us                 | 170.181 ms                |
| BlockToStepN              | 15.777 us                 | 640.333 us                |
| OneStep                   | 402.637 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 63.802, sample: 0.273, forward: 0.588, backward: 46.636, update: 0.191
[proc 7] 200 steps, total: 63.802, sample: 0.277, forward: 0.699, backward: 48.150, update: 0.180
[proc 5] 200 steps, total: 63.801, sample: 0.307, forward: 0.624, backward: 48.212, update: 0.206
[proc 2] 200 steps, total: 63.802, sample: 0.283, forward: 0.676, backward: 46.158, update: 0.197
[proc 1] 200 steps, total: 63.801, sample: 0.304, forward: 0.589, backward: 43.647, update: 0.233
[proc 0] 200 steps, total: 63.802, sample: 0.392, forward: 0.827, backward: 59.913, update: 0.287
[proc 6] 200 steps, total: 63.802, sample: 0.265, forward: 0.688, backward: 47.116, update: 0.177
[proc 4] 200 steps, total: 63.802, sample: 0.310, forward: 0.624, backward: 48.618, update: 0.197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.853 ms                  | 17.813 ms                 |
| Forward                   | 7.946 ms                  | 15.408 ms                 |
| Backward                  | 385.536 ms                | 978.177 ms                |
| Optimize                  | 2.725 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.711 us                 | 170.181 ms                |
| BlockToStepN              | 15.859 us                 | 640.333 us                |
| OneStep                   | 409.503 ms                | 1.005 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.865 ms                  | 19.512 ms                 |
| Forward                   | 7.969 ms                  | 17.059 ms                 |
| Backward                  | 390.580 ms                | 1.011 s                   |
| Optimize                  | 2.730 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.711 us                 | 170.181 ms                |
| BlockToStepN              | 16.286 us                 | 640.333 us                |
| OneStep                   | 433.882 ms                | 1.061 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.890 ms                  | 19.512 ms                 |
| Forward                   | 8.018 ms                  | 17.059 ms                 |
| Backward                  | 392.414 ms                | 1.038 s                   |
| Optimize                  | 2.745 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.864 us                 | 170.181 ms                |
| BlockToStepN              | 16.286 us                 | 640.333 us                |
| OneStep                   | 437.964 ms                | 1.113 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.899 ms                  | 19.512 ms                 |
| Forward                   | 8.101 ms                  | 17.059 ms                 |
| Backward                  | 412.506 ms                | 1.081 s                   |
| Optimize                  | 2.751 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.860 us                 | 170.181 ms                |
| BlockToStepN              | 16.509 us                 | 640.333 us                |
| OneStep                   | 449.847 ms                | 1.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.897 ms                  | 19.512 ms                 |
| Forward                   | 8.101 ms                  | 17.059 ms                 |
| Backward                  | 426.154 ms                | 1.081 s                   |
| Optimize                  | 2.752 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.864 us                 | 170.181 ms                |
| BlockToStepN              | 16.509 us                 | 640.333 us                |
| OneStep                   | 457.266 ms                | 1.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.897 ms                  | 19.512 ms                 |
| Forward                   | 8.125 ms                  | 17.059 ms                 |
| Backward                  | 433.923 ms                | 1.081 s                   |
| Optimize                  | 2.752 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 72.864 us                 | 170.181 ms                |
| BlockToStepN              | 16.591 us                 | 640.333 us                |
| OneStep                   | 464.614 ms                | 1.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.905 ms                  | 19.512 ms                 |
| Forward                   | 8.148 ms                  | 17.059 ms                 |
| Backward                  | 436.634 ms                | 1.111 s                   |
| Optimize                  | 2.782 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.860 us                 | 170.181 ms                |
| BlockToStepN              | 16.807 us                 | 640.333 us                |
| OneStep                   | 484.033 ms                | 1.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.919 ms                  | 19.512 ms                 |
| Forward                   | 8.149 ms                  | 17.059 ms                 |
| Backward                  | 449.745 ms                | 1.111 s                   |
| Optimize                  | 2.798 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.713 us                 | 170.181 ms                |
| BlockToStepN              | 17.090 us                 | 640.333 us                |
| OneStep                   | 490.486 ms                | 1.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.947 ms                  | 19.512 ms                 |
| Forward                   | 8.149 ms                  | 17.059 ms                 |
| Backward                  | 471.646 ms                | 1.134 s                   |
| Optimize                  | 2.806 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 170.181 ms                |
| BlockToStepN              | 17.109 us                 | 640.333 us                |
| OneStep                   | 504.371 ms                | 1.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 19.512 ms                 |
| Forward                   | 8.149 ms                  | 17.059 ms                 |
| Backward                  | 482.474 ms                | 1.141 s                   |
| Optimize                  | 2.826 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 73.860 us                 | 170.181 ms                |
| BlockToStepN              | 17.109 us                 | 640.333 us                |
| OneStep                   | 512.068 ms                | 1.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.992 ms                  | 17.813 ms                 |
| Forward                   | 8.182 ms                  | 15.408 ms                 |
| Backward                  | 490.290 ms                | 1.214 s                   |
| Optimize                  | 2.848 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 17.306 us                 | 522.260 us                |
| OneStep                   | 517.423 ms                | 1.256 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 17.813 ms                 |
| Forward                   | 8.185 ms                  | 15.408 ms                 |
| Backward                  | 499.284 ms                | 1.249 s                   |
| Optimize                  | 2.855 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 17.306 us                 | 522.260 us                |
| OneStep                   | 520.651 ms                | 1.275 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 17.813 ms                 |
| Forward                   | 8.185 ms                  | 15.408 ms                 |
| Backward                  | 502.249 ms                | 1.249 s                   |
| Optimize                  | 2.855 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 17.306 us                 | 522.260 us                |
| OneStep                   | 532.939 ms                | 1.277 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 17.813 ms                 |
| Forward                   | 8.184 ms                  | 15.408 ms                 |
| Backward                  | 507.957 ms                | 1.262 s                   |
| Optimize                  | 2.881 ms                  | 6.954 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 17.595 us                 | 522.260 us                |
| OneStep                   | 553.498 ms                | 1.293 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.044 ms                  | 19.397 ms                 |
| Forward                   | 8.212 ms                  | 15.408 ms                 |
| Backward                  | 515.339 ms                | 1.287 s                   |
| Optimize                  | 2.896 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 17.528 us                 | 522.260 us                |
| OneStep                   | 556.282 ms                | 1.301 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.052 ms                  | 19.397 ms                 |
| Forward                   | 8.234 ms                  | 15.408 ms                 |
| Backward                  | 530.635 ms                | 1.305 s                   |
| Optimize                  | 2.896 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 17.740 us                 | 640.333 us                |
| OneStep                   | 567.415 ms                | 1.321 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.044 ms                  | 19.397 ms                 |
| Forward                   | 8.234 ms                  | 15.408 ms                 |
| Backward                  | 540.876 ms                | 1.305 s                   |
| Optimize                  | 2.896 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 74.420 us                 | 204.400 ms                |
| BlockToStepN              | 18.707 us                 | 640.333 us                |
| OneStep                   | 569.816 ms                | 1.321 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.060 ms                  | 19.397 ms                 |
| Forward                   | 8.238 ms                  | 15.408 ms                 |
| Backward                  | 544.510 ms                | 1.365 s                   |
| Optimize                  | 2.900 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 18.707 us                 | 640.333 us                |
| OneStep                   | 577.320 ms                | 1.381 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.075 ms                  | 19.397 ms                 |
| Forward                   | 8.240 ms                  | 15.408 ms                 |
| Backward                  | 555.952 ms                | 1.379 s                   |
| Optimize                  | 2.915 ms                  | 7.068 ms                  |
| BarrierTimeBeforeRank0    | 75.359 us                 | 204.400 ms                |
| BlockToStepN              | 18.844 us                 | 640.333 us                |
| OneStep                   | 587.315 ms                | 1.409 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.075 ms                  | 19.397 ms                 |
| Forward                   | 8.250 ms                  | 15.408 ms                 |
| Backward                  | 565.167 ms                | 1.425 s                   |
| Optimize                  | 2.944 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 18.860 us                 | 640.333 us                |
| OneStep                   | 587.617 ms                | 1.438 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.064 ms                  | 19.397 ms                 |
| Forward                   | 8.240 ms                  | 15.408 ms                 |
| Backward                  | 567.611 ms                | 1.451 s                   |
| Optimize                  | 2.944 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 18.860 us                 | 640.333 us                |
| OneStep                   | 596.738 ms                | 1.464 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.079 ms                  | 19.397 ms                 |
| Forward                   | 8.240 ms                  | 15.408 ms                 |
| Backward                  | 574.680 ms                | 1.451 s                   |
| Optimize                  | 2.963 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 18.860 us                 | 766.009 us                |
| OneStep                   | 619.625 ms                | 1.467 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 109.732, sample: 0.254, forward: 0.712, backward: 78.229, update: 0.188
[proc 4] 300 steps, total: 109.731, sample: 0.326, forward: 0.629, backward: 78.382, update: 0.194
[proc 6] 300 steps, total: 109.731, sample: 0.278, forward: 0.682, backward: 77.332, update: 0.173
[proc 5] 300 steps, total: 109.732, sample: 0.272, forward: 0.607, backward: 76.216, update: 0.187
[proc 0] 300 steps, total: 109.731, sample: 0.420, forward: 0.880, backward: 107.123, update: 0.311
[proc 1] 300 steps, total: 109.732, sample: 0.268, forward: 0.591, backward: 70.383, update: 0.220
[proc 2] 300 steps, total: 109.732, sample: 0.286, forward: 0.684, backward: 75.079, update: 0.195
[proc 3] 300 steps, total: 109.732, sample: 0.264, forward: 0.586, backward: 75.659, update: 0.183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.082 ms                  | 19.397 ms                 |
| Forward                   | 8.250 ms                  | 15.408 ms                 |
| Backward                  | 575.800 ms                | 1.451 s                   |
| Optimize                  | 2.963 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 19.164 us                 | 766.009 us                |
| OneStep                   | 634.154 ms                | 1.467 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.111 ms                  | 19.397 ms                 |
| Forward                   | 8.267 ms                  | 15.408 ms                 |
| Backward                  | 582.923 ms                | 1.451 s                   |
| Optimize                  | 2.963 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 18.860 us                 | 766.009 us                |
| OneStep                   | 645.296 ms                | 1.467 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.114 ms                  | 19.397 ms                 |
| Forward                   | 8.271 ms                  | 15.408 ms                 |
| Backward                  | 604.444 ms                | 1.483 s                   |
| Optimize                  | 2.963 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 19.164 us                 | 766.009 us                |
| OneStep                   | 659.751 ms                | 1.505 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.114 ms                  | 19.397 ms                 |
| Forward                   | 8.279 ms                  | 15.408 ms                 |
| Backward                  | 608.045 ms                | 1.483 s                   |
| Optimize                  | 2.972 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.598 us                 | 204.400 ms                |
| BlockToStepN              | 19.382 us                 | 766.009 us                |
| OneStep                   | 669.420 ms                | 1.505 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.122 ms                  | 19.397 ms                 |
| Forward                   | 8.279 ms                  | 15.408 ms                 |
| Backward                  | 613.139 ms                | 1.549 s                   |
| Optimize                  | 2.987 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 19.475 us                 | 766.009 us                |
| OneStep                   | 676.190 ms                | 1.563 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.114 ms                  | 19.397 ms                 |
| Forward                   | 8.279 ms                  | 15.408 ms                 |
| Backward                  | 635.650 ms                | 1.570 s                   |
| Optimize                  | 3.000 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 19.548 us                 | 766.009 us                |
| OneStep                   | 683.139 ms                | 1.584 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.122 ms                  | 19.397 ms                 |
| Forward                   | 8.279 ms                  | 15.408 ms                 |
| Backward                  | 649.104 ms                | 1.570 s                   |
| Optimize                  | 2.987 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.359 us                 | 204.400 ms                |
| BlockToStepN              | 19.475 us                 | 766.009 us                |
| OneStep                   | 689.572 ms                | 1.584 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.127 ms                  | 19.397 ms                 |
| Forward                   | 8.279 ms                  | 15.408 ms                 |
| Backward                  | 662.465 ms                | 1.582 s                   |
| Optimize                  | 2.987 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.359 us                 | 204.400 ms                |
| BlockToStepN              | 20.019 us                 | 766.009 us                |
| OneStep                   | 692.140 ms                | 1.598 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.132 ms                  | 19.397 ms                 |
| Forward                   | 8.283 ms                  | 15.408 ms                 |
| Backward                  | 670.612 ms                | 1.596 s                   |
| Optimize                  | 3.000 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 204.400 ms                |
| BlockToStepN              | 20.023 us                 | 766.009 us                |
| OneStep                   | 698.556 ms                | 1.609 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.127 ms                  | 19.397 ms                 |
| Forward                   | 8.297 ms                  | 15.408 ms                 |
| Backward                  | 675.683 ms                | 1.596 s                   |
| Optimize                  | 3.044 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.359 us                 | 204.400 ms                |
| BlockToStepN              | 20.210 us                 | 766.009 us                |
| OneStep                   | 719.120 ms                | 1.609 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.122 ms                  | 19.397 ms                 |
| Forward                   | 8.297 ms                  | 15.408 ms                 |
| Backward                  | 676.097 ms                | 1.599 s                   |
| Optimize                  | 3.045 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 20.210 us                 | 766.009 us                |
| OneStep                   | 723.898 ms                | 1.618 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.114 ms                  | 19.397 ms                 |
| Forward                   | 8.300 ms                  | 15.408 ms                 |
| Backward                  | 700.282 ms                | 1.646 s                   |
| Optimize                  | 3.063 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 20.210 us                 | 766.009 us                |
| OneStep                   | 725.095 ms                | 1.659 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.104 ms                  | 19.397 ms                 |
| Forward                   | 8.300 ms                  | 15.408 ms                 |
| Backward                  | 704.912 ms                | 1.646 s                   |
| Optimize                  | 3.069 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 20.210 us                 | 766.009 us                |
| OneStep                   | 727.859 ms                | 1.659 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.111 ms                  | 19.397 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 705.144 ms                | 1.679 s                   |
| Optimize                  | 3.069 ms                  | 8.932 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 204.400 ms                |
| BlockToStepN              | 20.210 us                 | 766.009 us                |
| OneStep                   | 749.874 ms                | 1.704 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.104 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 710.898 ms                | 1.689 s                   |
| Optimize                  | 3.083 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.211 us                 | 170.181 ms                |
| BlockToStepN              | 20.266 us                 | 766.009 us                |
| OneStep                   | 752.510 ms                | 1.710 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.103 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 711.899 ms                | 1.713 s                   |
| Optimize                  | 3.084 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.359 us                 | 170.181 ms                |
| BlockToStepN              | 20.266 us                 | 766.009 us                |
| OneStep                   | 752.957 ms                | 1.728 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.082 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 738.979 ms                | 1.714 s                   |
| Optimize                  | 3.094 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 75.823 us                 | 170.181 ms                |
| BlockToStepN              | 20.266 us                 | 766.009 us                |
| OneStep                   | 753.971 ms                | 1.738 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.077 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 741.893 ms                | 1.745 s                   |
| Optimize                  | 3.096 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.237 us                 | 170.181 ms                |
| BlockToStepN              | 20.346 us                 | 766.009 us                |
| OneStep                   | 760.932 ms                | 1.771 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.079 ms                  | 18.306 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 744.249 ms                | 1.762 s                   |
| Optimize                  | 3.100 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.237 us                 | 170.181 ms                |
| BlockToStepN              | 20.346 us                 | 766.009 us                |
| OneStep                   | 762.071 ms                | 1.780 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.075 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 748.930 ms                | 1.803 s                   |
| Optimize                  | 3.109 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 170.181 ms                |
| BlockToStepN              | 20.362 us                 | 766.009 us                |
| OneStep                   | 790.736 ms                | 1.818 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.075 ms                  | 18.306 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 749.704 ms                | 1.808 s                   |
| Optimize                  | 3.115 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 170.181 ms                |
| BlockToStepN              | 20.362 us                 | 766.009 us                |
| OneStep                   | 791.407 ms                | 1.822 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.060 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 771.317 ms                | 1.808 s                   |
| Optimize                  | 3.127 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 170.181 ms                |
| BlockToStepN              | 20.362 us                 | 766.009 us                |
| OneStep                   | 795.987 ms                | 1.822 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.052 ms                  | 18.306 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 771.362 ms                | 1.808 s                   |
| Optimize                  | 3.127 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 170.181 ms                |
| BlockToStepN              | 20.362 us                 | 766.009 us                |
| OneStep                   | 800.308 ms                | 1.822 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.052 ms                  | 18.306 ms                 |
| Forward                   | 8.321 ms                  | 15.408 ms                 |
| Backward                  | 779.389 ms                | 1.808 s                   |
| Optimize                  | 3.127 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.446 us                 | 170.181 ms                |
| BlockToStepN              | 20.362 us                 | 766.009 us                |
| OneStep                   | 814.961 ms                | 1.822 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.044 ms                  | 18.306 ms                 |
| Forward                   | 8.321 ms                  | 15.408 ms                 |
| Backward                  | 780.702 ms                | 1.826 s                   |
| Optimize                  | 3.127 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.505 us                 | 170.181 ms                |
| BlockToStepN              | 20.420 us                 | 766.009 us                |
| OneStep                   | 824.031 ms                | 1.853 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.025 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 799.009 ms                | 1.878 s                   |
| Optimize                  | 3.150 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.854 us                 | 170.181 ms                |
| BlockToStepN              | 20.761 us                 | 766.009 us                |
| OneStep                   | 827.158 ms                | 1.893 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.025 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 800.037 ms                | 1.953 s                   |
| Optimize                  | 3.155 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.854 us                 | 170.181 ms                |
| BlockToStepN              | 20.761 us                 | 766.009 us                |
| OneStep                   | 830.800 ms                | 1.968 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.042 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 800.546 ms                | 1.953 s                   |
| Optimize                  | 3.155 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 76.903 us                 | 170.181 ms                |
| BlockToStepN              | 20.731 us                 | 766.009 us                |
| OneStep                   | 830.980 ms                | 1.970 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.025 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 813.633 ms                | 1.982 s                   |
| Optimize                  | 3.160 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.366 us                 | 170.181 ms                |
| BlockToStepN              | 20.761 us                 | 766.009 us                |
| OneStep                   | 842.123 ms                | 2.007 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.042 ms                  | 18.306 ms                 |
| Forward                   | 8.321 ms                  | 15.408 ms                 |
| Backward                  | 815.294 ms                | 1.982 s                   |
| Optimize                  | 3.160 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.366 us                 | 170.181 ms                |
| BlockToStepN              | 20.420 us                 | 766.009 us                |
| OneStep                   | 848.709 ms                | 2.007 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.025 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 822.988 ms                | 1.982 s                   |
| Optimize                  | 3.166 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.366 us                 | 170.181 ms                |
| BlockToStepN              | 20.731 us                 | 766.009 us                |
| OneStep                   | 849.121 ms                | 2.007 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 7] 400 steps, total: 156.459, sample: 0.273, forward: 0.704, backward: 107.696, update: 0.187
[proc 4] 400 steps, total: 156.459, sample: 0.257, forward: 0.620, backward: 106.708, update: 0.179
[proc 1] 400 steps, total: 156.458, sample: 0.240, forward: 0.581, backward: 96.226, update: 0.208
[proc 2] 400 steps, total: 156.458, sample: 0.262, forward: 0.683, backward: 103.365, update: 0.201
[proc 6] 400 steps, total: 156.459, sample: 0.253, forward: 0.699, backward: 108.076, update: 0.185
[proc 5] 400 steps, total: 156.458, sample: 0.257, forward: 0.632, backward: 106.195, update: 0.187
[proc 0] 400 steps, total: 156.458, sample: 0.384, forward: 0.852, backward: 154.669, update: 0.316
[proc 3] 400 steps, total: 156.458, sample: 0.272, forward: 0.594, backward: 105.599, update: 0.195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 829.020 ms                | 2.011 s                   |
| Optimize                  | 3.175 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.391 us                 | 170.181 ms                |
| BlockToStepN              | 21.033 us                 | 766.009 us                |
| OneStep                   | 854.191 ms                | 2.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.992 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 829.527 ms                | 2.014 s                   |
| Optimize                  | 3.175 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.391 us                 | 170.181 ms                |
| BlockToStepN              | 21.069 us                 | 766.009 us                |
| OneStep                   | 856.605 ms                | 2.028 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.991 ms                  | 18.306 ms                 |
| Forward                   | 8.322 ms                  | 15.408 ms                 |
| Backward                  | 833.848 ms                | 2.014 s                   |
| Optimize                  | 3.177 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.471 us                 | 170.181 ms                |
| BlockToStepN              | 21.132 us                 | 766.009 us                |
| OneStep                   | 865.685 ms                | 2.029 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 838.768 ms                | 2.041 s                   |
| Optimize                  | 3.184 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.768 us                 | 170.181 ms                |
| BlockToStepN              | 21.164 us                 | 766.009 us                |
| OneStep                   | 868.888 ms                | 2.056 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.988 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 838.855 ms                | 2.041 s                   |
| Optimize                  | 3.184 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.768 us                 | 170.181 ms                |
| BlockToStepN              | 21.164 us                 | 766.009 us                |
| OneStep                   | 868.984 ms                | 2.056 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.988 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 840.725 ms                | 2.048 s                   |
| Optimize                  | 3.186 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 77.830 us                 | 204.400 ms                |
| BlockToStepN              | 21.296 us                 | 766.009 us                |
| OneStep                   | 875.241 ms                | 2.063 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 18.306 ms                 |
| Forward                   | 8.307 ms                  | 15.408 ms                 |
| Backward                  | 850.499 ms                | 2.066 s                   |
| Optimize                  | 3.195 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.197 us                 | 204.400 ms                |
| BlockToStepN              | 21.430 us                 | 766.009 us                |
| OneStep                   | 894.225 ms                | 2.080 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 18.306 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 852.865 ms                | 2.095 s                   |
| Optimize                  | 3.204 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.332 us                 | 206.842 ms                |
| BlockToStepN              | 21.526 us                 | 766.009 us                |
| OneStep                   | 902.555 ms                | 2.114 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 18.306 ms                 |
| Forward                   | 8.307 ms                  | 15.408 ms                 |
| Backward                  | 854.963 ms                | 2.139 s                   |
| Optimize                  | 3.206 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.636 us                 | 206.842 ms                |
| BlockToStepN              | 22.169 us                 | 766.009 us                |
| OneStep                   | 902.584 ms                | 2.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.987 ms                  | 18.386 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 861.936 ms                | 2.139 s                   |
| Optimize                  | 3.206 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.332 us                 | 206.842 ms                |
| BlockToStepN              | 22.510 us                 | 878.547 us                |
| OneStep                   | 918.813 ms                | 2.153 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.987 ms                  | 18.386 ms                 |
| Forward                   | 8.311 ms                  | 15.408 ms                 |
| Backward                  | 862.301 ms                | 2.144 s                   |
| Optimize                  | 3.214 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.636 us                 | 206.842 ms                |
| BlockToStepN              | 22.835 us                 | 957.056 us                |
| OneStep                   | 919.567 ms                | 2.159 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.975 ms                  | 18.386 ms                 |
| Forward                   | 8.321 ms                  | 15.408 ms                 |
| Backward                  | 886.475 ms                | 2.146 s                   |
| Optimize                  | 3.222 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.639 us                 | 206.842 ms                |
| BlockToStepN              | 22.966 us                 | 957.056 us                |
| OneStep                   | 926.453 ms                | 2.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.975 ms                  | 18.386 ms                 |
| Forward                   | 8.321 ms                  | 15.408 ms                 |
| Backward                  | 889.583 ms                | 2.171 s                   |
| Optimize                  | 3.237 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.785 us                 | 206.842 ms                |
| BlockToStepN              | 23.312 us                 | 957.056 us                |
| OneStep                   | 926.473 ms                | 2.195 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.975 ms                  | 18.386 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 891.923 ms                | 2.171 s                   |
| Optimize                  | 3.244 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.785 us                 | 206.842 ms                |
| BlockToStepN              | 23.362 us                 | 957.056 us                |
| OneStep                   | 939.094 ms                | 2.195 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.386 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 901.886 ms                | 2.179 s                   |
| Optimize                  | 3.249 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.639 us                 | 206.842 ms                |
| BlockToStepN              | 23.494 us                 | 957.056 us                |
| OneStep                   | 940.019 ms                | 2.243 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.386 ms                 |
| Forward                   | 8.329 ms                  | 15.408 ms                 |
| Backward                  | 906.839 ms                | 2.179 s                   |
| Optimize                  | 3.252 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.636 us                 | 206.842 ms                |
| BlockToStepN              | 23.494 us                 | 957.056 us                |
| OneStep                   | 944.023 ms                | 2.243 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.386 ms                 |
| Forward                   | 8.329 ms                  | 15.408 ms                 |
| Backward                  | 909.228 ms                | 2.230 s                   |
| Optimize                  | 3.258 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.785 us                 | 206.842 ms                |
| BlockToStepN              | 23.806 us                 | 957.056 us                |
| OneStep                   | 949.311 ms                | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.970 ms                  | 18.386 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 918.941 ms                | 2.230 s                   |
| Optimize                  | 3.259 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.785 us                 | 206.842 ms                |
| BlockToStepN              | 23.933 us                 | 957.056 us                |
| OneStep                   | 967.009 ms                | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.386 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 924.689 ms                | 2.256 s                   |
| Optimize                  | 3.263 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.815 us                 | 241.982 ms                |
| BlockToStepN              | 24.026 us                 | 957.056 us                |
| OneStep                   | 971.016 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.970 ms                  | 18.386 ms                 |
| Forward                   | 8.328 ms                  | 15.408 ms                 |
| Backward                  | 925.799 ms                | 2.275 s                   |
| Optimize                  | 3.259 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.815 us                 | 241.982 ms                |
| BlockToStepN              | 24.064 us                 | 957.056 us                |
| OneStep                   | 979.057 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.970 ms                  | 18.306 ms                 |
| Forward                   | 8.329 ms                  | 14.340 ms                 |
| Backward                  | 934.416 ms                | 2.276 s                   |
| Optimize                  | 3.263 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.815 us                 | 241.982 ms                |
| BlockToStepN              | 24.238 us                 | 957.056 us                |
| OneStep                   | 987.058 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.329 ms                  | 14.340 ms                 |
| Backward                  | 956.037 ms                | 2.275 s                   |
| Optimize                  | 3.272 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.909 us                 | 206.842 ms                |
| BlockToStepN              | 24.252 us                 | 878.547 us                |
| OneStep                   | 994.510 ms                | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.332 ms                  | 14.340 ms                 |
| Backward                  | 960.324 ms                | 2.275 s                   |
| Optimize                  | 3.273 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 78.909 us                 | 206.842 ms                |
| BlockToStepN              | 24.611 us                 | 878.547 us                |
| OneStep                   | 997.113 ms                | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.332 ms                  | 14.340 ms                 |
| Backward                  | 965.070 ms                | 2.276 s                   |
| Optimize                  | 3.274 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.073 us                 | 206.842 ms                |
| BlockToStepN              | 24.981 us                 | 878.547 us                |
| OneStep                   | 1.003 s                   | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.339 ms                  | 14.340 ms                 |
| Backward                  | 975.184 ms                | 2.336 s                   |
| Optimize                  | 3.274 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.151 us                 | 206.842 ms                |
| BlockToStepN              | 25.285 us                 | 878.547 us                |
| OneStep                   | 1.003 s                   | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.339 ms                  | 14.340 ms                 |
| Backward                  | 975.680 ms                | 2.350 s                   |
| Optimize                  | 3.275 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 206.842 ms                |
| BlockToStepN              | 25.586 us                 | 878.547 us                |
| OneStep                   | 1.003 s                   | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.368 ms                  | 14.340 ms                 |
| Backward                  | 978.177 ms                | 2.350 s                   |
| Optimize                  | 3.278 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 241.982 ms                |
| BlockToStepN              | 25.686 us                 | 878.547 us                |
| OneStep                   | 1.004 s                   | 2.701 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.368 ms                  | 14.340 ms                 |
| Backward                  | 978.370 ms                | 2.384 s                   |
| Optimize                  | 3.279 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 241.982 ms                |
| BlockToStepN              | 25.770 us                 | 878.547 us                |
| OneStep                   | 1.005 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.370 ms                  | 14.340 ms                 |
| Backward                  | 985.193 ms                | 2.384 s                   |
| Optimize                  | 3.280 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 241.982 ms                |
| BlockToStepN              | 25.875 us                 | 878.547 us                |
| OneStep                   | 1.008 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.969 ms                  | 18.306 ms                 |
| Forward                   | 8.372 ms                  | 14.340 ms                 |
| Backward                  | 986.794 ms                | 2.386 s                   |
| Optimize                  | 3.281 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 241.982 ms                |
| BlockToStepN              | 25.918 us                 | 878.547 us                |
| OneStep                   | 1.012 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.970 ms                  | 18.306 ms                 |
| Forward                   | 8.376 ms                  | 14.340 ms                 |
| Backward                  | 989.280 ms                | 2.386 s                   |
| Optimize                  | 3.281 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.318 us                 | 241.982 ms                |
| BlockToStepN              | 26.348 us                 | 878.547 us                |
| OneStep                   | 1.012 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.970 ms                  | 18.306 ms                 |
| Forward                   | 8.376 ms                  | 14.340 ms                 |
| Backward                  | 994.041 ms                | 2.386 s                   |
| Optimize                  | 3.282 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.450 us                 | 241.982 ms                |
| BlockToStepN              | 26.519 us                 | 878.547 us                |
| OneStep                   | 1.021 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.306 ms                 |
| Forward                   | 8.376 ms                  | 14.340 ms                 |
| Backward                  | 996.289 ms                | 2.394 s                   |
| Optimize                  | 3.283 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.450 us                 | 241.982 ms                |
| BlockToStepN              | 26.835 us                 | 878.547 us                |
| OneStep                   | 1.027 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.974 ms                  | 18.306 ms                 |
| Forward                   | 8.376 ms                  | 14.340 ms                 |
| Backward                  | 996.746 ms                | 2.434 s                   |
| Optimize                  | 3.283 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.595 us                 | 241.982 ms                |
| BlockToStepN              | 26.835 us                 | 878.547 us                |
| OneStep                   | 1.036 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.975 ms                  | 18.306 ms                 |
| Forward                   | 8.385 ms                  | 14.340 ms                 |
| Backward                  | 1.011 s                   | 2.466 s                   |
| Optimize                  | 3.285 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.595 us                 | 241.982 ms                |
| BlockToStepN              | 26.835 us                 | 878.547 us                |
| OneStep                   | 1.039 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.975 ms                  | 18.306 ms                 |
| Forward                   | 8.385 ms                  | 14.340 ms                 |
| Backward                  | 1.015 s                   | 2.466 s                   |
| Optimize                  | 3.286 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.729 us                 | 241.982 ms                |
| BlockToStepN              | 26.835 us                 | 878.547 us                |
| OneStep                   | 1.043 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.978 ms                  | 18.306 ms                 |
| Forward                   | 8.385 ms                  | 14.340 ms                 |
| Backward                  | 1.018 s                   | 2.478 s                   |
| Optimize                  | 3.286 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.777 us                 | 241.982 ms                |
| BlockToStepN              | 26.835 us                 | 878.547 us                |
| OneStep                   | 1.052 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.978 ms                  | 18.306 ms                 |
| Forward                   | 8.386 ms                  | 14.340 ms                 |
| Backward                  | 1.021 s                   | 2.478 s                   |
| Optimize                  | 3.288 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.777 us                 | 241.982 ms                |
| BlockToStepN              | 27.213 us                 | 878.547 us                |
| OneStep                   | 1.052 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.978 ms                  | 18.306 ms                 |
| Forward                   | 8.386 ms                  | 14.340 ms                 |
| Backward                  | 1.024 s                   | 2.478 s                   |
| Optimize                  | 3.288 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.729 us                 | 241.982 ms                |
| BlockToStepN              | 27.299 us                 | 878.547 us                |
| OneStep                   | 1.052 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 18.306 ms                 |
| Forward                   | 8.391 ms                  | 14.340 ms                 |
| Backward                  | 1.036 s                   | 2.496 s                   |
| Optimize                  | 3.288 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.595 us                 | 241.982 ms                |
| BlockToStepN              | 27.722 us                 | 878.547 us                |
| OneStep                   | 1.054 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.987 ms                  | 18.306 ms                 |
| Forward                   | 8.394 ms                  | 14.340 ms                 |
| Backward                  | 1.038 s                   | 2.496 s                   |
| Optimize                  | 3.291 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.729 us                 | 241.982 ms                |
| BlockToStepN              | 27.932 us                 | 878.547 us                |
| OneStep                   | 1.067 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.988 ms                  | 18.306 ms                 |
| Forward                   | 8.394 ms                  | 14.340 ms                 |
| Backward                  | 1.039 s                   | 2.504 s                   |
| Optimize                  | 3.294 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.777 us                 | 241.982 ms                |
| BlockToStepN              | 27.932 us                 | 878.547 us                |
| OneStep                   | 1.077 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.991 ms                  | 18.306 ms                 |
| Forward                   | 8.391 ms                  | 14.340 ms                 |
| Backward                  | 1.042 s                   | 2.504 s                   |
| Optimize                  | 3.294 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.839 us                 | 241.982 ms                |
| BlockToStepN              | 27.766 us                 | 878.547 us                |
| OneStep                   | 1.085 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 213.226, sample: 0.258, forward: 0.616, backward: 136.079, update: 0.195
[proc 0] 500 steps, total: 213.226, sample: 0.364, forward: 0.876, backward: 208.188, update: 0.326
Successfully xmh. training takes 564.9615988731384 seconds
before call kg_cache_controller.StopThreads()
[proc 5] 500 steps, total: 213.226, sample: 0.252, forward: 0.614, backward: 136.672, update: 0.199
[proc 2] 500 steps, total: 213.226, sample: 0.276, forward: 0.726, backward: 140.863, update: 0.225
[proc 4] 500 steps, total: 213.226, sample: 0.275, forward: 0.621, backward: 137.373, update: 0.180
[proc 6] 500 steps, total: 213.226, sample: 0.275, forward: 0.750, backward: 148.011, update: 0.234
[proc 1] 500 steps, total: 213.226, sample: 0.273, forward: 0.592, backward: 124.221, update: 0.215
[proc 7] 500 steps, total: 213.226, sample: 0.266, forward: 0.762, backward: 144.731, update: 0.210
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
INFO [44996 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.991 ms                  | 18.306 ms                 |
| Forward                   | 8.391 ms                  | 14.340 ms                 |
| Backward                  | 1.042 s                   | 2.535 s                   |
| Optimize                  | 3.294 ms                  | 7.141 ms                  |
| BarrierTimeBeforeRank0    | 79.839 us                 | 241.982 ms                |
| BlockToStepN              | 27.766 us                 | 878.547 us                |
| OneStep                   | 1.085 s                   | 2.937 s                   |
+---------------------------+---------------------------+---------------------------+
