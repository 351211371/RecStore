WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 16:43:32.703298 21136 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_81', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [21136 sampler.py:454] Start PreSampling
WARNING [21136 sampler.py:532] Before construct renumbering_dict
WARNING [21136 sampler.py:555] PreSampling done
W20240124 16:56:23.984745 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 16:56:23.984967 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 16:56:23.984994 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 16:56:23.985015 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 16:56:23.985034 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 16:56:23.985069 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 16:56:23.985088 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 16:56:23.985122 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 16:56:23.985147 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 16:56:23.985172 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 16:56:23.985203 21136 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 16:56:23.985222 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 16:56:23.985244 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 16:56:23.985378 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 16:56:23.985409 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 16:56:23.985426 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 16:56:23.985471 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 16:56:23.985487 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 16:56:23.985512 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 16:56:23.985530 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 16:56:23.985548 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 16:56:23.985574 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 16:56:23.985599 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 16:56:23.985621 21136 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 16:56:23.985636 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 16:56:23.985651 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 16:56:23.985689 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 16:56:23.985708 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 16:56:23.985726 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 16:56:23.985743 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 16:56:23.985762 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 16:56:23.985782 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 16:56:23.985806 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 16:56:23.985836 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 16:56:23.985857 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 16:56:23.985873 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 16:56:23.985893 21136 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 16:56:23.985908 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 16:56:23.985925 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 16:56:23.985971 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 16:56:23.985991 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 16:56:23.986006 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 16:56:23.986028 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 16:56:23.986047 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 16:56:23.986068 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 16:56:23.986094 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 16:56:23.986114 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 16:56:23.986133 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 16:56:23.986150 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 16:56:23.986171 21136 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 16:56:23.986184 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 16:56:23.986202 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 16:56:23.986236 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 16:56:23.986263 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 16:56:23.986285 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 16:56:23.986301 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 16:56:23.986317 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 16:56:23.986336 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 16:56:23.986352 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 16:56:23.986375 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 16:56:23.986399 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 16:56:23.986420 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 16:56:23.986439 21136 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 16:56:23.986454 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 16:56:23.986466 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 16:56:23.986500 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 16:56:23.986521 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 16:56:23.986544 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 16:56:23.986560 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 16:56:23.986582 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 16:56:23.986598 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 16:56:23.986621 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 16:56:23.986640 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 16:56:23.986656 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 16:56:23.986672 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 16:56:23.986688 21136 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 16:56:23.986702 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 16:56:23.986714 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 16:56:23.986744 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 16:56:23.986771 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 16:56:23.986791 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 16:56:23.986812 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 16:56:23.986829 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 16:56:23.986845 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 16:56:23.986865 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 16:56:23.986881 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 16:56:23.986904 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 16:56:23.986927 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 16:56:23.986948 21136 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 16:56:23.986965 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 16:56:23.986979 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 16:56:23.987015 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 16:56:23.987041 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 16:56:23.987059 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 16:56:23.987075 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 16:56:23.987092 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 16:56:23.987114 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 16:56:23.987130 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 16:56:23.987147 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 16:56:23.987164 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 16:56:23.987190 21136 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 16:56:23.987206 21136 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 16:56:23.987219 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 16:56:23.987232 21136 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 16:56:24.342070 21136 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 16:56:24.342239 21136 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302767,  4302791,    58685,  ..., 56412290, 16961568, 30140427]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 947.814 seconds
[Rank1] pid = 45436
[Rank2] pid = 45538
[Rank3] pid = 45614
[Rank4] pid = 45687
[Rank5] pid = 45769
[Rank6] pid = 45853
INFO [21136 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [45436 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [45538 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [45614 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [45687 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [45853 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [45853 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45929 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [45769 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [45687 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45769 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45614 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45929 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45538 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21136 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45436 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [45614 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45538 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45769 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45929 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21136 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45853 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45436 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45687 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 16:59:37.021574 45688 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.021800 45854 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.021972 45615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.022204 45993 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.022316 45770 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.022464 45539 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.023659 45930 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 16:59:37.023777 45437 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 16:59:44.007766 45993 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 16:59:44.375434 45770 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:45.465440 45854 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:45.719343 45539 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:46.588440 45437 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:46.635105 45930 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:46.792171 45688 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 16:59:46.892699 45615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.745 ms                  | 6.745 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.745 ms                  | 43.968 ms                 |
| bucket keys               | 1.604 ms                  | 153.347 ms                |
| forward: a2a keys         | 2.434 ms                  | 1.323 s                   |
| forward: search cache     | 323.282 us                | 19.709 ms                 |
| forward: a2a values       | 3.664 ms                  | 15.189 ms                 |
| forward: join             | 1.185 ms                  | 1.583 ms                  |
| Forward                   | 31.139 ms                 | 1.952 s                   |
| back: aggr dram keys      | 32.839 ms                 | 1.056 s                   |
| back: set dram grad       | 2.349 ms                  | 3.359 ms                  |
| back: a2a grad            | 11.472 ms                 | 21.791 ms                 |
| back: grad sum & grad cache  | 4.621 ms                  | 37.504 ms                 |
| Backward                  | 128.154 ms                | 1.269 s                   |
| Optimize                  | 11.223 ms                 | 16.835 ms                 |
| BarrierTimeBeforeRank0    | 77.172 us                 | 116.887 us                |
| BlockToStepN              | 26.416 us                 | 67.797 us                 |
| OneStep                   | 185.221 ms                | 3.241 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.927 ms                  | 43.968 ms                 |
| bucket keys               | 1.604 ms                  | 3.433 ms                  |
| forward: a2a keys         | 2.603 ms                  | 20.739 ms                 |
| forward: search cache     | 325.540 us                | 583.613 us                |
| forward: a2a values       | 9.533 ms                  | 25.544 ms                 |
| forward: join             | 1.151 ms                  | 1.641 ms                  |
| Forward                   | 30.241 ms                 | 1.952 s                   |
| back: aggr dram keys      | 38.100 ms                 | 60.104 ms                 |
| back: set dram grad       | 2.374 ms                  | 3.359 ms                  |
| back: a2a grad            | 12.560 ms                 | 21.791 ms                 |
| back: grad sum & grad cache  | 4.621 ms                  | 40.993 ms                 |
| Backward                  | 130.876 ms                | 1.269 s                   |
| Optimize                  | 11.186 ms                 | 18.334 ms                 |
| BarrierTimeBeforeRank0    | 60.701 us                 | 116.887 us                |
| BlockToStepN              | 30.438 us                 | 6.279 ms                  |
| OneStep                   | 187.777 ms                | 3.241 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.877 ms                  | 41.755 ms                 |
| bucket keys               | 1.455 ms                  | 3.433 ms                  |
| forward: a2a keys         | 2.584 ms                  | 23.008 ms                 |
| forward: search cache     | 306.071 us                | 587.971 us                |
| forward: a2a values       | 9.330 ms                  | 29.036 ms                 |
| forward: join             | 1.160 ms                  | 1.712 ms                  |
| Forward                   | 30.002 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 39.318 ms                 | 63.612 ms                 |
| back: set dram grad       | 2.360 ms                  | 3.946 ms                  |
| back: a2a grad            | 12.675 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 134.533 ms                | 182.444 ms                |
| Optimize                  | 10.852 ms                 | 17.925 ms                 |
| BarrierTimeBeforeRank0    | 57.655 us                 | 111.594 us                |
| BlockToStepN              | 31.061 us                 | 13.416 ms                 |
| OneStep                   | 187.777 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.918 ms                  | 43.968 ms                 |
| bucket keys               | 1.420 ms                  | 3.269 ms                  |
| forward: a2a keys         | 2.647 ms                  | 23.008 ms                 |
| forward: search cache     | 305.553 us                | 810.332 us                |
| forward: a2a values       | 8.784 ms                  | 27.981 ms                 |
| forward: join             | 1.154 ms                  | 1.829 ms                  |
| Forward                   | 30.241 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.100 ms                 | 60.155 ms                 |
| back: set dram grad       | 2.374 ms                  | 3.359 ms                  |
| back: a2a grad            | 12.642 ms                 | 31.186 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 130.434 ms                | 182.444 ms                |
| Optimize                  | 10.655 ms                 | 18.334 ms                 |
| BarrierTimeBeforeRank0    | 49.691 us                 | 111.594 us                |
| BlockToStepN              | 36.875 us                 | 18.352 ms                 |
| OneStep                   | 185.666 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 24.266, sample: 0.488, forward: 5.751, backward: 10.558, update: 0.183
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.053, sample: 0.617, forward: 5.616, backward: 10.980, update: 0.153
[Rank7] pid = 45929
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([342359, 292115, 293399, 292139, 292177, 292210, 342392, 292241, 292268,
        292307]) tensor([ 4657142, 11670270, 50474154, 57315582, 20097928,   359381, 18212172,
        53775276, 50214027, 46829142])
-------Step 1-------
tensor([342359, 292115, 293399, 292139, 292177, 292210, 342392, 292241, 292268,
        292307]) tensor([24166486, 31706380, 63170323,  5473288, 70556079,  7142041,  5751001,
        14048433, 66775698,  5576896])
-------Step 2-------
tensor([  117519,   326290, 21371286,   326327,   117552,   342996,   326364,
          326407,   326434, 52610757]) tensor([75391207, 84966942, 42931880,  7787007, 36384462, 75464113, 43358514,
        32260028, 23298556, 85120869])
-------Step 3-------
tensor([  117519,   326290, 21371286,   326327,   117552,   342996,   326364,
          326407,   326434, 52610757]) tensor([59255052, 40346630, 45210602, 23849535,   459888, 20213416, 60952736,
        33553230, 43755930, 50537851])
-------Step 4-------
tensor([   13379,   360758, 52852230,    24155,   360785,   360823,   360863,
          360892,   360922,   360960]) tensor([48262840, 31749092,  1383622, 28466209, 21412046, 24145324,  8812768,
        59379837, 60816626, 27874711])
-------Step 5-------
tensor([   13379,   360758, 52852230,    24155,   360785,   360823,   360863,
          360892,   360922,   360960]) tensor([75405018, 35709233, 65157916,  4836972, 53247079, 40077262,  4684925,
        59921822, 63865563, 50387183])
-------Step 6-------
tensor([  395237,   395265,   395302,   395334, 41857547,   395364,   395394,
          112993,   395424,   356188]) tensor([49765848, 73822937, 82127113,  1554670, 68204588, 66066355, 52558172,
        20124874, 71583647, 75912896])
-------Step 7-------
tensor([  395237,   395265,   395302,   395334, 41857547,   395364,   395394,
          112993,   395424,   356188]) tensor([43591275, 44622254, 40412261, 44977580, 83928973,   384402, 78442230,
        64236675, 85896401, 73287937])
-------Step 8-------
tensor([36006144,   429974,   430009,   430036,   430066,   430095,   430123,
          430150,   430182, 21609136]) tensor([64717039, 55114345, 73012399, 36151418,    64360,  4350979, 25721939,
        51660977, 68315821, 10521173])
-------Step 9-------
tensor([36006144,   429974,   430009,   430036,   430066,   430095,   430123,
          430150,   430182, 21609136]) tensor([73910413, 26840948,  8607801, 33328444, 54433345, 20155447, 83620074,
        61613804, 79796521, 33904294])
before start barrier
start train
[proc 0] 100 steps, total: 22.006, sample: 0.697, forward: 5.302, backward: 14.512, update: 1.055
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 21.849, sample: 0.478, forward: 5.744, backward: 10.567, update: 0.174
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.922, sample: 0.531, forward: 5.704, backward: 10.698, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 21.749, sample: 0.524, forward: 5.683, backward: 10.710, update: 0.144
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 23.176, sample: 0.498, forward: 5.772, backward: 10.520, update: 0.152
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 24.634, sample: 0.558, forward: 5.684, backward: 10.670, update: 0.185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.939 ms                  | 43.968 ms                 |
| bucket keys               | 1.503 ms                  | 3.269 ms                  |
| forward: a2a keys         | 2.618 ms                  | 23.008 ms                 |
| forward: search cache     | 314.990 us                | 810.332 us                |
| forward: a2a values       | 8.015 ms                  | 27.981 ms                 |
| forward: join             | 1.172 ms                  | 1.829 ms                  |
| Forward                   | 30.303 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.646 ms                 | 60.155 ms                 |
| back: set dram grad       | 2.350 ms                  | 3.359 ms                  |
| back: a2a grad            | 12.603 ms                 | 31.186 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 128.154 ms                | 182.444 ms                |
| Optimize                  | 10.788 ms                 | 18.334 ms                 |
| BarrierTimeBeforeRank0    | 47.637 us                 | 111.594 us                |
| BlockToStepN              | 28.618 us                 | 18.352 ms                 |
| OneStep                   | 179.109 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.918 ms                  | 43.968 ms                 |
| bucket keys               | 1.532 ms                  | 3.269 ms                  |
| forward: a2a keys         | 2.603 ms                  | 23.008 ms                 |
| forward: search cache     | 319.988 us                | 810.332 us                |
| forward: a2a values       | 7.866 ms                  | 27.104 ms                 |
| forward: join             | 1.174 ms                  | 1.829 ms                  |
| Forward                   | 30.246 ms                 | 77.368 ms                 |
| back: aggr dram keys      | 37.625 ms                 | 60.328 ms                 |
| back: set dram grad       | 2.345 ms                  | 3.230 ms                  |
| back: a2a grad            | 12.615 ms                 | 31.186 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 128.154 ms                | 182.444 ms                |
| Optimize                  | 11.023 ms                 | 18.890 ms                 |
| BarrierTimeBeforeRank0    | 47.357 us                 | 111.594 us                |
| BlockToStepN              | 28.210 us                 | 18.352 ms                 |
| OneStep                   | 180.558 ms                | 273.398 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.825 ms                  | 43.968 ms                 |
| bucket keys               | 1.540 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.647 ms                  | 23.643 ms                 |
| forward: search cache     | 322.158 us                | 810.332 us                |
| forward: a2a values       | 7.804 ms                  | 27.981 ms                 |
| forward: join             | 1.176 ms                  | 2.232 ms                  |
| Forward                   | 30.625 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.100 ms                 | 63.612 ms                 |
| back: set dram grad       | 2.341 ms                  | 3.230 ms                  |
| back: a2a grad            | 12.642 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 128.154 ms                | 177.157 ms                |
| Optimize                  | 11.147 ms                 | 18.890 ms                 |
| BarrierTimeBeforeRank0    | 46.538 us                 | 100.161 us                |
| BlockToStepN              | 28.191 us                 | 18.352 ms                 |
| OneStep                   | 183.056 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.892 ms                  | 44.527 ms                 |
| bucket keys               | 1.721 ms                  | 3.349 ms                  |
| forward: a2a keys         | 2.627 ms                  | 23.643 ms                 |
| forward: search cache     | 353.830 us                | 807.947 us                |
| forward: a2a values       | 7.804 ms                  | 27.104 ms                 |
| forward: join             | 1.185 ms                  | 1.849 ms                  |
| Forward                   | 31.384 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.719 ms                 | 63.612 ms                 |
| back: set dram grad       | 2.330 ms                  | 3.203 ms                  |
| back: a2a grad            | 12.642 ms                 | 33.450 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.126 ms                 |
| Backward                  | 127.648 ms                | 177.333 ms                |
| Optimize                  | 11.013 ms                 | 18.890 ms                 |
| BarrierTimeBeforeRank0    | 42.555 us                 | 100.161 us                |
| BlockToStepN              | 28.715 us                 | 18.352 ms                 |
| OneStep                   | 182.024 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 18.668, sample: 0.612, forward: 3.710, backward: 9.732, update: 0.212
[proc 1] 200 steps, total: 18.668, sample: 0.591, forward: 3.746, backward: 9.965, update: 0.185
[proc 3] 200 steps, total: 18.668, sample: 0.565, forward: 3.789, backward: 9.712, update: 0.197
[proc 5] 200 steps, total: 18.668, sample: 0.612, forward: 3.721, backward: 9.620, update: 0.202
[proc 0] 200 steps, total: 18.668, sample: 0.714, forward: 3.470, backward: 13.232, update: 1.107
[proc 4] 200 steps, total: 18.668, sample: 0.501, forward: 3.825, backward: 9.614, update: 0.201
[proc 6] 200 steps, total: 18.668, sample: 0.483, forward: 3.840, backward: 9.624, update: 0.213
[proc 2] 200 steps, total: 18.668, sample: 0.632, forward: 3.677, backward: 9.746, update: 0.170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.918 ms                  | 44.527 ms                 |
| bucket keys               | 1.713 ms                  | 3.349 ms                  |
| forward: a2a keys         | 2.647 ms                  | 23.271 ms                 |
| forward: search cache     | 340.842 us                | 587.971 us                |
| forward: a2a values       | 7.804 ms                  | 25.544 ms                 |
| forward: join             | 1.185 ms                  | 1.849 ms                  |
| Forward                   | 31.216 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.719 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.314 ms                  | 3.088 ms                  |
| back: a2a grad            | 12.511 ms                 | 31.186 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 44.558 ms                 |
| Backward                  | 127.378 ms                | 177.333 ms                |
| Optimize                  | 11.097 ms                 | 18.890 ms                 |
| BarrierTimeBeforeRank0    | 43.471 us                 | 100.161 us                |
| BlockToStepN              | 28.210 us                 | 18.352 ms                 |
| OneStep                   | 179.983 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.877 ms                  | 44.527 ms                 |
| bucket keys               | 1.713 ms                  | 3.349 ms                  |
| forward: a2a keys         | 2.647 ms                  | 24.287 ms                 |
| forward: search cache     | 340.842 us                | 807.947 us                |
| forward: a2a values       | 7.829 ms                  | 25.544 ms                 |
| forward: join             | 1.188 ms                  | 1.970 ms                  |
| Forward                   | 31.383 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.953 ms                 | 63.612 ms                 |
| back: set dram grad       | 2.301 ms                  | 3.088 ms                  |
| back: a2a grad            | 12.473 ms                 | 33.743 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.126 ms                 |
| Backward                  | 127.538 ms                | 177.157 ms                |
| Optimize                  | 11.129 ms                 | 18.846 ms                 |
| BarrierTimeBeforeRank0    | 44.138 us                 | 94.815 us                 |
| BlockToStepN              | 27.980 us                 | 15.034 ms                 |
| OneStep                   | 181.093 ms                | 246.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.657 ms                  | 44.527 ms                 |
| bucket keys               | 1.721 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.647 ms                  | 24.287 ms                 |
| forward: search cache     | 341.620 us                | 807.947 us                |
| forward: a2a values       | 7.829 ms                  | 26.550 ms                 |
| forward: join             | 1.189 ms                  | 1.970 ms                  |
| Forward                   | 31.383 ms                 | 74.091 ms                 |
| back: aggr dram keys      | 38.935 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.302 ms                  | 3.088 ms                  |
| back: a2a grad            | 12.509 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 49.182 ms                 |
| Backward                  | 128.267 ms                | 177.333 ms                |
| Optimize                  | 11.168 ms                 | 18.948 ms                 |
| BarrierTimeBeforeRank0    | 43.471 us                 | 94.815 us                 |
| BlockToStepN              | 28.108 us                 | 15.034 ms                 |
| OneStep                   | 181.528 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 18.879, sample: 0.534, forward: 3.825, backward: 10.008, update: 0.167
[proc 6] 300 steps, total: 18.879, sample: 0.406, forward: 3.896, backward: 9.737, update: 0.174
[proc 4] 300 steps, total: 18.879, sample: 0.431, forward: 3.882, backward: 9.700, update: 0.212
[proc 3] 300 steps, total: 18.879, sample: 0.446, forward: 3.872, backward: 9.818, update: 0.184
[proc 5] 300 steps, total: 18.879, sample: 0.475, forward: 3.858, backward: 9.694, update: 0.210
[proc 2] 300 steps, total: 18.879, sample: 0.534, forward: 3.779, backward: 9.822, update: 0.188
[proc 7] 300 steps, total: 18.879, sample: 0.510, forward: 3.806, backward: 9.807, update: 0.193
[proc 0] 300 steps, total: 18.879, sample: 0.700, forward: 3.460, backward: 13.355, update: 1.244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.879 ms                  | 44.527 ms                 |
| bucket keys               | 1.708 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.706 ms                  | 24.287 ms                 |
| forward: search cache     | 335.568 us                | 807.947 us                |
| forward: a2a values       | 7.829 ms                  | 26.550 ms                 |
| forward: join             | 1.186 ms                  | 1.970 ms                  |
| Forward                   | 31.490 ms                 | 74.091 ms                 |
| back: aggr dram keys      | 38.953 ms                 | 62.945 ms                 |
| back: set dram grad       | 2.310 ms                  | 3.230 ms                  |
| back: a2a grad            | 12.509 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 49.182 ms                 |
| Backward                  | 128.154 ms                | 177.333 ms                |
| Optimize                  | 11.209 ms                 | 18.948 ms                 |
| BarrierTimeBeforeRank0    | 43.555 us                 | 94.815 us                 |
| BlockToStepN              | 28.108 us                 | 15.034 ms                 |
| OneStep                   | 181.225 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.825 ms                  | 44.527 ms                 |
| bucket keys               | 1.697 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.666 ms                  | 24.275 ms                 |
| forward: search cache     | 334.449 us                | 594.398 us                |
| forward: a2a values       | 7.858 ms                  | 25.544 ms                 |
| forward: join             | 1.183 ms                  | 1.968 ms                  |
| Forward                   | 31.139 ms                 | 74.091 ms                 |
| back: aggr dram keys      | 38.935 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.310 ms                  | 3.230 ms                  |
| back: a2a grad            | 12.511 ms                 | 33.743 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 49.586 ms                 |
| Backward                  | 127.578 ms                | 177.333 ms                |
| Optimize                  | 11.235 ms                 | 19.027 ms                 |
| BarrierTimeBeforeRank0    | 43.570 us                 | 94.815 us                 |
| BlockToStepN              | 27.395 us                 | 15.034 ms                 |
| OneStep                   | 181.091 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.625 ms                  | 43.968 ms                 |
| bucket keys               | 1.688 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.663 ms                  | 24.287 ms                 |
| forward: search cache     | 332.734 us                | 724.039 us                |
| forward: a2a values       | 7.829 ms                  | 25.544 ms                 |
| forward: join             | 1.185 ms                  | 1.968 ms                  |
| Forward                   | 31.086 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.935 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.310 ms                  | 3.230 ms                  |
| back: a2a grad            | 12.521 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 127.525 ms                | 177.157 ms                |
| Optimize                  | 11.235 ms                 | 19.027 ms                 |
| BarrierTimeBeforeRank0    | 44.299 us                 | 86.843 us                 |
| BlockToStepN              | 26.517 us                 | 13.416 ms                 |
| OneStep                   | 180.100 ms                | 257.629 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.825 ms                  | 44.527 ms                 |
| bucket keys               | 1.763 ms                  | 3.269 ms                  |
| forward: a2a keys         | 2.643 ms                  | 24.387 ms                 |
| forward: search cache     | 353.830 us                | 594.398 us                |
| forward: a2a values       | 7.829 ms                  | 25.076 ms                 |
| forward: join             | 1.187 ms                  | 1.968 ms                  |
| Forward                   | 30.954 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.646 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.294 ms                  | 3.203 ms                  |
| back: a2a grad            | 12.422 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.126 ms                 |
| Backward                  | 127.538 ms                | 177.333 ms                |
| Optimize                  | 11.215 ms                 | 19.027 ms                 |
| BarrierTimeBeforeRank0    | 43.471 us                 | 86.843 us                 |
| BlockToStepN              | 26.962 us                 | 13.416 ms                 |
| OneStep                   | 179.983 ms                | 257.629 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 18.050, sample: 0.361, forward: 3.562, backward: 9.184, update: 0.186
[proc 5] 400 steps, total: 18.050, sample: 0.366, forward: 3.557, backward: 9.171, update: 0.154
[proc 7] 400 steps, total: 18.050, sample: 0.398, forward: 3.538, backward: 9.260, update: 0.189
[proc 4] 400 steps, total: 18.050, sample: 0.368, forward: 3.548, backward: 9.196, update: 0.195
[proc 2] 400 steps, total: 18.050, sample: 0.492, forward: 3.462, backward: 9.273, update: 0.161
[proc 3] 400 steps, total: 18.050, sample: 0.388, forward: 3.532, backward: 9.289, update: 0.192
[proc 0] 400 steps, total: 18.050, sample: 0.634, forward: 3.170, backward: 12.893, update: 1.236
[proc 1] 400 steps, total: 18.050, sample: 0.499, forward: 3.436, backward: 9.532, update: 0.184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.879 ms                  | 44.527 ms                 |
| bucket keys               | 1.784 ms                  | 3.307 ms                  |
| forward: a2a keys         | 2.634 ms                  | 24.387 ms                 |
| forward: search cache     | 360.266 us                | 764.127 us                |
| forward: a2a values       | 7.829 ms                  | 25.076 ms                 |
| forward: join             | 1.189 ms                  | 2.023 ms                  |
| Forward                   | 30.948 ms                 | 70.977 ms                 |
| back: aggr dram keys      | 38.646 ms                 | 62.564 ms                 |
| back: set dram grad       | 2.290 ms                  | 3.203 ms                  |
| back: a2a grad            | 12.302 ms                 | 33.940 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.126 ms                 |
| Backward                  | 127.525 ms                | 177.333 ms                |
| Optimize                  | 11.251 ms                 | 19.601 ms                 |
| BarrierTimeBeforeRank0    | 43.471 us                 | 88.136 us                 |
| BlockToStepN              | 27.074 us                 | 13.416 ms                 |
| OneStep                   | 180.558 ms                | 257.629 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.657 ms                  | 44.527 ms                 |
| bucket keys               | 1.836 ms                  | 3.360 ms                  |
| forward: a2a keys         | 2.649 ms                  | 24.387 ms                 |
| forward: search cache     | 369.493 us                | 759.324 us                |
| forward: a2a values       | 7.829 ms                  | 23.473 ms                 |
| forward: join             | 1.194 ms                  | 2.023 ms                  |
| Forward                   | 31.086 ms                 | 74.091 ms                 |
| back: aggr dram keys      | 38.576 ms                 | 62.468 ms                 |
| back: set dram grad       | 2.284 ms                  | 3.133 ms                  |
| back: a2a grad            | 12.287 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.126 ms                 |
| Backward                  | 127.387 ms                | 182.245 ms                |
| Optimize                  | 11.262 ms                 | 19.601 ms                 |
| BarrierTimeBeforeRank0    | 43.570 us                 | 88.136 us                 |
| BlockToStepN              | 27.411 us                 | 13.416 ms                 |
| OneStep                   | 181.070 ms                | 257.629 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.573 ms                  | 43.968 ms                 |
| bucket keys               | 1.932 ms                  | 3.360 ms                  |
| forward: a2a keys         | 2.642 ms                  | 24.387 ms                 |
| forward: search cache     | 381.551 us                | 764.127 us                |
| forward: a2a values       | 7.829 ms                  | 23.473 ms                 |
| forward: join             | 1.198 ms                  | 2.120 ms                  |
| Forward                   | 31.046 ms                 | 71.781 ms                 |
| back: aggr dram keys      | 38.466 ms                 | 62.468 ms                 |
| back: set dram grad       | 2.278 ms                  | 3.203 ms                  |
| back: a2a grad            | 12.251 ms                 | 33.940 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 127.098 ms                | 177.333 ms                |
| Optimize                  | 11.256 ms                 | 19.524 ms                 |
| BarrierTimeBeforeRank0    | 42.679 us                 | 86.843 us                 |
| BlockToStepN              | 27.847 us                 | 13.416 ms                 |
| OneStep                   | 179.650 ms                | 253.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.593 ms                  | 43.968 ms                 |
| bucket keys               | 1.928 ms                  | 3.349 ms                  |
| forward: a2a keys         | 2.643 ms                  | 24.387 ms                 |
| forward: search cache     | 373.944 us                | 764.127 us                |
| forward: a2a values       | 7.858 ms                  | 23.146 ms                 |
| forward: join             | 1.199 ms                  | 2.023 ms                  |
| Forward                   | 31.050 ms                 | 71.781 ms                 |
| back: aggr dram keys      | 38.256 ms                 | 62.058 ms                 |
| back: set dram grad       | 2.274 ms                  | 3.133 ms                  |
| back: a2a grad            | 12.238 ms                 | 33.914 ms                 |
| back: grad sum & grad cache  | 19.334 ms                 | 50.655 ms                 |
| Backward                  | 127.035 ms                | 177.333 ms                |
| Optimize                  | 11.259 ms                 | 19.524 ms                 |
| BarrierTimeBeforeRank0    | 43.169 us                 | 88.136 us                 |
| BlockToStepN              | 27.598 us                 | 13.416 ms                 |
| OneStep                   | 179.650 ms                | 253.717 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 18.146, sample: 0.442, forward: 3.691, backward: 9.287, update: 0.169
[proc 7] 500 steps, total: 18.146, sample: 0.431, forward: 3.720, backward: 9.271, update: 0.187
[proc 2] 500 steps, total: 18.146, sample: 0.489, forward: 3.639, backward: 9.316, update: 0.191
[proc 4] 500 steps, total: 18.146, sample: 0.401, forward: 3.734, backward: 9.173, update: 0.204
[proc 6] 500 steps, total: 18.146, sample: 0.401, forward: 3.749, backward: 9.199, update: 0.201
[proc 0] 500 steps, total: 18.146, sample: 0.644, forward: 3.402, backward: 12.786, update: 1.176
[proc 1] 500 steps, total: 18.146, sample: 0.503, forward: 3.661, backward: 9.505, update: 0.187
[proc 5] 500 steps, total: 18.146, sample: 0.427, forward: 3.720, backward: 9.167, update: 0.211
Successfully xmh. training takes 95.75059747695923 seconds
before call kg_cache_controller.StopThreads()
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
INFO [21136 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
