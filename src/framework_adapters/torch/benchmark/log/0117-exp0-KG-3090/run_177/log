WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 13:11:43.813189  7635 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_Freebase_12', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [7635 sampler.py:454] Start PreSampling
WARNING [7635 sampler.py:532] Before construct renumbering_dict
WARNING [7635 sampler.py:555] PreSampling done
W20240125 13:42:22.477169  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 13:42:22.477500  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 13:42:22.477555  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 13:42:22.477602  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 13:42:22.477649  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 13:42:22.477682  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 13:42:22.477713  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 13:42:22.477756  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 13:42:22.477792  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 13:42:22.477825  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 13:42:22.477872  7635 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 13:42:22.477905  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 13:42:22.477931  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 13:42:22.478147  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 13:42:22.478201  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 13:42:22.478229  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 13:42:22.478291  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 13:42:22.478320  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 13:42:22.478371  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 13:42:22.478403  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 13:42:22.478436  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 13:42:22.478471  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 13:42:22.478530  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 13:42:22.478562  7635 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 13:42:22.478591  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 13:42:22.478615  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 13:42:22.478709  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 13:42:22.478755  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 13:42:22.478801  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 13:42:22.478832  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 13:42:22.478859  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 13:42:22.478899  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 13:42:22.478935  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 13:42:22.478971  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 13:42:22.479010  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 13:42:22.479049  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 13:42:22.479082  7635 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 13:42:22.479107  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 13:42:22.479132  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 13:42:22.479208  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 13:42:22.479250  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 13:42:22.479280  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 13:42:22.479308  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 13:42:22.479346  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 13:42:22.479374  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 13:42:22.479413  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 13:42:22.479441  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 13:42:22.479482  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 13:42:22.479517  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 13:42:22.479550  7635 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 13:42:22.479574  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 13:42:22.479602  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 13:42:22.479687  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 13:42:22.479746  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 13:42:22.479789  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 13:42:22.479825  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 13:42:22.479859  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 13:42:22.479903  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 13:42:22.479943  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 13:42:22.479980  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 13:42:22.480021  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 13:42:22.480051  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 13:42:22.480079  7635 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 13:42:22.480104  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 13:42:22.480129  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 13:42:22.480208  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 13:42:22.480262  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 13:42:22.480298  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 13:42:22.480327  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 13:42:22.480355  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 13:42:22.480383  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 13:42:22.480420  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 13:42:22.480456  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 13:42:22.480492  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 13:42:22.480527  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 13:42:22.480556  7635 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 13:42:22.480580  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 13:42:22.480612  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 13:42:22.480690  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 13:42:22.480737  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 13:42:22.480772  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 13:42:22.480814  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 13:42:22.480866  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 13:42:22.480901  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 13:42:22.480944  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 13:42:22.480993  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 13:42:22.481025  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 13:42:22.481056  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 13:42:22.481098  7635 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 13:42:22.481141  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 13:42:22.481178  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 13:42:22.481256  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 13:42:22.481302  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 13:42:22.481343  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 13:42:22.481375  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 13:42:22.481417  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 13:42:22.481453  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 13:42:22.481483  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 13:42:22.481521  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 13:42:22.481551  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 13:42:22.481581  7635 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 13:42:22.481611  7635 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 13:42:22.481635  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 13:42:22.481658  7635 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 13:42:23.416683  7635 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 13:42:23.416972  7635 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302712,  4302733,  4302791,  ..., 69168995, 22940707, 38087189]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2551.158 seconds
[Rank1] pid = 43030
[Rank2] pid = 43147
[Rank3] pid = 43248
[Rank4] pid = 43350
[Rank5] pid = 43435
[Rank6] pid = 43531
INFO [7635 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [43030 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [43147 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [43248 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [43350 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [43435 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [7635 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43030 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43248 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43147 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43350 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43435 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43531 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [43629 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [43629 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43531 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [7635 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43147 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43030 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43435 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43248 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43350 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43531 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [43629 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 13:54:31.866933 43630 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867030 43032 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867115 43249 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867188 43436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867261 43532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867336 43636 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867411 43150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 13:54:31.867494 43351 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240125 13:54:44.587204 43636 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 13:54:45.337250 43436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:47.884428 43150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:48.063560 43532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:49.801771 43032 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:50.111269 43249 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:50.966287 43630 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 13:54:51.993351 43351 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.715 ms                 | 126.856 ms                |
| Forward                   | 17.344 ms                 | 855.323 ms                |
| Backward                  | 149.970 ms                | 372.535 ms                |
| Optimize                  | 4.038 ms                  | 49.598 ms                 |
| BarrierTimeBeforeRank0    | 22.910 ms                 | 215.958 ms                |
| BlockToStepN              | 46.355 us                 | 31.299 ms                 |
| OneStep                   | 208.805 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.835 ms                  | 126.856 ms                |
| Forward                   | 19.049 ms                 | 855.323 ms                |
| Backward                  | 149.663 ms                | 372.535 ms                |
| Optimize                  | 4.263 ms                  | 49.598 ms                 |
| BarrierTimeBeforeRank0    | 28.109 ms                 | 215.958 ms                |
| BlockToStepN              | 51.525 us                 | 33.654 ms                 |
| OneStep                   | 212.197 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.299 ms                  | 105.245 ms                |
| Forward                   | 18.492 ms                 | 24.002 ms                 |
| Backward                  | 149.970 ms                | 372.535 ms                |
| Optimize                  | 4.155 ms                  | 4.809 ms                  |
| BarrierTimeBeforeRank0    | 47.584 ms                 | 111.080 ms                |
| BlockToStepN              | 51.356 us                 | 31.299 ms                 |
| OneStep                   | 244.324 ms                | 558.177 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.299 ms                  | 105.245 ms                |
| Forward                   | 18.464 ms                 | 24.002 ms                 |
| Backward                  | 150.320 ms                | 372.535 ms                |
| Optimize                  | 4.068 ms                  | 4.809 ms                  |
| BarrierTimeBeforeRank0    | 50.926 ms                 | 315.825 ms                |
| BlockToStepN              | 51.356 us                 | 31.299 ms                 |
| OneStep                   | 249.843 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.480 ms                  | 105.245 ms                |
| Forward                   | 18.492 ms                 | 24.002 ms                 |
| Backward                  | 150.238 ms                | 372.535 ms                |
| Optimize                  | 4.038 ms                  | 4.809 ms                  |
| BarrierTimeBeforeRank0    | 58.087 ms                 | 315.825 ms                |
| BlockToStepN              | 47.871 us                 | 31.299 ms                 |
| OneStep                   | 256.626 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.897 ms                  | 105.245 ms                |
| Forward                   | 18.529 ms                 | 86.026 ms                 |
| Backward                  | 150.123 ms                | 372.535 ms                |
| Optimize                  | 4.045 ms                  | 4.809 ms                  |
| BarrierTimeBeforeRank0    | 50.544 ms                 | 352.431 ms                |
| BlockToStepN              | 46.239 us                 | 33.654 ms                 |
| OneStep                   | 245.508 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 34.198, sample: 1.176, forward: 3.567, backward: 16.614, update: 0.447
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 32.281, sample: 1.197, forward: 3.618, backward: 19.330, update: 0.456
[Rank7] pid = 43629
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([446308, 166574, 446326, 166607, 166642, 401693, 446348, 166690, 166731,
        166783]) tensor([ 5302358, 14618738, 39816505, 66631770, 17570590,   208127, 21922718,
        69064443, 61589492, 37869705])
-------Step 1-------
tensor([446308, 166574, 446326, 166607, 166642, 401693, 446348, 166690, 166731,
        166783]) tensor([83833296, 35149295, 38232719, 38342338, 62714356, 15198277, 35741192,
          605456, 30098867, 55826981])
-------Step 2-------
tensor([   27235,   297378,   290782, 18381438,   297395,   297414,   297442,
          297464,   407069,   297484]) tensor([62027478, 30512770, 84564090, 34905238, 18470711, 20923046,  7043586,
        69500623, 48144947, 24661063])
-------Step 3-------
tensor([   27235,   297378,   290782, 18381438,   297395,   297414,   297442,
          297464,   407069,   297484]) tensor([23556402, 76377019, 65244380, 37310500, 60315814, 82407364, 80719534,
          758063, 82002533,   482038])
-------Step 4-------
tensor([  374120,   374137,   374156,   374176,   374193,   374209, 73099339,
          374235,   374250, 29970678]) tensor([51433411, 42284665, 79985755, 27916080,   326420,  4328693, 28894423,
        63133350, 79004724,  9936299])
-------Step 5-------
tensor([  374120,   374137,   374156,   374176,   374193,   374209, 73099339,
          374235,   374250, 29970678]) tensor([33735986, 51228889, 33780576, 38385654, 70040516, 43656604, 37355307,
         1498265, 62566421, 38981653])
-------Step 6-------
tensor([ 7305619,  5764537,   444839,   444853,   444873,   444895, 81845234,
          292526,   444912,   444928]) tensor([51946102, 83688307, 60738235, 13391664, 17758650, 26869898, 14642554,
        76592573, 58809770, 65653399])
-------Step 7-------
tensor([ 7305619,  5764537,   444839,   444853,   444873,   444895, 81845234,
          292526,   444912,   444928]) tensor([29686769,  8041898, 45353844,  9661596, 60524674, 66878104,  4320891,
        17920846, 31381774, 79271516])
-------Step 8-------
tensor([  491150,   491159, 82960366,   491172,   491183,   491194, 10447880,
          491205,   491212,   273363]) tensor([18891982, 36894106, 75090459,  4938101, 81034383,  5976731,  5665001,
        12811017, 51733252,   264589])
-------Step 9-------
tensor([  491150,   491159, 82960366,   491172,   491183,   491194, 10447880,
          491205,   491212,   273363]) tensor([78162844, 19597269, 37847176, 77659331, 34948658, 75894925, 80833170,
        17420631, 19897553,  6147299])
before start barrier
start train
[proc 0] 100 steps, total: 31.116, sample: 1.305, forward: 2.762, backward: 15.923, update: 0.429
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 37.495, sample: 1.624, forward: 3.586, backward: 17.011, update: 0.448
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.089, sample: 1.492, forward: 3.760, backward: 16.047, update: 0.446
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 34.019, sample: 1.426, forward: 3.716, backward: 16.008, update: 0.508
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 36.746, sample: 1.774, forward: 3.606, backward: 15.686, update: 0.423
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 31.971, sample: 1.740, forward: 3.688, backward: 19.363, update: 0.427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.051 ms                  | 124.655 ms                |
| Forward                   | 18.466 ms                 | 86.026 ms                 |
| Backward                  | 149.890 ms                | 372.535 ms                |
| Optimize                  | 4.030 ms                  | 9.420 ms                  |
| BarrierTimeBeforeRank0    | 41.750 ms                 | 352.431 ms                |
| BlockToStepN              | 45.913 us                 | 33.654 ms                 |
| OneStep                   | 238.105 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.287 ms                  | 124.655 ms                |
| Forward                   | 18.268 ms                 | 86.026 ms                 |
| Backward                  | 149.970 ms                | 372.535 ms                |
| Optimize                  | 4.038 ms                  | 9.420 ms                  |
| BarrierTimeBeforeRank0    | 38.147 ms                 | 352.431 ms                |
| BlockToStepN              | 46.466 us                 | 33.654 ms                 |
| OneStep                   | 239.664 ms                | 1.380 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.156 ms                  | 105.245 ms                |
| Forward                   | 18.091 ms                 | 36.810 ms                 |
| Backward                  | 150.402 ms                | 372.535 ms                |
| Optimize                  | 4.027 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 39.726 ms                 | 315.825 ms                |
| BlockToStepN              | 48.019 us                 | 31.299 ms                 |
| OneStep                   | 236.825 ms                | 615.560 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.970 ms                  | 105.245 ms                |
| Forward                   | 17.627 ms                 | 36.810 ms                 |
| Backward                  | 151.675 ms                | 372.535 ms                |
| Optimize                  | 4.027 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 35.729 ms                 | 352.431 ms                |
| BlockToStepN              | 48.097 us                 | 31.299 ms                 |
| OneStep                   | 236.645 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.970 ms                  | 105.245 ms                |
| Forward                   | 17.344 ms                 | 36.810 ms                 |
| Backward                  | 152.470 ms                | 372.535 ms                |
| Optimize                  | 4.035 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 29.944 ms                 | 486.917 ms                |
| BlockToStepN              | 51.356 us                 | 33.915 ms                 |
| OneStep                   | 237.499 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 25.847, sample: 1.102, forward: 2.481, backward: 15.800, update: 0.364
[proc 3] 200 steps, total: 25.847, sample: 1.259, forward: 2.805, backward: 16.327, update: 0.414
[proc 7] 200 steps, total: 25.847, sample: 1.237, forward: 2.678, backward: 15.289, update: 0.413
[proc 5] 200 steps, total: 25.847, sample: 1.251, forward: 2.803, backward: 15.413, update: 0.370
[proc 4] 200 steps, total: 25.847, sample: 1.316, forward: 2.672, backward: 15.844, update: 0.410
[proc 1] 200 steps, total: 25.847, sample: 1.567, forward: 2.434, backward: 16.239, update: 0.379
[proc 6] 200 steps, total: 25.847, sample: 1.152, forward: 2.678, backward: 15.668, update: 0.417
[proc 0] 200 steps, total: 25.847, sample: 1.397, forward: 1.647, backward: 17.997, update: 0.384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.897 ms                  | 105.245 ms                |
| Forward                   | 17.029 ms                 | 36.810 ms                 |
| Backward                  | 151.381 ms                | 380.996 ms                |
| Optimize                  | 4.038 ms                  | 9.420 ms                  |
| BarrierTimeBeforeRank0    | 35.729 ms                 | 486.917 ms                |
| BlockToStepN              | 51.706 us                 | 33.915 ms                 |
| OneStep                   | 239.664 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.758 ms                  | 105.245 ms                |
| Forward                   | 16.924 ms                 | 48.449 ms                 |
| Backward                  | 152.390 ms                | 380.996 ms                |
| Optimize                  | 4.032 ms                  | 9.420 ms                  |
| BarrierTimeBeforeRank0    | 36.384 ms                 | 486.917 ms                |
| BlockToStepN              | 51.356 us                 | 37.984 ms                 |
| OneStep                   | 239.664 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.045 ms                  | 104.754 ms                |
| Forward                   | 16.899 ms                 | 36.810 ms                 |
| Backward                  | 152.756 ms                | 372.535 ms                |
| Optimize                  | 4.027 ms                  | 5.525 ms                  |
| BarrierTimeBeforeRank0    | 33.131 ms                 | 352.431 ms                |
| BlockToStepN              | 50.765 us                 | 37.984 ms                 |
| OneStep                   | 237.027 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.051 ms                  | 104.754 ms                |
| Forward                   | 16.823 ms                 | 36.810 ms                 |
| Backward                  | 152.313 ms                | 372.535 ms                |
| Optimize                  | 4.026 ms                  | 5.525 ms                  |
| BarrierTimeBeforeRank0    | 36.527 ms                 | 352.431 ms                |
| BlockToStepN              | 51.706 us                 | 39.085 ms                 |
| OneStep                   | 238.105 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.970 ms                  | 104.754 ms                |
| Forward                   | 16.727 ms                 | 36.810 ms                 |
| Backward                  | 152.047 ms                | 380.996 ms                |
| Optimize                  | 4.024 ms                  | 5.525 ms                  |
| BarrierTimeBeforeRank0    | 39.726 ms                 | 352.431 ms                |
| BlockToStepN              | 51.882 us                 | 39.085 ms                 |
| OneStep                   | 240.319 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 26.014, sample: 1.175, forward: 2.661, backward: 15.444, update: 0.431
[proc 1] 300 steps, total: 26.014, sample: 1.016, forward: 2.342, backward: 15.825, update: 0.376
[proc 0] 300 steps, total: 26.014, sample: 1.191, forward: 1.661, backward: 15.788, update: 0.429
[proc 4] 300 steps, total: 26.014, sample: 1.793, forward: 2.529, backward: 15.895, update: 0.413
[proc 5] 300 steps, total: 26.014, sample: 1.661, forward: 2.589, backward: 15.295, update: 0.388
[proc 7] 300 steps, total: 26.014, sample: 1.652, forward: 2.583, backward: 16.298, update: 0.465
[proc 3] 300 steps, total: 26.014, sample: 1.630, forward: 2.694, backward: 15.984, update: 0.403
[proc 2] 300 steps, total: 26.014, sample: 0.962, forward: 2.474, backward: 16.493, update: 0.377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.792 ms                  | 104.754 ms                |
| Forward                   | 16.582 ms                 | 36.810 ms                 |
| Backward                  | 151.810 ms                | 380.996 ms                |
| Optimize                  | 4.008 ms                  | 5.525 ms                  |
| BarrierTimeBeforeRank0    | 36.527 ms                 | 352.431 ms                |
| BlockToStepN              | 50.372 us                 | 39.085 ms                 |
| OneStep                   | 237.499 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.658 ms                  | 104.754 ms                |
| Forward                   | 16.603 ms                 | 46.307 ms                 |
| Backward                  | 151.675 ms                | 380.996 ms                |
| Optimize                  | 3.995 ms                  | 5.525 ms                  |
| BarrierTimeBeforeRank0    | 35.512 ms                 | 486.917 ms                |
| BlockToStepN              | 49.680 us                 | 39.085 ms                 |
| OneStep                   | 233.941 ms                | 1.002 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.496 ms                  | 102.395 ms                |
| Forward                   | 16.483 ms                 | 36.810 ms                 |
| Backward                  | 151.310 ms                | 372.535 ms                |
| Optimize                  | 3.989 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 38.075 ms                 | 486.917 ms                |
| BlockToStepN              | 49.188 us                 | 39.085 ms                 |
| OneStep                   | 237.685 ms                | 1.002 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.501 ms                  | 102.395 ms                |
| Forward                   | 16.557 ms                 | 36.810 ms                 |
| Backward                  | 151.048 ms                | 372.535 ms                |
| Optimize                  | 3.988 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 38.147 ms                 | 352.431 ms                |
| BlockToStepN              | 48.885 us                 | 39.085 ms                 |
| OneStep                   | 237.499 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.534 ms                  | 104.754 ms                |
| Forward                   | 16.455 ms                 | 36.810 ms                 |
| Backward                  | 150.966 ms                | 372.535 ms                |
| Optimize                  | 3.987 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 38.147 ms                 | 352.431 ms                |
| BlockToStepN              | 48.097 us                 | 39.085 ms                 |
| OneStep                   | 237.027 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 400 steps, total: 25.471, sample: 1.045, forward: 2.270, backward: 15.406, update: 0.420
[proc 1] 400 steps, total: 25.471, sample: 0.891, forward: 2.579, backward: 16.574, update: 0.384
[proc 5] 400 steps, total: 25.471, sample: 1.074, forward: 2.323, backward: 15.328, update: 0.428
[proc 6] 400 steps, total: 25.471, sample: 0.930, forward: 2.356, backward: 15.324, update: 0.382
[proc 4] 400 steps, total: 25.471, sample: 1.197, forward: 2.321, backward: 18.222, update: 0.392
[proc 3] 400 steps, total: 25.471, sample: 1.079, forward: 2.576, backward: 16.669, update: 0.376
[proc 0] 400 steps, total: 25.471, sample: 1.046, forward: 1.696, backward: 15.546, update: 0.371
[proc 2] 400 steps, total: 25.471, sample: 0.959, forward: 2.429, backward: 15.789, update: 0.367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.534 ms                  | 104.754 ms                |
| Forward                   | 16.416 ms                 | 46.307 ms                 |
| Backward                  | 150.774 ms                | 372.535 ms                |
| Optimize                  | 3.988 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 38.075 ms                 | 352.431 ms                |
| BlockToStepN              | 47.746 us                 | 39.085 ms                 |
| OneStep                   | 237.027 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.447 ms                  | 104.754 ms                |
| Forward                   | 16.375 ms                 | 46.307 ms                 |
| Backward                  | 150.689 ms                | 380.996 ms                |
| Optimize                  | 3.985 ms                  | 5.484 ms                  |
| BarrierTimeBeforeRank0    | 35.729 ms                 | 352.431 ms                |
| BlockToStepN              | 47.670 us                 | 39.085 ms                 |
| OneStep                   | 233.941 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.322 ms                  | 102.395 ms                |
| Forward                   | 16.378 ms                 | 36.810 ms                 |
| Backward                  | 150.611 ms                | 372.535 ms                |
| Optimize                  | 3.985 ms                  | 5.425 ms                  |
| BarrierTimeBeforeRank0    | 35.324 ms                 | 352.431 ms                |
| BlockToStepN              | 47.488 us                 | 38.605 ms                 |
| OneStep                   | 233.158 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.278 ms                  | 102.395 ms                |
| Forward                   | 16.375 ms                 | 36.810 ms                 |
| Backward                  | 150.641 ms                | 372.535 ms                |
| Optimize                  | 3.983 ms                  | 5.425 ms                  |
| BarrierTimeBeforeRank0    | 35.040 ms                 | 352.431 ms                |
| BlockToStepN              | 47.227 us                 | 38.605 ms                 |
| OneStep                   | 230.441 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.151 ms                  | 104.754 ms                |
| Forward                   | 16.378 ms                 | 36.810 ms                 |
| Backward                  | 150.602 ms                | 372.535 ms                |
| Optimize                  | 3.980 ms                  | 5.425 ms                  |
| BarrierTimeBeforeRank0    | 33.131 ms                 | 352.431 ms                |
| BlockToStepN              | 46.714 us                 | 39.085 ms                 |
| OneStep                   | 227.585 ms                | 697.205 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 22.859, sample: 0.974, forward: 2.521, backward: 15.828, update: 0.385
[proc 2] 500 steps, total: 22.858, sample: 0.878, forward: 2.569, backward: 15.385, update: 0.364
[proc 4] 500 steps, total: 22.858, sample: 0.958, forward: 2.383, backward: 15.600, update: 0.384
[proc 3] 500 steps, total: 22.859, sample: 1.083, forward: 2.543, backward: 15.945, update: 0.378
[proc 7] 500 steps, total: 22.859, sample: 0.901, forward: 2.539, backward: 15.151, update: 0.399
[proc 6] 500 steps, total: 22.859, sample: 0.977, forward: 2.478, backward: 15.714, update: 0.380
[proc 5] 500 steps, total: 22.859, sample: 0.946, forward: 2.522, backward: 15.298, update: 0.370
[proc 0] 500 steps, total: 22.859, sample: 0.960, forward: 1.685, backward: 15.939, update: 0.370
Successfully xmh. training takes 131.30777144432068 seconds
before call kg_cache_controller.StopThreads()
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
INFO [7635 controller_process.py:380] call rank0 to StopThreads
