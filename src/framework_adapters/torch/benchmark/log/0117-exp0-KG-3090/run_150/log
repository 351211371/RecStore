WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 22:03:15.244767  3048 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_Freebase_5', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [3048 sampler.py:454] Start PreSampling
WARNING [3048 sampler.py:532] Before construct renumbering_dict
WARNING [3048 sampler.py:555] PreSampling done
W20240124 22:16:13.379426  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 22:16:13.379643  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 22:16:13.379678  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 22:16:13.379706  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 22:16:13.379729  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 22:16:13.379753  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 22:16:13.379776  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 22:16:13.379822  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 22:16:13.379848  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 22:16:13.379870  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 22:16:13.379910  3048 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 22:16:13.379932  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 22:16:13.379966  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 22:16:13.380117  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 22:16:13.380141  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 22:16:13.380159  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 22:16:13.380203  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 22:16:13.380227  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 22:16:13.380259  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 22:16:13.380280  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 22:16:13.380302  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 22:16:13.380318  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 22:16:13.380367  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 22:16:13.380390  3048 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 22:16:13.380406  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 22:16:13.380426  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 22:16:13.380467  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 22:16:13.380499  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 22:16:13.380520  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 22:16:13.380544  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 22:16:13.380563  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 22:16:13.380584  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 22:16:13.380601  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 22:16:13.380633  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 22:16:13.380654  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 22:16:13.380681  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 22:16:13.380702  3048 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 22:16:13.380717  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 22:16:13.380735  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 22:16:13.380774  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 22:16:13.380817  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 22:16:13.380841  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 22:16:13.380860  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 22:16:13.380890  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 22:16:13.380913  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 22:16:13.380930  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 22:16:13.380954  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 22:16:13.380980  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 22:16:13.380996  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 22:16:13.381017  3048 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 22:16:13.381031  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 22:16:13.381052  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 22:16:13.381086  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 22:16:13.381115  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 22:16:13.381134  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 22:16:13.381150  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 22:16:13.381167  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 22:16:13.381187  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 22:16:13.381214  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 22:16:13.381237  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 22:16:13.381259  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 22:16:13.381280  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 22:16:13.381297  3048 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 22:16:13.381311  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 22:16:13.381325  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 22:16:13.381364  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 22:16:13.381389  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 22:16:13.381407  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 22:16:13.381443  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 22:16:13.381479  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 22:16:13.381505  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 22:16:13.381538  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 22:16:13.381561  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 22:16:13.381583  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 22:16:13.381600  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 22:16:13.381623  3048 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 22:16:13.381637  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 22:16:13.381652  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 22:16:13.381700  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 22:16:13.381721  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 22:16:13.381739  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 22:16:13.381758  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 22:16:13.381780  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 22:16:13.381799  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 22:16:13.381820  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 22:16:13.381842  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 22:16:13.381865  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 22:16:13.381883  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 22:16:13.381901  3048 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 22:16:13.381922  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 22:16:13.381937  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 22:16:13.381978  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 22:16:13.382002  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 22:16:13.382021  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 22:16:13.382042  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 22:16:13.382061  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 22:16:13.382081  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 22:16:13.382098  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 22:16:13.382117  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 22:16:13.382145  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 22:16:13.382171  3048 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 22:16:13.382191  3048 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 22:16:13.382206  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 22:16:13.382222  3048 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 22:16:13.773970  3048 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 22:16:13.774152  3048 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302751,  4302780,    54375,  ..., 53290626, 19627306, 31745164]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 978.819 seconds
[Rank1] pid = 25002
[Rank2] pid = 25105
[Rank3] pid = 25175
[Rank4] pid = 25254
[Rank5] pid = 25339
[Rank6] pid = 25422
INFO [3048 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [25002 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [25105 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [25175 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [25254 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [25339 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [25339 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25175 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25422 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [25500 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [25105 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25500 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25422 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25254 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25002 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3048 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 22:19:41.722800 25340 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 22:19:41.723934 25504 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 22:19:41.724498 25176 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 22:19:41.724525 25569 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240124 22:19:41.724570 25424 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240124 22:19:41.724654 25003 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 22:19:41.724670 25106 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 22:19:41.724676 25255 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 22:19:41.864825 25424 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x10202724d000 781.2 kB
W20240124 22:19:41.865109 25569 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027316000 781.2 kB
W20240124 22:19:41.865151 25255 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x1020273db000 781.2 kB
W20240124 22:19:41.865247 25106 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020274a0000 781.2 kB
W20240124 22:19:41.865303 25176 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x10202762a000 781.2 kB
W20240124 22:19:41.865299 25504 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x102027565000 781.2 kB
W20240124 22:19:41.865365 25003 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020276ef000 781.2 kB
W20240124 22:19:41.865391 25340 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020277b4000 781.2 kB
W20240124 22:19:41.865525 25106 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x102027879000 781.2 kB
W20240124 22:19:41.865590 25424 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10202793e000 781.2 kB
W20240124 22:19:41.865634 25504 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102027a03000 781.2 kB
W20240124 22:19:41.865659 25003 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102027ac8000 781.2 kB
W20240124 22:19:41.865689 25106 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102027b8d000 152.6 MB
W20240124 22:19:41.865708 25176 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x102031425000 781.2 kB
W20240124 22:19:41.865768 25504 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x1020314ea000 152.6 MB
W20240124 22:19:41.865784 25569 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x10203ad82000 781.2 kB
W20240124 22:19:41.865819 25003 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10203ae47000 152.6 MB
W20240124 22:19:41.865845 25106 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020446df000 152.6 MB
W20240124 22:19:41.865875 25424 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10204df77000 152.6 MB
W20240124 22:19:41.865897 25176 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10205780f000 152.6 MB
W20240124 22:19:41.865942 25504 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1020610a7000 152.6 MB
W20240124 22:19:41.865980 25569 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10206a93f000 152.6 MB
W20240124 22:19:41.865998 25176 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10207429c000 152.6 MB
W20240124 22:19:41.865993 25340 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x1020741d7000 781.2 kB
W20240124 22:19:41.866029 25106 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 22:19:41.866044 25255 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10207db34000 781.2 kB
W20240124 22:19:41.866065 25424 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10207dbf9000 152.6 MB
W20240124 22:19:41.866062 25504 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 22:19:41.866078 25003 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x102087491000 152.6 MB
W20240124 22:19:41.866088 25176 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 22:19:41.866137 25569 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x102090d29000 152.6 MB
W20240124 22:19:41.866174 25340 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10209a5c1000 152.6 MB
W20240124 22:19:41.866214 25255 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x1020a3e59000 152.6 MB
W20240124 22:19:41.866286 25569 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 22:19:41.866294 25340 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 22:19:41.866343 25255 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 22:19:41.866456 25255 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 22:19:41.866482 25340 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 22:19:41.866524 25424 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 22:19:41.866526 25003 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 22:19:41.873872 25106 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 22:19:41.873960 25504 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 22:19:41.874056 25176 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 22:19:41.874428 25569 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 22:19:41.874457 25340 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 22:19:41.874469 25255 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 22:19:41.874553 25424 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 22:19:41.874631 25003 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
[Rank7] pid = 25500
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [25500 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [3048 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [25002 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [25339 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [25422 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [25105 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [25175 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [25254 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 22:20:30.702998 25255 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703122 25504 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703171 25569 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703313 25003 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703449 25340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703486 25106 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703522 25176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 22:20:30.703557 25424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 22:20:30.705142 25504 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 22:20:30.705248 25504 grad_base.h:172] Init GradProcessingBase done
I20240124 22:20:40.412232 25504 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 22:20:40.412451 25504 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 22:20:40.412459 25504 kg_controller.h:84] Construct KGCacheController done
I20240124 22:20:41.177006 25504 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 22:21:00.049657 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 22:21:00.049981 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:01.363338 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 22:21:01.363626 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:02.769599 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 22:21:02.769708 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:04.101491 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:21:04.107929 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 22:21:04.142935 25569 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 22:21:04.758080 25424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 22:21:06.212658 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:21:06.219643 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 22:21:06.233691 25176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 22:21:06.295940 25106 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 22:21:07.081601 25340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 22:21:08.091220 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:21:08.098085 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 22:21:08.111665 25003 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 22:21:09.809008 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:21:09.817270 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 22:21:09.841943 25504 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 22:21:10.532303 25255 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.913 ms                  | 4.913 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240124 22:21:10.817019 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240124 22:21:10.831185 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 22:21:12.515035 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:12.543983 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 22:21:12.586534 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:21:13.515015 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=13264
W20240124 22:21:13.658401 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240124 22:21:13.685330 26736 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
E20240124 22:21:14.518721 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:14.678990 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240124 22:21:14.688097 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 22:21:15.518013 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=2530
W20240124 22:21:15.695986 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.792 ms                  | 49.241 ms                 |
| Forward                   | 3.607 ms                  | 604.584 ms                |
| Backward                  | 3.093 ms                  | 145.430 ms                |
| Optimize                  | 1.373 ms                  | 34.128 ms                 |
| BarrierTimeBeforeRank0    | 4.744 ms                  | 115.817 ms                |
| AfterBackward             | 41.476 ms                 | 1.105 s                   |
| BlockToStepN              | 1.432 ms                  | 39.982 ms                 |
| OneStep                   | 86.425 ms                 | 2.052 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:15.811297 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.747 ms                  | 352.957 ms                |
| ProcessBack:UpdateCache   | 9.569 ms                  | 716.730 ms                |
| ProcessBack:UpsertPq      | 12.884 ms                 | 39.131 ms                 |
| ProcessOneStep            | 40.531 ms                 | 1.105 s                   |
| BlockToStepN              | 21.697 ms                 | 63.045 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 22:21:16.518023 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:16.967290 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
W20240124 22:21:17.276129 25504 grad_async_v2.h:236] pq is empty
W20240124 22:21:17.380398 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=37, pq.top=37
E20240124 22:21:17.518018 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240124 22:21:18.053011 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
E20240124 22:21:18.518013 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240124 22:21:18.574211 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240124 22:21:19.249891 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
E20240124 22:21:19.518069 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
W20240124 22:21:19.681550 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240124 22:21:20.334764 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 22:21:20.518039 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.247 ms                  | 52.854 ms                 |
| Forward                   | 3.659 ms                  | 30.801 ms                 |
| Backward                  | 3.240 ms                  | 6.815 ms                  |
| Optimize                  | 1.417 ms                  | 2.637 ms                  |
| BarrierTimeBeforeRank0    | 68.039 us                 | 92.554 ms                 |
| AfterBackward             | 43.363 ms                 | 1.105 s                   |
| BlockToStepN              | 1.432 ms                  | 42.582 ms                 |
| OneStep                   | 90.152 ms                 | 1.168 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:20.844645 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.046 ms                  | 352.957 ms                |
| ProcessBack:UpdateCache   | 9.784 ms                  | 716.730 ms                |
| ProcessBack:UpsertPq      | 16.940 ms                 | 48.339 ms                 |
| ProcessOneStep            | 44.078 ms                 | 1.105 s                   |
| BlockToStepN              | 4.683 ms                  | 42.314 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:21.490399 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
E20240124 22:21:21.518009 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
W20240124 22:21:21.860348 25504 grad_async_v2.h:236] pq is empty
W20240124 22:21:21.966763 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240124 22:21:22.518028 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=659
W20240124 22:21:22.546506 26736 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
W20240124 22:21:23.024911 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=77, pq.top=77
E20240124 22:21:23.518026 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240124 22:21:23.598627 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
W20240124 22:21:24.057741 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=81, pq.top=81
E20240124 22:21:24.526048 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:24.643893 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end7
W20240124 22:21:25.088224 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=91
E20240124 22:21:25.527936 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 22:21:25.686749 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.951 ms                  | 56.338 ms                 |
| Forward                   | 3.679 ms                  | 30.801 ms                 |
| Backward                  | 3.315 ms                  | 6.815 ms                  |
| Optimize                  | 1.447 ms                  | 2.637 ms                  |
| BarrierTimeBeforeRank0    | 58.429 us                 | 92.554 ms                 |
| AfterBackward             | 48.910 ms                 | 1.105 s                   |
| BlockToStepN              | 1.742 ms                  | 60.992 ms                 |
| OneStep                   | 92.657 ms                 | 1.168 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.163 ms                  | 48.255 ms                 |
| ProcessBack:UpdateCache   | 9.872 ms                  | 17.194 ms                 |
| ProcessBack:UpsertPq      | 18.343 ms                 | 67.760 ms                 |
| ProcessOneStep            | 48.870 ms                 | 1.105 s                   |
| BlockToStepN              | 1.647 ms                  | 60.874 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:26.261067 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
E20240124 22:21:26.527019 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=3636
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 21.969, sample: 0.673, forward: 0.873, backward: 0.547, update: 0.172
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.494, sample: 0.735, forward: 0.961, backward: 0.502, update: 0.221
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.616, sample: 0.614, forward: 0.924, backward: 0.571, update: 0.167
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.431, sample: 0.636, forward: 0.898, backward: 0.538, update: 0.186
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 16.195, sample: 0.681, forward: 0.887, backward: 0.506, update: 0.183
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 22.585, sample: 0.674, forward: 0.906, backward: 0.494, update: 0.169
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.646, sample: 1.217, forward: 1.079, backward: 0.454, update: 0.189
train_sampler.Prefill()
-------Step 0-------
tensor([271490, 304161, 251941, 304195, 304224, 304249, 271501, 304274, 304302,
        304334]) tensor([ 4705623, 12054266, 51808697, 53100844, 19058956,   371631, 17029184,
        54798306, 52755101, 45877616])
-------Step 1-------
tensor([271490, 304161, 251941, 304195, 304224, 304249, 271501, 304274, 304302,
        304334]) tensor([21156082, 29967158, 61407541,  5403255, 77407522,  7354617,  5452448,
        13389384, 67557316,  6675820])
-------Step 2-------
tensor([  124734,   338344, 22014587,   338371,   124764,   271696,   338408,
          338431,   338459, 50262488]) tensor([82768125, 82791037, 42988994, 10536749, 37289744, 71289756, 44624249,
        35913634, 23326022, 83851911])
-------Step 3-------
tensor([  124734,   338344, 22014587,   338371,   124764,   271696,   338408,
          338431,   338459, 50262488]) tensor([58287317, 39074928, 47256581, 19231336,   464584, 21301329, 58263637,
        35961913, 40660038, 53131088])
-------Step 4-------
tensor([   12110,   373589, 50497739,    22165,   373614,   373651,   373682,
          373712,   373748,   373777]) tensor([48605862, 31808568,  1397999, 30203393, 23406879, 24048890,  8150285,
        62714669, 62534717, 30618469])
-------Step 5-------
tensor([   12110,   373589, 50497739,    22165,   373614,   373651,   373682,
          373712,   373748,   373777]) tensor([81006564, 36237983, 68231499,  6130759, 57452679, 43211278,  5479920,
        65042685, 70320035, 51020606])
-------Step 6-------
tensor([  408533,   408561,   408590,   408617, 43423945,   408647,   408678,
          103881,   408710,   276519]) tensor([49921089, 70677714, 77636269,  1555157, 62464960, 64073031, 53318623,
        22991140, 74839821, 83238109])
-------Step 7-------
tensor([  408533,   408561,   408590,   408617, 43423945,   408647,   408678,
          103881,   408710,   276519]) tensor([45210147, 45886178, 43588770, 45404458, 78113776,   400349, 71559481,
        61838472, 85288766, 73738307])
-------Step 8-------
tensor([34257614,   441727,   441762,   441788,   441818,   441847,   441883,
          441909,   441936, 22279114]) tensor([66640805, 56088052, 78252716, 37707344,    75743,  4350443, 24768748,
        49491956, 66435005, 10122443])
-------Step 9-------
tensor([34257614,   441727,   441762,   441788,   441818,   441847,   441883,
          441909,   441936, 22279114]) tensor([70607916, 28848914,  8216628, 34247380, 57213967, 22608203, 84442027,
        60860792, 75735444, 34823448])
before start barrier
start train
[proc 0] 100 steps, total: 16.885, sample: 1.185, forward: 1.054, backward: 0.477, update: 0.181
W20240124 22:21:26.728520 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
W20240124 22:21:27.412151 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
E20240124 22:21:27.527010 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=136
W20240124 22:21:27.766086 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240124 22:21:28.424078 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=110, pq.top=110
E20240124 22:21:28.527011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=14547
W20240124 22:21:28.794029 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 22:21:29.527024 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240124 22:21:29.905175 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240124 22:21:30.507568 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=126, pq.top=126
E20240124 22:21:30.527038 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.456 ms                  | 56.338 ms                 |
| Forward                   | 3.707 ms                  | 30.801 ms                 |
| Backward                  | 3.337 ms                  | 9.330 ms                  |
| Optimize                  | 1.415 ms                  | 5.037 ms                  |
| BarrierTimeBeforeRank0    | 47.353 us                 | 92.554 ms                 |
| AfterBackward             | 48.877 ms                 | 1.105 s                   |
| BlockToStepN              | 3.043 ms                  | 60.992 ms                 |
| OneStep                   | 94.305 ms                 | 1.168 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:30.738847 25504 grad_async_v2.h:236] pq is empty
W20240124 22:21:30.954804 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.065 ms                  | 41.394 ms                 |
| ProcessBack:UpdateCache   | 9.740 ms                  | 56.931 ms                 |
| ProcessBack:UpsertPq      | 22.522 ms                 | 67.760 ms                 |
| ProcessOneStep            | 48.870 ms                 | 1.105 s                   |
| BlockToStepN              | 1.506 ms                  | 60.874 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 22:21:31.530515 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:32.063553 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
W20240124 22:21:32.410068 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=137
E20240124 22:21:32.530009 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=223
W20240124 22:21:33.149652 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
E20240124 22:21:33.536077 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:33.935045 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240124 22:21:34.157940 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240124 22:21:34.536033 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:35.243512 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
W20240124 22:21:35.475762 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240124 22:21:35.536012 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.634 ms                  | 54.662 ms                 |
| Forward                   | 3.682 ms                  | 30.334 ms                 |
| Backward                  | 3.337 ms                  | 6.815 ms                  |
| Optimize                  | 1.399 ms                  | 3.368 ms                  |
| BarrierTimeBeforeRank0    | 45.116 us                 | 78.539 ms                 |
| AfterBackward             | 44.202 ms                 | 997.498 ms                |
| BlockToStepN              | 3.043 ms                  | 58.928 ms                 |
| OneStep                   | 89.823 ms                 | 1.015 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.046 ms                  | 41.394 ms                 |
| ProcessBack:UpdateCache   | 9.702 ms                  | 56.931 ms                 |
| ProcessBack:UpsertPq      | 17.883 ms                 | 67.760 ms                 |
| ProcessOneStep            | 43.994 ms                 | 997.438 ms                |
| BlockToStepN              | 2.956 ms                  | 58.812 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:36.259651 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
W20240124 22:21:36.496978 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240124 22:21:36.536017 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=200
W20240124 22:21:37.264626 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
E20240124 22:21:37.538560 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:37.849064 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240124 22:21:38.274091 26736 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 22:21:38.538012 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=119
W20240124 22:21:38.881382 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 4] 200 steps, total: 12.155, sample: 0.578, forward: 0.365, backward: 0.320, update: 0.135
[proc 2] 200 steps, total: 12.155, sample: 0.609, forward: 0.368, backward: 0.355, update: 0.138
[proc 5] 200 steps, total: 12.155, sample: 0.608, forward: 0.422, backward: 0.375, update: 0.154
[proc 6] 200 steps, total: 12.155, sample: 0.615, forward: 0.383, backward: 0.312, update: 0.139
[proc 1] 200 steps, total: 12.155, sample: 0.611, forward: 0.359, backward: 0.382, update: 0.134
[proc 3] 200 steps, total: 12.155, sample: 0.529, forward: 0.363, backward: 0.365, update: 0.134
[proc 7] 200 steps, total: 12.155, sample: 0.564, forward: 0.372, backward: 0.404, update: 0.140
[proc 0] 200 steps, total: 12.154, sample: 0.932, forward: 0.368, backward: 0.353, update: 0.147
W20240124 22:21:39.305744 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 22:21:39.538009 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=2234
W20240124 22:21:39.887090 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240124 22:21:40.358952 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240124 22:21:40.538067 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=20691
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.010 ms                  | 54.662 ms                 |
| Forward                   | 3.680 ms                  | 30.334 ms                 |
| Backward                  | 3.347 ms                  | 6.815 ms                  |
| Optimize                  | 1.383 ms                  | 5.037 ms                  |
| BarrierTimeBeforeRank0    | 41.352 us                 | 78.539 ms                 |
| AfterBackward             | 43.082 ms                 | 997.498 ms                |
| BlockToStepN              | 5.846 ms                  | 62.739 ms                 |
| OneStep                   | 89.228 ms                 | 1.015 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:40.979892 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.010 ms                  | 31.222 ms                 |
| ProcessBack:UpdateCache   | 9.710 ms                  | 17.194 ms                 |
| ProcessBack:UpsertPq      | 16.105 ms                 | 64.655 ms                 |
| ProcessOneStep            | 42.654 ms                 | 997.438 ms                |
| BlockToStepN              | 5.437 ms                  | 62.645 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:41.384258 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240124 22:21:41.538188 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=1583
W20240124 22:21:42.042845 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240124 22:21:42.394403 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 22:21:42.549460 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:21:43.065318 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240124 22:21:43.463973 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240124 22:21:43.549015 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=17067
W20240124 22:21:44.108013 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240124 22:21:44.477860 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end7
E20240124 22:21:44.549010 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=11256
W20240124 22:21:45.173316 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240124 22:21:45.495810 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240124 22:21:45.549011 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=15070
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.901 ms                  | 52.854 ms                 |
| Forward                   | 3.680 ms                  | 15.662 ms                 |
| Backward                  | 3.361 ms                  | 7.300 ms                  |
| Optimize                  | 1.385 ms                  | 3.368 ms                  |
| BarrierTimeBeforeRank0    | 41.352 us                 | 77.577 ms                 |
| AfterBackward             | 42.127 ms                 | 993.131 ms                |
| BlockToStepN              | 10.387 ms                 | 92.045 ms                 |
| OneStep                   | 90.192 ms                 | 1.012 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.952 ms                  | 34.690 ms                 |
| ProcessBack:UpdateCache   | 9.657 ms                  | 16.069 ms                 |
| ProcessBack:UpsertPq      | 15.620 ms                 | 65.000 ms                 |
| ProcessOneStep            | 42.152 ms                 | 993.072 ms                |
| BlockToStepN              | 11.191 ms                 | 91.934 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:46.287678 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240124 22:21:46.537914 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 22:21:46.549011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=21540
W20240124 22:21:47.335196 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
E20240124 22:21:47.549016 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=2011
W20240124 22:21:47.597502 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
W20240124 22:21:48.335388 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
E20240124 22:21:48.549011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=64302
W20240124 22:21:48.609087 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 22:21:49.335253 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
E20240124 22:21:49.555063 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=4783
W20240124 22:21:49.621673 26736 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
[proc 3] 300 steps, total: 11.149, sample: 0.605, forward: 0.357, backward: 0.345, update: 0.132
[proc 7] 300 steps, total: 11.149, sample: 0.535, forward: 0.396, backward: 0.328, update: 0.136
[proc 5] 300 steps, total: 11.149, sample: 0.810, forward: 0.375, backward: 0.336, update: 0.132
[proc 6] 300 steps, total: 11.149, sample: 0.571, forward: 0.356, backward: 0.341, update: 0.140
[proc 2] 300 steps, total: 11.149, sample: 0.544, forward: 0.351, backward: 0.401, update: 0.138
[proc 1] 300 steps, total: 11.149, sample: 0.476, forward: 0.357, backward: 0.355, update: 0.155
[proc 4] 300 steps, total: 11.149, sample: 0.548, forward: 0.354, backward: 0.361, update: 0.136
[proc 0] 300 steps, total: 11.149, sample: 0.886, forward: 0.370, backward: 0.340, update: 0.149
W20240124 22:21:50.376726 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240124 22:21:50.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=3748
W20240124 22:21:50.655661 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.971 ms                  | 54.662 ms                 |
| Forward                   | 3.699 ms                  | 15.662 ms                 |
| Backward                  | 3.350 ms                  | 7.300 ms                  |
| Optimize                  | 1.383 ms                  | 3.368 ms                  |
| BarrierTimeBeforeRank0    | 40.226 us                 | 77.577 ms                 |
| AfterBackward             | 42.272 ms                 | 993.131 ms                |
| BlockToStepN              | 11.619 ms                 | 94.993 ms                 |
| OneStep                   | 90.883 ms                 | 1.012 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.002 ms                  | 33.837 ms                 |
| ProcessBack:UpdateCache   | 9.675 ms                  | 15.834 ms                 |
| ProcessBack:UpsertPq      | 16.029 ms                 | 65.000 ms                 |
| ProcessOneStep            | 42.183 ms                 | 993.072 ms                |
| BlockToStepN              | 11.546 ms                 | 94.901 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:51.379431 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
E20240124 22:21:51.555008 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=36614
W20240124 22:21:51.677724 26736 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
E20240124 22:21:52.555022 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=4906
W20240124 22:21:52.686997 26736 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 22:21:52.752606 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240124 22:21:53.555014 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=10901
W20240124 22:21:53.728432 26736 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 22:21:53.773545 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=332
E20240124 22:21:54.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=2381
W20240124 22:21:54.733893 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
W20240124 22:21:55.152377 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240124 22:21:55.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=9169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.121 ms                  | 54.662 ms                 |
| Forward                   | 3.699 ms                  | 15.662 ms                 |
| Backward                  | 3.348 ms                  | 8.286 ms                  |
| Optimize                  | 1.367 ms                  | 3.368 ms                  |
| BarrierTimeBeforeRank0    | 39.683 us                 | 77.577 ms                 |
| AfterBackward             | 42.216 ms                 | 993.131 ms                |
| BlockToStepN              | 15.876 ms                 | 97.017 ms                 |
| OneStep                   | 93.265 ms                 | 1.012 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 22:21:55.758247 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 22:21:56.152848 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.006 ms                  | 31.222 ms                 |
| ProcessBack:UpdateCache   | 9.755 ms                  | 15.782 ms                 |
| ProcessBack:UpsertPq      | 15.572 ms                 | 64.655 ms                 |
| ProcessOneStep            | 42.152 ms                 | 993.072 ms                |
| BlockToStepN              | 15.755 ms                 | 98.507 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 22:21:56.555012 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=85785
W20240124 22:21:56.916429 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240124 22:21:57.555027 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=393
W20240124 22:21:57.635257 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=356, pq.top=355
W20240124 22:21:57.920321 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 22:21:58.555012 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=1929
W20240124 22:21:58.754034 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240124 22:21:58.941888 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240124 22:21:59.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1180
W20240124 22:21:59.986204 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
W20240124 22:22:00.364746 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240124 22:22:00.555012 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=13283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.419 ms                  | 52.854 ms                 |
| Forward                   | 3.715 ms                  | 11.953 ms                 |
| Backward                  | 3.354 ms                  | 8.286 ms                  |
| Optimize                  | 1.365 ms                  | 3.368 ms                  |
| BarrierTimeBeforeRank0    | 37.230 us                 | 67.362 ms                 |
| AfterBackward             | 42.095 ms                 | 931.699 ms                |
| BlockToStepN              | 16.928 ms                 | 104.085 ms                |
| OneStep                   | 93.944 ms                 | 973.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 22:22:00.993125 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.014 ms                  | 31.222 ms                 |
| ProcessBack:UpdateCache   | 9.755 ms                  | 15.486 ms                 |
| ProcessBack:UpsertPq      | 15.890 ms                 | 64.320 ms                 |
| ProcessOneStep            | 42.069 ms                 | 931.504 ms                |
| BlockToStepN              | 17.203 ms                 | 111.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 22:22:01.374722 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240124 22:22:01.555254 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 22:22:02.001420 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 22:22:02.555013 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
W20240124 22:22:02.883090 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240124 22:22:03.022652 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
[proc 7] 400 steps, total: 13.473, sample: 0.476, forward: 0.351, backward: 0.348, update: 0.133
[proc 3] 400 steps, total: 13.473, sample: 0.473, forward: 0.347, backward: 0.386, update: 0.130
[proc 0] 400 steps, total: 13.473, sample: 1.044, forward: 0.373, backward: 0.381, update: 0.141
[proc 4] 400 steps, total: 13.473, sample: 0.466, forward: 0.343, backward: 0.363, update: 0.130
[proc 6] 400 steps, total: 13.473, sample: 0.459, forward: 0.348, backward: 0.336, update: 0.137
[proc 5] 400 steps, total: 13.473, sample: 0.593, forward: 0.364, backward: 0.383, update: 0.132
[proc 2] 400 steps, total: 13.473, sample: 0.451, forward: 0.381, backward: 0.353, update: 0.139
[proc 1] 400 steps, total: 13.473, sample: 0.540, forward: 0.347, backward: 0.378, update: 0.131
E20240124 22:22:03.555009 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=3742
W20240124 22:22:03.989912 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240124 22:22:04.219148 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 22:22:04.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=43183
W20240124 22:22:05.219162 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 22:22:05.368016 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240124 22:22:05.555014 26735 parallel_pq_v2.h:76] insert failed, size(hashtable)=5990
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.516 ms                  | 52.854 ms                 |
| Forward                   | 3.717 ms                  | 11.953 ms                 |
| Backward                  | 3.354 ms                  | 8.286 ms                  |
| Optimize                  | 1.367 ms                  | 5.609 ms                  |
| BarrierTimeBeforeRank0    | 37.089 us                 | 67.362 ms                 |
| AfterBackward             | 42.272 ms                 | 931.699 ms                |
| BlockToStepN              | 17.347 ms                 | 111.732 ms                |
| OneStep                   | 95.239 ms                 | 973.983 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.023 ms                  | 31.222 ms                 |
| ProcessBack:UpdateCache   | 9.823 ms                  | 15.486 ms                 |
| ProcessBack:UpsertPq      | 16.028 ms                 | 64.320 ms                 |
| ProcessOneStep            | 42.464 ms                 | 931.504 ms                |
| BlockToStepN              | 17.203 ms                 | 111.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 22:22:06.256518 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240124 22:22:06.368903 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
E20240124 22:22:06.555011 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=2449
W20240124 22:22:07.292482 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
W20240124 22:22:07.369957 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240124 22:22:07.555012 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=9629
W20240124 22:22:08.303526 26736 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240124 22:22:08.369033 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240124 22:22:08.555028 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=8872
W20240124 22:22:09.369462 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240124 22:22:09.373558 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 22:22:09.555446 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240124 22:22:10.393290 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240124 22:22:10.425184 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
E20240124 22:22:10.555014 25504 parallel_pq_v2.h:76] insert failed, size(hashtable)=9567
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.585 ms                  | 50.965 ms                 |
| Forward                   | 3.702 ms                  | 11.136 ms                 |
| Backward                  | 3.361 ms                  | 7.421 ms                  |
| Optimize                  | 1.369 ms                  | 5.037 ms                  |
| BarrierTimeBeforeRank0    | 38.895 us                 | 60.496 ms                 |
| AfterBackward             | 42.111 ms                 | 805.882 ms                |
| BlockToStepN              | 18.031 ms                 | 161.697 ms                |
| OneStep                   | 95.769 ms                 | 835.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.021 ms                  | 29.116 ms                 |
| ProcessBack:UpdateCache   | 9.784 ms                  | 15.381 ms                 |
| ProcessBack:UpsertPq      | 14.951 ms                 | 63.334 ms                 |
| ProcessOneStep            | 42.066 ms                 | 805.805 ms                |
| BlockToStepN              | 17.877 ms                 | 173.189 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 22:22:11.393180 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240124 22:22:11.470825 26736 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
E20240124 22:22:11.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=147663
W20240124 22:22:12.393610 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=472
W20240124 22:22:12.476040 26736 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 22:22:12.555011 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=81649
W20240124 22:22:13.473707 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240124 22:22:13.508713 26736 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 22:22:13.555009 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=11443
W20240124 22:22:14.510087 26736 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 22:22:14.519979 25504 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240124 22:22:14.555006 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=12965
[proc 5] 500 steps, total: 11.947, sample: 0.839, forward: 0.368, backward: 0.344, update: 0.139
[proc 1] 500 steps, total: 11.946, sample: 0.536, forward: 0.347, backward: 0.383, update: 0.131
[proc 2] 500 steps, total: 11.947, sample: 0.523, forward: 0.353, backward: 0.352, update: 0.136
[proc 4] 500 steps, total: 11.947, sample: 0.542, forward: 0.362, backward: 0.351, update: 0.136
[proc 0] 500 steps, total: 11.947, sample: 0.994, forward: 0.361, backward: 0.344, update: 0.155
[proc 3] 500 steps, total: 11.947, sample: 0.551, forward: 0.356, backward: 0.355, update: 0.129
[proc 6] 500 steps, total: 11.947, sample: 0.523, forward: 0.389, backward: 0.364, update: 0.137
[proc 7] 500 steps, total: 11.947, sample: 0.514, forward: 0.352, backward: 0.359, update: 0.140
Successfully xmh. training takes 65.6111102104187 seconds
before call kg_cache_controller.StopThreads()
W20240124 22:22:15.453091 25504 grad_async_v2.h:71] call StopThreads. PID = 3048
W20240124 22:22:15.453128 25504 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 22:22:15.453596 25504 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 22:22:15.453613 25504 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240124 22:22:15.552412 26736 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240124 22:22:15.556270 26736 parallel_pq_v2.h:76] insert failed, size(hashtable)=52
W20240124 22:22:15.669276 25504 grad_async_v2.h:91] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.634 ms                  | 50.965 ms                 |
| Forward                   | 3.682 ms                  | 11.136 ms                 |
| Backward                  | 3.361 ms                  | 7.421 ms                  |
| Optimize                  | 1.356 ms                  | 5.037 ms                  |
| BarrierTimeBeforeRank0    | 35.007 us                 | 60.496 ms                 |
| AfterBackward             | 41.554 ms                 | 805.882 ms                |
| BlockToStepN              | 18.649 ms                 | 224.307 ms                |
| OneStep                   | 96.084 ms                 | 835.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.980 ms                  | 29.116 ms                 |
| ProcessBack:UpdateCache   | 9.711 ms                  | 15.381 ms                 |
| ProcessBack:UpsertPq      | 14.716 ms                 | 62.776 ms                 |
| ProcessOneStep            | 41.518 ms                 | 805.805 ms                |
| BlockToStepN              | 18.538 ms                 | 224.149 ms                |
+---------------------------+---------------------------+---------------------------+
