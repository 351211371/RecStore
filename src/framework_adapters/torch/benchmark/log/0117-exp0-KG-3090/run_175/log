WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 11:34:57.184742 38038 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_Freebase_10', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38038 sampler.py:454] Start PreSampling
WARNING [38038 sampler.py:532] Before construct renumbering_dict
WARNING [38038 sampler.py:555] PreSampling done
W20240125 12:05:36.656831 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 12:05:36.657150 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 12:05:36.657212 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 12:05:36.657246 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 12:05:36.657285 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 12:05:36.657325 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 12:05:36.657354 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 12:05:36.657420 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 12:05:36.657454 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 12:05:36.657480 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 12:05:36.657531 38038 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 12:05:36.657565 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 12:05:36.657601 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 12:05:36.657819 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 12:05:36.657869 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 12:05:36.657902 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 12:05:36.657958 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 12:05:36.657994 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 12:05:36.658030 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 12:05:36.658079 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 12:05:36.658106 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 12:05:36.658143 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 12:05:36.658174 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 12:05:36.658210 38038 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 12:05:36.658236 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 12:05:36.658262 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 12:05:36.658352 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 12:05:36.658399 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 12:05:36.658432 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 12:05:36.658466 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 12:05:36.658500 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 12:05:36.658536 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 12:05:36.658567 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 12:05:36.658608 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 12:05:36.658653 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 12:05:36.658696 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 12:05:36.658725 38038 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 12:05:36.658752 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 12:05:36.658775 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 12:05:36.658864 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 12:05:36.658926 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 12:05:36.658968 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 12:05:36.659011 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 12:05:36.659052 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 12:05:36.659090 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 12:05:36.659133 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 12:05:36.659171 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 12:05:36.659209 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 12:05:36.659246 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 12:05:36.659281 38038 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 12:05:36.659303 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 12:05:36.659327 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 12:05:36.659408 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 12:05:36.659478 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 12:05:36.659516 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 12:05:36.659545 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 12:05:36.659574 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 12:05:36.659610 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 12:05:36.659644 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 12:05:36.659674 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 12:05:36.659716 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 12:05:36.659746 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 12:05:36.659785 38038 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 12:05:36.659811 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 12:05:36.659835 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 12:05:36.659910 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 12:05:36.659948 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 12:05:36.659983 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 12:05:36.660013 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 12:05:36.660053 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 12:05:36.660097 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 12:05:36.660130 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 12:05:36.660159 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 12:05:36.660194 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 12:05:36.660236 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 12:05:36.660266 38038 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 12:05:36.660290 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 12:05:36.660313 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 12:05:36.660390 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 12:05:36.660434 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 12:05:36.660470 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 12:05:36.660498 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 12:05:36.660538 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 12:05:36.660569 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 12:05:36.660598 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 12:05:36.660641 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 12:05:36.660671 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 12:05:36.660708 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 12:05:36.660739 38038 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 12:05:36.660778 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 12:05:36.660815 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 12:05:36.660917 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 12:05:36.660967 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 12:05:36.661013 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 12:05:36.661053 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 12:05:36.661098 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 12:05:36.661140 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 12:05:36.661178 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 12:05:36.661211 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 12:05:36.661245 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 12:05:36.661278 38038 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 12:05:36.661309 38038 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 12:05:36.661332 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 12:05:36.661363 38038 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 12:05:37.592365 38038 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 12:05:37.592643 38038 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302708,  4302739,  4302766,  ..., 66087545, 23569226, 34261541]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2565.506 seconds
[Rank1] pid = 8574
[Rank2] pid = 8693
[Rank3] pid = 8792
[Rank4] pid = 8891
[Rank5] pid = 8988
[Rank6] pid = 9076
INFO [38038 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [8574 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [8693 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [8792 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [8891 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [8988 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [38038 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8792 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [9171 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [9076 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [9171 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8891 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8988 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [9076 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8693 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 12:17:59.827806  9237 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
INFO [8574 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 12:17:59.828416  8793 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240125 12:17:59.830241  9078 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240125 12:17:59.830250  8892 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240125 12:17:59.830241  8694 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240125 12:17:59.830255  8576 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240125 12:17:59.830238  8989 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240125 12:17:59.830256  9174 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240125 12:17:59.961647  9174 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027251000 781.2 kB
W20240125 12:17:59.961848  9078 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x102027316000 781.2 kB
W20240125 12:17:59.961876  8694 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020273db000 781.2 kB
W20240125 12:17:59.961882  8989 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020274a0000 781.2 kB
W20240125 12:17:59.961910  8793 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x102027565000 781.2 kB
W20240125 12:17:59.962000  8892 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x10202762a000 781.2 kB
W20240125 12:17:59.962021  9174 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x1020276ef000 781.2 kB
W20240125 12:17:59.962059  8576 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x102027879000 781.2 kB
W20240125 12:17:59.962038  9237 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x1020277b4000 781.2 kB
W20240125 12:17:59.962131  9174 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10202793e000 152.6 MB
W20240125 12:17:59.962182  9174 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x1020311d6000 152.6 MB
W20240125 12:17:59.962252  9174 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 12:17:59.962381  9237 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10203aa6e000 781.2 kB
W20240125 12:17:59.962462  8989 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10203ab33000 781.2 kB
W20240125 12:17:59.962481  9237 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10203acbd000 152.6 MB
W20240125 12:17:59.962481  8793 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10203abf8000 781.2 kB
W20240125 12:17:59.962520  8892 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x102044555000 781.2 kB
W20240125 12:17:59.962532  9237 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1020446df000 152.6 MB
W20240125 12:17:59.962527  9078 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10204461a000 781.2 kB
W20240125 12:17:59.962608  9237 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 12:17:59.962885  8892 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x10204df77000 152.6 MB
W20240125 12:17:59.962947  8793 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10205780f000 152.6 MB
W20240125 12:17:59.962968  8892 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1020610a7000 152.6 MB
W20240125 12:17:59.963018  8793 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10206a93f000 152.6 MB
W20240125 12:17:59.963027  9078 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x1020741d7000 152.6 MB
W20240125 12:17:59.963057  8989 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10207da6f000 152.6 MB
W20240125 12:17:59.963078  8892 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 12:17:59.963088  8576 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102087307000 781.2 kB
W20240125 12:17:59.963114  9078 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x102087491000 152.6 MB
W20240125 12:17:59.963111  8694 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x1020873cc000 781.2 kB
W20240125 12:17:59.963141  8989 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x102090d29000 152.6 MB
W20240125 12:17:59.963186  8576 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10209a5c1000 152.6 MB
W20240125 12:17:59.963222  8694 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1020a3e59000 152.6 MB
W20240125 12:17:59.963253  8576 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1020ad6f1000 152.6 MB
W20240125 12:17:59.963311  9078 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 12:17:59.963310  8989 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 12:17:59.963325  8694 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020b6f89000 152.6 MB
W20240125 12:17:59.963340  8576 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 12:17:59.963347  8793 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 12:17:59.963435  8694 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 12:17:59.966964  9174 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 12:17:59.967025  9237 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 12:17:59.967335  8989 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 12:17:59.967352  8892 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 12:17:59.967352  9078 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 12:17:59.967362  8793 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 12:17:59.967368  8576 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 12:17:59.968219  8694 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
[Rank7] pid = 9171
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [38038 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8574 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8891 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [9076 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [8693 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [8988 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [8792 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [9171 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 12:19:26.932055  9174 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.932194  9237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.932257  8892 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.932325  8793 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.932528  9078 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.932590  8694 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.933148  8989 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 12:19:26.933197  8576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240125 12:19:26.934851  9237 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 12:19:26.935011  9237 grad_base.h:172] Init GradProcessingBase done
I20240125 12:19:44.595368  9237 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 12:19:44.595810  9237 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 12:19:44.595834  9237 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240125 12:19:46.676010  9237 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 12:20:32.633772 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:20:32.634217 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:20:34.269722 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:20:34.270303 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 12:20:35.620884 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:20:35.621060 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:20:40.378516 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:20:40.379583 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:20:42.768091 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:20:42.791479 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 12:20:42.867851  9174 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 12:20:43.227523  8989 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 12:20:43.791019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240125 12:20:44.103678 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240125 12:20:44.957372 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 12:20:44.999538  8694 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240125 12:20:47.097460 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:20:47.153326 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 12:20:47.215811  8793 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 12:20:47.832018  8576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 12:20:48.153017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=26
I20240125 12:20:48.868146  9078 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 12:20:49.153025 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
W20240125 12:20:49.154120 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
I20240125 12:20:50.102850  8892 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240125 12:20:50.156894 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:20:50.556344 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
E20240125 12:20:51.156841 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 12:20:56.403775 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:20:56.433662 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240125 12:20:56.574083  9237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.656 ms                  | 9.656 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240125 12:20:57.436946 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:20:57.459659 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 948.990 ms                | 974.255 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.656 ms                  | 9.656 ms                  |
| Forward                   | 1.728 s                   | 1.728 s                   |
| Backward                  | 528.667 ms                | 528.667 ms                |
| Optimize                  | 140.712 ms                | 140.712 ms                |
| BarrierTimeBeforeRank0    | 74.415 us                 | 74.415 us                 |
+---------------------------+---------------------------+---------------------------+
E20240125 12:21:02.427166  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240125 12:21:02.727981  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 12:21:02.956629 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:21:03.427011 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240125 12:21:03.550760  9237 grad_async_v2.h:236] pq is empty
W20240125 12:21:03.994616 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 12:21:04.320740  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=3, pq.top=3
E20240125 12:21:04.446072 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=42915
W20240125 12:21:05.014294 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 12:21:05.113214  9237 grad_async_v2.h:236] pq is empty
E20240125 12:21:05.446036 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=11717
W20240125 12:21:06.048974 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240125 12:21:06.449291  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.581 ms                 | 974.255 ms                |
| ProcessBack:UpdateCache   | 26.382 ms                 | 2.476 s                   |
| ProcessBack:UpsertPq      | 498.287 ms                | 716.872 ms                |
| ProcessOneStep            | 651.111 ms                | 3.741 s                   |
| BlockToStepN              | 303.567 us                | 220.825 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.611 ms                 | 79.509 ms                 |
| Forward                   | 9.480 ms                  | 1.728 s                   |
| Backward                  | 12.953 ms                 | 528.667 ms                |
| Optimize                  | 4.002 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 82.694 us                 | 11.536 ms                 |
| AfterBackward             | 651.186 ms                | 3.741 s                   |
| BlockToStepN              | 447.611 us                | 224.401 ms                |
| OneStep                   | 866.706 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:07.249601 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 12:21:07.449013 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=199
W20240125 12:21:08.367655 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 12:21:08.408232  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240125 12:21:08.449013 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=42624
W20240125 12:21:08.666074 10827 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240125 12:21:09.365203  9237 grad_async_v2.h:236] pq is empty
W20240125 12:21:09.404875 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:21:09.449014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1063
W20240125 12:21:10.012190  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240125 12:21:10.446200 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 12:21:10.449736  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240125 12:21:10.745826  9237 grad_async_v2.h:236] pq is empty
W20240125 12:21:11.288075  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=11, pq.top=11
E20240125 12:21:11.488891 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=38003
W20240125 12:21:11.613656 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.125 ms                 | 974.255 ms                |
| ProcessBack:UpdateCache   | 26.438 ms                 | 2.476 s                   |
| ProcessBack:UpsertPq      | 406.388 ms                | 888.329 ms                |
| ProcessOneStep            | 580.400 ms                | 3.741 s                   |
| BlockToStepN              | 892.191 us                | 227.193 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.611 ms                 | 374.125 ms                |
| Forward                   | 17.427 ms                 | 1.728 s                   |
| Backward                  | 11.128 ms                 | 528.667 ms                |
| Optimize                  | 4.122 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 99.322 us                 | 246.562 ms                |
| AfterBackward             | 551.546 ms                | 3.741 s                   |
| BlockToStepN              | 755.695 us                | 227.414 ms                |
| OneStep                   | 767.974 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:12.338503  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
E20240125 12:21:12.488015 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=29579
W20240125 12:21:12.705524 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 12:21:13.396955  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240125 12:21:13.488015 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=17939
W20240125 12:21:13.736506 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
W20240125 12:21:14.442654  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240125 12:21:14.488025 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=20717
W20240125 12:21:14.944589 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240125 12:21:15.482159  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
E20240125 12:21:15.488023 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=28188
W20240125 12:21:16.092074 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 12:21:16.483207  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
E20240125 12:21:16.492964 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=26706
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 12.125 ms                 | 974.255 ms                |
| ProcessBack:UpdateCache   | 26.382 ms                 | 2.476 s                   |
| ProcessBack:UpsertPq      | 208.730 ms                | 888.329 ms                |
| ProcessOneStep            | 377.439 ms                | 3.741 s                   |
| BlockToStepN              | 26.043 ms                 | 362.826 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 42.345 ms                 | 374.125 ms                |
| Forward                   | 9.639 ms                  | 1.728 s                   |
| Backward                  | 12.953 ms                 | 528.667 ms                |
| Optimize                  | 4.211 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 112.629 us                | 246.562 ms                |
| AfterBackward             | 377.593 ms                | 3.741 s                   |
| BlockToStepN              | 26.235 ms                 | 363.066 ms                |
| OneStep                   | 683.972 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:17.178509 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
E20240125 12:21:17.492013  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=12993
W20240125 12:21:17.558060  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240125 12:21:18.257922 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
E20240125 12:21:18.504848 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=8613
W20240125 12:21:18.661945  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240125 12:21:19.512712 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=16157
W20240125 12:21:19.579530 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
W20240125 12:21:19.661056  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=27, pq.top=27
E20240125 12:21:20.512015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=46771
W20240125 12:21:20.714001  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=30, pq.top=29
W20240125 12:21:20.774593 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240125 12:21:21.524904 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=50107
W20240125 12:21:21.721261  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=32, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.039 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 25.636 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 109.991 ms                | 811.048 ms                |
| ProcessOneStep            | 210.840 ms                | 3.741 s                   |
| BlockToStepN              | 77.439 ms                 | 429.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 37.132 ms                 | 374.125 ms                |
| Forward                   | 9.480 ms                  | 1.728 s                   |
| Backward                  | 11.128 ms                 | 528.667 ms                |
| Optimize                  | 4.151 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 177.656 us                | 246.562 ms                |
| AfterBackward             | 210.993 ms                | 3.741 s                   |
| BlockToStepN              | 56.298 ms                 | 430.044 ms                |
| OneStep                   | 640.380 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:22.006026 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240125 12:21:22.524022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=3744
W20240125 12:21:22.800086  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=35, pq.top=34
W20240125 12:21:23.264515 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240125 12:21:23.524096 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=57929
W20240125 12:21:23.800096  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240125 12:21:24.275733 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240125 12:21:24.525038 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=17583
W20240125 12:21:24.800053  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=37, pq.top=37
E20240125 12:21:25.612856 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:21:25.713434 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240125 12:21:25.844444  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
E20240125 12:21:26.616878 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=4814
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.914 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 25.264 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 103.058 ms                | 811.048 ms                |
| ProcessOneStep            | 200.777 ms                | 3.741 s                   |
| BlockToStepN              | 100.391 ms                | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:26.914338 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 35.918 ms                 | 410.349 ms                |
| Forward                   | 9.480 ms                  | 1.728 s                   |
| Backward                  | 9.666 ms                  | 528.667 ms                |
| Optimize                  | 4.163 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 177.656 us                | 246.562 ms                |
| AfterBackward             | 200.908 ms                | 3.741 s                   |
| BlockToStepN              | 77.777 ms                 | 535.095 ms                |
| OneStep                   | 640.380 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:27.083608  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=41, pq.top=41
E20240125 12:21:27.616017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1888
W20240125 12:21:28.141403  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240125 12:21:28.281553 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240125 12:21:28.616017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=46441
E20240125 12:21:29.616016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=29906
W20240125 12:21:29.620932  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240125 12:21:29.630584 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240125 12:21:30.616223 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:21:30.684612 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240125 12:21:31.212164  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
E20240125 12:21:31.625453 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=42721
W20240125 12:21:31.694944 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.225 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 24.763 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 119.211 ms                | 811.048 ms                |
| ProcessOneStep            | 234.812 ms                | 3.741 s                   |
| BlockToStepN              | 100.391 ms                | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.537 ms                 | 410.349 ms                |
| Forward                   | 9.639 ms                  | 1.728 s                   |
| Backward                  | 9.666 ms                  | 528.667 ms                |
| Optimize                  | 4.153 ms                  | 140.712 ms                |
| BarrierTimeBeforeRank0    | 1.109 ms                  | 246.562 ms                |
| AfterBackward             | 234.910 ms                | 3.741 s                   |
| BlockToStepN              | 100.624 ms                | 535.095 ms                |
| OneStep                   | 658.562 ms                | 6.379 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:21:32.625017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=21754
W20240125 12:21:32.671999  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240125 12:21:32.916647 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240125 12:21:33.629946  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:21:34.042126 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240125 12:21:34.077399  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
E20240125 12:21:34.640916 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:21:35.089227  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240125 12:21:35.207209 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
E20240125 12:21:35.640038 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=312
W20240125 12:21:36.097565  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
E20240125 12:21:36.656939 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.225 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 24.763 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 132.426 ms                | 811.048 ms                |
| ProcessOneStep            | 239.975 ms                | 968.799 ms                |
| BlockToStepN              | 77.439 ms                 | 508.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 32.497 ms                 | 374.125 ms                |
| Forward                   | 17.427 ms                 | 50.041 ms                 |
| Backward                  | 11.128 ms                 | 65.650 ms                 |
| Optimize                  | 4.211 ms                  | 22.046 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 240.064 ms                | 968.874 ms                |
| BlockToStepN              | 77.777 ms                 | 509.053 ms                |
| OneStep                   | 654.483 ms                | 1.539 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:37.011139 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
W20240125 12:21:37.412076  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240125 12:21:37.656024 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=30464
W20240125 12:21:38.412180  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=59, pq.top=59
E20240125 12:21:38.660897 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=29706
W20240125 12:21:38.975000 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
E20240125 12:21:39.660034 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=317
W20240125 12:21:39.997942 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240125 12:21:40.660032 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=671
W20240125 12:21:41.029531 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
E20240125 12:21:41.660017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.914 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 24.763 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 133.313 ms                | 811.048 ms                |
| ProcessOneStep            | 234.812 ms                | 968.799 ms                |
| BlockToStepN              | 77.195 ms                 | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 32.497 ms                 | 374.125 ms                |
| Forward                   | 17.900 ms                 | 50.041 ms                 |
| Backward                  | 11.188 ms                 | 65.650 ms                 |
| Optimize                  | 4.262 ms                  | 22.046 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 234.910 ms                | 968.874 ms                |
| BlockToStepN              | 77.406 ms                 | 535.095 ms                |
| OneStep                   | 641.353 ms                | 1.539 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:42.083984 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 12:21:42.461164  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
E20240125 12:21:42.660857 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=515
W20240125 12:21:43.194693 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:21:43.660033 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=28434
W20240125 12:21:43.799065  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240125 12:21:44.469882 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
E20240125 12:21:44.660022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=65
W20240125 12:21:44.929666  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240125 12:21:45.572032 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
E20240125 12:21:45.660027 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1409
W20240125 12:21:45.941236  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=67, pq.top=67
E20240125 12:21:46.669163 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=10040
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 22.929 ms                 | 948.990 ms                |
| ProcessBack:UpdateCache   | 25.278 ms                 | 2.452 s                   |
| ProcessBack:UpsertPq      | 134.315 ms                | 811.048 ms                |
| ProcessOneStep            | 245.418 ms                | 3.094 s                   |
| BlockToStepN              | 44.862 ms                 | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.537 ms                 | 374.125 ms                |
| Forward                   | 17.427 ms                 | 50.041 ms                 |
| Backward                  | 10.722 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 31.374 ms                 |
| BarrierTimeBeforeRank0    | 132.859 us                | 118.236 ms                |
| AfterBackward             | 245.488 ms                | 3.094 s                   |
| BlockToStepN              | 45.120 ms                 | 535.095 ms                |
| OneStep                   | 640.380 ms                | 3.239 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:47.003226 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240125 12:21:47.049682  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240125 12:21:47.669027  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=4754
W20240125 12:21:48.344938  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240125 12:21:48.515410 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240125 12:21:48.669042 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=3749
W20240125 12:21:49.526386 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
W20240125 12:21:49.624055  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
E20240125 12:21:49.669018 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=15921
W20240125 12:21:50.556979 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240125 12:21:50.669014  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=5746
W20240125 12:21:50.840130  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=75, pq.top=75
E20240125 12:21:51.669027 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=792
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 23.849 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.763 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 137.388 ms                | 811.048 ms                |
| ProcessOneStep            | 270.480 ms                | 3.094 s                   |
| BlockToStepN              | 56.088 ms                 | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:51.752686 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 30.737 ms                 | 378.435 ms                |
| Forward                   | 17.900 ms                 | 50.041 ms                 |
| Backward                  | 10.109 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 270.597 ms                | 3.094 s                   |
| BlockToStepN              | 56.298 ms                 | 535.095 ms                |
| OneStep                   | 640.380 ms                | 3.239 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:21:52.670137 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:21:52.923919 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240125 12:21:53.670022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1127
W20240125 12:21:54.471079 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240125 12:21:54.670030 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
W20240125 12:21:55.569864  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=76
W20240125 12:21:55.612773 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 12:21:55.670037 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=857
E20240125 12:21:56.677160 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=4760
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.074 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.763 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 140.446 ms                | 716.872 ms                |
| ProcessOneStep            | 280.045 ms                | 3.741 s                   |
| BlockToStepN              | 44.862 ms                 | 534.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:56.760406 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 30.737 ms                 | 378.435 ms                |
| Forward                   | 17.900 ms                 | 50.041 ms                 |
| Backward                  | 10.109 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 132.859 us                | 118.236 ms                |
| AfterBackward             | 280.170 ms                | 3.741 s                   |
| BlockToStepN              | 45.120 ms                 | 535.095 ms                |
| OneStep                   | 641.353 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:21:57.138597  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=78, pq.top=78
E20240125 12:21:57.681855 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=46397
W20240125 12:21:57.766819 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 12:21:58.321502  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
E20240125 12:21:58.681015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=11975
W20240125 12:21:58.851482 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
W20240125 12:21:59.466276  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=81, pq.top=81
E20240125 12:21:59.681016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=39862
W20240125 12:21:59.963616 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
W20240125 12:22:00.479202  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240125 12:22:00.681078 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=34191
W20240125 12:22:01.085851 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 12:22:01.479190  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=84, pq.top=84
E20240125 12:22:01.681013  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=4427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.556 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.691 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 144.392 ms                | 716.872 ms                |
| ProcessOneStep            | 281.647 ms                | 3.741 s                   |
| BlockToStepN              | 56.088 ms                 | 552.874 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 31.046 ms                 | 378.435 ms                |
| Forward                   | 17.900 ms                 | 50.041 ms                 |
| Backward                  | 10.581 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 132.859 us                | 118.236 ms                |
| AfterBackward             | 281.734 ms                | 3.741 s                   |
| BlockToStepN              | 77.406 ms                 | 553.109 ms                |
| OneStep                   | 654.483 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:02.263705 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
E20240125 12:22:02.681015  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=339
W20240125 12:22:02.777043  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240125 12:22:03.476030 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
E20240125 12:22:03.681294 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=5017
W20240125 12:22:03.793545  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240125 12:22:04.520678 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240125 12:22:04.681018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=13386
W20240125 12:22:04.797726  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240125 12:22:05.602438 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240125 12:22:05.681020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=46862
W20240125 12:22:05.797291  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240125 12:22:06.612931 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240125 12:22:06.687402 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=27046
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.205 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.176 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 131.288 ms                | 716.872 ms                |
| ProcessOneStep            | 240.216 ms                | 3.741 s                   |
| BlockToStepN              | 77.195 ms                 | 552.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:06.797041  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 30.737 ms                 | 378.435 ms                |
| Forward                   | 17.900 ms                 | 50.041 ms                 |
| Backward                  | 9.911 ms                  | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 240.320 ms                | 3.741 s                   |
| BlockToStepN              | 77.777 ms                 | 650.963 ms                |
| OneStep                   | 640.269 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:07.687019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5809
W20240125 12:22:07.797029  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240125 12:22:07.940251 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
E20240125 12:22:08.687021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=7264
W20240125 12:22:08.797127  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=99, pq.top=99
W20240125 12:22:09.315521 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 86.459, sample: 2.328, forward: 2.914, backward: 1.863, update: 0.582
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 84.687, sample: 2.740, forward: 2.735, backward: 1.933, update: 0.560
E20240125 12:22:09.687219 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
train_sampler.Prefill()
-------Step 0-------
tensor([  535965,    95595,   485814, 16264875,    95615,    95636,   535968,
           95649,    95670,    95694]) tensor([ 5527115, 11690372, 61226622, 63606656, 28196727,   209375, 20791724,
        48114118, 58731259, 39027501])
-------Step 1-------
tensor([  535965,    95595,   485814, 16264875,    95615,    95636,   535968,
           95649,    95670,    95694]) tensor([68695343, 33825485, 58885237, 39524644, 62266509, 14967453, 55952021,
          597163, 25718256, 35624803])
-------Step 2-------
tensor([   16489,   404217,   375284, 19132797,   130640,   130656,   130677,
          130706,   130728,   130742]) tensor([43421383, 40310955,  1402138, 33810245, 19912438, 29453209,  7929273,
        69414091, 73491605, 27849871])
-------Step 3-------
tensor([   16489,   404217,   375284, 19132797,   130640,   130656,   130677,
          130706,   130728,   130742]) tensor([22485062, 67709702, 67435156, 57388095, 81051517, 78438665, 80520734,
        28684194, 78411744, 12823327])
-------Step 4-------
tensor([  167721,   167739,   167754, 71845570,   167773,   167793,   167808,
          167824,   167839, 29457607]) tensor([76703513, 65443878, 74204558, 44068913,   327056,  4361254, 27923156,
        62678637, 76683017, 13179318])
-------Step 5-------
tensor([  167721,   167739,   167754, 71845570,   167773,   167793,   167808,
          167824,   167839, 29457607]) tensor([51334133, 48904157, 53316581,    51328, 71366812, 46590975, 43064057,
         1359767, 60790555, 37773320])
-------Step 6-------
tensor([ 7546340,  6039586,   205022, 41981932,   205036,   205066, 78094104,
        49065087,   205087,   205100]) tensor([31875410,   121869, 60596230, 18727078, 20096915, 38801891, 16797773,
        75877229, 61014424, 63102576])
-------Step 7-------
tensor([ 7546340,  6039586,   205022, 41981932,   205036,   205066, 78094104,
        49065087,   205087,   205100]) tensor([28357358,  6768935, 30578935, 10644489, 58012653, 66421092,  4324672,
        17521124, 47979687, 78338405])
-------Step 8-------
tensor([  240695,   240711, 78774710,   240733,   438293,   438313, 10880112,
          240752,   240773,   380581]) tensor([18346223, 36033607, 75214819,  5296411, 81367657,  5823967,  5560018,
        19065367, 58181682,  6499571])
-------Step 9-------
tensor([  240695,   240711, 78774710,   240733,   438293,   438313, 10880112,
          240752,   240773,   380581]) tensor([76955739, 28735758, 40515545, 60099837, 37609701, 75464251, 81768445,
        17036809, 24303216,  7084710])
before start barrier
start train
[proc 0] 100 steps, total: 73.113, sample: 5.872, forward: 3.460, backward: 1.918, update: 0.676
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 86.830, sample: 2.395, forward: 3.203, backward: 2.049, update: 0.741
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 80.829, sample: 2.243, forward: 2.813, backward: 1.849, update: 0.624
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 82.482, sample: 2.561, forward: 2.449, backward: 2.018, update: 0.517
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 81.868, sample: 2.462, forward: 3.035, backward: 1.798, update: 0.520
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 79.596, sample: 2.347, forward: 2.791, backward: 1.824, update: 0.700
W20240125 12:22:10.104773  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240125 12:22:10.688868 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=114961
W20240125 12:22:10.719928 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end2
W20240125 12:22:11.259133  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240125 12:22:11.698834 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=31939
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.335 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.183 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 133.313 ms                | 716.872 ms                |
| ProcessOneStep            | 240.216 ms                | 3.741 s                   |
| BlockToStepN              | 77.439 ms                 | 684.328 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.736 ms                 | 378.435 ms                |
| Forward                   | 17.646 ms                 | 63.793 ms                 |
| Backward                  | 9.911 ms                  | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 240.320 ms                | 3.741 s                   |
| BlockToStepN              | 77.777 ms                 | 684.566 ms                |
| OneStep                   | 639.908 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:12.219138 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240125 12:22:12.698102 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=6836
W20240125 12:22:12.738516  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240125 12:22:13.667418 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240125 12:22:13.698015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=457
W20240125 12:22:14.331431  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=106, pq.top=106
E20240125 12:22:14.698021  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=5948
W20240125 12:22:14.734274 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
E20240125 12:22:15.698014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=4875
W20240125 12:22:15.798501  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240125 12:22:16.134892 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240125 12:22:16.700846 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=26162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.335 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.183 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 137.248 ms                | 716.872 ms                |
| ProcessOneStep            | 247.188 ms                | 3.741 s                   |
| BlockToStepN              | 77.439 ms                 | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.177 ms                 | 378.435 ms                |
| Forward                   | 17.646 ms                 | 63.793 ms                 |
| Backward                  | 10.109 ms                 | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 105.150 us                | 118.236 ms                |
| AfterBackward             | 247.271 ms                | 3.741 s                   |
| BlockToStepN              | 100.624 ms                | 764.117 ms                |
| OneStep                   | 639.908 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:17.322747  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240125 12:22:17.609149 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240125 12:22:17.700035 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=48044
W20240125 12:22:18.690625  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=115, pq.top=114
E20240125 12:22:18.700862 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=6714
W20240125 12:22:19.245864 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240125 12:22:19.704867 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5296
W20240125 12:22:19.999861  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240125 12:22:20.704689 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1574
W20240125 12:22:21.213737 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
W20240125 12:22:21.312893  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240125 12:22:21.706187 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=37115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.205 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.117 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 134.315 ms                | 716.872 ms                |
| ProcessOneStep            | 241.991 ms                | 3.741 s                   |
| BlockToStepN              | 117.399 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.736 ms                 | 378.435 ms                |
| Forward                   | 17.427 ms                 | 63.793 ms                 |
| Backward                  | 10.463 ms                 | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 105.330 ms                |
| BarrierTimeBeforeRank0    | 105.150 us                | 135.796 ms                |
| AfterBackward             | 242.059 ms                | 3.741 s                   |
| BlockToStepN              | 117.609 ms                | 764.117 ms                |
| OneStep                   | 639.908 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:22.706029 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5113
W20240125 12:22:22.998436 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240125 12:22:23.706032 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240125 12:22:24.069656 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240125 12:22:24.711364 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240125 12:22:25.115530 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 12:22:25.356247  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
E20240125 12:22:25.711019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=40964
W20240125 12:22:26.136214 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 12:22:26.553876  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=123, pq.top=123
E20240125 12:22:26.712937 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=26304
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.382 ms                 | 164.552 ms                |
| ProcessBack:UpdateCache   | 24.173 ms                 | 146.164 ms                |
| ProcessBack:UpsertPq      | 134.249 ms                | 716.872 ms                |
| ProcessOneStep            | 245.418 ms                | 3.741 s                   |
| BlockToStepN              | 105.405 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 28.177 ms                 | 378.435 ms                |
| Forward                   | 17.427 ms                 | 63.793 ms                 |
| Backward                  | 10.636 ms                 | 65.650 ms                 |
| Optimize                  | 4.375 ms                  | 105.330 ms                |
| BarrierTimeBeforeRank0    | 103.291 us                | 135.796 ms                |
| AfterBackward             | 245.488 ms                | 3.741 s                   |
| BlockToStepN              | 117.609 ms                | 764.117 ms                |
| OneStep                   | 640.269 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:27.376996 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
W20240125 12:22:27.560031  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240125 12:22:27.726388 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=34261
W20240125 12:22:28.560384  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
E20240125 12:22:28.735143 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=36604
W20240125 12:22:28.737753 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240125 12:22:29.560034  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=129, pq.top=129
E20240125 12:22:29.743054 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1222
W20240125 12:22:29.959277 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
W20240125 12:22:30.566110  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=131, pq.top=131
E20240125 12:22:30.765735 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=35156
W20240125 12:22:31.566104  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240125 12:22:31.726806 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.382 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.374 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 132.175 ms                | 694.648 ms                |
| ProcessOneStep            | 239.975 ms                | 3.741 s                   |
| BlockToStepN              | 127.338 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:31.765031 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=79940
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.644 ms                 | 378.435 ms                |
| Forward                   | 17.427 ms                 | 63.793 ms                 |
| Backward                  | 10.636 ms                 | 91.022 ms                 |
| Optimize                  | 4.397 ms                  | 105.330 ms                |
| BarrierTimeBeforeRank0    | 112.629 us                | 135.796 ms                |
| AfterBackward             | 240.064 ms                | 3.741 s                   |
| BlockToStepN              | 127.615 ms                | 764.117 ms                |
| OneStep                   | 639.301 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:32.768846 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1294
W20240125 12:22:33.185791  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240125 12:22:33.371394 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240125 12:22:33.769598 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1095
W20240125 12:22:34.356035  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=136
E20240125 12:22:34.791455 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=2489
W20240125 12:22:35.098716 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
E20240125 12:22:35.796881 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.382 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.691 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 131.288 ms                | 694.648 ms                |
| ProcessOneStep            | 234.812 ms                | 3.741 s                   |
| BlockToStepN              | 129.513 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:36.796034 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.644 ms                 | 378.435 ms                |
| Forward                   | 15.592 ms                 | 63.793 ms                 |
| Backward                  | 10.636 ms                 | 91.022 ms                 |
| Optimize                  | 4.361 ms                  | 105.330 ms                |
| BarrierTimeBeforeRank0    | 132.859 us                | 135.796 ms                |
| AfterBackward             | 234.910 ms                | 3.741 s                   |
| BlockToStepN              | 129.733 ms                | 764.117 ms                |
| OneStep                   | 639.301 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:37.011381 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
E20240125 12:22:37.809486 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=203
W20240125 12:22:38.364041 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
E20240125 12:22:38.809016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=2887
W20240125 12:22:39.441619  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240125 12:22:39.483922 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:22:39.809013 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=43094
W20240125 12:22:40.441327  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=141, pq.top=141
E20240125 12:22:40.815219 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=42409
W20240125 12:22:40.832896 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
W20240125 12:22:41.714514  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.597 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 133.453 ms                | 694.648 ms                |
| ProcessOneStep            | 241.991 ms                | 4.400 s                   |
| BlockToStepN              | 127.338 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:41.815021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=20718
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.453 ms                 | 378.435 ms                |
| Forward                   | 15.592 ms                 | 63.793 ms                 |
| Backward                  | 10.636 ms                 | 91.022 ms                 |
| Optimize                  | 4.357 ms                  | 105.330 ms                |
| BarrierTimeBeforeRank0    | 177.656 us                | 135.796 ms                |
| AfterBackward             | 242.059 ms                | 4.400 s                   |
| BlockToStepN              | 127.615 ms                | 764.117 ms                |
| OneStep                   | 638.610 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:42.141290 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
W20240125 12:22:42.725119  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=144, pq.top=144
E20240125 12:22:42.815024 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=15884
W20240125 12:22:43.383859 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240125 12:22:43.824829 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1270
W20240125 12:22:44.023222  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240125 12:22:44.748051 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
E20240125 12:22:44.824018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=10806
W20240125 12:22:45.164714  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
E20240125 12:22:45.824018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=6077
W20240125 12:22:46.245712 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
W20240125 12:22:46.344869  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.984 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.176 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 133.453 ms                | 694.648 ms                |
| ProcessOneStep            | 239.975 ms                | 3.741 s                   |
| BlockToStepN              | 130.526 ms                | 684.328 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:46.824029 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=43855
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.453 ms                 | 374.125 ms                |
| Forward                   | 15.592 ms                 | 50.041 ms                 |
| Backward                  | 10.722 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 132.859 us                | 118.236 ms                |
| AfterBackward             | 240.064 ms                | 3.741 s                   |
| BlockToStepN              | 130.744 ms                | 684.566 ms                |
| OneStep                   | 633.401 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:47.541505  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=152
W20240125 12:22:47.543083 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240125 12:22:47.824013 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=135
W20240125 12:22:48.541379  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=155
E20240125 12:22:48.832832 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=29824
W20240125 12:22:49.080722 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
W20240125 12:22:49.638391  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240125 12:22:49.832015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=19350
W20240125 12:22:50.615787 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
E20240125 12:22:50.857056 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=8448
W20240125 12:22:50.862928  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.957 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 131.288 ms                | 694.648 ms                |
| ProcessOneStep            | 232.816 ms                | 3.741 s                   |
| BlockToStepN              | 133.421 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:51.860858 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=45995
W20240125 12:22:51.904246 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.086 ms                 | 374.125 ms                |
| Forward                   | 15.405 ms                 | 50.041 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 232.885 ms                | 3.741 s                   |
| BlockToStepN              | 133.627 ms                | 764.117 ms                |
| OneStep                   | 628.427 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:52.880138 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:22:53.078145 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240125 12:22:53.880014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1576
W20240125 12:22:54.147151 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240125 12:22:54.804549  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=160
E20240125 12:22:54.881569 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:22:55.247257 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:22:55.881014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=2103
W20240125 12:22:56.044467  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240125 12:22:56.399570 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.872 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.173 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 132.106 ms                | 694.648 ms                |
| ProcessOneStep            | 231.915 ms                | 3.741 s                   |
| BlockToStepN              | 133.421 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:22:56.884894  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.033 ms                 | 374.125 ms                |
| Forward                   | 14.240 ms                 | 50.041 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 230.266 ms                | 3.741 s                   |
| BlockToStepN              | 133.627 ms                | 764.117 ms                |
| OneStep                   | 628.427 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:22:57.045079  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240125 12:22:57.558054 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 12:22:57.884840 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1159
W20240125 12:22:58.068709  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240125 12:22:58.861728 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 12:22:58.884016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=30920
E20240125 12:22:59.891659  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=5842
W20240125 12:23:00.039723  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240125 12:23:00.049777 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240125 12:23:00.885021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=238
W20240125 12:23:01.242267 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 12:23:01.331223  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 137.488 ms                |
| ProcessBack:UpsertPq      | 133.313 ms                | 694.648 ms                |
| ProcessOneStep            | 232.816 ms                | 3.741 s                   |
| BlockToStepN              | 135.026 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:01.892859 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=599
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.429 ms                 | 374.125 ms                |
| Forward                   | 14.175 ms                 | 50.041 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 232.885 ms                | 3.741 s                   |
| BlockToStepN              | 133.627 ms                | 764.117 ms                |
| OneStep                   | 626.318 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:02.346199  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240125 12:23:02.892309  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=150
W20240125 12:23:03.033126 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
W20240125 12:23:03.476927  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240125 12:23:03.892128 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
E20240125 12:23:04.929348 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=223
W20240125 12:23:04.931586 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 12:23:05.167518  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240125 12:23:05.952391 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=2213
W20240125 12:23:06.108326 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.872 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 132.316 ms                | 689.437 ms                |
| ProcessOneStep            | 233.053 ms                | 3.741 s                   |
| BlockToStepN              | 135.026 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:06.952015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.453 ms                 | 374.125 ms                |
| Forward                   | 15.405 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 105.150 us                | 118.236 ms                |
| AfterBackward             | 233.123 ms                | 3.741 s                   |
| BlockToStepN              | 135.238 ms                | 764.117 ms                |
| OneStep                   | 623.337 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:07.481178 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240125 12:23:07.954479 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1511
W20240125 12:23:08.783550 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:23:08.954020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=141
W20240125 12:23:09.314203  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240125 12:23:09.826895 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 12:23:09.954082 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
W20240125 12:23:10.317514  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240125 12:23:10.858649 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240125 12:23:10.959952 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=14971
W20240125 12:23:11.426528  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 26.006 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 133.453 ms                | 689.437 ms                |
| ProcessOneStep            | 239.975 ms                | 3.840 s                   |
| BlockToStepN              | 139.002 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:11.959039 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=8510
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.095 ms                 | 374.125 ms                |
| Forward                   | 15.592 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 104.144 us                | 118.236 ms                |
| AfterBackward             | 234.910 ms                | 3.840 s                   |
| BlockToStepN              | 139.222 ms                | 764.117 ms                |
| OneStep                   | 623.337 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:11.971642 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 12:23:12.432024  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=185, pq.top=185
E20240125 12:23:12.959014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=584
W20240125 12:23:13.291162 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240125 12:23:13.432307  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
E20240125 12:23:13.959017 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=58943
W20240125 12:23:14.438194  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240125 12:23:14.438921 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240125 12:23:14.959911 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=56573
W20240125 12:23:15.438313  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240125 12:23:15.540629 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240125 12:23:15.973222 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=303
W20240125 12:23:16.440857  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.173 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 131.235 ms                | 689.437 ms                |
| ProcessOneStep            | 230.157 ms                | 3.840 s                   |
| BlockToStepN              | 135.026 ms                | 763.903 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.095 ms                 | 374.125 ms                |
| Forward                   | 15.304 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 230.266 ms                | 3.840 s                   |
| BlockToStepN              | 135.238 ms                | 764.117 ms                |
| OneStep                   | 604.400 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:16.977672 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=136227
W20240125 12:23:17.069382 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240125 12:23:17.641364  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240125 12:23:17.977217 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=14790
W20240125 12:23:18.359688 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240125 12:23:18.641175  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240125 12:23:18.977020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=46197
W20240125 12:23:19.574905 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
E20240125 12:23:19.978271 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=100207
W20240125 12:23:20.284010  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240125 12:23:20.577348 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240125 12:23:21.014531 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=145473
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.362 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.121 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 130.835 ms                | 689.437 ms                |
| ProcessOneStep            | 229.223 ms                | 3.840 s                   |
| BlockToStepN              | 135.026 ms                | 964.294 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:21.806962  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.429 ms                 | 374.125 ms                |
| Forward                   | 15.304 ms                 | 57.559 ms                 |
| Backward                  | 10.636 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 229.300 ms                | 3.840 s                   |
| BlockToStepN              | 135.238 ms                | 964.517 ms                |
| OneStep                   | 611.573 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:22.014016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=13788
W20240125 12:23:22.157914 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240125 12:23:22.806242  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
E20240125 12:23:23.014022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=65752
W20240125 12:23:23.214941 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
[proc 0] 200 steps, total: 73.800, sample: 5.465, forward: 1.678, backward: 1.504, update: 0.576
[proc 3] 200 steps, total: 73.794, sample: 2.230, forward: 1.068, backward: 1.244, update: 0.464
[proc 2] 200 steps, total: 73.818, sample: 2.284, forward: 1.376, backward: 1.242, update: 0.658
[proc 1] 200 steps, total: 73.818, sample: 2.176, forward: 1.331, backward: 1.347, update: 0.571
[proc 5] 200 steps, total: 73.830, sample: 2.130, forward: 1.169, backward: 1.382, update: 0.540
[proc 4] 200 steps, total: 73.818, sample: 2.335, forward: 1.317, backward: 1.274, update: 0.447
[proc 6] 200 steps, total: 73.820, sample: 2.242, forward: 1.251, backward: 1.203, update: 0.429
[proc 7] 200 steps, total: 73.820, sample: 2.300, forward: 1.218, backward: 1.285, update: 0.436
W20240125 12:23:23.806398  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=201
E20240125 12:23:24.014014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=17337
W20240125 12:23:24.292243 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240125 12:23:25.002743  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=202, pq.top=202
E20240125 12:23:25.014016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=4021
W20240125 12:23:25.759979 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240125 12:23:26.014020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=43210
W20240125 12:23:26.557178  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.362 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.117 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 131.120 ms                | 689.437 ms                |
| ProcessOneStep            | 229.223 ms                | 3.840 s                   |
| BlockToStepN              | 141.031 ms                | 976.461 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.429 ms                 | 374.125 ms                |
| Forward                   | 14.175 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 229.300 ms                | 3.840 s                   |
| BlockToStepN              | 143.408 ms                | 976.726 ms                |
| OneStep                   | 612.587 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:27.017848 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:23:27.157631 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
W20240125 12:23:27.561926  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
E20240125 12:23:28.023597 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=93
W20240125 12:23:28.573268  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240125 12:23:28.619370 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
E20240125 12:23:29.023022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=231
W20240125 12:23:29.580919  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
E20240125 12:23:30.023483 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=25907
W20240125 12:23:30.107194 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240125 12:23:30.580263  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240125 12:23:31.026751 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=74696
W20240125 12:23:31.587031  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240125 12:23:31.633234 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.616 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 126.900 ms                | 689.437 ms                |
| ProcessOneStep            | 228.973 ms                | 3.840 s                   |
| BlockToStepN              | 143.204 ms                | 976.461 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.120 ms                 | 374.125 ms                |
| Forward                   | 14.240 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 229.062 ms                | 3.840 s                   |
| BlockToStepN              | 148.056 ms                | 976.726 ms                |
| OneStep                   | 612.587 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:32.023088  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=389
W20240125 12:23:32.649994  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
E20240125 12:23:33.023013 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=18769
W20240125 12:23:33.649062  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240125 12:23:33.745186 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240125 12:23:34.028847 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=56729
W20240125 12:23:34.993227 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
E20240125 12:23:35.028017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5221
E20240125 12:23:36.029417 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:23:36.038187 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.872 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 24.015 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 123.795 ms                | 689.437 ms                |
| ProcessOneStep            | 228.973 ms                | 3.840 s                   |
| BlockToStepN              | 143.204 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:36.866243  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.429 ms                 | 374.125 ms                |
| Forward                   | 15.304 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.371 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 229.062 ms                | 3.840 s                   |
| BlockToStepN              | 143.408 ms                | 1.099 s                   |
| OneStep                   | 612.587 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:37.032557 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=39398
W20240125 12:23:37.070679 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 12:23:37.870659  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240125 12:23:38.034327 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=29896
W20240125 12:23:38.152698 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 12:23:38.908463  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240125 12:23:39.034081 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=14093
W20240125 12:23:39.180493 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 12:23:40.034243  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=6450
W20240125 12:23:40.124521  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240125 12:23:40.322911 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240125 12:23:41.034020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=127020
W20240125 12:23:41.124661  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240125 12:23:41.503674 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.957 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.770 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 122.007 ms                | 679.480 ms                |
| ProcessOneStep            | 224.891 ms                | 3.840 s                   |
| BlockToStepN              | 143.204 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.033 ms                 | 374.125 ms                |
| Forward                   | 14.175 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.357 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 225.077 ms                | 3.840 s                   |
| BlockToStepN              | 143.408 ms                | 1.099 s                   |
| OneStep                   | 604.400 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:42.040150 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=171142
W20240125 12:23:42.127506  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240125 12:23:42.794688 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240125 12:23:43.048861 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=235196
W20240125 12:23:43.345276  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
E20240125 12:23:44.048027 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=20136
W20240125 12:23:44.177879 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
W20240125 12:23:44.355186  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
E20240125 12:23:45.048331 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=47851
W20240125 12:23:45.220244 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240125 12:23:46.048017  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
W20240125 12:23:46.097841  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=230
W20240125 12:23:46.265937 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.872 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.615 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 120.726 ms                | 679.480 ms                |
| ProcessOneStep            | 224.891 ms                | 3.840 s                   |
| BlockToStepN              | 147.816 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.644 ms                 | 378.435 ms                |
| Forward                   | 14.144 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 65.650 ms                 |
| Optimize                  | 4.361 ms                  | 42.900 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 224.962 ms                | 3.840 s                   |
| BlockToStepN              | 148.674 ms                | 1.213 s                   |
| OneStep                   | 612.587 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:47.048775  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:23:47.169154  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240125 12:23:47.376297 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240125 12:23:48.062379 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=27659
W20240125 12:23:48.466416 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 12:23:48.466506  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=232
E20240125 12:23:49.062963  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240125 12:23:49.601652 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 12:23:49.605270  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
E20240125 12:23:50.064857 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
W20240125 12:23:50.620052  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240125 12:23:50.707921 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240125 12:23:51.064376 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5374
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.770 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 121.008 ms                | 679.480 ms                |
| ProcessOneStep            | 224.926 ms                | 3.840 s                   |
| BlockToStepN              | 149.837 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:51.813959 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.033 ms                 | 378.435 ms                |
| Forward                   | 14.175 ms                 | 57.559 ms                 |
| Backward                  | 11.124 ms                 | 65.650 ms                 |
| Optimize                  | 4.356 ms                  | 42.900 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 118.236 ms                |
| AfterBackward             | 225.077 ms                | 3.840 s                   |
| BlockToStepN              | 150.053 ms                | 1.213 s                   |
| OneStep                   | 613.579 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:23:52.064014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=14436
W20240125 12:23:52.119443  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
E20240125 12:23:53.064195 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=48569
W20240125 12:23:53.068759 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240125 12:23:53.453634  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
E20240125 12:23:54.068945 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=41585
W20240125 12:23:54.158825 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 12:23:54.507618  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
E20240125 12:23:55.068025 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=12627
W20240125 12:23:55.281950 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 12:23:55.563463  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=244, pq.top=244
E20240125 12:23:56.068018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=29782
W20240125 12:23:56.518615 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.616 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.737 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 121.008 ms                | 679.480 ms                |
| ProcessOneStep            | 224.926 ms                | 3.840 s                   |
| BlockToStepN              | 156.310 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.120 ms                 | 378.435 ms                |
| Forward                   | 13.992 ms                 | 57.559 ms                 |
| Backward                  | 11.124 ms                 | 65.650 ms                 |
| Optimize                  | 4.336 ms                  | 42.900 ms                 |
| BarrierTimeBeforeRank0    | 177.656 us                | 118.236 ms                |
| AfterBackward             | 225.077 ms                | 3.840 s                   |
| BlockToStepN              | 156.581 ms                | 1.213 s                   |
| OneStep                   | 612.587 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:23:56.994024  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240125 12:23:57.068020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=204
W20240125 12:23:57.740213 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
E20240125 12:23:58.068019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=67391
W20240125 12:23:58.218384  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240125 12:23:58.988931 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240125 12:23:59.068032 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=128778
W20240125 12:23:59.219379  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=251, pq.top=251
E20240125 12:24:00.068025 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=193229
W20240125 12:24:00.219269  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240125 12:24:00.250017 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
E20240125 12:24:01.068018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=251729
W20240125 12:24:01.219841  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240125 12:24:01.382864 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.616 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.737 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 118.745 ms                | 679.480 ms                |
| ProcessOneStep            | 218.923 ms                | 3.741 s                   |
| BlockToStepN              | 156.310 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.120 ms                 | 374.125 ms                |
| Forward                   | 14.144 ms                 | 50.041 ms                 |
| Backward                  | 10.757 ms                 | 45.983 ms                 |
| Optimize                  | 4.336 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 132.859 us                | 103.102 ms                |
| AfterBackward             | 219.016 ms                | 3.741 s                   |
| BlockToStepN              | 156.581 ms                | 1.099 s                   |
| OneStep                   | 611.573 ms                | 4.121 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:02.071837 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=297359
W20240125 12:24:02.230585  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240125 12:24:02.867110 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
E20240125 12:24:03.072868 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=342066
W20240125 12:24:03.396759  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
E20240125 12:24:04.072031 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=387874
W20240125 12:24:04.729580 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240125 12:24:05.072014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240125 12:24:05.183079  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240125 12:24:05.738710 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
E20240125 12:24:06.073382 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=49608
W20240125 12:24:06.183499  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.404 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.605 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 116.829 ms                | 679.480 ms                |
| ProcessOneStep            | 217.333 ms                | 3.741 s                   |
| BlockToStepN              | 156.310 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:06.881213 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.429 ms                 | 378.435 ms                |
| Forward                   | 13.805 ms                 | 50.041 ms                 |
| Backward                  | 10.757 ms                 | 45.983 ms                 |
| Optimize                  | 4.332 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 103.102 ms                |
| AfterBackward             | 217.435 ms                | 3.741 s                   |
| BlockToStepN              | 156.581 ms                | 1.099 s                   |
| OneStep                   | 608.496 ms                | 4.121 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:07.076870 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=82492
W20240125 12:24:07.183908  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240125 12:24:08.084945 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=111838
W20240125 12:24:08.184108  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240125 12:24:09.084141 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=116644
W20240125 12:24:09.185022  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240125 12:24:10.004001 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 12:24:10.084848 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=128523
E20240125 12:24:11.084013  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=57
W20240125 12:24:11.101439  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240125 12:24:11.346117 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.404 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.495 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 117.746 ms                | 686.669 ms                |
| ProcessOneStep            | 218.094 ms                | 3.741 s                   |
| BlockToStepN              | 156.819 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.120 ms                 | 378.435 ms                |
| Forward                   | 13.805 ms                 | 50.041 ms                 |
| Backward                  | 10.713 ms                 | 45.983 ms                 |
| Optimize                  | 4.324 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.961 us                | 103.102 ms                |
| AfterBackward             | 218.194 ms                | 3.741 s                   |
| BlockToStepN              | 160.509 ms                | 1.213 s                   |
| OneStep                   | 610.544 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:12.084277 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64306
W20240125 12:24:12.359887  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240125 12:24:12.434321 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 12:24:13.084012 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=57765
W20240125 12:24:13.580107 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 12:24:13.711114  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240125 12:24:14.084025 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=38941
W20240125 12:24:14.608222 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 12:24:14.755044  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
E20240125 12:24:15.084017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=39088
W20240125 12:24:15.651211 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 12:24:15.859359  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
E20240125 12:24:16.084017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=122404
W20240125 12:24:16.720093 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.335 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.375 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 116.425 ms                | 686.669 ms                |
| ProcessOneStep            | 218.094 ms                | 3.741 s                   |
| BlockToStepN              | 156.819 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.095 ms                 | 378.435 ms                |
| Forward                   | 13.805 ms                 | 50.041 ms                 |
| Backward                  | 10.713 ms                 | 45.983 ms                 |
| Optimize                  | 4.324 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.340 us                | 103.102 ms                |
| AfterBackward             | 218.194 ms                | 3.741 s                   |
| BlockToStepN              | 160.509 ms                | 1.213 s                   |
| OneStep                   | 604.400 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:17.086810 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=183130
W20240125 12:24:17.479523  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240125 12:24:17.834254 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240125 12:24:18.086434 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=33458
W20240125 12:24:18.491320  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240125 12:24:18.913537 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 12:24:19.088845 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=78289
W20240125 12:24:19.749915  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=278
W20240125 12:24:20.085911 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 12:24:20.096277 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=53127
W20240125 12:24:20.965267  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240125 12:24:21.096014 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=36160
W20240125 12:24:21.412950 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.404 ms                 | 106.306 ms                |
| ProcessBack:UpdateCache   | 23.168 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 116.351 ms                | 679.480 ms                |
| ProcessOneStep            | 218.094 ms                | 3.741 s                   |
| BlockToStepN              | 160.290 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.291 ms                 | 378.435 ms                |
| Forward                   | 13.992 ms                 | 57.559 ms                 |
| Backward                  | 10.636 ms                 | 45.983 ms                 |
| Optimize                  | 4.332 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 120.143 ms                |
| AfterBackward             | 218.194 ms                | 3.741 s                   |
| BlockToStepN              | 157.040 ms                | 1.213 s                   |
| OneStep                   | 600.014 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:22.096765  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=8126
W20240125 12:24:22.215715  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240125 12:24:22.506601 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 12:24:23.097337  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240125 12:24:23.319262  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240125 12:24:23.519567 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 12:24:24.097018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=231
W20240125 12:24:24.321033  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240125 12:24:24.661140 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 12:24:25.099551 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=59794
W20240125 12:24:25.344960  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240125 12:24:25.691536 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240125 12:24:26.099012  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=90
W20240125 12:24:26.360102  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.616 ms                 | 106.306 ms                |
| ProcessBack:UpdateCache   | 22.986 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 114.254 ms                | 679.480 ms                |
| ProcessOneStep            | 217.171 ms                | 3.741 s                   |
| BlockToStepN              | 170.156 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:26.839977 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.773 ms                 | 378.435 ms                |
| Forward                   | 14.240 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 45.983 ms                 |
| Optimize                  | 4.332 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 121.594 us                | 120.143 ms                |
| AfterBackward             | 217.191 ms                | 3.741 s                   |
| BlockToStepN              | 160.509 ms                | 1.213 s                   |
| OneStep                   | 596.561 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:27.099015 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=188512
W20240125 12:24:27.593950  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240125 12:24:28.097216 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
E20240125 12:24:28.108860 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=233151
W20240125 12:24:28.676533  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
E20240125 12:24:29.108021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=266051
W20240125 12:24:29.529713 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
W20240125 12:24:29.905876  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
E20240125 12:24:30.120887 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=301613
W20240125 12:24:30.632184 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
W20240125 12:24:31.057205  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=299
E20240125 12:24:31.120891 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=350423
[proc 4] 300 steps, total: 68.047, sample: 2.064, forward: 1.180, backward: 1.410, update: 0.413
[proc 2] 300 steps, total: 68.059, sample: 1.859, forward: 1.071, backward: 1.299, update: 0.409
[proc 7] 300 steps, total: 68.047, sample: 2.196, forward: 1.341, backward: 1.377, update: 0.433
[proc 1] 300 steps, total: 68.047, sample: 2.147, forward: 1.165, backward: 1.537, update: 0.472
[proc 5] 300 steps, total: 68.047, sample: 2.268, forward: 1.284, backward: 1.273, update: 0.475
[proc 6] 300 steps, total: 68.060, sample: 2.029, forward: 1.311, backward: 1.218, update: 0.392
[proc 3] 300 steps, total: 68.090, sample: 2.120, forward: 1.108, backward: 1.416, update: 0.481
[proc 0] 300 steps, total: 68.090, sample: 6.251, forward: 1.705, backward: 1.371, update: 0.527
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.382 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.168 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 112.148 ms                | 679.480 ms                |
| ProcessOneStep            | 214.220 ms                | 3.741 s                   |
| BlockToStepN              | 160.290 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:31.820448 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.834 ms                 | 410.349 ms                |
| Forward                   | 14.240 ms                 | 57.559 ms                 |
| Backward                  | 10.862 ms                 | 45.983 ms                 |
| Optimize                  | 4.332 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.961 us                | 120.143 ms                |
| AfterBackward             | 214.355 ms                | 3.741 s                   |
| BlockToStepN              | 160.509 ms                | 1.213 s                   |
| OneStep                   | 584.961 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:32.058262  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240125 12:24:32.120013 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=382760
W20240125 12:24:32.867686 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240125 12:24:33.063155  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240125 12:24:33.120013 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=428815
W20240125 12:24:34.066463  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
E20240125 12:24:34.125699 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=462247
W20240125 12:24:34.160830 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240125 12:24:35.067394  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
E20240125 12:24:35.128885 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=485608
W20240125 12:24:35.449609 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240125 12:24:36.128021 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=519428
W20240125 12:24:36.269992  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.382 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.044 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 113.389 ms                | 679.480 ms                |
| ProcessOneStep            | 217.085 ms                | 3.741 s                   |
| BlockToStepN              | 170.156 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.834 ms                 | 410.349 ms                |
| Forward                   | 14.175 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 45.983 ms                 |
| Optimize                  | 4.315 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.961 us                | 120.143 ms                |
| AfterBackward             | 217.191 ms                | 3.741 s                   |
| BlockToStepN              | 170.392 ms                | 1.213 s                   |
| OneStep                   | 588.989 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:37.133028 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=547156
W20240125 12:24:37.547183 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
W20240125 12:24:38.077867  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240125 12:24:38.133018 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=554405
W20240125 12:24:38.662652 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240125 12:24:39.133013  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=4543
W20240125 12:24:39.250226  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
E20240125 12:24:40.133420 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=3407
W20240125 12:24:40.182837 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
E20240125 12:24:41.133041 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=33919
W20240125 12:24:41.408241 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 114.606 ms                | 679.480 ms                |
| ProcessOneStep            | 217.171 ms                | 3.741 s                   |
| BlockToStepN              | 170.156 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.291 ms                 | 532.525 ms                |
| Forward                   | 14.144 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 45.983 ms                 |
| Optimize                  | 4.314 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.340 us                | 120.143 ms                |
| AfterBackward             | 217.245 ms                | 3.741 s                   |
| BlockToStepN              | 170.392 ms                | 1.213 s                   |
| OneStep                   | 588.989 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:42.136878 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=62124
W20240125 12:24:42.410691 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 12:24:43.089129  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 12:24:43.146819 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=86136
W20240125 12:24:44.101364  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 12:24:44.151530 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=86590
W20240125 12:24:45.108135  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 12:24:45.152706 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=87130
W20240125 12:24:46.118207  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 12:24:46.152467 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=87643
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.401 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 114.254 ms                | 679.480 ms                |
| ProcessOneStep            | 217.171 ms                | 3.741 s                   |
| BlockToStepN              | 170.156 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.291 ms                 | 532.525 ms                |
| Forward                   | 14.144 ms                 | 57.559 ms                 |
| Backward                  | 10.722 ms                 | 45.983 ms                 |
| Optimize                  | 4.314 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.340 us                | 120.143 ms                |
| AfterBackward             | 217.245 ms                | 3.741 s                   |
| BlockToStepN              | 170.392 ms                | 1.213 s                   |
| OneStep                   | 588.989 ms                | 4.484 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:47.119338  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 12:24:47.161224 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=88201
W20240125 12:24:47.544124 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 12:24:48.161015  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=10818
W20240125 12:24:48.260654  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=314
E20240125 12:24:49.161926 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=131644
W20240125 12:24:49.260367  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240125 12:24:49.587059 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 12:24:50.161016 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=197499
W20240125 12:24:50.266535  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240125 12:24:50.596305 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:24:51.161262 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=15583
W20240125 12:24:51.269794  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.404 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 23.375 ms                 | 82.966 ms                 |
| ProcessBack:UpsertPq      | 113.389 ms                | 679.480 ms                |
| ProcessOneStep            | 217.171 ms                | 3.741 s                   |
| BlockToStepN              | 170.156 ms                | 1.720 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 26.299 ms                 | 532.525 ms                |
| Forward                   | 14.240 ms                 | 57.559 ms                 |
| Backward                  | 10.757 ms                 | 45.983 ms                 |
| Optimize                  | 4.315 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 120.143 ms                |
| AfterBackward             | 217.245 ms                | 3.741 s                   |
| BlockToStepN              | 170.392 ms                | 1.721 s                   |
| OneStep                   | 584.961 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:24:52.161135 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=21508
W20240125 12:24:52.293583  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240125 12:24:52.842995 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 12:24:53.161031 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=45404
W20240125 12:24:53.466491  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240125 12:24:53.844895 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 12:24:54.161018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=216
W20240125 12:24:54.466535  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240125 12:24:54.890885 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 12:24:55.161020 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=191917
W20240125 12:24:55.539526  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240125 12:24:55.933106 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 12:24:56.162086 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=24153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.335 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.270 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 112.147 ms                | 615.673 ms                |
| ProcessOneStep            | 214.220 ms                | 3.741 s                   |
| BlockToStepN              | 170.615 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:56.964876 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.834 ms                 | 532.525 ms                |
| Forward                   | 14.264 ms                 | 57.559 ms                 |
| Backward                  | 10.713 ms                 | 45.983 ms                 |
| Optimize                  | 4.310 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.340 us                | 120.143 ms                |
| AfterBackward             | 214.355 ms                | 3.741 s                   |
| BlockToStepN              | 174.145 ms                | 1.812 s                   |
| OneStep                   | 584.961 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:24:57.037654  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=326
E20240125 12:24:57.162014 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=24577
W20240125 12:24:58.006525 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 12:24:58.162015  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=3849
W20240125 12:24:58.239470  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240125 12:24:59.070205 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 12:24:59.168852  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=5261
W20240125 12:24:59.248013  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240125 12:25:00.094914 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240125 12:25:00.168021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=88
W20240125 12:25:00.305456  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240125 12:25:01.154440 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240125 12:25:01.168015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=210549
W20240125 12:25:01.307025  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.236 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 112.148 ms                | 615.673 ms                |
| ProcessOneStep            | 210.840 ms                | 3.741 s                   |
| BlockToStepN              | 170.615 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.547 ms                 | 532.525 ms                |
| Forward                   | 14.818 ms                 | 57.559 ms                 |
| Backward                  | 10.636 ms                 | 45.983 ms                 |
| Optimize                  | 4.297 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 116.340 us                | 120.143 ms                |
| AfterBackward             | 211.827 ms                | 3.741 s                   |
| BlockToStepN              | 174.145 ms                | 1.812 s                   |
| OneStep                   | 584.145 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:02.168143 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=272391
W20240125 12:25:02.244845 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240125 12:25:02.311054  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=337
E20240125 12:25:03.172878 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=303930
W20240125 12:25:03.321228  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240125 12:25:03.343197 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240125 12:25:04.180920 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=347361
W20240125 12:25:04.427934 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
W20240125 12:25:04.444314  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=341
E20240125 12:25:05.184967 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=387838
W20240125 12:25:05.709075 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
W20240125 12:25:05.731777  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240125 12:25:06.184026 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=24968
W20240125 12:25:06.733531  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 25.032 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.236 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 113.087 ms                | 615.673 ms                |
| ProcessOneStep            | 217.085 ms                | 3.741 s                   |
| BlockToStepN              | 170.615 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:06.774724 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.453 ms                 | 532.525 ms                |
| Forward                   | 14.818 ms                 | 57.559 ms                 |
| Backward                  | 10.636 ms                 | 45.983 ms                 |
| Optimize                  | 4.294 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 107.806 us                | 120.143 ms                |
| AfterBackward             | 217.191 ms                | 3.741 s                   |
| BlockToStepN              | 174.145 ms                | 1.812 s                   |
| OneStep                   | 584.145 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:07.188266 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=58698
W20240125 12:25:07.734261  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240125 12:25:08.188032 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=63883
W20240125 12:25:08.736310  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240125 12:25:09.188115 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=70484
W20240125 12:25:09.737139  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240125 12:25:09.943051 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 12:25:10.188019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=85346
W20240125 12:25:10.740609  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240125 12:25:10.961077 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 12:25:11.188014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=157514
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 112.147 ms                | 615.673 ms                |
| ProcessOneStep            | 211.760 ms                | 3.741 s                   |
| BlockToStepN              | 170.615 ms                | 1.956 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:11.928483  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240125 12:25:11.965751 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.034 ms                 | 532.525 ms                |
| Forward                   | 14.818 ms                 | 57.559 ms                 |
| Backward                  | 10.463 ms                 | 45.983 ms                 |
| Optimize                  | 4.294 ms                  | 36.879 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 120.143 ms                |
| AfterBackward             | 211.827 ms                | 3.741 s                   |
| BlockToStepN              | 174.145 ms                | 1.956 s                   |
| OneStep                   | 583.686 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:12.188019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=246641
W20240125 12:25:12.940150  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240125 12:25:13.032223 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 12:25:13.188021 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=304684
W20240125 12:25:14.045439 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240125 12:25:14.101312  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=354, pq.top=354
E20240125 12:25:14.188864 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=353969
W20240125 12:25:15.104703  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240125 12:25:15.111359 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 12:25:15.188014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=57476
W20240125 12:25:16.104291  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240125 12:25:16.192898 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=68509
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.236 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 110.730 ms                | 615.673 ms                |
| ProcessOneStep            | 208.992 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.120 ms                 | 410.349 ms                |
| Forward                   | 14.818 ms                 | 57.378 ms                 |
| Backward                  | 10.463 ms                 | 44.961 ms                 |
| Optimize                  | 4.291 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 209.086 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 1.812 s                   |
| OneStep                   | 576.627 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:17.106817  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240125 12:25:17.218317 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=72331
W20240125 12:25:17.290354 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 12:25:18.107707  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240125 12:25:18.228994 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=139603
W20240125 12:25:18.292856 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 12:25:19.109714  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240125 12:25:19.228018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=22218
W20240125 12:25:19.304520 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:25:20.340410  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240125 12:25:20.437436 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 12:25:20.740667  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240125 12:25:21.344362 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=63285
W20240125 12:25:21.584782 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 12:25:21.740485  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.257 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 109.887 ms                | 615.673 ms                |
| ProcessOneStep            | 210.840 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 1.956 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.033 ms                 | 410.349 ms                |
| Forward                   | 14.543 ms                 | 57.378 ms                 |
| Backward                  | 10.581 ms                 | 44.961 ms                 |
| Optimize                  | 4.291 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 110.837 us                | 118.236 ms                |
| AfterBackward             | 210.993 ms                | 3.247 s                   |
| BlockToStepN              | 174.145 ms                | 1.956 s                   |
| OneStep                   | 577.234 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:22.344015 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=131875
W20240125 12:25:22.628495 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240125 12:25:22.923419  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240125 12:25:23.344015 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=194460
W20240125 12:25:23.744678 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240125 12:25:24.333298  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=369, pq.top=369
E20240125 12:25:24.348906 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=250799
W20240125 12:25:24.768422 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240125 12:25:25.348500 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=303563
W20240125 12:25:25.502554  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240125 12:25:25.843991 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
E20240125 12:25:26.356778 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=351882
W20240125 12:25:26.706085  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 23.236 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 109.887 ms                | 615.673 ms                |
| ProcessOneStep            | 210.840 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 1.956 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:26.877910 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.800 ms                 | 410.349 ms                |
| Forward                   | 14.818 ms                 | 57.378 ms                 |
| Backward                  | 10.463 ms                 | 44.961 ms                 |
| Optimize                  | 4.288 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 210.993 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 1.956 s                   |
| OneStep                   | 577.234 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:27.356490  9804 parallel_pq_v2.h:76] insert failed, size(hashtable)=34
W20240125 12:25:27.925875 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
W20240125 12:25:28.073449  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 12:25:28.356014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=15893
W20240125 12:25:28.985201 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 12:25:29.073738  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 12:25:29.365046 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=46063
W20240125 12:25:30.078135  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 12:25:30.368903 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=51154
W20240125 12:25:31.079802  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 12:25:31.385130 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=55374
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.995 ms                 | 143.252 ms                |
| ProcessBack:UpdateCache   | 23.257 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 110.265 ms                | 615.673 ms                |
| ProcessOneStep            | 210.840 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 1.956 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.025 ms                 | 410.349 ms                |
| Forward                   | 14.750 ms                 | 57.378 ms                 |
| Backward                  | 10.444 ms                 | 44.961 ms                 |
| Optimize                  | 4.287 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 110.837 us                | 118.236 ms                |
| AfterBackward             | 210.993 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 1.956 s                   |
| OneStep                   | 577.234 ms                | 4.614 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:32.084935  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240125 12:25:32.353109 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 12:25:32.387729 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=62888
E20240125 12:25:33.472862 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=10724
W20240125 12:25:33.527329  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=376
W20240125 12:25:33.587635 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 12:25:34.472028 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=68277
W20240125 12:25:34.594619 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 12:25:34.786298  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240125 12:25:35.472781 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=142923
W20240125 12:25:35.613502 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 12:25:35.794927  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240125 12:25:36.472014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1034
W20240125 12:25:36.654685 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.923 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.257 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 109.887 ms                | 615.673 ms                |
| ProcessOneStep            | 211.019 ms                | 3.246 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:36.873644  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.800 ms                 | 410.349 ms                |
| Forward                   | 15.128 ms                 | 57.378 ms                 |
| Backward                  | 10.426 ms                 | 44.961 ms                 |
| Optimize                  | 4.278 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 112.629 us                | 118.236 ms                |
| AfterBackward             | 210.993 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 2.843 s                   |
| OneStep                   | 577.234 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:37.472047 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=285002
W20240125 12:25:37.753347 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
W20240125 12:25:38.133405  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=386
E20240125 12:25:38.472030 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=330048
W20240125 12:25:38.769413 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240125 12:25:39.135424  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=389
E20240125 12:25:39.472016 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=360341
W20240125 12:25:39.988385 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
E20240125 12:25:40.476857 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=397144
W20240125 12:25:40.657616  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240125 12:25:41.156555 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
E20240125 12:25:41.477445 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=428409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.692 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.236 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 109.119 ms                | 615.673 ms                |
| ProcessOneStep            | 208.992 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:41.785939  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.025 ms                 | 410.349 ms                |
| Forward                   | 15.128 ms                 | 57.378 ms                 |
| Backward                  | 10.207 ms                 | 44.961 ms                 |
| Optimize                  | 4.281 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 110.837 us                | 118.236 ms                |
| AfterBackward             | 209.086 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 2.843 s                   |
| OneStep                   | 577.234 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:42.200691 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
E20240125 12:25:42.477028 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=466535
W20240125 12:25:42.787025  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=395, pq.top=395
E20240125 12:25:43.478488 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=496163
W20240125 12:25:43.589092 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
W20240125 12:25:43.968644  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
E20240125 12:25:44.478025 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=532631
W20240125 12:25:44.716722 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240125 12:25:45.044749  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=399, pq.top=399
E20240125 12:25:45.478018 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=551502
W20240125 12:25:45.738766 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240125 12:25:46.058122  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 2] 400 steps, total: 74.506, sample: 1.890, forward: 1.020, backward: 1.356, update: 0.530
[proc 7] 400 steps, total: 74.506, sample: 2.224, forward: 1.034, backward: 1.453, update: 0.522
[proc 6] 400 steps, total: 74.500, sample: 2.086, forward: 1.183, backward: 1.338, update: 0.383
[proc 1] 400 steps, total: 74.517, sample: 1.995, forward: 1.315, backward: 1.371, update: 0.458
[proc 0] 400 steps, total: 74.509, sample: 5.282, forward: 1.723, backward: 1.328, update: 0.520
[proc 3] 400 steps, total: 74.513, sample: 2.147, forward: 1.123, backward: 1.464, update: 0.458
[proc 5] 400 steps, total: 74.530, sample: 1.973, forward: 1.197, backward: 1.265, update: 0.405
[proc 4] 400 steps, total: 74.530, sample: 2.003, forward: 1.127, backward: 1.246, update: 0.405
E20240125 12:25:46.478017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=580000
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.270 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 108.042 ms                | 615.673 ms                |
| ProcessOneStep            | 208.992 ms                | 3.246 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.800 ms                 | 410.349 ms                |
| Forward                   | 14.750 ms                 | 57.378 ms                 |
| Backward                  | 10.260 ms                 | 44.961 ms                 |
| Optimize                  | 4.282 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.757 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 2.843 s                   |
| OneStep                   | 577.234 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:47.101003 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240125 12:25:47.346751  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240125 12:25:47.489066 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=630063
W20240125 12:25:48.304301 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
W20240125 12:25:48.357239  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=405
E20240125 12:25:48.489017 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=669920
W20240125 12:25:49.367583 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
E20240125 12:25:49.492872 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=4985
W20240125 12:25:49.503033  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240125 12:25:50.486558 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240125 12:25:50.492036 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=72507
W20240125 12:25:50.504957  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 12:25:51.492139 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=90364
W20240125 12:25:51.508579  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.376 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 107.453 ms                | 615.673 ms                |
| ProcessOneStep            | 208.678 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.832 ms                 | 410.349 ms                |
| Forward                   | 14.750 ms                 | 57.378 ms                 |
| Backward                  | 10.278 ms                 | 44.961 ms                 |
| Optimize                  | 4.288 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.757 ms                | 3.247 s                   |
| BlockToStepN              | 170.392 ms                | 2.843 s                   |
| OneStep                   | 577.234 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:25:52.505173 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=93406
W20240125 12:25:52.509967  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 12:25:53.509008 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=96736
W20240125 12:25:53.511569  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 12:25:54.508987 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=100045
W20240125 12:25:54.511963  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240125 12:25:55.512261  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 12:25:55.528434 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=102943
E20240125 12:25:56.528124 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=105189
W20240125 12:25:56.543877  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.737 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.376 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 107.453 ms                | 615.673 ms                |
| ProcessOneStep            | 208.678 ms                | 3.246 s                   |
| BlockToStepN              | 170.156 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.832 ms                 | 410.349 ms                |
| Forward                   | 14.750 ms                 | 57.378 ms                 |
| Backward                  | 10.278 ms                 | 44.961 ms                 |
| Optimize                  | 4.288 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.757 ms                | 3.247 s                   |
| BlockToStepN              | 174.145 ms                | 4.103 s                   |
| OneStep                   | 583.686 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:25:57.024188 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 12:25:57.600258 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1404
W20240125 12:25:57.696539  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=407
W20240125 12:25:58.698643  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=407
E20240125 12:25:58.826551 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1533
W20240125 12:25:58.853526 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:25:59.826014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=65922
W20240125 12:25:59.861625 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 12:26:00.052785  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240125 12:26:00.833844 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=5404
W20240125 12:26:00.930728 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 12:26:01.052677  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.576 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.270 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 106.448 ms                | 615.673 ms                |
| ProcessOneStep            | 208.552 ms                | 3.246 s                   |
| BlockToStepN              | 173.925 ms                | 4.103 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:01.836352 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=56130
W20240125 12:26:01.982755 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.800 ms                 | 410.349 ms                |
| Forward                   | 14.818 ms                 | 57.378 ms                 |
| Backward                  | 10.278 ms                 | 44.961 ms                 |
| Optimize                  | 4.288 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.618 ms                | 3.247 s                   |
| BlockToStepN              | 177.819 ms                | 4.103 s                   |
| OneStep                   | 583.686 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:02.082055  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=414
E20240125 12:26:02.836014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=112986
W20240125 12:26:03.013870 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 12:26:03.288529  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240125 12:26:03.836019 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=169362
W20240125 12:26:04.184470 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240125 12:26:04.288261  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=419
E20240125 12:26:04.836028 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=243379
W20240125 12:26:05.288059  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240125 12:26:05.304311 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240125 12:26:05.836024 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=301018
W20240125 12:26:06.339887 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 12:26:06.398757  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.556 ms                 | 139.537 ms                |
| ProcessBack:UpdateCache   | 23.495 ms                 | 78.361 ms                 |
| ProcessBack:UpsertPq      | 105.199 ms                | 615.673 ms                |
| ProcessOneStep            | 208.552 ms                | 3.246 s                   |
| BlockToStepN              | 170.615 ms                | 4.103 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:06.844967 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=36794
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.522 ms                 | 410.349 ms                |
| Forward                   | 15.128 ms                 | 57.378 ms                 |
| Backward                  | 10.444 ms                 | 44.961 ms                 |
| Optimize                  | 4.282 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.618 ms                | 3.247 s                   |
| BlockToStepN              | 174.145 ms                | 4.103 s                   |
| OneStep                   | 577.234 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:07.402674  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240125 12:26:07.849014 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=44396
W20240125 12:26:08.402542  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240125 12:26:08.561987 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 12:26:08.849020 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=68680
W20240125 12:26:09.627660  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240125 12:26:09.651064 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 12:26:09.852897 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=112769
W20240125 12:26:10.631659  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240125 12:26:10.714078 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 12:26:10.853338 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=25527
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.433 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.519 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 105.082 ms                | 597.657 ms                |
| ProcessOneStep            | 208.678 ms                | 3.246 s                   |
| BlockToStepN              | 173.925 ms                | 4.103 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:11.818441  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=428, pq.top=428
W20240125 12:26:11.843863 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:26:11.853024 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=65956
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.271 ms                 | 410.349 ms                |
| Forward                   | 15.128 ms                 | 57.378 ms                 |
| Backward                  | 10.260 ms                 | 44.961 ms                 |
| Optimize                  | 4.282 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 208.757 ms                | 3.247 s                   |
| BlockToStepN              | 174.145 ms                | 4.103 s                   |
| OneStep                   | 583.686 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:12.853029 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1319
W20240125 12:26:12.872167 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240125 12:26:13.168756  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240125 12:26:13.856948 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=39185
W20240125 12:26:14.060137 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 12:26:14.478492  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=432, pq.top=432
E20240125 12:26:14.856846 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=81870
W20240125 12:26:15.122968 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 12:26:15.482281  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=434, pq.top=434
E20240125 12:26:15.865214  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=11664
W20240125 12:26:16.183534 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 12:26:16.750389  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.476 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.376 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 105.297 ms                | 597.657 ms                |
| ProcessOneStep            | 208.992 ms                | 3.246 s                   |
| BlockToStepN              | 170.615 ms                | 4.103 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:16.869691 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=14027
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.255 ms                 | 410.349 ms                |
| Forward                   | 14.818 ms                 | 57.378 ms                 |
| Backward                  | 10.463 ms                 | 44.961 ms                 |
| Optimize                  | 4.281 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.806 us                | 118.236 ms                |
| AfterBackward             | 209.086 ms                | 3.247 s                   |
| BlockToStepN              | 174.145 ms                | 4.103 s                   |
| OneStep                   | 583.686 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:17.187939 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 12:26:17.753460  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
E20240125 12:26:17.869014 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=47900
W20240125 12:26:18.224380 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 12:26:18.869017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=510
W20240125 12:26:19.151837  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240125 12:26:19.276918 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 12:26:19.871685 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=121681
W20240125 12:26:20.154230  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240125 12:26:20.284152 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 12:26:20.880832 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=167718
W20240125 12:26:21.367760 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240125 12:26:21.670383  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.433 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.376 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 105.297 ms                | 597.657 ms                |
| ProcessOneStep            | 210.840 ms                | 3.246 s                   |
| BlockToStepN              | 170.615 ms                | 4.103 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:21.880014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=229404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.271 ms                 | 410.349 ms                |
| Forward                   | 14.750 ms                 | 57.378 ms                 |
| Backward                  | 10.444 ms                 | 44.961 ms                 |
| Optimize                  | 4.279 ms                  | 35.313 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 119.655 ms                |
| AfterBackward             | 210.993 ms                | 3.247 s                   |
| BlockToStepN              | 177.819 ms                | 4.103 s                   |
| OneStep                   | 583.991 ms                | 4.768 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:22.404203 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240125 12:26:22.884963  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=20941
W20240125 12:26:22.931281  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240125 12:26:23.457003 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 12:26:23.884085 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=315348
W20240125 12:26:24.274228  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=447, pq.top=446
W20240125 12:26:24.617028 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 12:26:24.884029 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=356676
W20240125 12:26:25.283855  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240125 12:26:25.621644 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
E20240125 12:26:25.885962 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=392815
W20240125 12:26:26.297036  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240125 12:26:26.646200 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.536 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.304 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 105.082 ms                | 597.657 ms                |
| ProcessOneStep            | 210.840 ms                | 3.199 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:26.892870 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=422388
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.103 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.278 ms                 | 39.690 ms                 |
| Optimize                  | 4.282 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 106.808 us                | 118.236 ms                |
| AfterBackward             | 210.993 ms                | 3.199 s                   |
| BlockToStepN              | 174.145 ms                | 2.843 s                   |
| OneStep                   | 583.991 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:27.549937  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=454
W20240125 12:26:27.757535 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240125 12:26:27.892917 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=464543
W20240125 12:26:28.560696  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240125 12:26:28.777348 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240125 12:26:28.892931  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240125 12:26:29.563549  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
E20240125 12:26:29.893712  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 12:26:30.122298 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240125 12:26:30.567776  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=459
E20240125 12:26:30.893019 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=564414
W20240125 12:26:31.352435 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240125 12:26:31.613448  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.536 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.304 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 104.138 ms                | 597.657 ms                |
| ProcessOneStep            | 211.019 ms                | 3.199 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:31.900909 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=736
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 23.072 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.260 ms                 | 39.690 ms                 |
| Optimize                  | 4.278 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 105.150 us                | 118.236 ms                |
| AfterBackward             | 211.135 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 583.991 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:32.533443 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240125 12:26:32.615535  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240125 12:26:32.900876 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=656006
W20240125 12:26:33.876664  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240125 12:26:33.900022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=690664
W20240125 12:26:33.912714 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240125 12:26:34.902801  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=3351
W20240125 12:26:35.055238  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240125 12:26:35.059420 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240125 12:26:35.902017 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=780073
W20240125 12:26:36.159677 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240125 12:26:36.358741  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.536 ms                 | 129.438 ms                |
| ProcessBack:UpdateCache   | 23.257 ms                 | 73.722 ms                 |
| ProcessBack:UpsertPq      | 103.277 ms                | 597.657 ms                |
| ProcessOneStep            | 210.840 ms                | 3.199 s                   |
| BlockToStepN              | 173.925 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:36.902046  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.742 ms                 | 404.766 ms                |
| Forward                   | 14.543 ms                 | 56.713 ms                 |
| Backward                  | 10.207 ms                 | 39.690 ms                 |
| Optimize                  | 4.266 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 107.615 us                | 118.236 ms                |
| AfterBackward             | 209.086 ms                | 3.199 s                   |
| BlockToStepN              | 174.145 ms                | 2.843 s                   |
| OneStep                   | 583.991 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:37.361864  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240125 12:26:37.398350 10828 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
E20240125 12:26:37.902200  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=5234
W20240125 12:26:38.598287 10828 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
W20240125 12:26:38.804996  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240125 12:26:38.902021 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=906600
W20240125 12:26:39.606958 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
W20240125 12:26:39.864027  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
E20240125 12:26:39.902017 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=956641
E20240125 12:26:40.902014  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=18981
W20240125 12:26:40.987253 10828 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
W20240125 12:26:41.013507  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.433 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 102.907 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:41.902014 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1043573
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.742 ms                 | 404.766 ms                |
| Forward                   | 14.818 ms                 | 56.713 ms                 |
| Backward                  | 10.234 ms                 | 39.690 ms                 |
| Optimize                  | 4.278 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.905 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 174.145 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:42.028123  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240125 12:26:42.054471 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240125 12:26:42.902016  9237 parallel_pq_v2.h:76] insert failed, size(hashtable)=8582
W20240125 12:26:43.047964  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=484
E20240125 12:26:43.902021 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1106712
W20240125 12:26:44.164256 10828 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
W20240125 12:26:44.237102  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=486
E20240125 12:26:44.908952 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1127313
W20240125 12:26:45.358239 10828 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240125 12:26:45.446766  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
E20240125 12:26:45.908017 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1177294
W20240125 12:26:46.388705 10828 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
W20240125 12:26:46.521206  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=490
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.419 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 101.696 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 170.615 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:46.924423 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1229928
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.742 ms                 | 404.766 ms                |
| Forward                   | 14.818 ms                 | 56.713 ms                 |
| Backward                  | 10.188 ms                 | 39.690 ms                 |
| Optimize                  | 4.279 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.144 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:47.525949  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240125 12:26:47.797672 10828 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240125 12:26:47.949505 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1269698
W20240125 12:26:48.590492  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240125 12:26:48.949018 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1298615
W20240125 12:26:49.310945 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
W20240125 12:26:49.687927  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240125 12:26:49.975240 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=1339332
W20240125 12:26:50.662402 10828 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240125 12:26:50.804888  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
E20240125 12:26:50.975018 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=1366393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.370 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 101.696 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 173.925 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 12:26:51.850143 10828 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240125 12:26:51.990022 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=5817
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.493 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.234 ms                 | 44.961 ms                 |
| Optimize                  | 4.279 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.905 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:53.000867 10828 parallel_pq_v2.h:76] insert failed, size(hashtable)=48252
W20240125 12:26:53.041934 10828 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240125 12:26:53.227308  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:26:54.019687 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=63169
W20240125 12:26:54.230057  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:26:55.019235 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=63443
W20240125 12:26:55.234637  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:26:56.024201 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=63720
W20240125 12:26:56.245811  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.370 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 101.115 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 173.925 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.493 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.234 ms                 | 44.961 ms                 |
| Optimize                  | 4.279 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.905 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:26:57.024742 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64004
W20240125 12:26:57.249857  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:26:58.034288 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64221
W20240125 12:26:58.258458  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:26:59.034209 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64478
W20240125 12:26:59.269039  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:00.035785 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64756
W20240125 12:27:00.273895  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:01.056360 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=64999
W20240125 12:27:01.276372  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.370 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 101.115 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 173.925 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.493 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.234 ms                 | 44.961 ms                 |
| Optimize                  | 4.279 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.905 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:27:02.065519 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=65213
W20240125 12:27:02.297010  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:03.073936 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=65365
W20240125 12:27:03.297631  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:04.073228 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=65561
W20240125 12:27:04.301265  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:05.085413 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=65811
W20240125 12:27:05.303254  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:06.110431 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=66005
W20240125 12:27:06.316817  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.370 ms                 | 114.530 ms                |
| ProcessBack:UpdateCache   | 23.176 ms                 | 73.527 ms                 |
| ProcessBack:UpsertPq      | 101.115 ms                | 568.978 ms                |
| ProcessOneStep            | 208.477 ms                | 3.199 s                   |
| BlockToStepN              | 173.925 ms                | 2.843 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.493 ms                 | 404.766 ms                |
| Forward                   | 14.750 ms                 | 56.713 ms                 |
| Backward                  | 10.234 ms                 | 44.961 ms                 |
| Optimize                  | 4.279 ms                  | 33.335 ms                 |
| BarrierTimeBeforeRank0    | 104.905 us                | 118.236 ms                |
| AfterBackward             | 208.544 ms                | 3.199 s                   |
| BlockToStepN              | 177.819 ms                | 2.843 s                   |
| OneStep                   | 581.713 ms                | 4.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 12:27:07.113257 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=66258
W20240125 12:27:07.304162  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:08.125974 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=66467
W20240125 12:27:08.307782  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:09.126394 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=66715
W20240125 12:27:09.308450  9237 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240125 12:27:10.136335 10827 parallel_pq_v2.h:76] insert failed, size(hashtable)=66923
[proc 6] 500 steps, total: 84.164, sample: 1.985, forward: 1.137, backward: 1.415, update: 0.367
[proc 2] 500 steps, total: 84.171, sample: 1.777, forward: 1.121, backward: 1.443, update: 0.408
[proc 1] 500 steps, total: 84.160, sample: 1.975, forward: 1.142, backward: 1.386, update: 0.426
[proc 5] 500 steps, total: 84.139, sample: 1.893, forward: 1.046, backward: 1.245, update: 0.433
[proc 3] 500 steps, total: 84.160, sample: 1.869, forward: 1.077, backward: 1.308, update: 0.473
[proc 0] 500 steps, total: 84.164, sample: 4.507, forward: 1.533, backward: 1.484, update: 0.452
Successfully xmh. training takes 373.6813876628876 seconds
before call kg_cache_controller.StopThreads()
W20240125 12:27:10.255533  9237 grad_async_v2.h:71] call StopThreads. PID = 38038
W20240125 12:27:10.255578  9237 grad_base.h:210] before processOneStepNegThread_.join();
[proc 7] 500 steps, total: 84.185, sample: 1.852, forward: 1.147, backward: 1.279, update: 0.409
W20240125 12:27:10.256194  9237 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 12:27:10.256224  9237 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
[proc 4] 500 steps, total: 84.140, sample: 1.942, forward: 1.037, backward: 1.373, update: 0.424
W20240125 12:27:10.264617  9237 grad_async_v2.h:91] StopThreads done.
