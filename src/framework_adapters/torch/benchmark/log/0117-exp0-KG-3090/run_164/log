WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 03:22:53.673180 63687 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_Freebase_19', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [63687 sampler.py:454] Start PreSampling
WARNING [63687 sampler.py:532] Before construct renumbering_dict
WARNING [63687 sampler.py:555] PreSampling done
W20240125 03:56:05.884831 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 03:56:05.885174 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 03:56:05.885236 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 03:56:05.885273 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 03:56:05.885311 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 03:56:05.885356 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 03:56:05.885393 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 03:56:05.885442 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 03:56:05.885479 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 03:56:05.885516 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 03:56:05.885562 63687 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 03:56:05.885598 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 03:56:05.885630 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 03:56:05.885852 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 03:56:05.885901 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 03:56:05.885941 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 03:56:05.886003 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 03:56:05.886031 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 03:56:05.886065 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 03:56:05.886094 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 03:56:05.886126 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 03:56:05.886162 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 03:56:05.886193 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 03:56:05.886225 63687 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 03:56:05.886252 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 03:56:05.886288 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 03:56:05.886380 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 03:56:05.886428 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 03:56:05.886458 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 03:56:05.886488 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 03:56:05.886516 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 03:56:05.886551 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 03:56:05.886595 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 03:56:05.886626 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 03:56:05.886665 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 03:56:05.886706 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 03:56:05.886739 63687 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 03:56:05.886765 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 03:56:05.886790 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 03:56:05.886868 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 03:56:05.886910 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 03:56:05.886945 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 03:56:05.886977 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 03:56:05.887013 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 03:56:05.887053 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 03:56:05.887094 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 03:56:05.887140 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 03:56:05.887187 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 03:56:05.887229 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 03:56:05.887259 63687 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 03:56:05.887282 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 03:56:05.887305 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 03:56:05.887378 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 03:56:05.887449 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 03:56:05.887483 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 03:56:05.887530 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 03:56:05.887566 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 03:56:05.887611 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 03:56:05.887651 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 03:56:05.887686 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 03:56:05.887717 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 03:56:05.887748 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 03:56:05.887784 63687 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 03:56:05.887809 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 03:56:05.887840 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 03:56:05.887915 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 03:56:05.887962 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 03:56:05.887992 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 03:56:05.888034 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 03:56:05.888072 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 03:56:05.888103 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 03:56:05.888152 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 03:56:05.888192 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 03:56:05.888223 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 03:56:05.888252 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 03:56:05.888290 63687 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 03:56:05.888314 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 03:56:05.888343 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 03:56:05.888425 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 03:56:05.888484 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 03:56:05.888516 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 03:56:05.888546 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 03:56:05.888577 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 03:56:05.888607 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 03:56:05.888638 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 03:56:05.888671 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 03:56:05.888710 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 03:56:05.888743 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 03:56:05.888779 63687 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 03:56:05.888832 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 03:56:05.888880 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 03:56:05.888954 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 03:56:05.888993 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 03:56:05.889026 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 03:56:05.889062 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 03:56:05.889096 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 03:56:05.889128 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 03:56:05.889166 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 03:56:05.889204 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 03:56:05.889243 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 03:56:05.889274 63687 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 03:56:05.889312 63687 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 03:56:05.889336 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 03:56:05.889360 63687 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 03:56:06.862403 63687 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240125 03:56:06.862677 63687 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302707,  4302737,  4302819,  ..., 64501859, 22388060, 35571821]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2726.354 seconds
[Rank1] pid = 36553
[Rank2] pid = 36674
[Rank3] pid = 36778
[Rank4] pid = 36885
[Rank5] pid = 36985
[Rank6] pid = 37084
INFO [63687 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [36553 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [36674 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [36778 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [36885 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [36985 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [37181 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [37084 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [36778 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37084 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37181 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36885 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36985 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [63687 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36553 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36674 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [37084 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36553 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36674 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36885 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36778 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [63687 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [37181 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36985 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 04:08:53.552469 36986 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.552613 37085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553428 36888 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553584 36554 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553666 37182 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553756 37197 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553848 36780 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:08:53.553956 36675 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 04:09:06.014539 37197 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 04:09:06.158193 36986 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:09.048075 36675 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:09.341079 37085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:10.667629 36554 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:11.364389 36780 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:12.055287 36888 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 04:09:12.512339 37182 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.481 ms                 | 14.481 ms                 |
| bucket keys               | 203.172 ms                | 203.172 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.525 ms                 | 18.392 ms                 |
| bucket keys               | 3.351 ms                  | 203.172 ms                |
| forward: a2a keys         | 7.967 ms                  | 1.771 s                   |
| forward: search cache     | 486.207 us                | 35.798 ms                 |
| forward: a2a values       | 11.345 ms                 | 73.165 ms                 |
| forward: join             | 3.753 ms                  | 4.136 ms                  |
| Forward                   | 97.299 ms                 | 2.680 s                   |
| back: aggr dram keys      | 62.694 ms                 | 1.195 s                   |
| back: set dram grad       | 3.440 ms                  | 12.358 ms                 |
| back: a2a grad            | 14.743 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 10.859 ms                 | 293.352 ms                |
| Backward                  | 548.853 ms                | 1.869 s                   |
| Optimize                  | 49.918 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 80.802 us                 | 166.092 us                |
| BlockToStepN              | 94.330 us                 | 116.396 us                |
| OneStep                   | 704.524 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.098 ms                 | 533.527 ms                |
| bucket keys               | 2.647 ms                  | 203.172 ms                |
| forward: a2a keys         | 5.908 ms                  | 1.771 s                   |
| forward: search cache     | 477.382 us                | 35.798 ms                 |
| forward: a2a values       | 11.345 ms                 | 73.165 ms                 |
| forward: join             | 3.625 ms                  | 4.570 ms                  |
| Forward                   | 84.000 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 1.195 s                   |
| back: set dram grad       | 3.537 ms                  | 12.358 ms                 |
| back: a2a grad            | 14.743 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 10.859 ms                 | 293.352 ms                |
| Backward                  | 498.583 ms                | 1.869 s                   |
| Optimize                  | 39.143 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 78.103 us                 | 166.092 us                |
| BlockToStepN              | 90.842 us                 | 130.485 us                |
| OneStep                   | 699.563 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.748 ms                  | 533.527 ms                |
| bucket keys               | 2.904 ms                  | 203.172 ms                |
| forward: a2a keys         | 4.725 ms                  | 1.771 s                   |
| forward: search cache     | 477.382 us                | 35.798 ms                 |
| forward: a2a values       | 30.596 ms                 | 73.165 ms                 |
| forward: join             | 3.625 ms                  | 4.570 ms                  |
| Forward                   | 82.792 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 1.195 s                   |
| back: set dram grad       | 3.647 ms                  | 12.358 ms                 |
| back: a2a grad            | 35.539 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 10.859 ms                 | 293.352 ms                |
| Backward                  | 487.433 ms                | 1.869 s                   |
| Optimize                  | 39.131 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 77.671 us                 | 166.092 us                |
| BlockToStepN              | 90.842 us                 | 30.892 ms                 |
| OneStep                   | 655.460 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.898 ms                  | 533.527 ms                |
| bucket keys               | 2.904 ms                  | 203.172 ms                |
| forward: a2a keys         | 4.709 ms                  | 1.771 s                   |
| forward: search cache     | 486.630 us                | 35.798 ms                 |
| forward: a2a values       | 30.596 ms                 | 73.165 ms                 |
| forward: join             | 3.625 ms                  | 4.570 ms                  |
| Forward                   | 82.792 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 1.195 s                   |
| back: set dram grad       | 4.156 ms                  | 13.644 ms                 |
| back: a2a grad            | 35.782 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 12.133 ms                 | 293.352 ms                |
| Backward                  | 499.318 ms                | 1.869 s                   |
| Optimize                  | 38.925 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 76.246 us                 | 166.092 us                |
| BlockToStepN              | 90.842 us                 | 30.892 ms                 |
| OneStep                   | 655.460 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.621 ms                  | 533.527 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.078 ms                  | 63.252 ms                 |
| forward: search cache     | 486.630 us                | 572.400 us                |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.625 ms                  | 4.554 ms                  |
| Forward                   | 77.755 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 13.965 ms                 |
| back: a2a grad            | 36.043 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 12.901 ms                 | 272.139 ms                |
| Backward                  | 504.186 ms                | 1.869 s                   |
| Optimize                  | 39.131 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 75.025 us                 | 166.092 us                |
| BlockToStepN              | 91.294 us                 | 47.070 ms                 |
| OneStep                   | 663.900 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.748 ms                  | 533.527 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.384 ms                  | 142.049 ms                |
| forward: search cache     | 485.704 us                | 574.149 us                |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.771 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 221.532 ms                |
| back: set dram grad       | 5.613 ms                  | 14.554 ms                 |
| back: a2a grad            | 36.043 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 12.901 ms                 | 272.139 ms                |
| Backward                  | 513.351 ms                | 1.869 s                   |
| Optimize                  | 39.143 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 74.936 us                 | 166.092 us                |
| BlockToStepN              | 92.333 us                 | 47.070 ms                 |
| OneStep                   | 671.620 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.748 ms                  | 533.527 ms                |
| bucket keys               | 2.988 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.613 ms                  | 142.049 ms                |
| forward: search cache     | 485.704 us                | 35.798 ms                 |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 82.792 ms                 | 2.680 s                   |
| back: aggr dram keys      | 117.965 ms                | 221.532 ms                |
| back: set dram grad       | 5.613 ms                  | 14.555 ms                 |
| back: a2a grad            | 36.043 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 13.319 ms                 | 293.352 ms                |
| Backward                  | 528.202 ms                | 1.869 s                   |
| Optimize                  | 38.949 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 75.025 us                 | 166.092 us                |
| BlockToStepN              | 94.330 us                 | 47.070 ms                 |
| OneStep                   | 699.563 ms                | 4.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.986 ms                  | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.587 ms                  | 142.049 ms                |
| forward: search cache     | 486.739 us                | 35.798 ms                 |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 78.099 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.965 ms                | 221.532 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.142 ms                 | 79.072 ms                 |
| back: grad sum & grad cache  | 13.319 ms                 | 293.352 ms                |
| Backward                  | 521.212 ms                | 663.614 ms                |
| Optimize                  | 38.941 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 73.622 us                 | 146.501 us                |
| BlockToStepN              | 93.606 us                 | 30.892 ms                 |
| OneStep                   | 671.620 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.986 ms                  | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.391 ms                  | 142.049 ms                |
| forward: search cache     | 489.289 us                | 35.798 ms                 |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.755 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.965 ms                | 221.532 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.239 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 13.319 ms                 | 293.352 ms                |
| Backward                  | 523.531 ms                | 663.614 ms                |
| Optimize                  | 39.022 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 73.622 us                 | 146.501 us                |
| BlockToStepN              | 93.458 us                 | 30.892 ms                 |
| OneStep                   | 676.952 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.281 ms                  | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.076 ms                  | 142.049 ms                |
| forward: search cache     | 491.993 us                | 35.798 ms                 |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.445 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.965 ms                | 221.532 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.239 ms                 | 88.901 ms                 |
| back: grad sum & grad cache  | 13.319 ms                 | 293.352 ms                |
| Backward                  | 523.531 ms                | 663.614 ms                |
| Optimize                  | 39.131 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 67.530 us                 | 146.501 us                |
| BlockToStepN              | 93.458 us                 | 47.070 ms                 |
| OneStep                   | 682.271 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.776 ms                  | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 10.513 ms                 |
| forward: a2a keys         | 4.076 ms                  | 142.049 ms                |
| forward: search cache     | 493.879 us                | 35.798 ms                 |
| forward: a2a values       | 30.508 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.706 ms                 | 223.759 ms                |
| back: aggr dram keys      | 118.264 ms                | 221.532 ms                |
| back: set dram grad       | 10.154 ms                 | 14.748 ms                 |
| back: a2a grad            | 36.399 ms                 | 88.901 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 523.531 ms                | 663.614 ms                |
| Optimize                  | 39.189 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 65.237 us                 | 146.501 us                |
| BlockToStepN              | 93.599 us                 | 47.070 ms                 |
| OneStep                   | 692.933 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.098 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.044 ms                  | 134.399 ms                |
| forward: search cache     | 492.589 us                | 575.811 us                |
| forward: a2a values       | 30.508 ms                 | 52.453 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.706 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.965 ms                | 195.643 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.399 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 523.531 ms                | 663.614 ms                |
| Optimize                  | 39.213 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 63.128 us                 | 146.501 us                |
| BlockToStepN              | 93.606 us                 | 47.493 ms                 |
| OneStep                   | 684.463 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.098 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.063 ms                  | 134.399 ms                |
| forward: search cache     | 492.589 us                | 575.811 us                |
| forward: a2a values       | 30.508 ms                 | 52.453 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.383 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.965 ms                | 195.643 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.248 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 523.325 ms                | 663.614 ms                |
| Optimize                  | 39.244 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 62.697 us                 | 146.501 us                |
| BlockToStepN              | 94.694 us                 | 47.493 ms                 |
| OneStep                   | 684.463 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.098 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.063 ms                  | 134.399 ms                |
| forward: search cache     | 492.053 us                | 575.811 us                |
| forward: a2a values       | 30.508 ms                 | 52.453 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.445 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.828 ms                | 195.643 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.239 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 521.212 ms                | 663.614 ms                |
| Optimize                  | 39.244 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 62.749 us                 | 146.501 us                |
| BlockToStepN              | 95.864 us                 | 47.493 ms                 |
| OneStep                   | 678.724 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank7] pid = 37181
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 10108,  14689, 245076,  14709,  14737,  14776,  10149,  14822,  14863,
         14901]) tensor([ 5385294, 15787637, 64854566, 64924471, 23211769,   364901, 22061597,
        71443897, 52651370,  1693339])
-------Step 1-------
tensor([ 10108,  14689, 245076,  14709,  14737,  14776,  10149,  14822,  14863,
         14901]) tensor([55087078, 50583187, 53648576,   316386,  1105504, 44468546, 57082729,
         1262944, 59499955, 38422558])
-------Step 2-------
tensor([  111554,   111590,   111629,   111666,   111709, 63197954, 83289868,
          111741, 56419023,   111776]) tensor([70226405, 37407298, 20412542, 12408293, 25714419, 50514862, 68883327,
        35037677, 79623843, 19101548])
-------Step 3-------
tensor([  111554,   111590,   111629,   111666,   111709, 63197954, 83289868,
          111741, 56419023,   111776]) tensor([85708199, 74064651, 61369634, 38250785, 15674205, 77675534, 75544224,
        11824384, 81845449,    92430])
-------Step 4-------
tensor([  272261,   206701,   206732,  4367450,   206771,   206805,   206853,
        20301630,   206886,   206929]) tensor([36150144, 31598678, 58163773, 50343744,  8536101, 11800891, 45941111,
        15617218, 70134026, 69728140])
-------Step 5-------
tensor([  272261,   206701,   206732,  4367450,   206771,   206805,   206853,
        20301630,   206886,   206929]) tensor([ 1016978, 62080724,  7309742, 54123402, 30340515, 56754114, 48154681,
        32275882, 73520465, 40301037])
-------Step 6-------
tensor([280446, 261193, 261218,  62397,  62430, 261232,  62474, 261247, 261260,
         11985]) tensor([13990907, 67196249, 30322823, 64038191, 29944650, 62907591, 15747743,
        18582288, 32663379, 56696000])
-------Step 7-------
tensor([280446, 261193, 261218,  62397,  62430, 261232,  62474, 261247, 261260,
         11985]) tensor([53695662, 46490224, 69362597, 74107344, 28682061,  2094302, 41243392,
        62337959, 84117307, 77950638])
-------Step 8-------
tensor([  303087,  6362388,   303106,   295909,  9474420,   303126, 26811055,
           79905,    79958,   303147]) tensor([ 1313025, 45151817, 53210552,  6028390, 46828322, 53480918,  6495039,
        53961954, 78129728, 68642654])
-------Step 9-------
tensor([  303087,  6362388,   303106,   295909,  9474420,   303126, 26811055,
           79905,    79958,   303147]) tensor([77376602, 28072288, 13092346, 81766065,  6625402, 46827499, 58690190,
        73385709, 18569301, 24878630])
before start barrier
start train
[proc 0] 100 steps, total: 73.555, sample: 3.254, forward: 11.812, backward: 53.845, update: 4.235
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 80.052, sample: 1.923, forward: 13.907, backward: 29.901, update: 0.527
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 74.011, sample: 1.711, forward: 14.181, backward: 29.654, update: 0.525
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 76.726, sample: 1.922, forward: 14.000, backward: 29.625, update: 0.497
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 79.909, sample: 2.167, forward: 13.763, backward: 29.629, update: 0.503
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 75.399, sample: 2.871, forward: 13.092, backward: 30.739, update: 0.507
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 74.702, sample: 2.062, forward: 13.825, backward: 29.964, update: 0.541
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 77.018, sample: 3.627, forward: 12.181, backward: 30.096, update: 0.517
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.465 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.076 ms                  | 134.399 ms                |
| forward: search cache     | 491.810 us                | 575.811 us                |
| forward: a2a values       | 30.463 ms                 | 60.581 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.445 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.841 ms                | 195.643 ms                |
| back: set dram grad       | 10.154 ms                 | 15.484 ms                 |
| back: a2a grad            | 36.142 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 520.709 ms                | 663.614 ms                |
| Optimize                  | 39.213 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 62.403 us                 | 146.501 us                |
| BlockToStepN              | 95.864 us                 | 47.493 ms                 |
| OneStep                   | 678.724 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.465 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.076 ms                  | 134.399 ms                |
| forward: search cache     | 489.289 us                | 575.811 us                |
| forward: a2a values       | 30.463 ms                 | 73.165 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.269 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.828 ms                | 195.643 ms                |
| back: set dram grad       | 10.154 ms                 | 54.422 ms                 |
| back: a2a grad            | 36.129 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 518.097 ms                | 663.614 ms                |
| Optimize                  | 39.213 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.478 us                 | 146.501 us                |
| BlockToStepN              | 94.330 us                 | 47.493 ms                 |
| OneStep                   | 671.620 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.525 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.044 ms                  | 134.399 ms                |
| forward: search cache     | 491.810 us                | 575.811 us                |
| forward: a2a values       | 30.463 ms                 | 73.165 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.706 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.554 ms                | 195.643 ms                |
| back: set dram grad       | 5.613 ms                  | 54.422 ms                 |
| back: a2a grad            | 36.142 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 293.352 ms                |
| Backward                  | 515.921 ms                | 663.614 ms                |
| Optimize                  | 39.244 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.478 us                 | 146.501 us                |
| BlockToStepN              | 93.644 us                 | 47.493 ms                 |
| OneStep                   | 670.319 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.743 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.938 ms                  | 126.409 ms                |
| forward: search cache     | 492.053 us                | 574.149 us                |
| forward: a2a values       | 30.463 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 77.269 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.142 ms                 | 79.127 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 514.565 ms                | 663.614 ms                |
| Optimize                  | 39.257 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.446 us                 | 146.501 us                |
| BlockToStepN              | 93.606 us                 | 47.493 ms                 |
| OneStep                   | 665.541 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.077 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.876 ms                  | 126.409 ms                |
| forward: search cache     | 492.589 us                | 574.149 us                |
| forward: a2a values       | 30.208 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 75.733 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.142 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 514.565 ms                | 663.614 ms                |
| Optimize                  | 39.277 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.478 us                 | 146.501 us                |
| BlockToStepN              | 93.599 us                 | 47.493 ms                 |
| OneStep                   | 665.541 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.743 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.876 ms                  | 126.409 ms                |
| forward: search cache     | 493.665 us                | 574.149 us                |
| forward: a2a values       | 30.463 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.310 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.142 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 515.588 ms                | 663.614 ms                |
| Optimize                  | 39.322 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.478 us                 | 146.501 us                |
| BlockToStepN              | 93.644 us                 | 47.493 ms                 |
| OneStep                   | 670.319 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.900 ms                 | 432.619 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.915 ms                  | 126.409 ms                |
| forward: search cache     | 493.879 us                | 574.149 us                |
| forward: a2a values       | 30.463 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.706 ms                 | 223.759 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.196 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 515.921 ms                | 663.614 ms                |
| Optimize                  | 39.277 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 61.127 us                 | 146.501 us                |
| BlockToStepN              | 94.076 us                 | 47.493 ms                 |
| OneStep                   | 669.572 ms                | 1.160 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.900 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 3.938 ms                  | 126.409 ms                |
| forward: search cache     | 493.879 us                | 574.149 us                |
| forward: a2a values       | 30.463 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.554 ms                  |
| Forward                   | 76.310 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.196 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 515.921 ms                | 641.774 ms                |
| Optimize                  | 39.277 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.630 us                 | 115.942 us                |
| BlockToStepN              | 94.694 us                 | 47.070 ms                 |
| OneStep                   | 669.070 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.900 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 3.938 ms                  | 126.409 ms                |
| forward: search cache     | 494.285 us                | 574.149 us                |
| forward: a2a values       | 30.353 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.570 ms                  |
| Forward                   | 76.310 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.196 ms                 | 88.901 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 517.532 ms                | 641.774 ms                |
| Optimize                  | 39.320 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 115.942 us                |
| BlockToStepN              | 94.873 us                 | 47.070 ms                 |
| OneStep                   | 670.640 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.492 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.820 ms                  |
| forward: a2a keys         | 3.842 ms                  | 126.409 ms                |
| forward: search cache     | 493.665 us                | 574.149 us                |
| forward: a2a values       | 30.353 ms                 | 66.042 ms                 |
| forward: join             | 3.563 ms                  | 4.573 ms                  |
| Forward                   | 75.257 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 15.484 ms                 |
| back: a2a grad            | 36.230 ms                 | 88.901 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 286.350 ms                |
| Backward                  | 518.097 ms                | 641.774 ms                |
| Optimize                  | 39.320 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.630 us                 | 115.942 us                |
| BlockToStepN              | 94.330 us                 | 47.070 ms                 |
| OneStep                   | 670.640 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.492 ms                 | 320.604 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.842 ms                  | 92.902 ms                 |
| forward: search cache     | 492.589 us                | 572.400 us                |
| forward: a2a values       | 30.208 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.570 ms                  |
| Forward                   | 75.002 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.554 ms                | 194.332 ms                |
| back: set dram grad       | 5.613 ms                  | 14.748 ms                 |
| back: a2a grad            | 36.230 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 517.532 ms                | 641.774 ms                |
| Optimize                  | 39.320 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 115.942 us                |
| BlockToStepN              | 94.261 us                 | 47.070 ms                 |
| OneStep                   | 669.070 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.492 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.876 ms                  | 96.173 ms                 |
| forward: search cache     | 492.111 us                | 572.400 us                |
| forward: a2a values       | 28.920 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.570 ms                  |
| Forward                   | 75.257 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.824 ms                | 195.643 ms                |
| back: set dram grad       | 10.154 ms                 | 14.748 ms                 |
| back: a2a grad            | 36.142 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 516.938 ms                | 641.774 ms                |
| Optimize                  | 39.345 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.488 us                 | 115.942 us                |
| BlockToStepN              | 94.330 us                 | 47.070 ms                 |
| OneStep                   | 668.003 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.492 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 3.991 ms                  | 96.173 ms                 |
| forward: search cache     | 492.111 us                | 572.400 us                |
| forward: a2a values       | 25.968 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.570 ms                  |
| Forward                   | 75.495 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.273 ms                | 195.643 ms                |
| back: set dram grad       | 6.028 ms                  | 14.748 ms                 |
| back: a2a grad            | 35.979 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 515.588 ms                | 641.774 ms                |
| Optimize                  | 39.388 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.430 us                 | 115.942 us                |
| BlockToStepN              | 94.873 us                 | 47.070 ms                 |
| OneStep                   | 666.445 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 66.395, sample: 1.545, forward: 10.535, backward: 28.228, update: 0.482
[proc 3] 200 steps, total: 66.394, sample: 2.045, forward: 10.125, backward: 28.396, update: 0.484
[proc 5] 200 steps, total: 66.395, sample: 1.646, forward: 10.494, backward: 28.123, update: 0.457
[proc 6] 200 steps, total: 66.395, sample: 1.831, forward: 10.278, backward: 28.174, update: 0.494
[proc 0] 200 steps, total: 66.395, sample: 3.280, forward: 8.214, backward: 50.342, update: 4.190
[proc 2] 200 steps, total: 66.394, sample: 2.521, forward: 9.526, backward: 28.572, update: 0.474
[proc 7] 200 steps, total: 66.395, sample: 1.498, forward: 10.617, backward: 28.463, update: 0.488
[proc 1] 200 steps, total: 66.395, sample: 2.358, forward: 9.728, backward: 29.353, update: 0.488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.492 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.044 ms                  | 96.173 ms                 |
| forward: search cache     | 492.589 us                | 574.149 us                |
| forward: a2a values       | 25.681 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.570 ms                  |
| Forward                   | 75.495 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.273 ms                | 195.643 ms                |
| back: set dram grad       | 6.028 ms                  | 14.748 ms                 |
| back: a2a grad            | 35.444 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 514.519 ms                | 641.774 ms                |
| Optimize                  | 39.411 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.583 us                 | 115.942 us                |
| BlockToStepN              | 94.873 us                 | 47.070 ms                 |
| OneStep                   | 665.244 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.133 ms                 | 320.604 ms                |
| bucket keys               | 2.904 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.076 ms                  | 96.173 ms                 |
| forward: search cache     | 493.665 us                | 574.149 us                |
| forward: a2a values       | 25.291 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.573 ms                  |
| Forward                   | 75.583 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.554 ms                | 195.643 ms                |
| back: set dram grad       | 10.154 ms                 | 14.748 ms                 |
| back: a2a grad            | 33.316 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 510.129 ms                | 641.774 ms                |
| Optimize                  | 39.460 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 115.942 us                |
| BlockToStepN              | 95.800 us                 | 47.070 ms                 |
| OneStep                   | 663.900 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.167 ms                 | 320.604 ms                |
| bucket keys               | 2.988 ms                  | 3.820 ms                  |
| forward: a2a keys         | 4.180 ms                  | 96.173 ms                 |
| forward: search cache     | 493.484 us                | 575.811 us                |
| forward: a2a values       | 24.898 ms                 | 61.389 ms                 |
| forward: join             | 3.563 ms                  | 4.573 ms                  |
| Forward                   | 75.495 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.391 ms                | 195.643 ms                |
| back: set dram grad       | 7.145 ms                  | 14.748 ms                 |
| back: a2a grad            | 32.076 ms                 | 86.598 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 283.760 ms                |
| Backward                  | 508.948 ms                | 641.774 ms                |
| Optimize                  | 39.507 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.683 us                 | 115.942 us                |
| BlockToStepN              | 96.080 us                 | 47.070 ms                 |
| OneStep                   | 661.254 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.133 ms                 | 320.604 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.186 ms                  | 92.902 ms                 |
| forward: search cache     | 492.394 us                | 574.149 us                |
| forward: a2a values       | 23.417 ms                 | 60.581 ms                 |
| forward: join             | 3.625 ms                  | 4.754 ms                  |
| Forward                   | 74.996 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.391 ms                | 194.332 ms                |
| back: set dram grad       | 8.206 ms                  | 14.748 ms                 |
| back: a2a grad            | 31.180 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 505.807 ms                | 641.774 ms                |
| Optimize                  | 39.613 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.683 us                 | 115.942 us                |
| BlockToStepN              | 95.800 us                 | 47.070 ms                 |
| OneStep                   | 657.633 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.167 ms                 | 320.604 ms                |
| bucket keys               | 2.993 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.180 ms                  | 92.902 ms                 |
| forward: search cache     | 492.394 us                | 574.149 us                |
| forward: a2a values       | 22.388 ms                 | 60.581 ms                 |
| forward: join             | 3.653 ms                  | 4.785 ms                  |
| Forward                   | 75.002 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.391 ms                | 194.332 ms                |
| back: set dram grad       | 10.090 ms                 | 14.748 ms                 |
| back: a2a grad            | 30.877 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 504.634 ms                | 641.774 ms                |
| Optimize                  | 39.674 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.683 us                 | 115.942 us                |
| BlockToStepN              | 94.873 us                 | 47.493 ms                 |
| OneStep                   | 656.149 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.025 ms                 | 320.604 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.180 ms                  | 92.902 ms                 |
| forward: search cache     | 492.470 us                | 574.149 us                |
| forward: a2a values       | 18.809 ms                 | 60.581 ms                 |
| forward: join             | 3.675 ms                  | 4.810 ms                  |
| Forward                   | 74.714 ms                 | 209.959 ms                |
| back: aggr dram keys      | 117.806 ms                | 194.332 ms                |
| back: set dram grad       | 10.215 ms                 | 14.748 ms                 |
| back: a2a grad            | 30.545 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 504.057 ms                | 641.774 ms                |
| Optimize                  | 39.729 ms                 | 84.081 ms                 |
| BarrierTimeBeforeRank0    | 60.882 us                 | 115.942 us                |
| BlockToStepN              | 94.538 us                 | 47.493 ms                 |
| OneStep                   | 651.488 ms                | 1.081 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.900 ms                 | 317.981 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.186 ms                  | 92.902 ms                 |
| forward: search cache     | 492.589 us                | 574.149 us                |
| forward: a2a values       | 18.192 ms                 | 60.581 ms                 |
| forward: join             | 3.680 ms                  | 4.828 ms                  |
| Forward                   | 74.588 ms                 | 201.438 ms                |
| back: aggr dram keys      | 117.828 ms                | 194.332 ms                |
| back: set dram grad       | 10.274 ms                 | 14.748 ms                 |
| back: a2a grad            | 29.754 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 503.008 ms                | 638.656 ms                |
| Optimize                  | 39.759 ms                 | 83.996 ms                 |
| BarrierTimeBeforeRank0    | 60.767 us                 | 102.822 us                |
| BlockToStepN              | 94.538 us                 | 47.493 ms                 |
| OneStep                   | 648.568 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.591 ms                 | 317.981 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.199 ms                  | 92.902 ms                 |
| forward: search cache     | 493.613 us                | 574.149 us                |
| forward: a2a values       | 18.163 ms                 | 60.581 ms                 |
| forward: join             | 3.685 ms                  | 4.833 ms                  |
| Forward                   | 74.472 ms                 | 201.438 ms                |
| back: aggr dram keys      | 117.842 ms                | 194.332 ms                |
| back: set dram grad       | 10.323 ms                 | 14.748 ms                 |
| back: a2a grad            | 28.957 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 500.006 ms                | 638.656 ms                |
| Optimize                  | 39.860 ms                 | 83.996 ms                 |
| BarrierTimeBeforeRank0    | 60.767 us                 | 102.822 us                |
| BlockToStepN              | 94.076 us                 | 47.493 ms                 |
| OneStep                   | 644.003 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.402 ms                 | 317.981 ms                |
| bucket keys               | 2.988 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.354 ms                  | 92.902 ms                 |
| forward: search cache     | 494.080 us                | 574.149 us                |
| forward: a2a values       | 17.995 ms                 | 60.581 ms                 |
| forward: join             | 3.692 ms                  | 4.953 ms                  |
| Forward                   | 74.496 ms                 | 201.438 ms                |
| back: aggr dram keys      | 117.965 ms                | 194.332 ms                |
| back: set dram grad       | 10.365 ms                 | 14.748 ms                 |
| back: a2a grad            | 27.067 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 276.858 ms                |
| Backward                  | 498.911 ms                | 638.656 ms                |
| Optimize                  | 39.908 ms                 | 83.996 ms                 |
| BarrierTimeBeforeRank0    | 60.683 us                 | 102.822 us                |
| BlockToStepN              | 93.644 us                 | 47.493 ms                 |
| OneStep                   | 643.175 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.077 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 3.530 ms                  |
| forward: a2a keys         | 4.353 ms                  | 90.287 ms                 |
| forward: search cache     | 494.153 us                | 572.400 us                |
| forward: a2a values       | 16.036 ms                 | 56.240 ms                 |
| forward: join             | 3.704 ms                  | 5.686 ms                  |
| Forward                   | 74.450 ms                 | 201.438 ms                |
| back: aggr dram keys      | 117.965 ms                | 192.948 ms                |
| back: set dram grad       | 10.378 ms                 | 14.555 ms                 |
| back: a2a grad            | 25.597 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 70.375 ms                 | 272.856 ms                |
| Backward                  | 495.551 ms                | 638.656 ms                |
| Optimize                  | 40.030 ms                 | 83.996 ms                 |
| BarrierTimeBeforeRank0    | 60.683 us                 | 115.942 us                |
| BlockToStepN              | 93.978 us                 | 47.493 ms                 |
| OneStep                   | 640.591 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.591 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.353 ms                  | 90.287 ms                 |
| forward: search cache     | 494.422 us                | 574.149 us                |
| forward: a2a values       | 13.828 ms                 | 56.240 ms                 |
| forward: join             | 3.710 ms                  | 5.686 ms                  |
| Forward                   | 74.393 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.264 ms                | 192.948 ms                |
| back: set dram grad       | 10.382 ms                 | 14.555 ms                 |
| back: a2a grad            | 24.825 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 64.756 ms                 | 272.856 ms                |
| Backward                  | 491.591 ms                | 638.656 ms                |
| Optimize                  | 40.653 ms                 | 83.996 ms                 |
| BarrierTimeBeforeRank0    | 60.782 us                 | 146.501 us                |
| BlockToStepN              | 93.644 us                 | 47.493 ms                 |
| OneStep                   | 639.857 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.402 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.300 ms                  | 90.287 ms                 |
| forward: search cache     | 494.472 us                | 574.149 us                |
| forward: a2a values       | 13.621 ms                 | 56.240 ms                 |
| forward: join             | 3.719 ms                  | 5.686 ms                  |
| Forward                   | 73.983 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.376 ms                | 194.332 ms                |
| back: set dram grad       | 10.395 ms                 | 14.555 ms                 |
| back: a2a grad            | 24.239 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 64.756 ms                 | 272.856 ms                |
| Backward                  | 488.865 ms                | 638.656 ms                |
| Optimize                  | 41.928 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 60.782 us                 | 146.501 us                |
| BlockToStepN              | 93.599 us                 | 47.493 ms                 |
| OneStep                   | 639.087 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 58.856, sample: 1.211, forward: 9.328, backward: 32.070, update: 0.482
[proc 3] 300 steps, total: 58.856, sample: 1.581, forward: 9.053, backward: 32.093, update: 0.476
[proc 2] 300 steps, total: 58.856, sample: 1.737, forward: 8.825, backward: 32.270, update: 0.510
[proc 5] 300 steps, total: 58.856, sample: 1.350, forward: 9.201, backward: 31.930, update: 0.454
[proc 6] 300 steps, total: 58.856, sample: 1.337, forward: 9.238, backward: 32.030, update: 0.448
[proc 4] 300 steps, total: 58.856, sample: 1.384, forward: 9.218, backward: 32.009, update: 0.482
[proc 1] 300 steps, total: 58.856, sample: 1.844, forward: 8.742, backward: 32.953, update: 0.457
[proc 0] 300 steps, total: 58.856, sample: 2.549, forward: 7.450, backward: 42.479, update: 5.934
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.050 ms                 | 317.981 ms                |
| bucket keys               | 2.949 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.199 ms                  | 90.287 ms                 |
| forward: search cache     | 494.472 us                | 574.149 us                |
| forward: a2a values       | 13.465 ms                 | 56.240 ms                 |
| forward: join             | 3.726 ms                  | 5.686 ms                  |
| Forward                   | 73.775 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.527 ms                | 194.332 ms                |
| back: set dram grad       | 10.401 ms                 | 14.555 ms                 |
| back: a2a grad            | 23.653 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 64.756 ms                 | 272.856 ms                |
| Backward                  | 486.831 ms                | 638.656 ms                |
| Optimize                  | 42.982 ms                 | 86.614 ms                 |
| BarrierTimeBeforeRank0    | 60.646 us                 | 146.501 us                |
| BlockToStepN              | 93.580 us                 | 47.591 ms                 |
| OneStep                   | 637.081 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.970 ms                 | 317.981 ms                |
| bucket keys               | 2.960 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.304 ms                  | 90.287 ms                 |
| forward: search cache     | 494.153 us                | 574.149 us                |
| forward: a2a values       | 13.314 ms                 | 56.240 ms                 |
| forward: join             | 3.734 ms                  | 5.686 ms                  |
| Forward                   | 73.367 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.757 ms                | 194.332 ms                |
| back: set dram grad       | 10.408 ms                 | 14.555 ms                 |
| back: a2a grad            | 22.834 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 64.357 ms                 | 272.856 ms                |
| Backward                  | 485.604 ms                | 638.656 ms                |
| Optimize                  | 43.385 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 146.501 us                |
| BlockToStepN              | 93.401 us                 | 48.954 ms                 |
| OneStep                   | 635.783 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.495 ms                 | 317.981 ms                |
| bucket keys               | 2.960 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.354 ms                  | 90.287 ms                 |
| forward: search cache     | 494.916 us                | 574.149 us                |
| forward: a2a values       | 13.163 ms                 | 60.581 ms                 |
| forward: join             | 3.738 ms                  | 5.897 ms                  |
| Forward                   | 73.015 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.846 ms                | 195.643 ms                |
| back: set dram grad       | 10.416 ms                 | 14.555 ms                 |
| back: a2a grad            | 21.134 ms                 | 85.801 ms                 |
| back: grad sum & grad cache  | 64.154 ms                 | 272.856 ms                |
| Backward                  | 483.052 ms                | 638.656 ms                |
| Optimize                  | 44.340 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 146.501 us                |
| BlockToStepN              | 93.111 us                 | 48.954 ms                 |
| OneStep                   | 633.618 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.495 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.358 ms                  | 79.466 ms                 |
| forward: search cache     | 495.307 us                | 573.561 us                |
| forward: a2a values       | 13.124 ms                 | 56.240 ms                 |
| forward: join             | 3.743 ms                  | 5.686 ms                  |
| Forward                   | 72.873 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.926 ms                | 195.643 ms                |
| back: set dram grad       | 10.425 ms                 | 14.748 ms                 |
| back: a2a grad            | 20.481 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 64.154 ms                 | 272.139 ms                |
| Backward                  | 480.931 ms                | 638.656 ms                |
| Optimize                  | 45.652 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 146.501 us                |
| BlockToStepN              | 93.045 us                 | 48.954 ms                 |
| OneStep                   | 633.604 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.525 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.384 ms                  | 79.466 ms                 |
| forward: search cache     | 495.298 us                | 573.561 us                |
| forward: a2a values       | 13.113 ms                 | 56.240 ms                 |
| forward: join             | 3.750 ms                  | 5.977 ms                  |
| Forward                   | 72.652 ms                 | 201.438 ms                |
| back: aggr dram keys      | 118.946 ms                | 195.643 ms                |
| back: set dram grad       | 10.433 ms                 | 15.484 ms                 |
| back: a2a grad            | 20.161 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 64.154 ms                 | 272.139 ms                |
| Backward                  | 478.808 ms                | 638.656 ms                |
| Optimize                  | 45.964 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.630 us                 | 172.908 us                |
| BlockToStepN              | 93.111 us                 | 51.312 ms                 |
| OneStep                   | 631.410 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.465 ms                 | 317.981 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.384 ms                  | 79.466 ms                 |
| forward: search cache     | 495.398 us                | 573.561 us                |
| forward: a2a values       | 12.999 ms                 | 56.240 ms                 |
| forward: join             | 3.752 ms                  | 5.977 ms                  |
| Forward                   | 72.531 ms                 | 201.438 ms                |
| back: aggr dram keys      | 119.072 ms                | 195.643 ms                |
| back: set dram grad       | 10.432 ms                 | 15.484 ms                 |
| back: a2a grad            | 19.749 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 63.939 ms                 | 272.139 ms                |
| Backward                  | 474.880 ms                | 638.656 ms                |
| Optimize                  | 46.211 ms                 | 97.580 ms                 |
| BarrierTimeBeforeRank0    | 60.646 us                 | 172.908 us                |
| BlockToStepN              | 92.818 us                 | 51.312 ms                 |
| OneStep                   | 631.232 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.033 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.391 ms                  | 79.466 ms                 |
| forward: search cache     | 495.547 us                | 575.811 us                |
| forward: a2a values       | 12.999 ms                 | 56.240 ms                 |
| forward: join             | 3.754 ms                  | 5.977 ms                  |
| Forward                   | 72.531 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.228 ms                | 195.643 ms                |
| back: set dram grad       | 10.443 ms                 | 15.484 ms                 |
| back: a2a grad            | 19.524 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 63.939 ms                 | 272.139 ms                |
| Backward                  | 471.774 ms                | 614.346 ms                |
| Optimize                  | 46.546 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.583 us                 | 166.092 us                |
| BlockToStepN              | 92.818 us                 | 48.954 ms                 |
| OneStep                   | 629.992 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.906 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.384 ms                  | 79.466 ms                 |
| forward: search cache     | 495.785 us                | 575.811 us                |
| forward: a2a values       | 12.999 ms                 | 56.240 ms                 |
| forward: join             | 3.757 ms                  | 5.977 ms                  |
| Forward                   | 72.364 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.248 ms                | 195.643 ms                |
| back: set dram grad       | 10.449 ms                 | 16.913 ms                 |
| back: a2a grad            | 19.318 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 63.939 ms                 | 272.139 ms                |
| Backward                  | 466.987 ms                | 614.346 ms                |
| Optimize                  | 46.829 ms                 | 93.695 ms                 |
| BarrierTimeBeforeRank0    | 60.527 us                 | 166.092 us                |
| BlockToStepN              | 92.698 us                 | 48.954 ms                 |
| OneStep                   | 627.494 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.848 ms                 | 311.960 ms                |
| bucket keys               | 2.979 ms                  | 4.073 ms                  |
| forward: a2a keys         | 4.387 ms                  | 79.466 ms                 |
| forward: search cache     | 495.922 us                | 575.811 us                |
| forward: a2a values       | 12.999 ms                 | 56.240 ms                 |
| forward: join             | 3.759 ms                  | 5.977 ms                  |
| Forward                   | 72.128 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.339 ms                | 195.643 ms                |
| back: set dram grad       | 10.455 ms                 | 18.727 ms                 |
| back: a2a grad            | 19.151 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 63.939 ms                 | 272.139 ms                |
| Backward                  | 465.451 ms                | 614.346 ms                |
| Optimize                  | 47.455 ms                 | 97.580 ms                 |
| BarrierTimeBeforeRank0    | 60.488 us                 | 166.092 us                |
| BlockToStepN              | 92.526 us                 | 48.954 ms                 |
| OneStep                   | 623.495 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.724 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.895 ms                  |
| forward: a2a keys         | 4.391 ms                  | 79.466 ms                 |
| forward: search cache     | 496.390 us                | 574.149 us                |
| forward: a2a values       | 12.999 ms                 | 55.089 ms                 |
| forward: join             | 3.761 ms                  | 5.897 ms                  |
| Forward                   | 72.128 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.284 ms                | 194.332 ms                |
| back: set dram grad       | 10.456 ms                 | 18.727 ms                 |
| back: a2a grad            | 18.937 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 63.939 ms                 | 270.594 ms                |
| Backward                  | 463.133 ms                | 614.346 ms                |
| Optimize                  | 48.150 ms                 | 98.156 ms                 |
| BarrierTimeBeforeRank0    | 60.527 us                 | 166.092 us                |
| BlockToStepN              | 92.420 us                 | 48.954 ms                 |
| OneStep                   | 621.236 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.724 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.895 ms                  |
| forward: a2a keys         | 4.394 ms                  | 79.466 ms                 |
| forward: search cache     | 496.717 us                | 575.811 us                |
| forward: a2a values       | 12.975 ms                 | 55.089 ms                 |
| forward: join             | 3.764 ms                  | 5.897 ms                  |
| Forward                   | 71.748 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.345 ms                | 194.332 ms                |
| back: set dram grad       | 10.464 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.877 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.594 ms                |
| Backward                  | 461.133 ms                | 614.346 ms                |
| Optimize                  | 49.394 ms                 | 99.592 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 166.092 us                |
| BlockToStepN              | 92.383 us                 | 48.954 ms                 |
| OneStep                   | 620.659 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 57.066, sample: 1.316, forward: 8.225, backward: 33.978, update: 0.449
[proc 3] 400 steps, total: 57.066, sample: 1.502, forward: 8.035, backward: 34.118, update: 0.517
[proc 4] 400 steps, total: 57.066, sample: 1.406, forward: 8.134, backward: 33.992, update: 0.477
[proc 2] 400 steps, total: 57.066, sample: 1.420, forward: 8.022, backward: 34.364, update: 0.466
[proc 7] 400 steps, total: 57.066, sample: 1.209, forward: 8.305, backward: 34.007, update: 0.484
[proc 5] 400 steps, total: 57.066, sample: 1.330, forward: 8.275, backward: 33.827, update: 0.450
[proc 1] 400 steps, total: 57.065, sample: 1.514, forward: 8.004, backward: 34.839, update: 0.494
[proc 0] 400 steps, total: 57.065, sample: 1.966, forward: 7.099, backward: 40.470, update: 6.911
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.415 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.895 ms                  |
| forward: a2a keys         | 4.453 ms                  | 79.466 ms                 |
| forward: search cache     | 496.390 us                | 575.811 us                |
| forward: a2a values       | 12.984 ms                 | 55.089 ms                 |
| forward: join             | 3.770 ms                  | 5.897 ms                  |
| Forward                   | 71.476 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.490 ms                | 194.332 ms                |
| back: set dram grad       | 10.472 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.746 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.594 ms                |
| Backward                  | 457.999 ms                | 614.346 ms                |
| Optimize                  | 49.918 ms                 | 99.592 ms                 |
| BarrierTimeBeforeRank0    | 60.613 us                 | 166.092 us                |
| BlockToStepN              | 92.352 us                 | 51.312 ms                 |
| OneStep                   | 619.393 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.222 ms                 | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.895 ms                  |
| forward: a2a keys         | 4.490 ms                  | 79.466 ms                 |
| forward: search cache     | 496.318 us                | 575.811 us                |
| forward: a2a values       | 12.984 ms                 | 55.089 ms                 |
| forward: join             | 3.771 ms                  | 5.977 ms                  |
| Forward                   | 71.221 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.697 ms                | 194.332 ms                |
| back: set dram grad       | 10.474 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.723 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.594 ms                |
| Backward                  | 455.922 ms                | 614.346 ms                |
| Optimize                  | 50.454 ms                 | 99.870 ms                 |
| BarrierTimeBeforeRank0    | 60.583 us                 | 166.092 us                |
| BlockToStepN              | 92.352 us                 | 51.312 ms                 |
| OneStep                   | 617.757 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.888 ms                  | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.895 ms                  |
| forward: a2a keys         | 4.547 ms                  | 79.466 ms                 |
| forward: search cache     | 496.390 us                | 575.811 us                |
| forward: a2a values       | 12.975 ms                 | 55.089 ms                 |
| forward: join             | 3.773 ms                  | 5.977 ms                  |
| Forward                   | 71.159 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.797 ms                | 195.643 ms                |
| back: set dram grad       | 10.477 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.656 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.594 ms                |
| Backward                  | 455.461 ms                | 614.346 ms                |
| Optimize                  | 52.426 ms                 | 108.757 ms                |
| BarrierTimeBeforeRank0    | 60.544 us                 | 166.092 us                |
| BlockToStepN              | 92.383 us                 | 51.312 ms                 |
| OneStep                   | 614.498 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.674 ms                  | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.547 ms                  | 70.549 ms                 |
| forward: search cache     | 496.734 us                | 574.149 us                |
| forward: a2a values       | 12.975 ms                 | 56.240 ms                 |
| forward: join             | 3.780 ms                  | 5.936 ms                  |
| Forward                   | 71.074 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.823 ms                | 195.643 ms                |
| back: set dram grad       | 10.480 ms                 | 18.727 ms                 |
| back: a2a grad            | 18.533 ms                 | 79.127 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 453.974 ms                | 614.346 ms                |
| Optimize                  | 52.874 ms                 | 109.535 ms                |
| BarrierTimeBeforeRank0    | 60.527 us                 | 166.092 us                |
| BlockToStepN              | 92.333 us                 | 51.312 ms                 |
| OneStep                   | 613.116 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.415 ms                  | 311.960 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.552 ms                  | 70.549 ms                 |
| forward: search cache     | 496.390 us                | 575.811 us                |
| forward: a2a values       | 12.966 ms                 | 56.240 ms                 |
| forward: join             | 3.786 ms                  | 5.936 ms                  |
| Forward                   | 70.970 ms                 | 199.503 ms                |
| back: aggr dram keys      | 119.970 ms                | 195.643 ms                |
| back: set dram grad       | 10.492 ms                 | 19.231 ms                 |
| back: a2a grad            | 18.519 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 453.652 ms                | 614.346 ms                |
| Optimize                  | 54.468 ms                 | 109.947 ms                |
| BarrierTimeBeforeRank0    | 60.488 us                 | 166.092 us                |
| BlockToStepN              | 92.292 us                 | 51.312 ms                 |
| OneStep                   | 611.895 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.595 ms                  | 311.960 ms                |
| bucket keys               | 2.979 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.567 ms                  | 79.466 ms                 |
| forward: search cache     | 496.717 us                | 576.792 us                |
| forward: a2a values       | 12.966 ms                 | 56.240 ms                 |
| forward: join             | 3.787 ms                  | 5.936 ms                  |
| Forward                   | 70.970 ms                 | 199.503 ms                |
| back: aggr dram keys      | 120.022 ms                | 195.643 ms                |
| back: set dram grad       | 10.498 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.494 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 450.703 ms                | 614.346 ms                |
| Optimize                  | 55.782 ms                 | 109.947 ms                |
| BarrierTimeBeforeRank0    | 60.544 us                 | 166.092 us                |
| BlockToStepN              | 92.162 us                 | 51.312 ms                 |
| OneStep                   | 609.967 ms                | 1.031 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.415 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.613 ms                  | 79.466 ms                 |
| forward: search cache     | 496.318 us                | 582.777 us                |
| forward: a2a values       | 12.962 ms                 | 60.581 ms                 |
| forward: join             | 3.788 ms                  | 5.936 ms                  |
| Forward                   | 70.895 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.093 ms                | 195.643 ms                |
| back: set dram grad       | 10.502 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.467 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 449.543 ms                | 613.115 ms                |
| Optimize                  | 56.839 ms                 | 109.535 ms                |
| BarrierTimeBeforeRank0    | 60.583 us                 | 146.501 us                |
| BlockToStepN              | 92.257 us                 | 48.987 ms                 |
| OneStep                   | 609.039 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.230 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.591 ms                  | 79.466 ms                 |
| forward: search cache     | 496.166 us                | 582.777 us                |
| forward: a2a values       | 12.958 ms                 | 60.581 ms                 |
| forward: join             | 3.788 ms                  | 5.936 ms                  |
| Forward                   | 70.845 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.106 ms                | 195.643 ms                |
| back: set dram grad       | 10.504 ms                 | 19.395 ms                 |
| back: a2a grad            | 18.402 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 446.570 ms                | 613.115 ms                |
| Optimize                  | 58.384 ms                 | 109.947 ms                |
| BarrierTimeBeforeRank0    | 60.527 us                 | 146.501 us                |
| BlockToStepN              | 92.162 us                 | 48.987 ms                 |
| OneStep                   | 608.007 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.174 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.628 ms                  | 79.466 ms                 |
| forward: search cache     | 495.922 us                | 582.777 us                |
| forward: a2a values       | 12.945 ms                 | 60.581 ms                 |
| forward: join             | 3.790 ms                  | 5.936 ms                  |
| Forward                   | 70.661 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.284 ms                | 195.643 ms                |
| back: set dram grad       | 10.506 ms                 | 19.938 ms                 |
| back: a2a grad            | 18.389 ms                 | 83.710 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 270.513 ms                |
| Backward                  | 445.838 ms                | 613.115 ms                |
| Optimize                  | 59.166 ms                 | 109.947 ms                |
| BarrierTimeBeforeRank0    | 60.469 us                 | 146.501 us                |
| BlockToStepN              | 92.052 us                 | 48.987 ms                 |
| OneStep                   | 604.707 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.128 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.695 ms                  | 70.549 ms                 |
| forward: search cache     | 495.785 us                | 576.792 us                |
| forward: a2a values       | 12.945 ms                 | 59.906 ms                 |
| forward: join             | 3.792 ms                  | 5.898 ms                  |
| Forward                   | 70.566 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.500 ms                | 194.332 ms                |
| back: set dram grad       | 10.506 ms                 | 19.560 ms                 |
| back: a2a grad            | 18.325 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 268.528 ms                |
| Backward                  | 444.257 ms                | 613.115 ms                |
| Optimize                  | 59.563 ms                 | 109.947 ms                |
| BarrierTimeBeforeRank0    | 60.430 us                 | 146.501 us                |
| BlockToStepN              | 92.162 us                 | 48.987 ms                 |
| OneStep                   | 604.072 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.939 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.709 ms                  | 70.549 ms                 |
| forward: search cache     | 495.785 us                | 576.792 us                |
| forward: a2a values       | 12.936 ms                 | 59.906 ms                 |
| forward: join             | 3.796 ms                  | 5.898 ms                  |
| Forward                   | 70.445 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.524 ms                | 194.332 ms                |
| back: set dram grad       | 10.509 ms                 | 19.560 ms                 |
| back: a2a grad            | 18.280 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 268.528 ms                |
| Backward                  | 441.416 ms                | 613.115 ms                |
| Optimize                  | 59.788 ms                 | 113.503 ms                |
| BarrierTimeBeforeRank0    | 60.488 us                 | 146.501 us                |
| BlockToStepN              | 92.052 us                 | 48.987 ms                 |
| OneStep                   | 601.712 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.807 ms                  | 277.965 ms                |
| bucket keys               | 2.962 ms                  | 3.888 ms                  |
| forward: a2a keys         | 4.705 ms                  | 70.549 ms                 |
| forward: search cache     | 495.785 us                | 576.792 us                |
| forward: a2a values       | 12.945 ms                 | 59.906 ms                 |
| forward: join             | 3.797 ms                  | 5.936 ms                  |
| Forward                   | 70.290 ms                 | 193.306 ms                |
| back: aggr dram keys      | 120.726 ms                | 195.643 ms                |
| back: set dram grad       | 10.509 ms                 | 19.560 ms                 |
| back: a2a grad            | 18.280 ms                 | 83.017 ms                 |
| back: grad sum & grad cache  | 62.308 ms                 | 268.528 ms                |
| Backward                  | 439.673 ms                | 613.115 ms                |
| Optimize                  | 60.298 ms                 | 113.503 ms                |
| BarrierTimeBeforeRank0    | 60.430 us                 | 146.501 us                |
| BlockToStepN              | 91.917 us                 | 48.987 ms                 |
| OneStep                   | 600.515 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 56.638, sample: 1.612, forward: 7.083, backward: 40.310, update: 7.039
[proc 6] 500 steps, total: 56.638, sample: 1.329, forward: 7.760, backward: 34.013, update: 0.450
[proc 2] 500 steps, total: 56.638, sample: 1.319, forward: 7.722, backward: 34.284, update: 0.466
[proc 5] 500 steps, total: 56.638, sample: 1.195, forward: 7.895, backward: 33.912, update: 0.458
[proc 4] 500 steps, total: 56.638, sample: 1.392, forward: 7.681, backward: 34.046, update: 0.484
Successfully xmh. training takes 312.51073384284973 seconds
before call kg_cache_controller.StopThreads()
[proc 7] 500 steps, total: 56.638, sample: 1.197, forward: 7.887, backward: 33.979, update: 0.483
[proc 3] 500 steps, total: 56.638, sample: 1.458, forward: 7.701, backward: 34.085, update: 0.521
[proc 1] 500 steps, total: 56.638, sample: 1.464, forward: 7.587, backward: 34.928, update: 0.454
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
INFO [63687 controller_process.py:380] call rank0 to StopThreads
