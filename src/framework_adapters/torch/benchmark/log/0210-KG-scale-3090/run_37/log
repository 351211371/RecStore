WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240211 23:52:08.050618 20643 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_96', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [20643 sampler.py:454] Start PreSampling
WARNING [20643 sampler.py:532] Before construct renumbering_dict
WARNING [20643 sampler.py:555] PreSampling done
W20240211 23:52:13.597110 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240211 23:52:13.597308 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240211 23:52:13.597355 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240211 23:52:13.597400 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240211 23:52:13.597455 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240211 23:52:13.597497 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240211 23:52:13.597550 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240211 23:52:13.597601 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240211 23:52:13.597653 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240211 23:52:13.597685 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240211 23:52:13.597733 20643 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240211 23:52:13.597766 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240211 23:52:13.597802 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240211 23:52:13.598006 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240211 23:52:13.598057 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240211 23:52:13.598088 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240211 23:52:13.598150 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240211 23:52:13.598186 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240211 23:52:13.598248 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240211 23:52:13.598299 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240211 23:52:13.598340 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240211 23:52:13.598383 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240211 23:52:13.598417 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240211 23:52:13.598448 20643 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240211 23:52:13.598475 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240211 23:52:13.598503 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240211 23:52:13.598573 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240211 23:52:13.598610 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240211 23:52:13.598647 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240211 23:52:13.598686 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240211 23:52:13.598724 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240211 23:52:13.598765 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240211 23:52:13.598798 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240211 23:52:13.598836 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240211 23:52:13.598886 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240211 23:52:13.598924 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240211 23:52:13.598954 20643 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240211 23:52:13.598981 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240211 23:52:13.599007 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240211 23:52:13.599069 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240211 23:52:13.599119 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240211 23:52:13.599157 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240211 23:52:13.599195 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240211 23:52:13.599228 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240211 23:52:13.599263 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240211 23:52:13.599294 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240211 23:52:13.599340 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240211 23:52:13.599370 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240211 23:52:13.599403 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240211 23:52:13.599444 20643 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240211 23:52:13.599470 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240211 23:52:13.599503 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240211 23:52:13.599565 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240211 23:52:13.599614 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240211 23:52:13.599646 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240211 23:52:13.599678 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240211 23:52:13.599715 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240211 23:52:13.599752 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240211 23:52:13.599782 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240211 23:52:13.599820 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240211 23:52:13.599856 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240211 23:52:13.599893 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240211 23:52:13.599923 20643 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240211 23:52:13.599951 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240211 23:52:13.599977 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240211 23:52:13.600033 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240211 23:52:13.600096 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240211 23:52:13.600144 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240211 23:52:13.600186 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240211 23:52:13.600216 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240211 23:52:13.600247 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240211 23:52:13.600286 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240211 23:52:13.600324 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240211 23:52:13.600366 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240211 23:52:13.600404 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240211 23:52:13.600442 20643 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240211 23:52:13.600469 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240211 23:52:13.600495 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240211 23:52:13.600562 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240211 23:52:13.600608 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240211 23:52:13.600651 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240211 23:52:13.600688 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240211 23:52:13.600719 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240211 23:52:13.600750 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240211 23:52:13.600787 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240211 23:52:13.600823 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240211 23:52:13.600855 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240211 23:52:13.600889 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240211 23:52:13.600931 20643 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240211 23:52:13.600960 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240211 23:52:13.600986 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240211 23:52:13.601045 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240211 23:52:13.601094 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240211 23:52:13.601126 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240211 23:52:13.601157 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240211 23:52:13.601188 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240211 23:52:13.601228 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240211 23:52:13.601260 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240211 23:52:13.601292 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240211 23:52:13.601325 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240211 23:52:13.601361 20643 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240211 23:52:13.601400 20643 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240211 23:52:13.601428 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240211 23:52:13.601454 20643 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240211 23:52:13.803310 20643 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240211 23:52:13.838213 20643 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([1501, 1941, 2489,  ..., 9722, 9626, 7258]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.836 seconds
[Rank1] pid = 20850
[Rank2] pid = 20895
[Rank3] pid = 20978
[Rank4] pid = 20979
[Rank5] pid = 21044
[Rank6] pid = 21080
INFO [20643 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20850 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20895 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [20978 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [20979 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [21044 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [21080 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [21173 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [21080 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21173 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20979 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20978 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21044 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [21080 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20978 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [21044 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [21173 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20979 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [20643 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20850 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20895 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [20643 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20895 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20850 DistTensor.py:59] The tensor name already exists in the kvstore
I20240211 23:52:16.504693 21172 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.504818 21244 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.504964 20851 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.505106 20980 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.505237 20915 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.505354 21043 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.505491 21079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 23:52:16.505618 21243 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240211 23:52:17.221089 21043 recstore.cc:66] init folly done
E20240211 23:52:17.221139 21243 recstore.cc:66] init folly done
E20240211 23:52:17.221345 20980 recstore.cc:66] init folly done
E20240211 23:52:17.221462 20915 recstore.cc:66] init folly done
E20240211 23:52:17.221462 20851 recstore.cc:66] init folly done
E20240211 23:52:17.221478 21172 recstore.cc:66] init folly done
E20240211 23:52:17.221940 21244 recstore.cc:66] init folly done
E20240211 23:52:17.221948 21079 recstore.cc:66] init folly done
I20240211 23:52:17.290940 20980 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240211 23:52:17.293072 21079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.293566 20915 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.295218 20851 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.296039 21172 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.296831 21243 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.297752 21043 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 23:52:17.301637 21244 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.242 ms                  | 38.529 ms                 |
| Forward                   | 9.194 ms                  | 483.949 ms                |
| Backward                  | 124.260 ms                | 376.084 ms                |
| Optimize                  | 2.480 ms                  | 43.764 ms                 |
| BarrierTimeBeforeRank0    | 6.174 ms                  | 22.457 ms                 |
| BlockToStepN              | 35.433 us                 | 276.583 us                |
| OneStep                   | 147.242 ms                | 907.486 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.825 ms                  | 32.917 ms                 |
| Forward                   | 9.700 ms                  | 19.549 ms                 |
| Backward                  | 118.909 ms                | 148.777 ms                |
| Optimize                  | 3.464 ms                  | 7.839 ms                  |
| BarrierTimeBeforeRank0    | 6.132 ms                  | 28.021 ms                 |
| BlockToStepN              | 35.675 us                 | 261.105 us                |
| OneStep                   | 143.375 ms                | 189.630 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.798 ms                  | 32.917 ms                 |
| Forward                   | 9.527 ms                  | 19.549 ms                 |
| Backward                  | 116.568 ms                | 148.777 ms                |
| Optimize                  | 3.473 ms                  | 7.839 ms                  |
| BarrierTimeBeforeRank0    | 9.140 ms                  | 44.936 ms                 |
| BlockToStepN              | 34.649 us                 | 261.105 us                |
| OneStep                   | 147.242 ms                | 189.630 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 15.523, sample: 0.433, forward: 1.226, backward: 11.744, update: 0.321
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 15.520, sample: 0.376, forward: 1.173, backward: 11.633, update: 0.229
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 15.525, sample: 0.436, forward: 1.179, backward: 11.707, update: 0.313
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 15.519, sample: 0.416, forward: 1.220, backward: 12.105, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 15.523, sample: 0.366, forward: 1.068, backward: 11.041, update: 0.350
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 15.519, sample: 0.580, forward: 1.345, backward: 12.523, update: 0.371
[Rank7] pid = 21173
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
train_sampler.Prefill()
-------Step 0-------
tensor([  170,    52,  3816,   161, 12287, 12721,  1854,  7641, 12580, 11042]) tensor([ 2489, 10290,  6408, 11881,    73,  1759,  1282,  5303,  1072, 13356])
-------Step 1-------
tensor([  170,    52,  3816,   161, 12287, 12721,  1854,  7641, 12580, 11042]) tensor([  946,   243, 14374,  2054,  1743,  8092, 13596, 10846,  5389, 12574])
-------Step 2-------
tensor([ 7515, 10362,  5957,  4266,    79,  8413, 10941,  5332, 10696,  1637]) tensor([ 4551,  5619,  4334,  6957,   325,  8514, 14088,  9339, 12744, 10525])
-------Step 3-------
tensor([ 7515, 10362,  5957,  4266,    79,  8413, 10941,  5332, 10696,  1637]) tensor([ 8202,  7363,  7536, 10937,  7652,  1383,   584,  2891, 13191,  2893])
-------Step 4-------
tensor([   52, 13404, 11375,  5670,  6857,  4102,    18,  7642,   131,  1753]) tensor([1192, 1809,  570, 3641, 3125, 3159, 7641, 7461, 6237, 2611])
-------Step 5-------
tensor([   52, 13404, 11375,  5670,  6857,  4102,    18,  7642,   131,  1753]) tensor([11998,  5350,   531,  2520,  3980,  1556,  1555,  2028,  5347,  7118])
-------Step 6-------
tensor([ 2442,  8989,    31,    83,  9265,  3229,  8860, 12058, 13386,    41]) tensor([10362,  3473,  7977,  4944,  9124,  8997,  4620,  8467,  9823, 12625])
-------Step 7-------
tensor([ 2442,  8989,    31,    83,  9265,  3229,  8860, 12058, 13386,    41]) tensor([13542,   801,  4055,  7271,  2023,  1458,  7838,  4580,  8643,  1396])
-------Step 8-------
tensor([ 4068,  8057,  5525, 13243,    64,    51,  9385, 13312,    78,  2823]) tensor([ 6970,  5232,  4861,  7512,  3406, 14162,  9207,  2155, 10645,  4013])
-------Step 9-------
tensor([ 4068,  8057,  5525, 13243,    64,    51,  9385, 13312,    78,  2823]) tensor([12427,  4324, 13230,  8452, 14884,   792, 14241, 10846,  1413, 13461])
before start barrier
start train
[proc 0] 100 steps, total: 15.515, sample: 0.564, forward: 1.456, backward: 11.888, update: 0.398
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.521, sample: 0.370, forward: 1.196, backward: 10.778, update: 0.357
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.850 ms                  | 32.917 ms                 |
| Forward                   | 9.984 ms                  | 19.549 ms                 |
| Backward                  | 113.711 ms                | 148.777 ms                |
| Optimize                  | 3.505 ms                  | 7.839 ms                  |
| BarrierTimeBeforeRank0    | 6.959 ms                  | 44.936 ms                 |
| BlockToStepN              | 34.996 us                 | 261.105 us                |
| OneStep                   | 142.517 ms                | 189.630 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.826 ms                  | 31.065 ms                 |
| Forward                   | 9.771 ms                  | 14.182 ms                 |
| Backward                  | 111.406 ms                | 138.443 ms                |
| Optimize                  | 3.505 ms                  | 7.729 ms                  |
| BarrierTimeBeforeRank0    | 7.775 ms                  | 47.234 ms                 |
| BlockToStepN              | 34.649 us                 | 190.285 us                |
| OneStep                   | 140.724 ms                | 378.250 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.698 ms                  | 31.065 ms                 |
| Forward                   | 9.338 ms                  | 14.415 ms                 |
| Backward                  | 110.647 ms                | 138.443 ms                |
| Optimize                  | 3.430 ms                  | 7.729 ms                  |
| BarrierTimeBeforeRank0    | 9.937 ms                  | 91.990 ms                 |
| BlockToStepN              | 34.545 us                 | 190.285 us                |
| OneStep                   | 142.460 ms                | 378.250 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 14.886, sample: 0.367, forward: 0.593, backward: 10.413, update: 0.266
[proc 6] 200 steps, total: 14.886, sample: 0.404, forward: 0.673, backward: 11.519, update: 0.206
[proc 5] 200 steps, total: 14.886, sample: 0.529, forward: 0.814, backward: 11.769, update: 0.306
[proc 3] 200 steps, total: 14.886, sample: 0.461, forward: 0.702, backward: 11.275, update: 0.284
[proc 7] 200 steps, total: 14.886, sample: 0.401, forward: 0.682, backward: 11.250, update: 0.208
[proc 1] 200 steps, total: 14.885, sample: 0.424, forward: 0.702, backward: 10.644, update: 0.280
[proc 0] 200 steps, total: 14.885, sample: 0.540, forward: 0.897, backward: 10.384, update: 0.341
[proc 4] 200 steps, total: 14.885, sample: 0.563, forward: 0.867, backward: 12.031, update: 0.309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.420 ms                  | 31.065 ms                 |
| Forward                   | 9.013 ms                  | 16.883 ms                 |
| Backward                  | 111.260 ms                | 138.443 ms                |
| Optimize                  | 3.454 ms                  | 7.729 ms                  |
| BarrierTimeBeforeRank0    | 11.703 ms                 | 103.446 ms                |
| BlockToStepN              | 34.447 us                 | 196.537 us                |
| OneStep                   | 145.314 ms                | 378.250 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.271 ms                  | 30.707 ms                 |
| Forward                   | 8.790 ms                  | 14.415 ms                 |
| Backward                  | 110.942 ms                | 138.443 ms                |
| Optimize                  | 3.464 ms                  | 6.962 ms                  |
| BarrierTimeBeforeRank0    | 13.159 ms                 | 91.990 ms                 |
| BlockToStepN              | 34.263 us                 | 190.285 us                |
| OneStep                   | 147.374 ms                | 363.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.147 ms                  | 31.725 ms                 |
| Forward                   | 8.634 ms                  | 14.415 ms                 |
| Backward                  | 110.942 ms                | 138.443 ms                |
| Optimize                  | 3.463 ms                  | 6.962 ms                  |
| BarrierTimeBeforeRank0    | 13.873 ms                 | 91.990 ms                 |
| BlockToStepN              | 34.373 us                 | 190.285 us                |
| OneStep                   | 147.325 ms                | 363.437 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 15.303, sample: 0.307, forward: 0.534, backward: 10.153, update: 0.241
[proc 3] 300 steps, total: 15.303, sample: 0.407, forward: 0.712, backward: 11.539, update: 0.260
[proc 4] 300 steps, total: 15.303, sample: 0.425, forward: 0.699, backward: 11.550, update: 0.231
[proc 6] 300 steps, total: 15.303, sample: 0.389, forward: 0.733, backward: 12.156, update: 0.253
[proc 5] 300 steps, total: 15.303, sample: 0.413, forward: 0.633, backward: 11.504, update: 0.271
[proc 0] 300 steps, total: 15.303, sample: 0.448, forward: 0.805, backward: 11.255, update: 0.365
[proc 1] 300 steps, total: 15.303, sample: 0.371, forward: 0.651, backward: 11.008, update: 0.301
[proc 7] 300 steps, total: 15.303, sample: 0.462, forward: 0.709, backward: 11.502, update: 0.298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.066 ms                  | 31.725 ms                 |
| Forward                   | 8.463 ms                  | 14.415 ms                 |
| Backward                  | 110.803 ms                | 138.443 ms                |
| Optimize                  | 3.476 ms                  | 6.962 ms                  |
| BarrierTimeBeforeRank0    | 15.398 ms                 | 91.990 ms                 |
| BlockToStepN              | 34.173 us                 | 190.285 us                |
| OneStep                   | 147.239 ms                | 363.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.099 ms                  | 31.725 ms                 |
| Forward                   | 8.463 ms                  | 14.415 ms                 |
| Backward                  | 110.853 ms                | 133.090 ms                |
| Optimize                  | 3.479 ms                  | 6.962 ms                  |
| BarrierTimeBeforeRank0    | 15.695 ms                 | 123.539 ms                |
| BlockToStepN              | 34.268 us                 | 188.288 us                |
| OneStep                   | 146.730 ms                | 311.050 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.167 ms                  | 31.758 ms                 |
| Forward                   | 8.527 ms                  | 14.415 ms                 |
| Backward                  | 110.890 ms                | 133.090 ms                |
| Optimize                  | 3.518 ms                  | 6.970 ms                  |
| BarrierTimeBeforeRank0    | 14.848 ms                 | 123.539 ms                |
| BlockToStepN              | 33.997 us                 | 190.285 us                |
| OneStep                   | 145.607 ms                | 311.050 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 14.847, sample: 0.414, forward: 0.672, backward: 11.358, update: 0.264
[proc 5] 400 steps, total: 14.847, sample: 0.468, forward: 0.657, backward: 10.623, update: 0.301
[proc 4] 400 steps, total: 14.847, sample: 0.344, forward: 0.584, backward: 11.451, update: 0.167
[proc 6] 400 steps, total: 14.847, sample: 0.398, forward: 0.684, backward: 12.183, update: 0.171
[proc 2] 400 steps, total: 14.847, sample: 0.360, forward: 0.645, backward: 10.613, update: 0.241
[proc 0] 400 steps, total: 14.847, sample: 0.530, forward: 0.877, backward: 11.116, update: 0.397
[proc 1] 400 steps, total: 14.847, sample: 0.429, forward: 0.673, backward: 10.410, update: 0.295
[proc 7] 400 steps, total: 14.847, sample: 0.434, forward: 0.781, backward: 11.609, update: 0.272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.193 ms                  | 31.886 ms                 |
| Forward                   | 8.527 ms                  | 14.415 ms                 |
| Backward                  | 110.972 ms                | 133.090 ms                |
| Optimize                  | 3.527 ms                  | 6.970 ms                  |
| BarrierTimeBeforeRank0    | 14.567 ms                 | 123.539 ms                |
| BlockToStepN              | 33.890 us                 | 192.332 us                |
| OneStep                   | 145.455 ms                | 311.050 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.242 ms                  | 31.758 ms                 |
| Forward                   | 8.625 ms                  | 14.415 ms                 |
| Backward                  | 111.109 ms                | 132.103 ms                |
| Optimize                  | 3.531 ms                  | 6.970 ms                  |
| BarrierTimeBeforeRank0    | 13.731 ms                 | 103.446 ms                |
| BlockToStepN              | 34.123 us                 | 190.285 us                |
| OneStep                   | 145.048 ms                | 275.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.371 ms                  | 32.216 ms                 |
| Forward                   | 8.736 ms                  | 15.874 ms                 |
| Backward                  | 111.190 ms                | 132.103 ms                |
| Optimize                  | 3.551 ms                  | 6.970 ms                  |
| BarrierTimeBeforeRank0    | 12.985 ms                 | 123.539 ms                |
| BlockToStepN              | 34.457 us                 | 190.285 us                |
| OneStep                   | 144.567 ms                | 276.413 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 14.890, sample: 0.304, forward: 0.586, backward: 11.392, update: 0.165
[proc 6] 500 steps, total: 14.890, sample: 0.344, forward: 0.658, backward: 11.919, update: 0.175
[proc 5] 500 steps, total: 14.890, sample: 0.441, forward: 0.697, backward: 10.719, update: 0.286
[proc 7] 500 steps, total: 14.890, sample: 0.555, forward: 0.804, backward: 11.629, update: 0.285
[proc 0] 500 steps, total: 14.890, sample: 0.589, forward: 0.992, backward: 11.286, update: 0.378
[proc 3] 500 steps, total: 14.890, sample: 0.511, forward: 0.768, backward: 11.653, update: 0.292
Successfully xmh. training takes 75.44045209884644 seconds
before call kg_cache_controller.StopThreads()
[proc 1] 500 steps, total: 14.890, sample: 0.364, forward: 0.645, backward: 10.537, update: 0.238
[proc 2] 500 steps, total: 14.890, sample: 0.459, forward: 0.666, backward: 10.623, update: 0.286
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
INFO [20643 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
