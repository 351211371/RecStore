WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240211 05:43:39.801553 40778 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_211', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [40778 sampler.py:454] Start PreSampling
WARNING [40778 sampler.py:532] Before construct renumbering_dict
WARNING [40778 sampler.py:555] PreSampling done
W20240211 05:43:45.414463 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240211 05:43:45.414692 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240211 05:43:45.414757 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240211 05:43:45.414804 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240211 05:43:45.414856 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240211 05:43:45.414914 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240211 05:43:45.414969 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240211 05:43:45.415025 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240211 05:43:45.415082 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240211 05:43:45.415138 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240211 05:43:45.415194 40778 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240211 05:43:45.415236 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240211 05:43:45.415282 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240211 05:43:45.415439 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240211 05:43:45.415496 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240211 05:43:45.415542 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240211 05:43:45.415604 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240211 05:43:45.415670 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240211 05:43:45.415730 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240211 05:43:45.415793 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240211 05:43:45.415843 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240211 05:43:45.415892 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240211 05:43:45.415947 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240211 05:43:45.415993 40778 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240211 05:43:45.416031 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240211 05:43:45.416081 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240211 05:43:45.416182 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240211 05:43:45.416234 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240211 05:43:45.416277 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240211 05:43:45.416330 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240211 05:43:45.416375 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240211 05:43:45.416422 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240211 05:43:45.416484 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240211 05:43:45.416538 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240211 05:43:45.416594 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240211 05:43:45.416638 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240211 05:43:45.416690 40778 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240211 05:43:45.416729 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240211 05:43:45.416770 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240211 05:43:45.416865 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240211 05:43:45.416923 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240211 05:43:45.416988 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240211 05:43:45.417045 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240211 05:43:45.417104 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240211 05:43:45.417161 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240211 05:43:45.417215 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240211 05:43:45.417272 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240211 05:43:45.417328 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240211 05:43:45.417373 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240211 05:43:45.417419 40778 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240211 05:43:45.417457 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240211 05:43:45.417498 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240211 05:43:45.417591 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240211 05:43:45.417637 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240211 05:43:45.417683 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240211 05:43:45.417749 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240211 05:43:45.417797 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240211 05:43:45.417853 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240211 05:43:45.417899 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240211 05:43:45.417944 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240211 05:43:45.417992 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240211 05:43:45.418051 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240211 05:43:45.418097 40778 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240211 05:43:45.418139 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240211 05:43:45.418179 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240211 05:43:45.418267 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240211 05:43:45.418319 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240211 05:43:45.418380 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240211 05:43:45.418433 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240211 05:43:45.418489 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240211 05:43:45.418542 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240211 05:43:45.418594 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240211 05:43:45.418649 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240211 05:43:45.418695 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240211 05:43:45.418753 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240211 05:43:45.418805 40778 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240211 05:43:45.418844 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240211 05:43:45.418882 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240211 05:43:45.418962 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240211 05:43:45.419020 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240211 05:43:45.419075 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240211 05:43:45.419121 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240211 05:43:45.419171 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240211 05:43:45.419232 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240211 05:43:45.419286 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240211 05:43:45.419345 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240211 05:43:45.419400 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240211 05:43:45.419458 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240211 05:43:45.419510 40778 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240211 05:43:45.419549 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240211 05:43:45.419590 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240211 05:43:45.419679 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240211 05:43:45.419734 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240211 05:43:45.419787 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240211 05:43:45.419837 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240211 05:43:45.419884 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240211 05:43:45.419935 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240211 05:43:45.419981 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240211 05:43:45.420034 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240211 05:43:45.420104 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240211 05:43:45.420154 40778 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240211 05:43:45.420207 40778 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240211 05:43:45.420246 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240211 05:43:45.420284 40778 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240211 05:43:45.666873 40778 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240211 05:43:45.758661 40778 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 744, 1134, 1659,  ..., 8762, 8805, 7003]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.056 seconds
[Rank1] pid = 40988
[Rank2] pid = 41032
[Rank3] pid = 41116
[Rank4] pid = 41180
[Rank5] pid = 41245
[Rank6] pid = 41255
INFO [40778 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [40988 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41032 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [41116 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [41255 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [41180 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [41318 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [41245 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [41245 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41180 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41116 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41318 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41032 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41255 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40778 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40988 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240211 05:43:48.489820 41319 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240211 05:43:48.490456 41246 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240211 05:43:48.490954 40989 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240211 05:43:48.490967 41117 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240211 05:43:48.490983 41181 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240211 05:43:48.490985 41375 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240211 05:43:48.491014 41320 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240211 05:43:48.491012 41053 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240211 05:43:48.527204 41375 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a14000 7.629 MB
W20240211 05:43:48.527431 41319 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10002895a000 7.629 MB
W20240211 05:43:48.527428 41117 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000281b7000 7.629 MB
W20240211 05:43:48.527452 41181 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000290fd000 7.629 MB
W20240211 05:43:48.527458 41246 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000298a0000 7.629 MB
W20240211 05:43:48.527577 41320 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10002a043000 7.629 MB
W20240211 05:43:48.527582 40989 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10002a7e6000 7.629 MB
W20240211 05:43:48.527607 41375 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10002b72c000 7.629 MB
W20240211 05:43:48.527607 41053 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10002af89000 7.629 MB
W20240211 05:43:48.527711 41375 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002becf000 1.49 GB
W20240211 05:43:48.527770 41375 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10008b4b2000 1.49 GB
W20240211 05:43:48.527807 41246 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000eaa95000 7.629 MB
W20240211 05:43:48.527808 41319 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000eb238000 7.629 MB
W20240211 05:43:48.527833 41117 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000eb9db000 7.629 MB
W20240211 05:43:48.527870 41375 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240211 05:43:48.527873 40989 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ec17e000 7.629 MB
W20240211 05:43:48.527887 41319 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1000ec921000 1.49 GB
W20240211 05:43:48.527946 41319 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10014bf04000 1.49 GB
W20240211 05:43:48.527979 41053 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1001ab4e7000 7.629 MB
W20240211 05:43:48.527987 41320 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1001abc8a000 7.629 MB
W20240211 05:43:48.527993 40989 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1001ac42d000 1.49 GB
W20240211 05:43:48.528018 41181 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10020ba10000 7.629 MB
W20240211 05:43:48.528144 40989 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10020c1b3000 1.49 GB
W20240211 05:43:48.529678 41320 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10026b796000 1.49 GB
W20240211 05:43:48.529762 41117 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1002cad79000 1.49 GB
W20240211 05:43:48.529770 41320 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10032a35c000 1.49 GB
W20240211 05:43:48.529781 41246 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10038993f000 1.49 GB
W20240211 05:43:48.529846 41117 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1003e8f22000 1.49 GB
W20240211 05:43:48.529876 41246 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100448507000 1.49 GB
W20240211 05:43:48.529906 41181 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1004a7aea000 1.49 GB
W20240211 05:43:48.529932 41053 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1005070cd000 1.49 GB
W20240211 05:43:48.529940 41246 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240211 05:43:48.529968 41117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240211 05:43:48.529983 40989 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240211 05:43:48.529989 41181 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1005666b0000 1.49 GB
W20240211 05:43:48.529999 41053 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005c5c93000 1.49 GB
W20240211 05:43:48.530130 41375 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240211 05:43:48.531572 41319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240211 05:43:48.531580 41053 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240211 05:43:48.531585 41181 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240211 05:43:48.531625 41320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240211 05:43:48.543200 41246 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240211 05:43:48.543361 41319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240211 05:43:48.543385 41117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240211 05:43:48.543408 40989 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240211 05:43:48.543416 41053 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240211 05:43:48.544972 41181 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240211 05:43:48.544988 41320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [41116 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [41032 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [40988 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [41180 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [41318 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [41245 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [41255 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 41318
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [40778 DistTensor.py:59] The tensor name already exists in the kvstore
I20240211 05:43:51.358940 41319 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.359622 41246 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.360042 41053 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.360582 41117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.360734 41375 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.361056 40989 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.361263 41181 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240211 05:43:51.361343 41320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240211 05:43:52.174862 41246 recstore.cc:66] init folly done
E20240211 05:43:52.175036 41320 recstore.cc:66] init folly done
E20240211 05:43:52.175554 41181 recstore.cc:66] init folly done
E20240211 05:43:52.175545 41375 recstore.cc:66] init folly done
E20240211 05:43:52.175562 41053 recstore.cc:66] init folly done
E20240211 05:43:52.175716 41117 recstore.cc:66] init folly done
E20240211 05:43:52.175766 41319 recstore.cc:66] init folly done
E20240211 05:43:52.175719 40989 recstore.cc:66] init folly done
I20240211 05:43:52.251248 41319 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240211 05:43:52.251513 41117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.251814 41246 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.254314 41375 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.262163 40989 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.262817 41181 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.264994 41053 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 05:43:52.269618 41320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 985.291 us                | 985.291 us                |
| Forward                   | 627.686 ms                | 627.686 ms                |
| back: bucket keys         | 14.265 ms                 | 14.265 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.133 ms                  | 5.117 ms                  |
| Forward                   | 6.576 ms                  | 627.686 ms                |
| back: bucket keys         | 583.831 us                | 14.265 ms                 |
| back: a2a                 | 14.579 ms                 | 51.745 s                  |
| back: cache               | 5.716 ms                  | 17.117 ms                 |
| back: aggr dram keys      | 58.093 ms                 | 985.605 ms                |
| back: set dram grad       | 2.458 ms                  | 2.842 ms                  |
| Backward                  | 151.131 ms                | 53.103 s                  |
| Optimize                  | 37.583 ms                 | 44.784 ms                 |
| BarrierTimeBeforeRank0    | 41.615 us                 | 96.090 us                 |
| BlockToStepN              | 69.532 us                 | 143.127 us                |
| OneStep                   | 201.070 ms                | 53.777 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.665 ms                  | 22.357 ms                 |
| Forward                   | 5.088 ms                  | 627.686 ms                |
| back: bucket keys         | 843.787 us                | 2.326 ms                  |
| back: a2a                 | 12.263 ms                 | 21.846 ms                 |
| back: cache               | 7.000 ms                  | 13.150 ms                 |
| back: aggr dram keys      | 49.981 ms                 | 62.364 ms                 |
| back: set dram grad       | 2.445 ms                  | 6.048 ms                  |
| Backward                  | 152.444 ms                | 53.103 s                  |
| Optimize                  | 30.851 ms                 | 53.615 ms                 |
| BarrierTimeBeforeRank0    | 51.624 us                 | 205.631 us                |
| BlockToStepN              | 111.903 us                | 501.216 us                |
| OneStep                   | 195.598 ms                | 53.777 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.790 ms                  | 20.079 ms                 |
| Forward                   | 5.149 ms                  | 9.540 ms                  |
| back: bucket keys         | 752.350 us                | 6.793 ms                  |
| back: a2a                 | 12.876 ms                 | 33.717 ms                 |
| back: cache               | 7.404 ms                  | 15.864 ms                 |
| back: aggr dram keys      | 50.057 ms                 | 69.780 ms                 |
| back: set dram grad       | 2.445 ms                  | 6.222 ms                  |
| Backward                  | 153.206 ms                | 190.516 ms                |
| Optimize                  | 31.128 ms                 | 51.901 ms                 |
| BarrierTimeBeforeRank0    | 58.242 us                 | 158.753 us                |
| BlockToStepN              | 118.380 us                | 972.004 us                |
| OneStep                   | 196.378 ms                | 239.065 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.037 ms                  | 28.707 ms                 |
| Forward                   | 5.837 ms                  | 14.085 ms                 |
| back: bucket keys         | 843.787 us                | 2.853 ms                  |
| back: a2a                 | 12.698 ms                 | 31.520 ms                 |
| back: cache               | 7.309 ms                  | 15.864 ms                 |
| back: aggr dram keys      | 50.169 ms                 | 69.143 ms                 |
| back: set dram grad       | 2.448 ms                  | 6.222 ms                  |
| Backward                  | 153.206 ms                | 190.516 ms                |
| Optimize                  | 33.190 ms                 | 66.618 ms                 |
| BarrierTimeBeforeRank0    | 62.752 us                 | 158.753 us                |
| BlockToStepN              | 120.288 us                | 972.004 us                |
| OneStep                   | 201.070 ms                | 265.956 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 73.806, sample: 0.355, forward: 1.093, backward: 64.806, update: 0.368
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 73.801, sample: 0.342, forward: 1.082, backward: 64.838, update: 0.347
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 73.820, sample: 0.349, forward: 1.032, backward: 64.857, update: 0.376
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 73.817, sample: 0.340, forward: 1.030, backward: 64.849, update: 0.400
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 73.808, sample: 0.351, forward: 1.068, backward: 64.829, update: 0.312
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 73.820, sample: 0.356, forward: 1.096, backward: 64.800, update: 0.299
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 73.809, sample: 0.350, forward: 1.107, backward: 64.814, update: 0.360
train_sampler.Prefill()
-------Step 0-------
tensor([ 1944,    81,  3009,  3175, 11929, 12926,  1164,   436, 13778, 11502]) tensor([ 1659,  9739,  5573, 10826, 10710,  1028,   583,  4817,   511, 13010])
-------Step 1-------
tensor([ 1944,    81,  3009,  3175, 11929, 12926,  1164,   436, 13778, 11502]) tensor([ 3754, 10792, 14803,  1493,   995,  7978, 14515, 10474,  5333, 12689])
-------Step 2-------
tensor([ 7108, 10755,  5678,  4080,  9986,  9089, 10197,    82, 10661,   906]) tensor([ 3416,  4819,  3659,  8344,  5894,  8425, 13280, 10268, 13560,  9476])
-------Step 3-------
tensor([ 7108, 10755,  5678,  4080,  9986,  9089, 10197,    82, 10661,   906]) tensor([ 8398,  6770,  7240, 10900,  7420,   710,  4843,  2100, 12370,  2081])
-------Step 4-------
tensor([   81, 10906, 10858,  5277,  5253,  3268,    92,  6823,  7198,  1015]) tensor([ 611, 1146, 3880, 2607, 3003, 2564,  436, 6441, 5411, 1805])
-------Step 5-------
tensor([   81, 10906, 10858,  5277,  5253,  3268,    92,  6823,  7198,  1015]) tensor([11526,  4479,  6410,  1806,  3146,   818,   822,  1290,  5961,  6397])
-------Step 6-------
tensor([ 1639,  8079,     5,    27,  7477,  2924,  8922, 11378, 14066, 13240]) tensor([10755,  3098,  7840,  4286,  8951,  9145,  3802,  7110, 10051, 11673])
-------Step 7-------
tensor([ 1639,  8079,     5,    27,  7477,  2924,  8922, 11378, 14066, 13240]) tensor([12816, 10861,  4367,  6663,  1305,  8524,  7605,  3439,   154, 13063])
-------Step 8-------
tensor([ 3370,  7504,  4630, 12450,     4,    37,  9483, 12853,    42,  1987]) tensor([ 6218,  5446,  3743,  7508,  2662, 13970,  9344,  1506,  8654,  3224])
-------Step 9-------
tensor([ 3370,  7504,  4630, 12450,     4,    37,  9483, 12853,    42,  1987]) tensor([12093,  3789, 13054,  8390, 14850, 13863, 13764, 10474,   658, 13336])
before start barrier
start train
[proc 0] 100 steps, total: 73.820, sample: 0.444, forward: 1.224, backward: 68.490, update: 3.492
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.959 ms                  | 28.707 ms                 |
| Forward                   | 5.505 ms                  | 14.085 ms                 |
| back: bucket keys         | 803.483 us                | 2.853 ms                  |
| back: a2a                 | 12.641 ms                 | 31.520 ms                 |
| back: cache               | 7.232 ms                  | 15.864 ms                 |
| back: aggr dram keys      | 50.470 ms                 | 69.143 ms                 |
| back: set dram grad       | 2.449 ms                  | 6.313 ms                  |
| Backward                  | 154.374 ms                | 190.516 ms                |
| Optimize                  | 32.844 ms                 | 69.541 ms                 |
| BarrierTimeBeforeRank0    | 61.807 us                 | 158.753 us                |
| BlockToStepN              | 125.066 us                | 972.004 us                |
| OneStep                   | 200.018 ms                | 265.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.838 ms                  | 28.707 ms                 |
| Forward                   | 5.401 ms                  | 14.085 ms                 |
| back: bucket keys         | 747.323 us                | 2.326 ms                  |
| back: a2a                 | 12.641 ms                 | 23.835 ms                 |
| back: cache               | 7.131 ms                  | 14.561 ms                 |
| back: aggr dram keys      | 50.725 ms                 | 69.780 ms                 |
| back: set dram grad       | 2.431 ms                  | 6.313 ms                  |
| Backward                  | 154.374 ms                | 190.516 ms                |
| Optimize                  | 33.906 ms                 | 69.541 ms                 |
| BarrierTimeBeforeRank0    | 58.658 us                 | 158.753 us                |
| BlockToStepN              | 125.249 us                | 1.571 ms                  |
| OneStep                   | 200.018 ms                | 265.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.802 ms                  | 28.416 ms                 |
| Forward                   | 5.224 ms                  | 14.003 ms                 |
| back: bucket keys         | 689.002 us                | 2.326 ms                  |
| back: a2a                 | 12.620 ms                 | 33.717 ms                 |
| back: cache               | 6.808 ms                  | 14.561 ms                 |
| back: aggr dram keys      | 50.951 ms                 | 69.780 ms                 |
| back: set dram grad       | 2.431 ms                  | 6.867 ms                  |
| Backward                  | 154.879 ms                | 186.681 ms                |
| Optimize                  | 34.398 ms                 | 66.618 ms                 |
| BarrierTimeBeforeRank0    | 58.669 us                 | 151.224 us                |
| BlockToStepN              | 126.284 us                | 972.004 us                |
| OneStep                   | 200.985 ms                | 253.480 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.766 ms                  | 28.416 ms                 |
| Forward                   | 5.102 ms                  | 14.003 ms                 |
| back: bucket keys         | 650.059 us                | 2.075 ms                  |
| back: a2a                 | 12.572 ms                 | 35.614 ms                 |
| back: cache               | 6.483 ms                  | 14.098 ms                 |
| back: aggr dram keys      | 50.951 ms                 | 69.143 ms                 |
| back: set dram grad       | 2.400 ms                  | 8.561 ms                  |
| Backward                  | 155.138 ms                | 186.681 ms                |
| Optimize                  | 33.991 ms                 | 66.618 ms                 |
| BarrierTimeBeforeRank0    | 58.535 us                 | 151.224 us                |
| BlockToStepN              | 125.249 us                | 1.571 ms                  |
| OneStep                   | 200.402 ms                | 253.480 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 91.89893436431885 seconds
before call kg_cache_controller.StopThreads()
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
INFO [40778 controller_process.py:421] call rank0 to StopThreads
