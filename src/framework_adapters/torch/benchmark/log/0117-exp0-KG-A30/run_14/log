WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240118 20:27:43.666146 1088152 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_4', no_save_emb=True, max_step=500, batch_size=4800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1088152 sampler.py:454] Start PreSampling
WARNING [1088152 sampler.py:532] Before construct renumbering_dict
WARNING [1088152 sampler.py:555] PreSampling done
W20240118 20:27:45.806413 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240118 20:27:45.806520 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240118 20:27:45.806540 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240118 20:27:45.806558 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240118 20:27:45.806578 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240118 20:27:45.806598 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240118 20:27:45.806615 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240118 20:27:45.806635 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240118 20:27:45.806653 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240118 20:27:45.806670 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240118 20:27:45.806695 1088152 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240118 20:27:45.806711 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240118 20:27:45.806726 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240118 20:27:45.806819 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240118 20:27:45.806841 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240118 20:27:45.806857 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240118 20:27:45.806872 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240118 20:27:45.806888 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240118 20:27:45.806919 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240118 20:27:45.806936 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240118 20:27:45.806952 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240118 20:27:45.806968 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240118 20:27:45.806985 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240118 20:27:45.807003 1088152 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240118 20:27:45.807016 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240118 20:27:45.807029 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240118 20:27:45.807063 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240118 20:27:45.807081 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240118 20:27:45.807097 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240118 20:27:45.807123 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240118 20:27:45.807140 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240118 20:27:45.807157 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240118 20:27:45.807173 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240118 20:27:45.807199 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240118 20:27:45.807215 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240118 20:27:45.807231 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240118 20:27:45.807247 1088152 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240118 20:27:45.807260 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240118 20:27:45.807273 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240118 20:27:45.807308 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240118 20:27:45.807327 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240118 20:27:45.807343 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240118 20:27:45.807360 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240118 20:27:45.807376 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240118 20:27:45.807392 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240118 20:27:45.807408 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240118 20:27:45.807425 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240118 20:27:45.807442 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240118 20:27:45.807459 1088152 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240118 20:27:45.807475 1088152 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240118 20:27:45.807489 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240118 20:27:45.807502 1088152 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240118 20:27:45.920222 1088152 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240118 20:27:45.920333 1088152 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9480, num_edges=154759,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11158, num_edges=169559,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=11355, num_edges=241153,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10394, num_edges=202691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9480 N 154759 E
MertisPartition: part 1 has 11158 N 169559 E
MertisPartition: part 2 has 11355 N 241153 E
MertisPartition: part 3 has 10394 N 202691 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    6,    10,    11,  ...,  2559,  7188, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
After renumbering graph:  {'_ID': tensor([1717, 1861, 1915,  ..., 8302, 6372, 7354]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.284 seconds
[Rank1] pid = 1088494
[Rank2] pid = 1088562
INFO [1088152 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1088494 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1088562 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1088599 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1088562 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1088494 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1088599 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [1088494 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1088562 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1088599 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [1088152 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [1088152 DistTensor.py:56] The tensor name already exists in the kvstore
I20240118 20:27:48.034389 1088628 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240118 20:27:48.034436 1088495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240118 20:27:48.034476 1088691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240118 20:27:48.034518 1088563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240118 20:27:48.451792 1088495 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240118 20:27:48.458195 1088691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240118 20:27:48.487262 1088628 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240118 20:27:48.489609 1088563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.197 ms                  | 27.001 ms                 |
| Forward                   | 12.942 ms                 | 805.083 ms                |
| Backward                  | 112.235 ms                | 1.206 s                   |
| Optimize                  | 3.886 ms                  | 9.629 ms                  |
| BarrierTimeBeforeRank0    | 39.131 ms                 | 76.289 ms                 |
| BlockToStepN              | 15.128 us                 | 58.931 us                 |
| OneStep                   | 186.011 ms                | 1.454 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.220 ms                  | 57.777 ms                 |
| Forward                   | 15.587 ms                 | 805.083 ms                |
| Backward                  | 113.689 ms                | 1.206 s                   |
| Optimize                  | 3.596 ms                  | 16.296 ms                 |
| BarrierTimeBeforeRank0    | 8.704 ms                  | 127.708 ms                |
| BlockToStepN              | 16.454 us                 | 58.931 us                 |
| OneStep                   | 168.571 ms                | 1.454 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.280 ms                  | 56.419 ms                 |
| Forward                   | 17.099 ms                 | 206.612 ms                |
| Backward                  | 112.572 ms                | 597.837 ms                |
| Optimize                  | 4.205 ms                  | 15.347 ms                 |
| BarrierTimeBeforeRank0    | 5.561 ms                  | 76.289 ms                 |
| BlockToStepN              | 17.705 us                 | 40.950 us                 |
| OneStep                   | 161.957 ms                | 1.424 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 100 steps, total: 19.199, sample: 0.697, forward: 2.311, backward: 13.840, update: 0.452
[proc 2] 100 steps, total: 19.161, sample: 0.707, forward: 2.289, backward: 13.662, update: 0.407
[proc 3] 100 steps, total: 19.193, sample: 0.635, forward: 2.342, backward: 13.820, update: 0.332
[Rank3] pid = 1088599
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
-------Step 0-------
tensor([10417, 14278, 13154, 11788,  5504,  6055,    18,  2100,  3383, 11200]) tensor([ 1915,   297,  7444, 13750, 10868,   111, 10912,  4438, 12594,  8092])
-------Step 1-------
tensor([10417, 14278, 13154, 11788,  5504,  6055,    18,  2100,  3383, 11200]) tensor([ 8246, 13019,  3927, 12971,  2656,  3308,  8290,  2376, 14626,  8779])
-------Step 2-------
tensor([    7, 12057,  8220,   381,   837,  8566,  3501,    53, 10758,   265]) tensor([ 9608, 10001,  8555,  7726,  2980,  6867,  7896,  4858, 11887, 11665])
-------Step 3-------
tensor([    7, 12057,  8220,   381,   837,  8566,  3501,    53, 10758,   265]) tensor([12732,  6376, 14880, 10362, 12852, 10959, 14543,  3802,  9172,  5369])
-------Step 4-------
tensor([12967,  5997,  7805,  5111,  1785,  4336,  1096, 13486, 10910,   205]) tensor([ 6292,  3617,  8810, 11742,  9295,  6688,    46, 14910,  7499,  5428])
-------Step 5-------
tensor([12967,  5997,  7805,  5111,  1785,  4336,  1096, 13486, 10910,   205]) tensor([ 5455, 11408,  5062,  8168, 13463,  6170, 12205,  4631,  9036,   297])
-------Step 6-------
tensor([ 2227,    58,  3550,   154, 13730,   168, 10009,  4800, 11676,  4100]) tensor([  509, 14051,  6467,   172,  1791,  2544,  9984, 14910,  9324,  6518])
-------Step 7-------
tensor([ 2227,    58,  3550,   154, 13730,   168, 10009,  4800, 11676,  4100]) tensor([ 7754,  5909, 12645,  5185,  6021,  2001,  1884, 13082,  6199,  8161])
-------Step 8-------
tensor([   52,  2140,  1411,  7866,  3511,  6793,  2499,   119, 10857, 12845]) tensor([ 5589,  2249,    96, 12164,  3929,  8964,  3868,  5045,   294,  8775])
-------Step 9-------
tensor([   52,  2140,  1411,  7866,  3511,  6793,  2499,   119, 10857, 12845]) tensor([  361,  1303,  6220,  7576,   112,  1402,  8774, 11803, 10577,  1139])
[proc 0] 100 steps, total: 19.164, sample: 0.680, forward: 2.656, backward: 13.377, update: 0.507
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.227 ms                  | 57.049 ms                 |
| Forward                   | 16.766 ms                 | 206.612 ms                |
| Backward                  | 112.345 ms                | 597.837 ms                |
| Optimize                  | 4.205 ms                  | 15.347 ms                 |
| BarrierTimeBeforeRank0    | 6.748 ms                  | 76.289 ms                 |
| BlockToStepN              | 17.705 us                 | 57.602 us                 |
| OneStep                   | 161.384 ms                | 1.424 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.224 ms                  | 57.777 ms                 |
| Forward                   | 16.644 ms                 | 206.612 ms                |
| Backward                  | 112.345 ms                | 597.837 ms                |
| Optimize                  | 4.205 ms                  | 15.347 ms                 |
| BarrierTimeBeforeRank0    | 6.748 ms                  | 89.717 ms                 |
| BlockToStepN              | 18.122 us                 | 57.602 us                 |
| OneStep                   | 161.041 ms                | 1.424 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.220 ms                  | 57.049 ms                 |
| Forward                   | 16.721 ms                 | 32.103 ms                 |
| Backward                  | 112.312 ms                | 193.039 ms                |
| Optimize                  | 4.222 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 7.833 ms                  | 85.743 ms                 |
| BlockToStepN              | 19.092 us                 | 49.618 us                 |
| OneStep                   | 159.735 ms                | 307.063 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.197 ms                  | 57.777 ms                 |
| Forward                   | 16.617 ms                 | 32.103 ms                 |
| Backward                  | 112.235 ms                | 193.039 ms                |
| Optimize                  | 4.355 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.312 ms                  | 85.743 ms                 |
| BlockToStepN              | 19.081 us                 | 57.602 us                 |
| OneStep                   | 159.207 ms                | 307.063 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 16.261, sample: 0.642, forward: 1.380, backward: 11.228, update: 0.399
[proc 3] 200 steps, total: 16.261, sample: 0.659, forward: 1.574, backward: 11.747, update: 0.413
[proc 0] 200 steps, total: 16.261, sample: 0.823, forward: 1.634, backward: 11.436, update: 0.496
[proc 2] 200 steps, total: 16.261, sample: 0.745, forward: 1.680, backward: 11.902, update: 0.421
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.209 ms                  | 57.777 ms                 |
| Forward                   | 16.639 ms                 | 33.790 ms                 |
| Backward                  | 112.345 ms                | 193.039 ms                |
| Optimize                  | 4.408 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.320 ms                  | 89.717 ms                 |
| BlockToStepN              | 19.092 us                 | 58.896 us                 |
| OneStep                   | 157.996 ms                | 307.063 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.131 ms                  | 57.777 ms                 |
| Forward                   | 16.615 ms                 | 32.103 ms                 |
| Backward                  | 112.275 ms                | 184.632 ms                |
| Optimize                  | 4.499 ms                  | 14.920 ms                 |
| BarrierTimeBeforeRank0    | 8.470 ms                  | 88.184 ms                 |
| BlockToStepN              | 19.081 us                 | 57.602 us                 |
| OneStep                   | 157.228 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.060 ms                  | 57.777 ms                 |
| Forward                   | 16.440 ms                 | 32.103 ms                 |
| Backward                  | 112.340 ms                | 185.407 ms                |
| Optimize                  | 4.408 ms                  | 14.920 ms                 |
| BarrierTimeBeforeRank0    | 8.496 ms                  | 88.184 ms                 |
| BlockToStepN              | 18.837 us                 | 58.931 us                 |
| OneStep                   | 157.228 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 16.412, sample: 0.697, forward: 1.478, backward: 11.784, update: 0.427
[proc 0] 300 steps, total: 16.412, sample: 0.708, forward: 1.639, backward: 11.444, update: 0.520
[proc 2] 300 steps, total: 16.412, sample: 0.830, forward: 1.587, backward: 12.046, update: 0.433
[proc 1] 300 steps, total: 16.412, sample: 0.680, forward: 1.511, backward: 11.279, update: 0.431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.094 ms                  | 57.777 ms                 |
| Forward                   | 16.510 ms                 | 32.103 ms                 |
| Backward                  | 112.389 ms                | 185.407 ms                |
| Optimize                  | 4.462 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.276 ms                  | 88.184 ms                 |
| BlockToStepN              | 19.038 us                 | 58.931 us                 |
| OneStep                   | 156.679 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.124 ms                  | 57.777 ms                 |
| Forward                   | 16.615 ms                 | 32.103 ms                 |
| Backward                  | 112.401 ms                | 190.780 ms                |
| Optimize                  | 4.493 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 7.940 ms                  | 88.184 ms                 |
| BlockToStepN              | 18.896 us                 | 66.007 us                 |
| OneStep                   | 156.902 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.116 ms                  | 57.227 ms                 |
| Forward                   | 16.594 ms                 | 31.921 ms                 |
| Backward                  | 112.410 ms                | 187.386 ms                |
| Optimize                  | 4.555 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.227 ms                  | 85.743 ms                 |
| BlockToStepN              | 18.821 us                 | 58.931 us                 |
| OneStep                   | 156.664 ms                | 251.343 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 16.132, sample: 0.606, forward: 1.725, backward: 11.582, update: 0.516
[proc 1] 400 steps, total: 16.132, sample: 0.693, forward: 1.603, backward: 11.380, update: 0.451
[proc 2] 400 steps, total: 16.132, sample: 0.764, forward: 1.538, backward: 11.966, update: 0.469
[proc 3] 400 steps, total: 16.132, sample: 0.683, forward: 1.411, backward: 11.819, update: 0.411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.099 ms                  | 57.227 ms                 |
| Forward                   | 16.615 ms                 | 31.921 ms                 |
| Backward                  | 112.431 ms                | 187.386 ms                |
| Optimize                  | 4.510 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.276 ms                  | 88.184 ms                 |
| BlockToStepN              | 18.772 us                 | 64.304 us                 |
| OneStep                   | 155.826 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.059 ms                  | 57.227 ms                 |
| Forward                   | 16.617 ms                 | 31.921 ms                 |
| Backward                  | 112.431 ms                | 187.386 ms                |
| Optimize                  | 4.510 ms                  | 14.963 ms                 |
| BarrierTimeBeforeRank0    | 8.320 ms                  | 88.398 ms                 |
| BlockToStepN              | 18.719 us                 | 64.304 us                 |
| OneStep                   | 155.579 ms                | 252.027 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.050 ms                  | 57.049 ms                 |
| Forward                   | 16.605 ms                 | 31.457 ms                 |
| Backward                  | 112.431 ms                | 186.387 ms                |
| Optimize                  | 4.462 ms                  | 14.920 ms                 |
| BarrierTimeBeforeRank0    | 8.496 ms                  | 88.184 ms                 |
| BlockToStepN              | 18.631 us                 | 58.931 us                 |
| OneStep                   | 154.009 ms                | 251.343 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 16.239, sample: 0.773, forward: 1.730, backward: 11.945, update: 0.515
[proc 3] 500 steps, total: 16.239, sample: 0.763, forward: 1.522, backward: 11.759, update: 0.424
[proc 0] 500 steps, total: 16.239, sample: 0.620, forward: 1.535, backward: 11.430, update: 0.424
[proc 1] 500 steps, total: 16.239, sample: 0.701, forward: 1.460, backward: 11.287, update: 0.389
Successfully xmh. training takes 84.20862317085266 seconds
before call kg_cache_controller.StopThreads()
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
INFO [1088152 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.017 ms                  | 57.049 ms                 |
| Forward                   | 16.463 ms                 | 31.457 ms                 |
| Backward                  | 112.380 ms                | 186.387 ms                |
| Optimize                  | 4.386 ms                  | 14.920 ms                 |
| BarrierTimeBeforeRank0    | 8.734 ms                  | 89.717 ms                 |
| BlockToStepN              | 18.424 us                 | 58.931 us                 |
| OneStep                   | 154.222 ms                | 251.343 ms                |
+---------------------------+---------------------------+---------------------------+
