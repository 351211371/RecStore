WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 16:27:53.114481 64462 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_108', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [64462 sampler.py:454] Start PreSampling
WARNING [64462 sampler.py:532] Before construct renumbering_dict
WARNING [64462 sampler.py:555] PreSampling done
W20240125 16:28:05.260149 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 16:28:05.260823 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 16:28:05.260942 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 16:28:05.260987 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 16:28:05.261073 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 16:28:05.261157 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 16:28:05.261240 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 16:28:05.261389 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 16:28:05.261498 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 16:28:05.261601 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 16:28:05.261684 64462 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 16:28:05.261751 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 16:28:05.261783 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 16:28:05.262023 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 16:28:05.262135 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 16:28:05.262178 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 16:28:05.262259 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 16:28:05.262347 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 16:28:05.262437 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 16:28:05.262523 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 16:28:05.262612 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 16:28:05.262670 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 16:28:05.262795 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 16:28:05.262883 64462 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 16:28:05.262915 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 16:28:05.262988 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 16:28:05.263111 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 16:28:05.263154 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 16:28:05.263280 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 16:28:05.263353 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 16:28:05.263408 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 16:28:05.263500 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 16:28:05.263556 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 16:28:05.263589 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 16:28:05.263621 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 16:28:05.263660 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 16:28:05.263690 64462 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 16:28:05.263715 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 16:28:05.263741 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 16:28:05.263835 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 16:28:05.263873 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 16:28:05.263947 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 16:28:05.263983 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 16:28:05.264034 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 16:28:05.264101 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 16:28:05.264169 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 16:28:05.264240 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 16:28:05.264277 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 16:28:05.264367 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 16:28:05.264400 64462 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 16:28:05.264426 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 16:28:05.264489 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 16:28:05.264577 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 16:28:05.264629 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 16:28:05.264753 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 16:28:05.264858 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 16:28:05.265028 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 16:28:05.265116 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 16:28:05.265173 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 16:28:05.265205 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 16:28:05.265281 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 16:28:05.265355 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 16:28:05.265434 64462 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 16:28:05.265472 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 16:28:05.265551 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 16:28:05.265648 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 16:28:05.265791 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 16:28:05.265847 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 16:28:05.265916 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 16:28:05.265951 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 16:28:05.266016 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 16:28:05.266054 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 16:28:05.266105 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 16:28:05.266142 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 16:28:05.266196 64462 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 16:28:05.266322 64462 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 16:28:05.266352 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 16:28:05.266397 64462 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 16:28:05.790051 64462 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100002e52000 22.81 MB
W20240125 16:28:05.790477 64462 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100004524000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([ 964, 1246, 1489,  ..., 3090, 5596, 8266]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 12.837 seconds
[Rank1] pid = 337
[Rank2] pid = 473
[Rank3] pid = 477
[Rank4] pid = 633
INFO [64462 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [633 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [473 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [477 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [337 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [701 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [701 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [337 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [473 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [477 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [64462 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [633 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240125 16:28:08.722462   702 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240125 16:28:08.723093   545 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240125 16:28:08.723091   703 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240125 16:28:08.723088   634 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240125 16:28:08.723088   476 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240125 16:28:08.723089   343 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240125 16:28:08.752368   702 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x100004540000 781.2 kB
W20240125 16:28:08.752378   545 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1000046ca000 781.2 kB
W20240125 16:28:08.752374   343 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x100004605000 781.2 kB
W20240125 16:28:08.752406   634 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x10000478f000 781.2 kB
W20240125 16:28:08.752410   703 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x100004854000 781.2 kB
W20240125 16:28:08.752416   476 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x100004919000 781.2 kB
W20240125 16:28:08.752606   702 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x1000049de000 781.2 kB
W20240125 16:28:08.752611   476 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x100004aa3000 781.2 kB
W20240125 16:28:08.752630   703 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x100004b68000 781.2 kB
W20240125 16:28:08.752635   634 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x100004c2d000 781.2 kB
W20240125 16:28:08.752641   545 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x100004cf2000 781.2 kB
W20240125 16:28:08.752656   343 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x100004db7000 781.2 kB
W20240125 16:28:08.752674   702 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x100004e7c000 152.6 MB
W20240125 16:28:08.752712   476 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x10000e714000 152.6 MB
W20240125 16:28:08.752715   702 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100017fac000 152.6 MB
W20240125 16:28:08.752722   703 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x100021844000 152.6 MB
W20240125 16:28:08.752745   545 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10002b0dc000 152.6 MB
W20240125 16:28:08.752751   634 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x100034974000 152.6 MB
W20240125 16:28:08.752761   702 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:28:08.752772   343 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10003e20c000 152.6 MB
W20240125 16:28:08.752791   476 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x100047aa4000 152.6 MB
W20240125 16:28:08.752817   703 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10005133c000 152.6 MB
W20240125 16:28:08.752831   545 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10005abd4000 152.6 MB
W20240125 16:28:08.752846   634 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10006446c000 152.6 MB
W20240125 16:28:08.752872   703 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:28:08.752878   476 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:28:08.752880   343 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10006dd04000 152.6 MB
W20240125 16:28:08.752887   545 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:28:08.752894   634 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 16:28:08.752938   343 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:28:08.755971   545 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:28:08.755965   703 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:28:08.755967   343 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:28:08.755965   702 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:28:08.756002   476 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:28:08.756018   634 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
cudaHostRegister 0x100002e52000
3: KnownLocalCachedEmbedding init done
WARNING [477 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 701
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x100002e52000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100002e52000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100002e52000
4: KnownLocalCachedEmbedding init done
WARNING [64462 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [701 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [633 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
2: KnownLocalCachedEmbedding init done
WARNING [473 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
1: KnownLocalCachedEmbedding init done
WARNING [337 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 16:28:09.005303   343 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240125 16:28:09.005378   702 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240125 16:28:09.005439   545 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240125 16:28:09.005488   703 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240125 16:28:09.005537   476 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240125 16:28:09.005579   634 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240125 16:28:09.006565   702 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 16:28:09.006704   702 grad_base.h:172] Init GradProcessingBase done
I20240125 16:28:09.012399   702 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 16:28:09.012624   702 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 16:28:09.012637   702 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240125 16:28:10.812551   702 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 16:28:12.024722  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:28:12.025296  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 16:28:12.081872   703 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240125 16:28:12.108255   476 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240125 16:28:12.129516   545 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240125 16:28:12.131172   343 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240125 16:28:12.140087   634 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240125 16:28:12.317766   702 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.368 ms                  | 1.368 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 587.137 ms                | 587.167 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:17.047053  2079 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240125 16:28:17.289996   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 16:28:17.341615  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:28:18.046061  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=7663
W20240125 16:28:18.358484  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:28:18.397897   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.164 ms                  | 78.458 ms                 |
| Forward                   | 13.419 ms                 | 1.835 s                   |
| Backward                  | 6.690 ms                  | 688.777 ms                |
| Optimize                  | 4.008 ms                  | 15.046 ms                 |
| BarrierTimeBeforeRank0    | 1.170 ms                  | 121.115 ms                |
| AfterBackward             | 55.229 ms                 | 2.320 s                   |
| BlockToStepN              | 30.305 ms                 | 74.342 ms                 |
| OneStep                   | 171.574 ms                | 5.028 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:19.046036  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=6628
W20240125 16:28:19.374629  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240125 16:28:19.473345   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=14, pq.top=14
E20240125 16:28:20.046031  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4241
W20240125 16:28:20.497145   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240125 16:28:20.528848  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.239 ms                  | 587.167 ms                |
| ProcessBack:UpdateCache   | 8.531 ms                  | 1.442 s                   |
| ProcessBack:UpsertPq      | 35.153 ms                 | 247.205 ms                |
| ProcessOneStep            | 68.626 ms                 | 2.319 s                   |
| BlockToStepN              | 22.254 ms                 | 91.132 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:21.046041  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3878
W20240125 16:28:21.533406  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:28:21.578980   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=24, pq.top=24
E20240125 16:28:22.047178  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5965
W20240125 16:28:22.578037   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240125 16:28:22.656464  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:28:23.047089  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=306
W20240125 16:28:23.645382   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240125 16:28:23.754110  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.858 ms                  | 78.458 ms                 |
| Forward                   | 7.365 ms                  | 1.835 s                   |
| Backward                  | 6.690 ms                  | 688.777 ms                |
| Optimize                  | 3.207 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 13.509 ms                 | 121.115 ms                |
| AfterBackward             | 65.370 ms                 | 2.320 s                   |
| BlockToStepN              | 46.888 ms                 | 163.959 ms                |
| OneStep                   | 184.576 ms                | 5.028 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:24.050093  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3644
W20240125 16:28:24.645490   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240125 16:28:24.814683  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:28:25.056950  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=6307
W20240125 16:28:25.733336   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.877 ms                  | 587.137 ms                |
| ProcessBack:UpdateCache   | 6.496 ms                  | 1.426 s                   |
| ProcessBack:UpsertPq      | 32.864 ms                 | 233.843 ms                |
| ProcessOneStep            | 65.244 ms                 | 2.319 s                   |
| BlockToStepN              | 54.736 ms                 | 186.424 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:28:25.874439  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:28:26.059576  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3952
W20240125 16:28:26.733047   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240125 16:28:26.904250  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:28:27.059083  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=138
W20240125 16:28:27.733103   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240125 16:28:27.911767  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:28:28.066958  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3908
W20240125 16:28:28.897186   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240125 16:28:28.954304  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.855 ms                  | 50.241 ms                 |
| Forward                   | 7.498 ms                  | 32.764 ms                 |
| Backward                  | 6.697 ms                  | 25.420 ms                 |
| Optimize                  | 3.207 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 12.237 ms                 | 55.959 ms                 |
| AfterBackward             | 65.370 ms                 | 212.697 ms                |
| BlockToStepN              | 62.523 ms                 | 186.601 ms                |
| OneStep                   | 200.273 ms                | 408.915 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:29.066089  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2627
W20240125 16:28:29.961263  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:28:29.962240   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
E20240125 16:28:30.069481  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2858
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.924 ms                  | 587.137 ms                |
| ProcessBack:UpdateCache   | 5.922 ms                  | 1.426 s                   |
| ProcessBack:UpsertPq      | 32.033 ms                 | 233.843 ms                |
| ProcessOneStep            | 61.888 ms                 | 212.601 ms                |
| BlockToStepN              | 65.508 ms                 | 186.457 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:28:30.962054   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240125 16:28:31.034684  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:28:31.069027  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5183
W20240125 16:28:32.005527   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=70
E20240125 16:28:32.069020  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3795
W20240125 16:28:32.109393  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:28:33.017619   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240125 16:28:33.071854  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3356
W20240125 16:28:33.116992  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:28:34.051090   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.790 ms                  | 50.241 ms                 |
| Forward                   | 7.023 ms                  | 32.764 ms                 |
| Backward                  | 7.506 ms                  | 25.420 ms                 |
| Optimize                  | 3.237 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 12.237 ms                 | 70.325 ms                 |
| AfterBackward             | 64.979 ms                 | 212.697 ms                |
| BlockToStepN              | 70.213 ms                 | 186.678 ms                |
| OneStep                   | 207.860 ms                | 408.915 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:34.074229  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3027
W20240125 16:28:34.130649  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:28:35.070027   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240125 16:28:35.074110  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2287
W20240125 16:28:35.370517  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.624 ms                  | 40.656 ms                 |
| ProcessBack:UpdateCache   | 5.804 ms                  | 77.457 ms                 |
| ProcessBack:UpsertPq      | 29.449 ms                 | 139.099 ms                |
| ProcessOneStep            | 62.815 ms                 | 212.601 ms                |
| BlockToStepN              | 71.610 ms                 | 294.828 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:36.074013  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3182
W20240125 16:28:36.074862   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240125 16:28:36.396826  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:28:37.074023  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4761
W20240125 16:28:37.184058   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=90, pq.top=90
W20240125 16:28:37.424656  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:28:38.074023  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4965
W20240125 16:28:38.268080   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=96, pq.top=96
W20240125 16:28:38.446277  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.790 ms                  | 62.699 ms                 |
| Forward                   | 6.834 ms                  | 35.457 ms                 |
| Backward                  | 7.619 ms                  | 51.135 ms                 |
| Optimize                  | 3.238 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 10.256 ms                 | 70.325 ms                 |
| AfterBackward             | 61.197 ms                 | 212.697 ms                |
| BlockToStepN              | 72.636 ms                 | 295.182 ms                |
| OneStep                   | 205.265 ms                | 528.027 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:39.074071  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2606
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.007, sample: 0.601, forward: 2.965, backward: 1.419, update: 0.313
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.983, sample: 0.589, forward: 2.158, backward: 1.559, update: 0.348
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 27.035, sample: 0.676, forward: 2.551, backward: 1.847, update: 0.330
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 26.980, sample: 0.571, forward: 2.460, backward: 1.625, update: 0.344
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.991, sample: 0.674, forward: 2.331, backward: 1.722, update: 0.342
train_sampler.Prefill()
-------Step 0-------
tensor([  116,  2890,  9445,   893,  9762, 13401,    75,  6658,  8973,  3335]) tensor([ 1489,    74,  8137,  6602,   117,  9413,  9277, 11676,  1014,  7919])
-------Step 1-------
tensor([  116,  2890,  9445,   893,  9762, 13401,    75,  6658,  8973,  3335]) tensor([10125,  4631, 13532,  4841,  2978,  6920,  5110,  8628, 14767,  5499])
-------Step 2-------
tensor([11053,    57,    25,     3, 11989,  4135,  3735,  9121,  5713,  1423]) tensor([ 2820,  5822,  1255,  2443,  4595, 12659, 12262,  8433, 11732, 11870])
-------Step 3-------
tensor([11053,    57,    25,     3, 11989,  4135,  3735,  9121,  5713,  1423]) tensor([14655, 10536,  6090,  7535, 12085,  7793, 13333,  6843, 12679, 10580])
-------Step 4-------
tensor([14918,  8800,  7338, 12199,  4285,  7157,   123,  3917,  9762, 14448]) tensor([ 8631,  2433,  3092,  1372,  2038,  2385, 11718, 14814,  8061,  4100])
-------Step 5-------
tensor([14918,  8800,  7338, 12199,  4285,  7157,   123,  3917,  9762, 14448]) tensor([ 6518, 14860, 12014,  9691, 10314,  2004,  1533,  8884, 10714,  6680])
-------Step 6-------
tensor([10090,  3736, 12343,   758,  8722, 10403, 11819, 10609,    89, 12632]) tensor([  945,  2421,  2703,  9039, 14009,  4427, 13646,  9030,  3516,  7589])
-------Step 7-------
tensor([10090,  3736, 12343,   758,  8722, 10403, 11819, 10609,    89, 12632]) tensor([ 7801,  1812,  5915, 11246,  5361,  7897,  2507,  3432,  2404,  4582])
-------Step 8-------
tensor([ 3847, 13650, 11479, 11859,  3136,  7560,  9821, 12778,  2162,  8321]) tensor([ 6925,  2921, 14062,  3078,  6969,  6013,  7058,  7820, 12121,  1122])
-------Step 9-------
tensor([ 3847, 13650, 11479, 11859,  3136,  7560,  9821, 12778,  2162,  8321]) tensor([ 1761,  8339, 14324,  3226, 11460,  9767,  1472,  1402, 14767, 13347])
before start barrier
start train
[proc 0] 100 steps, total: 26.802, sample: 0.768, forward: 2.853, backward: 1.711, update: 0.418
W20240125 16:28:39.277544   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240125 16:28:39.563588  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:28:40.080106  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2900
W20240125 16:28:40.287583   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240125 16:28:40.564162  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.632 ms                  | 45.087 ms                 |
| ProcessBack:UpdateCache   | 5.460 ms                  | 77.457 ms                 |
| ProcessBack:UpsertPq      | 29.449 ms                 | 139.099 ms                |
| ProcessOneStep            | 61.102 ms                 | 212.601 ms                |
| BlockToStepN              | 74.103 ms                 | 294.828 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:41.083540  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1961
W20240125 16:28:41.393925   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240125 16:28:41.569501  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:28:42.090222  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=51
W20240125 16:28:42.412770   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240125 16:28:42.590202  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:28:43.094084  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:28:43.468099   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240125 16:28:43.682320  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.775 ms                  | 62.699 ms                 |
| Forward                   | 6.939 ms                  | 36.113 ms                 |
| Backward                  | 7.604 ms                  | 51.135 ms                 |
| Optimize                  | 3.240 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 9.603 ms                  | 70.325 ms                 |
| AfterBackward             | 61.197 ms                 | 212.697 ms                |
| BlockToStepN              | 78.478 ms                 | 326.661 ms                |
| OneStep                   | 222.538 ms                | 528.027 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:44.094072  2076 parallel_pq_v2.h:76] insert failed, size(hashtable)=2144
W20240125 16:28:44.470988   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240125 16:28:44.796029  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:28:45.097100  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=283
W20240125 16:28:45.599200   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.624 ms                  | 45.087 ms                 |
| ProcessBack:UpdateCache   | 5.328 ms                  | 77.457 ms                 |
| ProcessBack:UpsertPq      | 29.086 ms                 | 139.099 ms                |
| ProcessOneStep            | 61.888 ms                 | 212.601 ms                |
| BlockToStepN              | 79.586 ms                 | 326.485 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:28:45.880656  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:28:46.098737  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2393
W20240125 16:28:46.657080   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240125 16:28:46.960911  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:28:47.103704  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1995
W20240125 16:28:47.749580   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240125 16:28:47.971820  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:28:48.105016  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2609
W20240125 16:28:48.928241   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.772 ms                  | 62.699 ms                 |
| Forward                   | 7.023 ms                  | 36.113 ms                 |
| Backward                  | 7.506 ms                  | 51.135 ms                 |
| Optimize                  | 3.251 ms                  | 19.987 ms                 |
| BarrierTimeBeforeRank0    | 9.121 ms                  | 75.269 ms                 |
| AfterBackward             | 60.985 ms                 | 212.697 ms                |
| BlockToStepN              | 83.259 ms                 | 326.661 ms                |
| OneStep                   | 227.447 ms                | 528.027 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:49.105015  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4471
W20240125 16:28:49.114455  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:28:49.932031   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=140
E20240125 16:28:50.105398  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4955
W20240125 16:28:50.117588  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.567 ms                  | 44.126 ms                 |
| ProcessBack:UpdateCache   | 5.460 ms                  | 66.680 ms                 |
| ProcessBack:UpsertPq      | 28.619 ms                 | 129.581 ms                |
| ProcessOneStep            | 60.523 ms                 | 212.601 ms                |
| BlockToStepN              | 91.132 ms                 | 326.485 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:28:50.970119   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240125 16:28:51.110556  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2103
W20240125 16:28:51.263074  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:28:51.971210   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=145
E20240125 16:28:52.116864  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1752
W20240125 16:28:52.348845  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:28:52.979844   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
E20240125 16:28:53.116277  2088 parallel_pq_v2.h:76] insert failed, size(hashtable)=754
W20240125 16:28:53.454391  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:28:53.985814   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.772 ms                  | 61.997 ms                 |
| Forward                   | 7.023 ms                  | 35.457 ms                 |
| Backward                  | 7.506 ms                  | 29.261 ms                 |
| Optimize                  | 3.255 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 10.012 ms                 | 70.325 ms                 |
| AfterBackward             | 61.040 ms                 | 170.111 ms                |
| BlockToStepN              | 96.164 ms                 | 304.844 ms                |
| OneStep                   | 231.833 ms                | 476.845 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:54.116211  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1380
W20240125 16:28:54.498962  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:28:54.985291   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=156
E20240125 16:28:55.116200  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2918
W20240125 16:28:55.632356  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.446 ms                  | 44.126 ms                 |
| ProcessBack:UpdateCache   | 5.328 ms                  | 66.680 ms                 |
| ProcessBack:UpsertPq      | 28.181 ms                 | 129.581 ms                |
| ProcessOneStep            | 60.953 ms                 | 169.931 ms                |
| BlockToStepN              | 100.003 ms                | 326.485 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:28:56.025224   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240125 16:28:56.117558  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2049
W20240125 16:28:56.868371  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:28:57.025377   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=162
E20240125 16:28:57.117027  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3309
W20240125 16:28:57.962313  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:28:58.051755   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240125 16:28:58.137959  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2274
W20240125 16:28:59.056710  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 61.997 ms                 |
| Forward                   | 6.834 ms                  | 35.457 ms                 |
| Backward                  | 7.537 ms                  | 29.261 ms                 |
| Optimize                  | 3.249 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 10.256 ms                 | 70.325 ms                 |
| AfterBackward             | 61.081 ms                 | 170.111 ms                |
| BlockToStepN              | 108.732 ms                | 326.661 ms                |
| OneStep                   | 246.552 ms                | 483.818 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:28:59.140900  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2787
W20240125 16:28:59.222757   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240125 16:29:00.095994  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:29:00.144862  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4800
W20240125 16:29:00.257823   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.567 ms                  | 44.126 ms                 |
| ProcessBack:UpdateCache   | 5.384 ms                  | 66.680 ms                 |
| ProcessBack:UpsertPq      | 28.619 ms                 | 129.581 ms                |
| ProcessOneStep            | 61.102 ms                 | 169.931 ms                |
| BlockToStepN              | 112.224 ms                | 326.485 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:01.144016  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1910
W20240125 16:29:01.258649   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240125 16:29:01.490413  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:02.144068  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2833
W20240125 16:29:02.297322   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240125 16:29:02.497757  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:29:03.160677  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2114
W20240125 16:29:03.309279   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240125 16:29:03.633775  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 61.997 ms                 |
| Forward                   | 6.834 ms                  | 35.457 ms                 |
| Backward                  | 7.506 ms                  | 29.261 ms                 |
| Optimize                  | 3.255 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 11.339 ms                 | 70.325 ms                 |
| AfterBackward             | 62.554 ms                 | 170.111 ms                |
| BlockToStepN              | 118.317 ms                | 362.157 ms                |
| OneStep                   | 251.140 ms                | 528.027 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:04.160120  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1915
W20240125 16:29:04.313864   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240125 16:29:04.703063  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:05.160872  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1756
W20240125 16:29:05.313088   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240125 16:29:05.713646  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.567 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.327 ms                  | 62.127 ms                 |
| ProcessBack:UpsertPq      | 28.619 ms                 | 114.261 ms                |
| ProcessOneStep            | 61.689 ms                 | 169.931 ms                |
| BlockToStepN              | 120.745 ms                | 361.995 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:06.160856  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2726
W20240125 16:29:06.418748   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240125 16:29:06.753521  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:29:07.160240  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240125 16:29:07.418524   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240125 16:29:07.832840  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:29:08.176837  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2673
W20240125 16:29:08.428440   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240125 16:29:08.833307  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.776 ms                  | 61.997 ms                 |
| Forward                   | 6.767 ms                  | 35.457 ms                 |
| Backward                  | 7.484 ms                  | 29.261 ms                 |
| Optimize                  | 3.251 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 11.857 ms                 | 79.685 ms                 |
| AfterBackward             | 61.738 ms                 | 170.111 ms                |
| BlockToStepN              | 125.918 ms                | 382.978 ms                |
| OneStep                   | 256.750 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:09.176370  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=108
W20240125 16:29:09.432572   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240125 16:29:09.839375  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:29:10.181392  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2332
[proc 1] 200 steps, total: 31.186, sample: 0.685, forward: 0.819, backward: 0.978, update: 0.322
[proc 3] 200 steps, total: 31.180, sample: 0.677, forward: 0.913, backward: 1.082, update: 0.341
[proc 5] 200 steps, total: 31.184, sample: 0.622, forward: 0.724, backward: 0.921, update: 0.323
[proc 2] 200 steps, total: 31.187, sample: 0.761, forward: 0.911, backward: 1.084, update: 0.347
[proc 4] 200 steps, total: 31.182, sample: 0.593, forward: 0.774, backward: 0.978, update: 0.331
[proc 0] 200 steps, total: 31.181, sample: 0.782, forward: 0.982, backward: 0.961, update: 0.420
W20240125 16:29:10.488041   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.416 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.267 ms                  | 62.127 ms                 |
| ProcessBack:UpsertPq      | 28.814 ms                 | 114.261 ms                |
| ProcessOneStep            | 61.419 ms                 | 169.931 ms                |
| BlockToStepN              | 125.756 ms                | 382.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:10.944424  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:29:11.182101  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2296
W20240125 16:29:11.488168   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=204, pq.top=204
W20240125 16:29:11.998327  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:12.182466  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=63
W20240125 16:29:12.614311   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=208
E20240125 16:29:13.233445  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2678
W20240125 16:29:13.382915  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:29:13.634303   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.772 ms                  | 62.699 ms                 |
| Forward                   | 6.732 ms                  | 35.457 ms                 |
| Backward                  | 7.306 ms                  | 29.261 ms                 |
| Optimize                  | 3.247 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 13.509 ms                 | 79.685 ms                 |
| AfterBackward             | 61.206 ms                 | 170.111 ms                |
| BlockToStepN              | 127.829 ms                | 382.978 ms                |
| OneStep                   | 258.142 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:14.233101  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1995
W20240125 16:29:14.398296  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:29:14.749976   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
E20240125 16:29:15.233827  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5252
W20240125 16:29:15.430327  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.382 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.244 ms                  | 62.127 ms                 |
| ProcessBack:UpsertPq      | 28.479 ms                 | 114.261 ms                |
| ProcessOneStep            | 61.102 ms                 | 169.931 ms                |
| BlockToStepN              | 127.642 ms                | 382.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:15.866365   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240125 16:29:16.233021  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2493
W20240125 16:29:16.438732  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:29:16.870914   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=222
E20240125 16:29:17.252837  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1464
W20240125 16:29:17.468636  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:29:17.548337  2077 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240125 16:29:17.875607   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
E20240125 16:29:18.252861  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3017
W20240125 16:29:18.611958  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:29:18.875609   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 68.893 ms                 |
| Forward                   | 6.767 ms                  | 35.457 ms                 |
| Backward                  | 7.403 ms                  | 29.261 ms                 |
| Optimize                  | 3.242 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 13.509 ms                 | 79.685 ms                 |
| AfterBackward             | 61.509 ms                 | 170.111 ms                |
| BlockToStepN              | 130.723 ms                | 405.192 ms                |
| OneStep                   | 262.504 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:19.256879  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2609
W20240125 16:29:19.834152  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:29:19.967304   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
E20240125 16:29:20.260830   702 parallel_pq_v2.h:76] insert failed, size(hashtable)=2506
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.363 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.314 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.785 ms                 | 114.207 ms                |
| ProcessOneStep            | 61.102 ms                 | 169.931 ms                |
| BlockToStepN              | 130.538 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:20.980264  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:29:21.080560   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
E20240125 16:29:21.345590  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2655
W20240125 16:29:21.983866  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:29:22.086591   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=238, pq.top=238
E20240125 16:29:22.347349  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1863
W20240125 16:29:23.061962  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:29:23.191414   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
E20240125 16:29:23.352954  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2808
W20240125 16:29:24.063423  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 68.893 ms                 |
| Forward                   | 6.724 ms                  | 36.113 ms                 |
| Backward                  | 7.403 ms                  | 29.261 ms                 |
| Optimize                  | 3.242 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 13.509 ms                 | 79.685 ms                 |
| AfterBackward             | 61.369 ms                 | 170.111 ms                |
| BlockToStepN              | 133.751 ms                | 405.192 ms                |
| OneStep                   | 264.488 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:24.192026   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240125 16:29:24.352012  2079 parallel_pq_v2.h:76] insert failed, size(hashtable)=944
W20240125 16:29:25.192070   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240125 16:29:25.296674  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:29:25.352015  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5960
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.382 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.235 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.955 ms                 | 114.207 ms                |
| ProcessOneStep            | 61.282 ms                 | 169.931 ms                |
| BlockToStepN              | 135.189 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:26.192327   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240125 16:29:26.302165  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:29:26.352108  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=75
W20240125 16:29:27.194247   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=254
E20240125 16:29:27.352855  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2866
W20240125 16:29:27.373168  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:29:28.207620   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240125 16:29:28.352069  2078 parallel_pq_v2.h:76] insert failed, size(hashtable)=1360
W20240125 16:29:28.629905  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 62.699 ms                 |
| Forward                   | 6.681 ms                  | 35.457 ms                 |
| Backward                  | 7.403 ms                  | 29.147 ms                 |
| Optimize                  | 3.242 ms                  | 18.435 ms                 |
| BarrierTimeBeforeRank0    | 14.883 ms                 | 76.847 ms                 |
| AfterBackward             | 61.369 ms                 | 156.829 ms                |
| BlockToStepN              | 136.989 ms                | 382.978 ms                |
| OneStep                   | 266.326 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:29.207681   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=260
E20240125 16:29:29.352144  2082 parallel_pq_v2.h:76] insert failed, size(hashtable)=444
W20240125 16:29:29.695597  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:29:30.207979   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240125 16:29:30.352370  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.417 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.328 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.785 ms                 | 114.207 ms                |
| ProcessOneStep            | 61.127 ms                 | 156.656 ms                |
| BlockToStepN              | 137.821 ms                | 382.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:30.877898  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:29:31.329712   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=266, pq.top=266
E20240125 16:29:31.355878  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2090
W20240125 16:29:31.877501  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:29:32.338740   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240125 16:29:32.356885  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2291
W20240125 16:29:32.894804  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:29:33.343323   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=272
E20240125 16:29:33.362794  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2545
W20240125 16:29:33.933302  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.772 ms                  | 62.699 ms                 |
| Forward                   | 6.681 ms                  | 35.457 ms                 |
| Backward                  | 7.618 ms                  | 29.147 ms                 |
| Optimize                  | 3.243 ms                  | 18.435 ms                 |
| BarrierTimeBeforeRank0    | 15.072 ms                 | 79.685 ms                 |
| AfterBackward             | 61.206 ms                 | 156.829 ms                |
| BlockToStepN              | 139.721 ms                | 382.978 ms                |
| OneStep                   | 268.869 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:34.362512  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240125 16:29:34.496373   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240125 16:29:34.948616  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:29:35.362150  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=230
W20240125 16:29:35.496950   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.417 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.296 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.762 ms                 | 99.958 ms                 |
| ProcessOneStep            | 61.276 ms                 | 156.656 ms                |
| BlockToStepN              | 141.983 ms                | 382.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:36.178970  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:29:36.362027  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2371
W20240125 16:29:36.527765   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240125 16:29:37.335453  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:37.363852  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=34
W20240125 16:29:37.531155   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=286
E20240125 16:29:38.364006  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4647
W20240125 16:29:38.374713  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:29:38.576051   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 62.699 ms                 |
| Forward                   | 6.724 ms                  | 35.457 ms                 |
| Backward                  | 7.537 ms                  | 29.147 ms                 |
| Optimize                  | 3.249 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 16.019 ms                 | 79.685 ms                 |
| AfterBackward             | 61.509 ms                 | 156.829 ms                |
| BlockToStepN              | 142.165 ms                | 392.659 ms                |
| OneStep                   | 272.805 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:39.366432  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2557
W20240125 16:29:39.518883  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:29:39.660014   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=293, pq.top=293
E20240125 16:29:40.370141  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2612
W20240125 16:29:40.659818   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240125 16:29:40.811048  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.416 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.221 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.699 ms                 | 99.958 ms                 |
| ProcessOneStep            | 61.276 ms                 | 156.656 ms                |
| BlockToStepN              | 142.133 ms                | 392.480 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:41.392838  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2715
W20240125 16:29:41.673811   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=299
W20240125 16:29:41.823438  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 3] 300 steps, total: 31.894, sample: 0.703, forward: 0.991, backward: 0.984, update: 0.362
[proc 0] 300 steps, total: 31.896, sample: 0.672, forward: 1.102, backward: 0.978, update: 0.433
[proc 2] 300 steps, total: 31.896, sample: 0.573, forward: 0.897, backward: 0.993, update: 0.379
[proc 5] 300 steps, total: 31.900, sample: 0.603, forward: 0.750, backward: 0.999, update: 0.330
[proc 1] 300 steps, total: 31.904, sample: 0.578, forward: 0.824, backward: 0.900, update: 0.310
[proc 4] 300 steps, total: 31.905, sample: 0.625, forward: 0.890, backward: 0.973, update: 0.331
E20240125 16:29:42.516844  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1345
W20240125 16:29:42.678028   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240125 16:29:42.861505  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:29:43.516016  2088 parallel_pq_v2.h:76] insert failed, size(hashtable)=1816
W20240125 16:29:43.832319   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 64.622 ms                 |
| Forward                   | 6.704 ms                  | 35.457 ms                 |
| Backward                  | 7.484 ms                  | 29.147 ms                 |
| Optimize                  | 3.249 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 15.842 ms                 | 79.685 ms                 |
| AfterBackward             | 61.509 ms                 | 156.829 ms                |
| BlockToStepN              | 144.938 ms                | 405.192 ms                |
| OneStep                   | 279.256 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:44.190871  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:44.516103  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
W20240125 16:29:44.910941   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240125 16:29:45.442641  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:29:45.533053  1078 parallel_pq_v2.h:76] insert failed, size(hashtable)=2077
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.407 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.244 ms                  | 51.022 ms                 |
| ProcessBack:UpsertPq      | 27.785 ms                 | 99.958 ms                 |
| ProcessOneStep            | 61.276 ms                 | 156.656 ms                |
| BlockToStepN              | 144.554 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:45.910810   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240125 16:29:46.532074  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5562
W20240125 16:29:46.538375  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:29:46.918936   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
E20240125 16:29:47.556039  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1922
W20240125 16:29:47.666479  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:29:47.977293   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
E20240125 16:29:48.568042  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1529
W20240125 16:29:48.792376  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:29:48.979984   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=322, pq.top=322
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.774 ms                  | 66.912 ms                 |
| Forward                   | 6.684 ms                  | 35.457 ms                 |
| Backward                  | 7.286 ms                  | 29.147 ms                 |
| Optimize                  | 3.247 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 16.019 ms                 | 84.364 ms                 |
| AfterBackward             | 61.081 ms                 | 156.829 ms                |
| BlockToStepN              | 145.685 ms                | 405.192 ms                |
| OneStep                   | 279.256 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:29:49.568032  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
W20240125 16:29:49.882320  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:29:49.990119   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
E20240125 16:29:50.571466  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2960
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.407 ms                  | 40.656 ms                 |
| ProcessBack:UpdateCache   | 5.229 ms                  | 44.719 ms                 |
| ProcessBack:UpsertPq      | 27.532 ms                 | 99.924 ms                 |
| ProcessOneStep            | 61.018 ms                 | 156.656 ms                |
| BlockToStepN              | 145.600 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:51.002840   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240125 16:29:51.054270  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:29:51.571122  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5574
W20240125 16:29:52.062449  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:29:52.113224   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=332
E20240125 16:29:52.571396  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2518
W20240125 16:29:53.116175   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240125 16:29:53.278180  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:29:53.571208  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2717
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.776 ms                  | 66.912 ms                 |
| Forward                   | 6.684 ms                  | 35.457 ms                 |
| Backward                  | 7.306 ms                  | 29.147 ms                 |
| Optimize                  | 3.247 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 16.217 ms                 | 84.364 ms                 |
| AfterBackward             | 61.197 ms                 | 156.829 ms                |
| BlockToStepN              | 147.437 ms                | 405.192 ms                |
| OneStep                   | 279.878 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:54.220160   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240125 16:29:54.452598  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:29:54.580837  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1629
W20240125 16:29:55.224931   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240125 16:29:55.463928  1464 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:29:55.608829  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2400
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.407 ms                  | 40.656 ms                 |
| ProcessBack:UpdateCache   | 5.221 ms                  | 44.719 ms                 |
| ProcessBack:UpsertPq      | 27.532 ms                 | 99.924 ms                 |
| ProcessOneStep            | 60.973 ms                 | 156.656 ms                |
| BlockToStepN              | 148.334 ms                | 425.733 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:56.225034   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240125 16:29:56.564544  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:29:56.608356  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=107
W20240125 16:29:57.233287   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=347
E20240125 16:29:57.608530  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2964
W20240125 16:29:57.737331  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:29:58.233140   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=350, pq.top=350
E20240125 16:29:58.609309  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1930
W20240125 16:29:58.770325  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.775 ms                  | 64.622 ms                 |
| Forward                   | 6.680 ms                  | 32.764 ms                 |
| Backward                  | 7.262 ms                  | 26.549 ms                 |
| Optimize                  | 3.244 ms                  | 18.435 ms                 |
| BarrierTimeBeforeRank0    | 16.133 ms                 | 79.685 ms                 |
| AfterBackward             | 61.197 ms                 | 140.195 ms                |
| BlockToStepN              | 150.028 ms                | 405.192 ms                |
| OneStep                   | 280.874 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:29:59.363510   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
E20240125 16:29:59.609019  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2988
W20240125 16:30:00.082332  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:30:00.482770   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240125 16:30:00.609022  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4807
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.375 ms                  | 40.656 ms                 |
| ProcessBack:UpdateCache   | 5.204 ms                  | 48.553 ms                 |
| ProcessBack:UpsertPq      | 27.532 ms                 | 99.924 ms                 |
| ProcessOneStep            | 60.973 ms                 | 140.073 ms                |
| BlockToStepN              | 149.124 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:01.092267  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:30:01.504916   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=360, pq.top=360
E20240125 16:30:01.609392  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2724
W20240125 16:30:02.191068  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:30:02.507288   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=362, pq.top=362
E20240125 16:30:02.610106  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4391
W20240125 16:30:03.211501  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:30:03.609051   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240125 16:30:03.620859  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2128
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.775 ms                  | 64.622 ms                 |
| Forward                   | 6.669 ms                  | 35.168 ms                 |
| Backward                  | 7.338 ms                  | 29.147 ms                 |
| Optimize                  | 3.245 ms                  | 18.435 ms                 |
| BarrierTimeBeforeRank0    | 16.133 ms                 | 84.364 ms                 |
| AfterBackward             | 61.206 ms                 | 140.195 ms                |
| BlockToStepN              | 150.630 ms                | 405.192 ms                |
| OneStep                   | 282.393 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:04.424227  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:30:04.613416   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=369, pq.top=369
E20240125 16:30:04.627507  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=1506
W20240125 16:30:05.614416  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:30:05.628376  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240125 16:30:05.721611   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=372, pq.top=372
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.382 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.158 ms                  | 48.553 ms                 |
| ProcessBack:UpsertPq      | 27.762 ms                 | 99.924 ms                 |
| ProcessOneStep            | 61.102 ms                 | 140.073 ms                |
| BlockToStepN              | 150.884 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:30:06.628067  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2101
W20240125 16:30:06.724709   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240125 16:30:06.814848  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:30:07.629757  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4704
W20240125 16:30:07.784154   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240125 16:30:08.024727  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:30:08.629029  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2787
W20240125 16:30:08.786211   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.776 ms                  | 64.622 ms                 |
| Forward                   | 6.673 ms                  | 35.168 ms                 |
| Backward                  | 7.338 ms                  | 29.147 ms                 |
| Optimize                  | 3.244 ms                  | 18.435 ms                 |
| BarrierTimeBeforeRank0    | 16.382 ms                 | 84.364 ms                 |
| AfterBackward             | 61.197 ms                 | 140.195 ms                |
| BlockToStepN              | 152.400 ms                | 405.192 ms                |
| OneStep                   | 284.127 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:09.186864  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:30:09.629040  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3940
W20240125 16:30:09.790203   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240125 16:30:10.371709  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:30:10.629215  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3172
W20240125 16:30:10.816844   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.366 ms                  | 40.656 ms                 |
| ProcessBack:UpdateCache   | 5.128 ms                  | 44.719 ms                 |
| ProcessBack:UpsertPq      | 27.102 ms                 | 98.090 ms                 |
| ProcessOneStep            | 60.924 ms                 | 140.073 ms                |
| BlockToStepN              | 153.208 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:11.421727  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:30:11.631096  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2805
W20240125 16:30:11.824465   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240125 16:30:12.605989  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:30:12.631034  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=68
W20240125 16:30:12.824721   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240125 16:30:13.640872  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2207
W20240125 16:30:13.782824  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:30:13.935460   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=396, pq.top=396
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.774 ms                  | 64.622 ms                 |
| Forward                   | 6.665 ms                  | 35.168 ms                 |
| Backward                  | 7.412 ms                  | 29.261 ms                 |
| Optimize                  | 3.245 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 16.772 ms                 | 84.364 ms                 |
| AfterBackward             | 60.985 ms                 | 156.829 ms                |
| BlockToStepN              | 153.279 ms                | 417.857 ms                |
| OneStep                   | 287.553 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:30:14.648876  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3416
W20240125 16:30:14.952445   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=399, pq.top=399
W20240125 16:30:14.996201  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 4] 400 steps, total: 33.151, sample: 0.605, forward: 0.722, backward: 1.042, update: 0.309
[proc 2] 400 steps, total: 33.159, sample: 0.574, forward: 0.824, backward: 0.962, update: 0.325
[proc 0] 400 steps, total: 33.160, sample: 0.698, forward: 0.883, backward: 1.017, update: 0.388
[proc 3] 400 steps, total: 33.164, sample: 0.690, forward: 0.950, backward: 1.043, update: 0.330
[proc 1] 400 steps, total: 33.153, sample: 0.642, forward: 0.808, backward: 1.080, update: 0.307
[proc 5] 400 steps, total: 33.166, sample: 0.596, forward: 0.767, backward: 1.046, update: 0.302
E20240125 16:30:15.648126  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=54
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.375 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.118 ms                  | 44.719 ms                 |
| ProcessBack:UpsertPq      | 26.919 ms                 | 99.924 ms                 |
| ProcessOneStep            | 60.523 ms                 | 156.656 ms                |
| BlockToStepN              | 153.477 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:15.970352   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240125 16:30:16.018586  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:30:16.660835  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2454
W20240125 16:30:16.973726   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240125 16:30:17.123467  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:30:17.660934  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2516
W20240125 16:30:18.092657   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240125 16:30:18.220499  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:30:18.660022  2078 parallel_pq_v2.h:76] insert failed, size(hashtable)=303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 68.893 ms                 |
| Forward                   | 6.673 ms                  | 36.113 ms                 |
| Backward                  | 7.338 ms                  | 29.261 ms                 |
| Optimize                  | 3.245 ms                  | 19.132 ms                 |
| BarrierTimeBeforeRank0    | 16.951 ms                 | 84.364 ms                 |
| AfterBackward             | 61.040 ms                 | 156.829 ms                |
| BlockToStepN              | 154.614 ms                | 417.857 ms                |
| OneStep                   | 292.110 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:19.116734   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240125 16:30:19.224493  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:30:19.660712  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=129
W20240125 16:30:20.117134   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240125 16:30:20.332852  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:30:20.660027  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5633
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.375 ms                  | 41.536 ms                 |
| ProcessBack:UpdateCache   | 5.122 ms                  | 44.719 ms                 |
| ProcessBack:UpsertPq      | 26.919 ms                 | 99.924 ms                 |
| ProcessOneStep            | 60.523 ms                 | 156.656 ms                |
| BlockToStepN              | 157.717 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:21.182587   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240125 16:30:21.332441  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:30:21.662607  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=169
W20240125 16:30:22.182729   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240125 16:30:22.428858  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:30:22.705520  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2975
W20240125 16:30:23.187202   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240125 16:30:23.434675  1464 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:30:23.707486  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 68.893 ms                 |
| Forward                   | 6.680 ms                  | 36.113 ms                 |
| Backward                  | 7.412 ms                  | 29.261 ms                 |
| Optimize                  | 3.247 ms                  | 19.132 ms                 |
| BarrierTimeBeforeRank0    | 16.951 ms                 | 84.364 ms                 |
| AfterBackward             | 60.985 ms                 | 156.829 ms                |
| BlockToStepN              | 159.074 ms                | 417.857 ms                |
| OneStep                   | 295.881 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:24.245754   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240125 16:30:24.455497  1464 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:30:24.714253  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2926
W20240125 16:30:25.247071   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=430, pq.top=430
E20240125 16:30:25.714023  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3042
W20240125 16:30:25.752766  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.375 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.107 ms                  | 43.673 ms                 |
| ProcessBack:UpsertPq      | 26.840 ms                 | 98.090 ms                 |
| ProcessOneStep            | 60.500 ms                 | 156.656 ms                |
| BlockToStepN              | 158.939 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:26.260677   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240125 16:30:26.716507  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2604
W20240125 16:30:26.839032  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:30:27.283547   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=436, pq.top=436
E20240125 16:30:27.728822  2078 parallel_pq_v2.h:76] insert failed, size(hashtable)=334
W20240125 16:30:28.003705  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:30:28.284154   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 16:30:28.716120  2080 parallel_pq_v2.h:76] insert failed, size(hashtable)=1600
W20240125 16:30:29.007014  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 68.893 ms                 |
| Forward                   | 6.673 ms                  | 36.113 ms                 |
| Backward                  | 7.506 ms                  | 29.261 ms                 |
| Optimize                  | 3.249 ms                  | 19.132 ms                 |
| BarrierTimeBeforeRank0    | 16.951 ms                 | 95.286 ms                 |
| AfterBackward             | 61.040 ms                 | 156.829 ms                |
| BlockToStepN              | 159.497 ms                | 417.857 ms                |
| OneStep                   | 296.534 ms                | 549.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:29.356488   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
E20240125 16:30:29.720489  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2434
W20240125 16:30:30.110261  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:30:30.506184   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240125 16:30:30.720721  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=4271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.366 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.101 ms                  | 43.673 ms                 |
| ProcessBack:UpsertPq      | 26.760 ms                 | 98.090 ms                 |
| ProcessOneStep            | 60.523 ms                 | 156.656 ms                |
| BlockToStepN              | 158.869 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:31.302070  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:30:31.509876   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=450, pq.top=450
E20240125 16:30:31.720063  2081 parallel_pq_v2.h:76] insert failed, size(hashtable)=1979
W20240125 16:30:32.311362  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:30:32.526163   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=453, pq.top=453
E20240125 16:30:32.720875  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=5001
W20240125 16:30:33.400367  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:30:33.593374   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=456
E20240125 16:30:33.720316  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.772 ms                  | 66.912 ms                 |
| Forward                   | 6.684 ms                  | 35.457 ms                 |
| Backward                  | 7.575 ms                  | 29.147 ms                 |
| Optimize                  | 3.252 ms                  | 18.452 ms                 |
| BarrierTimeBeforeRank0    | 17.490 ms                 | 95.286 ms                 |
| AfterBackward             | 61.197 ms                 | 140.195 ms                |
| BlockToStepN              | 159.497 ms                | 405.192 ms                |
| OneStep                   | 296.534 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:34.430517  1464 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:30:34.601797   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=459
E20240125 16:30:34.723929  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240125 16:30:35.433319  1464 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:30:35.678154   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240125 16:30:35.727382  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2765
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.363 ms                  | 42.658 ms                 |
| ProcessBack:UpdateCache   | 5.088 ms                  | 43.673 ms                 |
| ProcessBack:UpsertPq      | 26.919 ms                 | 98.090 ms                 |
| ProcessOneStep            | 60.973 ms                 | 140.073 ms                |
| BlockToStepN              | 158.939 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:36.590355  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:30:36.727146  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=90
W20240125 16:30:36.742169   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240125 16:30:37.732786  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2921
W20240125 16:30:37.745987   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240125 16:30:37.910112  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:30:38.757400   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=472, pq.top=472
E20240125 16:30:38.777796  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2567
W20240125 16:30:38.915836  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 66.912 ms                 |
| Forward                   | 6.704 ms                  | 35.457 ms                 |
| Backward                  | 7.537 ms                  | 29.147 ms                 |
| Optimize                  | 3.256 ms                  | 19.132 ms                 |
| BarrierTimeBeforeRank0    | 17.589 ms                 | 95.286 ms                 |
| AfterBackward             | 61.197 ms                 | 140.195 ms                |
| BlockToStepN              | 159.497 ms                | 405.192 ms                |
| OneStep                   | 296.534 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:39.762589   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
E20240125 16:30:39.784859  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2345
W20240125 16:30:39.916786  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:30:40.784232  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=6284
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.363 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.070 ms                  | 40.910 ms                 |
| ProcessBack:UpsertPq      | 26.742 ms                 | 96.316 ms                 |
| ProcessOneStep            | 60.924 ms                 | 140.073 ms                |
| BlockToStepN              | 158.939 ms                | 405.011 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:40.842965   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240125 16:30:40.965390  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:30:41.784039  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=2680
W20240125 16:30:41.847530   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
W20240125 16:30:41.991998  1464 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:30:42.784245  2076 parallel_pq_v2.h:76] insert failed, size(hashtable)=1581
W20240125 16:30:42.860146   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240125 16:30:43.246564  1464 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:30:43.788817  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3199
W20240125 16:30:43.970202   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.775 ms                  | 66.912 ms                 |
| Forward                   | 6.724 ms                  | 35.457 ms                 |
| Backward                  | 7.506 ms                  | 29.147 ms                 |
| Optimize                  | 3.264 ms                  | 19.986 ms                 |
| BarrierTimeBeforeRank0    | 17.732 ms                 | 95.286 ms                 |
| AfterBackward             | 61.073 ms                 | 140.195 ms                |
| BlockToStepN              | 161.052 ms                | 417.857 ms                |
| OneStep                   | 296.534 ms                | 547.314 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:44.436894  1464 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:30:44.788095  1464 parallel_pq_v2.h:76] insert failed, size(hashtable)=91
W20240125 16:30:45.082362   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240125 16:30:45.482430  1464 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:30:45.788825  2081 parallel_pq_v2.h:76] insert failed, size(hashtable)=2272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.363 ms                  | 42.129 ms                 |
| ProcessBack:UpdateCache   | 5.083 ms                  | 40.910 ms                 |
| ProcessBack:UpsertPq      | 26.716 ms                 | 96.316 ms                 |
| ProcessOneStep            | 60.523 ms                 | 140.073 ms                |
| BlockToStepN              | 160.039 ms                | 417.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:30:46.168782   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=496, pq.top=496
W20240125 16:30:46.483780  1464 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:30:46.792848  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=3129
W20240125 16:30:47.173616   702 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 2] 500 steps, total: 32.236, sample: 0.547, forward: 0.708, backward: 1.102, update: 0.321
[proc 0] 500 steps, total: 32.235, sample: 0.830, forward: 1.151, backward: 1.032, update: 0.478
[proc 4] 500 steps, total: 32.236, sample: 0.638, forward: 0.835, backward: 0.987, update: 0.302
Successfully xmh. training takes 155.2762291431427 seconds
before call kg_cache_controller.StopThreads()
W20240125 16:30:47.594064   702 grad_async_v2.h:71] call StopThreads. PID = 64462
W20240125 16:30:47.594110   702 grad_base.h:210] before processOneStepNegThread_.join();
[proc 1] 500 steps, total: 32.229, sample: 0.663, forward: 0.845, backward: 0.931, update: 0.309
[proc 5] 500 steps, total: 32.229, sample: 0.626, forward: 0.771, backward: 0.975, update: 0.322
[proc 3] 500 steps, total: 32.239, sample: 0.793, forward: 0.864, backward: 0.965, update: 0.325
W20240125 16:30:47.600865   702 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 16:30:47.601171   702 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
E20240125 16:30:47.792096  1463 parallel_pq_v2.h:76] insert failed, size(hashtable)=7749
W20240125 16:30:47.815130   702 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fe388e76790>
