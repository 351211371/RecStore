WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 16:34:18.563854 33681 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_110', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [33681 sampler.py:454] Start PreSampling
WARNING [33681 sampler.py:532] Before construct renumbering_dict
WARNING [33681 sampler.py:555] PreSampling done
W20240125 16:34:32.618185 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 16:34:32.619200 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 16:34:32.619706 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 16:34:32.620139 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 16:34:32.620538 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 16:34:32.620975 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 16:34:32.621448 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 16:34:32.621896 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 16:34:32.622318 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 16:34:32.622738 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 16:34:32.623167 33681 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 16:34:32.623577 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 16:34:32.623980 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 16:34:32.624610 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 16:34:32.625057 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 16:34:32.625484 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 16:34:32.625895 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 16:34:32.626335 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 16:34:32.626756 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 16:34:32.627183 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 16:34:32.627604 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 16:34:32.628017 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 16:34:32.628432 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 16:34:32.628885 33681 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 16:34:32.629302 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 16:34:32.629727 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 16:34:32.630268 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 16:34:32.630695 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 16:34:32.631114 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 16:34:32.631534 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 16:34:32.631933 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 16:34:32.632376 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 16:34:32.632803 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 16:34:32.633236 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 16:34:32.633301 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 16:34:32.633342 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 16:34:32.633380 33681 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 16:34:32.633414 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 16:34:32.633436 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 16:34:32.633595 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 16:34:32.633643 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 16:34:32.633677 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 16:34:32.633728 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 16:34:32.633760 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 16:34:32.633806 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 16:34:32.633833 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 16:34:32.633870 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 16:34:32.633913 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 16:34:32.633940 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 16:34:32.633967 33681 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 16:34:32.633996 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 16:34:32.634018 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 16:34:32.634101 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 16:34:32.634184 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 16:34:32.634214 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 16:34:32.634245 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 16:34:32.634279 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 16:34:32.634315 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 16:34:32.634354 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 16:34:32.634399 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 16:34:32.634435 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 16:34:32.634472 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 16:34:32.634503 33681 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 16:34:32.634531 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 16:34:32.634557 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 16:34:32.634632 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 16:34:32.634685 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 16:34:32.634728 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 16:34:32.634764 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 16:34:32.634804 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 16:34:32.634851 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 16:34:32.634882 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 16:34:32.634917 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 16:34:32.634948 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 16:34:32.634990 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 16:34:32.635026 33681 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 16:34:32.635053 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 16:34:32.635083 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 16:34:32.635154 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 16:34:32.635195 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 16:34:32.635233 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 16:34:32.635290 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 16:34:32.635330 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 16:34:32.635367 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 16:34:32.635411 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 16:34:32.635452 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 16:34:32.635480 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 16:34:32.635532 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 16:34:32.635562 33681 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 16:34:32.635607 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 16:34:32.635633 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 16:34:32.635712 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 16:34:32.635758 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 16:34:32.635789 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 16:34:32.635823 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 16:34:32.635861 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 16:34:32.635890 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 16:34:32.635921 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 16:34:32.635950 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 16:34:32.635994 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 16:34:32.636035 33681 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 16:34:32.636075 33681 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 16:34:32.636101 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 16:34:32.636132 33681 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 16:34:33.123610 33681 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100003dc2000 22.81 MB
W20240125 16:34:33.123942 33681 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 9333,  9881, 10237,  ..., 10209, 10070,  8336]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 14.723 seconds
[Rank1] pid = 34900
[Rank2] pid = 34964
[Rank3] pid = 34966
[Rank4] pid = 35073
[Rank5] pid = 35156
[Rank6] pid = 35220
INFO [33681 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [34900 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [34964 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [34966 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [35073 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [35156 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [35222 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [35220 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [35222 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35220 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34966 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35073 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [35156 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 16:34:36.292117 35093 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240125 16:34:36.292117 35029 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240125 16:34:36.292117 35221 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240125 16:34:36.292117 35287 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240125 16:34:36.292241 35157 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
INFO [34964 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33681 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34900 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 16:34:36.300267 35285 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240125 16:34:36.301271 34901 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240125 16:34:36.301271 34965 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240125 16:34:36.340834 35029 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1000054a8000 781.2 kB
W20240125 16:34:36.340899 35285 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10000556d000 781.2 kB
W20240125 16:34:36.341471 35029 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x100005632000 781.2 kB
W20240125 16:34:36.341595 35029 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x1000056f7000 152.6 MB
W20240125 16:34:36.341678 35029 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10000ef8f000 152.6 MB
W20240125 16:34:36.341702 35285 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x100018827000 781.2 kB
W20240125 16:34:36.341746 35029 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:34:36.341823 35285 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x1000188ec000 152.6 MB
W20240125 16:34:36.341900 35285 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100022184000 152.6 MB
W20240125 16:34:36.342221 35285 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:34:36.343096 35029 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:34:36.343189 35285 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:34:36.349555 35287 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x10002ba2a000 781.2 kB
W20240125 16:34:36.349558 35157 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x10002bbb4000 781.2 kB
W20240125 16:34:36.349555 35221 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x10002baef000 781.2 kB
W20240125 16:34:36.349820 35221 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10002bc79000 781.2 kB
W20240125 16:34:36.349825 35157 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10002bd3e000 781.2 kB
W20240125 16:34:36.349831 35287 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x10002be03000 781.2 kB
W20240125 16:34:36.349915 35221 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10002bec8000 152.6 MB
W20240125 16:34:36.349920 35157 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x100035760000 152.6 MB
W20240125 16:34:36.349939 35287 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10003eff8000 152.6 MB
W20240125 16:34:36.350030 35221 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x100048896000 152.6 MB
W20240125 16:34:36.350036 35287 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10005212e000 152.6 MB
W20240125 16:34:36.350042 35157 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x10005b9c6000 152.6 MB
W20240125 16:34:36.350101 35287 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 16:34:36.350107 35221 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 16:34:36.350128 35157 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:34:36.350275 35093 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x10006525e000 781.2 kB
W20240125 16:34:36.350442 35093 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x1000654ad000 781.2 kB
W20240125 16:34:36.350417 34901 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1000653e8000 781.2 kB
W20240125 16:34:36.350415 34965 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x100065323000 781.2 kB
W20240125 16:34:36.350523 35093 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x100065572000 152.6 MB
W20240125 16:34:36.350600 35093 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10006ee0a000 152.6 MB
W20240125 16:34:36.350649 35093 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 16:34:36.350708 34965 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x1000786a2000 781.2 kB
W20240125 16:34:36.350728 34901 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x100078767000 781.2 kB
W20240125 16:34:36.350809 34901 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10007882c000 152.6 MB
W20240125 16:34:36.350821 34965 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1000820c4000 152.6 MB
W20240125 16:34:36.350888 34901 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10008b95c000 152.6 MB
W20240125 16:34:36.350912 34965 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1000951f4000 152.6 MB
W20240125 16:34:36.350945 34901 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:34:36.350963 34965 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:34:36.354393 35287 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 16:34:36.354395 35221 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 16:34:36.354544 35157 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:34:36.354554 35093 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 16:34:36.354636 34901 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:34:36.354650 34965 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [34964 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [34900 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [35073 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 35222
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [33681 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [35222 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [34966 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35156 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [35220 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 16:34:36.611440 35157 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611491 35221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611531 35029 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611567 34901 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611626 35285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611691 34965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.611804 35093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:34:36.612082 35287 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240125 16:34:36.613361 35285 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 16:34:36.613530 35285 grad_base.h:172] Init GradProcessingBase done
I20240125 16:34:36.619310 35285 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 16:34:36.619555 35285 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 16:34:36.619568 35285 kg_controller.h:84] Construct KGCacheController done
I20240125 16:34:37.638424 35285 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 16:34:39.544205 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:34:39.560593 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 16:34:39.588959 34901 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 16:34:39.593686 35157 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.604009 34965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.614984 35287 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.651465 35221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.660823 35093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.667308 35029 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:34:39.791348 35285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.573 ms                 | 19.573 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:34:46.520129 36863 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.573 ms                 | 19.573 ms                 |
| Forward                   | 2.375 s                   | 2.375 s                   |
| Backward                  | 697.243 ms                | 697.243 ms                |
| Optimize                  | 5.374 ms                  | 5.374 ms                  |
| BarrierTimeBeforeRank0    | 111.124 us                | 111.124 us                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:46.708540 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:34:46.875265 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=2, pq.top=2
E20240125 16:34:47.520993 36862 parallel_pq_v2.h:76] insert failed, size(hashtable)=6728
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.976 ms                 | 1.125 s                   |
| ProcessBack:UpdateCache   | 24.981 ms                 | 2.457 s                   |
| ProcessBack:UpsertPq      | 26.310 ms                 | 222.446 ms                |
| ProcessOneStep            | 79.832 ms                 | 3.811 s                   |
| BlockToStepN              | 3.313 ms                  | 146.075 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:47.726007 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:34:47.910611 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240125 16:34:48.520071 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=10643
W20240125 16:34:48.730865 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:49.054407 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=12, pq.top=12
E20240125 16:34:49.520181 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8891
W20240125 16:34:49.741371 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:34:50.156775 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240125 16:34:50.537489 36868 parallel_pq_v2.h:76] insert failed, size(hashtable)=1173
W20240125 16:34:50.744939 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:51.365154 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=24, pq.top=24
E20240125 16:34:51.520022 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4306
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.465 ms                  | 57.916 ms                 |
| Forward                   | 7.280 ms                  | 2.375 s                   |
| Backward                  | 6.386 ms                  | 697.243 ms                |
| Optimize                  | 2.383 ms                  | 5.374 ms                  |
| BarrierTimeBeforeRank0    | 19.438 ms                 | 64.236 ms                 |
| AfterBackward             | 91.245 ms                 | 3.811 s                   |
| BlockToStepN              | 17.424 ms                 | 146.391 ms                |
| OneStep                   | 202.520 ms                | 6.913 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:51.762401 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:34:52.369670 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
E20240125 16:34:52.520071 36875 parallel_pq_v2.h:76] insert failed, size(hashtable)=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.763 ms                 | 1.111 s                   |
| ProcessBack:UpdateCache   | 23.576 ms                 | 2.433 s                   |
| ProcessBack:UpsertPq      | 36.468 ms                 | 198.667 ms                |
| ProcessOneStep            | 92.402 ms                 | 3.811 s                   |
| BlockToStepN              | 18.101 ms                 | 146.075 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:52.767226 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:53.403117 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=34
E20240125 16:34:53.520044 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=507
W20240125 16:34:53.848040 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:34:54.414737 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=38, pq.top=38
E20240125 16:34:54.520551 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=346
W20240125 16:34:54.863910 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:55.441323 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
E20240125 16:34:55.520013 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6887
W20240125 16:34:55.980172 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:34:56.529390 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=48, pq.top=48
E20240125 16:34:56.535105 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.856 ms                  | 57.916 ms                 |
| Forward                   | 6.704 ms                  | 2.375 s                   |
| Backward                  | 5.894 ms                  | 697.243 ms                |
| Optimize                  | 2.415 ms                  | 10.536 ms                 |
| BarrierTimeBeforeRank0    | 22.841 ms                 | 64.236 ms                 |
| AfterBackward             | 84.598 ms                 | 3.811 s                   |
| BlockToStepN              | 45.091 ms                 | 155.615 ms                |
| OneStep                   | 209.545 ms                | 6.913 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:57.066269 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:57.530613 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=52, pq.top=52
E20240125 16:34:57.543368 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4622
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 14.894 ms                 | 1.111 s                   |
| ProcessBack:UpdateCache   | 21.700 ms                 | 2.433 s                   |
| ProcessBack:UpsertPq      | 28.377 ms                 | 198.667 ms                |
| ProcessOneStep            | 83.522 ms                 | 171.556 ms                |
| BlockToStepN              | 45.386 ms                 | 146.075 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:34:57.753777 36863 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240125 16:34:58.160635 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:34:58.530071 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240125 16:34:58.552847 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3805
W20240125 16:34:59.166394 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:34:59.531131 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
E20240125 16:34:59.552847 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4089
W20240125 16:35:00.169673 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:35:00.549118 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=66, pq.top=66
E20240125 16:35:00.553467 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3625
W20240125 16:35:01.224953 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:35:01.549144 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=70
E20240125 16:35:01.557015 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.827 ms                  | 53.578 ms                 |
| Forward                   | 6.738 ms                  | 70.200 ms                 |
| Backward                  | 5.953 ms                  | 22.086 ms                 |
| Optimize                  | 2.428 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 20.260 ms                 | 56.976 ms                 |
| AfterBackward             | 78.473 ms                 | 171.698 ms                |
| BlockToStepN              | 57.299 ms                 | 158.747 ms                |
| OneStep                   | 215.846 ms                | 371.864 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:02.471315 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:35:02.558184 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=412
W20240125 16:35:02.588199 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.322 ms                 | 1.111 s                   |
| ProcessBack:UpdateCache   | 19.342 ms                 | 2.433 s                   |
| ProcessBack:UpsertPq      | 28.155 ms                 | 198.667 ms                |
| ProcessOneStep            | 78.365 ms                 | 171.556 ms                |
| BlockToStepN              | 60.351 ms                 | 215.728 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:03.502898 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:35:03.564875 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=9556
W20240125 16:35:03.617827 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=76
E20240125 16:35:04.564021 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4848
W20240125 16:35:04.608265 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:35:04.740316 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
E20240125 16:35:05.568359 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4556
W20240125 16:35:05.610981 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:35:05.741330 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=84, pq.top=84
E20240125 16:35:06.577415 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4316
W20240125 16:35:06.614593 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.898 ms                  | 53.578 ms                 |
| Forward                   | 6.729 ms                  | 70.200 ms                 |
| Backward                  | 5.863 ms                  | 22.086 ms                 |
| Optimize                  | 2.420 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 21.410 ms                 | 77.134 ms                 |
| AfterBackward             | 78.385 ms                 | 171.698 ms                |
| BlockToStepN              | 67.128 ms                 | 281.207 ms                |
| OneStep                   | 223.933 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:06.747481 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
E20240125 16:35:07.584975 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.322 ms                 | 38.175 ms                 |
| ProcessBack:UpdateCache   | 19.603 ms                 | 87.954 ms                 |
| ProcessBack:UpsertPq      | 27.775 ms                 | 96.394 ms                 |
| ProcessOneStep            | 77.375 ms                 | 171.556 ms                |
| BlockToStepN              | 68.197 ms                 | 280.912 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:07.745126 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:07.860046 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240125 16:35:08.585083 36865 parallel_pq_v2.h:76] insert failed, size(hashtable)=785
W20240125 16:35:08.793531 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:35:08.917892 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240125 16:35:09.585563 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.131, sample: 0.521, forward: 2.600, backward: 1.837, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.188, sample: 0.505, forward: 2.638, backward: 1.424, update: 0.268
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 30.140, sample: 0.555, forward: 3.227, backward: 1.770, update: 0.280
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 30.177, sample: 0.573, forward: 2.686, backward: 1.796, update: 0.218
train_sampler.Prefill()
-------Step 0-------
tensor([ 2257,    74,  4112,  2291, 11742, 12224,   955,   384, 12145, 11606]) tensor([10237, 10468,  6859, 11320, 12709,  1117,   615,  3373, 14014, 12117])
-------Step 1-------
tensor([ 2257,    74,  4112,  2291, 11742, 12224,   955,   384, 12145, 11606]) tensor([ 1086,  2715,   484, 13613,  7873,  5112, 14881, 13656, 12123,  1156])
-------Step 2-------
tensor([ 4478, 13570,  2802, 13088,  9946,    26,   822,    15, 14417,  6175]) tensor([ 5659,  7285, 13838,  6967,  5057,  8876, 12116,   427, 14596,  5210])
-------Step 3-------
tensor([ 4478, 13570,  2802, 13088,  9946,    26,   822,    15, 14417,  6175]) tensor([13219,  3851, 10297, 12036,  3849, 13561,  2323, 14103, 13632,  5322])
-------Step 4-------
tensor([ 8204,  3383,  4162,    15,  6718,  4033, 13287,    26,  6284,    71]) tensor([11195,  8566,  7173,  1295,  4172,  1289,  1382, 13676, 10325,  2027])
-------Step 5-------
tensor([ 8204,  3383,  4162,    15,  6718,  4033, 13287,    26,  6284,    71]) tensor([ 3111, 10578,  1326,  5802, 10343,  8066, 13499,  7270,  8068,  5494])
-------Step 6-------
tensor([   74, 13572, 11033,  3626, 13002,  3732,    63, 14201,  8597,   923]) tensor([  613,  1030, 13922,  3531,  2197,  2921,   384,  7554,  3799,  1956])
-------Step 7-------
tensor([   74, 13572, 11033,  3626, 13002,  3732,    63, 14201,  8597,   923]) tensor([ 3952,  7082,  5754, 14553, 10307,  1814, 12085, 11057,  4991,  7530])
-------Step 8-------
tensor([14634,  1358,     8,  2696,  8757,     5, 10581,    26,   944,  2126]) tensor([14071,  7274,  2114, 10124, 14521,  8901, 11440,  1565,  9399,  4066])
-------Step 9-------
tensor([14634,  1358,     8,  2696,  8757,     5, 10581,    26,   944,  2126]) tensor([ 2688, 14486, 12962,  1236,  1059,  8644, 13032, 14461,  6252, 14764])
before start barrier
start train
[proc 0] 100 steps, total: 30.000, sample: 0.625, forward: 3.365, backward: 1.474, update: 0.242
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.132, sample: 0.530, forward: 2.721, backward: 1.771, update: 0.241
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.210, sample: 0.474, forward: 2.831, backward: 1.521, update: 0.282
W20240125 16:35:09.800679 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 30.213, sample: 0.536, forward: 2.771, backward: 1.784, update: 0.232
W20240125 16:35:09.921485 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
E20240125 16:35:10.585700 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=90
W20240125 16:35:10.921334 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240125 16:35:11.004460 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:35:11.585013 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.827 ms                  | 53.578 ms                 |
| Forward                   | 6.781 ms                  | 70.200 ms                 |
| Backward                  | 5.866 ms                  | 28.661 ms                 |
| Optimize                  | 2.415 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 21.951 ms                 | 77.134 ms                 |
| AfterBackward             | 77.114 ms                 | 171.698 ms                |
| BlockToStepN              | 72.138 ms                 | 291.380 ms                |
| OneStep                   | 225.363 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:12.017398 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=108, pq.top=108
W20240125 16:35:12.180982 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:35:12.597853 36868 parallel_pq_v2.h:76] insert failed, size(hashtable)=692
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.649 ms                 | 47.718 ms                 |
| ProcessBack:UpdateCache   | 20.322 ms                 | 87.954 ms                 |
| ProcessBack:UpsertPq      | 27.801 ms                 | 96.394 ms                 |
| ProcessOneStep            | 77.408 ms                 | 171.556 ms                |
| BlockToStepN              | 74.277 ms                 | 291.184 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:13.029742 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240125 16:35:13.261656 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:35:13.616858 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4237
W20240125 16:35:14.034710 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240125 16:35:14.323789 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:35:14.616014 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6232
W20240125 16:35:15.044876 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240125 16:35:15.326306 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:35:15.616851 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4312
W20240125 16:35:16.055151 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240125 16:35:16.332569 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:35:16.621592 36873 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.798 ms                  | 53.578 ms                 |
| Forward                   | 6.716 ms                  | 70.200 ms                 |
| Backward                  | 5.925 ms                  | 28.661 ms                 |
| Optimize                  | 2.408 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 21.351 ms                 | 77.134 ms                 |
| AfterBackward             | 78.385 ms                 | 171.698 ms                |
| BlockToStepN              | 70.561 ms                 | 291.380 ms                |
| OneStep                   | 224.514 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:17.135360 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240125 16:35:17.494318 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:35:17.624835 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4074
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.649 ms                 | 38.175 ms                 |
| ProcessBack:UpdateCache   | 19.732 ms                 | 79.589 ms                 |
| ProcessBack:UpsertPq      | 28.467 ms                 | 90.835 ms                 |
| ProcessOneStep            | 77.408 ms                 | 171.556 ms                |
| BlockToStepN              | 70.848 ms                 | 291.184 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:18.205382 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240125 16:35:18.552579 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:35:18.624379 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=128
W20240125 16:35:19.205322 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240125 16:35:19.555855 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:35:19.624019 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3917
W20240125 16:35:20.315143 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240125 16:35:20.637666 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4473
W20240125 16:35:21.010273 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:35:21.448907 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=146, pq.top=146
E20240125 16:35:21.638306 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.763 ms                  | 53.578 ms                 |
| Forward                   | 6.568 ms                  | 70.200 ms                 |
| Backward                  | 5.866 ms                  | 28.661 ms                 |
| Optimize                  | 2.383 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 22.134 ms                 | 77.134 ms                 |
| AfterBackward             | 77.549 ms                 | 171.698 ms                |
| BlockToStepN              | 75.141 ms                 | 369.796 ms                |
| OneStep                   | 227.259 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:22.011190 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:35:22.566442 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240125 16:35:22.638017 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=9422
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.961 ms                 | 38.175 ms                 |
| ProcessBack:UpdateCache   | 19.732 ms                 | 79.589 ms                 |
| ProcessBack:UpsertPq      | 28.847 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.277 ms                 | 140.097 ms                |
| BlockToStepN              | 74.133 ms                 | 291.184 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:23.190258 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:23.566104 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=154, pq.top=154
E20240125 16:35:23.638104 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=48
W20240125 16:35:24.286906 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:35:24.633005 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=160
E20240125 16:35:24.655351 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4569
W20240125 16:35:25.383514 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:35:25.646242 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=164, pq.top=164
E20240125 16:35:25.659902 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4898
W20240125 16:35:26.391675 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:35:26.660867 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7594
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.763 ms                  | 50.248 ms                 |
| Forward                   | 6.568 ms                  | 42.249 ms                 |
| Backward                  | 5.866 ms                  | 22.086 ms                 |
| Optimize                  | 2.386 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 22.134 ms                 | 74.020 ms                 |
| AfterBackward             | 78.763 ms                 | 140.232 ms                |
| BlockToStepN              | 74.329 ms                 | 369.796 ms                |
| OneStep                   | 224.514 ms                | 587.908 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:26.880653 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240125 16:35:27.394726 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.571 ms                 | 38.474 ms                 |
| ProcessBack:UpdateCache   | 20.322 ms                 | 79.589 ms                 |
| ProcessBack:UpsertPq      | 28.467 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.277 ms                 | 140.097 ms                |
| BlockToStepN              | 70.848 ms                 | 369.599 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:27.660295 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=113
W20240125 16:35:27.943540 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=174, pq.top=174
W20240125 16:35:28.471778 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:35:28.660261 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=40
W20240125 16:35:28.980952 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240125 16:35:29.471793 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:35:29.663839 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6005
W20240125 16:35:30.198781 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240125 16:35:30.607542 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:35:30.663035 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=75
W20240125 16:35:31.244169 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=188
E20240125 16:35:31.668884 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4572
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.742 ms                  | 50.248 ms                 |
| Forward                   | 6.470 ms                  | 42.249 ms                 |
| Backward                  | 5.874 ms                  | 27.639 ms                 |
| Optimize                  | 2.382 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 21.957 ms                 | 74.020 ms                 |
| AfterBackward             | 78.763 ms                 | 140.232 ms                |
| BlockToStepN              | 74.329 ms                 | 369.796 ms                |
| OneStep                   | 224.043 ms                | 587.908 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:31.723372 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:35:32.300000 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.763 ms                 | 38.184 ms                 |
| ProcessBack:UpdateCache   | 20.109 ms                 | 57.303 ms                 |
| ProcessBack:UpsertPq      | 28.467 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.674 ms                 | 140.097 ms                |
| BlockToStepN              | 71.956 ms                 | 369.599 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:32.668476 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=185
W20240125 16:35:32.803226 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:35:33.359762 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=198, pq.top=198
E20240125 16:35:33.668694 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5407
W20240125 16:35:33.854226 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
[proc 7] 200 steps, total: 24.475, sample: 0.595, forward: 0.806, backward: 0.925, update: 0.226
[proc 0] 200 steps, total: 24.485, sample: 0.481, forward: 0.834, backward: 0.791, update: 0.217
[proc 6] 200 steps, total: 24.486, sample: 0.591, forward: 0.725, backward: 1.091, update: 0.234
[proc 4] 200 steps, total: 24.486, sample: 0.546, forward: 0.881, backward: 1.050, update: 0.249
[proc 1] 200 steps, total: 24.480, sample: 0.659, forward: 0.870, backward: 1.133, update: 0.240
[proc 3] 200 steps, total: 24.486, sample: 0.563, forward: 0.817, backward: 0.991, update: 0.229
[proc 5] 200 steps, total: 24.471, sample: 0.619, forward: 0.905, backward: 0.958, update: 0.242
[proc 2] 200 steps, total: 24.498, sample: 0.587, forward: 0.780, backward: 0.963, update: 0.222
W20240125 16:35:34.412439 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=201, pq.top=200
E20240125 16:35:34.668020 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7678
W20240125 16:35:34.879333 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:35:35.419574 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=206, pq.top=206
E20240125 16:35:35.668247 36863 parallel_pq_v2.h:76] insert failed, size(hashtable)=754
W20240125 16:35:36.053306 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:35:36.475174 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
E20240125 16:35:36.668016 35285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1634
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.742 ms                  | 50.248 ms                 |
| Forward                   | 6.432 ms                  | 42.249 ms                 |
| Backward                  | 5.874 ms                  | 27.639 ms                 |
| Optimize                  | 2.378 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 22.181 ms                 | 74.020 ms                 |
| AfterBackward             | 78.473 ms                 | 140.232 ms                |
| BlockToStepN              | 72.138 ms                 | 376.185 ms                |
| OneStep                   | 223.930 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:37.072297 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:37.482846 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.649 ms                 | 38.474 ms                 |
| ProcessBack:UpdateCache   | 20.107 ms                 | 57.303 ms                 |
| ProcessBack:UpsertPq      | 28.155 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.350 ms                 | 140.097 ms                |
| BlockToStepN              | 70.848 ms                 | 376.004 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:37.670779 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=9903
W20240125 16:35:38.094359 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:35:38.547704 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240125 16:35:38.670444 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
W20240125 16:35:39.138252 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:39.591521 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
E20240125 16:35:39.670017 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7274
W20240125 16:35:40.215759 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:35:40.602176 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=229, pq.top=229
E20240125 16:35:40.670027 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6034
W20240125 16:35:41.438555 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:41.608461 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.741 ms                  | 50.248 ms                 |
| Forward                   | 6.411 ms                  | 42.249 ms                 |
| Backward                  | 5.925 ms                  | 27.639 ms                 |
| Optimize                  | 2.387 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 22.134 ms                 | 77.134 ms                 |
| AfterBackward             | 78.806 ms                 | 147.821 ms                |
| BlockToStepN              | 68.934 ms                 | 376.185 ms                |
| OneStep                   | 223.707 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:41.688836 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4430
W20240125 16:35:42.558409 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.078 ms                 | 38.474 ms                 |
| ProcessBack:UpdateCache   | 19.939 ms                 | 56.908 ms                 |
| ProcessBack:UpsertPq      | 27.972 ms                 | 89.251 ms                 |
| ProcessOneStep            | 79.053 ms                 | 147.748 ms                |
| BlockToStepN              | 68.470 ms                 | 376.004 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:42.692623 35285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1930
W20240125 16:35:42.698500 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240125 16:35:43.698441 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
E20240125 16:35:43.716835 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4925
W20240125 16:35:43.850309 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:35:44.716035 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8438
W20240125 16:35:44.804349 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240125 16:35:44.857159 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:35:45.718385 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4961
W20240125 16:35:45.889501 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240125 16:35:45.971354 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.735 ms                  | 46.167 ms                 |
| Forward                   | 6.377 ms                  | 41.429 ms                 |
| Backward                  | 5.894 ms                  | 24.600 ms                 |
| Optimize                  | 2.386 ms                  | 5.912 ms                  |
| BarrierTimeBeforeRank0    | 22.388 ms                 | 85.626 ms                 |
| AfterBackward             | 78.806 ms                 | 140.421 ms                |
| BlockToStepN              | 67.552 ms                 | 377.803 ms                |
| OneStep                   | 223.450 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:46.718014 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3781
W20240125 16:35:46.889554 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240125 16:35:47.070726 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.961 ms                 | 38.613 ms                 |
| ProcessBack:UpdateCache   | 19.603 ms                 | 56.908 ms                 |
| ProcessBack:UpsertPq      | 27.962 ms                 | 89.251 ms                 |
| ProcessOneStep            | 78.639 ms                 | 140.351 ms                |
| BlockToStepN              | 67.336 ms                 | 377.603 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:47.720888 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=9196
W20240125 16:35:47.891041 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240125 16:35:48.076186 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:35:48.724921 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3393
W20240125 16:35:48.894045 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240125 16:35:49.077723 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:35:49.759202 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4165
W20240125 16:35:50.048487 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240125 16:35:50.098340 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:35:50.767875 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4376
W20240125 16:35:51.101692 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:35:51.143761 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.741 ms                  | 46.167 ms                 |
| Forward                   | 6.373 ms                  | 41.429 ms                 |
| Backward                  | 5.874 ms                  | 24.600 ms                 |
| Optimize                  | 2.382 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 22.388 ms                 | 85.626 ms                 |
| AfterBackward             | 78.763 ms                 | 140.421 ms                |
| BlockToStepN              | 68.645 ms                 | 377.803 ms                |
| OneStep                   | 223.638 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:51.767026 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6626
W20240125 16:35:52.102735 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:35:52.195808 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=275, pq.top=275
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.961 ms                 | 38.613 ms                 |
| ProcessBack:UpdateCache   | 19.519 ms                 | 55.419 ms                 |
| ProcessBack:UpsertPq      | 27.962 ms                 | 87.356 ms                 |
| ProcessOneStep            | 78.674 ms                 | 140.351 ms                |
| BlockToStepN              | 67.086 ms                 | 377.603 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:52.768884 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8004
W20240125 16:35:53.182296 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:35:53.352140 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=280, pq.top=280
E20240125 16:35:53.768280 36868 parallel_pq_v2.h:76] insert failed, size(hashtable)=953
W20240125 16:35:54.192294 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:35:54.561681 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
E20240125 16:35:54.771992 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4183
W20240125 16:35:55.342275 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:35:55.562600 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=288, pq.top=288
E20240125 16:35:55.773459 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4868
W20240125 16:35:56.355262 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:35:56.626082 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.741 ms                  | 46.167 ms                 |
| Forward                   | 6.348 ms                  | 41.429 ms                 |
| Backward                  | 5.866 ms                  | 24.600 ms                 |
| Optimize                  | 2.387 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 23.222 ms                 | 90.636 ms                 |
| AfterBackward             | 79.164 ms                 | 140.421 ms                |
| BlockToStepN              | 68.375 ms                 | 377.803 ms                |
| OneStep                   | 223.930 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:35:56.773023 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7905
W20240125 16:35:57.365624 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.322 ms                 | 42.377 ms                 |
| ProcessBack:UpdateCache   | 19.492 ms                 | 55.419 ms                 |
| ProcessBack:UpsertPq      | 27.775 ms                 | 92.103 ms                 |
| ProcessOneStep            | 79.053 ms                 | 140.351 ms                |
| BlockToStepN              | 67.336 ms                 | 377.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:35:57.673609 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
E20240125 16:35:57.780841 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3906
W20240125 16:35:58.516733 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 4] 300 steps, total: 24.400, sample: 0.497, forward: 0.808, backward: 1.075, update: 0.246
[proc 0] 300 steps, total: 24.384, sample: 0.503, forward: 0.785, backward: 0.833, update: 0.235
[proc 2] 300 steps, total: 24.388, sample: 0.570, forward: 0.780, backward: 0.859, update: 0.261
[proc 3] 300 steps, total: 24.393, sample: 0.553, forward: 0.749, backward: 1.023, update: 0.259
[proc 7] 300 steps, total: 24.413, sample: 0.518, forward: 0.745, backward: 1.005, update: 0.268
[proc 6] 300 steps, total: 24.404, sample: 0.651, forward: 0.980, backward: 0.991, update: 0.265
[proc 5] 300 steps, total: 24.397, sample: 0.544, forward: 0.776, backward: 0.925, update: 0.249
[proc 1] 300 steps, total: 24.405, sample: 0.603, forward: 0.813, backward: 0.924, update: 0.258
W20240125 16:35:58.773207 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240125 16:35:58.780840 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3340
W20240125 16:35:59.555439 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:35:59.786183 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:36:00.132342 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240125 16:36:00.581331 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:36:00.786854 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:36:01.261137 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240125 16:36:01.588274 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.736 ms                  | 46.167 ms                 |
| Forward                   | 6.331 ms                  | 41.429 ms                 |
| Backward                  | 5.858 ms                  | 24.600 ms                 |
| Optimize                  | 2.387 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 23.536 ms                 | 90.636 ms                 |
| AfterBackward             | 79.164 ms                 | 140.421 ms                |
| BlockToStepN              | 67.128 ms                 | 377.803 ms                |
| OneStep                   | 222.436 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:01.786468 36867 parallel_pq_v2.h:76] insert failed, size(hashtable)=32
W20240125 16:36:02.336181 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.322 ms                 | 47.718 ms                 |
| ProcessBack:UpdateCache   | 19.519 ms                 | 55.419 ms                 |
| ProcessBack:UpsertPq      | 27.962 ms                 | 92.103 ms                 |
| ProcessOneStep            | 79.328 ms                 | 140.351 ms                |
| BlockToStepN              | 65.818 ms                 | 377.603 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:02.786032 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5118
W20240125 16:36:02.825814 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:36:03.347057 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240125 16:36:03.787068 35593 parallel_pq_v2.h:76] insert failed, size(hashtable)=1214
W20240125 16:36:03.850435 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:36:04.460484 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
E20240125 16:36:04.786942 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=76
W20240125 16:36:04.856163 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:36:05.500294 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=329, pq.top=329
E20240125 16:36:05.786283 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=100
W20240125 16:36:06.002482 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:36:06.622593 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=334, pq.top=334
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.736 ms                  | 48.119 ms                 |
| Forward                   | 6.307 ms                  | 41.429 ms                 |
| Backward                  | 5.825 ms                  | 24.600 ms                 |
| Optimize                  | 2.385 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 24.095 ms                 | 90.636 ms                 |
| AfterBackward             | 79.434 ms                 | 147.636 ms                |
| BlockToStepN              | 66.240 ms                 | 377.803 ms                |
| OneStep                   | 223.638 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:06.792870 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8222
W20240125 16:36:07.358259 36193 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:36:07.624171 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.166 ms                 | 42.377 ms                 |
| ProcessBack:UpdateCache   | 19.603 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 28.358 ms                 | 92.103 ms                 |
| ProcessOneStep            | 79.474 ms                 | 147.521 ms                |
| BlockToStepN              | 66.044 ms                 | 407.937 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:07.792927 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3984
W20240125 16:36:08.359869 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:36:08.714422 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=341, pq.top=341
E20240125 16:36:08.792075 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8979
W20240125 16:36:09.363943 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:36:09.737895 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=345
E20240125 16:36:09.792013 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4791
W20240125 16:36:10.544193 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:36:10.738901 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=348, pq.top=348
E20240125 16:36:10.793548 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5101
W20240125 16:36:11.558270 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.729 ms                  | 46.167 ms                 |
| Forward                   | 6.283 ms                  | 28.179 ms                 |
| Backward                  | 5.804 ms                  | 23.680 ms                 |
| Optimize                  | 2.386 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 24.941 ms                 | 85.626 ms                 |
| AfterBackward             | 78.806 ms                 | 140.421 ms                |
| BlockToStepN              | 68.645 ms                 | 377.803 ms                |
| OneStep                   | 223.889 ms                | 588.836 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:11.793020 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8672
W20240125 16:36:12.274276 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.770 ms                  | 44.861 ms                 |
| ProcessBack:UpdateCache   | 19.411 ms                 | 55.419 ms                 |
| ProcessBack:UpsertPq      | 27.962 ms                 | 92.103 ms                 |
| ProcessOneStep            | 78.674 ms                 | 140.351 ms                |
| BlockToStepN              | 67.336 ms                 | 377.603 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:12.793058 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4853
W20240125 16:36:12.875505 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:36:13.275620 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240125 16:36:13.799284 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5121
W20240125 16:36:14.100845 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:36:14.294626 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240125 16:36:14.799018 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=9663
W20240125 16:36:15.297000 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240125 16:36:15.575210 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:36:15.816834 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8854
W20240125 16:36:16.296761 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=365, pq.top=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.729 ms                  | 46.167 ms                 |
| Forward                   | 6.277 ms                  | 28.179 ms                 |
| Backward                  | 5.810 ms                  | 23.680 ms                 |
| Optimize                  | 2.387 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.744 ms                 | 85.626 ms                 |
| AfterBackward             | 78.763 ms                 | 140.421 ms                |
| BlockToStepN              | 68.375 ms                 | 433.781 ms                |
| OneStep                   | 223.638 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:16.824846 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7217
W20240125 16:36:16.837028 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:36:17.299705 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=370, pq.top=370
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.634 ms                  | 44.861 ms                 |
| ProcessBack:UpdateCache   | 19.329 ms                 | 55.419 ms                 |
| ProcessBack:UpsertPq      | 27.972 ms                 | 92.103 ms                 |
| ProcessOneStep            | 78.365 ms                 | 140.351 ms                |
| BlockToStepN              | 67.086 ms                 | 433.588 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:17.836262 36876 parallel_pq_v2.h:76] insert failed, size(hashtable)=1634
W20240125 16:36:17.887023 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:36:18.329237 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240125 16:36:18.836551 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
W20240125 16:36:18.894817 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:36:19.365698 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240125 16:36:19.836094 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
W20240125 16:36:20.058923 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:36:20.681815 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240125 16:36:20.836076 36866 parallel_pq_v2.h:76] insert failed, size(hashtable)=1422
W20240125 16:36:21.061599 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.734 ms                  | 46.167 ms                 |
| Forward                   | 6.243 ms                  | 28.179 ms                 |
| Backward                  | 5.788 ms                  | 23.680 ms                 |
| Optimize                  | 2.388 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.720 ms                 | 85.626 ms                 |
| AfterBackward             | 78.450 ms                 | 140.421 ms                |
| BlockToStepN              | 68.375 ms                 | 433.781 ms                |
| OneStep                   | 223.450 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:36:21.685160 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=389
E20240125 16:36:21.836220 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=10121
W20240125 16:36:22.148897 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.770 ms                  | 42.377 ms                 |
| ProcessBack:UpdateCache   | 19.316 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 27.916 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.365 ms                 | 140.351 ms                |
| BlockToStepN              | 67.086 ms                 | 433.588 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:36:22.827697 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=394, pq.top=394
E20240125 16:36:22.840837 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4351
W20240125 16:36:23.152592 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:36:23.832545 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=398, pq.top=398
E20240125 16:36:23.843549 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4809
[proc 0] 400 steps, total: 25.648, sample: 0.502, forward: 0.729, backward: 0.719, update: 0.234
[proc 3] 400 steps, total: 25.648, sample: 0.582, forward: 0.755, backward: 1.132, update: 0.241
[proc 7] 400 steps, total: 25.646, sample: 0.642, forward: 0.720, backward: 1.178, update: 0.248
W20240125 16:36:24.327714 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
[proc 5] 400 steps, total: 25.651, sample: 0.538, forward: 0.780, backward: 0.973, update: 0.247
[proc 4] 400 steps, total: 25.655, sample: 0.544, forward: 0.743, backward: 0.984, update: 0.267
[proc 6] 400 steps, total: 25.659, sample: 0.470, forward: 0.894, backward: 0.961, update: 0.257
[proc 2] 400 steps, total: 25.663, sample: 0.506, forward: 0.758, backward: 1.181, update: 0.237
[proc 1] 400 steps, total: 25.641, sample: 0.520, forward: 0.721, backward: 1.137, update: 0.224
E20240125 16:36:24.846334 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3150
W20240125 16:36:24.875382 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240125 16:36:25.347697 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:36:25.852892 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3533
W20240125 16:36:25.879207 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240125 16:36:26.388823 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.727 ms                  | 46.167 ms                 |
| Forward                   | 6.230 ms                  | 28.179 ms                 |
| Backward                  | 5.788 ms                  | 23.680 ms                 |
| Optimize                  | 2.388 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.784 ms                 | 85.626 ms                 |
| AfterBackward             | 78.100 ms                 | 140.421 ms                |
| BlockToStepN              | 67.291 ms                 | 433.781 ms                |
| OneStep                   | 222.533 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:26.852860 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3936
W20240125 16:36:27.027367 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240125 16:36:27.535915 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.770 ms                  | 43.635 ms                 |
| ProcessBack:UpdateCache   | 19.304 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 27.962 ms                 | 90.835 ms                 |
| ProcessOneStep            | 78.277 ms                 | 140.351 ms                |
| BlockToStepN              | 65.818 ms                 | 433.588 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:27.852252 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
W20240125 16:36:28.161782 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240125 16:36:28.823889 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:36:28.852634 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
W20240125 16:36:29.184201 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240125 16:36:29.839423 36193 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:36:29.852013 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7647
W20240125 16:36:30.582334 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
E20240125 16:36:30.856341 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4525
W20240125 16:36:30.902276 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:36:31.583542 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.727 ms                  | 46.167 ms                 |
| Forward                   | 6.219 ms                  | 28.179 ms                 |
| Backward                  | 5.796 ms                  | 23.680 ms                 |
| Optimize                  | 2.390 ms                  | 10.536 ms                 |
| BarrierTimeBeforeRank0    | 25.855 ms                 | 85.626 ms                 |
| AfterBackward             | 78.473 ms                 | 140.421 ms                |
| BlockToStepN              | 67.291 ms                 | 433.781 ms                |
| OneStep                   | 223.707 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:31.860994 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:36:31.904594 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:36:32.588081 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.006 ms                 | 44.861 ms                 |
| ProcessBack:UpdateCache   | 19.196 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 28.461 ms                 | 89.251 ms                 |
| ProcessOneStep            | 78.590 ms                 | 140.351 ms                |
| BlockToStepN              | 66.914 ms                 | 433.588 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:32.860023 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=4262
W20240125 16:36:32.930397 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:36:33.692219 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240125 16:36:33.860558 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=68
W20240125 16:36:34.030829 36193 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:36:34.844926 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
E20240125 16:36:34.864832 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5427
W20240125 16:36:35.063638 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:36:35.864012 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=7146
W20240125 16:36:36.011169 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=448, pq.top=448
W20240125 16:36:36.065402 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.725 ms                  | 45.085 ms                 |
| Forward                   | 6.210 ms                  | 26.115 ms                 |
| Backward                  | 5.796 ms                  | 22.133 ms                 |
| Optimize                  | 2.389 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.997 ms                 | 79.911 ms                 |
| AfterBackward             | 78.681 ms                 | 140.421 ms                |
| BlockToStepN              | 67.291 ms                 | 433.781 ms                |
| OneStep                   | 224.031 ms                | 631.527 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:36.864856 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3991
W20240125 16:36:37.084810 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240125 16:36:37.186852 36193 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.006 ms                 | 44.861 ms                 |
| ProcessBack:UpdateCache   | 19.323 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 28.155 ms                 | 89.251 ms                 |
| ProcessOneStep            | 78.365 ms                 | 140.097 ms                |
| BlockToStepN              | 67.086 ms                 | 420.875 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:37.864014 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6342
W20240125 16:36:38.216653 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240125 16:36:38.298170 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:36:38.864012 35285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1662
W20240125 16:36:39.216639 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240125 16:36:39.303651 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:36:39.864836 36866 parallel_pq_v2.h:76] insert failed, size(hashtable)=1820
W20240125 16:36:40.255847 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240125 16:36:40.309108 36193 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:36:40.864017 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=5428
W20240125 16:36:41.258831 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240125 16:36:41.314273 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.727 ms                  | 45.085 ms                 |
| Forward                   | 6.228 ms                  | 27.708 ms                 |
| Backward                  | 5.819 ms                  | 22.133 ms                 |
| Optimize                  | 2.390 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.852 ms                 | 79.911 ms                 |
| AfterBackward             | 79.164 ms                 | 140.421 ms                |
| BlockToStepN              | 67.125 ms                 | 421.076 ms                |
| OneStep                   | 224.043 ms                | 609.508 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:41.864419 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=101
W20240125 16:36:42.296998 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240125 16:36:42.410347 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.961 ms                  | 47.718 ms                 |
| ProcessBack:UpdateCache   | 19.241 ms                 | 54.847 ms                 |
| ProcessBack:UpsertPq      | 28.155 ms                 | 89.251 ms                 |
| ProcessOneStep            | 79.053 ms                 | 140.351 ms                |
| BlockToStepN              | 66.914 ms                 | 420.875 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:42.864019 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=6411
W20240125 16:36:43.297530 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240125 16:36:43.410320 36193 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:36:43.877092 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3341
W20240125 16:36:44.307777 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240125 16:36:44.411285 36193 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:36:44.879499 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=3535
W20240125 16:36:45.319294 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240125 16:36:45.415675 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:36:45.879102 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=133
W20240125 16:36:46.326494 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240125 16:36:46.566658 36193 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.728 ms                  | 45.085 ms                 |
| Forward                   | 6.219 ms                  | 27.708 ms                 |
| Backward                  | 5.818 ms                  | 24.430 ms                 |
| Optimize                  | 2.392 ms                  | 9.960 ms                  |
| BarrierTimeBeforeRank0    | 25.855 ms                 | 79.911 ms                 |
| AfterBackward             | 78.806 ms                 | 140.421 ms                |
| BlockToStepN              | 68.934 ms                 | 421.076 ms                |
| OneStep                   | 224.222 ms                | 609.508 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:46.881744 36865 parallel_pq_v2.h:76] insert failed, size(hashtable)=1253
W20240125 16:36:47.331652 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240125 16:36:47.588582 36193 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.961 ms                  | 44.861 ms                 |
| ProcessBack:UpdateCache   | 19.196 ms                 | 53.714 ms                 |
| ProcessBack:UpsertPq      | 27.801 ms                 | 87.356 ms                 |
| ProcessOneStep            | 78.639 ms                 | 140.351 ms                |
| BlockToStepN              | 67.767 ms                 | 420.875 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:36:47.882913 36193 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
W20240125 16:36:48.334125 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240125 16:36:48.597203 36193 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:36:48.896854 36192 parallel_pq_v2.h:76] insert failed, size(hashtable)=8163
W20240125 16:36:49.339221 35285 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 4] 500 steps, total: 25.053, sample: 0.599, forward: 0.783, backward: 0.942, update: 0.283
[proc 0] 500 steps, total: 25.060, sample: 0.476, forward: 0.801, backward: 0.850, update: 0.237
[proc 5] 500 steps, total: 25.053, sample: 0.549, forward: 0.765, backward: 0.870, update: 0.230
[proc 7] 500 steps, total: 25.060, sample: 0.592, forward: 0.778, backward: 0.929, update: 0.263
[proc 6] 500 steps, total: 25.046, sample: 0.472, forward: 0.768, backward: 1.085, update: 0.217
Successfully xmh. training takes 129.59574103355408 seconds
before call kg_cache_controller.StopThreads()
W20240125 16:36:49.387053 35285 grad_async_v2.h:71] call StopThreads. PID = 33681
W20240125 16:36:49.387091 35285 grad_base.h:210] before processOneStepNegThread_.join();
[proc 3] 500 steps, total: 25.061, sample: 0.530, forward: 0.802, backward: 1.037, update: 0.236
[proc 2] 500 steps, total: 25.047, sample: 0.555, forward: 0.764, backward: 1.167, update: 0.245
[proc 1] 500 steps, total: 25.035, sample: 0.560, forward: 0.798, backward: 1.112, update: 0.249
W20240125 16:36:49.396014 35285 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 16:36:49.396095 35285 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240125 16:36:49.404729 35285 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f6357434a50>
