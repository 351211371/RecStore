WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 16:20:19.690902 29532 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_105', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [29532 sampler.py:454] Start PreSampling
WARNING [29532 sampler.py:532] Before construct renumbering_dict
WARNING [29532 sampler.py:555] PreSampling done
W20240125 16:20:30.705592 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 16:20:30.706485 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 16:20:30.706928 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 16:20:30.707152 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 16:20:30.707371 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 16:20:30.707587 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 16:20:30.707792 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 16:20:30.708009 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 16:20:30.708223 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 16:20:30.708434 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 16:20:30.708671 29532 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 16:20:30.708962 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 16:20:30.709147 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 16:20:30.709599 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 16:20:30.709821 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 16:20:30.709978 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 16:20:30.710131 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 16:20:30.710304 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 16:20:30.710459 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 16:20:30.710618 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 16:20:30.710767 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 16:20:30.710925 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 16:20:30.711097 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 16:20:30.711264 29532 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 16:20:30.711437 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 16:20:30.711594 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 16:20:30.711867 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 16:20:30.712041 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 16:20:30.712194 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 16:20:30.712340 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 16:20:30.712486 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 16:20:30.712651 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 16:20:30.712849 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 16:20:30.713130 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 16:20:30.713351 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 16:20:30.713562 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 16:20:30.713768 29532 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 16:20:30.713960 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 16:20:30.714147 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 16:20:30.714424 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 16:20:30.714637 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 16:20:30.714834 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 16:20:30.715039 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 16:20:30.715237 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 16:20:30.715446 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 16:20:30.715653 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 16:20:30.715874 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 16:20:30.716081 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 16:20:30.716313 29532 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 16:20:30.716471 29532 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 16:20:30.716612 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 16:20:30.716754 29532 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 16:20:31.196067 29532 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100001ee2000 22.81 MB
W20240125 16:20:31.196372 29532 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([3705, 3890, 3947,  ..., 8468, 2751, 8865]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 11.670 seconds
[Rank1] pid = 30712
[Rank2] pid = 30776
INFO [30712 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29532 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [30776 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [30778 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29532 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [30712 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [30776 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [30778 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240125 16:20:32.691536 30796 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240125 16:20:32.692051 30777 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240125 16:20:32.692049 30713 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240125 16:20:32.692050 30842 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240125 16:20:32.731423 30713 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x100003691000 781.2 kB
W20240125 16:20:32.731416 30796 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x1000035cc000 781.2 kB
W20240125 16:20:32.731479 30777 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x100003756000 781.2 kB
W20240125 16:20:32.731518 30842 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x10000381b000 781.2 kB
W20240125 16:20:32.731673 30842 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x1000038e0000 781.2 kB
W20240125 16:20:32.731684 30777 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x1000039a5000 781.2 kB
W20240125 16:20:32.731755 30777 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x100003a6a000 152.6 MB
W20240125 16:20:32.731761 30842 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10000d302000 152.6 MB
W20240125 16:20:32.731765 30796 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x100016b9a000 781.2 kB
W20240125 16:20:32.731818 30713 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x100016c5f000 781.2 kB
W20240125 16:20:32.731833 30842 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100016d24000 152.6 MB
W20240125 16:20:32.731835 30796 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x1000205bc000 152.6 MB
W20240125 16:20:32.731851 30777 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x100029e54000 152.6 MB
W20240125 16:20:32.731873 30796 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1000336ec000 152.6 MB
W20240125 16:20:32.731905 30842 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:20:32.731910 30777 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:20:32.731917 30713 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10003cf84000 152.6 MB
W20240125 16:20:32.731928 30796 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:20:32.731981 30713 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10004681c000 152.6 MB
W20240125 16:20:32.732018 30713 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:20:32.734174 30777 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:20:32.734174 30796 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:20:32.734185 30842 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:20:32.734174 30713 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100001ee2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100001ee2000
2: KnownLocalCachedEmbedding init done
WARNING [30776 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [30778 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
1: KnownLocalCachedEmbedding init done
[Rank3] pid = 30778
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
cudaHostRegister 0x100001ee2000
0: KnownLocalCachedEmbedding init done
WARNING [29532 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [30712 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 16:20:32.969007 30796 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240125 16:20:32.969079 30713 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240125 16:20:32.969136 30842 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240125 16:20:32.969198 30777 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240125 16:20:32.970175 30796 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 16:20:32.970352 30796 grad_base.h:172] Init GradProcessingBase done
I20240125 16:20:32.976109 30796 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 16:20:32.976333 30796 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 16:20:32.976349 30796 kg_controller.h:84] Construct KGCacheController done
I20240125 16:20:33.573223 30796 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 16:20:34.443589 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:20:34.444168 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 16:20:34.540634 30777 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240125 16:20:34.547401 30713 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240125 16:20:34.547868 30842 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240125 16:20:34.667035 30796 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.237 ms                  | 1.237 ms                  |
| Forward                   | 2.469 s                   | 2.469 s                   |
| Backward                  | 707.602 ms                | 707.602 ms                |
| Optimize                  | 6.145 ms                  | 6.145 ms                  |
| BarrierTimeBeforeRank0    | 134.116 us                | 134.116 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 603.936 ms                | 604.012 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:20:39.461169 31684 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240125 16:20:39.597630 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 16:20:39.710135 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:20:40.462146 31685 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240125 16:20:40.597033 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240125 16:20:40.718976 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:20:41.461328 31684 parallel_pq_v2.h:76] insert failed, size(hashtable)=504
W20240125 16:20:41.602980 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240125 16:20:41.737737 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:20:42.461275 31683 parallel_pq_v2.h:76] insert failed, size(hashtable)=595
W20240125 16:20:42.672037 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240125 16:20:42.745538 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.968 ms                  | 54.669 ms                 |
| Forward                   | 7.719 ms                  | 2.469 s                   |
| Backward                  | 7.299 ms                  | 707.602 ms                |
| Optimize                  | 3.476 ms                  | 22.267 ms                 |
| BarrierTimeBeforeRank0    | 1.202 ms                  | 25.958 ms                 |
| AfterBackward             | 41.903 ms                 | 1.738 s                   |
| BlockToStepN              | 20.993 ms                 | 100.049 ms                |
| OneStep                   | 112.600 ms                | 5.034 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 16:20:43.461040 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=76
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.114 ms                  | 603.936 ms                |
| ProcessBack:UpdateCache   | 2.644 ms                  | 958.472 ms                |
| ProcessBack:UpsertPq      | 19.989 ms                 | 99.354 ms                 |
| ProcessOneStep            | 40.332 ms                 | 1.738 s                   |
| BlockToStepN              | 22.749 ms                 | 106.187 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:43.672032 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=32, pq.top=32
W20240125 16:20:43.887511 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:20:44.461582 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5433
W20240125 16:20:44.764387 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240125 16:20:44.891353 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:20:45.468039 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=168
W20240125 16:20:45.837729 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240125 16:20:45.960686 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:20:46.469074 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4137
W20240125 16:20:46.912019 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=53, pq.top=52
W20240125 16:20:46.960439 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:20:47.469180 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=273
W20240125 16:20:47.931737 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=60, pq.top=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.968 ms                  | 47.286 ms                 |
| Forward                   | 7.656 ms                  | 52.335 ms                 |
| Backward                  | 7.458 ms                  | 40.270 ms                 |
| Optimize                  | 3.429 ms                  | 7.593 ms                  |
| BarrierTimeBeforeRank0    | 774.614 us                | 24.910 ms                 |
| AfterBackward             | 39.487 ms                 | 94.229 ms                 |
| BlockToStepN              | 29.868 ms                 | 130.048 ms                |
| OneStep                   | 133.552 ms                | 279.609 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:47.988487 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:20:48.470902 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3708
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.068 ms                  | 603.936 ms                |
| ProcessBack:UpdateCache   | 2.657 ms                  | 958.472 ms                |
| ProcessBack:UpsertPq      | 20.141 ms                 | 99.354 ms                 |
| ProcessOneStep            | 39.275 ms                 | 94.160 ms                 |
| BlockToStepN              | 38.062 ms                 | 129.843 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:48.957628 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240125 16:20:48.993342 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:20:49.470050 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=7543
W20240125 16:20:50.013623 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240125 16:20:50.108997 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:20:50.472865 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=106
W20240125 16:20:50.698812 31686 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240125 16:20:51.076298 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240125 16:20:51.140992 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:20:51.476883 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5414
W20240125 16:20:52.082216 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240125 16:20:52.144184 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:20:52.476217 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=445
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.965 ms                  | 47.286 ms                 |
| Forward                   | 7.582 ms                  | 52.335 ms                 |
| Backward                  | 7.237 ms                  | 40.270 ms                 |
| Optimize                  | 3.379 ms                  | 7.593 ms                  |
| BarrierTimeBeforeRank0    | 2.168 ms                  | 31.100 ms                 |
| AfterBackward             | 37.136 ms                 | 94.229 ms                 |
| BlockToStepN              | 39.464 ms                 | 200.549 ms                |
| OneStep                   | 133.360 ms                | 327.307 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:53.171422 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=96, pq.top=96
W20240125 16:20:53.184504 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:20:53.476387 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5672
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.927 ms                  | 47.813 ms                 |
| ProcessBack:UpdateCache   | 2.638 ms                  | 33.107 ms                 |
| ProcessBack:UpsertPq      | 18.340 ms                 | 88.471 ms                 |
| ProcessOneStep            | 37.660 ms                 | 94.160 ms                 |
| BlockToStepN              | 39.226 ms                 | 200.329 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 19.188, sample: 0.525, forward: 2.352, backward: 1.698, update: 0.309
train_sampler.Prefill()
-------Step 0-------
tensor([10192,  4764,  7651,  5569,    58,  6623,  9654,    70,    77, 13037]) tensor([ 3947, 10127,  2812, 14122,  3017, 13478,  3935,  6920,  2674,  8202])
-------Step 1-------
tensor([10192,  4764,  7651,  5569,    58,  6623,  9654,    70,    77, 13037]) tensor([3856, 9126, 5893, 4583, 7522, 6586, 6118, 1786, 6276, 9820])
-------Step 2-------
tensor([ 7626, 14561,  4943, 13235,    44,  1790,    13, 12822,  4477, 13787]) tensor([10518,  1990,  7538,  4576,  5416,    52, 13567, 13068, 10053, 14282])
-------Step 3-------
tensor([ 7626, 14561,  4943, 13235,    44,  1790,    13, 12822,  4477, 13787]) tensor([ 5911, 13745, 14367,  3615,  4924,  3862, 11670,  4016,  3795, 10774])
-------Step 4-------
tensor([14687,  8887,  4038,  2418,  9446, 10887,  5294, 14941,   170,  6053]) tensor([  578,  3143, 10964,  5330,  2572,    32,  1755,  4435,  6447,  8839])
-------Step 5-------
tensor([14687,  8887,  4038,  2418,  9446, 10887,  5294, 14941,   170,  6053]) tensor([ 7500,  7308,  2295,  8350,  6924,  6459,  6239, 14266,  7063, 13626])
-------Step 6-------
tensor([ 7170,  2957,  1889, 12346,    99,  6371,  7294,  5248,    57,  1980]) tensor([ 6474, 12643,  7700,  9185, 10427, 13693,  2418,  3738,  8654,  5174])
-------Step 7-------
tensor([ 7170,  2957,  1889, 12346,    99,  6371,  7294,  5248,    57,  1980]) tensor([ 6197,  3198, 10277,  7807, 13754,   826,  2707,  2097,  4990,  6629])
-------Step 8-------
tensor([   11,  5960,    54,  5245,  5818, 13363, 11626,  5977,   114,  3781]) tensor([ 8959,  3443,  1137,  9119,  9527, 12292,  1683,  8536,  9285,  7562])
-------Step 9-------
tensor([   11,  5960,    54,  5245,  5818, 13363, 11626,  5977,   114,  3781]) tensor([ 6212,  7959, 14672,  3631, 11260,  1550,  8817,  1786, 13841,  5067])
before start barrier
start train
[proc 0] 100 steps, total: 19.068, sample: 0.684, forward: 3.573, backward: 1.575, update: 0.363
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.196, sample: 0.636, forward: 2.277, backward: 1.538, update: 0.309
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.192, sample: 0.472, forward: 2.494, backward: 1.569, update: 0.289
W20240125 16:20:54.171114 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240125 16:20:54.391557 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:20:54.479768 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4196
W20240125 16:20:55.230029 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=108, pq.top=108
W20240125 16:20:55.391608 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:20:55.484846 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=7159
W20240125 16:20:56.322180 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240125 16:20:56.397890 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:20:56.484014 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3685
W20240125 16:20:57.378895 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240125 16:20:57.404215 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:20:57.484834 31685 parallel_pq_v2.h:76] insert failed, size(hashtable)=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.968 ms                  | 49.445 ms                 |
| Forward                   | 7.565 ms                  | 52.335 ms                 |
| Backward                  | 7.157 ms                  | 40.270 ms                 |
| Optimize                  | 3.420 ms                  | 16.006 ms                 |
| BarrierTimeBeforeRank0    | 1.981 ms                  | 31.100 ms                 |
| AfterBackward             | 39.378 ms                 | 94.229 ms                 |
| BlockToStepN              | 39.625 ms                 | 218.031 ms                |
| OneStep                   | 133.360 ms                | 337.362 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:58.387626 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240125 16:20:58.463243 31272 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:20:58.484234 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.874 ms                  | 42.278 ms                 |
| ProcessBack:UpdateCache   | 2.481 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 18.231 ms                 | 84.144 ms                 |
| ProcessOneStep            | 38.910 ms                 | 94.160 ms                 |
| BlockToStepN              | 40.749 ms                 | 217.795 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:20:59.397866 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=136
E20240125 16:20:59.488859 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=6015
W20240125 16:20:59.498409 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:21:00.488081 31682 parallel_pq_v2.h:76] insert failed, size(hashtable)=1581
W20240125 16:21:00.506475 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240125 16:21:00.596810 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:21:01.488225 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=299
W20240125 16:21:01.570925 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=146, pq.top=146
W20240125 16:21:01.618110 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:21:02.488099 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3798
W20240125 16:21:02.570184 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
W20240125 16:21:02.620924 31272 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.965 ms                  | 50.358 ms                 |
| Forward                   | 7.392 ms                  | 47.256 ms                 |
| Backward                  | 7.094 ms                  | 34.686 ms                 |
| Optimize                  | 3.412 ms                  | 14.817 ms                 |
| BarrierTimeBeforeRank0    | 2.173 ms                  | 29.312 ms                 |
| AfterBackward             | 39.378 ms                 | 90.782 ms                 |
| BlockToStepN              | 44.170 ms                 | 223.904 ms                |
| OneStep                   | 136.780 ms                | 452.758 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:21:03.491552 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3676
W20240125 16:21:03.570317 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.872 ms                  | 42.278 ms                 |
| ProcessBack:UpdateCache   | 2.459 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 18.696 ms                 | 84.144 ms                 |
| ProcessOneStep            | 38.910 ms                 | 90.703 ms                 |
| BlockToStepN              | 44.186 ms                 | 223.365 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:03.733973 31272 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:21:04.491034 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=2994
W20240125 16:21:04.642339 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240125 16:21:04.745322 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:21:05.491030 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4616
W20240125 16:21:05.706867 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=170
W20240125 16:21:05.779594 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:21:06.491017 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3707
W20240125 16:21:06.736961 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
W20240125 16:21:06.780839 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:21:07.496837 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=8380
W20240125 16:21:07.736264 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240125 16:21:07.946935 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.961 ms                  | 50.358 ms                 |
| Forward                   | 7.300 ms                  | 47.256 ms                 |
| Backward                  | 7.160 ms                  | 34.686 ms                 |
| Optimize                  | 3.408 ms                  | 14.817 ms                 |
| BarrierTimeBeforeRank0    | 1.697 ms                  | 29.312 ms                 |
| AfterBackward             | 39.378 ms                 | 90.782 ms                 |
| BlockToStepN              | 46.716 ms                 | 306.635 ms                |
| OneStep                   | 138.072 ms                | 484.554 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:21:08.496026 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4599
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.849 ms                  | 34.822 ms                 |
| ProcessBack:UpdateCache   | 2.441 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 18.911 ms                 | 66.101 ms                 |
| ProcessOneStep            | 39.213 ms                 | 90.703 ms                 |
| BlockToStepN              | 47.697 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:08.740906 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240125 16:21:09.045344 31272 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:21:09.502310 30796 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:21:09.742847 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240125 16:21:10.046686 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:21:10.502017 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5007
W20240125 16:21:10.875015 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 2] 200 steps, total: 17.262, sample: 0.554, forward: 0.778, backward: 0.910, update: 0.336
[proc 3] 200 steps, total: 17.263, sample: 0.501, forward: 0.736, backward: 0.940, update: 0.328
[proc 1] 200 steps, total: 17.261, sample: 0.515, forward: 0.763, backward: 0.890, update: 0.333
[proc 0] 200 steps, total: 17.266, sample: 0.744, forward: 1.013, backward: 0.922, update: 0.348
W20240125 16:21:11.069674 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:21:11.502012 30796 parallel_pq_v2.h:76] insert failed, size(hashtable)=2287
W20240125 16:21:11.959003 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240125 16:21:12.142750 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:21:12.504235 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4782
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.952 ms                  | 50.358 ms                 |
| Forward                   | 7.162 ms                  | 47.256 ms                 |
| Backward                  | 7.092 ms                  | 34.686 ms                 |
| Optimize                  | 3.408 ms                  | 14.817 ms                 |
| BarrierTimeBeforeRank0    | 2.096 ms                  | 31.100 ms                 |
| AfterBackward             | 39.557 ms                 | 90.782 ms                 |
| BlockToStepN              | 50.048 ms                 | 306.635 ms                |
| OneStep                   | 139.687 ms                | 484.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:13.019912 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240125 16:21:13.158435 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:21:13.504858 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4474
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.837 ms                  | 34.822 ms                 |
| ProcessBack:UpdateCache   | 2.439 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 18.917 ms                 | 66.101 ms                 |
| ProcessOneStep            | 39.475 ms                 | 90.703 ms                 |
| BlockToStepN              | 49.971 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:14.023804 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240125 16:21:14.172008 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:21:14.509500 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5512
W20240125 16:21:15.023443 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240125 16:21:15.239065 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:21:15.515938 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4060
W20240125 16:21:16.067440 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240125 16:21:16.239459 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:21:16.523968 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5284
W20240125 16:21:17.083328 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240125 16:21:17.361454 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:21:17.523139 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=9256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.941 ms                  | 54.669 ms                 |
| Forward                   | 7.070 ms                  | 47.256 ms                 |
| Backward                  | 7.121 ms                  | 34.686 ms                 |
| Optimize                  | 3.388 ms                  | 14.817 ms                 |
| BarrierTimeBeforeRank0    | 2.136 ms                  | 31.430 ms                 |
| AfterBackward             | 39.606 ms                 | 90.782 ms                 |
| BlockToStepN              | 53.031 ms                 | 344.314 ms                |
| OneStep                   | 143.098 ms                | 491.796 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:18.086879 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240125 16:21:18.421430 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:21:18.523025 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4570
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.854 ms                  | 32.676 ms                 |
| ProcessBack:UpdateCache   | 2.433 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 19.129 ms                 | 65.680 ms                 |
| ProcessOneStep            | 39.475 ms                 | 90.703 ms                 |
| BlockToStepN              | 52.789 ms                 | 344.095 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:19.166018 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240125 16:21:19.470396 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:21:19.524565 30796 parallel_pq_v2.h:76] insert failed, size(hashtable)=784
W20240125 16:21:20.269831 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240125 16:21:20.499683 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:21:20.524025 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=8233
W20240125 16:21:21.314009 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240125 16:21:21.513346 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:21:21.524852 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=7254
W20240125 16:21:22.315398 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240125 16:21:22.524013 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=7534
W20240125 16:21:22.556625 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.938 ms                  | 50.358 ms                 |
| Forward                   | 7.059 ms                  | 43.884 ms                 |
| Backward                  | 7.121 ms                  | 32.850 ms                 |
| Optimize                  | 3.386 ms                  | 11.297 ms                 |
| BarrierTimeBeforeRank0    | 2.168 ms                  | 38.169 ms                 |
| AfterBackward             | 39.487 ms                 | 88.351 ms                 |
| BlockToStepN              | 54.100 ms                 | 306.635 ms                |
| OneStep                   | 143.252 ms                | 484.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:23.357496 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=275, pq.top=275
E20240125 16:21:23.528841 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4440
W20240125 16:21:23.558125 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.856 ms                  | 31.860 ms                 |
| ProcessBack:UpdateCache   | 2.435 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 19.030 ms                 | 60.946 ms                 |
| ProcessOneStep            | 39.423 ms                 | 88.244 ms                 |
| BlockToStepN              | 52.391 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:24.361194 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240125 16:21:24.532835 30796 parallel_pq_v2.h:76] insert failed, size(hashtable)=1314
W20240125 16:21:24.605855 31272 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:21:25.361724 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=286
E20240125 16:21:25.533809 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=6999
W20240125 16:21:25.762449 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:21:26.361604 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240125 16:21:26.533017 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4867
W20240125 16:21:26.767407 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:21:27.363624 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
E20240125 16:21:27.533205 31038 parallel_pq_v2.h:76] insert failed, size(hashtable)=946
W20240125 16:21:27.776716 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.937 ms                  | 50.358 ms                 |
| Forward                   | 7.070 ms                  | 43.884 ms                 |
| Backward                  | 7.123 ms                  | 32.850 ms                 |
| Optimize                  | 3.387 ms                  | 11.297 ms                 |
| BarrierTimeBeforeRank0    | 2.096 ms                  | 51.563 ms                 |
| AfterBackward             | 39.945 ms                 | 88.351 ms                 |
| BlockToStepN              | 56.491 ms                 | 306.635 ms                |
| OneStep                   | 145.186 ms                | 484.554 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 17.019, sample: 0.600, forward: 0.738, backward: 0.950, update: 0.315
[proc 0] 300 steps, total: 17.015, sample: 0.620, forward: 0.838, backward: 0.942, update: 0.327
[proc 2] 300 steps, total: 17.024, sample: 0.558, forward: 0.736, backward: 1.049, update: 0.348
[proc 1] 300 steps, total: 17.023, sample: 0.549, forward: 0.747, backward: 0.865, update: 0.285
W20240125 16:21:28.368280 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=302, pq.top=302
E20240125 16:21:28.533013 31683 parallel_pq_v2.h:76] insert failed, size(hashtable)=1837
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.868 ms                  | 31.860 ms                 |
| ProcessBack:UpdateCache   | 2.433 ms                  | 23.883 ms                 |
| ProcessBack:UpsertPq      | 19.033 ms                 | 60.946 ms                 |
| ProcessOneStep            | 39.737 ms                 | 88.244 ms                 |
| BlockToStepN              | 56.127 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:28.790364 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:21:29.423488 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=308, pq.top=308
E20240125 16:21:29.533121 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=10304
W20240125 16:21:29.914039 31272 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:21:30.425387 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240125 16:21:30.533254 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=11504
W20240125 16:21:30.976284 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:21:31.490195 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=318, pq.top=318
E20240125 16:21:31.535380 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5969
W20240125 16:21:32.015573 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:21:32.511324 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=324, pq.top=324
E20240125 16:21:32.536350 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4011
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.937 ms                  | 50.358 ms                 |
| Forward                   | 7.009 ms                  | 43.884 ms                 |
| Backward                  | 7.123 ms                  | 32.850 ms                 |
| Optimize                  | 3.383 ms                  | 11.297 ms                 |
| BarrierTimeBeforeRank0    | 3.021 ms                  | 62.213 ms                 |
| AfterBackward             | 39.656 ms                 | 88.351 ms                 |
| BlockToStepN              | 57.004 ms                 | 306.635 ms                |
| OneStep                   | 148.517 ms                | 484.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:33.016738 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:21:33.536015 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=8510
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.874 ms                  | 27.032 ms                 |
| ProcessBack:UpdateCache   | 2.433 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 19.030 ms                 | 58.677 ms                 |
| ProcessOneStep            | 39.527 ms                 | 88.244 ms                 |
| BlockToStepN              | 56.793 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:33.599897 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240125 16:21:34.017292 31272 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:21:34.540836 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4775
W20240125 16:21:34.601630 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240125 16:21:35.083035 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:21:35.542567 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5354
W20240125 16:21:35.609416 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240125 16:21:36.240408 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:21:36.543776 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5773
W20240125 16:21:36.692862 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=346, pq.top=346
W20240125 16:21:37.276876 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:21:37.543013 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=10352
W20240125 16:21:37.698364 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.931 ms                  | 50.358 ms                 |
| Forward                   | 6.999 ms                  | 38.932 ms                 |
| Backward                  | 7.169 ms                  | 32.850 ms                 |
| Optimize                  | 3.379 ms                  | 12.901 ms                 |
| BarrierTimeBeforeRank0    | 3.203 ms                  | 61.468 ms                 |
| AfterBackward             | 39.487 ms                 | 84.342 ms                 |
| BlockToStepN              | 58.616 ms                 | 306.635 ms                |
| OneStep                   | 149.108 ms                | 467.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:38.314369 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:21:38.543013 31683 parallel_pq_v2.h:76] insert failed, size(hashtable)=1358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.872 ms                  | 31.860 ms                 |
| ProcessBack:UpdateCache   | 2.432 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 19.024 ms                 | 58.677 ms                 |
| ProcessOneStep            | 39.423 ms                 | 84.209 ms                 |
| BlockToStepN              | 60.517 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:38.742225 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240125 16:21:39.332990 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:21:39.543123 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=131
W20240125 16:21:39.757774 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240125 16:21:40.334425 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:21:40.543629 31687 parallel_pq_v2.h:76] insert failed, size(hashtable)=877
W20240125 16:21:40.759539 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240125 16:21:41.363945 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:21:41.543015 31684 parallel_pq_v2.h:76] insert failed, size(hashtable)=439
W20240125 16:21:41.761710 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240125 16:21:42.401774 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:21:42.546133 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4024
W20240125 16:21:42.767707 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=383
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.934 ms                  | 50.358 ms                 |
| Forward                   | 6.897 ms                  | 38.932 ms                 |
| Backward                  | 7.157 ms                  | 32.850 ms                 |
| Optimize                  | 3.378 ms                  | 12.901 ms                 |
| BarrierTimeBeforeRank0    | 3.927 ms                  | 61.468 ms                 |
| AfterBackward             | 39.656 ms                 | 88.351 ms                 |
| BlockToStepN              | 60.726 ms                 | 306.635 ms                |
| OneStep                   | 149.409 ms                | 467.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:43.538707 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:21:43.546121 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.868 ms                  | 27.932 ms                 |
| ProcessBack:UpdateCache   | 2.423 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 19.154 ms                 | 60.946 ms                 |
| ProcessOneStep            | 39.592 ms                 | 88.244 ms                 |
| BlockToStepN              | 60.517 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:43.884917 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=389
E20240125 16:21:44.549311 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
W20240125 16:21:44.568535 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:21:44.892092 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=394, pq.top=394
E20240125 16:21:45.549013 31684 parallel_pq_v2.h:76] insert failed, size(hashtable)=146
W20240125 16:21:45.668751 31272 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 2] 400 steps, total: 17.822, sample: 0.608, forward: 0.842, backward: 1.011, update: 0.343
[proc 1] 400 steps, total: 17.826, sample: 0.625, forward: 0.806, backward: 0.975, update: 0.303
[proc 3] 400 steps, total: 17.832, sample: 0.620, forward: 0.726, backward: 1.070, update: 0.311
[proc 0] 400 steps, total: 17.833, sample: 0.592, forward: 0.831, backward: 1.005, update: 0.343
W20240125 16:21:45.931293 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240125 16:21:46.549016 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
W20240125 16:21:46.714440 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:21:47.018862 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240125 16:21:47.549014 31684 parallel_pq_v2.h:76] insert failed, size(hashtable)=1214
W20240125 16:21:47.790022 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.938 ms                  | 54.669 ms                 |
| Forward                   | 6.897 ms                  | 38.932 ms                 |
| Backward                  | 7.169 ms                  | 32.850 ms                 |
| Optimize                  | 3.384 ms                  | 12.901 ms                 |
| BarrierTimeBeforeRank0    | 4.101 ms                  | 62.213 ms                 |
| AfterBackward             | 40.133 ms                 | 88.351 ms                 |
| BlockToStepN              | 60.726 ms                 | 306.635 ms                |
| OneStep                   | 150.457 ms                | 467.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:48.113312 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=413
E20240125 16:21:48.552841 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=10395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.910 ms                  | 27.932 ms                 |
| ProcessBack:UpdateCache   | 2.438 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 19.154 ms                 | 60.946 ms                 |
| ProcessOneStep            | 40.044 ms                 | 88.244 ms                 |
| BlockToStepN              | 61.612 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:48.902431 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:21:49.181716 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=418, pq.top=418
E20240125 16:21:49.554073 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=12787
W20240125 16:21:50.030467 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:21:50.312386 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240125 16:21:50.554026 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=8412
W20240125 16:21:51.091833 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:21:51.332321 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=430, pq.top=430
E20240125 16:21:51.559049 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=9870
W20240125 16:21:52.138507 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:21:52.431758 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=437
E20240125 16:21:52.559026 30796 parallel_pq_v2.h:76] insert failed, size(hashtable)=1170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.939 ms                  | 55.898 ms                 |
| Forward                   | 6.853 ms                  | 38.932 ms                 |
| Backward                  | 7.169 ms                  | 32.850 ms                 |
| Optimize                  | 3.381 ms                  | 12.901 ms                 |
| BarrierTimeBeforeRank0    | 4.624 ms                  | 74.659 ms                 |
| AfterBackward             | 40.392 ms                 | 88.351 ms                 |
| BlockToStepN              | 60.357 ms                 | 306.635 ms                |
| OneStep                   | 152.185 ms                | 467.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:53.260144 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:21:53.453388 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=443, pq.top=443
E20240125 16:21:53.563046 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=12603
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.909 ms                  | 27.932 ms                 |
| ProcessBack:UpdateCache   | 2.438 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 19.178 ms                 | 58.677 ms                 |
| ProcessOneStep            | 40.207 ms                 | 88.244 ms                 |
| BlockToStepN              | 59.086 ms                 | 306.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:54.282876 31272 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:21:54.515623 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=450, pq.top=450
E20240125 16:21:54.563019 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=6847
W20240125 16:21:55.288661 31272 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:21:55.548650 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240125 16:21:55.564493 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3134
W20240125 16:21:56.296048 31272 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:21:56.548708 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240125 16:21:56.564846 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=5707
W20240125 16:21:57.300495 31272 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:21:57.569664 31272 parallel_pq_v2.h:76] insert failed, size(hashtable)=46
W20240125 16:21:57.630700 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.940 ms                  | 54.669 ms                 |
| Forward                   | 6.858 ms                  | 36.689 ms                 |
| Backward                  | 7.196 ms                  | 29.592 ms                 |
| Optimize                  | 3.379 ms                  | 14.429 ms                 |
| BarrierTimeBeforeRank0    | 4.705 ms                  | 72.809 ms                 |
| AfterBackward             | 40.423 ms                 | 87.469 ms                 |
| BlockToStepN              | 60.257 ms                 | 303.218 ms                |
| OneStep                   | 153.905 ms                | 452.758 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:58.307627 31272 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:21:58.569649 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=2310
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.904 ms                  | 31.860 ms                 |
| ProcessBack:UpdateCache   | 2.437 ms                  | 21.705 ms                 |
| ProcessBack:UpsertPq      | 19.368 ms                 | 58.677 ms                 |
| ProcessOneStep            | 40.338 ms                 | 87.400 ms                 |
| BlockToStepN              | 59.757 ms                 | 302.364 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:21:58.630340 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240125 16:21:59.308190 31272 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:21:59.569018 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=4813
W20240125 16:21:59.694674 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240125 16:22:00.424775 31272 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:22:00.576867 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=3652
W20240125 16:22:00.732637 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240125 16:22:01.425556 31272 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:22:01.576032 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=8591
W20240125 16:22:01.794024 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240125 16:22:02.430852 31272 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:22:02.576014 31271 parallel_pq_v2.h:76] insert failed, size(hashtable)=7761
W20240125 16:22:02.894743 30796 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.940 ms                  | 54.669 ms                 |
| Forward                   | 6.840 ms                  | 36.689 ms                 |
| Backward                  | 7.169 ms                  | 29.592 ms                 |
| Optimize                  | 3.378 ms                  | 14.429 ms                 |
| BarrierTimeBeforeRank0    | 4.980 ms                  | 72.809 ms                 |
| AfterBackward             | 40.452 ms                 | 88.351 ms                 |
| BlockToStepN              | 61.135 ms                 | 303.218 ms                |
| OneStep                   | 154.952 ms                | 452.758 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 17.426, sample: 0.500, forward: 0.708, backward: 0.968, update: 0.307
[proc 3] 500 steps, total: 17.426, sample: 0.560, forward: 0.831, backward: 1.084, update: 0.325
[proc 2] 500 steps, total: 17.432, sample: 0.506, forward: 0.818, backward: 0.941, update: 0.325
[proc 0] 500 steps, total: 17.439, sample: 0.713, forward: 0.955, backward: 0.994, update: 0.369
Successfully xmh. training takes 88.62261533737183 seconds
before call kg_cache_controller.StopThreads()
W20240125 16:22:03.289646 30796 grad_async_v2.h:71] call StopThreads. PID = 29532
W20240125 16:22:03.289690 30796 grad_base.h:210] before processOneStepNegThread_.join();
W20240125 16:22:03.292997 30796 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 16:22:03.293081 30796 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240125 16:22:03.296388 30796 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f06062dd450>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.897 ms                  | 27.932 ms                 |
| ProcessBack:UpdateCache   | 2.429 ms                  | 21.299 ms                 |
| ProcessBack:UpsertPq      | 19.539 ms                 | 58.659 ms                 |
| ProcessOneStep            | 40.335 ms                 | 88.244 ms                 |
| BlockToStepN              | 60.905 ms                 | 302.364 ms                |
+---------------------------+---------------------------+---------------------------+
