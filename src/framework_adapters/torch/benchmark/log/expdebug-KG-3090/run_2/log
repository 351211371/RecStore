WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 16:14:03.342226  4956 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_102', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [4956 sampler.py:454] Start PreSampling
WARNING [4956 sampler.py:532] Before construct renumbering_dict
WARNING [4956 sampler.py:555] PreSampling done
W20240125 16:14:12.801194  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 16:14:12.802094  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 16:14:12.802433  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 16:14:12.802744  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 16:14:12.803051  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 16:14:12.803364  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 16:14:12.803663  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 16:14:12.803977  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 16:14:12.804286  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 16:14:12.804587  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 16:14:12.804937  4956 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 16:14:12.805310  4956 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 16:14:12.805706  4956 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 16:14:12.806282  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 16:14:12.806710  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 16:14:12.807107  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 16:14:12.807497  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 16:14:12.807911  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 16:14:12.808315  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 16:14:12.808723  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 16:14:12.809149  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 16:14:12.809568  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 16:14:12.809980  4956 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 16:14:12.810392  4956 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 16:14:12.810788  4956 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 16:14:12.811193  4956 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 16:14:13.280704  4956 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100000f72000 22.81 MB
W20240125 16:14:13.281005  4956 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100002644000 58.4 kB
{0: Graph(num_nodes=13500, num_edges=273181,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12803, num_edges=385691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 13500 N 273181 E
MertisPartition: part 1 has 12803 N 385691 E
Rank0: cached key size 373
Rank1: cached key size 373
Before renumbering graph:  {'_ID': tensor([    0,     2,     6,  ..., 11079,  2237, 14365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([  746,   782,   841,  ..., 10106, 13487,  6020]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=13500, num_edges=273181,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=13500, num_edges=273181,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 10.122 seconds
INFO [5987 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [4956 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [4956 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [5987 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
W20240125 16:14:15.583796  5988 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240125 16:14:15.584224  5999 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240125 16:14:15.614285  5988 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x100002658000 781.2 kB
W20240125 16:14:15.614372  5999 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x10000271d000 781.2 kB
W20240125 16:14:15.614529  5999 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x1000027e2000 781.2 kB
W20240125 16:14:15.614531  5988 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x1000028a7000 781.2 kB
W20240125 16:14:15.614610  5988 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10000296c000 152.6 MB
W20240125 16:14:15.614636  5999 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10000c204000 152.6 MB
W20240125 16:14:15.614689  5999 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x100015a9c000 152.6 MB
W20240125 16:14:15.614691  5988 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10001f334000 152.6 MB
W20240125 16:14:15.614745  5988 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:14:15.614748  5999 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:14:15.615995  5999 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:14:15.615989  5988 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
cudaHostRegister 0x100000f72000
1: KnownLocalCachedEmbedding init done
WARNING [5987 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank1] pid = 5987
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494)]
cudaHostRegister 0x100000f72000
0: KnownLocalCachedEmbedding init done
WARNING [4956 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 16:14:15.839797  5988 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240125 16:14:15.839908  5999 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
W20240125 16:14:15.840989  5988 grad_base.h:55] KGCacheController, config={
        "num_gpus": 2,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 16:14:15.841189  5988 grad_base.h:172] Init GradProcessingBase done
I20240125 16:14:15.846891  5988 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 16:14:15.847112  5988 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 16:14:15.847127  5988 kg_controller.h:84] Construct KGCacheController done
I20240125 16:14:16.174432  5988 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 16:14:16.547616  6324 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:14:16.548066  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 16:14:16.766875  5988 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240125 16:14:16.787542  5999 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
E20240125 16:14:20.837107  5988 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.883 ms                  | 1.883 ms                  |
| Forward                   | 1.687 s                   | 1.687 s                   |
| Backward                  | 812.105 ms                | 812.105 ms                |
| Optimize                  | 4.999 ms                  | 4.999 ms                  |
| BarrierTimeBeforeRank0    | 178.446 us                | 178.446 us                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:20.929843  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 16:14:21.004662  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.297 ms                  | 233.090 ms                |
| ProcessBack:UpdateCache   | 14.543 ms                 | 1.291 s                   |
| ProcessBack:UpsertPq      | 22.214 ms                 | 111.215 ms                |
| ProcessOneStep            | 26.155 ms                 | 1.633 s                   |
| BlockToStepN              | 16.022 ms                 | 64.786 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:21.841995  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8669
W20240125 16:14:21.945695  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240125 16:14:22.076336  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:14:22.845331  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=9477
W20240125 16:14:22.955763  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240125 16:14:23.088860  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:14:23.687749  6184 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
E20240125 16:14:23.845016  6184 parallel_pq_v2.h:76] insert failed, size(hashtable)=361
W20240125 16:14:24.002153  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240125 16:14:24.132887  6324 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:14:24.845165  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=14054
W20240125 16:14:25.007680  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=40, pq.top=39
W20240125 16:14:25.187278  6324 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:14:25.846508  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8047
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.542 ms                  | 62.291 ms                 |
| Forward                   | 9.219 ms                  | 1.687 s                   |
| Backward                  | 8.641 ms                  | 812.105 ms                |
| Optimize                  | 3.389 ms                  | 24.533 ms                 |
| BarrierTimeBeforeRank0    | 77.530 us                 | 4.795 ms                  |
| AfterBackward             | 25.034 ms                 | 1.634 s                   |
| BlockToStepN              | 19.127 ms                 | 105.737 ms                |
| OneStep                   | 94.881 ms                 | 4.225 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:26.049057  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=52, pq.top=52
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.153 ms                  | 233.013 ms                |
| ProcessBack:UpdateCache   | 825.938 us                | 1.270 s                   |
| ProcessBack:UpsertPq      | 9.943 ms                  | 78.587 ms                 |
| ProcessOneStep            | 24.214 ms                 | 71.932 ms                 |
| BlockToStepN              | 18.909 ms                 | 64.786 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:26.220858  6324 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:14:26.846030  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=5550
W20240125 16:14:27.116642  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=62
W20240125 16:14:27.236681  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:14:27.854472  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7857
W20240125 16:14:28.183176  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240125 16:14:28.238116  6324 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:14:28.856868  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=5312
W20240125 16:14:29.220086  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240125 16:14:29.261961  6324 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:14:29.856914  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7108
W20240125 16:14:30.230265  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240125 16:14:30.276849  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 13.960, sample: 0.498, forward: 2.266, backward: 1.555, update: 0.325
train_sampler.Prefill()
-------Step 0-------
tensor([  857,  6842,  4071,  5327,   249,  5293,  7853,    32, 11046, 14835]) tensor([  865,  2692, 14171,  2654,  6980,  4373, 12598,  4204, 12204,  8630])
-------Step 1-------
tensor([  857,  6842,  4071,  5327,   249,  5293,  7853,    32, 11046, 14835]) tensor([ 7305,  9894, 12291, 12984, 14032,  3380, 11883,  1119, 12681,  3011])
-------Step 2-------
tensor([11209,   131, 11399, 12373,  1506,  5636,  8714, 14479, 13799,  2767]) tensor([ 9875,  3583,  3106, 11286,  7492, 13801,   382, 12347, 14862,  2315])
-------Step 3-------
tensor([11209,   131, 11399, 12373,  1506,  5636,  8714, 14479, 13799,  2767]) tensor([ 5405,  6838,  7910,  8320, 10611,  4874,  9797,  4834, 11840,  9645])
-------Step 4-------
tensor([    7,  2431,   837, 12294, 12691,   348,    52, 11482,    48,   325]) tensor([14778,  4330,  2975, 11020,  1331,  7655, 10360,  4231,  3942,  1842])
-------Step 5-------
tensor([    7,  2431,   837, 12294, 12691,   348,    52, 11482,    48,   325]) tensor([13879,  1251,  1806,  6616, 12646, 10493,  5267,  2523, 10472,  1361])
-------Step 6-------
tensor([13506, 14438,  6318,  6734,  8341,   222,  2089,  9659,  2926, 10941]) tensor([ 4504,  3770,   906, 13003,  7792, 10292,  9115,  9636, 13386,  2436])
-------Step 7-------
tensor([13506, 14438,  6318,  6734,  8341,   222,  2089,  9659,  2926, 10941]) tensor([ 3889,   282, 11966,  2784,  1907,  9569,  5374, 13236, 10394, 12349])
-------Step 8-------
tensor([10812,  1440,  6918,  9079, 13435,  6131, 12563, 11673,   333,  2517]) tensor([ 2250, 12028,  9013, 11620,  2521,  4813,  8697, 14195, 14537,  1452])
-------Step 9-------
tensor([10812,  1440,  6918,  9079, 13435,  6131, 12563, 11673,   333,  2517]) tensor([13291, 14152,  5377, 10563,  8513,  1054, 11883, 11183, 12520, 10205])
before start barrier
start train
[proc 0] 100 steps, total: 13.972, sample: 0.746, forward: 2.964, backward: 1.822, update: 0.444
E20240125 16:14:30.856724  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8615
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.372 ms                  | 59.583 ms                 |
| Forward                   | 8.077 ms                  | 67.470 ms                 |
| Backward                  | 8.078 ms                  | 30.998 ms                 |
| Optimize                  | 3.362 ms                  | 22.980 ms                 |
| BarrierTimeBeforeRank0    | 73.418 us                 | 25.387 ms                 |
| AfterBackward             | 24.756 ms                 | 72.052 ms                 |
| BlockToStepN              | 23.979 ms                 | 91.354 ms                 |
| OneStep                   | 94.881 ms                 | 233.840 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.148 ms                  | 23.163 ms                 |
| ProcessBack:UpdateCache   | 809.709 us                | 18.460 ms                 |
| ProcessBack:UpsertPq      | 10.377 ms                 | 69.357 ms                 |
| ProcessOneStep            | 24.214 ms                 | 71.932 ms                 |
| BlockToStepN              | 22.792 ms                 | 91.084 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:31.248764  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240125 16:14:31.294358  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:14:31.860844  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8487
W20240125 16:14:32.296371  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240125 16:14:32.352450  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:32.860097  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240125 16:14:33.353232  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:14:33.372340  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
E20240125 16:14:33.861297  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=12748
W20240125 16:14:34.382373  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:14:34.422879  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=136
E20240125 16:14:34.861061  6503 parallel_pq_v2.h:76] insert failed, size(hashtable)=154
W20240125 16:14:35.445271  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:14:35.486343  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.188 ms                  | 59.583 ms                 |
| Forward                   | 7.851 ms                  | 67.470 ms                 |
| Backward                  | 7.882 ms                  | 30.998 ms                 |
| Optimize                  | 3.309 ms                  | 22.980 ms                 |
| BarrierTimeBeforeRank0    | 72.310 us                 | 27.542 ms                 |
| AfterBackward             | 23.469 ms                 | 73.757 ms                 |
| BlockToStepN              | 25.993 ms                 | 91.354 ms                 |
| OneStep                   | 94.993 ms                 | 233.840 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:35.863445  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8058
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.129 ms                  | 23.163 ms                 |
| ProcessBack:UpdateCache   | 739.664 us                | 15.885 ms                 |
| ProcessBack:UpsertPq      | 9.285 ms                  | 69.357 ms                 |
| ProcessOneStep            | 23.068 ms                 | 71.932 ms                 |
| BlockToStepN              | 25.758 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:36.483711  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:14:36.553809  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240125 16:14:36.863027  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7893
W20240125 16:14:37.491712  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:14:37.622581  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
E20240125 16:14:37.863010  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8541
W20240125 16:14:38.543475  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:14:38.622509  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
E20240125 16:14:38.863021  5988 parallel_pq_v2.h:76] insert failed, size(hashtable)=656
W20240125 16:14:39.570195  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:14:39.633283  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
E20240125 16:14:39.863148  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240125 16:14:40.630738  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:14:40.697482  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.181 ms                  | 53.854 ms                 |
| Forward                   | 7.675 ms                  | 50.522 ms                 |
| Backward                  | 7.437 ms                  | 30.998 ms                 |
| Optimize                  | 3.276 ms                  | 22.225 ms                 |
| BarrierTimeBeforeRank0    | 75.575 us                 | 27.542 ms                 |
| AfterBackward             | 23.741 ms                 | 72.052 ms                 |
| BlockToStepN              | 28.251 ms                 | 90.398 ms                 |
| OneStep                   | 96.888 ms                 | 221.072 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:40.868861  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=9558
[proc 1] 200 steps, total: 10.289, sample: 0.557, forward: 0.816, backward: 0.966, update: 0.338
[proc 0] 200 steps, total: 10.290, sample: 0.756, forward: 0.926, backward: 0.951, update: 0.323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.115 ms                  | 23.149 ms                 |
| ProcessBack:UpdateCache   | 726.562 us                | 15.694 ms                 |
| ProcessBack:UpsertPq      | 9.109 ms                  | 61.413 ms                 |
| ProcessOneStep            | 23.404 ms                 | 71.932 ms                 |
| BlockToStepN              | 27.802 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:41.649004  6324 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:14:41.743440  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240125 16:14:41.868021  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=9083
W20240125 16:14:42.713114  6324 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:14:42.802405  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240125 16:14:42.870170  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=4057
W20240125 16:14:43.743659  6324 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:14:43.804461  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=230
E20240125 16:14:43.875277  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=12309
W20240125 16:14:44.800850  6324 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:14:44.841778  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=240, pq.top=239
E20240125 16:14:44.876861  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=6899
W20240125 16:14:45.820436  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:14:45.857218  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.181 ms                  | 55.212 ms                 |
| Forward                   | 7.446 ms                  | 50.522 ms                 |
| Backward                  | 7.437 ms                  | 30.998 ms                 |
| Optimize                  | 3.261 ms                  | 22.225 ms                 |
| BarrierTimeBeforeRank0    | 73.418 us                 | 28.719 ms                 |
| AfterBackward             | 22.788 ms                 | 73.757 ms                 |
| BlockToStepN              | 28.407 ms                 | 90.398 ms                 |
| OneStep                   | 97.651 ms                 | 221.072 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:45.884833  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7040
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.111 ms                  | 22.117 ms                 |
| ProcessBack:UpdateCache   | 718.206 us                | 15.694 ms                 |
| ProcessBack:UpsertPq      | 9.020 ms                  | 61.413 ms                 |
| ProcessOneStep            | 23.068 ms                 | 71.932 ms                 |
| BlockToStepN              | 27.935 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:46.857339  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=258, pq.top=258
E20240125 16:14:46.884850  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=9742
W20240125 16:14:46.890655  6324 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:14:47.884132  6503 parallel_pq_v2.h:76] insert failed, size(hashtable)=1303
W20240125 16:14:47.903601  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240125 16:14:47.946722  6324 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:14:48.884032  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8375
W20240125 16:14:48.903601  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240125 16:14:49.047436  6324 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:14:49.884971  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8664
W20240125 16:14:49.944360  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240125 16:14:50.080333  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.181 ms                  | 53.854 ms                 |
| Forward                   | 7.289 ms                  | 48.339 ms                 |
| Backward                  | 7.566 ms                  | 30.998 ms                 |
| Optimize                  | 3.255 ms                  | 22.222 ms                 |
| BarrierTimeBeforeRank0    | 72.385 us                 | 28.719 ms                 |
| AfterBackward             | 23.466 ms                 | 72.052 ms                 |
| BlockToStepN              | 28.709 ms                 | 88.484 ms                 |
| OneStep                   | 98.359 ms                 | 209.302 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:50.888866  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7359
W20240125 16:14:50.999810  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240125 16:14:51.105141  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.117 ms                  | 22.117 ms                 |
| ProcessBack:UpdateCache   | 713.112 us                | 15.504 ms                 |
| ProcessBack:UpsertPq      | 9.285 ms                  | 59.179 ms                 |
| ProcessOneStep            | 23.404 ms                 | 71.932 ms                 |
| BlockToStepN              | 28.445 ms                 | 88.280 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 10.344, sample: 0.510, forward: 0.782, backward: 1.060, update: 0.298
[proc 0] 300 steps, total: 10.348, sample: 0.760, forward: 0.870, backward: 0.934, update: 0.320
E20240125 16:14:51.896836  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=6987
W20240125 16:14:52.000435  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240125 16:14:52.172008  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:14:52.899292  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=12608
W20240125 16:14:53.002918  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240125 16:14:53.186565  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:53.899015  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8062
W20240125 16:14:54.002140  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240125 16:14:54.267211  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:54.908849  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=11393
W20240125 16:14:55.002044  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240125 16:14:55.326512  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.188 ms                  | 53.854 ms                 |
| Forward                   | 7.229 ms                  | 50.522 ms                 |
| Backward                  | 7.682 ms                  | 34.307 ms                 |
| Optimize                  | 3.261 ms                  | 22.222 ms                 |
| BarrierTimeBeforeRank0    | 71.928 us                 | 28.719 ms                 |
| AfterBackward             | 23.881 ms                 | 74.523 ms                 |
| BlockToStepN              | 29.569 ms                 | 90.398 ms                 |
| OneStep                   | 101.151 ms                | 209.302 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:14:55.908022  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=9131
W20240125 16:14:56.049978  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=342, pq.top=342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.120 ms                  | 19.820 ms                 |
| ProcessBack:UpdateCache   | 712.334 us                | 15.694 ms                 |
| ProcessBack:UpsertPq      | 9.475 ms                  | 59.179 ms                 |
| ProcessOneStep            | 23.802 ms                 | 74.457 ms                 |
| BlockToStepN              | 29.363 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:14:56.356616  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:14:56.908025  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=12067
W20240125 16:14:57.100911  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240125 16:14:57.358127  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:57.908028  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=3900
W20240125 16:14:58.164642  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240125 16:14:58.380383  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:58.908015  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8184
W20240125 16:14:59.231508  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240125 16:14:59.442982  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:14:59.908169  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
W20240125 16:15:00.363185  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240125 16:15:00.506664  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.194 ms                  | 53.136 ms                 |
| Forward                   | 7.269 ms                  | 48.339 ms                 |
| Backward                  | 7.518 ms                  | 30.998 ms                 |
| Optimize                  | 3.260 ms                  | 22.222 ms                 |
| BarrierTimeBeforeRank0    | 72.055 us                 | 28.315 ms                 |
| AfterBackward             | 23.800 ms                 | 73.757 ms                 |
| BlockToStepN              | 29.875 ms                 | 88.484 ms                 |
| OneStep                   | 101.151 ms                | 199.992 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:15:00.911518  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=10198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.116 ms                  | 19.561 ms                 |
| ProcessBack:UpdateCache   | 713.811 us                | 16.683 ms                 |
| ProcessBack:UpsertPq      | 9.898 ms                  | 58.308 ms                 |
| ProcessOneStep            | 23.712 ms                 | 73.672 ms                 |
| BlockToStepN              | 29.591 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:15:01.387702  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240125 16:15:01.506034  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:15:01.911258  6184 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
[proc 1] 400 steps, total: 10.720, sample: 0.530, forward: 0.832, backward: 0.905, update: 0.338
[proc 0] 400 steps, total: 10.724, sample: 0.673, forward: 0.983, backward: 0.959, update: 0.392
W20240125 16:15:02.392304  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240125 16:15:02.527890  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:15:02.924867  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=8041
W20240125 16:15:03.395030  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240125 16:15:03.539356  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:15:03.928208  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:15:04.450178  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240125 16:15:04.592427  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:15:04.930941  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=14091
W20240125 16:15:05.528702  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=428, pq.top=428
W20240125 16:15:05.677075  6324 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.210 ms                  | 53.136 ms                 |
| Forward                   | 7.274 ms                  | 48.339 ms                 |
| Backward                  | 7.440 ms                  | 30.998 ms                 |
| Optimize                  | 3.244 ms                  | 22.225 ms                 |
| BarrierTimeBeforeRank0    | 72.310 us                 | 30.108 ms                 |
| AfterBackward             | 24.241 ms                 | 73.757 ms                 |
| BlockToStepN              | 30.420 ms                 | 90.398 ms                 |
| OneStep                   | 102.621 ms                | 209.302 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:15:05.931663  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=13457
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.115 ms                  | 19.223 ms                 |
| ProcessBack:UpdateCache   | 712.220 us                | 16.683 ms                 |
| ProcessBack:UpsertPq      | 10.125 ms                 | 57.279 ms                 |
| ProcessOneStep            | 24.088 ms                 | 73.672 ms                 |
| BlockToStepN              | 30.186 ms                 | 90.171 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:15:06.557974  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240125 16:15:06.748728  6324 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:15:06.931706  5988 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:15:07.682932  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240125 16:15:07.820416  6324 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:15:07.931106  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=2793
W20240125 16:15:08.694805  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240125 16:15:08.859827  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:15:08.931036  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=5456
W20240125 16:15:09.870548  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240125 16:15:09.922304  6324 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:15:09.932721  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.210 ms                  | 55.212 ms                 |
| Forward                   | 7.277 ms                  | 44.291 ms                 |
| Backward                  | 7.265 ms                  | 30.418 ms                 |
| Optimize                  | 3.237 ms                  | 22.222 ms                 |
| BarrierTimeBeforeRank0    | 73.245 us                 | 35.596 ms                 |
| AfterBackward             | 24.273 ms                 | 72.052 ms                 |
| BlockToStepN              | 31.645 ms                 | 91.354 ms                 |
| OneStep                   | 103.453 ms                | 209.302 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:15:10.873560  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240125 16:15:10.930783  6324 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:15:10.932078  6502 parallel_pq_v2.h:76] insert failed, size(hashtable)=1031
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.111 ms                  | 19.561 ms                 |
| ProcessBack:UpdateCache   | 710.825 us                | 18.460 ms                 |
| ProcessBack:UpsertPq      | 10.468 ms                 | 57.279 ms                 |
| ProcessOneStep            | 24.164 ms                 | 71.932 ms                 |
| BlockToStepN              | 31.131 ms                 | 91.084 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:15:11.919389  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240125 16:15:11.932858  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7343
W20240125 16:15:12.000870  6324 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:15:12.928658  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=486, pq.top=486
E20240125 16:15:12.935302  6323 parallel_pq_v2.h:76] insert failed, size(hashtable)=7688
W20240125 16:15:13.004065  6324 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:15:13.935029  6324 parallel_pq_v2.h:76] insert failed, size(hashtable)=111
W20240125 16:15:13.962527  5988 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240125 16:15:14.007103  6324 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
[proc 1] 500 steps, total: 12.561, sample: 0.582, forward: 0.880, backward: 1.056, update: 0.333
[proc 0] 500 steps, total: 12.555, sample: 0.831, forward: 0.964, backward: 0.940, update: 0.349
Successfully xmh. training takes 57.889678716659546 seconds
before call kg_cache_controller.StopThreads()
W20240125 16:15:14.656682  5988 grad_async_v2.h:71] call StopThreads. PID = 4956
W20240125 16:15:14.656723  5988 grad_base.h:210] before processOneStepNegThread_.join();
W20240125 16:15:14.665724  5988 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 16:15:14.665830  5988 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240125 16:15:14.721503  5988 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f4bb8edac50>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.111 ms                  | 19.820 ms                 |
| ProcessBack:UpdateCache   | 712.156 us                | 18.460 ms                 |
| ProcessBack:UpsertPq      | 10.294 ms                 | 56.809 ms                 |
| ProcessOneStep            | 24.018 ms                 | 71.932 ms                 |
| BlockToStepN              | 32.445 ms                 | 91.880 ms                 |
+---------------------------+---------------------------+---------------------------+
