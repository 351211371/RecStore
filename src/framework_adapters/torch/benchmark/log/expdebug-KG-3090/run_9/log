WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240125 16:31:33.593892 18614 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_109', no_save_emb=True, max_step=500, batch_size=400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [18614 sampler.py:454] Start PreSampling
WARNING [18614 sampler.py:532] Before construct renumbering_dict
WARNING [18614 sampler.py:555] PreSampling done
W20240125 16:31:50.708132 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240125 16:31:50.709055 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240125 16:31:50.709548 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240125 16:31:50.709978 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240125 16:31:50.710398 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240125 16:31:50.710820 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240125 16:31:50.711251 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240125 16:31:50.711688 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240125 16:31:50.712087 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240125 16:31:50.712498 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240125 16:31:50.712926 18614 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240125 16:31:50.713343 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240125 16:31:50.713739 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240125 16:31:50.714346 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240125 16:31:50.714766 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240125 16:31:50.715185 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240125 16:31:50.715596 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240125 16:31:50.716042 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240125 16:31:50.716456 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240125 16:31:50.716895 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240125 16:31:50.717314 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240125 16:31:50.717737 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240125 16:31:50.718138 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240125 16:31:50.718552 18614 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240125 16:31:50.718945 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240125 16:31:50.719358 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240125 16:31:50.719892 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240125 16:31:50.720314 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240125 16:31:50.720707 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240125 16:31:50.721120 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240125 16:31:50.721536 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240125 16:31:50.721956 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240125 16:31:50.722391 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240125 16:31:50.722788 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240125 16:31:50.723212 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240125 16:31:50.723263 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240125 16:31:50.723299 18614 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240125 16:31:50.723330 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240125 16:31:50.723356 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240125 16:31:50.723515 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240125 16:31:50.723558 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240125 16:31:50.723603 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240125 16:31:50.723645 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240125 16:31:50.723678 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240125 16:31:50.723713 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240125 16:31:50.723744 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240125 16:31:50.723778 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240125 16:31:50.723814 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240125 16:31:50.723842 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240125 16:31:50.723873 18614 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240125 16:31:50.723898 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240125 16:31:50.723920 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240125 16:31:50.723999 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240125 16:31:50.724066 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240125 16:31:50.724105 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240125 16:31:50.724135 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240125 16:31:50.724174 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240125 16:31:50.724211 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240125 16:31:50.724242 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240125 16:31:50.724272 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240125 16:31:50.724300 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240125 16:31:50.724328 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240125 16:31:50.724355 18614 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240125 16:31:50.724380 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240125 16:31:50.724411 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240125 16:31:50.724478 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240125 16:31:50.724516 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240125 16:31:50.724555 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240125 16:31:50.724584 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240125 16:31:50.724617 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240125 16:31:50.724665 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240125 16:31:50.724727 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240125 16:31:50.724772 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240125 16:31:50.724813 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240125 16:31:50.724864 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240125 16:31:50.724895 18614 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240125 16:31:50.724920 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240125 16:31:50.724943 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240125 16:31:50.725014 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240125 16:31:50.725055 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240125 16:31:50.725085 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240125 16:31:50.725114 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240125 16:31:50.725144 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240125 16:31:50.725175 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240125 16:31:50.725211 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240125 16:31:50.725251 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240125 16:31:50.725286 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240125 16:31:50.725317 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240125 16:31:50.725346 18614 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240125 16:31:50.725389 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240125 16:31:50.725421 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240125 16:31:50.725500 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240125 16:31:50.725541 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240125 16:31:50.725579 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240125 16:31:50.725615 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240125 16:31:50.725644 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240125 16:31:50.725682 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240125 16:31:50.725733 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240125 16:31:50.725764 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240125 16:31:50.725803 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240125 16:31:50.725844 18614 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240125 16:31:50.725875 18614 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240125 16:31:50.725900 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240125 16:31:50.725925 18614 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240125 16:31:51.167970 18614 IPCTensor.h:365] NewIPCTensor: full_emb [14951, 400]0x100003dc2000 22.81 MB
W20240125 16:31:51.168251 18614 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  838,  1225,  1782,  ...,  7191, 14026,  6140]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 17.742 seconds
[Rank1] pid = 19869
[Rank2] pid = 19933
[Rank3] pid = 19934
[Rank4] pid = 19999
[Rank5] pid = 20126
[Rank6] pid = 20195
INFO [18614 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [19869 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [19933 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [19934 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [19999 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [20126 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [19933 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19869 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20259 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [20195 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [19999 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20126 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20259 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19934 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [20195 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 16:31:54.487535 20062 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240125 16:31:54.487536 19998 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240125 16:31:54.487533 20127 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240125 16:31:54.487534 20196 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240125 16:31:54.487536 20323 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240125 16:31:54.487533 19870 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240125 16:31:54.487533 19935 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
INFO [18614 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240125 16:31:54.496093 20260 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240125 16:31:54.518589 20323 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x100005701000 781.2 kB
W20240125 16:31:54.518570 20127 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x100005577000 781.2 kB
W20240125 16:31:54.518570 19998 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1000054b2000 781.2 kB
W20240125 16:31:54.518600 20062 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x10000588b000 781.2 kB
W20240125 16:31:54.518574 20196 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x10000563c000 781.2 kB
W20240125 16:31:54.518595 19870 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1000057c6000 781.2 kB
W20240125 16:31:54.518615 19935 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x100005950000 781.2 kB
W20240125 16:31:54.518818 20323 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x100005a15000 781.2 kB
W20240125 16:31:54.518836 20127 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x100005ada000 781.2 kB
W20240125 16:31:54.518851 19998 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x100005b9f000 781.2 kB
W20240125 16:31:54.518857 19935 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x100005c64000 781.2 kB
W20240125 16:31:54.518862 20196 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x100005d29000 781.2 kB
W20240125 16:31:54.518867 20062 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x100005dee000 781.2 kB
W20240125 16:31:54.518893 19870 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x100005eb3000 781.2 kB
W20240125 16:31:54.518934 20323 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x100005f78000 152.6 MB
W20240125 16:31:54.518954 20127 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10000f810000 152.6 MB
W20240125 16:31:54.518960 19998 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x1000190a8000 152.6 MB
W20240125 16:31:54.518985 20196 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x100022940000 152.6 MB
W20240125 16:31:54.518990 19870 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10002c1d8000 152.6 MB
W20240125 16:31:54.518996 20062 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x100035a70000 152.6 MB
W20240125 16:31:54.519019 19935 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x10003f308000 152.6 MB
W20240125 16:31:54.519026 20323 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x100048ba0000 152.6 MB
W20240125 16:31:54.519054 19998 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100052438000 152.6 MB
W20240125 16:31:54.519059 20196 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10005bcd0000 152.6 MB
W20240125 16:31:54.519084 19870 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10006ee00000 152.6 MB
W20240125 16:31:54.519080 20127 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x100065568000 152.6 MB
W20240125 16:31:54.519090 20062 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x100078698000 152.6 MB
W20240125 16:31:54.519132 20323 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 16:31:54.519136 20196 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 16:31:54.519140 19935 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x100081f30000 152.6 MB
W20240125 16:31:54.519150 19870 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:31:54.519150 19998 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:31:54.519177 20062 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 16:31:54.519186 20127 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:31:54.519199 19935 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:31:54.523114 20062 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240125 16:31:54.523113 19998 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240125 16:31:54.523113 20196 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240125 16:31:54.523113 19870 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240125 16:31:54.523113 19935 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240125 16:31:54.523113 20323 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240125 16:31:54.523137 20127 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240125 16:31:54.527694 20260 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10008b7e6000 781.2 kB
W20240125 16:31:54.527869 20260 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10008b8ab000 781.2 kB
W20240125 16:31:54.527927 20260 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10008b970000 152.6 MB
W20240125 16:31:54.527988 20260 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100095208000 152.6 MB
W20240125 16:31:54.528038 20260 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240125 16:31:54.528913 20260 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
[Rank7] pid = 20259
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [18614 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [19933 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [20259 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [20195 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [19999 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [19934 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [20126 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [19869 DistTensor.py:56] The tensor name already exists in the kvstore
I20240125 16:31:54.805859 20062 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.805915 20196 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.805953 19870 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.805984 20260 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.806020 19998 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.806068 20127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.806100 19935 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240125 16:31:54.806133 20323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240125 16:31:54.807087 20260 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240125 16:31:54.807375 20260 grad_base.h:172] Init GradProcessingBase done
I20240125 16:31:54.813215 20260 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240125 16:31:54.813459 20260 kg_controller.h:78] after init GradAsyncProcessingV2
I20240125 16:31:54.813473 20260 kg_controller.h:84] Construct KGCacheController done
I20240125 16:31:55.857455 20260 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240125 16:31:57.542299 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:31:57.543077 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240125 16:31:57.574774 20196 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240125 16:31:57.594732 19998 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.595425 19935 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.607887 20062 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.617156 20323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.642439 19870 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.663069 20127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240125 16:31:57.687923 20260 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.460 ms                 | 17.460 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.460 ms                 | 17.460 ms                 |
| Forward                   | 2.896 s                   | 2.896 s                   |
| Backward                  | 706.919 ms                | 706.919 ms                |
| Optimize                  | 3.004 ms                  | 3.004 ms                  |
| BarrierTimeBeforeRank0    | 130.444 us                | 130.444 us                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:05.857482 22148 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.156 s                   | 1.474 s                   |
| ProcessBack:UpdateCache   | 3.032 s                   | 3.032 s                   |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:06.076294 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240125 16:32:06.136672 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:32:06.782049 22156 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
E20240125 16:32:06.864955 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:32:07.146823 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240125 16:32:07.192853 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:32:07.864022 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=509
W20240125 16:32:08.157815 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240125 16:32:08.224284 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:32:08.865072 22160 parallel_pq_v2.h:76] insert failed, size(hashtable)=398
W20240125 16:32:09.157027 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240125 16:32:09.224576 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.157 ms                  | 41.666 ms                 |
| Forward                   | 9.420 ms                  | 2.896 s                   |
| Backward                  | 6.755 ms                  | 706.919 ms                |
| Optimize                  | 1.801 ms                  | 35.254 ms                 |
| BarrierTimeBeforeRank0    | 3.634 ms                  | 52.977 ms                 |
| AfterBackward             | 70.832 ms                 | 4.763 s                   |
| BlockToStepN              | 12.505 ms                 | 57.484 ms                 |
| OneStep                   | 152.455 ms                | 8.440 s                   |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:09.870556 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:32:10.182358 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240125 16:32:10.227840 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.566 ms                  | 1.156 s                   |
| ProcessBack:UpdateCache   | 16.404 ms                 | 3.032 s                   |
| ProcessBack:UpsertPq      | 23.096 ms                 | 191.342 ms                |
| ProcessOneStep            | 72.613 ms                 | 4.761 s                   |
| BlockToStepN              | 11.624 ms                 | 57.297 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:10.872089 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=6123
W20240125 16:32:11.231563 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:32:11.458583 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=36
E20240125 16:32:11.871229 22146 parallel_pq_v2.h:76] insert failed, size(hashtable)=905
W20240125 16:32:12.262863 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:32:12.529438 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
E20240125 16:32:12.871014 22146 parallel_pq_v2.h:76] insert failed, size(hashtable)=342
W20240125 16:32:13.371942 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:32:13.660420 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240125 16:32:13.872884 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8347
W20240125 16:32:14.372069 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:32:14.660123 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.921 ms                  | 29.564 ms                 |
| Forward                   | 6.080 ms                  | 51.185 ms                 |
| Backward                  | 5.953 ms                  | 26.269 ms                 |
| Optimize                  | 1.638 ms                  | 15.385 ms                 |
| BarrierTimeBeforeRank0    | 9.190 ms                  | 52.977 ms                 |
| AfterBackward             | 73.831 ms                 | 145.882 ms                |
| BlockToStepN              | 12.214 ms                 | 55.189 ms                 |
| OneStep                   | 154.704 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:14.873924 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=1961
W20240125 16:32:15.419339 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:32:15.693506 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.273 ms                  | 1.156 s                   |
| ProcessBack:UpdateCache   | 19.490 ms                 | 3.032 s                   |
| ProcessBack:UpsertPq      | 22.365 ms                 | 191.342 ms                |
| ProcessOneStep            | 73.722 ms                 | 145.535 ms                |
| BlockToStepN              | 12.022 ms                 | 54.892 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:15.873019 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=1009
W20240125 16:32:16.422354 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:32:16.789465 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240125 16:32:16.881034 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7434
W20240125 16:32:17.523950 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:32:17.881242 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=49
W20240125 16:32:17.915146 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=76
W20240125 16:32:18.580845 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:32:18.881016 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=11290
W20240125 16:32:18.946303 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240125 16:32:19.665102 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.813 ms                  | 35.676 ms                 |
| Forward                   | 5.516 ms                  | 51.185 ms                 |
| Backward                  | 5.576 ms                  | 26.269 ms                 |
| Optimize                  | 1.621 ms                  | 15.385 ms                 |
| BarrierTimeBeforeRank0    | 12.806 ms                 | 52.977 ms                 |
| AfterBackward             | 73.408 ms                 | 145.882 ms                |
| BlockToStepN              | 14.389 ms                 | 57.484 ms                 |
| OneStep                   | 154.704 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:19.881191 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=283
W20240125 16:32:19.946218 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240125 16:32:20.685950 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.140 ms                  | 78.187 ms                 |
| ProcessBack:UpdateCache   | 19.285 ms                 | 87.202 ms                 |
| ProcessBack:UpsertPq      | 22.793 ms                 | 91.538 ms                 |
| ProcessOneStep            | 73.300 ms                 | 145.535 ms                |
| BlockToStepN              | 14.101 ms                 | 57.297 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:20.881022 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7562
W20240125 16:32:21.051719 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=96, pq.top=96
W20240125 16:32:21.685756 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 24.186, sample: 0.470, forward: 2.648, backward: 1.459, update: 0.148
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 24.198, sample: 0.385, forward: 3.182, backward: 1.533, update: 0.159
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 24.139, sample: 0.396, forward: 3.094, backward: 1.518, update: 0.163
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.227, sample: 0.336, forward: 3.622, backward: 1.241, update: 0.149
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.161, sample: 0.344, forward: 2.256, backward: 1.339, update: 0.200
train_sampler.Prefill()
-------Step 0-------
tensor([   40,    78, 13130,  1705, 10948,  9312,  1053,   447, 11208,  8715]) tensor([ 1782, 12547,  5036, 14378, 14438,   957,   605, 13321, 13383, 12647])
-------Step 1-------
tensor([   40,    78, 13130,  1705, 10948,  9312,  1053,   447, 11208,  8715]) tensor([ 4963,  8379,  1841,  7114,  7925, 12323,  8480,  1839,  5899,  2748])
-------Step 2-------
tensor([14284,  2037, 12155,  4698,  9656,  9203,  6709, 10685,    44, 13849]) tensor([ 8753,  1994,  8680,  8448, 14254,  5671, 11621,  1384,  4189,  5017])
-------Step 3-------
tensor([14284,  2037, 12155,  4698,  9656,  9203,  6709, 10685,    44, 13849]) tensor([ 8271,  6091, 11170,  4602,  7211,  7428, 13230,  3747, 11854,  8784])
-------Step 4-------
tensor([ 2952, 10340,  2104, 14521,  6961,    18,   802,    51,  7447, 12414]) tensor([6915, 2920, 2768, 8226, 3308, 5546, 9206,  409, 8370, 3489])
-------Step 5-------
tensor([ 2952, 10340,  2104, 14521,  6961,    18,   802,    51,  7447, 12414]) tensor([ 3260,  6330,   512, 11988,  9202,   455, 14383, 10615,  5181,   407])
-------Step 6-------
tensor([ 6348,  8271,  4637,  6594,  7721,  9216, 14213,    56,  8079,   867]) tensor([ 3808, 13389,  3285,  7097,  2593, 13858,  9779,  9916,  9735, 11723])
-------Step 7-------
tensor([ 6348,  8271,  4637,  6594,  7721,  9216, 14213,    56,  8079,   867]) tensor([ 7099, 12089, 11519, 13365, 14105,  8646,  7826,  1830, 10414,  6579])
-------Step 8-------
tensor([13723, 11056,  5409,    51,  4249, 13468, 10681,    18,  4597,    57]) tensor([ 8271,  8573,  4520,  1076,  5810, 12839,  1334,  1254, 14104,  1250])
-------Step 9-------
tensor([13723, 11056,  5409,    51,  4249, 13468, 10681,    18,  4597,    57]) tensor([ 5247, 11195,  2227,  6546,  2340, 14827,  7535,  1272,  8510, 13127])
before start barrier
start train
[proc 0] 100 steps, total: 24.114, sample: 0.545, forward: 3.892, backward: 1.428, update: 0.213
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 24.214, sample: 0.495, forward: 2.951, backward: 1.326, update: 0.156
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.219, sample: 0.365, forward: 2.884, backward: 1.406, update: 0.155
E20240125 16:32:21.881016 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8211
W20240125 16:32:22.067782 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=102, pq.top=102
W20240125 16:32:22.736763 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:32:22.881045 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240125 16:32:23.149482 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=108, pq.top=108
W20240125 16:32:23.818473 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:32:23.881453 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10545
W20240125 16:32:24.149356 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.742 ms                  | 35.676 ms                 |
| Forward                   | 5.497 ms                  | 51.185 ms                 |
| Backward                  | 5.215 ms                  | 26.269 ms                 |
| Optimize                  | 1.594 ms                  | 15.385 ms                 |
| BarrierTimeBeforeRank0    | 13.784 ms                 | 63.205 ms                 |
| AfterBackward             | 73.634 ms                 | 145.882 ms                |
| BlockToStepN              | 16.112 ms                 | 74.343 ms                 |
| OneStep                   | 155.839 ms                | 260.719 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:24.869499 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:32:24.881014 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7940
W20240125 16:32:25.267066 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.184 ms                  | 78.187 ms                 |
| ProcessBack:UpdateCache   | 20.043 ms                 | 87.202 ms                 |
| ProcessBack:UpsertPq      | 22.374 ms                 | 91.538 ms                 |
| ProcessOneStep            | 73.722 ms                 | 145.535 ms                |
| BlockToStepN              | 15.676 ms                 | 74.123 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:25.885234 22145 parallel_pq_v2.h:76] insert failed, size(hashtable)=618
W20240125 16:32:25.945274 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:32:26.285554 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=126, pq.top=126
E20240125 16:32:26.884013 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=1713
W20240125 16:32:27.041080 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240125 16:32:27.464011 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
E20240125 16:32:27.884013 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=4154
W20240125 16:32:28.152499 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:32:28.615826 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
E20240125 16:32:28.885279 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=4801
W20240125 16:32:29.162480 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.746 ms                  | 41.666 ms                 |
| Forward                   | 5.482 ms                  | 51.185 ms                 |
| Backward                  | 5.125 ms                  | 26.269 ms                 |
| Optimize                  | 1.588 ms                  | 15.385 ms                 |
| BarrierTimeBeforeRank0    | 15.461 ms                 | 91.238 ms                 |
| AfterBackward             | 74.527 ms                 | 145.882 ms                |
| BlockToStepN              | 19.914 ms                 | 74.343 ms                 |
| OneStep                   | 158.603 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:29.884089 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=147
E20240125 16:32:29.894511 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=5114
W20240125 16:32:30.165444 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.271 ms                  | 53.075 ms                 |
| ProcessBack:UpdateCache   | 19.506 ms                 | 73.718 ms                 |
| ProcessBack:UpsertPq      | 23.364 ms                 | 85.066 ms                 |
| ProcessOneStep            | 74.717 ms                 | 134.281 ms                |
| BlockToStepN              | 19.879 ms                 | 67.849 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:30.894184 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=5608
W20240125 16:32:31.019593 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240125 16:32:31.196352 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:32:31.894121 22152 parallel_pq_v2.h:76] insert failed, size(hashtable)=48
W20240125 16:32:32.096906 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240125 16:32:32.199360 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:32:32.897336 22159 parallel_pq_v2.h:76] insert failed, size(hashtable)=402
W20240125 16:32:33.134613 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240125 16:32:33.200929 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:32:33.897171 22157 parallel_pq_v2.h:76] insert failed, size(hashtable)=608
W20240125 16:32:34.286417 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:32:34.419739 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.732 ms                  | 35.676 ms                 |
| Forward                   | 5.485 ms                  | 50.514 ms                 |
| Backward                  | 5.081 ms                  | 22.766 ms                 |
| Optimize                  | 1.595 ms                  | 14.836 ms                 |
| BarrierTimeBeforeRank0    | 17.818 ms                 | 91.238 ms                 |
| AfterBackward             | 75.079 ms                 | 145.882 ms                |
| BlockToStepN              | 21.186 ms                 | 68.027 ms                 |
| OneStep                   | 159.632 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:34.897019 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9695
W20240125 16:32:35.336124 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:32:35.455243 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.140 ms                  | 52.714 ms                 |
| ProcessBack:UpdateCache   | 19.970 ms                 | 68.421 ms                 |
| ProcessBack:UpsertPq      | 23.597 ms                 | 91.538 ms                 |
| ProcessOneStep            | 75.118 ms                 | 145.535 ms                |
| BlockToStepN              | 21.079 ms                 | 74.123 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:35.900168 22147 parallel_pq_v2.h:76] insert failed, size(hashtable)=99
W20240125 16:32:36.367632 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:32:36.501345 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=183
E20240125 16:32:36.899173 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8621
W20240125 16:32:37.381599 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:32:37.574702 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=191, pq.top=191
E20240125 16:32:37.899026 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7347
W20240125 16:32:38.436405 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240125 16:32:38.586535 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240125 16:32:38.899017 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9159
[proc 1] 200 steps, total: 17.363, sample: 0.370, forward: 0.709, backward: 0.837, update: 0.153
[proc 2] 200 steps, total: 17.351, sample: 0.357, forward: 0.697, backward: 0.831, update: 0.178
[proc 5] 200 steps, total: 17.363, sample: 0.454, forward: 0.723, backward: 0.864, update: 0.154
[proc 4] 200 steps, total: 17.373, sample: 0.405, forward: 0.752, backward: 0.940, update: 0.138
[proc 7] 200 steps, total: 17.364, sample: 0.459, forward: 0.775, backward: 0.839, update: 0.163
[proc 3] 200 steps, total: 17.359, sample: 0.444, forward: 0.760, backward: 0.946, update: 0.157
[proc 6] 200 steps, total: 17.370, sample: 0.422, forward: 0.761, backward: 0.922, update: 0.195
[proc 0] 200 steps, total: 17.369, sample: 0.486, forward: 0.861, backward: 0.679, update: 0.149
W20240125 16:32:39.504959 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:32:39.664666 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.732 ms                  | 35.676 ms                 |
| Forward                   | 5.470 ms                  | 50.514 ms                 |
| Backward                  | 5.129 ms                  | 22.766 ms                 |
| Optimize                  | 1.605 ms                  | 14.836 ms                 |
| BarrierTimeBeforeRank0    | 19.447 ms                 | 91.238 ms                 |
| AfterBackward             | 74.901 ms                 | 145.882 ms                |
| BlockToStepN              | 21.739 ms                 | 74.343 ms                 |
| OneStep                   | 160.836 ms                | 277.917 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:39.899012 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=62
W20240125 16:32:40.567396 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:32:40.805347 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=209, pq.top=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.184 ms                  | 53.075 ms                 |
| ProcessBack:UpdateCache   | 19.901 ms                 | 73.718 ms                 |
| ProcessBack:UpsertPq      | 23.096 ms                 | 91.538 ms                 |
| ProcessOneStep            | 75.012 ms                 | 145.535 ms                |
| BlockToStepN              | 22.536 ms                 | 74.123 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:40.904867 22147 parallel_pq_v2.h:76] insert failed, size(hashtable)=460
W20240125 16:32:41.569499 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240125 16:32:41.888936 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=216, pq.top=216
E20240125 16:32:41.916929 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=1773
W20240125 16:32:42.649775 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:32:42.920889 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240125 16:32:43.046775 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240125 16:32:43.714205 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:32:43.924844 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=11366
W20240125 16:32:44.046679 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 35.676 ms                 |
| Forward                   | 5.436 ms                  | 50.514 ms                 |
| Backward                  | 5.081 ms                  | 22.766 ms                 |
| Optimize                  | 1.594 ms                  | 14.836 ms                 |
| BarrierTimeBeforeRank0    | 19.447 ms                 | 91.238 ms                 |
| AfterBackward             | 75.079 ms                 | 145.882 ms                |
| BlockToStepN              | 23.042 ms                 | 74.343 ms                 |
| OneStep                   | 161.862 ms                | 277.917 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:44.891561 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:32:44.924186 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=73
W20240125 16:32:45.183604 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=234, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.271 ms                  | 52.714 ms                 |
| ProcessBack:UpdateCache   | 19.566 ms                 | 68.421 ms                 |
| ProcessBack:UpsertPq      | 22.849 ms                 | 90.500 ms                 |
| ProcessOneStep            | 75.012 ms                 | 145.535 ms                |
| BlockToStepN              | 22.992 ms                 | 74.123 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:45.905469 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:32:45.932106 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10421
W20240125 16:32:46.189150 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=240, pq.top=240
E20240125 16:32:46.932020 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9670
W20240125 16:32:46.964507 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:32:47.275658 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240125 16:32:47.936841 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7186
W20240125 16:32:48.066579 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:32:48.346591 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=253
E20240125 16:32:48.936076 22152 parallel_pq_v2.h:76] insert failed, size(hashtable)=2264
W20240125 16:32:49.070573 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:32:49.435377 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.702 ms                  | 34.761 ms                 |
| Forward                   | 5.408 ms                  | 49.605 ms                 |
| Backward                  | 4.982 ms                  | 22.766 ms                 |
| Optimize                  | 1.594 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 18.976 ms                 | 88.544 ms                 |
| AfterBackward             | 74.846 ms                 | 137.274 ms                |
| BlockToStepN              | 24.425 ms                 | 69.502 ms                 |
| OneStep                   | 161.862 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:49.936851 22147 parallel_pq_v2.h:76] insert failed, size(hashtable)=286
W20240125 16:32:50.070686 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:32:50.602470 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=266, pq.top=266
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.140 ms                  | 52.714 ms                 |
| ProcessBack:UpdateCache   | 19.566 ms                 | 68.421 ms                 |
| ProcessBack:UpsertPq      | 23.028 ms                 | 90.500 ms                 |
| ProcessOneStep            | 74.717 ms                 | 137.158 ms                |
| BlockToStepN              | 24.812 ms                 | 69.256 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:50.937758 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=4853
W20240125 16:32:51.160360 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:32:51.610697 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=272
E20240125 16:32:51.937018 22148 parallel_pq_v2.h:76] insert failed, size(hashtable)=406
W20240125 16:32:52.183413 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:32:52.739919 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
E20240125 16:32:52.944851 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10056
W20240125 16:32:53.184317 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:32:53.739629 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240125 16:32:53.945305 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10164
W20240125 16:32:54.254820 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240125 16:32:54.813212 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.688 ms                  | 34.761 ms                 |
| Forward                   | 5.359 ms                  | 49.605 ms                 |
| Backward                  | 4.973 ms                  | 22.766 ms                 |
| Optimize                  | 1.594 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 19.447 ms                 | 88.544 ms                 |
| AfterBackward             | 74.782 ms                 | 137.274 ms                |
| BlockToStepN              | 26.046 ms                 | 69.810 ms                 |
| OneStep                   | 161.944 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:54.946882 22148 parallel_pq_v2.h:76] insert failed, size(hashtable)=333
W20240125 16:32:55.373955 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:32:55.828208 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=298, pq.top=298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.184 ms                  | 50.883 ms                 |
| ProcessBack:UpdateCache   | 19.613 ms                 | 56.162 ms                 |
| ProcessBack:UpsertPq      | 22.849 ms                 | 86.393 ms                 |
| ProcessOneStep            | 74.717 ms                 | 137.158 ms                |
| BlockToStepN              | 25.645 ms                 | 69.618 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:32:55.952139 22160 parallel_pq_v2.h:76] insert failed, size(hashtable)=544
[proc 4] 300 steps, total: 17.049, sample: 0.458, forward: 0.745, backward: 0.809, update: 0.153
[proc 0] 300 steps, total: 17.042, sample: 0.354, forward: 0.720, backward: 0.681, update: 0.140
[proc 6] 300 steps, total: 17.043, sample: 0.350, forward: 0.647, backward: 0.924, update: 0.155
[proc 5] 300 steps, total: 17.049, sample: 0.355, forward: 0.716, backward: 0.792, update: 0.143
[proc 3] 300 steps, total: 17.048, sample: 0.429, forward: 0.652, backward: 0.823, update: 0.163
[proc 2] 300 steps, total: 17.056, sample: 0.380, forward: 0.607, backward: 0.793, update: 0.157
[proc 7] 300 steps, total: 17.062, sample: 0.368, forward: 0.615, backward: 0.963, update: 0.173
[proc 1] 300 steps, total: 17.066, sample: 0.289, forward: 0.558, backward: 0.724, update: 0.156
W20240125 16:32:56.396853 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:32:56.860463 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=304, pq.top=304
E20240125 16:32:56.952036 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=13775
W20240125 16:32:57.501044 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:32:57.896335 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
E20240125 16:32:57.954573 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=6377
W20240125 16:32:58.628840 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240125 16:32:58.912390 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240125 16:32:58.954015 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=5089
W20240125 16:32:59.737780 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.685 ms                  | 34.761 ms                 |
| Forward                   | 5.359 ms                  | 49.605 ms                 |
| Backward                  | 5.008 ms                  | 25.821 ms                 |
| Optimize                  | 1.594 ms                  | 14.836 ms                 |
| BarrierTimeBeforeRank0    | 19.539 ms                 | 91.238 ms                 |
| AfterBackward             | 75.240 ms                 | 137.274 ms                |
| BlockToStepN              | 26.916 ms                 | 73.668 ms                 |
| OneStep                   | 163.199 ms                | 268.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:32:59.912982 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=318
E20240125 16:32:59.954023 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.184 ms                  | 52.636 ms                 |
| ProcessBack:UpdateCache   | 19.963 ms                 | 56.162 ms                 |
| ProcessBack:UpsertPq      | 23.664 ms                 | 86.393 ms                 |
| ProcessOneStep            | 75.903 ms                 | 137.158 ms                |
| BlockToStepN              | 26.889 ms                 | 73.426 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:00.878363 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:33:00.954020 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=12882
W20240125 16:33:01.198737 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240125 16:33:01.902099 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:33:01.954041 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=5719
W20240125 16:33:02.383423 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240125 16:33:02.953318 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:33:02.954279 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240125 16:33:03.410455 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=338, pq.top=338
E20240125 16:33:03.956861 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=12445
W20240125 16:33:04.094323 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:33:04.426514 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 34.761 ms                 |
| Forward                   | 5.300 ms                  | 49.605 ms                 |
| Backward                  | 4.982 ms                  | 25.821 ms                 |
| Optimize                  | 1.588 ms                  | 14.836 ms                 |
| BarrierTimeBeforeRank0    | 20.321 ms                 | 91.238 ms                 |
| AfterBackward             | 76.635 ms                 | 137.274 ms                |
| BlockToStepN              | 27.839 ms                 | 73.668 ms                 |
| OneStep                   | 165.162 ms                | 268.053 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:04.984959 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8780
W20240125 16:33:05.217907 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:33:05.544092 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.011 ms                  | 50.883 ms                 |
| ProcessBack:UpdateCache   | 20.104 ms                 | 56.162 ms                 |
| ProcessBack:UpsertPq      | 24.032 ms                 | 86.092 ms                 |
| ProcessOneStep            | 76.257 ms                 | 134.281 ms                |
| BlockToStepN              | 27.655 ms                 | 73.426 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:05.985848 22159 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240125 16:33:06.314293 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240125 16:33:06.598657 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=354
E20240125 16:33:06.988847 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8076
W20240125 16:33:07.427421 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240125 16:33:07.599221 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=360, pq.top=360
E20240125 16:33:07.988018 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9882
W20240125 16:33:08.538275 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240125 16:33:08.684664 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
E20240125 16:33:08.988013 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=13266
W20240125 16:33:09.553205 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.674 ms                  | 34.401 ms                 |
| Forward                   | 5.269 ms                  | 44.939 ms                 |
| Backward                  | 4.947 ms                  | 23.497 ms                 |
| Optimize                  | 1.587 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 20.599 ms                 | 88.544 ms                 |
| AfterBackward             | 75.269 ms                 | 134.465 ms                |
| BlockToStepN              | 29.442 ms                 | 74.343 ms                 |
| OneStep                   | 165.895 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:09.885032 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240125 16:33:09.988472 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=12699
W20240125 16:33:10.655270 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.928 ms                  | 47.078 ms                 |
| ProcessBack:UpdateCache   | 20.297 ms                 | 55.322 ms                 |
| ProcessBack:UpsertPq      | 23.664 ms                 | 86.092 ms                 |
| ProcessOneStep            | 75.186 ms                 | 134.281 ms                |
| BlockToStepN              | 29.225 ms                 | 73.426 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:10.990725 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10327
W20240125 16:33:11.147058 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240125 16:33:11.790274 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240125 16:33:11.990015 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8351
W20240125 16:33:12.319129 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240125 16:33:12.801091 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:33:13.001646 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=5796
W20240125 16:33:13.393620 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240125 16:33:13.822916 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:33:14.004848 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=6163
W20240125 16:33:14.399884 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.675 ms                  | 34.401 ms                 |
| Forward                   | 5.293 ms                  | 44.939 ms                 |
| Backward                  | 4.947 ms                  | 25.821 ms                 |
| Optimize                  | 1.591 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 20.599 ms                 | 88.544 ms                 |
| AfterBackward             | 75.532 ms                 | 142.204 ms                |
| BlockToStepN              | 30.354 ms                 | 80.751 ms                 |
| OneStep                   | 168.275 ms                | 268.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:14.824491 21054 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240125 16:33:15.007123 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8934
[proc 0] 400 steps, total: 18.801, sample: 0.323, forward: 0.694, backward: 0.780, update: 0.153
[proc 7] 400 steps, total: 18.793, sample: 0.417, forward: 0.616, backward: 0.947, update: 0.172
[proc 1] 400 steps, total: 18.793, sample: 0.359, forward: 0.610, backward: 0.746, update: 0.150
[proc 2] 400 steps, total: 18.804, sample: 0.432, forward: 0.701, backward: 0.964, update: 0.168
[proc 4] 400 steps, total: 18.810, sample: 0.370, forward: 0.729, backward: 0.873, update: 0.167
[proc 6] 400 steps, total: 18.817, sample: 0.416, forward: 0.706, backward: 0.990, update: 0.203
[proc 3] 400 steps, total: 18.821, sample: 0.424, forward: 0.844, backward: 1.075, update: 0.163
[proc 5] 400 steps, total: 18.822, sample: 0.396, forward: 0.653, backward: 0.823, update: 0.144
W20240125 16:33:15.515832 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.011 ms                  | 47.078 ms                 |
| ProcessBack:UpdateCache   | 20.126 ms                 | 56.162 ms                 |
| ProcessBack:UpsertPq      | 23.623 ms                 | 86.393 ms                 |
| ProcessOneStep            | 75.186 ms                 | 142.093 ms                |
| BlockToStepN              | 30.148 ms                 | 74.123 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:15.930284 21054 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240125 16:33:16.008841 22157 parallel_pq_v2.h:76] insert failed, size(hashtable)=1342
W20240125 16:33:16.801966 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=410, pq.top=410
E20240125 16:33:17.016858 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10292
W20240125 16:33:17.020641 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240125 16:33:17.853683 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=416, pq.top=416
E20240125 16:33:18.016844 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7286
W20240125 16:33:18.057667 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240125 16:33:18.889371 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=422, pq.top=422
E20240125 16:33:19.016849 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=11794
W20240125 16:33:19.204377 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.680 ms                  | 34.761 ms                 |
| Forward                   | 5.294 ms                  | 44.939 ms                 |
| Backward                  | 4.948 ms                  | 26.269 ms                 |
| Optimize                  | 1.594 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 20.812 ms                 | 88.544 ms                 |
| AfterBackward             | 75.532 ms                 | 142.204 ms                |
| BlockToStepN              | 31.107 ms                 | 82.194 ms                 |
| OneStep                   | 168.777 ms                | 268.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:20.000056 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
E20240125 16:33:20.016016 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=3573
W20240125 16:33:20.216112 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.922 ms                  | 45.711 ms                 |
| ProcessBack:UpdateCache   | 19.970 ms                 | 55.322 ms                 |
| ProcessBack:UpsertPq      | 23.623 ms                 | 86.092 ms                 |
| ProcessOneStep            | 75.186 ms                 | 142.093 ms                |
| BlockToStepN              | 30.913 ms                 | 80.559 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240125 16:33:21.003003 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240125 16:33:21.020851 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7239
W20240125 16:33:21.221927 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:33:22.021057 22144 parallel_pq_v2.h:76] insert failed, size(hashtable)=1602
W20240125 16:33:22.073715 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240125 16:33:22.352092 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240125 16:33:23.023929 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8762
W20240125 16:33:23.148293 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240125 16:33:23.447161 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240125 16:33:24.023083 21054 parallel_pq_v2.h:76] insert failed, size(hashtable)=140
W20240125 16:33:24.192145 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240125 16:33:24.454532 21054 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 34.401 ms                 |
| Forward                   | 5.287 ms                  | 43.613 ms                 |
| Backward                  | 4.948 ms                  | 25.821 ms                 |
| Optimize                  | 1.595 ms                  | 6.998 ms                  |
| BarrierTimeBeforeRank0    | 20.617 ms                 | 79.391 ms                 |
| AfterBackward             | 74.901 ms                 | 137.274 ms                |
| BlockToStepN              | 32.138 ms                 | 82.194 ms                 |
| OneStep                   | 168.777 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:25.031241 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=11488
W20240125 16:33:25.305948 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240125 16:33:25.560510 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.827 ms                  | 45.711 ms                 |
| ProcessBack:UpdateCache   | 19.798 ms                 | 55.322 ms                 |
| ProcessBack:UpsertPq      | 23.597 ms                 | 86.092 ms                 |
| ProcessOneStep            | 74.897 ms                 | 137.158 ms                |
| BlockToStepN              | 32.169 ms                 | 80.559 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:26.038755 22146 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240125 16:33:26.318001 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240125 16:33:26.565874 21054 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240125 16:33:27.039124 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10430
W20240125 16:33:27.322391 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240125 16:33:27.565457 21054 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240125 16:33:28.040829 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8459
W20240125 16:33:28.450489 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240125 16:33:28.686112 21054 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240125 16:33:29.040022 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9337
W20240125 16:33:29.583946 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240125 16:33:29.757994 21054 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.676 ms                  | 34.401 ms                 |
| Forward                   | 5.275 ms                  | 43.613 ms                 |
| Backward                  | 4.941 ms                  | 25.821 ms                 |
| Optimize                  | 1.595 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 20.751 ms                 | 79.391 ms                 |
| AfterBackward             | 74.846 ms                 | 137.274 ms                |
| BlockToStepN              | 33.238 ms                 | 85.968 ms                 |
| OneStep                   | 169.746 ms                | 261.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:30.044838 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=8339
W20240125 16:33:30.603977 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240125 16:33:30.838340 21054 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.815 ms                  | 43.808 ms                 |
| ProcessBack:UpdateCache   | 19.963 ms                 | 54.581 ms                 |
| ProcessBack:UpsertPq      | 23.364 ms                 | 86.092 ms                 |
| ProcessOneStep            | 74.897 ms                 | 137.158 ms                |
| BlockToStepN              | 33.074 ms                 | 85.761 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240125 16:33:31.048840 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=9039
W20240125 16:33:31.642794 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=490, pq.top=490
W20240125 16:33:31.864792 21054 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240125 16:33:32.056841 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=10799
W20240125 16:33:32.713306 20260 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=496, pq.top=496
W20240125 16:33:32.929217 21054 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240125 16:33:33.057461 21053 parallel_pq_v2.h:76] insert failed, size(hashtable)=7853
[proc 7] 500 steps, total: 18.471, sample: 0.337, forward: 0.655, backward: 0.845, update: 0.145
[proc 6] 500 steps, total: 18.461, sample: 0.388, forward: 0.631, backward: 0.883, update: 0.182
[proc 0] 500 steps, total: 18.476, sample: 0.351, forward: 0.733, backward: 0.642, update: 0.170
[proc 4] 500 steps, total: 18.467, sample: 0.372, forward: 0.629, backward: 0.775, update: 0.150
[proc 3] 500 steps, total: 18.457, sample: 0.368, forward: 0.656, backward: 0.922, update: 0.157
[proc 1] 500 steps, total: 18.468, sample: 0.362, forward: 0.615, backward: 0.741, update: 0.153
[proc 5] 500 steps, total: 18.456, sample: 0.340, forward: 0.668, backward: 0.780, update: 0.143
[proc 2] 500 steps, total: 18.468, sample: 0.336, forward: 0.740, backward: 0.777, update: 0.173
Successfully xmh. training takes 95.8057153224945 seconds
before call kg_cache_controller.StopThreads()
W20240125 16:33:33.493781 20260 grad_async_v2.h:71] call StopThreads. PID = 18614
W20240125 16:33:33.493820 20260 grad_base.h:210] before processOneStepNegThread_.join();
W20240125 16:33:33.494772 20260 grad_base.h:212] after processOneStepNegThread_.join();
W20240125 16:33:33.494818 20260 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240125 16:33:33.507278 20260 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fd14822d850>
