WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 16:49:30.012502  1372 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 16:49:30.023159  1372 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [1372 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f636d3d59e0>==========
Worker 1 pid=1526
Worker 2 pid=1528
INFO [1372 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1528 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1372 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1526 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1529 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1529 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1526 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 16:49:47.791860  1372 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:49:47.792552  1529 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:49:47.793188  1526 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [1528 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 16:49:47.799892  1528 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 16:50:05.930033  1528 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240131 16:50:05.931460  1529 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240131 16:50:05.931463  1526 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240131 16:50:05.933270  1372 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240131 16:50:06.245281  1526 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10010196e000 7.629 MB
W20240131 16:50:06.245447  1526 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100102111000 7.629 MB
W20240131 16:50:06.245505  1526 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001028b4000 122.1 MB
W20240131 16:50:06.245558  1526 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10010a2c8000 122.1 MB
W20240131 16:50:06.245597  1526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:50:06.245787  1528 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100111cde000 7.629 MB
W20240131 16:50:06.245935  1528 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100112481000 7.629 MB
W20240131 16:50:06.246011  1528 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100112c24000 122.1 MB
W20240131 16:50:06.246069  1528 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10011a63a000 122.1 MB
W20240131 16:50:06.246105  1526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:50:06.246122  1528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:50:06.246852  1528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:50:06.257838  1529 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100122056000 7.629 MB
W20240131 16:50:06.257984  1529 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001227f9000 7.629 MB
W20240131 16:50:06.258045  1529 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100122f9c000 122.1 MB
W20240131 16:50:06.258108  1529 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10012a9b0000 122.1 MB
W20240131 16:50:06.258147  1529 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:50:06.258491  1529 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:50:06.266427  1372 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1001323ca000 7.629 MB
W20240131 16:50:06.266577  1372 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100132b6d000 7.629 MB
W20240131 16:50:06.266652  1372 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100133310000 122.1 MB
W20240131 16:50:06.266700  1372 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10013ad24000 122.1 MB
W20240131 16:50:06.266736  1372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 16:50:06.267096  1372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
Worker 3 pid=1529
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240131 16:50:12.932688  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10014273c000 7.629 MB
W20240131 16:50:12.932933  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100142edf000 7.629 MB
W20240131 16:50:12.933038  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100143682000 7.629 MB
W20240131 16:50:12.933082  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100143e25000 7.629 MB
W20240131 16:50:12.933158  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1001445c8000 7.629 MB
W20240131 16:50:12.933205  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100144d6b000 7.629 MB
W20240131 16:50:12.933243  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014550e000 7.629 MB
W20240131 16:50:12.933295  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100145cb1000 7.629 MB
W20240131 16:50:12.933363  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100146454000 7.629 MB
W20240131 16:50:12.933403  1526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100146bf7000 7.629 MB
W20240131 16:50:12.933458  1526 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10014739a000 80 B 
W20240131 16:50:12.933495  1526 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10014739c000 8 B 
W20240131 16:50:12.933527  1526 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:50:12.933941  1526 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 16:50:13.097523  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1001473a0000 7.629 MB
W20240131 16:50:13.097644  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100147b43000 7.629 MB
W20240131 16:50:13.097693  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001482e6000 7.629 MB
W20240131 16:50:13.097733  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100148a89000 7.629 MB
W20240131 16:50:13.097779  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10014922c000 7.629 MB
W20240131 16:50:13.097816  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001499cf000 7.629 MB
W20240131 16:50:13.097857  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014a172000 7.629 MB
W20240131 16:50:13.097918  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10014a915000 7.629 MB
W20240131 16:50:13.097965  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10014b0b8000 7.629 MB
W20240131 16:50:13.098002  1528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10014b85b000 7.629 MB
W20240131 16:50:13.098037  1528 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10014bffe000 80 B 
W20240131 16:50:13.098069  1528 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10014c000000 8 B 
W20240131 16:50:13.098099  1528 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:50:13.098402  1528 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 16:50:13.487502  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10014c004000 7.629 MB
W20240131 16:50:13.487707  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10014c7a7000 7.629 MB
W20240131 16:50:13.487771  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10014cf4a000 7.629 MB
W20240131 16:50:13.487819  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10014d6ed000 7.629 MB
W20240131 16:50:13.487859  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10014de90000 7.629 MB
W20240131 16:50:13.487895  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10014e633000 7.629 MB
W20240131 16:50:13.487927  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10014edd6000 7.629 MB
W20240131 16:50:13.487993  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10014f579000 7.629 MB
W20240131 16:50:13.488044  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10014fd1c000 7.629 MB
W20240131 16:50:13.488087  1529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1001504bf000 7.629 MB
W20240131 16:50:13.488122  1529 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x100150c62000 80 B 
W20240131 16:50:13.488157  1529 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100150c64000 8 B 
W20240131 16:50:13.488184  1529 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:50:13.488570  1529 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 16:50:13.616384  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100150c68000 7.629 MB
W20240131 16:50:13.616581  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10015140b000 7.629 MB
W20240131 16:50:13.616623  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100151bae000 7.629 MB
W20240131 16:50:13.616670  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100152351000 7.629 MB
W20240131 16:50:13.616708  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100152af4000 7.629 MB
W20240131 16:50:13.616741  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100153297000 7.629 MB
W20240131 16:50:13.616796  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100153a3a000 7.629 MB
W20240131 16:50:13.616849  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1001541dd000 7.629 MB
W20240131 16:50:13.616891  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100154980000 7.629 MB
W20240131 16:50:13.616940  1372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100155123000 7.629 MB
W20240131 16:50:13.616983  1372 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1001558c6000 80 B 
W20240131 16:50:13.617018  1372 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1001558c8000 8 B 
W20240131 16:50:13.617056  1372 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:50:13.617413  1372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 16:50:13.618644  1372 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 16:50:13.618759  1372 grad_base.h:184] Init GradProcessingBase done
I20240131 16:50:17.695093  1372 grad_async_v2.h:42] Use main thread to update emb.
W20240131 16:50:17.695425  1372 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 16:50:17.695438  1372 kg_controller.h:84] Construct KGCacheController done
E20240131 16:50:18.136257  1372 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 16:50:18.136477  1528 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 16:50:18.138104  1529 recstore.cc:66] init folly done
E20240131 16:50:18.138132  1526 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 16:50:18.139856  1372 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 16:50:18.662771  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:50:18.663703  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:50:19.663023  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240131 16:50:19.799333  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 16:50:20.663007  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:50:20.969295  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 16:50:21.672194  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:50:22.149540  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 16:50:22.672029  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.318 us                | 287.947 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:50:23.336750  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 16:50:23.672025  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:24.383870  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:50:24.672201  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:25.412092  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 16:50:25.672035  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:50:26.566210  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 16:50:26.672232  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
Before Training
Before Training
I20240131 16:50:27.859234  1526 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240131 16:50:27.859287  1529 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 16:50:27.859884  1372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 16:50:27.864830  1528 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
W20240131 16:50:27.880061  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:50:27.880261  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 176.705 us                | 338.697 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 317.964 us                | 317.964 us                |
| GenInput                  | 46.542 ms                 | 46.542 ms                 |
| NN                        | 185.171 ms                | 185.171 ms                |
| Forward                   | 248.079 ms                | 248.079 ms                |
| Backward                  | 120.044 ms                | 120.044 ms                |
| Optimize                  | 3.729 ms                  | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 32.862 ms                 | 32.862 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 16:50:28.880582  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 16:50:29.880095  1948 parallel_pq_v2.h:79] insert failed, size(hashtable)=4760
W20240131 16:50:29.951633  1372 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240131 16:50:30.370810  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
INFO [1372 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1526 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1528 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1529 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
E20240131 16:50:30.884110  1948 parallel_pq_v2.h:79] insert failed, size(hashtable)=367
W20240131 16:50:31.373596  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 16:50:31.884084  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=5363
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
W20240131 16:50:32.694154  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 6 ========== 
E20240131 16:50:32.890441  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 194.419 us                | 31.879 ms                 |
| ProcessBack:Shuffle       | 158.747 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.845 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 53.414 us                 | 458.923 ms                |
| ProcessOneStep            | 160.228 ms                | 1.632 s                   |
| BlockToStepN              | 50.148 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 7 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 270.738 us                | 317.964 us                |
| GenInput                  | 85.608 ms                 | 96.348 ms                 |
| NN                        | 1.431 ms                  | 185.171 ms                |
| Forward                   | 2.027 ms                  | 248.079 ms                |
| Backward                  | 11.662 ms                 | 120.044 ms                |
| Optimize                  | 343.323 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 1.724 ms                  | 32.862 ms                 |
| AfterBackward             | 439.890 ms                | 1.633 s                   |
| BlockToStepN              | 152.619 us                | 369.089 ms                |
| OneStep                   | 539.262 ms                | 2.456 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 8 ========== 
E20240131 16:50:33.890245  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=367
========== Step 9 ========== 
W20240131 16:50:34.155489  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
========== Step 10 ========== 
E20240131 16:50:34.890009  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1084
========== Step 11 ========== 
W20240131 16:50:35.272401  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
E20240131 16:50:35.898325  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=125
========== Step 15 ========== 
W20240131 16:50:36.784369  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240131 16:50:36.898241  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3875
========== Step 16 ========== 
E20240131 16:50:37.251859  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=16, sample_step_cpp_seen_[rank]=15
E20240131 16:50:37.898051  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.483 us                | 265.161 us                |
| ProcessBack:Shuffle       | 239.853 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.380 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 56.996 us                 | 458.923 ms                |
| ProcessOneStep            | 212.107 ms                | 1.632 s                   |
| BlockToStepN              | 52.050 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:50:38.463769  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 263.117 us                | 380.755 us                |
| GenInput                  | 80.391 ms                 | 104.039 ms                |
| NN                        | 1.202 ms                  | 185.171 ms                |
| Forward                   | 1.818 ms                  | 248.079 ms                |
| Backward                  | 11.662 ms                 | 120.044 ms                |
| Optimize                  | 313.520 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 190.051 us                | 32.862 ms                 |
| AfterBackward             | 212.136 ms                | 1.633 s                   |
| BlockToStepN              | 156.920 us                | 369.089 ms                |
| OneStep                   | 312.066 ms                | 2.456 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:50:38.898005  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:50:39.678850  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240131 16:50:39.898072  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:40.690567  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 17 ========== 
E20240131 16:50:40.898183  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
E20240131 16:50:41.924153  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:42.107045  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 21 ========== 
========== Step 22 ========== 
E20240131 16:50:42.924494  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.015 us                | 810.903 us                |
| ProcessBack:Shuffle       | 239.853 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.375 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 54.193 us                 | 458.923 ms                |
| ProcessOneStep            | 254.845 ms                | 3.680 s                   |
| BlockToStepN              | 65.552 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 250.594 us                | 380.755 us                |
| GenInput                  | 80.391 ms                 | 104.763 ms                |
| NN                        | 1.103 ms                  | 185.171 ms                |
| Forward                   | 1.629 ms                  | 248.079 ms                |
| Backward                  | 10.079 ms                 | 120.044 ms                |
| Optimize                  | 297.785 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 190.051 us                | 32.862 ms                 |
| AfterBackward             | 276.299 ms                | 3.680 s                   |
| BlockToStepN              | 155.278 us                | 369.089 ms                |
| OneStep                   | 371.592 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:50:43.772780  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240131 16:50:43.924188  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
========== Step 24 ========== 
========== Step 25 ========== 
E20240131 16:50:44.930701  1950 parallel_pq_v2.h:79] insert failed, size(hashtable)=2579
W20240131 16:50:44.953619  1372 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
W20240131 16:50:45.164112  1372 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
E20240131 16:50:45.924029  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=737
W20240131 16:50:45.946779  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
E20240131 16:50:46.924355  1968 parallel_pq_v2.h:79] insert failed, size(hashtable)=333
========== Step 33 ========== 
W20240131 16:50:47.706234  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 16:50:47.819618  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=33, sample_step_cpp_seen_[rank]=32
========== Step 34 ========== 
E20240131 16:50:47.924080  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.922 us                | 27.946 ms                 |
| ProcessBack:Shuffle       | 253.397 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.355 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 56.996 us                 | 458.923 ms                |
| ProcessOneStep            | 276.097 ms                | 3.680 s                   |
| BlockToStepN              | 71.341 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 254.696 us                | 380.755 us                |
| GenInput                  | 81.522 ms                 | 104.763 ms                |
| NN                        | 1.137 ms                  | 185.171 ms                |
| Forward                   | 1.653 ms                  | 248.079 ms                |
| Backward                  | 4.881 ms                  | 120.044 ms                |
| Optimize                  | 295.162 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 601.574 us                | 32.862 ms                 |
| AfterBackward             | 276.299 ms                | 3.680 s                   |
| BlockToStepN              | 156.920 us                | 369.089 ms                |
| OneStep                   | 371.592 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:50:48.924031  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
E20240131 16:50:49.924036  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:50:50.096211  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240131 16:50:50.925074  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:51.702294  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 16:50:51.925698  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
E20240131 16:50:52.925093  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=173
W20240131 16:50:53.090242  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 144.031 us                | 31.701 ms                 |
| ProcessBack:Shuffle       | 253.397 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.352 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 56.996 us                 | 458.923 ms                |
| ProcessOneStep            | 276.097 ms                | 4.243 s                   |
| BlockToStepN              | 80.805 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.336 us                | 380.755 us                |
| GenInput                  | 81.416 ms                 | 104.763 ms                |
| NN                        | 1.075 ms                  | 185.171 ms                |
| Forward                   | 1.616 ms                  | 248.079 ms                |
| Backward                  | 4.274 ms                  | 120.044 ms                |
| Optimize                  | 280.619 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 524.475 us                | 32.862 ms                 |
| AfterBackward             | 217.150 ms                | 4.243 s                   |
| BlockToStepN              | 158.119 us                | 369.089 ms                |
| OneStep                   | 320.597 ms                | 4.352 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:50:53.925021  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=332
========== Step 43 ========== 
W20240131 16:50:54.223973  1372 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
========== Step 45 ========== 
E20240131 16:50:54.925009  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 46 ========== 
E20240131 16:50:55.441095  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=46, sample_step_cpp_seen_[rank]=45
W20240131 16:50:55.600265  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 47 ========== 
E20240131 16:50:55.925271  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:50:56.925215  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:50:57.145923  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240131 16:50:57.925031  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.772 us                | 276.332 us                |
| ProcessBack:Shuffle       | 239.853 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.348 ms                  | 454.066 ms                |
| ProcessBack:UpsertPq      | 56.996 us                 | 458.923 ms                |
| ProcessOneStep            | 254.845 ms                | 4.243 s                   |
| BlockToStepN              | 90.918 us                 | 356.273 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:50:58.189460  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 48 ========== 
========== Step 49 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 255.131 us                | 380.755 us                |
| GenInput                  | 81.416 ms                 | 104.763 ms                |
| NN                        | 1.124 ms                  | 185.171 ms                |
| Forward                   | 1.629 ms                  | 248.079 ms                |
| Backward                  | 4.180 ms                  | 120.044 ms                |
| Optimize                  | 284.433 us                | 3.729 ms                  |
| BarrierTimeBeforeRank0    | 601.574 us                | 32.862 ms                 |
| AfterBackward             | 254.868 ms                | 4.243 s                   |
| BlockToStepN              | 164.205 us                | 369.089 ms                |
| OneStep                   | 344.383 ms                | 4.352 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 50 ========== 
E20240131 16:50:58.925170  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=711
========== Step 51 ========== 
W20240131 16:50:59.257187  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
========== Step 52 ========== 
E20240131 16:50:59.925143  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 53 ========== 
W20240131 16:51:00.163924  1372 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
========== Step 55 ========== 
E20240131 16:51:00.925225  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 16:51:01.048791  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
========== Step 56 ========== 
E20240131 16:51:01.925400  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
========== Step 57 ========== 
W20240131 16:51:02.425601  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 16:51:02.925063  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 152.744 us                | 15.673 ms                 |
| ProcessBack:Shuffle       | 239.853 ms                | 884.468 ms                |
| ProcessBack:UpdateCache   | 1.348 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 55.249 us                 | 492.963 us                |
| ProcessOneStep            | 254.845 ms                | 3.680 s                   |
| BlockToStepN              | 98.513 us                 | 365.527 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 254.696 us                | 328.875 us                |
| GenInput                  | 80.680 ms                 | 104.039 ms                |
| NN                        | 1.137 ms                  | 15.298 ms                 |
| Forward                   | 1.678 ms                  | 17.409 ms                 |
| Backward                  | 4.274 ms                  | 18.733 ms                 |
| Optimize                  | 287.771 us                | 685.692 us                |
| BarrierTimeBeforeRank0    | 962.664 us                | 10.436 ms                 |
| AfterBackward             | 254.868 ms                | 3.680 s                   |
| BlockToStepN              | 177.171 us                | 936.749 us                |
| OneStep                   | 344.383 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:03.826087  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
========== Step 58 ========== 
E20240131 16:51:03.936301  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
E20240131 16:51:04.936125  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=794
W20240131 16:51:05.126446  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
E20240131 16:51:05.948459  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=256
========== Step 66 ========== 
W20240131 16:51:06.913179  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:51:06.948196  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=338
E20240131 16:51:06.962859  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=66, sample_step_cpp_seen_[rank]=65
========== Step 67 ========== 
========== Step 68 ========== 
E20240131 16:51:07.948256  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.035 us                | 354.653 us                |
| ProcessBack:Shuffle       | 214.352 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.352 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 55.707 us                 | 492.963 us                |
| ProcessOneStep            | 217.122 ms                | 3.680 s                   |
| BlockToStepN              | 110.002 us                | 1.264 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 255.131 us                | 341.488 us                |
| GenInput                  | 81.390 ms                 | 104.039 ms                |
| NN                        | 1.143 ms                  | 15.298 ms                 |
| Forward                   | 1.720 ms                  | 17.409 ms                 |
| Backward                  | 4.260 ms                  | 18.733 ms                 |
| Optimize                  | 291.586 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.150 ms                  | 10.436 ms                 |
| AfterBackward             | 217.150 ms                | 3.680 s                   |
| BlockToStepN              | 181.698 us                | 1.362 ms                  |
| OneStep                   | 320.597 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:08.767562  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 69 ========== 
E20240131 16:51:08.948176  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:51:09.948216  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=195
W20240131 16:51:10.242905  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
========== Step 70 ========== 
E20240131 16:51:10.948139  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=329
========== Step 71 ========== 
========== Step 72 ========== 
W20240131 16:51:11.762679  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240131 16:51:11.948213  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=55
========== Step 73 ========== 
========== Step 74 ========== 
E20240131 16:51:12.948370  1949 parallel_pq_v2.h:79] insert failed, size(hashtable)=486
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 164.438 us                | 31.836 ms                 |
| ProcessBack:Shuffle       | 239.853 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.355 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 55.904 us                 | 492.963 us                |
| ProcessOneStep            | 254.845 ms                | 3.680 s                   |
| BlockToStepN              | 120.680 us                | 5.086 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.336 us                | 368.803 us                |
| GenInput                  | 81.416 ms                 | 104.039 ms                |
| NN                        | 1.168 ms                  | 15.298 ms                 |
| Forward                   | 1.725 ms                  | 17.409 ms                 |
| Backward                  | 4.274 ms                  | 18.733 ms                 |
| Optimize                  | 295.162 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.150 ms                  | 10.436 ms                 |
| AfterBackward             | 254.868 ms                | 3.680 s                   |
| BlockToStepN              | 190.088 us                | 5.185 ms                  |
| OneStep                   | 344.383 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:13.948232  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=221
W20240131 16:51:13.969375  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
E20240131 16:51:14.948129  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=502
========== Step 80 ========== 
========== Step 81 ========== 
W20240131 16:51:15.568876  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 16:51:15.720176  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=81, sample_step_cpp_seen_[rank]=80
========== Step 82 ========== 
E20240131 16:51:15.948030  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
========== Step 83 ========== 
E20240131 16:51:16.948585  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=152
========== Step 84 ========== 
W20240131 16:51:17.765450  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240131 16:51:17.948225  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 136.854 us                | 27.803 ms                 |
| ProcessBack:Shuffle       | 247.072 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.348 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 56.793 us                 | 492.963 us                |
| ProcessOneStep            | 271.806 ms                | 3.680 s                   |
| BlockToStepN              | 123.761 us                | 5.086 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 85 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.515 us                | 380.755 us                |
| GenInput                  | 80.826 ms                 | 104.039 ms                |
| NN                        | 1.198 ms                  | 15.298 ms                 |
| Forward                   | 1.740 ms                  | 17.409 ms                 |
| Backward                  | 4.426 ms                  | 18.733 ms                 |
| Optimize                  | 291.586 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.150 ms                  | 10.436 ms                 |
| AfterBackward             | 276.299 ms                | 3.680 s                   |
| BlockToStepN              | 200.270 us                | 5.185 ms                  |
| OneStep                   | 378.164 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:18.948055  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=238
W20240131 16:51:19.190132  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240131 16:51:19.948495  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:20.521618  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 86 ========== 
E20240131 16:51:20.948786  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=750
========== Step 87 ========== 
W20240131 16:51:21.656885  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 88 ========== 
E20240131 16:51:21.948009  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=98
========== Step 89 ========== 
W20240131 16:51:22.881966  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 16:51:22.948154  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=571
========== Step 90 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 143.736 us                | 28.159 ms                 |
| ProcessBack:Shuffle       | 274.357 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.372 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 56.793 us                 | 492.963 us                |
| ProcessOneStep            | 320.890 ms                | 3.680 s                   |
| BlockToStepN              | 131.883 us                | 5.086 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 91 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.523 us                | 380.755 us                |
| GenInput                  | 80.826 ms                 | 104.039 ms                |
| NN                        | 1.202 ms                  | 15.298 ms                 |
| Forward                   | 1.762 ms                  | 17.409 ms                 |
| Backward                  | 4.436 ms                  | 18.733 ms                 |
| Optimize                  | 294.685 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 341.840 ms                | 3.680 s                   |
| BlockToStepN              | 208.656 us                | 5.185 ms                  |
| OneStep                   | 426.974 ms                | 3.776 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 92 ========== 
W20240131 16:51:23.884785  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240131 16:51:23.956096  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=54
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
E20240131 16:51:24.956797  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=58
========== Step 96 ========== 
========== Step 97 ========== 
W20240131 16:51:25.741751  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 16:51:25.956178  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=362
========== Step 98 ========== 
========== Step 99 ========== 
Step99:rank2, time: 79.331, per_step: 0.793307
Step99:rank3, time: 79.331, per_step: 0.793306
Step99:rank0, time: 79.331, per_step: 0.793307
Step99:rank1, time: 79.331, per_step: 0.793307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.523 us                | 380.755 us                |
| GenInput                  | 80.740 ms                 | 104.039 ms                |
| NN                        | 1.219 ms                  | 15.298 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.436 ms                  | 18.733 ms                 |
| Optimize                  | 295.162 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 283.226 ms                | 3.680 s                   |
| BlockToStepN              | 228.227 us                | 6.870 ms                  |
| OneStep                   | 409.530 ms                | 3.776 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 16:51:26.956322  1947 parallel_pq_v2.h:79] insert failed, size(hashtable)=710
W20240131 16:51:27.252990  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
========== Step 101 ========== 
E20240131 16:51:27.956068  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:51:27.971485  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=101, sample_step_cpp_seen_[rank]=100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.193 us                | 27.852 ms                 |
| ProcessBack:Shuffle       | 270.397 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.380 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.269 us                 | 492.963 us                |
| ProcessOneStep            | 320.890 ms                | 3.680 s                   |
| BlockToStepN              | 143.131 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 257.456 us                | 380.755 us                |
| GenInput                  | 80.680 ms                 | 104.039 ms                |
| NN                        | 1.219 ms                  | 15.298 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.446 ms                  | 18.733 ms                 |
| Optimize                  | 297.308 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 320.912 ms                | 3.680 s                   |
| BlockToStepN              | 231.345 us                | 6.870 ms                  |
| OneStep                   | 409.530 ms                | 3.776 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:28.956138  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:28.967551  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240131 16:51:29.956212  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:30.603099  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240131 16:51:30.956089  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:51:31.725486  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 16:51:31.956012  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
W20240131 16:51:32.884644  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 16:51:32.956300  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:32.987990  1372 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 160.725 us                | 28.424 ms                 |
| ProcessBack:Shuffle       | 253.397 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.375 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.322 us                 | 492.963 us                |
| ProcessOneStep            | 283.194 ms                | 4.099 s                   |
| BlockToStepN              | 156.068 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:33.233520  1372 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.523 us                | 380.755 us                |
| GenInput                  | 80.680 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 15.298 ms                 |
| Forward                   | 1.762 ms                  | 17.409 ms                 |
| Backward                  | 4.446 ms                  | 18.733 ms                 |
| Optimize                  | 294.685 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 962.664 us                | 10.436 ms                 |
| AfterBackward             | 283.226 ms                | 4.099 s                   |
| BlockToStepN              | 234.000 us                | 6.989 ms                  |
| OneStep                   | 381.813 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:33.757407  1372 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
E20240131 16:51:33.956089  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1133
========== Step 109 ========== 
W20240131 16:51:34.599701  1372 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
W20240131 16:51:34.794092  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240131 16:51:34.956130  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=54
========== Step 111 ========== 
E20240131 16:51:35.956329  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 112 ========== 
W20240131 16:51:36.333837  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
========== Step 113 ========== 
========== Step 114 ========== 
E20240131 16:51:36.956082  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=147
========== Step 115 ========== 
E20240131 16:51:37.566118  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=115, sample_step_cpp_seen_[rank]=114
E20240131 16:51:37.956022  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 16:51:38.067282  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.038 us                | 323.195 us                |
| ProcessBack:Shuffle       | 253.397 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.380 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.269 us                 | 492.963 us                |
| ProcessOneStep            | 283.194 ms                | 4.099 s                   |
| BlockToStepN              | 170.262 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:38.228719  1372 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 257.918 us                | 380.755 us                |
| GenInput                  | 80.826 ms                 | 104.763 ms                |
| NN                        | 1.217 ms                  | 16.204 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.426 ms                  | 18.733 ms                 |
| Optimize                  | 295.162 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 283.226 ms                | 4.099 s                   |
| BlockToStepN              | 255.128 us                | 6.989 ms                  |
| OneStep                   | 381.813 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:38.956040  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 117 ========== 
========== Step 118 ========== 
W20240131 16:51:39.695971  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 16:51:39.956013  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=189
========== Step 119 ========== 
E20240131 16:51:40.956012  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=339
========== Step 120 ========== 
W20240131 16:51:41.154191  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
========== Step 121 ========== 
E20240131 16:51:41.956128  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=80
W20240131 16:51:42.468662  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 122 ========== 
E20240131 16:51:42.956072  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=65
========== Step 123 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.524 us                | 27.896 ms                 |
| ProcessBack:Shuffle       | 281.643 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.397 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.322 us                 | 492.963 us                |
| ProcessOneStep            | 341.803 ms                | 4.099 s                   |
| BlockToStepN              | 180.518 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 124 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 257.918 us                | 380.755 us                |
| GenInput                  | 80.826 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 16.204 ms                 |
| Forward                   | 1.762 ms                  | 17.409 ms                 |
| Backward                  | 4.426 ms                  | 18.733 ms                 |
| Optimize                  | 295.162 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 341.840 ms                | 4.099 s                   |
| BlockToStepN              | 269.076 us                | 6.989 ms                  |
| OneStep                   | 426.974 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 125 ========== 
W20240131 16:51:43.763634  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
========== Step 126 ========== 
E20240131 16:51:43.956749  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=136
E20240131 16:51:44.140691  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=126, sample_step_cpp_seen_[rank]=125
W20240131 16:51:44.919297  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240131 16:51:44.956058  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
E20240131 16:51:45.956128  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:46.541306  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240131 16:51:46.956115  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:47.951920  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:51:47.956070  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.685 us                | 269.008 us                |
| ProcessBack:Shuffle       | 278.886 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.269 us                 | 492.963 us                |
| ProcessOneStep            | 320.890 ms                | 4.099 s                   |
| BlockToStepN              | 183.171 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 257.918 us                | 667.630 us                |
| GenInput                  | 80.826 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 16.204 ms                 |
| Forward                   | 1.762 ms                  | 17.409 ms                 |
| Backward                  | 4.373 ms                  | 18.733 ms                 |
| Optimize                  | 294.685 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 870.472 us                | 10.436 ms                 |
| AfterBackward             | 341.840 ms                | 4.243 s                   |
| BlockToStepN              | 274.146 us                | 6.989 ms                  |
| OneStep                   | 426.974 ms                | 4.352 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:51:48.923034  1372 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
E20240131 16:51:48.964301  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:49.113781  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 129 ========== 
========== Step 130 ========== 
E20240131 16:51:49.968192  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 131 ========== 
========== Step 132 ========== 
W20240131 16:51:50.590128  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 133 ========== 
E20240131 16:51:50.968257  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=65
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
E20240131 16:51:51.968211  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:51:52.636121  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
========== Step 137 ========== 
E20240131 16:51:52.968132  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 138 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.567 us                | 15.835 ms                 |
| ProcessBack:Shuffle       | 275.086 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 59.544 us                 | 492.963 us                |
| ProcessOneStep            | 303.599 ms                | 4.243 s                   |
| BlockToStepN              | 192.416 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 259.152 us                | 667.630 us                |
| GenInput                  | 80.826 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 16.204 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.436 ms                  | 18.733 ms                 |
| Optimize                  | 294.685 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.088 ms                  | 10.436 ms                 |
| AfterBackward             | 303.630 ms                | 4.243 s                   |
| BlockToStepN              | 288.486 us                | 6.989 ms                  |
| OneStep                   | 401.524 ms                | 4.352 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:53.968115  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=394
W20240131 16:51:54.162927  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
W20240131 16:51:54.424757  1372 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
========== Step 140 ========== 
E20240131 16:51:54.968029  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=80
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
W20240131 16:51:55.872864  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 16:51:55.968093  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=52
========== Step 144 ========== 
E20240131 16:51:56.968088  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 145 ========== 
W20240131 16:51:57.712973  1372 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
========== Step 147 ========== 
E20240131 16:51:57.968037  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=377
W20240131 16:51:58.123070  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 16:51:58.144088  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=147, sample_step_cpp_seen_[rank]=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 144.061 us                | 30.240 ms                 |
| ProcessBack:Shuffle       | 275.086 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 58.700 us                 | 492.963 us                |
| ProcessOneStep            | 303.599 ms                | 4.243 s                   |
| BlockToStepN              | 205.619 us                | 7.436 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 148 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 259.152 us                | 667.630 us                |
| GenInput                  | 80.740 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 16.204 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.446 ms                  | 18.733 ms                 |
| Optimize                  | 293.016 us                | 1.143 ms                  |
| BarrierTimeBeforeRank0    | 1.015 ms                  | 10.436 ms                 |
| AfterBackward             | 303.630 ms                | 4.243 s                   |
| BlockToStepN              | 304.688 us                | 7.571 ms                  |
| OneStep                   | 401.524 ms                | 4.352 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:51:58.968271  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=114
========== Step 149 ========== 
========== Step 150 ========== 
E20240131 16:51:59.968031  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=183
W20240131 16:52:00.072580  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
E20240131 16:52:00.968014  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=453
========== Step 154 ========== 
W20240131 16:52:01.483369  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 155 ========== 
========== Step 156 ========== 
E20240131 16:52:01.968428  1952 parallel_pq_v2.h:79] insert failed, size(hashtable)=707
W20240131 16:52:02.131709  1372 grad_async_v2.h:257] pq is empty
========== Step 157 ========== 
========== Step 158 ========== 
E20240131 16:52:02.968078  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:52:03.056898  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 16:52:03.144006  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=158, sample_step_cpp_seen_[rank]=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.568 us                | 3.933 ms                  |
| ProcessBack:Shuffle       | 274.357 ms                | 1.302 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 59.544 us                 | 230.992 us                |
| ProcessOneStep            | 288.134 ms                | 4.099 s                   |
| BlockToStepN              | 214.167 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 159 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 259.152 us                | 667.630 us                |
| GenInput                  | 80.826 ms                 | 104.039 ms                |
| NN                        | 1.198 ms                  | 15.298 ms                 |
| Forward                   | 1.762 ms                  | 17.205 ms                 |
| Backward                  | 4.551 ms                  | 18.014 ms                 |
| Optimize                  | 291.824 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 962.664 us                | 10.205 ms                 |
| AfterBackward             | 294.056 ms                | 4.099 s                   |
| BlockToStepN              | 320.640 us                | 6.989 ms                  |
| OneStep                   | 392.637 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:52:03.968014  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=139
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
E20240131 16:52:04.968111  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=170
W20240131 16:52:04.997200  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 164 ========== 
========== Step 165 ========== 
E20240131 16:52:05.968825  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:52:06.968824  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:52:07.209553  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 166 ========== 
========== Step 167 ========== 
E20240131 16:52:07.968201  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.685 us                | 15.997 ms                 |
| ProcessBack:Shuffle       | 269.083 ms                | 1.302 s                   |
| ProcessBack:UpdateCache   | 1.397 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 59.593 us                 | 230.992 us                |
| ProcessOneStep            | 283.878 ms                | 4.099 s                   |
| BlockToStepN              | 227.712 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 257.918 us                | 667.630 us                |
| GenInput                  | 81.040 ms                 | 104.763 ms                |
| NN                        | 1.196 ms                  | 15.298 ms                 |
| Forward                   | 1.762 ms                  | 17.205 ms                 |
| Backward                  | 4.586 ms                  | 18.014 ms                 |
| Optimize                  | 291.824 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.077 ms                  | 10.205 ms                 |
| AfterBackward             | 283.968 ms                | 4.099 s                   |
| BlockToStepN              | 336.538 us                | 6.989 ms                  |
| OneStep                   | 387.349 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 168 ========== 
W20240131 16:52:08.839174  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 16:52:08.980134  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 169 ========== 
W20240131 16:52:09.882781  1945 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
E20240131 16:52:09.980540  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
E20240131 16:52:10.484011  1372 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=169, sample_step_cpp_seen_[rank]=168
E20240131 16:52:10.980016  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 16:52:11.603811  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 16:52:11.874346  1372 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
E20240131 16:52:11.980175  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
E20240131 16:52:12.980129  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
W20240131 16:52:13.004729  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.499 us                | 27.709 ms                 |
| ProcessBack:Shuffle       | 270.396 ms                | 1.302 s                   |
| ProcessBack:UpdateCache   | 1.397 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 59.544 us                 | 230.992 us                |
| ProcessOneStep            | 288.134 ms                | 4.099 s                   |
| BlockToStepN              | 243.630 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 259.152 us                | 667.630 us                |
| GenInput                  | 81.040 ms                 | 104.763 ms                |
| NN                        | 1.196 ms                  | 15.298 ms                 |
| Forward                   | 1.762 ms                  | 17.205 ms                 |
| Backward                  | 4.586 ms                  | 18.014 ms                 |
| Optimize                  | 293.016 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.077 ms                  | 10.205 ms                 |
| AfterBackward             | 288.169 ms                | 4.099 s                   |
| BlockToStepN              | 340.428 us                | 6.989 ms                  |
| OneStep                   | 389.832 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 174 ========== 
E20240131 16:52:13.980194  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=80
W20240131 16:52:14.268946  1945 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 175 ========== 
E20240131 16:52:14.980027  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 176 ========== 
W20240131 16:52:15.795192  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240131 16:52:15.980173  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=796
========== Step 177 ========== 
W20240131 16:52:16.872625  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 178 ========== 
E20240131 16:52:16.980131  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=120
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
E20240131 16:52:17.980186  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.685 us                | 31.743 ms                 |
| ProcessBack:Shuffle       | 270.396 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.405 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 59.593 us                 | 230.992 us                |
| ProcessOneStep            | 288.134 ms                | 4.099 s                   |
| BlockToStepN              | 248.634 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:52:18.288240  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 260.265 us                | 667.630 us                |
| GenInput                  | 81.005 ms                 | 104.763 ms                |
| NN                        | 1.198 ms                  | 15.298 ms                 |
| Forward                   | 1.778 ms                  | 17.205 ms                 |
| Backward                  | 4.446 ms                  | 18.014 ms                 |
| Optimize                  | 294.685 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.081 ms                  | 10.205 ms                 |
| AfterBackward             | 288.169 ms                | 4.099 s                   |
| BlockToStepN              | 344.755 us                | 6.989 ms                  |
| OneStep                   | 389.832 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 182 ========== 
E20240131 16:52:18.981289  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 183 ========== 
E20240131 16:52:19.981279  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 184 ========== 
W20240131 16:52:20.243870  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
========== Step 185 ========== 
E20240131 16:52:20.996094  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 186 ========== 
W20240131 16:52:21.689026  1372 grad_async_v2.h:257] pq is empty
========== Step 187 ========== 
W20240131 16:52:21.791333  1945 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 16:52:21.996059  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
========== Step 188 ========== 
E20240131 16:52:22.996057  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 143.792 us                | 27.660 ms                 |
| ProcessBack:Shuffle       | 274.357 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.415 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 59.660 us                 | 230.992 us                |
| ProcessOneStep            | 297.538 ms                | 4.099 s                   |
| BlockToStepN              | 254.554 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:52:23.161782  1945 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 261.846 us                | 667.630 us                |
| GenInput                  | 80.826 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 15.298 ms                 |
| Forward                   | 1.795 ms                  | 17.409 ms                 |
| Backward                  | 4.586 ms                  | 18.733 ms                 |
| Optimize                  | 297.546 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.148 ms                  | 10.205 ms                 |
| AfterBackward             | 297.665 ms                | 4.099 s                   |
| BlockToStepN              | 347.834 us                | 6.989 ms                  |
| OneStep                   | 397.868 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:52:23.770817  1372 grad_async_v2.h:257] pq is empty
========== Step 189 ========== 
E20240131 16:52:23.996490  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=266
========== Step 190 ========== 
========== Step 191 ========== 
W20240131 16:52:24.743304  1945 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240131 16:52:24.996033  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=228
W20240131 16:52:25.230109  1372 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
E20240131 16:52:25.996414  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
W20240131 16:52:26.558512  1372 grad_async_v2.h:257] pq is empty
========== Step 193 ========== 
E20240131 16:52:27.000077  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:52:27.093926  1945 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 194 ========== 
E20240131 16:52:28.000022  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 138.215 us                | 27.576 ms                 |
| ProcessBack:Shuffle       | 278.886 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.427 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 60.144 us                 | 230.992 us                |
| ProcessOneStep            | 320.890 ms                | 4.099 s                   |
| BlockToStepN              | 260.914 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 195 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 262.014 us                | 667.630 us                |
| GenInput                  | 80.680 ms                 | 104.763 ms                |
| NN                        | 1.214 ms                  | 15.298 ms                 |
| Forward                   | 1.807 ms                  | 17.409 ms                 |
| Backward                  | 4.641 ms                  | 18.733 ms                 |
| Optimize                  | 297.546 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.150 ms                  | 10.205 ms                 |
| AfterBackward             | 325.769 ms                | 4.099 s                   |
| BlockToStepN              | 361.320 us                | 6.989 ms                  |
| OneStep                   | 418.887 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 58.743 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 196 ========== 
E20240131 16:52:29.000176  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:52:29.011848  1945 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
========== Step 197 ========== 
========== Step 198 ========== 
E20240131 16:52:30.000144  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=235
========== Step 199 ========== 
W20240131 16:52:30.781049  1945 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 16:52:31.000032  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
Step199:rank0, time: 64.833, per_step: 0.641907
Step199:rank2, time: 64.833, per_step: 0.641907
Step199:rank3, time: 64.833, per_step: 0.641908
Step199:rank1, time: 64.833, per_step: 0.641907
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 261.399 us                | 667.630 us                |
| GenInput                  | 80.628 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 15.298 ms                 |
| Forward                   | 1.796 ms                  | 17.409 ms                 |
| Backward                  | 4.648 ms                  | 18.733 ms                 |
| Optimize                  | 297.546 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.153 ms                  | 10.205 ms                 |
| AfterBackward             | 339.877 ms                | 4.099 s                   |
| BlockToStepN              | 372.013 us                | 6.989 ms                  |
| OneStep                   | 426.809 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 64.833 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 16:52:31.448722  1372 grad_async_v2.h:84] call StopThreads. PID = 1372
W20240131 16:52:31.448742  1372 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 16:52:31.448787  1372 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 16:52:31.448794  1372 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
E20240131 16:52:32.000057  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:52:32.862540  1945 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240131 16:52:33.000011  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 139.672 us                | 495.811 us                |
| ProcessBack:Shuffle       | 286.882 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.415 ms                  | 17.739 ms                 |
| ProcessBack:UpsertPq      | 60.144 us                 | 230.992 us                |
| ProcessOneStep            | 339.848 ms                | 4.099 s                   |
| BlockToStepN              | 270.830 us                | 6.797 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 261.399 us                | 667.630 us                |
| GenInput                  | 80.628 ms                 | 104.763 ms                |
| NN                        | 1.202 ms                  | 15.298 ms                 |
| Forward                   | 1.796 ms                  | 17.409 ms                 |
| Backward                  | 4.648 ms                  | 18.733 ms                 |
| Optimize                  | 297.546 us                | 1.134 ms                  |
| BarrierTimeBeforeRank0    | 1.153 ms                  | 10.205 ms                 |
| AfterBackward             | 339.877 ms                | 4.099 s                   |
| BlockToStepN              | 372.013 us                | 6.989 ms                  |
| OneStep                   | 426.809 ms                | 4.190 s                   |
| E2E-100                   | 58.743 s                  | 64.833 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:52:34.000331  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:52:34.527062  1945 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 16:52:35.000144  1945 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 16:52:35.363873  1372 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
