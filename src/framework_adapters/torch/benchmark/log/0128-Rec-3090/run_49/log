WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 15:09:43.737017 15308 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 15:09:43.746361 15308 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [15308 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f95151cd9e0>==========
Worker 1 pid=15675
Worker 2 pid=15676
Worker 3 pid=15677
Worker 4 pid=15678
INFO [15308 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [15675 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [15676 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [15677 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [15677 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [15678 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [15679 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [15678 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [15679 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [15675 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
E20240131 15:09:49.961702 15677 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 15:09:49.961949 15679 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 15:09:49.961951 15678 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 15:09:49.962225 15675 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [15676 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
E20240131 15:09:49.963080 15676 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [15308 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
E20240131 15:09:49.964509 15308 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 15:09:55.165143 15679 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [472460, 32]; dev=5; size=57.67 MB
W20240131 15:09:55.165444 15677 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 15:09:55.165490 15675 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 15:09:55.165531 15676 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 15:09:55.166831 15678 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [472460, 32]; dev=4; size=57.67 MB
W20240131 15:09:55.171031 15308 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 15:09:55.732280 15679 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10004817f000 7.629 MB
W20240131 15:09:55.732348 15678 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100048922000 7.629 MB
W20240131 15:09:55.732486 15678 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000490c5000 7.629 MB
W20240131 15:09:55.732497 15679 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100049868000 7.629 MB
W20240131 15:09:55.732558 15678 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10004a00b000 122.1 MB
W20240131 15:09:55.732563 15679 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x100051a1f000 122.1 MB
W20240131 15:09:55.732612 15679 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100059433000 122.1 MB
W20240131 15:09:55.732617 15678 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100060e47000 122.1 MB
W20240131 15:09:55.732650 15679 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 15:09:55.732671 15678 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 15:09:55.733795 15679 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 15:09:55.733805 15678 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 15:09:55.733940 15676 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100068861000 7.629 MB
W20240131 15:09:55.734069 15676 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100069004000 7.629 MB
W20240131 15:09:55.734124 15676 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a7000 122.1 MB
W20240131 15:09:55.734167 15676 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000711bb000 122.1 MB
W20240131 15:09:55.734213 15676 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 15:09:55.734697 15676 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 15:09:55.743793 15675 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100078bd9000 7.629 MB
W20240131 15:09:55.743971 15675 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10007937c000 7.629 MB
W20240131 15:09:55.744040 15675 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100079b21000 122.1 MB
W20240131 15:09:55.744096 15675 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100081535000 122.1 MB
W20240131 15:09:55.744129 15675 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 15:09:55.744279 15677 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100088f49000 7.629 MB
W20240131 15:09:55.744426 15677 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000896ec000 7.629 MB
W20240131 15:09:55.744503 15677 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100089e91000 122.1 MB
W20240131 15:09:55.744501 15675 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 15:09:55.744553 15677 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000918a5000 122.1 MB
W20240131 15:09:55.744606 15677 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 15:09:55.745079 15677 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 15:09:55.756490 15308 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000992c1000 7.629 MB
W20240131 15:09:55.756726 15308 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100099a64000 7.629 MB
W20240131 15:09:55.756816 15308 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10009a207000 122.1 MB
W20240131 15:09:55.756857 15308 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000a1c1b000 122.1 MB
W20240131 15:09:55.756906 15308 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 15:09:55.757262 15308 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
Worker 5 pid=15679
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840), (1889840, 2362300), (2362300, 2834760)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240131 15:10:00.182560 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000a9633000 7.629 MB
W20240131 15:10:00.182761 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000a9dd6000 7.629 MB
W20240131 15:10:00.182816 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000aa579000 7.629 MB
W20240131 15:10:00.182857 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000aad1c000 7.629 MB
W20240131 15:10:00.182889 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000ab4bf000 7.629 MB
W20240131 15:10:00.182929 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000abc62000 7.629 MB
W20240131 15:10:00.182965 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000ac405000 7.629 MB
W20240131 15:10:00.183025 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000acba8000 7.629 MB
W20240131 15:10:00.183068 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000ad34b000 7.629 MB
W20240131 15:10:00.183100 15676 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000adaee000 7.629 MB
W20240131 15:10:00.183152 15676 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000ae291000 80 B 
W20240131 15:10:00.183189 15676 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000ae293000 8 B 
W20240131 15:10:00.183234 15676 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000ae295000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:00.183614 15676 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
W20240131 15:10:00.194717 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000ae297000 7.629 MB
W20240131 15:10:00.194909 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000aea3a000 7.629 MB
W20240131 15:10:00.194969 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000af1dd000 7.629 MB
W20240131 15:10:00.195008 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000af980000 7.629 MB
W20240131 15:10:00.195045 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000b0123000 7.629 MB
W20240131 15:10:00.195084 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000b08c6000 7.629 MB
W20240131 15:10:00.195122 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000b1069000 7.629 MB
W20240131 15:10:00.195186 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000b180c000 7.629 MB
W20240131 15:10:00.195235 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000b1faf000 7.629 MB
W20240131 15:10:00.195271 15679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000b2752000 7.629 MB
W20240131 15:10:00.195341 15679 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000b2ef5000 80 B 
W20240131 15:10:00.195377 15679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000b2ef7000 8 B 
W20240131 15:10:00.195423 15679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000b2ef9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:00.195813 15679 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240131 15:10:00.915048 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000b2efb000 7.629 MB
W20240131 15:10:00.915380 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000b369e000 7.629 MB
W20240131 15:10:00.915446 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000b3e41000 7.629 MB
W20240131 15:10:00.915480 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000b45e4000 7.629 MB
W20240131 15:10:00.915529 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000b4d87000 7.629 MB
W20240131 15:10:00.915611 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000b552a000 7.629 MB
W20240131 15:10:00.915694 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000b5ccd000 7.629 MB
W20240131 15:10:00.915786 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000b6470000 7.629 MB
W20240131 15:10:00.915825 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000b6c13000 7.629 MB
W20240131 15:10:00.915874 15308 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000b73b6000 7.629 MB
W20240131 15:10:00.915911 15308 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000b7b59000 80 B 
W20240131 15:10:00.915946 15308 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000b7b5b000 8 B 
W20240131 15:10:00.915971 15308 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000b7b5d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:00.916360 15308 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240131 15:10:01.036708 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000b7b5f000 7.629 MB
W20240131 15:10:01.036880 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000b8302000 7.629 MB
W20240131 15:10:01.036940 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000b8aa5000 7.629 MB
W20240131 15:10:01.036985 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000b9248000 7.629 MB
W20240131 15:10:01.037022 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000b99eb000 7.629 MB
W20240131 15:10:01.037060 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000ba18e000 7.629 MB
W20240131 15:10:01.037098 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000ba931000 7.629 MB
W20240131 15:10:01.037164 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000bb0d4000 7.629 MB
W20240131 15:10:01.037217 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000bb877000 7.629 MB
W20240131 15:10:01.037254 15678 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000bc01a000 7.629 MB
W20240131 15:10:01.037307 15678 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000bc7bd000 80 B 
W20240131 15:10:01.037345 15678 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000bc7bf000 8 B 
W20240131 15:10:01.037389 15678 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000bc7c1000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:01.037705 15678 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240131 15:10:01.208940 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000bc7c3000 7.629 MB
W20240131 15:10:01.209136 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000bcf66000 7.629 MB
W20240131 15:10:01.209198 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000bd709000 7.629 MB
W20240131 15:10:01.209239 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000bdeac000 7.629 MB
W20240131 15:10:01.209276 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000be64f000 7.629 MB
W20240131 15:10:01.209318 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000bedf2000 7.629 MB
W20240131 15:10:01.209355 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000bf595000 7.629 MB
W20240131 15:10:01.209424 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000bfd38000 7.629 MB
W20240131 15:10:01.209481 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000c04db000 7.629 MB
W20240131 15:10:01.209527 15677 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000c0c7e000 7.629 MB
W20240131 15:10:01.209580 15677 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000c1421000 80 B 
W20240131 15:10:01.209616 15677 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000c1423000 8 B 
W20240131 15:10:01.209666 15677 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000c1425000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:01.209996 15677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240131 15:10:01.285295 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000c1427000 7.629 MB
W20240131 15:10:01.285436 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000c1bca000 7.629 MB
W20240131 15:10:01.285492 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000c236d000 7.629 MB
W20240131 15:10:01.285537 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000c2b10000 7.629 MB
W20240131 15:10:01.285571 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000c32b3000 7.629 MB
W20240131 15:10:01.285606 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000c3a56000 7.629 MB
W20240131 15:10:01.285643 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000c41f9000 7.629 MB
W20240131 15:10:01.285699 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000c499c000 7.629 MB
W20240131 15:10:01.285753 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000c513f000 7.629 MB
W20240131 15:10:01.285787 15675 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000c58e2000 7.629 MB
W20240131 15:10:01.285832 15675 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000c6085000 80 B 
W20240131 15:10:01.285866 15675 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000c6087000 8 B 
W20240131 15:10:01.285909 15675 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000c6089000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 15:10:01.286212 15675 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240131 15:10:01.288861 15308 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 15:10:01.289211 15308 grad_base.h:184] Init GradProcessingBase done
I20240131 15:10:02.432466 15308 grad_async_v2.h:42] Use main thread to update emb.
W20240131 15:10:02.432811 15308 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 15:10:02.432823 15308 kg_controller.h:84] Construct KGCacheController done
E20240131 15:10:03.064183 15679 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 15:10:03.064298 15678 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 15:10:03.065090 15308 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 15:10:03.065418 15675 recstore.cc:66] init folly done
E20240131 15:10:03.065430 15676 recstore.cc:66] init folly done
E20240131 15:10:03.065438 15677 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 15:10:03.066484 15308 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 15:10:03.733717 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 15:10:03.734056 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 15:10:04.734050 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:04.749888 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 15:10:05.734066 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:05.841796 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 15:10:06.734023 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:06.990803 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 15:10:07.734772 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.923 us                | 264.204 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:08.125384 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 15:10:08.734319 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
W20240131 15:10:09.155164 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 15:10:09.734031 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=99
W20240131 15:10:10.274176 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 15:10:10.734046 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:11.319409 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 15:10:11.734059 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:12.347450 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 15:10:12.734014 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.177 us                | 266.075 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:13.411255 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
Before Training
I20240131 15:10:14.312068 15679 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
Before Training
Before Training
Before Training
Before Training
I20240131 15:10:14.312762 15676 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240131 15:10:14.312860 15675 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240131 15:10:14.313246 15677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240131 15:10:14.313292 15678 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
Before Training
I20240131 15:10:14.315778 15308 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
========== Step 0 ========== 
E20240131 15:10:14.337481 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 15:10:14.510519 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 15:10:16.162346 17685 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 346.573 us                | 346.573 us                |
| GenInput                  | 81.950 ms                 | 81.950 ms                 |
| NN                        | 190.815 ms                | 190.815 ms                |
| Forward                   | 253.733 ms                | 253.733 ms                |
| Backward                  | 139.801 ms                | 139.801 ms                |
| Optimize                  | 4.834 ms                  | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 15.248 ms                 | 15.248 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:17.162050 17688 parallel_pq_v2.h:79] insert failed, size(hashtable)=339
W20240131 15:10:17.530236 15308 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 188.702 us                | 427.843 us                |
| ProcessBack:Shuffle       | 713.076 ms                | 713.076 ms                |
| ProcessBack:UpdateCache   | 620.213 ms                | 620.213 ms                |
| ProcessBack:UpsertPq      | 1.368 s                   | 1.368 s                   |
| ProcessOneStep            | 2.711 s                   | 2.711 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:18.280192 16455 parallel_pq_v2.h:79] insert failed, size(hashtable)=4433
========== Step 1 ========== 
W20240131 15:10:18.416841 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [15679 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15675 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15677 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15676 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15678 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15308 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
E20240131 15:10:19.279093 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1487
W20240131 15:10:19.558027 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 3 ========== 
E20240131 15:10:20.279038 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 4 ========== 
W20240131 15:10:20.624469 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 15:10:21.279047 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=4384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 343.436 us                | 376.638 us                |
| GenInput                  | 84.717 ms                 | 116.288 ms                |
| NN                        | 10.283 ms                 | 190.815 ms                |
| Forward                   | 27.195 ms                 | 253.733 ms                |
| Backward                  | 4.864 ms                  | 139.801 ms                |
| Optimize                  | 581.264 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.172 ms                  | 15.248 ms                 |
| AfterBackward             | 279.861 ms                | 2.711 s                   |
| BlockToStepN              | 128.987 us                | 835.447 ms                |
| OneStep                   | 410.097 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:21.828431 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 15:10:22.208639 15308 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
E20240131 15:10:22.288039 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240131 15:10:23.030066 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 195.187 us                | 44.059 ms                 |
| ProcessBack:Shuffle       | 713.076 ms                | 1.473 s                   |
| ProcessBack:UpdateCache   | 5.618 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 65.300 us                 | 1.368 s                   |
| ProcessOneStep            | 1.412 s                   | 2.711 s                   |
| BlockToStepN              | 80.981 us                 | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:23.288014 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=3627
W20240131 15:10:23.560532 15308 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 15:10:24.086349 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 15:10:24.288007 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=5157
W20240131 15:10:24.496378 15308 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
W20240131 15:10:25.216885 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 15:10:25.288080 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=128
========== Step 8 ========== 
========== Step 9 ========== 
E20240131 15:10:26.288101 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=702
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.148 us                | 463.332 us                |
| GenInput                  | 91.502 ms                 | 128.571 ms                |
| NN                        | 1.782 ms                  | 190.815 ms                |
| Forward                   | 2.396 ms                  | 253.733 ms                |
| Backward                  | 4.864 ms                  | 139.801 ms                |
| Optimize                  | 401.735 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.466 ms                  | 15.248 ms                 |
| AfterBackward             | 807.171 ms                | 2.711 s                   |
| BlockToStepN              | 202.131 us                | 835.447 ms                |
| OneStep                   | 935.876 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:26.332592 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 15:10:27.114703 15308 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
E20240131 15:10:27.288030 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=862
W20240131 15:10:27.413563 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 232.324 us                | 47.763 ms                 |
| ProcessBack:Shuffle       | 804.829 ms                | 1.473 s                   |
| ProcessBack:UpdateCache   | 2.449 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 76.500 us                 | 1.368 s                   |
| ProcessOneStep            | 807.087 ms                | 2.711 s                   |
| BlockToStepN              | 115.007 us                | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:28.069801 15308 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
E20240131 15:10:28.304158 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=74
W20240131 15:10:28.530356 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 12 ========== 
E20240131 15:10:29.304039 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=267
W20240131 15:10:29.611145 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 13 ========== 
E20240131 15:10:30.304011 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=115
W20240131 15:10:30.789604 15308 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
W20240131 15:10:30.828060 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 236.857 us                | 463.332 us                |
| GenInput                  | 93.820 ms                 | 130.368 ms                |
| NN                        | 1.782 ms                  | 190.815 ms                |
| Forward                   | 2.396 ms                  | 253.733 ms                |
| Backward                  | 8.827 ms                  | 139.801 ms                |
| Optimize                  | 399.828 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.466 ms                  | 15.248 ms                 |
| AfterBackward             | 818.141 ms                | 2.711 s                   |
| BlockToStepN              | 182.098 us                | 835.447 ms                |
| OneStep                   | 949.329 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:31.304201 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=175
W20240131 15:10:31.723774 15308 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
W20240131 15:10:31.890579 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 15:10:32.304199 16455 parallel_pq_v2.h:79] insert failed, size(hashtable)=3478
W20240131 15:10:32.607828 15308 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
W20240131 15:10:33.008613 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 198.204 us                | 44.852 ms                 |
| ProcessBack:Shuffle       | 804.829 ms                | 1.473 s                   |
| ProcessBack:UpdateCache   | 2.449 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 76.064 us                 | 1.368 s                   |
| ProcessOneStep            | 812.543 ms                | 2.711 s                   |
| BlockToStepN              | 89.331 us                 | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:33.304168 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:10:33.468255 15308 grad_async_v2.h:257] pq is empty
========== Step 17 ========== 
========== Step 18 ========== 
W20240131 15:10:34.201057 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 15:10:34.304006 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=2842
========== Step 19 ========== 
W20240131 15:10:35.268939 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 15:10:35.304363 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=928
W20240131 15:10:36.037129 15308 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 236.857 us                | 463.332 us                |
| GenInput                  | 101.183 ms                | 130.368 ms                |
| NN                        | 1.703 ms                  | 190.815 ms                |
| Forward                   | 2.281 ms                  | 253.733 ms                |
| Backward                  | 9.821 ms                  | 139.801 ms                |
| Optimize                  | 399.828 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.466 ms                  | 15.248 ms                 |
| AfterBackward             | 807.171 ms                | 2.711 s                   |
| BlockToStepN              | 186.908 us                | 835.447 ms                |
| OneStep                   | 934.174 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:36.304337 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1477
W20240131 15:10:36.362617 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 15:10:36.955184 15308 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
E20240131 15:10:37.304016 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1414
========== Step 22 ========== 
W20240131 15:10:37.543196 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 289.384 us                | 55.231 ms                 |
| ProcessBack:Shuffle       | 757.529 ms                | 1.473 s                   |
| ProcessBack:UpdateCache   | 2.427 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 76.064 us                 | 1.368 s                   |
| ProcessOneStep            | 801.475 ms                | 2.711 s                   |
| BlockToStepN              | 93.421 us                 | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:38.304158 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=4661
========== Step 23 ========== 
W20240131 15:10:38.919622 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240131 15:10:39.304044 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=613
W20240131 15:10:39.928364 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 15:10:40.212879 15308 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
E20240131 15:10:40.304083 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=302
W20240131 15:10:41.047665 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 230.710 us                | 463.332 us                |
| GenInput                  | 101.183 ms                | 130.368 ms                |
| NN                        | 1.573 ms                  | 190.815 ms                |
| Forward                   | 2.217 ms                  | 253.733 ms                |
| Backward                  | 9.821 ms                  | 139.801 ms                |
| Optimize                  | 399.828 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.466 ms                  | 15.248 ms                 |
| AfterBackward             | 807.171 ms                | 2.711 s                   |
| BlockToStepN              | 186.908 us                | 835.447 ms                |
| OneStep                   | 934.174 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:41.304270 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=719
W20240131 15:10:41.398948 15308 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
W20240131 15:10:42.130810 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 26 ========== 
E20240131 15:10:42.304069 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=306
========== Step 27 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 261.491 us                | 51.428 ms                 |
| ProcessBack:Shuffle       | 799.294 ms                | 1.650 s                   |
| ProcessBack:UpdateCache   | 2.422 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 74.078 us                 | 1.368 s                   |
| ProcessOneStep            | 807.087 ms                | 2.711 s                   |
| BlockToStepN              | 90.567 us                 | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:43.285599 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 15:10:43.304030 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=352
W20240131 15:10:44.227325 15308 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
E20240131 15:10:44.304028 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=111
W20240131 15:10:44.366901 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 15:10:45.092963 15308 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
E20240131 15:10:45.304131 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=606
W20240131 15:10:45.390362 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 15:10:45.959364 15308 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 230.710 us                | 463.332 us                |
| GenInput                  | 105.384 ms                | 130.368 ms                |
| NN                        | 1.451 ms                  | 190.815 ms                |
| Forward                   | 2.017 ms                  | 253.733 ms                |
| Backward                  | 11.184 ms                 | 139.801 ms                |
| Optimize                  | 399.828 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.620 ms                  | 15.248 ms                 |
| AfterBackward             | 801.523 ms                | 2.711 s                   |
| BlockToStepN              | 186.908 us                | 835.447 ms                |
| OneStep                   | 918.010 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:46.304088 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=124
W20240131 15:10:46.418953 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 15:10:46.905619 15308 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
========== Step 32 ========== 
E20240131 15:10:47.304183 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=810
W20240131 15:10:47.450157 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 230.344 us                | 47.967 ms                 |
| ProcessBack:Shuffle       | 757.529 ms                | 1.650 s                   |
| ProcessBack:UpdateCache   | 2.390 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 75.039 us                 | 1.368 s                   |
| ProcessOneStep            | 801.475 ms                | 2.711 s                   |
| BlockToStepN              | 97.964 us                 | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:48.304129 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=465
W20240131 15:10:48.572010 15308 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
W20240131 15:10:48.588483 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 15:10:49.304075 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=442
W20240131 15:10:49.490448 15308 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
W20240131 15:10:49.672534 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 35 ========== 
E20240131 15:10:50.304098 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=463
W20240131 15:10:50.924712 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.440 us                | 463.332 us                |
| GenInput                  | 103.200 ms                | 130.368 ms                |
| NN                        | 1.427 ms                  | 190.815 ms                |
| Forward                   | 2.003 ms                  | 253.733 ms                |
| Backward                  | 8.827 ms                  | 139.801 ms                |
| Optimize                  | 399.828 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.612 ms                  | 15.248 ms                 |
| AfterBackward             | 801.523 ms                | 2.711 s                   |
| BlockToStepN              | 186.908 us                | 835.447 ms                |
| OneStep                   | 918.419 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 15:10:51.317965 15308 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
E20240131 15:10:51.359309 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 37 ========== 
W20240131 15:10:51.953750 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 15:10:52.359118 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=3880
W20240131 15:10:52.965067 15308 grad_async_v2.h:257] pq is empty
========== Step 38 ========== 
W20240131 15:10:53.038563 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 245.763 us                | 47.857 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 1.650 s                   |
| ProcessBack:UpdateCache   | 2.390 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 74.078 us                 | 1.368 s                   |
| ProcessOneStep            | 801.475 ms                | 2.711 s                   |
| BlockToStepN              | 104.513 us                | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:53.359182 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=492
W20240131 15:10:53.924439 15308 grad_async_v2.h:257] pq is empty
========== Step 39 ========== 
W20240131 15:10:54.126662 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 15:10:54.359282 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=358
W20240131 15:10:54.800640 15308 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
========== Step 41 ========== 
W20240131 15:10:55.329628 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240131 15:10:55.359045 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 223.630 us                | 463.332 us                |
| GenInput                  | 109.191 ms                | 130.368 ms                |
| NN                        | 1.427 ms                  | 190.815 ms                |
| Forward                   | 1.992 ms                  | 253.733 ms                |
| Backward                  | 9.821 ms                  | 139.801 ms                |
| Optimize                  | 390.291 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.642 ms                  | 15.248 ms                 |
| AfterBackward             | 785.741 ms                | 2.711 s                   |
| BlockToStepN              | 198.432 us                | 835.447 ms                |
| OneStep                   | 918.010 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:56.359010 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=114
W20240131 15:10:56.489454 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 43 ========== 
========== Step 44 ========== 
E20240131 15:10:57.359103 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=203
W20240131 15:10:57.764278 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 216.624 us                | 47.857 ms                 |
| ProcessBack:Shuffle       | 757.529 ms                | 1.650 s                   |
| ProcessBack:UpdateCache   | 2.349 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 73.669 us                 | 1.368 s                   |
| ProcessOneStep            | 785.618 ms                | 2.711 s                   |
| BlockToStepN              | 104.871 us                | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:10:58.359562 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
W20240131 15:10:58.708478 15308 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
W20240131 15:10:58.918387 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240131 15:10:59.359722 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=238
W20240131 15:11:00.058548 15308 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
W20240131 15:11:00.092092 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 15:11:00.359834 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=130
W20240131 15:11:00.994290 15308 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
W20240131 15:11:01.142014 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 48 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.440 us                | 463.332 us                |
| GenInput                  | 109.542 ms                | 130.487 ms                |
| NN                        | 1.401 ms                  | 190.815 ms                |
| Forward                   | 1.970 ms                  | 253.733 ms                |
| Backward                  | 6.625 ms                  | 139.801 ms                |
| Optimize                  | 383.854 us                | 4.834 ms                  |
| BarrierTimeBeforeRank0    | 1.642 ms                  | 15.248 ms                 |
| AfterBackward             | 801.099 ms                | 2.711 s                   |
| BlockToStepN              | 201.555 us                | 835.447 ms                |
| OneStep                   | 918.419 ms                | 4.049 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:01.359679 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=310
W20240131 15:11:02.160900 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 15:11:02.359103 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=341
========== Step 49 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 204.487 us                | 47.958 ms                 |
| ProcessBack:Shuffle       | 798.352 ms                | 1.650 s                   |
| ProcessBack:UpdateCache   | 2.365 ms                  | 620.213 ms                |
| ProcessBack:UpsertPq      | 73.945 us                 | 1.368 s                   |
| ProcessOneStep            | 801.475 ms                | 2.711 s                   |
| BlockToStepN              | 106.390 us                | 834.595 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:03.254705 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 15:11:03.359827 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=68
W20240131 15:11:03.604622 15308 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
W20240131 15:11:04.282912 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 15:11:04.359254 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=327
W20240131 15:11:04.494709 15308 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
W20240131 15:11:05.406858 15308 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
W20240131 15:11:05.420617 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 15:11:05.420699 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 53 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.968 us                | 437.028 us                |
| GenInput                  | 108.554 ms                | 130.368 ms                |
| NN                        | 1.401 ms                  | 26.601 ms                 |
| Forward                   | 1.970 ms                  | 27.508 ms                 |
| Backward                  | 6.625 ms                  | 23.133 ms                 |
| Optimize                  | 383.854 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.642 ms                  | 10.703 ms                 |
| AfterBackward             | 801.099 ms                | 1.652 s                   |
| BlockToStepN              | 201.555 us                | 476.782 us                |
| OneStep                   | 918.419 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:06.420035 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=204
W20240131 15:11:06.636126 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240131 15:11:07.240100 15308 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
E20240131 15:11:07.420059 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=111
W20240131 15:11:07.665383 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 200.457 us                | 47.754 ms                 |
| ProcessBack:Shuffle       | 790.647 ms                | 1.480 s                   |
| ProcessBack:UpdateCache   | 2.346 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 71.305 us                 | 107.972 us                |
| ProcessOneStep            | 801.055 ms                | 1.652 s                   |
| BlockToStepN              | 108.218 us                | 215.427 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:08.133803 15308 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
E20240131 15:11:08.421023 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=68
========== Step 56 ========== 
W20240131 15:11:08.786120 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 57 ========== 
E20240131 15:11:09.421047 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=41
W20240131 15:11:09.488570 15308 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
W20240131 15:11:10.051707 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240131 15:11:10.421036 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
========== Step 59 ========== 
W20240131 15:11:11.293577 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.251 us                | 437.028 us                |
| GenInput                  | 108.554 ms                | 130.368 ms                |
| NN                        | 1.401 ms                  | 26.601 ms                 |
| Forward                   | 1.970 ms                  | 27.508 ms                 |
| Backward                  | 7.327 ms                  | 23.133 ms                 |
| Optimize                  | 383.854 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.650 ms                  | 10.703 ms                 |
| AfterBackward             | 792.876 ms                | 1.652 s                   |
| BlockToStepN              | 202.811 us                | 476.782 us                |
| OneStep                   | 918.010 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:11.422137 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
========== Step 60 ========== 
W20240131 15:11:12.403563 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240131 15:11:12.422111 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=515
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 190.889 us                | 44.030 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 1.480 s                   |
| ProcessBack:UpdateCache   | 2.346 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 71.197 us                 | 107.972 us                |
| ProcessOneStep            | 792.841 ms                | 1.652 s                   |
| BlockToStepN              | 111.608 us                | 215.427 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:13.247695 15308 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
E20240131 15:11:13.422176 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
W20240131 15:11:13.446301 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 15:11:14.198494 15308 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
E20240131 15:11:14.422309 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=75
W20240131 15:11:14.573231 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 15:11:15.428344 15308 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
E20240131 15:11:15.461719 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:11:15.641234 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.251 us                | 437.028 us                |
| GenInput                  | 108.025 ms                | 130.368 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 6.674 ms                  | 23.133 ms                 |
| Optimize                  | 378.609 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.683 ms                  | 10.703 ms                 |
| AfterBackward             | 801.523 ms                | 1.652 s                   |
| BlockToStepN              | 209.632 us                | 476.782 us                |
| OneStep                   | 934.174 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:16.398631 15308 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
E20240131 15:11:16.463217 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=62
W20240131 15:11:16.718330 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 65 ========== 
========== Step 66 ========== 
E20240131 15:11:17.463748 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
========== Step 67 ========== 
W20240131 15:11:17.966776 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 248.803 us                | 50.729 ms                 |
| ProcessBack:Shuffle       | 790.647 ms                | 1.480 s                   |
| ProcessBack:UpdateCache   | 2.337 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 70.425 us                 | 107.972 us                |
| ProcessOneStep            | 801.055 ms                | 1.652 s                   |
| BlockToStepN              | 115.053 us                | 215.427 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:18.463099 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 68 ========== 
W20240131 15:11:19.368793 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240131 15:11:19.463016 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
========== Step 69 ========== 
E20240131 15:11:20.463069 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
W20240131 15:11:20.540601 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
========== Step 70 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.968 us                | 437.028 us                |
| GenInput                  | 108.554 ms                | 130.368 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 6.674 ms                  | 23.133 ms                 |
| Optimize                  | 372.171 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 10.703 ms                 |
| AfterBackward             | 792.876 ms                | 1.652 s                   |
| BlockToStepN              | 214.243 us                | 492.749 us                |
| OneStep                   | 918.010 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:21.463013 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=155
W20240131 15:11:21.832571 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 71 ========== 
E20240131 15:11:22.463157 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=69
W20240131 15:11:22.724771 15308 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
W20240131 15:11:22.854676 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 73 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 270.605 us                | 50.970 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 1.480 s                   |
| ProcessBack:UpdateCache   | 2.337 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 69.214 us                 | 107.972 us                |
| ProcessOneStep            | 792.841 ms                | 1.652 s                   |
| BlockToStepN              | 124.458 us                | 331.504 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:23.463148 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=282
========== Step 74 ========== 
W20240131 15:11:24.216660 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 75 ========== 
E20240131 15:11:24.463594 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
========== Step 76 ========== 
E20240131 15:11:25.463070 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=201
W20240131 15:11:25.722883 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
========== Step 77 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 209.021 us                | 437.028 us                |
| GenInput                  | 109.448 ms                | 130.449 ms                |
| NN                        | 1.401 ms                  | 26.601 ms                 |
| Forward                   | 1.968 ms                  | 27.508 ms                 |
| Backward                  | 7.211 ms                  | 23.133 ms                 |
| Optimize                  | 365.019 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 764.069 ms                | 1.652 s                   |
| BlockToStepN              | 228.351 us                | 492.749 us                |
| OneStep                   | 893.668 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 79 ========== 
E20240131 15:11:26.476450 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=89
W20240131 15:11:26.885622 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 15:11:27.476047 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
W20240131 15:11:27.738462 15308 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 278.844 us                | 54.546 ms                 |
| ProcessBack:Shuffle       | 757.529 ms                | 1.480 s                   |
| ProcessBack:UpdateCache   | 2.277 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 68.624 us                 | 107.972 us                |
| ProcessOneStep            | 764.012 ms                | 1.652 s                   |
| BlockToStepN              | 132.129 us                | 331.504 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:28.108275 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240131 15:11:28.476660 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=270
W20240131 15:11:29.311921 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240131 15:11:29.477320 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=85
========== Step 81 ========== 
E20240131 15:11:30.477246 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=110
W20240131 15:11:30.518829 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240131 15:11:30.694213 15308 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.781 us                | 437.028 us                |
| GenInput                  | 109.191 ms                | 130.449 ms                |
| NN                        | 1.418 ms                  | 26.601 ms                 |
| Forward                   | 1.970 ms                  | 27.508 ms                 |
| Backward                  | 7.211 ms                  | 23.133 ms                 |
| Optimize                  | 366.926 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 764.069 ms                | 2.328 s                   |
| BlockToStepN              | 236.227 us                | 492.749 us                |
| OneStep                   | 893.668 ms                | 2.473 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:31.477681 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=138
W20240131 15:11:31.803817 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240131 15:11:32.477190 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
========== Step 83 ========== 
W20240131 15:11:33.074532 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 215.467 us                | 43.908 ms                 |
| ProcessBack:Shuffle       | 761.461 ms                | 1.743 s                   |
| ProcessBack:UpdateCache   | 2.284 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.810 us                 | 107.972 us                |
| ProcessOneStep            | 785.618 ms                | 2.328 s                   |
| BlockToStepN              | 134.008 us                | 331.504 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:33.477066 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=162
========== Step 84 ========== 
W20240131 15:11:34.320379 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240131 15:11:34.477028 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
========== Step 85 ========== 
E20240131 15:11:35.477125 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=40
W20240131 15:11:35.650128 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240131 15:11:36.206178 15308 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.781 us                | 437.028 us                |
| GenInput                  | 109.191 ms                | 130.487 ms                |
| NN                        | 1.427 ms                  | 26.601 ms                 |
| Forward                   | 1.992 ms                  | 27.508 ms                 |
| Backward                  | 6.674 ms                  | 23.133 ms                 |
| Optimize                  | 365.019 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 237.356 us                | 632.742 us                |
| OneStep                   | 918.010 ms                | 2.473 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:36.477335 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
E20240131 15:11:37.477715 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=284
W20240131 15:11:37.577562 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240131 15:11:37.940711 15308 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 194.617 us                | 43.656 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 1.743 s                   |
| ProcessBack:UpdateCache   | 2.284 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.810 us                 | 107.972 us                |
| ProcessOneStep            | 792.841 ms                | 2.328 s                   |
| BlockToStepN              | 135.797 us                | 527.395 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:38.477083 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=85
W20240131 15:11:39.347292 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 15:11:39.477337 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:11:40.169975 15308 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
E20240131 15:11:40.477129 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=74
W20240131 15:11:40.527662 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 109.448 ms                | 130.487 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 7.327 ms                  | 23.133 ms                 |
| Optimize                  | 365.019 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.781 ms                  | 13.956 ms                 |
| AfterBackward             | 792.876 ms                | 2.328 s                   |
| BlockToStepN              | 241.293 us                | 632.742 us                |
| OneStep                   | 918.419 ms                | 2.473 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 89 ========== 
E20240131 15:11:41.477141 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
W20240131 15:11:41.528707 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 90 ========== 
E20240131 15:11:42.477735 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 91 ========== 
W20240131 15:11:42.890226 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 239.525 us                | 47.885 ms                 |
| ProcessBack:Shuffle       | 790.647 ms                | 2.102 s                   |
| ProcessBack:UpdateCache   | 2.277 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.441 us                 | 107.972 us                |
| ProcessOneStep            | 801.055 ms                | 2.328 s                   |
| BlockToStepN              | 137.323 us                | 527.395 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 92 ========== 
E20240131 15:11:43.488078 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 15:11:44.375008 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240131 15:11:44.489218 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=139
========== Step 93 ========== 
========== Step 94 ========== 
E20240131 15:11:45.489118 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=131
========== Step 95 ========== 
W20240131 15:11:45.984934 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 96 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 110.270 ms                | 133.375 ms                |
| NN                        | 1.427 ms                  | 26.601 ms                 |
| Forward                   | 1.999 ms                  | 27.508 ms                 |
| Backward                  | 7.327 ms                  | 23.133 ms                 |
| Optimize                  | 356.197 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.834 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 258.055 us                | 829.239 us                |
| OneStep                   | 918.010 ms                | 2.473 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:46.489020 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=249
W20240131 15:11:47.258299 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240131 15:11:47.489006 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 270.038 us                | 51.855 ms                 |
| ProcessBack:Shuffle       | 779.690 ms                | 2.102 s                   |
| ProcessBack:UpdateCache   | 2.268 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.212 us                 | 107.972 us                |
| ProcessOneStep            | 785.618 ms                | 2.328 s                   |
| BlockToStepN              | 139.300 us                | 682.350 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 97 ========== 
E20240131 15:11:48.504379 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:11:48.508183 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
W20240131 15:11:48.840536 15308 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
E20240131 15:11:49.504060 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
========== Step 99 ========== 
W20240131 15:11:49.915783 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
E20240131 15:11:50.504133 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=113
Step99:rank0, time: 114.482, per_step: 1.144820
Step99:rank2, time: 114.482, per_step: 1.144821
Step99:rank3, time: 114.482, per_step: 1.144824
Step99:rank5, time: 114.482, per_step: 1.144825
Step99:rank4, time: 114.482, per_step: 1.144823
Step99:rank1, time: 114.482, per_step: 1.144823
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 110.270 ms                | 133.375 ms                |
| NN                        | 1.427 ms                  | 26.601 ms                 |
| Forward                   | 1.999 ms                  | 27.508 ms                 |
| Backward                  | 7.497 ms                  | 23.133 ms                 |
| Optimize                  | 356.197 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.781 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 263.414 us                | 1.014 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240131 15:11:50.928203 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 110.270 ms                | 133.375 ms                |
| NN                        | 1.427 ms                  | 26.601 ms                 |
| Forward                   | 1.999 ms                  | 27.508 ms                 |
| Backward                  | 7.509 ms                  | 23.133 ms                 |
| Optimize                  | 356.197 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.781 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 263.414 us                | 1.014 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:51.504137 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=93
========== Step 101 ========== 
W20240131 15:11:52.121034 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240131 15:11:52.504566 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=117
========== Step 102 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 5.677 ms                  | 62.034 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.277 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.212 us                 | 107.972 us                |
| ProcessOneStep            | 792.841 ms                | 2.328 s                   |
| BlockToStepN              | 147.024 us                | 682.350 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:53.171808 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 103 ========== 
E20240131 15:11:53.512140 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:11:54.190863 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240131 15:11:54.512099 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
W20240131 15:11:55.281219 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240131 15:11:55.513149 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
W20240131 15:11:55.563741 15308 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 212.764 us                | 437.028 us                |
| GenInput                  | 110.270 ms                | 133.375 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 8.237 ms                  | 23.133 ms                 |
| Optimize                  | 362.158 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 792.876 ms                | 2.328 s                   |
| BlockToStepN              | 267.050 us                | 1.014 ms                  |
| OneStep                   | 918.419 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 15:11:56.344069 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 15:11:56.537724 15308 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
E20240131 15:11:56.557416 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 15:11:57.417927 15308 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
W20240131 15:11:57.440532 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 15:11:57.557008 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=211
========== Step 107 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 363.259 us                | 53.326 ms                 |
| ProcessBack:Shuffle       | 783.089 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.277 ms                  | 17.780 ms                 |
| ProcessBack:UpsertPq      | 67.441 us                 | 107.972 us                |
| ProcessOneStep            | 792.841 ms                | 2.328 s                   |
| BlockToStepN              | 147.539 us                | 682.350 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:11:58.557011 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
W20240131 15:11:58.584429 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 15:11:59.217098 15308 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
W20240131 15:11:59.463029 15308 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
E20240131 15:11:59.560209 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=55
W20240131 15:11:59.617417 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 110 ========== 
E20240131 15:12:00.560107 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=158
W20240131 15:12:00.761396 15308 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
W20240131 15:12:01.020184 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 109.542 ms                | 133.375 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 7.723 ms                  | 23.133 ms                 |
| Optimize                  | 356.197 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.683 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 276.310 us                | 1.014 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 112 ========== 
E20240131 15:12:01.571264 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
========== Step 113 ========== 
W20240131 15:12:02.281253 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240131 15:12:02.571208 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
========== Step 114 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 229.287 us                | 50.663 ms                 |
| ProcessBack:Shuffle       | 761.461 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.257 ms                  | 18.455 ms                 |
| ProcessBack:UpsertPq      | 67.212 us                 | 107.972 us                |
| ProcessOneStep            | 781.888 ms                | 2.328 s                   |
| BlockToStepN              | 155.379 us                | 792.242 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:12:03.481448 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240131 15:12:03.571235 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=189
E20240131 15:12:04.571038 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
W20240131 15:12:04.908563 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 115 ========== 
E20240131 15:12:05.571146 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=82
W20240131 15:12:05.954360 16454 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 109.191 ms                | 133.375 ms                |
| NN                        | 1.427 ms                  | 26.601 ms                 |
| Forward                   | 2.003 ms                  | 27.508 ms                 |
| Backward                  | 8.237 ms                  | 23.133 ms                 |
| Optimize                  | 351.429 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 278.451 us                | 1.014 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 15:12:06.471628 15308 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
E20240131 15:12:06.571187 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=139
========== Step 117 ========== 
W20240131 15:12:07.200521 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 15:12:07.571044 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 253.191 us                | 48.099 ms                 |
| ProcessBack:Shuffle       | 779.690 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.257 ms                  | 18.455 ms                 |
| ProcessBack:UpsertPq      | 67.212 us                 | 107.972 us                |
| ProcessOneStep            | 785.618 ms                | 2.328 s                   |
| BlockToStepN              | 157.113 us                | 792.242 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 15:12:08.212857 15308 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
W20240131 15:12:08.224478 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 15:12:08.571375 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=312
W20240131 15:12:09.271384 15308 grad_async_v2.h:257] pq is empty
W20240131 15:12:09.288761 16454 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 119 ========== 
E20240131 15:12:09.571030 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=204
W20240131 15:12:10.176854 15308 grad_async_v2.h:257] pq is empty
========== Step 120 ========== 
W20240131 15:12:10.405251 16454 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 121 ========== 
E20240131 15:12:10.571019 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.957 us                | 437.028 us                |
| GenInput                  | 108.255 ms                | 133.375 ms                |
| NN                        | 1.420 ms                  | 26.601 ms                 |
| Forward                   | 1.999 ms                  | 27.508 ms                 |
| Backward                  | 8.827 ms                  | 23.133 ms                 |
| Optimize                  | 346.422 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.764 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 282.078 us                | 1.014 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 15:12:11.525557 16454 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 15:12:11.571133 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=202
========== Step 122 ========== 
========== Step 123 ========== 
E20240131 15:12:12.571046 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=90
W20240131 15:12:12.604332 16454 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 297.980 us                | 48.206 ms                 |
| ProcessBack:Shuffle       | 779.690 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.256 ms                  | 18.455 ms                 |
| ProcessBack:UpsertPq      | 67.085 us                 | 107.972 us                |
| ProcessOneStep            | 785.618 ms                | 2.328 s                   |
| BlockToStepN              | 162.250 us                | 874.843 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 15:12:13.571342 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=114
W20240131 15:12:13.712903 16454 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 15:12:13.914626 15308 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
========== Step 125 ========== 
E20240131 15:12:14.571060 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
W20240131 15:12:14.935890 16454 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 126 ========== 
E20240131 15:12:15.571039 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=140
W20240131 15:12:15.942015 16454 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 127 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.594 us                | 437.028 us                |
| GenInput                  | 108.255 ms                | 133.375 ms                |
| NN                        | 1.432 ms                  | 26.601 ms                 |
| Forward                   | 2.004 ms                  | 27.508 ms                 |
| Backward                  | 8.916 ms                  | 23.133 ms                 |
| Optimize                  | 351.429 us                | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 1.781 ms                  | 13.956 ms                 |
| AfterBackward             | 785.741 ms                | 2.328 s                   |
| BlockToStepN              | 284.705 us                | 1.329 ms                  |
| OneStep                   | 918.010 ms                | 2.473 s                   |
| E2E-100                   | 96.402 s                  | 96.402 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 15:12:16.571035 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
========== Step 128 ========== 
W20240131 15:12:17.068224 16454 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 129 ========== 
E20240131 15:12:17.571226 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 3.916 ms                  | 47.694 ms                 |
| ProcessBack:Shuffle       | 778.846 ms                | 2.235 s                   |
| ProcessBack:UpdateCache   | 2.257 ms                  | 18.455 ms                 |
| ProcessBack:UpsertPq      | 67.212 us                 | 126.054 us                |
| ProcessOneStep            | 781.888 ms                | 2.328 s                   |
| BlockToStepN              | 170.664 us                | 1.098 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 15:12:18.207870 16454 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 15:12:18.571308 16454 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
W20240131 15:12:19.246670 15308 grad_async_v2.h:257] pq is empty
Successfully xmh
W20240131 15:12:19.246987 15308 grad_async_v2.h:84] call StopThreads. PID = 15308
W20240131 15:12:19.247000 15308 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 15:12:19.247045 15308 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 15:12:19.247053 15308 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240131 15:12:19.298110 15308 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
