WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 16:07:52.431694 25962 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 16:07:52.440991 25962 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [25962 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f47115e99e0>==========
Worker 1 pid=26118
Worker 2 pid=26119
Worker 3 pid=26120
Worker 4 pid=26121
Worker 5 pid=26122
Worker 6 pid=26123
INFO [25962 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26118 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26119 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26120 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [26123 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26121 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [26122 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26124 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [26123 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26121 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26119 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26122 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26118 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26124 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26120 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 16:08:09.385525 26123 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385581 26119 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385584 26121 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385601 26122 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385653 26124 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385663 26118 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:08:09.385797 26120 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [25962 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 16:08:09.388772 25962 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 16:08:28.083616 26119 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240131 16:08:28.084935 26121 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1688128, 32]; dev=4; size=206.1 MB
W20240131 16:08:28.084959 26123 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1688128, 32]; dev=6; size=206.1 MB
W20240131 16:08:28.085363 26120 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240131 16:08:28.086561 26122 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1688128, 32]; dev=5; size=206.1 MB
W20240131 16:08:28.086714 26118 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240131 16:08:28.086817 25962 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240131 16:08:28.093447 26124 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1688128, 32]; dev=7; size=206.1 MB
W20240131 16:08:28.845244 26123 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10010196e000 7.629 MB
W20240131 16:08:28.845434 26123 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100102111000 7.629 MB
W20240131 16:08:28.845496 26123 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x1001028b4000 122.1 MB
W20240131 16:08:28.845551 26123 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x10010a2c8000 122.1 MB
W20240131 16:08:28.845593 26123 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 16:08:28.849210 26123 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 16:08:28.861709 26121 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100111ce2000 7.629 MB
W20240131 16:08:28.861867 26121 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100112485000 7.629 MB
W20240131 16:08:28.861924 26121 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x100112c28000 122.1 MB
W20240131 16:08:28.861976 26121 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x10011a63c000 122.1 MB
W20240131 16:08:28.862021 26121 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 16:08:28.862594 26121 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 16:08:28.918367 26120 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100122056000 7.629 MB
W20240131 16:08:28.918581 26120 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001227f9000 7.629 MB
W20240131 16:08:28.918660 26120 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100122f9c000 122.1 MB
W20240131 16:08:28.918715 26120 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10012a9b0000 122.1 MB
W20240131 16:08:28.918759 26120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:08:28.919813 26120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:08:28.921978 26119 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1001323ca000 7.629 MB
W20240131 16:08:28.922194 26119 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100132b6d000 7.629 MB
W20240131 16:08:28.922286 26119 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100133310000 122.1 MB
W20240131 16:08:28.922362 26119 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10013ad24000 122.1 MB
W20240131 16:08:28.922430 26119 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:08:28.938421 26119 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:08:28.939775 25962 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10014273e000 7.629 MB
W20240131 16:08:28.939962 25962 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100142ee3000 7.629 MB
W20240131 16:08:28.940040 25962 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100143e29000 122.1 MB
W20240131 16:08:28.940038 26118 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100143686000 7.629 MB
W20240131 16:08:28.940119 25962 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10014b83d000 122.1 MB
W20240131 16:08:28.940160 25962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 16:08:28.940201 26118 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100153251000 7.629 MB
W20240131 16:08:28.940259 26118 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001539f4000 122.1 MB
W20240131 16:08:28.940310 26118 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10015b408000 122.1 MB
W20240131 16:08:28.940351 26118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:08:28.942204 25962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 16:08:28.942220 26118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:08:28.950191 26122 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100162e26000 7.629 MB
W20240131 16:08:28.950349 26122 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1001635c9000 7.629 MB
W20240131 16:08:28.950407 26122 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x100163d6c000 122.1 MB
W20240131 16:08:28.950464 26122 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x10016b780000 122.1 MB
W20240131 16:08:28.950511 26122 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 16:08:28.951247 26122 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 16:08:28.955089 26124 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10017319a000 7.629 MB
W20240131 16:08:28.955252 26124 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10017393d000 7.629 MB
W20240131 16:08:28.955319 26124 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1001740e0000 122.1 MB
W20240131 16:08:28.955374 26124 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10017baf4000 122.1 MB
W20240131 16:08:28.955417 26124 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 16:08:28.955775 26124 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
Worker 7 pid=26124
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512), (6752512, 8440640), (8440640, 10128768), (10128768, 11816896), (11816896, 13505024)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
W20240131 16:08:36.225598 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10018350c000 7.629 MB
W20240131 16:08:36.225798 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100183caf000 7.629 MB
W20240131 16:08:36.225858 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100184452000 7.629 MB
W20240131 16:08:36.225905 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100184bf5000 7.629 MB
W20240131 16:08:36.225943 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100185398000 7.629 MB
W20240131 16:08:36.225989 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100185b3b000 7.629 MB
W20240131 16:08:36.226042 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1001862de000 7.629 MB
W20240131 16:08:36.226110 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100186a81000 7.629 MB
W20240131 16:08:36.226153 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x100187224000 7.629 MB
W20240131 16:08:36.226204 26119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1001879c7000 7.629 MB
W20240131 16:08:36.226249 26119 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10018816a000 80 B 
W20240131 16:08:36.226287 26119 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10018816c000 8 B 
W20240131 16:08:36.226332 26119 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10018816e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:36.226708 26119 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 16:08:36.228776 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100188170000 7.629 MB
W20240131 16:08:36.228926 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100188913000 7.629 MB
W20240131 16:08:36.228984 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1001890b6000 7.629 MB
W20240131 16:08:36.229035 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100189859000 7.629 MB
W20240131 16:08:36.229081 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100189ffc000 7.629 MB
W20240131 16:08:36.229130 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10018a79f000 7.629 MB
W20240131 16:08:36.229173 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10018af42000 7.629 MB
W20240131 16:08:36.229238 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10018b6e5000 7.629 MB
W20240131 16:08:36.229275 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10018be88000 7.629 MB
W20240131 16:08:36.229321 26121 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10018c62b000 7.629 MB
W20240131 16:08:36.229365 26121 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x10018cdce000 80 B 
W20240131 16:08:36.229400 26121 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10018cdd0000 8 B 
W20240131 16:08:36.229439 26121 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10018cdd2000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:36.229737 26121 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:36.531420 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10018cdd4000 7.629 MB
W20240131 16:08:36.531738 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10018d577000 7.629 MB
W20240131 16:08:36.531813 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10018dd1a000 7.629 MB
W20240131 16:08:36.531872 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10018e4bd000 7.629 MB
W20240131 16:08:36.531916 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10018ec60000 7.629 MB
W20240131 16:08:36.531972 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10018f403000 7.629 MB
W20240131 16:08:36.532017 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10018fba6000 7.629 MB
W20240131 16:08:36.532070 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100190349000 7.629 MB
W20240131 16:08:36.532119 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100190aec000 7.629 MB
W20240131 16:08:36.532169 25962 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10019128f000 7.629 MB
W20240131 16:08:36.532214 25962 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100191a32000 80 B 
W20240131 16:08:36.532250 25962 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100191a34000 8 B 
W20240131 16:08:36.532279 25962 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100191a36000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:36.532738 25962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:36.889533 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100191a38000 7.629 MB
W20240131 16:08:36.889678 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1001921db000 7.629 MB
W20240131 16:08:36.889732 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10019297e000 7.629 MB
W20240131 16:08:36.889781 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100193121000 7.629 MB
W20240131 16:08:36.889822 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1001938c4000 7.629 MB
W20240131 16:08:36.889901 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100194067000 7.629 MB
W20240131 16:08:36.889964 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10019480a000 7.629 MB
W20240131 16:08:36.890031 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100194fad000 7.629 MB
W20240131 16:08:36.890075 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100195750000 7.629 MB
W20240131 16:08:36.890127 26120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100195ef3000 7.629 MB
W20240131 16:08:36.890170 26120 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x100196696000 80 B 
W20240131 16:08:36.890206 26120 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100196698000 8 B 
W20240131 16:08:36.890252 26120 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10019669a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:36.890552 26120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:36.981370 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10019669c000 7.629 MB
W20240131 16:08:36.981508 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100196e3f000 7.629 MB
W20240131 16:08:36.981560 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1001975e2000 7.629 MB
W20240131 16:08:36.981611 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x100197d85000 7.629 MB
W20240131 16:08:36.981650 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100198528000 7.629 MB
W20240131 16:08:36.981707 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100198ccb000 7.629 MB
W20240131 16:08:36.981756 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10019946e000 7.629 MB
W20240131 16:08:36.981822 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x100199c11000 7.629 MB
W20240131 16:08:36.981863 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10019a3b4000 7.629 MB
W20240131 16:08:36.981907 26123 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10019ab57000 7.629 MB
W20240131 16:08:36.981946 26123 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x10019b2fa000 80 B 
W20240131 16:08:36.981982 26123 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10019b2fc000 8 B 
W20240131 16:08:36.982020 26123 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10019b2fe000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:36.982286 26123 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:37.624369 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10019b300000 7.629 MB
W20240131 16:08:37.624562 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10019baa3000 7.629 MB
W20240131 16:08:37.624631 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10019c246000 7.629 MB
W20240131 16:08:37.624680 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10019c9e9000 7.629 MB
W20240131 16:08:37.624724 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10019d18c000 7.629 MB
W20240131 16:08:37.624773 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10019d92f000 7.629 MB
W20240131 16:08:37.624821 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10019e0d2000 7.629 MB
W20240131 16:08:37.624891 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10019e875000 7.629 MB
W20240131 16:08:37.624931 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x10019f018000 7.629 MB
W20240131 16:08:37.624979 26124 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10019f7bb000 7.629 MB
W20240131 16:08:37.625036 26124 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10019ff5e000 80 B 
W20240131 16:08:37.625075 26124 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10019ff60000 8 B 
W20240131 16:08:37.625114 26124 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10019ff62000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:37.625458 26124 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:38.126775 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10019ff64000 7.629 MB
W20240131 16:08:38.126993 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1001a0707000 7.629 MB
W20240131 16:08:38.127058 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1001a0eaa000 7.629 MB
W20240131 16:08:38.127110 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1001a164d000 7.629 MB
W20240131 16:08:38.127152 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1001a1df0000 7.629 MB
W20240131 16:08:38.127207 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1001a2593000 7.629 MB
W20240131 16:08:38.127254 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1001a2d36000 7.629 MB
W20240131 16:08:38.127323 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1001a34d9000 7.629 MB
W20240131 16:08:38.127363 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1001a3c7c000 7.629 MB
W20240131 16:08:38.127413 26122 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1001a441f000 7.629 MB
W20240131 16:08:38.127455 26122 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1001a4bc2000 80 B 
W20240131 16:08:38.127501 26122 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1001a4bc4000 8 B 
W20240131 16:08:38.127542 26122 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1001a4bc6000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:38.127902 26122 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:38.155555 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1001a4bc8000 7.629 MB
W20240131 16:08:38.155714 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1001a536b000 7.629 MB
W20240131 16:08:38.155776 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1001a5b0e000 7.629 MB
W20240131 16:08:38.155830 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1001a62b1000 7.629 MB
W20240131 16:08:38.155871 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1001a6a54000 7.629 MB
W20240131 16:08:38.155920 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1001a71f7000 7.629 MB
W20240131 16:08:38.155972 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1001a799a000 7.629 MB
W20240131 16:08:38.156045 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1001a813d000 7.629 MB
W20240131 16:08:38.156101 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1001a88e0000 7.629 MB
W20240131 16:08:38.156150 26118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1001a9083000 7.629 MB
W20240131 16:08:38.156191 26118 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1001a9826000 80 B 
W20240131 16:08:38.156240 26118 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1001a9828000 8 B 
W20240131 16:08:38.156286 26118 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1001a982a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:08:38.156590 26118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:08:38.159113 25962 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 16:08:38.159430 25962 grad_base.h:184] Init GradProcessingBase done
I20240131 16:08:42.185372 25962 grad_async_v2.h:42] Use main thread to update emb.
W20240131 16:08:42.185765 25962 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 16:08:42.185777 25962 kg_controller.h:84] Construct KGCacheController done
E20240131 16:08:42.956964 26123 recstore.cc:66] init folly done
E20240131 16:08:42.956970 26120 recstore.cc:66] init folly done
E20240131 16:08:42.956969 26118 recstore.cc:66] init folly done
E20240131 16:08:42.956972 26124 recstore.cc:66] init folly done
E20240131 16:08:42.957017 26121 recstore.cc:66] init folly done
E20240131 16:08:42.957034 25962 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 16:08:42.957062 26119 recstore.cc:66] init folly done
E20240131 16:08:42.957063 26122 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 16:08:42.958689 25962 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 16:08:44.123826 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:08:44.124327 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 16:08:45.124017 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 16:08:45.137866 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 16:08:46.124019 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:08:46.168216 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:08:47.124034 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 16:08:47.187490 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.661 us                | 13.286 ms                 |
+---------------------------+---------------------------+---------------------------+
Before Training
Before Training
Before Training
I20240131 16:08:48.554663 26123 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240131 16:08:48.554818 26121 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240131 16:08:48.554931 26119 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:08:48.554963 25962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:08:48.554999 26122 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:08:48.555048 26120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:08:48.555081 26118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 16:08:48.556239 26124 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240131 16:08:48.558574 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:08:48.558686 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 0 ========== 
E20240131 16:08:50.167569 26990 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:08:50.359769 25962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240131 16:08:50.530324 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
INFO [26121 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26119 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26123 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26122 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26120 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [25962 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26118 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [26124 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
E20240131 16:08:51.167008 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=286
========== Step 4 ========== 
W20240131 16:08:51.638123 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
W20240131 16:08:51.669389 25962 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
========== Step 6 ========== 
E20240131 16:08:52.167016 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5976
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
W20240131 16:08:52.933787 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 174.328 us                | 35.971 ms                 |
| ProcessBack:Shuffle       | 252.510 ms                | 311.615 ms                |
| ProcessBack:UpdateCache   | 18.155 ms                 | 859.274 ms                |
| ProcessBack:UpsertPq      | 63.189 us                 | 192.702 ms                |
| ProcessOneStep            | 270.092 ms                | 1.375 s                   |
| BlockToStepN              | 52.232 us                 | 169.458 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 10 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.867 us                | 12.772 ms                 |
| GenInput                  | 1.223 ms                  | 15.105 ms                 |
| NN                        | 1.265 ms                  | 192.554 ms                |
| Forward                   | 1.789 ms                  | 252.051 ms                |
| Backward                  | 3.759 ms                  | 153.422 ms                |
| Optimize                  | 387.430 us                | 4.902 ms                  |
| BarrierTimeBeforeRank0    | 1.033 ms                  | 13.093 ms                 |
| AfterBackward             | 268.923 ms                | 1.375 s                   |
| BlockToStepN              | 146.152 us                | 169.940 ms                |
| OneStep                   | 276.434 ms                | 1.973 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:08:53.167007 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2925
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
E20240131 16:08:54.176426 26870 parallel_pq_v2.h:79] insert failed, size(hashtable)=100
W20240131 16:08:54.249303 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
E20240131 16:08:55.184312 26865 parallel_pq_v2.h:79] insert failed, size(hashtable)=512
E20240131 16:08:55.195425 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=17, sample_step_cpp_seen_[rank]=16
W20240131 16:08:55.256125 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240131 16:08:56.184139 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:08:56.269531 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
========== Step 18 ========== 
========== Step 19 ========== 
E20240131 16:08:57.184188 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2042
========== Step 20 ========== 
W20240131 16:08:57.281675 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
========== Step 21 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 190.527 us                | 31.844 ms                 |
| ProcessBack:Shuffle       | 245.658 ms                | 311.615 ms                |
| ProcessBack:UpdateCache   | 18.155 ms                 | 859.274 ms                |
| ProcessBack:UpsertPq      | 70.310 us                 | 192.702 ms                |
| ProcessOneStep            | 265.152 ms                | 1.925 s                   |
| BlockToStepN              | 89.091 us                 | 169.458 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.920 us                | 12.772 ms                 |
| GenInput                  | 996.052 us                | 15.105 ms                 |
| NN                        | 1.233 ms                  | 192.554 ms                |
| Forward                   | 1.723 ms                  | 252.051 ms                |
| Backward                  | 3.512 ms                  | 153.422 ms                |
| Optimize                  | 381.947 us                | 4.902 ms                  |
| BarrierTimeBeforeRank0    | 762.539 us                | 13.093 ms                 |
| AfterBackward             | 265.758 ms                | 1.926 s                   |
| BlockToStepN              | 195.131 us                | 169.940 ms                |
| OneStep                   | 276.434 ms                | 1.973 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:08:58.184006 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1767
W20240131 16:08:58.328121 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
E20240131 16:08:59.196079 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 28 ========== 
W20240131 16:08:59.645700 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
========== Step 29 ========== 
========== Step 30 ========== 
E20240131 16:09:00.196029 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1257
========== Step 31 ========== 
========== Step 32 ========== 
W20240131 16:09:00.686787 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
========== Step 33 ========== 
========== Step 34 ========== 
E20240131 16:09:01.196252 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2133
========== Step 35 ========== 
E20240131 16:09:01.519652 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=35, sample_step_cpp_seen_[rank]=34
W20240131 16:09:01.844373 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240131 16:09:02.196017 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240131 16:09:02.848738 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 195.614 us                | 438.163 us                |
| ProcessBack:Shuffle       | 245.658 ms                | 311.615 ms                |
| ProcessBack:UpdateCache   | 17.922 ms                 | 859.274 ms                |
| ProcessBack:UpsertPq      | 70.310 us                 | 192.702 ms                |
| ProcessOneStep            | 265.152 ms                | 1.925 s                   |
| BlockToStepN              | 118.265 us                | 169.458 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 150.347 us                | 12.772 ms                 |
| GenInput                  | 996.052 us                | 15.105 ms                 |
| NN                        | 1.233 ms                  | 192.554 ms                |
| Forward                   | 1.723 ms                  | 252.051 ms                |
| Backward                  | 3.402 ms                  | 153.422 ms                |
| Optimize                  | 333.071 us                | 4.902 ms                  |
| BarrierTimeBeforeRank0    | 772.713 us                | 13.093 ms                 |
| AfterBackward             | 265.209 ms                | 1.926 s                   |
| BlockToStepN              | 203.364 us                | 169.940 ms                |
| OneStep                   | 274.502 ms                | 1.973 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:03.196152 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1425
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
W20240131 16:09:03.935420 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
========== Step 40 ========== 
E20240131 16:09:04.196012 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=797
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
W20240131 16:09:04.941512 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
========== Step 44 ========== 
E20240131 16:09:05.196692 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=944
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
W20240131 16:09:06.029517 25962 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
E20240131 16:09:06.196015 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2670
W20240131 16:09:06.239116 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
W20240131 16:09:07.125017 25962 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
E20240131 16:09:07.196115 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=139
W20240131 16:09:07.387575 25962 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
W20240131 16:09:07.391042 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 54 ========== 
E20240131 16:09:07.931236 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=54, sample_step_cpp_seen_[rank]=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.220 us                | 39.879 ms                 |
| ProcessBack:Shuffle       | 245.160 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.922 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 67.152 us                 | 296.626 us                |
| ProcessOneStep            | 263.559 ms                | 1.761 s                   |
| BlockToStepN              | 120.591 us                | 649.670 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.920 us                | 2.333 ms                  |
| GenInput                  | 983.208 us                | 13.438 ms                 |
| NN                        | 1.206 ms                  | 7.820 ms                  |
| Forward                   | 1.603 ms                  | 12.189 ms                 |
| Backward                  | 3.335 ms                  | 12.375 ms                 |
| Optimize                  | 319.004 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 799.207 us                | 1.850 ms                  |
| AfterBackward             | 263.590 ms                | 1.761 s                   |
| BlockToStepN              | 203.364 us                | 897.257 us                |
| OneStep                   | 273.223 ms                | 1.941 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:08.196019 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:09:08.546829 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240131 16:09:09.196617 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 55 ========== 
W20240131 16:09:09.577381 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 56 ========== 
========== Step 57 ========== 
E20240131 16:09:10.196336 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=543
========== Step 58 ========== 
========== Step 59 ========== 
W20240131 16:09:10.540762 25962 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
========== Step 61 ========== 
W20240131 16:09:10.876616 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
========== Step 62 ========== 
========== Step 63 ========== 
E20240131 16:09:11.196141 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
W20240131 16:09:12.167650 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240131 16:09:12.204216 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=81
========== Step 67 ========== 
W20240131 16:09:12.580636 25962 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
W20240131 16:09:12.836237 25962 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 171.629 us                | 39.762 ms                 |
| ProcessBack:Shuffle       | 245.160 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 63.890 us                 | 296.626 us                |
| ProcessOneStep            | 264.044 ms                | 1.784 s                   |
| BlockToStepN              | 143.771 us                | 649.670 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 70 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 141.677 us                | 2.333 ms                  |
| GenInput                  | 983.208 us                | 13.438 ms                 |
| NN                        | 1.178 ms                  | 7.820 ms                  |
| Forward                   | 1.591 ms                  | 12.189 ms                 |
| Backward                  | 3.335 ms                  | 12.375 ms                 |
| Optimize                  | 317.574 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 822.418 us                | 1.850 ms                  |
| AfterBackward             | 264.074 ms                | 1.784 s                   |
| BlockToStepN              | 253.196 us                | 897.257 us                |
| OneStep                   | 273.223 ms                | 1.941 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:13.204182 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
E20240131 16:09:13.395362 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=70, sample_step_cpp_seen_[rank]=69
W20240131 16:09:13.395797 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 16:09:14.204102 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:09:14.600091 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 71 ========== 
========== Step 72 ========== 
E20240131 16:09:15.204604 26890 parallel_pq_v2.h:79] insert failed, size(hashtable)=759
========== Step 73 ========== 
W20240131 16:09:15.641737 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 74 ========== 
========== Step 75 ========== 
E20240131 16:09:16.212425 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=73
W20240131 16:09:16.215526 25962 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
W20240131 16:09:16.824311 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 79 ========== 
E20240131 16:09:17.212039 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=449
========== Step 80 ========== 
========== Step 81 ========== 
W20240131 16:09:17.861222 25962 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
W20240131 16:09:17.915925 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.536 us                | 32.211 ms                 |
| ProcessBack:Shuffle       | 245.658 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 65.007 us                 | 296.626 us                |
| ProcessOneStep            | 264.044 ms                | 1.784 s                   |
| BlockToStepN              | 172.165 us                | 649.670 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 83 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.920 us                | 2.333 ms                  |
| GenInput                  | 994.580 us                | 13.438 ms                 |
| NN                        | 1.153 ms                  | 7.820 ms                  |
| Forward                   | 1.583 ms                  | 12.189 ms                 |
| Backward                  | 3.317 ms                  | 12.375 ms                 |
| Optimize                  | 320.911 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 793.381 us                | 1.850 ms                  |
| AfterBackward             | 264.074 ms                | 1.784 s                   |
| BlockToStepN              | 265.092 us                | 983.193 us                |
| OneStep                   | 273.223 ms                | 1.941 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:18.212100 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=528
========== Step 84 ========== 
========== Step 85 ========== 
W20240131 16:09:18.923559 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
========== Step 86 ========== 
W20240131 16:09:19.203639 25962 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
E20240131 16:09:19.212153 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
E20240131 16:09:20.212278 26863 parallel_pq_v2.h:79] insert failed, size(hashtable)=1025
W20240131 16:09:20.269399 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 16:09:20.367808 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=90, sample_step_cpp_seen_[rank]=89
E20240131 16:09:21.212574 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:09:21.350948 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
========== Step 91 ========== 
E20240131 16:09:22.212173 26896 parallel_pq_v2.h:79] insert failed, size(hashtable)=879
========== Step 92 ========== 
W20240131 16:09:22.440699 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 93 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.852 us                | 31.700 ms                 |
| ProcessBack:Shuffle       | 246.612 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.163 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 66.677 us                 | 296.626 us                |
| ProcessOneStep            | 264.378 ms                | 1.888 s                   |
| BlockToStepN              | 180.548 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 95 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 141.677 us                | 2.333 ms                  |
| GenInput                  | 997.949 us                | 13.438 ms                 |
| NN                        | 1.153 ms                  | 7.820 ms                  |
| Forward                   | 1.583 ms                  | 12.189 ms                 |
| Backward                  | 3.327 ms                  | 12.375 ms                 |
| Optimize                  | 324.965 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 790.505 us                | 1.850 ms                  |
| AfterBackward             | 264.971 ms                | 1.888 s                   |
| BlockToStepN              | 280.607 us                | 3.296 ms                  |
| OneStep                   | 273.375 ms                | 1.941 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:23.212335 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=512
========== Step 96 ========== 
W20240131 16:09:23.582172 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240131 16:09:23.598559 25962 grad_async_v2.h:257] pq is empty
========== Step 97 ========== 
W20240131 16:09:23.754936 25962 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
========== Step 99 ========== 
E20240131 16:09:24.212139 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=257
Step99:rank0, time: 53.791, per_step: 0.537912
Step99:rank4, time: 53.791, per_step: 0.537913
Step99:rank5, time: 53.791, per_step: 0.537913
Step99:rank3, time: 53.791, per_step: 0.537914
Step99:rank6, time: 53.791, per_step: 0.537914
Step99:rank2, time: 53.791, per_step: 0.537913
Step99:rank7, time: 53.791, per_step: 0.537913
Step99:rank1, time: 53.791, per_step: 0.537915
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.867 us                | 2.333 ms                  |
| GenInput                  | 994.580 us                | 13.438 ms                 |
| NN                        | 1.151 ms                  | 7.820 ms                  |
| Forward                   | 1.552 ms                  | 12.189 ms                 |
| Backward                  | 3.317 ms                  | 12.375 ms                 |
| Optimize                  | 325.203 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 774.935 us                | 1.850 ms                  |
| AfterBackward             | 264.551 ms                | 1.888 s                   |
| BlockToStepN              | 284.321 us                | 3.296 ms                  |
| OneStep                   | 273.266 ms                | 1.941 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 101 ========== 
W20240131 16:09:24.760576 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
========== Step 102 ========== 
========== Step 103 ========== 
W20240131 16:09:25.168874 25962 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
E20240131 16:09:25.212126 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=129
========== Step 105 ========== 
========== Step 106 ========== 
E20240131 16:09:25.997130 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=106, sample_step_cpp_seen_[rank]=105
W20240131 16:09:26.003127 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 16:09:26.212078 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:09:27.081833 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240131 16:09:27.212014 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.097 us                | 25.755 ms                 |
| ProcessBack:Shuffle       | 246.630 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.025 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 66.399 us                 | 296.626 us                |
| ProcessOneStep            | 264.939 ms                | 1.888 s                   |
| BlockToStepN              | 197.706 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 110 ========== 
W20240131 16:09:28.095500 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 140.867 us                | 2.333 ms                  |
| GenInput                  | 994.580 us                | 13.438 ms                 |
| NN                        | 1.154 ms                  | 7.820 ms                  |
| Forward                   | 1.583 ms                  | 12.189 ms                 |
| Backward                  | 3.317 ms                  | 12.375 ms                 |
| Optimize                  | 327.349 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 769.417 us                | 1.850 ms                  |
| AfterBackward             | 264.551 ms                | 1.888 s                   |
| BlockToStepN              | 288.903 us                | 3.296 ms                  |
| OneStep                   | 273.223 ms                | 1.941 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:28.212020 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1012
========== Step 111 ========== 
W20240131 16:09:28.559692 25962 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
W20240131 16:09:29.108422 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240131 16:09:29.212013 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=196
========== Step 115 ========== 
W20240131 16:09:29.591959 25962 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
W20240131 16:09:29.854696 25962 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
W20240131 16:09:30.113022 25962 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
W20240131 16:09:30.204439 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240131 16:09:30.212028 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=619
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
E20240131 16:09:31.216095 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 123 ========== 
W20240131 16:09:31.622090 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 124 ========== 
E20240131 16:09:32.001013 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=124, sample_step_cpp_seen_[rank]=123
E20240131 16:09:32.216166 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=72
W20240131 16:09:32.748534 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.127 us                | 310.784 us                |
| ProcessBack:Shuffle       | 246.378 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.334 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 63.890 us                 | 296.626 us                |
| ProcessOneStep            | 264.378 ms                | 1.888 s                   |
| BlockToStepN              | 214.798 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 139.912 us                | 2.333 ms                  |
| GenInput                  | 983.208 us                | 13.438 ms                 |
| NN                        | 1.140 ms                  | 7.820 ms                  |
| Forward                   | 1.534 ms                  | 12.189 ms                 |
| Backward                  | 3.259 ms                  | 12.375 ms                 |
| Optimize                  | 327.349 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 774.935 us                | 1.850 ms                  |
| AfterBackward             | 264.551 ms                | 1.888 s                   |
| BlockToStepN              | 299.699 us                | 3.296 ms                  |
| OneStep                   | 273.223 ms                | 1.941 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:33.216032 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:09:33.790822 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240131 16:09:34.216025 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:09:35.045518 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
E20240131 16:09:35.224087 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
W20240131 16:09:36.088974 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240131 16:09:36.224195 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=524
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
E20240131 16:09:37.224022 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=86
W20240131 16:09:37.228304 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
W20240131 16:09:37.294554 25962 grad_async_v2.h:257] pq is empty
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 152.522 us                | 32.044 ms                 |
| ProcessBack:Shuffle       | 246.378 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 65.328 us                 | 296.626 us                |
| ProcessOneStep            | 264.378 ms                | 1.925 s                   |
| BlockToStepN              | 223.880 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 136 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 139.912 us                | 2.333 ms                  |
| GenInput                  | 983.208 us                | 13.438 ms                 |
| NN                        | 1.153 ms                  | 7.820 ms                  |
| Forward                   | 1.549 ms                  | 12.189 ms                 |
| Backward                  | 3.242 ms                  | 12.375 ms                 |
| Optimize                  | 324.965 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 769.417 us                | 1.850 ms                  |
| AfterBackward             | 264.551 ms                | 1.926 s                   |
| BlockToStepN              | 311.473 us                | 3.296 ms                  |
| OneStep                   | 273.266 ms                | 1.973 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:38.224010 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=73
W20240131 16:09:38.315265 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
E20240131 16:09:39.187238 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=139, sample_step_cpp_seen_[rank]=138
E20240131 16:09:39.224148 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:09:39.578181 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 16:09:40.224013 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:09:40.823601 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
========== Step 140 ========== 
E20240131 16:09:41.224113 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=350
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
W20240131 16:09:41.882967 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
W20240131 16:09:42.092974 25962 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
E20240131 16:09:42.224473 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=112
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.736 us                | 31.843 ms                 |
| ProcessBack:Shuffle       | 246.378 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.922 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 65.166 us                 | 296.626 us                |
| ProcessOneStep            | 264.378 ms                | 2.089 s                   |
| BlockToStepN              | 239.816 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:09:42.979059 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 137.823 us                | 2.333 ms                  |
| GenInput                  | 933.792 us                | 13.438 ms                 |
| NN                        | 1.154 ms                  | 7.820 ms                  |
| Forward                   | 1.552 ms                  | 12.189 ms                 |
| Backward                  | 3.179 ms                  | 14.163 ms                 |
| Optimize                  | 323.772 us                | 1.431 ms                  |
| BarrierTimeBeforeRank0    | 767.106 us                | 1.850 ms                  |
| AfterBackward             | 264.551 ms                | 2.090 s                   |
| BlockToStepN              | 328.465 us                | 3.296 ms                  |
| OneStep                   | 273.375 ms                | 2.095 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 148 ========== 
E20240131 16:09:43.231871 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
E20240131 16:09:44.231611 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=369
W20240131 16:09:44.240531 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
========== Step 153 ========== 
========== Step 154 ========== 
W20240131 16:09:44.855854 25962 grad_async_v2.h:257] pq is empty
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
E20240131 16:09:45.231029 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
========== Step 158 ========== 
W20240131 16:09:45.486107 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 159 ========== 
E20240131 16:09:46.020329 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=159, sample_step_cpp_seen_[rank]=158
E20240131 16:09:46.231012 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 16:09:46.652293 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240131 16:09:47.231294 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:09:47.674858 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 160 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.570 us                | 5.745 ms                  |
| ProcessBack:Shuffle       | 245.658 ms                | 283.608 ms                |
| ProcessBack:UpdateCache   | 17.334 ms                 | 23.771 ms                 |
| ProcessBack:UpsertPq      | 65.007 us                 | 275.972 us                |
| ProcessOneStep            | 264.044 ms                | 1.971 s                   |
| BlockToStepN              | 246.362 us                | 895.440 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 161 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 137.823 us                | 1.787 ms                  |
| GenInput                  | 933.792 us                | 12.158 ms                 |
| NN                        | 1.153 ms                  | 5.478 ms                  |
| Forward                   | 1.549 ms                  | 8.482 ms                  |
| Backward                  | 3.177 ms                  | 12.375 ms                 |
| Optimize                  | 323.772 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 769.417 us                | 1.850 ms                  |
| AfterBackward             | 264.074 ms                | 1.971 s                   |
| BlockToStepN              | 350.279 us                | 1.127 ms                  |
| OneStep                   | 273.223 ms                | 1.986 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:48.231077 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=593
========== Step 162 ========== 
========== Step 163 ========== 
W20240131 16:09:48.787295 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 164 ========== 
W20240131 16:09:49.091316 25962 grad_async_v2.h:257] pq is empty
========== Step 165 ========== 
E20240131 16:09:49.231546 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=321
========== Step 166 ========== 
========== Step 167 ========== 
W20240131 16:09:49.819932 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
========== Step 168 ========== 
========== Step 169 ========== 
E20240131 16:09:50.232125 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=93
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
W20240131 16:09:51.009356 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
W20240131 16:09:51.186098 25962 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
E20240131 16:09:51.232115 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=295
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
W20240131 16:09:52.030059 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:09:52.067502 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=176, sample_step_cpp_seen_[rank]=175
========== Step 177 ========== 
E20240131 16:09:52.240849 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.491 us                | 262.722 us                |
| ProcessBack:Shuffle       | 245.658 ms                | 283.608 ms                |
| ProcessBack:UpdateCache   | 17.409 ms                 | 25.327 ms                 |
| ProcessBack:UpsertPq      | 66.399 us                 | 275.972 us                |
| ProcessOneStep            | 263.961 ms                | 1.971 s                   |
| BlockToStepN              | 276.073 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 136.811 us                | 1.787 ms                  |
| GenInput                  | 870.095 us                | 12.158 ms                 |
| NN                        | 1.140 ms                  | 5.478 ms                  |
| Forward                   | 1.534 ms                  | 8.482 ms                  |
| Backward                  | 3.175 ms                  | 12.375 ms                 |
| Optimize                  | 325.203 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 769.417 us                | 1.850 ms                  |
| AfterBackward             | 263.995 ms                | 1.971 s                   |
| BlockToStepN              | 364.495 us                | 3.296 ms                  |
| OneStep                   | 273.214 ms                | 1.986 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:09:53.191982 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240131 16:09:53.240145 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 178 ========== 
W20240131 16:09:54.176705 25962 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
E20240131 16:09:54.240109 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=172
W20240131 16:09:54.262465 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
E20240131 16:09:55.240249 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=107
========== Step 183 ========== 
W20240131 16:09:55.293978 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
E20240131 16:09:56.240443 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=504
W20240131 16:09:56.351377 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
E20240131 16:09:57.240013 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 16:09:57.242581 25962 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
W20240131 16:09:57.371517 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 191 ========== 
========== Step 192 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.474 us                | 39.730 ms                 |
| ProcessBack:Shuffle       | 246.213 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 65.702 us                 | 275.972 us                |
| ProcessOneStep            | 264.044 ms                | 1.971 s                   |
| BlockToStepN              | 292.956 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 193 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.769 us                | 1.787 ms                  |
| GenInput                  | 870.095 us                | 12.158 ms                 |
| NN                        | 1.135 ms                  | 5.478 ms                  |
| Forward                   | 1.526 ms                  | 8.482 ms                  |
| Backward                  | 3.168 ms                  | 12.375 ms                 |
| Optimize                  | 327.587 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 767.106 us                | 2.481 ms                  |
| AfterBackward             | 264.481 ms                | 1.971 s                   |
| BlockToStepN              | 372.175 us                | 3.296 ms                  |
| OneStep                   | 273.375 ms                | 1.986 s                   |
| E2E-100                   | 35.729 s                  | 35.729 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:09:58.252060 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=138
========== Step 194 ========== 
========== Step 195 ========== 
W20240131 16:09:58.582538 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
========== Step 196 ========== 
========== Step 197 ========== 
E20240131 16:09:59.252029 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=136
========== Step 198 ========== 
E20240131 16:09:59.631567 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=198, sample_step_cpp_seen_[rank]=197
W20240131 16:09:59.695436 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240131 16:10:00.252296 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:10:00.890296 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 16:10:01.252987 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 199 ========== 
W20240131 16:10:01.829496 25962 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 37.546, per_step: 0.371740
Step199:rank5, time: 37.546, per_step: 0.371739
Step199:rank7, time: 37.545, per_step: 0.371736
Step199:rank6, time: 37.545, per_step: 0.371737
Step199:rank4, time: 37.546, per_step: 0.371739
Step199:rank1, time: 37.545, per_step: 0.371735
Step199:rank3, time: 37.546, per_step: 0.371738
Step199:rank2, time: 37.545, per_step: 0.371737
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.769 us                | 1.787 ms                  |
| GenInput                  | 870.095 us                | 12.158 ms                 |
| NN                        | 1.132 ms                  | 5.478 ms                  |
| Forward                   | 1.523 ms                  | 8.482 ms                  |
| Backward                  | 3.168 ms                  | 12.375 ms                 |
| Optimize                  | 329.971 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 767.106 us                | 2.481 ms                  |
| AfterBackward             | 264.427 ms                | 2.090 s                   |
| BlockToStepN              | 379.997 us                | 3.296 ms                  |
| OneStep                   | 273.545 ms                | 2.095 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 16:10:01.937925 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 201 ========== 
E20240131 16:10:02.252027 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=336
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.367 us                | 31.567 ms                 |
| ProcessBack:Shuffle       | 246.213 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.409 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 65.951 us                 | 275.972 us                |
| ProcessOneStep            | 263.961 ms                | 2.089 s                   |
| BlockToStepN              | 306.228 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:10:03.073693 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 205 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.407 us                | 1.787 ms                  |
| GenInput                  | 869.604 us                | 12.158 ms                 |
| NN                        | 1.135 ms                  | 5.478 ms                  |
| Forward                   | 1.526 ms                  | 8.482 ms                  |
| Backward                  | 3.152 ms                  | 12.375 ms                 |
| Optimize                  | 331.640 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 767.106 us                | 2.481 ms                  |
| AfterBackward             | 263.995 ms                | 2.090 s                   |
| BlockToStepN              | 386.083 us                | 3.296 ms                  |
| OneStep                   | 273.223 ms                | 2.095 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:03.252027 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=424
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
W20240131 16:10:04.133744 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240131 16:10:04.181514 25962 grad_async_v2.h:257] pq is empty
========== Step 209 ========== 
E20240131 16:10:04.252072 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=52
W20240131 16:10:04.464313 25962 grad_async_v2.h:257] pq is empty
========== Step 210 ========== 
========== Step 211 ========== 
W20240131 16:10:04.959074 25962 grad_async_v2.h:257] pq is empty
========== Step 212 ========== 
========== Step 213 ========== 
E20240131 16:10:05.252027 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=135
W20240131 16:10:05.276692 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
E20240131 16:10:06.264217 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=187
========== Step 217 ========== 
E20240131 16:10:06.355352 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=217, sample_step_cpp_seen_[rank]=216
W20240131 16:10:06.703456 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240131 16:10:07.264205 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 16:10:07.932667 26861 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.748 us                | 277.721 us                |
| ProcessBack:Shuffle       | 246.147 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.409 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 66.411 us                 | 275.972 us                |
| ProcessOneStep            | 263.757 ms                | 2.089 s                   |
| BlockToStepN              | 312.825 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.407 us                | 1.787 ms                  |
| GenInput                  | 847.608 us                | 12.158 ms                 |
| NN                        | 1.136 ms                  | 5.478 ms                  |
| Forward                   | 1.526 ms                  | 8.482 ms                  |
| Backward                  | 3.152 ms                  | 14.163 ms                 |
| Optimize                  | 329.971 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 761.649 us                | 2.481 ms                  |
| AfterBackward             | 263.806 ms                | 2.090 s                   |
| BlockToStepN              | 402.112 us                | 3.296 ms                  |
| OneStep                   | 273.128 ms                | 2.095 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:08.264559 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 218 ========== 
W20240131 16:10:08.947912 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 219 ========== 
E20240131 16:10:09.264353 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=165
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
W20240131 16:10:10.074393 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 223 ========== 
E20240131 16:10:10.265666 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
W20240131 16:10:11.205680 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240131 16:10:11.265240 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
W20240131 16:10:11.396680 25962 grad_async_v2.h:257] pq is empty
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
E20240131 16:10:12.265170 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 232 ========== 
W20240131 16:10:12.623390 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240131 16:10:12.759487 25962 grad_async_v2.h:257] pq is empty
========== Step 233 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 163.482 us                | 35.883 ms                 |
| ProcessBack:Shuffle       | 246.213 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.907 ms                 |
| ProcessBack:UpsertPq      | 66.399 us                 | 275.972 us                |
| ProcessOneStep            | 263.559 ms                | 2.168 s                   |
| BlockToStepN              | 319.628 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 234 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.017 us                | 1.787 ms                  |
| GenInput                  | 841.307 us                | 12.158 ms                 |
| NN                        | 1.132 ms                  | 5.478 ms                  |
| Forward                   | 1.526 ms                  | 8.482 ms                  |
| Backward                  | 3.125 ms                  | 14.163 ms                 |
| Optimize                  | 329.971 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 767.106 us                | 3.017 ms                  |
| AfterBackward             | 263.590 ms                | 2.168 s                   |
| BlockToStepN              | 417.826 us                | 3.296 ms                  |
| OneStep                   | 272.899 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:13.265151 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=436
========== Step 235 ========== 
E20240131 16:10:13.672572 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=235, sample_step_cpp_seen_[rank]=234
W20240131 16:10:13.803599 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240131 16:10:14.265095 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 236 ========== 
W20240131 16:10:14.859990 26861 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 237 ========== 
========== Step 238 ========== 
E20240131 16:10:15.265719 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
W20240131 16:10:16.045081 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240131 16:10:16.265285 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=320
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
E20240131 16:10:17.265058 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 16:10:17.384280 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
W20240131 16:10:17.523455 25962 grad_async_v2.h:257] pq is empty
========== Step 248 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 162.166 us                | 31.894 ms                 |
| ProcessBack:Shuffle       | 246.147 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.869 ms                 | 25.907 ms                 |
| ProcessBack:UpsertPq      | 66.411 us                 | 275.972 us                |
| ProcessOneStep            | 263.559 ms                | 2.168 s                   |
| BlockToStepN              | 334.582 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.312 us                | 1.787 ms                  |
| GenInput                  | 833.359 us                | 12.158 ms                 |
| NN                        | 1.129 ms                  | 5.478 ms                  |
| Forward                   | 1.526 ms                  | 8.482 ms                  |
| Backward                  | 3.113 ms                  | 14.163 ms                 |
| Optimize                  | 327.826 us                | 1.351 ms                  |
| BarrierTimeBeforeRank0    | 744.437 us                | 3.017 ms                  |
| AfterBackward             | 263.590 ms                | 2.168 s                   |
| BlockToStepN              | 440.699 us                | 3.296 ms                  |
| OneStep                   | 272.641 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:18.265023 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:10:18.672008 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=248, sample_step_cpp_seen_[rank]=247
W20240131 16:10:18.836122 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240131 16:10:19.265193 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:10:19.898510 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 249 ========== 
E20240131 16:10:20.265039 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=277
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
W20240131 16:10:21.013849 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 253 ========== 
E20240131 16:10:21.265396 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=423
W20240131 16:10:21.268648 25962 grad_async_v2.h:257] pq is empty
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
W20240131 16:10:22.048444 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240131 16:10:22.266084 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.311 us                | 31.797 ms                 |
| ProcessBack:Shuffle       | 245.763 ms                | 283.730 ms                |
| ProcessBack:UpdateCache   | 17.596 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 66.411 us                 | 275.972 us                |
| ProcessOneStep            | 263.478 ms                | 2.168 s                   |
| BlockToStepN              | 342.340 us                | 1.936 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 261 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.335 us                | 1.580 ms                  |
| GenInput                  | 832.761 us                | 10.775 ms                 |
| NN                        | 1.132 ms                  | 5.201 ms                  |
| Forward                   | 1.526 ms                  | 7.805 ms                  |
| Backward                  | 3.105 ms                  | 13.414 ms                 |
| Optimize                  | 327.826 us                | 1.267 ms                  |
| BarrierTimeBeforeRank0    | 741.694 us                | 2.481 ms                  |
| AfterBackward             | 263.590 ms                | 2.168 s                   |
| BlockToStepN              | 446.743 us                | 2.030 ms                  |
| OneStep                   | 272.724 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:23.266687 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
========== Step 262 ========== 
W20240131 16:10:23.425187 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
E20240131 16:10:24.229009 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=265, sample_step_cpp_seen_[rank]=264
E20240131 16:10:24.266023 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 16:10:24.627450 26861 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240131 16:10:25.266018 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:10:25.753031 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 266 ========== 
========== Step 267 ========== 
E20240131 16:10:26.266528 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 268 ========== 
W20240131 16:10:26.760339 25962 grad_async_v2.h:257] pq is empty
========== Step 269 ========== 
W20240131 16:10:26.810652 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
W20240131 16:10:27.036320 25962 grad_async_v2.h:257] pq is empty
========== Step 270 ========== 
E20240131 16:10:27.266140 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
========== Step 271 ========== 
========== Step 272 ========== 
W20240131 16:10:27.822777 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 273 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.948 us                | 31.451 ms                 |
| ProcessBack:Shuffle       | 245.951 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.571 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 66.677 us                 | 275.972 us                |
| ProcessOneStep            | 263.682 ms                | 2.168 s                   |
| BlockToStepN              | 349.017 us                | 1.936 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 274 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 134.326 us                | 1.580 ms                  |
| GenInput                  | 832.668 us                | 10.775 ms                 |
| NN                        | 1.132 ms                  | 5.201 ms                  |
| Forward                   | 1.526 ms                  | 7.805 ms                  |
| Backward                  | 3.087 ms                  | 13.414 ms                 |
| Optimize                  | 331.640 us                | 1.267 ms                  |
| BarrierTimeBeforeRank0    | 741.694 us                | 3.017 ms                  |
| AfterBackward             | 263.660 ms                | 2.168 s                   |
| BlockToStepN              | 455.205 us                | 2.030 ms                  |
| OneStep                   | 272.849 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:28.266604 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=71
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
W20240131 16:10:29.059631 26861 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 278 ========== 
E20240131 16:10:29.266685 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
E20240131 16:10:30.266031 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
W20240131 16:10:30.313993 26861 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240131 16:10:30.379504 25962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=282, sample_step_cpp_seen_[rank]=281
E20240131 16:10:31.267360 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:10:31.377182 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
========== Step 283 ========== 
E20240131 16:10:32.267030 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=172
W20240131 16:10:32.377090 26861 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 140.982 us                | 27.541 ms                 |
| ProcessBack:Shuffle       | 245.805 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.442 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 66.726 us                 | 275.972 us                |
| ProcessOneStep            | 263.682 ms                | 2.168 s                   |
| BlockToStepN              | 357.516 us                | 1.936 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 134.326 us                | 1.580 ms                  |
| GenInput                  | 832.668 us                | 10.775 ms                 |
| NN                        | 1.129 ms                  | 5.201 ms                  |
| Forward                   | 1.525 ms                  | 7.805 ms                  |
| Backward                  | 3.087 ms                  | 13.414 ms                 |
| Optimize                  | 331.879 us                | 1.267 ms                  |
| BarrierTimeBeforeRank0    | 733.253 us                | 3.017 ms                  |
| AfterBackward             | 263.770 ms                | 2.168 s                   |
| BlockToStepN              | 464.574 us                | 2.030 ms                  |
| OneStep                   | 272.899 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 287 ========== 
E20240131 16:10:33.267064 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 16:10:33.397547 26861 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 288 ========== 
========== Step 289 ========== 
W20240131 16:10:34.023420 25962 grad_async_v2.h:257] pq is empty
========== Step 290 ========== 
E20240131 16:10:34.267069 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 291 ========== 
W20240131 16:10:34.542162 25962 grad_async_v2.h:257] pq is empty
========== Step 292 ========== 
W20240131 16:10:34.667884 26861 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
========== Step 293 ========== 
========== Step 294 ========== 
E20240131 16:10:35.267129 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=81
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
W20240131 16:10:35.910452 26861 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 298 ========== 
E20240131 16:10:36.267177 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=214
========== Step 299 ========== 
Step299:rank0, time: 34.828, per_step: 0.344828
Step299:rank7, time: 34.828, per_step: 0.344827
Step299:rank4, time: 34.828, per_step: 0.344827
Step299:rank1, time: 34.827, per_step: 0.344826
Step299:rank2, time: 34.827, per_step: 0.344824
Step299:rank3, time: 34.827, per_step: 0.344824
Step299:rank5, time: 34.828, per_step: 0.344828
Step299:rank6, time: 34.828, per_step: 0.344827
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.335 us                | 1.580 ms                  |
| GenInput                  | 832.668 us                | 10.775 ms                 |
| NN                        | 1.132 ms                  | 5.478 ms                  |
| Forward                   | 1.525 ms                  | 7.805 ms                  |
| Backward                  | 3.087 ms                  | 14.163 ms                 |
| Optimize                  | 331.879 us                | 1.267 ms                  |
| BarrierTimeBeforeRank0    | 729.752 us                | 3.017 ms                  |
| AfterBackward             | 263.806 ms                | 2.168 s                   |
| BlockToStepN              | 473.260 us                | 3.296 ms                  |
| OneStep                   | 272.917 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 16:10:36.658241 25962 grad_async_v2.h:84] call StopThreads. PID = 25962
W20240131 16:10:36.658264 25962 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 16:10:36.658310 25962 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 16:10:36.658319 25962 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240131 16:10:37.249819 26861 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 16:10:37.267040 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 139.344 us                | 271.452 us                |
| ProcessBack:Shuffle       | 245.865 ms                | 292.664 ms                |
| ProcessBack:UpdateCache   | 17.571 ms                 | 25.902 ms                 |
| ProcessBack:UpsertPq      | 66.677 us                 | 275.972 us                |
| ProcessOneStep            | 263.757 ms                | 2.168 s                   |
| BlockToStepN              | 367.807 us                | 3.201 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.335 us                | 1.580 ms                  |
| GenInput                  | 832.668 us                | 10.775 ms                 |
| NN                        | 1.132 ms                  | 5.478 ms                  |
| Forward                   | 1.525 ms                  | 7.805 ms                  |
| Backward                  | 3.087 ms                  | 14.163 ms                 |
| Optimize                  | 331.879 us                | 1.267 ms                  |
| BarrierTimeBeforeRank0    | 729.752 us                | 3.017 ms                  |
| AfterBackward             | 263.806 ms                | 2.168 s                   |
| BlockToStepN              | 473.260 us                | 3.296 ms                  |
| OneStep                   | 272.899 ms                | 2.174 s                   |
| E2E-100                   | 35.729 s                  | 37.546 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:10:38.267031 26861 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
