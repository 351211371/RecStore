WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 14:25:20.102950 21005 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 14:25:20.112707 21005 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [21005 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f680c6c99e0>==========
Worker 1 pid=21365
Worker 2 pid=21366
INFO [21005 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [21365 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [21367 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [21366 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [21367 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [21366 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [21365 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 14:25:26.154641 21367 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:25:26.154681 21366 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:25:26.154701 21365 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [21005 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 14:25:26.155731 21005 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 14:25:31.314651 21366 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 14:25:31.317025 21367 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 14:25:31.317360 21365 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 14:25:31.326850 21005 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 14:25:31.702579 21366 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004817d000 7.629 MB
W20240131 14:25:31.702786 21366 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100048920000 7.629 MB
W20240131 14:25:31.702841 21366 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000490c3000 122.1 MB
W20240131 14:25:31.702909 21366 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100050ad7000 122.1 MB
W20240131 14:25:31.702958 21366 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:25:31.703347 21366 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:25:31.726195 21365 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000584f1000 7.629 MB
W20240131 14:25:31.726377 21365 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100058c94000 7.629 MB
W20240131 14:25:31.726445 21365 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100059437000 122.1 MB
W20240131 14:25:31.726509 21365 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100060e4b000 122.1 MB
W20240131 14:25:31.726547 21365 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:25:31.726891 21365 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:25:31.728933 21005 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100068865000 7.629 MB
W20240131 14:25:31.729178 21005 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100069008000 7.629 MB
W20240131 14:25:31.729254 21005 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1000697ab000 122.1 MB
W20240131 14:25:31.729300 21005 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000711bf000 122.1 MB
W20240131 14:25:31.729332 21005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 14:25:31.729682 21005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 14:25:31.739974 21367 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100078bd9000 7.629 MB
W20240131 14:25:31.740128 21367 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10007937c000 7.629 MB
W20240131 14:25:31.740195 21367 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100079b1f000 122.1 MB
W20240131 14:25:31.740255 21367 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100081533000 122.1 MB
W20240131 14:25:31.740293 21367 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 14:25:31.741184 21367 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
Worker 3 pid=21367
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240131 14:25:35.960778 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100088f4b000 7.629 MB
W20240131 14:25:35.960914 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000896ee000 7.629 MB
W20240131 14:25:35.960960 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100089e91000 7.629 MB
W20240131 14:25:35.961002 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10008a634000 7.629 MB
W20240131 14:25:35.961036 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10008add7000 7.629 MB
W20240131 14:25:35.961084 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10008b57a000 7.629 MB
W20240131 14:25:35.961125 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10008bd1d000 7.629 MB
W20240131 14:25:35.961184 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10008c4c0000 7.629 MB
W20240131 14:25:35.961225 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10008cc63000 7.629 MB
W20240131 14:25:35.961269 21367 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10008d406000 7.629 MB
W20240131 14:25:35.961311 21367 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10008dba9000 80 B 
W20240131 14:25:35.961344 21367 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10008dbab000 8 B 
W20240131 14:25:35.961371 21367 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:25:35.961663 21367 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 14:25:36.097290 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10008dbaf000 7.629 MB
W20240131 14:25:36.097429 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10008e352000 7.629 MB
W20240131 14:25:36.097478 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10008eaf5000 7.629 MB
W20240131 14:25:36.097517 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008f298000 7.629 MB
W20240131 14:25:36.097550 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008fa3b000 7.629 MB
W20240131 14:25:36.097590 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000901de000 7.629 MB
W20240131 14:25:36.097623 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100090981000 7.629 MB
W20240131 14:25:36.097677 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100091124000 7.629 MB
W20240131 14:25:36.097719 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000918c7000 7.629 MB
W20240131 14:25:36.097751 21366 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10009206a000 7.629 MB
W20240131 14:25:36.097791 21366 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10009280d000 80 B 
W20240131 14:25:36.097822 21366 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10009280f000 8 B 
W20240131 14:25:36.097851 21366 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:25:36.098140 21366 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 14:25:36.153622 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100092813000 7.629 MB
W20240131 14:25:36.153785 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100092fb6000 7.629 MB
W20240131 14:25:36.153839 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100093759000 7.629 MB
W20240131 14:25:36.153880 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100093efc000 7.629 MB
W20240131 14:25:36.153911 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10009469f000 7.629 MB
W20240131 14:25:36.153942 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100094e42000 7.629 MB
W20240131 14:25:36.153988 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000955e5000 7.629 MB
W20240131 14:25:36.154053 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100095d88000 7.629 MB
W20240131 14:25:36.154095 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10009652b000 7.629 MB
W20240131 14:25:36.154134 21005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100096cce000 7.629 MB
W20240131 14:25:36.154173 21005 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100097471000 80 B 
W20240131 14:25:36.154206 21005 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100097473000 8 B 
W20240131 14:25:36.154234 21005 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:25:36.154632 21005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 14:25:36.697727 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100097477000 7.629 MB
W20240131 14:25:36.697880 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100097c1a000 7.629 MB
W20240131 14:25:36.697925 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000983bd000 7.629 MB
W20240131 14:25:36.697965 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100098b60000 7.629 MB
W20240131 14:25:36.698000 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100099303000 7.629 MB
W20240131 14:25:36.698040 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100099aa6000 7.629 MB
W20240131 14:25:36.698074 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10009a249000 7.629 MB
W20240131 14:25:36.698118 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10009a9ec000 7.629 MB
W20240131 14:25:36.698159 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009b18f000 7.629 MB
W20240131 14:25:36.698192 21365 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10009b932000 7.629 MB
W20240131 14:25:36.698236 21365 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10009c0d5000 80 B 
W20240131 14:25:36.698271 21365 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10009c0d7000 8 B 
W20240131 14:25:36.698302 21365 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:25:36.698647 21365 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 14:25:36.700990 21005 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 14:25:36.701298 21005 grad_base.h:184] Init GradProcessingBase done
I20240131 14:25:37.817000 21005 grad_async_v2.h:42] Use main thread to update emb.
W20240131 14:25:37.817277 21005 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 14:25:37.817291 21005 kg_controller.h:84] Construct KGCacheController done
E20240131 14:25:38.296168 21365 recstore.cc:66] init folly done
E20240131 14:25:38.296262 21366 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 14:25:38.296470 21005 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 14:25:38.296039 21367 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
I20240131 14:25:38.301257 21005 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 14:25:38.672137 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:25:38.672475 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 14:25:39.672011 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:25:39.748823 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:25:40.672089 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:25:40.790007 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:25:41.672116 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:25:41.867506 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:25:42.672032 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:25:43.073755 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 173.504 us                | 321.637 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:25:43.672061 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:25:44.216603 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:25:44.672205 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
Before Training
Before Training
I20240131 14:25:45.893947 21365 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240131 14:25:45.893986 21366 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 14:25:45.894255 21005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 14:25:45.894726 21367 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
W20240131 14:25:45.908531 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:25:45.908730 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 584.117 us                | 584.117 us                |
| GenInput                  | 79.782 ms                 | 79.782 ms                 |
| NN                        | 205.197 ms                | 205.197 ms                |
| Forward                   | 266.689 ms                | 266.689 ms                |
| Backward                  | 103.436 ms                | 103.436 ms                |
| Optimize                  | 4.094 ms                  | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 634.242 us                | 634.242 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:25:47.121742 22603 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:25:47.813735 21005 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240131 14:25:48.216208 21857 parallel_pq_v2.h:79] insert failed, size(hashtable)=3253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 232.158 us                | 505.159 us                |
| ProcessBack:Shuffle       | 376.254 ms                | 376.254 ms                |
| ProcessBack:UpdateCache   | 385.887 ms                | 385.887 ms                |
| ProcessBack:UpsertPq      | 691.746 ms                | 691.746 ms                |
| ProcessOneStep            | 1.461 s                   | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
W20240131 14:25:48.416743 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [21367 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [21365 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [21005 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [21366 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
E20240131 14:25:49.216035 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=691
========== Step 3 ========== 
W20240131 14:25:49.629089 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 4 ========== 
E20240131 14:25:50.216017 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=180
W20240131 14:25:50.853814 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 14:25:51.281853 21005 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
E20240131 14:25:51.308998 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.096 us                | 584.117 us                |
| GenInput                  | 79.782 ms                 | 85.546 ms                 |
| NN                        | 3.232 ms                  | 205.197 ms                |
| Forward                   | 4.732 ms                  | 266.689 ms                |
| Backward                  | 6.179 ms                  | 103.436 ms                |
| Optimize                  | 499.725 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 55.097 us                 | 3.201 ms                  |
| AfterBackward             | 708.992 ms                | 1.462 s                   |
| BlockToStepN              | 562.112 us                | 573.834 ms                |
| OneStep                   | 802.251 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:25:51.931176 21005 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 14:25:51.932509 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:25:52.316058 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2157
W20240131 14:25:52.612147 21005 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
========== Step 8 ========== 
W20240131 14:25:52.940143 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 9 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 150.519 us                | 32.088 ms                 |
| ProcessBack:Shuffle       | 523.536 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.652 ms                  | 385.887 ms                |
| ProcessBack:UpsertPq      | 67.312 us                 | 691.746 ms                |
| ProcessOneStep            | 559.604 ms                | 1.461 s                   |
| BlockToStepN              | 65.075 us                 | 573.224 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:25:53.308713 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=130
W20240131 14:25:53.979593 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 14:25:54.293527 21005 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
E20240131 14:25:54.308013 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=27
W20240131 14:25:54.899950 21005 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
W20240131 14:25:55.080855 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:25:55.308418 21858 parallel_pq_v2.h:79] insert failed, size(hashtable)=173
========== Step 12 ========== 
W20240131 14:25:56.133934 21005 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
W20240131 14:25:56.164511 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:25:56.308142 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 225.261 us                | 584.117 us                |
| GenInput                  | 79.782 ms                 | 85.546 ms                 |
| NN                        | 1.457 ms                  | 205.197 ms                |
| Forward                   | 2.098 ms                  | 266.689 ms                |
| Backward                  | 4.247 ms                  | 103.436 ms                |
| Optimize                  | 339.508 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 674.273 us                | 3.458 ms                  |
| AfterBackward             | 526.315 ms                | 1.462 s                   |
| BlockToStepN              | 174.124 us                | 573.834 ms                |
| OneStep                   | 634.898 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:25:57.173537 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:25:57.308209 21868 parallel_pq_v2.h:79] insert failed, size(hashtable)=499
========== Step 15 ========== 
W20240131 14:25:58.180671 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:25:58.202236 21005 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 161.422 us                | 31.878 ms                 |
| ProcessBack:Shuffle       | 523.536 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.492 ms                  | 385.887 ms                |
| ProcessBack:UpsertPq      | 64.740 us                 | 691.746 ms                |
| ProcessOneStep            | 542.968 ms                | 1.461 s                   |
| BlockToStepN              | 72.110 us                 | 573.224 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:25:58.308066 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 17 ========== 
W20240131 14:25:59.287467 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:25:59.308001 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=426
========== Step 18 ========== 
========== Step 19 ========== 
W20240131 14:26:00.299163 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 14:26:00.308007 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=167
W20240131 14:26:00.998929 21005 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
E20240131 14:26:01.308414 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1027
W20240131 14:26:01.312621 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 21 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.021 us                | 584.117 us                |
| GenInput                  | 77.162 ms                 | 97.193 ms                 |
| NN                        | 1.334 ms                  | 205.197 ms                |
| Forward                   | 1.912 ms                  | 266.689 ms                |
| Backward                  | 3.641 ms                  | 103.436 ms                |
| Optimize                  | 316.143 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.071 ms                  | 3.458 ms                  |
| AfterBackward             | 547.704 ms                | 1.462 s                   |
| BlockToStepN              | 180.060 us                | 573.834 ms                |
| OneStep                   | 640.048 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:02.308074 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=77
W20240131 14:26:02.471685 21005 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
W20240131 14:26:02.472865 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:26:03.083256 21005 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.347 us                | 27.936 ms                 |
| ProcessBack:Shuffle       | 541.276 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.465 ms                  | 385.887 ms                |
| ProcessBack:UpsertPq      | 64.685 us                 | 691.746 ms                |
| ProcessOneStep            | 547.682 ms                | 1.461 s                   |
| BlockToStepN              | 79.949 us                 | 573.224 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:03.308113 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:03.517187 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 14:26:03.731768 21005 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
W20240131 14:26:03.904574 21005 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
E20240131 14:26:04.308149 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=933
========== Step 26 ========== 
W20240131 14:26:04.641476 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 27 ========== 
E20240131 14:26:05.308252 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1023
W20240131 14:26:05.662703 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:26:05.943802 21005 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
E20240131 14:26:06.308192 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:06.501803 21005 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
W20240131 14:26:06.672277 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.220 us                | 584.117 us                |
| GenInput                  | 79.187 ms                 | 97.193 ms                 |
| NN                        | 1.252 ms                  | 205.197 ms                |
| Forward                   | 1.736 ms                  | 266.689 ms                |
| Backward                  | 3.641 ms                  | 103.436 ms                |
| Optimize                  | 308.990 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.071 ms                  | 3.458 ms                  |
| AfterBackward             | 547.704 ms                | 1.462 s                   |
| BlockToStepN              | 164.583 us                | 573.834 ms                |
| OneStep                   | 640.048 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:07.140448 21005 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
E20240131 14:26:07.308018 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 31 ========== 
========== Step 32 ========== 
W20240131 14:26:07.882575 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 14:26:08.308521 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.216 us                | 31.648 ms                 |
| ProcessBack:Shuffle       | 523.536 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 385.887 ms                |
| ProcessBack:UpsertPq      | 64.478 us                 | 691.746 ms                |
| ProcessOneStep            | 542.968 ms                | 1.461 s                   |
| BlockToStepN              | 79.949 us                 | 573.224 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:08.309638 21005 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
========== Step 34 ========== 
W20240131 14:26:09.148705 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 35 ========== 
E20240131 14:26:09.318177 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=351
========== Step 36 ========== 
========== Step 37 ========== 
E20240131 14:26:10.318121 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=116
W20240131 14:26:10.416867 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 38 ========== 
E20240131 14:26:11.318030 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.220 us                | 584.117 us                |
| GenInput                  | 78.941 ms                 | 97.193 ms                 |
| NN                        | 1.232 ms                  | 205.197 ms                |
| Forward                   | 1.726 ms                  | 266.689 ms                |
| Backward                  | 4.247 ms                  | 103.436 ms                |
| Optimize                  | 308.990 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.136 ms                  | 5.292 ms                  |
| AfterBackward             | 526.315 ms                | 1.462 s                   |
| BlockToStepN              | 166.715 us                | 573.834 ms                |
| OneStep                   | 634.898 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:11.744874 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 39 ========== 
E20240131 14:26:12.318178 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:12.589335 21005 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
W20240131 14:26:12.852684 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 41 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 152.547 us                | 31.651 ms                 |
| ProcessBack:Shuffle       | 523.536 ms                | 1.143 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 385.887 ms                |
| ProcessBack:UpsertPq      | 64.083 us                 | 691.746 ms                |
| ProcessOneStep            | 542.968 ms                | 1.461 s                   |
| BlockToStepN              | 85.376 us                 | 573.224 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:13.318022 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 42 ========== 
W20240131 14:26:13.903339 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:26:14.026906 21005 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
========== Step 44 ========== 
E20240131 14:26:14.332139 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=240
========== Step 45 ========== 
========== Step 46 ========== 
W20240131 14:26:14.912036 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240131 14:26:14.958703 21005 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
E20240131 14:26:15.332027 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=47
========== Step 48 ========== 
W20240131 14:26:16.089561 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 14:26:16.332108 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=80
W20240131 14:26:16.499305 21005 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 199.910 us                | 584.117 us                |
| GenInput                  | 77.162 ms                 | 97.193 ms                 |
| NN                        | 1.184 ms                  | 205.197 ms                |
| Forward                   | 1.681 ms                  | 266.689 ms                |
| Backward                  | 4.903 ms                  | 103.436 ms                |
| Optimize                  | 308.990 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.071 ms                  | 6.112 ms                  |
| AfterBackward             | 515.341 ms                | 1.462 s                   |
| BlockToStepN              | 180.060 us                | 573.834 ms                |
| OneStep                   | 606.423 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 50 ========== 
========== Step 51 ========== 
E20240131 14:26:17.332064 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:26:17.470358 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
========== Step 52 ========== 
W20240131 14:26:18.294800 21005 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.150 us                | 31.909 ms                 |
| ProcessBack:Shuffle       | 508.344 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.368 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 234.013 us                |
| ProcessOneStep            | 512.114 ms                | 1.161 s                   |
| BlockToStepN              | 98.761 us                 | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:18.332368 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=203
========== Step 54 ========== 
W20240131 14:26:18.779633 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
========== Step 55 ========== 
E20240131 14:26:19.332123 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=264
========== Step 56 ========== 
========== Step 57 ========== 
E20240131 14:26:20.332445 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:20.336552 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
W20240131 14:26:20.949483 21005 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
========== Step 59 ========== 
E20240131 14:26:21.332176 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=72
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 199.575 us                | 348.247 us                |
| GenInput                  | 77.158 ms                 | 93.982 ms                 |
| NN                        | 1.170 ms                  | 15.218 ms                 |
| Forward                   | 1.673 ms                  | 15.743 ms                 |
| Backward                  | 4.903 ms                  | 29.573 ms                 |
| Optimize                  | 307.560 us                | 1.454 ms                  |
| BarrierTimeBeforeRank0    | 1.153 ms                  | 5.292 ms                  |
| AfterBackward             | 509.827 ms                | 1.161 s                   |
| BlockToStepN              | 181.119 us                | 6.319 ms                  |
| OneStep                   | 592.308 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:21.965659 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 14:26:22.332120 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=133
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.008 us                | 35.968 ms                 |
| ProcessBack:Shuffle       | 491.791 ms                | 1.131 s                   |
| ProcessBack:UpdateCache   | 1.368 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 63.070 us                 | 234.013 us                |
| ProcessOneStep            | 504.681 ms                | 1.161 s                   |
| BlockToStepN              | 108.276 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:23.332078 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=311
========== Step 64 ========== 
W20240131 14:26:23.787245 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
========== Step 65 ========== 
E20240131 14:26:24.332171 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
========== Step 66 ========== 
========== Step 67 ========== 
E20240131 14:26:25.332120 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:25.801679 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 68 ========== 
E20240131 14:26:26.332108 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=336
========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 199.629 us                | 348.247 us                |
| GenInput                  | 76.755 ms                 | 97.153 ms                 |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.679 ms                  | 15.743 ms                 |
| Backward                  | 5.548 ms                  | 29.573 ms                 |
| Optimize                  | 307.560 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.194 ms                  | 6.345 ms                  |
| AfterBackward             | 493.430 ms                | 1.161 s                   |
| BlockToStepN              | 197.749 us                | 6.319 ms                  |
| OneStep                   | 589.807 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:26.993173 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
========== Step 70 ========== 
E20240131 14:26:27.332077 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:26:28.139295 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
========== Step 71 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.690 us                | 32.015 ms                 |
| ProcessBack:Shuffle       | 468.505 ms                | 1.135 s                   |
| ProcessBack:UpdateCache   | 1.358 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.307 us                 | 234.013 us                |
| ProcessOneStep            | 493.381 ms                | 1.161 s                   |
| BlockToStepN              | 116.744 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:28.332492 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
E20240131 14:26:29.332144 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=232
========== Step 75 ========== 
W20240131 14:26:29.594853 21005 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
========== Step 77 ========== 
W20240131 14:26:29.995293 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 14:26:30.332060 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 78 ========== 
E20240131 14:26:30.634898 21005 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=78, sample_step_cpp_seen_[rank]=77
W20240131 14:26:31.040735 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 14:26:31.332275 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 196.258 us                | 348.247 us                |
| GenInput                  | 76.528 ms                 | 97.153 ms                 |
| NN                        | 1.170 ms                  | 15.218 ms                 |
| Forward                   | 1.669 ms                  | 15.743 ms                 |
| Backward                  | 5.548 ms                  | 29.573 ms                 |
| Optimize                  | 295.162 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.194 ms                  | 8.028 ms                  |
| AfterBackward             | 464.955 ms                | 1.161 s                   |
| BlockToStepN              | 203.485 us                | 6.319 ms                  |
| OneStep                   | 557.517 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:32.125020 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 14:26:32.332150 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:33.251282 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 143.505 us                | 280.568 us                |
| ProcessBack:Shuffle       | 453.255 ms                | 1.135 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.178 us                 | 234.013 us                |
| ProcessOneStep            | 464.919 ms                | 1.161 s                   |
| BlockToStepN              | 122.599 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:33.332149 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:33.465688 21005 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
W20240131 14:26:34.296864 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240131 14:26:34.332069 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=77
W20240131 14:26:34.811424 21005 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
========== Step 83 ========== 
E20240131 14:26:35.348090 21867 parallel_pq_v2.h:79] insert failed, size(hashtable)=344
W20240131 14:26:35.420007 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
E20240131 14:26:36.360427 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:36.564469 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 196.258 us                | 348.247 us                |
| GenInput                  | 76.528 ms                 | 97.153 ms                 |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.673 ms                  | 15.743 ms                 |
| Backward                  | 5.914 ms                  | 29.573 ms                 |
| Optimize                  | 295.162 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.194 ms                  | 8.028 ms                  |
| AfterBackward             | 455.699 ms                | 1.462 s                   |
| BlockToStepN              | 215.107 us                | 6.319 ms                  |
| OneStep                   | 544.366 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:37.360087 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=162
W20240131 14:26:37.756084 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
W20240131 14:26:37.830539 21005 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
========== Step 88 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.062 us                | 28.004 ms                 |
| ProcessBack:Shuffle       | 390.800 ms                | 1.143 s                   |
| ProcessBack:UpdateCache   | 1.354 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 63.070 us                 | 234.013 us                |
| ProcessOneStep            | 455.579 ms                | 1.461 s                   |
| BlockToStepN              | 128.306 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:38.360126 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:26:38.953053 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 14:26:39.117684 21005 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
E20240131 14:26:39.360005 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=198
W20240131 14:26:39.735711 21005 grad_async_v2.h:257] pq is empty
========== Step 90 ========== 
W20240131 14:26:39.957098 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 91 ========== 
E20240131 14:26:40.360155 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=87
========== Step 92 ========== 
W20240131 14:26:41.150568 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 14:26:41.360028 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 199.629 us                | 363.564 us                |
| GenInput                  | 76.528 ms                 | 97.153 ms                 |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.678 ms                  | 15.743 ms                 |
| Backward                  | 5.914 ms                  | 29.573 ms                 |
| Optimize                  | 293.016 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.194 ms                  | 8.028 ms                  |
| AfterBackward             | 455.699 ms                | 1.462 s                   |
| BlockToStepN              | 224.216 us                | 6.319 ms                  |
| OneStep                   | 544.366 ms                | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 93 ========== 
========== Step 94 ========== 
W20240131 14:26:42.257220 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:26:42.360042 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=180
========== Step 95 ========== 
========== Step 96 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.953 us                | 31.639 ms                 |
| ProcessBack:Shuffle       | 390.800 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.999 us                 | 234.013 us                |
| ProcessOneStep            | 455.579 ms                | 1.461 s                   |
| BlockToStepN              | 133.193 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:43.330547 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240131 14:26:43.360158 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=334
========== Step 97 ========== 
E20240131 14:26:44.360307 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=121
W20240131 14:26:44.493469 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 98 ========== 
========== Step 99 ========== 
Step99:rank0, time: 73.093, per_step: 0.730930
Step99:rank1, time: 73.093, per_step: 0.730932
Step99:rank2, time: 73.093, per_step: 0.730931
Step99:rank3, time: 73.093, per_step: 0.730932
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 199.629 us                | 363.564 us                |
| GenInput                  | 76.755 ms                 | 97.153 ms                 |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.678 ms                  | 15.743 ms                 |
| Backward                  | 6.179 ms                  | 29.573 ms                 |
| Optimize                  | 295.162 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.153 ms                  | 8.028 ms                  |
| AfterBackward             | 413.229 ms                | 1.462 s                   |
| BlockToStepN              | 231.810 us                | 6.319 ms                  |
| OneStep                   | 544.366 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 14:26:45.360054 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=288
W20240131 14:26:45.719975 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
========== Step 101 ========== 
========== Step 102 ========== 
E20240131 14:26:46.360189 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 200.454 us                | 363.564 us                |
| GenInput                  | 76.528 ms                 | 97.153 ms                 |
| NN                        | 1.187 ms                  | 15.218 ms                 |
| Forward                   | 1.679 ms                  | 15.743 ms                 |
| Backward                  | 6.250 ms                  | 29.573 ms                 |
| Optimize                  | 301.600 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.167 ms                  | 8.866 ms                  |
| AfterBackward             | 413.229 ms                | 1.462 s                   |
| BlockToStepN              | 233.209 us                | 6.319 ms                  |
| OneStep                   | 510.665 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:46.991825 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 103 ========== 
========== Step 104 ========== 
E20240131 14:26:47.360229 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=181
W20240131 14:26:48.275072 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.158 us                | 31.964 ms                 |
| ProcessBack:Shuffle       | 376.254 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.787 us                 | 234.013 us                |
| ProcessOneStep            | 413.137 ms                | 1.461 s                   |
| BlockToStepN              | 140.711 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:48.360320 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=51
W20240131 14:26:48.411820 21005 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
E20240131 14:26:49.360252 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=184
W20240131 14:26:49.403146 21005 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
W20240131 14:26:49.420521 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
E20240131 14:26:50.360323 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=182
========== Step 110 ========== 
W20240131 14:26:50.660920 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 111 ========== 
W20240131 14:26:51.269744 21005 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
E20240131 14:26:51.360033 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=53
W20240131 14:26:51.554669 21005 grad_async_v2.h:257] pq is empty
========== Step 113 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 200.454 us                | 363.564 us                |
| GenInput                  | 76.528 ms                 | 97.153 ms                 |
| NN                        | 1.188 ms                  | 15.218 ms                 |
| Forward                   | 1.679 ms                  | 15.743 ms                 |
| Backward                  | 6.441 ms                  | 29.573 ms                 |
| Optimize                  | 295.162 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.194 ms                  | 8.866 ms                  |
| AfterBackward             | 370.224 ms                | 1.462 s                   |
| BlockToStepN              | 241.162 us                | 6.319 ms                  |
| OneStep                   | 465.369 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:26:51.808693 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
========== Step 114 ========== 
E20240131 14:26:52.360227 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
========== Step 115 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 168.214 us                | 43.639 ms                 |
| ProcessBack:Shuffle       | 338.954 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.769 us                 | 234.013 us                |
| ProcessOneStep            | 370.196 ms                | 1.461 s                   |
| BlockToStepN              | 151.130 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:53.360258 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
========== Step 116 ========== 
W20240131 14:26:53.571039 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
========== Step 117 ========== 
E20240131 14:26:54.360126 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=514
========== Step 118 ========== 
W20240131 14:26:54.647267 21005 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 120 ========== 
E20240131 14:26:55.360179 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:26:55.523109 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 121 ========== 
E20240131 14:26:56.360302 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=123
========== Step 122 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.220 us                | 584.117 us                |
| GenInput                  | 76.755 ms                 | 97.193 ms                 |
| NN                        | 1.195 ms                  | 15.218 ms                 |
| Forward                   | 1.699 ms                  | 15.743 ms                 |
| Backward                  | 6.250 ms                  | 29.573 ms                 |
| Optimize                  | 304.699 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.163 ms                  | 8.866 ms                  |
| AfterBackward             | 392.544 ms                | 1.462 s                   |
| BlockToStepN              | 243.726 us                | 8.429 ms                  |
| OneStep                   | 484.096 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 123 ========== 
E20240131 14:26:57.360232 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240131 14:26:57.382339 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
========== Step 124 ========== 
========== Step 125 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 183.603 us                | 36.032 ms                 |
| ProcessBack:Shuffle       | 368.571 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.999 us                 | 234.013 us                |
| ProcessOneStep            | 392.427 ms                | 1.461 s                   |
| BlockToStepN              | 158.544 us                | 8.298 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:26:58.360144 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
W20240131 14:26:58.387830 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
========== Step 126 ========== 
========== Step 127 ========== 
E20240131 14:26:59.360205 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=118
W20240131 14:26:59.526347 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
W20240131 14:26:59.606382 21005 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
W20240131 14:27:00.151477 21005 grad_async_v2.h:257] pq is empty
========== Step 129 ========== 
E20240131 14:27:00.360045 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 130 ========== 
E20240131 14:27:01.360064 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
========== Step 131 ========== 
W20240131 14:27:01.641794 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.202 us                | 584.117 us                |
| GenInput                  | 76.834 ms                 | 101.872 ms                |
| NN                        | 1.193 ms                  | 15.218 ms                 |
| Forward                   | 1.689 ms                  | 15.743 ms                 |
| Backward                  | 6.189 ms                  | 29.573 ms                 |
| Optimize                  | 303.268 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.163 ms                  | 8.866 ms                  |
| AfterBackward             | 413.229 ms                | 1.462 s                   |
| BlockToStepN              | 250.721 us                | 8.429 ms                  |
| OneStep                   | 510.665 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 132 ========== 
E20240131 14:27:02.361047 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=279
========== Step 133 ========== 
========== Step 134 ========== 
W20240131 14:27:02.909732 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
========== Step 135 ========== 
========== Step 136 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 161.258 us                | 31.799 ms                 |
| ProcessBack:Shuffle       | 355.305 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 62.787 us                 | 234.013 us                |
| ProcessOneStep            | 370.196 ms                | 1.461 s                   |
| BlockToStepN              | 165.494 us                | 8.298 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:03.368321 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
========== Step 137 ========== 
E20240131 14:27:04.368364 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=94
W20240131 14:27:04.414770 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 138 ========== 
E20240131 14:27:05.066834 21005 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=138, sample_step_cpp_seen_[rank]=137
E20240131 14:27:05.368170 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:27:06.227205 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240131 14:27:06.368041 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 201.446 us                | 584.117 us                |
| GenInput                  | 76.755 ms                 | 101.872 ms                |
| NN                        | 1.188 ms                  | 15.218 ms                 |
| Forward                   | 1.684 ms                  | 15.743 ms                 |
| Backward                  | 6.050 ms                  | 29.573 ms                 |
| Optimize                  | 301.600 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.200 ms                  | 8.866 ms                  |
| AfterBackward             | 392.544 ms                | 1.462 s                   |
| BlockToStepN              | 258.906 us                | 8.429 ms                  |
| OneStep                   | 484.096 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 139 ========== 
W20240131 14:27:07.281473 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:27:07.368191 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:27:07.564345 21005 grad_async_v2.h:257] pq is empty
========== Step 140 ========== 
W20240131 14:27:08.104591 21005 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 152.429 us                | 27.735 ms                 |
| ProcessBack:Shuffle       | 376.254 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.333 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 63.518 us                 | 234.013 us                |
| ProcessOneStep            | 413.137 ms                | 2.292 s                   |
| BlockToStepN              | 169.120 us                | 8.298 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:08.368204 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:27:08.421451 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
E20240131 14:27:09.384366 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:27:09.587138 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 146 ========== 
========== Step 147 ========== 
E20240131 14:27:10.384150 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=223
========== Step 148 ========== 
W20240131 14:27:10.681867 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 149 ========== 
W20240131 14:27:11.294131 21005 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
E20240131 14:27:11.384068 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
========== Step 151 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.202 us                | 450.192 us                |
| GenInput                  | 76.528 ms                 | 97.193 ms                 |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.679 ms                  | 15.743 ms                 |
| Backward                  | 5.914 ms                  | 26.613 ms                 |
| Optimize                  | 295.162 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.167 ms                  | 8.028 ms                  |
| AfterBackward             | 371.655 ms                | 1.462 s                   |
| BlockToStepN              | 274.082 us                | 6.319 ms                  |
| OneStep                   | 465.369 ms                | 2.372 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:12.242094 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 152 ========== 
E20240131 14:27:12.384269 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 150.033 us                | 35.539 ms                 |
| ProcessBack:Shuffle       | 368.571 ms                | 1.176 s                   |
| ProcessBack:UpdateCache   | 1.342 ms                  | 16.000 ms                 |
| ProcessBack:UpsertPq      | 63.518 us                 | 124.814 us                |
| ProcessOneStep            | 371.623 ms                | 1.461 s                   |
| BlockToStepN              | 179.890 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 153 ========== 
E20240131 14:27:13.384037 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
========== Step 154 ========== 
W20240131 14:27:14.066681 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
W20240131 14:27:14.279044 21005 grad_async_v2.h:257] pq is empty
========== Step 155 ========== 
E20240131 14:27:14.384496 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
========== Step 156 ========== 
========== Step 157 ========== 
E20240131 14:27:15.388643 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=78
W20240131 14:27:15.591327 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
========== Step 158 ========== 
W20240131 14:27:15.985013 21005 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
========== Step 160 ========== 
W20240131 14:27:16.367552 21005 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
E20240131 14:27:16.392258 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 162 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.202 us                | 450.192 us                |
| GenInput                  | 76.528 ms                 | 101.872 ms                |
| NN                        | 1.178 ms                  | 15.218 ms                 |
| Forward                   | 1.681 ms                  | 16.811 ms                 |
| Backward                  | 5.548 ms                  | 26.613 ms                 |
| Optimize                  | 301.600 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.153 ms                  | 8.028 ms                  |
| AfterBackward             | 357.030 ms                | 1.462 s                   |
| BlockToStepN              | 291.145 us                | 6.319 ms                  |
| OneStep                   | 445.078 ms                | 2.372 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 163 ========== 
========== Step 164 ========== 
E20240131 14:27:17.400323 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
W20240131 14:27:17.931061 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
========== Step 165 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.304 us                | 39.509 ms                 |
| ProcessBack:Shuffle       | 339.418 ms                | 1.176 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 16.000 ms                 |
| ProcessBack:UpsertPq      | 63.670 us                 | 124.814 us                |
| ProcessOneStep            | 356.984 ms                | 1.461 s                   |
| BlockToStepN              | 192.791 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:18.399482 21005 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=165, sample_step_cpp_seen_[rank]=164
E20240131 14:27:18.400257 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:27:19.113585 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240131 14:27:19.400077 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:27:20.209851 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240131 14:27:20.400168 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 166 ========== 
W20240131 14:27:21.255324 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 167 ========== 
E20240131 14:27:21.411950 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 168 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 205.537 us                | 450.192 us                |
| GenInput                  | 76.755 ms                 | 101.872 ms                |
| NN                        | 1.184 ms                  | 15.218 ms                 |
| Forward                   | 1.689 ms                  | 16.811 ms                 |
| Backward                  | 5.453 ms                  | 26.613 ms                 |
| Optimize                  | 295.162 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.145 ms                  | 8.028 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 300.675 us                | 6.319 ms                  |
| OneStep                   | 445.078 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:22.268841 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 14:27:22.411013 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=237
W20240131 14:27:22.681617 21005 grad_async_v2.h:257] pq is empty
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
W20240131 14:27:23.294440 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 149.662 us                | 31.788 ms                 |
| ProcessBack:Shuffle       | 339.255 ms                | 1.176 s                   |
| ProcessBack:UpdateCache   | 1.343 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 124.814 us                |
| ProcessOneStep            | 356.984 ms                | 2.292 s                   |
| BlockToStepN              | 205.529 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 172 ========== 
E20240131 14:27:23.420675 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=45
E20240131 14:27:24.420455 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:27:24.453595 21005 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
W20240131 14:27:24.484741 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 174 ========== 
E20240131 14:27:25.420635 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240131 14:27:25.639407 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
E20240131 14:27:26.420177 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:27:26.649966 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 206.196 us                | 450.192 us                |
| GenInput                  | 77.004 ms                 | 101.872 ms                |
| NN                        | 1.187 ms                  | 15.218 ms                 |
| Forward                   | 1.689 ms                  | 16.811 ms                 |
| Backward                  | 5.453 ms                  | 26.613 ms                 |
| Optimize                  | 301.361 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.132 ms                  | 8.028 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 306.727 us                | 6.319 ms                  |
| OneStep                   | 445.078 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 178 ========== 
E20240131 14:27:27.420341 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
========== Step 179 ========== 
========== Step 180 ========== 
W20240131 14:27:27.950852 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.605 us                | 31.574 ms                 |
| ProcessBack:Shuffle       | 339.255 ms                | 1.176 s                   |
| ProcessBack:UpdateCache   | 1.354 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 124.814 us                |
| ProcessOneStep            | 349.392 ms                | 2.292 s                   |
| BlockToStepN              | 207.549 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:28.420594 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=81
========== Step 181 ========== 
========== Step 182 ========== 
W20240131 14:27:29.340107 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
E20240131 14:27:29.420114 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=39
========== Step 183 ========== 
========== Step 184 ========== 
E20240131 14:27:30.420275 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
========== Step 185 ========== 
W20240131 14:27:30.684623 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240131 14:27:31.420012 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=128
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 206.701 us                | 450.192 us                |
| GenInput                  | 77.140 ms                 | 101.872 ms                |
| NN                        | 1.188 ms                  | 15.218 ms                 |
| Forward                   | 1.690 ms                  | 16.811 ms                 |
| Backward                  | 5.349 ms                  | 26.613 ms                 |
| Optimize                  | 301.600 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.132 ms                  | 8.866 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 317.062 us                | 6.319 ms                  |
| OneStep                   | 447.793 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:32.019366 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240131 14:27:32.420076 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=362
W20240131 14:27:32.500594 21005 grad_async_v2.h:257] pq is empty
========== Step 186 ========== 
W20240131 14:27:33.116325 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 187 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 162.368 us                | 32.315 ms                 |
| ProcessBack:Shuffle       | 347.850 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.368 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 124.814 us                |
| ProcessOneStep            | 361.842 ms                | 2.292 s                   |
| BlockToStepN              | 221.487 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:33.420115 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=131
========== Step 188 ========== 
W20240131 14:27:34.202137 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 189 ========== 
E20240131 14:27:34.420253 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=45
W20240131 14:27:34.452603 21005 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
W20240131 14:27:35.254081 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240131 14:27:35.420226 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
W20240131 14:27:36.128960 21005 grad_async_v2.h:257] pq is empty
========== Step 196 ========== 
========== Step 197 ========== 
E20240131 14:27:36.420161 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
W20240131 14:27:36.462764 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 206.701 us                | 450.192 us                |
| GenInput                  | 77.140 ms                 | 101.872 ms                |
| NN                        | 1.188 ms                  | 15.218 ms                 |
| Forward                   | 1.690 ms                  | 16.811 ms                 |
| Backward                  | 5.287 ms                  | 26.613 ms                 |
| Optimize                  | 302.315 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.136 ms                  | 8.866 ms                  |
| AfterBackward             | 340.903 ms                | 2.292 s                   |
| BlockToStepN              | 323.966 us                | 6.319 ms                  |
| OneStep                   | 436.977 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 198 ========== 
E20240131 14:27:37.420449 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
========== Step 199 ========== 
W20240131 14:27:37.662292 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 161.947 us                | 31.770 ms                 |
| ProcessBack:Shuffle       | 338.954 ms                | 1.327 s                   |
| ProcessBack:UpdateCache   | 1.389 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.203 us                 | 124.814 us                |
| ProcessOneStep            | 340.905 ms                | 2.292 s                   |
| BlockToStepN              | 225.434 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:38.420770 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:27:38.485299 21005 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 53.340, per_step: 0.528120
Step199:rank1, time: 53.340, per_step: 0.528119
Step199:rank2, time: 53.340, per_step: 0.528119
Step199:rank3, time: 53.340, per_step: 0.528119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 206.701 us                | 450.192 us                |
| GenInput                  | 77.111 ms                 | 101.872 ms                |
| NN                        | 1.193 ms                  | 15.218 ms                 |
| Forward                   | 1.694 ms                  | 16.811 ms                 |
| Backward                  | 5.287 ms                  | 26.613 ms                 |
| Optimize                  | 303.268 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.136 ms                  | 8.866 ms                  |
| AfterBackward             | 340.951 ms                | 2.292 s                   |
| BlockToStepN              | 326.647 us                | 6.319 ms                  |
| OneStep                   | 443.650 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 14:27:38.728468 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240131 14:27:39.349028 21005 grad_async_v2.h:257] pq is empty
========== Step 201 ========== 
E20240131 14:27:39.421154 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
========== Step 202 ========== 
W20240131 14:27:40.115926 21005 grad_async_v2.h:257] pq is empty
========== Step 203 ========== 
W20240131 14:27:40.267475 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 14:27:40.421316 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
E20240131 14:27:41.421106 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=52
W20240131 14:27:41.528913 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 207.012 us                | 450.192 us                |
| GenInput                  | 77.158 ms                 | 101.872 ms                |
| NN                        | 1.193 ms                  | 15.218 ms                 |
| Forward                   | 1.694 ms                  | 16.811 ms                 |
| Backward                  | 5.034 ms                  | 26.613 ms                 |
| Optimize                  | 303.268 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.132 ms                  | 8.866 ms                  |
| AfterBackward             | 349.426 ms                | 2.292 s                   |
| BlockToStepN              | 327.969 us                | 6.319 ms                  |
| OneStep                   | 445.078 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:42.278048 21005 grad_async_v2.h:257] pq is empty
========== Step 204 ========== 
E20240131 14:27:42.421584 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=56
W20240131 14:27:42.743048 21005 grad_async_v2.h:257] pq is empty
========== Step 205 ========== 
W20240131 14:27:43.284322 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 149.674 us                | 31.436 ms                 |
| ProcessBack:Shuffle       | 339.418 ms                | 1.420 s                   |
| ProcessBack:UpdateCache   | 1.390 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 124.814 us                |
| ProcessOneStep            | 356.984 ms                | 2.292 s                   |
| BlockToStepN              | 227.236 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:43.362926 21005 grad_async_v2.h:257] pq is empty
========== Step 206 ========== 
E20240131 14:27:43.423702 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=108
W20240131 14:27:44.303884 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240131 14:27:44.423547 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=40
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
W20240131 14:27:45.305068 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 14:27:45.423408 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 210 ========== 
E20240131 14:27:46.423097 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=37
W20240131 14:27:46.491086 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 211 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 207.845 us                | 450.192 us                |
| GenInput                  | 77.162 ms                 | 101.872 ms                |
| NN                        | 1.196 ms                  | 15.277 ms                 |
| Forward                   | 1.700 ms                  | 16.811 ms                 |
| Backward                  | 4.854 ms                  | 26.613 ms                 |
| Optimize                  | 303.507 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.104 ms                  | 8.866 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 330.811 us                | 6.319 ms                  |
| OneStep                   | 447.793 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 212 ========== 
E20240131 14:27:47.423048 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
W20240131 14:27:47.670821 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
W20240131 14:27:47.927414 21005 grad_async_v2.h:257] pq is empty
========== Step 213 ========== 
========== Step 214 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.961 us                | 31.519 ms                 |
| ProcessBack:Shuffle       | 339.255 ms                | 1.420 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.083 us                 | 124.814 us                |
| ProcessOneStep            | 349.392 ms                | 2.292 s                   |
| BlockToStepN              | 232.237 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:48.424746 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=184
========== Step 215 ========== 
W20240131 14:27:48.711330 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240131 14:27:48.735626 21005 grad_async_v2.h:257] pq is empty
========== Step 216 ========== 
========== Step 217 ========== 
E20240131 14:27:49.435940 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 218 ========== 
W20240131 14:27:49.969609 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
========== Step 219 ========== 
E20240131 14:27:50.435199 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
========== Step 220 ========== 
W20240131 14:27:51.102519 21005 grad_async_v2.h:257] pq is empty
========== Step 221 ========== 
E20240131 14:27:51.435065 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 207.845 us                | 450.192 us                |
| GenInput                  | 77.111 ms                 | 101.872 ms                |
| NN                        | 1.197 ms                  | 15.277 ms                 |
| Forward                   | 1.706 ms                  | 16.811 ms                 |
| Backward                  | 5.034 ms                  | 26.613 ms                 |
| Optimize                  | 304.699 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.115 ms                  | 9.132 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 336.413 us                | 6.319 ms                  |
| OneStep                   | 447.793 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 222 ========== 
W20240131 14:27:52.341171 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240131 14:27:52.435360 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 150.712 us                | 25.746 ms                 |
| ProcessBack:Shuffle       | 339.418 ms                | 1.420 s                   |
| ProcessBack:UpdateCache   | 1.390 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.203 us                 | 124.814 us                |
| ProcessOneStep            | 356.984 ms                | 2.292 s                   |
| BlockToStepN              | 234.656 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:53.435257 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=53
W20240131 14:27:54.065810 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 223 ========== 
E20240131 14:27:54.435534 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=110
========== Step 224 ========== 
E20240131 14:27:55.435168 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240131 14:27:55.442203 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 225 ========== 
========== Step 226 ========== 
E20240131 14:27:56.435321 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:27:56.573796 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.188 us                | 450.192 us                |
| GenInput                  | 77.111 ms                 | 101.872 ms                |
| NN                        | 1.212 ms                  | 15.277 ms                 |
| Forward                   | 1.718 ms                  | 16.811 ms                 |
| Backward                  | 5.034 ms                  | 26.613 ms                 |
| Optimize                  | 304.699 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.136 ms                  | 9.132 ms                  |
| AfterBackward             | 361.889 ms                | 2.292 s                   |
| BlockToStepN              | 339.670 us                | 6.319 ms                  |
| OneStep                   | 450.205 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:27:57.251080 21005 grad_async_v2.h:257] pq is empty
========== Step 227 ========== 
E20240131 14:27:57.435261 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=178
W20240131 14:27:57.669171 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:27:57.824451 21005 grad_async_v2.h:257] pq is empty
========== Step 228 ========== 
========== Step 229 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 156.572 us                | 31.420 ms                 |
| ProcessBack:Shuffle       | 355.305 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.396 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.312 us                 | 124.814 us                |
| ProcessOneStep            | 365.046 ms                | 2.292 s                   |
| BlockToStepN              | 244.654 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:27:58.435249 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 230 ========== 
W20240131 14:27:59.034845 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 231 ========== 
========== Step 232 ========== 
E20240131 14:27:59.435093 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=89
========== Step 233 ========== 
W20240131 14:28:00.401999 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240131 14:28:00.435120 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
E20240131 14:28:01.435211 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
========== Step 234 ========== 
W20240131 14:28:01.715899 21856 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.425 us                | 450.192 us                |
| GenInput                  | 77.111 ms                 | 101.872 ms                |
| NN                        | 1.213 ms                  | 15.277 ms                 |
| Forward                   | 1.721 ms                  | 16.811 ms                 |
| Backward                  | 4.903 ms                  | 26.613 ms                 |
| Optimize                  | 304.937 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.136 ms                  | 9.132 ms                  |
| AfterBackward             | 361.889 ms                | 2.292 s                   |
| BlockToStepN              | 355.410 us                | 6.319 ms                  |
| OneStep                   | 450.205 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:02.436024 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 14:28:02.496107 21005 grad_async_v2.h:257] pq is empty
========== Step 235 ========== 
W20240131 14:28:02.886723 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 236 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.977 us                | 27.541 ms                 |
| ProcessBack:Shuffle       | 355.305 ms                | 1.850 s                   |
| ProcessBack:UpdateCache   | 1.392 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.312 us                 | 124.814 us                |
| ProcessOneStep            | 365.046 ms                | 2.292 s                   |
| BlockToStepN              | 249.045 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:03.436457 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:28:03.848237 21005 grad_async_v2.h:257] pq is empty
========== Step 237 ========== 
W20240131 14:28:03.887315 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 238 ========== 
========== Step 239 ========== 
E20240131 14:28:04.436090 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:05.267573 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 14:28:05.436120 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:05.701928 21005 grad_async_v2.h:257] pq is empty
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
E20240131 14:28:06.436303 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=196
========== Step 243 ========== 
W20240131 14:28:06.678340 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.188 us                | 450.192 us                |
| GenInput                  | 77.004 ms                 | 101.872 ms                |
| NN                        | 1.213 ms                  | 15.277 ms                 |
| Forward                   | 1.721 ms                  | 16.811 ms                 |
| Backward                  | 4.769 ms                  | 26.613 ms                 |
| Optimize                  | 307.560 us                | 4.094 ms                  |
| BarrierTimeBeforeRank0    | 1.115 ms                  | 9.132 ms                  |
| AfterBackward             | 365.407 ms                | 2.292 s                   |
| BlockToStepN              | 367.050 us                | 6.319 ms                  |
| OneStep                   | 451.853 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 244 ========== 
E20240131 14:28:07.436095 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=170
W20240131 14:28:07.799388 21005 grad_async_v2.h:257] pq is empty
========== Step 245 ========== 
W20240131 14:28:08.019158 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 246 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.133 us                | 34.064 ms                 |
| ProcessBack:Shuffle       | 347.850 ms                | 1.850 s                   |
| ProcessBack:UpdateCache   | 1.390 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.203 us                 | 124.814 us                |
| ProcessOneStep            | 361.842 ms                | 2.292 s                   |
| BlockToStepN              | 253.877 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:08.436020 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
E20240131 14:28:09.436180 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:28:09.477392 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
E20240131 14:28:10.436321 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
========== Step 253 ========== 
========== Step 254 ========== 
W20240131 14:28:11.185648 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
========== Step 255 ========== 
E20240131 14:28:11.436055 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 209.081 us                | 377.529 us                |
| GenInput                  | 76.755 ms                 | 101.357 ms                |
| NN                        | 1.216 ms                  | 15.218 ms                 |
| Forward                   | 1.727 ms                  | 16.402 ms                 |
| Backward                  | 4.903 ms                  | 23.379 ms                 |
| Optimize                  | 307.560 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.104 ms                  | 9.132 ms                  |
| AfterBackward             | 349.426 ms                | 2.052 s                   |
| BlockToStepN              | 381.784 us                | 3.146 ms                  |
| OneStep                   | 445.078 ms                | 2.372 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 256 ========== 
========== Step 257 ========== 
W20240131 14:28:12.403065 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 14:28:12.436220 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=62
========== Step 258 ========== 
E20240131 14:28:13.279496 21005 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=258, sample_step_cpp_seen_[rank]=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.081 us                | 44.808 ms                 |
| ProcessBack:Shuffle       | 339.418 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.391 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.132 us                 | 122.161 us                |
| ProcessOneStep            | 349.392 ms                | 2.052 s                   |
| BlockToStepN              | 262.287 us                | 3.088 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:13.436417 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:28:13.765848 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240131 14:28:14.436333 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:28:15.125859 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240131 14:28:15.437034 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:28:16.137058 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 259 ========== 
E20240131 14:28:16.437168 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 209.081 us                | 377.529 us                |
| GenInput                  | 76.643 ms                 | 101.357 ms                |
| NN                        | 1.216 ms                  | 15.218 ms                 |
| Forward                   | 1.727 ms                  | 16.402 ms                 |
| Backward                  | 4.983 ms                  | 23.379 ms                 |
| Optimize                  | 307.798 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.104 ms                  | 9.132 ms                  |
| AfterBackward             | 357.030 ms                | 2.292 s                   |
| BlockToStepN              | 384.963 us                | 3.146 ms                  |
| OneStep                   | 447.793 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:28:17.343899 21005 grad_async_v2.h:257] pq is empty
========== Step 260 ========== 
W20240131 14:28:17.379837 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:28:17.437263 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 261 ========== 
========== Step 262 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.730 us                | 27.680 ms                 |
| ProcessBack:Shuffle       | 339.418 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.391 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.132 us                 | 124.814 us                |
| ProcessOneStep            | 356.984 ms                | 2.292 s                   |
| BlockToStepN              | 267.980 us                | 3.088 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:28:18.406327 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 14:28:18.437119 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=49
========== Step 263 ========== 
========== Step 264 ========== 
E20240131 14:28:19.437129 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:19.600818 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 265 ========== 
E20240131 14:28:20.437224 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=102
W20240131 14:28:20.714743 21005 grad_async_v2.h:257] pq is empty
========== Step 266 ========== 
W20240131 14:28:20.732522 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 267 ========== 
E20240131 14:28:21.437091 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 209.643 us                | 377.529 us                |
| GenInput                  | 76.755 ms                 | 101.872 ms                |
| NN                        | 1.216 ms                  | 15.218 ms                 |
| Forward                   | 1.727 ms                  | 16.402 ms                 |
| Backward                  | 5.034 ms                  | 24.835 ms                 |
| Optimize                  | 306.845 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.098 ms                  | 9.132 ms                  |
| AfterBackward             | 365.407 ms                | 2.292 s                   |
| BlockToStepN              | 392.165 us                | 6.319 ms                  |
| OneStep                   | 451.853 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:28:21.786787 21005 grad_async_v2.h:257] pq is empty
========== Step 268 ========== 
W20240131 14:28:21.808663 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 14:28:22.332551 21005 grad_async_v2.h:257] pq is empty
========== Step 269 ========== 
E20240131 14:28:22.437070 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=114
W20240131 14:28:22.931430 21005 grad_async_v2.h:257] pq is empty
========== Step 270 ========== 
W20240131 14:28:22.956445 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 150.938 us                | 23.755 ms                 |
| ProcessBack:Shuffle       | 355.305 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.391 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.217 us                 | 124.814 us                |
| ProcessOneStep            | 370.196 ms                | 2.292 s                   |
| BlockToStepN              | 269.540 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:23.437068 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:23.481357 21005 grad_async_v2.h:257] pq is empty
========== Step 271 ========== 
W20240131 14:28:24.062942 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 14:28:24.283237 21005 grad_async_v2.h:257] pq is empty
========== Step 272 ========== 
E20240131 14:28:24.437106 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
========== Step 273 ========== 
========== Step 274 ========== 
W20240131 14:28:25.146358 21005 grad_async_v2.h:257] pq is empty
========== Step 275 ========== 
W20240131 14:28:25.176491 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 14:28:25.437706 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
========== Step 276 ========== 
E20240131 14:28:26.437036 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:28:26.616437 21856 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.425 us                | 377.529 us                |
| GenInput                  | 76.528 ms                 | 101.872 ms                |
| NN                        | 1.213 ms                  | 15.218 ms                 |
| Forward                   | 1.726 ms                  | 16.402 ms                 |
| Backward                  | 4.983 ms                  | 24.835 ms                 |
| Optimize                  | 307.560 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.092 ms                  | 9.134 ms                  |
| AfterBackward             | 371.217 ms                | 2.292 s                   |
| BlockToStepN              | 393.273 us                | 6.319 ms                  |
| OneStep                   | 464.962 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:27.437040 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:27.642576 21005 grad_async_v2.h:257] pq is empty
========== Step 277 ========== 
W20240131 14:28:27.665094 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.627 us                | 27.391 ms                 |
| ProcessBack:Shuffle       | 355.305 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.390 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.217 us                 | 124.814 us                |
| ProcessOneStep            | 370.196 ms                | 2.292 s                   |
| BlockToStepN              | 272.858 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:28.437263 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
========== Step 281 ========== 
W20240131 14:28:28.943738 21856 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
========== Step 282 ========== 
========== Step 283 ========== 
E20240131 14:28:29.437029 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:28:30.365731 21856 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
W20240131 14:28:30.418301 21005 grad_async_v2.h:257] pq is empty
========== Step 284 ========== 
E20240131 14:28:30.448329 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:28:31.448486 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
W20240131 14:28:31.509783 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.047 us                | 398.834 us                |
| GenInput                  | 76.508 ms                 | 101.872 ms                |
| NN                        | 1.201 ms                  | 15.277 ms                 |
| Forward                   | 1.718 ms                  | 16.811 ms                 |
| Backward                  | 4.983 ms                  | 24.835 ms                 |
| Optimize                  | 304.937 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.098 ms                  | 9.134 ms                  |
| AfterBackward             | 370.224 ms                | 2.292 s                   |
| BlockToStepN              | 398.592 us                | 6.319 ms                  |
| OneStep                   | 463.068 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:28:32.227017 21005 grad_async_v2.h:257] pq is empty
========== Step 285 ========== 
E20240131 14:28:32.448078 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=30
W20240131 14:28:32.635782 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:28:32.791129 21005 grad_async_v2.h:257] pq is empty
========== Step 286 ========== 
========== Step 287 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 158.634 us                | 27.335 ms                 |
| ProcessBack:Shuffle       | 360.116 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.389 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.217 us                 | 124.814 us                |
| ProcessOneStep            | 371.188 ms                | 2.292 s                   |
| BlockToStepN              | 276.782 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:33.448516 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:28:33.652247 21856 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 288 ========== 
E20240131 14:28:34.448133 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240131 14:28:34.551074 21005 grad_async_v2.h:257] pq is empty
========== Step 289 ========== 
W20240131 14:28:34.694900 21856 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 14:28:35.123263 21005 grad_async_v2.h:257] pq is empty
========== Step 290 ========== 
E20240131 14:28:35.448549 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240131 14:28:35.683053 21005 grad_async_v2.h:257] pq is empty
========== Step 291 ========== 
W20240131 14:28:35.708572 21856 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 292 ========== 
========== Step 293 ========== 
E20240131 14:28:36.448359 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.425 us                | 398.834 us                |
| GenInput                  | 76.229 ms                 | 101.872 ms                |
| NN                        | 1.201 ms                  | 15.277 ms                 |
| Forward                   | 1.721 ms                  | 16.811 ms                 |
| Backward                  | 4.983 ms                  | 24.835 ms                 |
| Optimize                  | 304.699 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.104 ms                  | 9.134 ms                  |
| AfterBackward             | 371.655 ms                | 2.292 s                   |
| BlockToStepN              | 405.882 us                | 6.319 ms                  |
| OneStep                   | 465.369 ms                | 2.493 s                   |
| E2E-100                   | 53.340 s                  | 59.251 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:28:36.863803 21856 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 294 ========== 
E20240131 14:28:37.448104 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240131 14:28:37.791185 21005 grad_async_v2.h:257] pq is empty
========== Step 295 ========== 
W20240131 14:28:38.010628 21856 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 296 ========== 
W20240131 14:28:38.256553 21005 grad_async_v2.h:257] pq is empty
========== Step 297 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 167.885 us                | 31.554 ms                 |
| ProcessBack:Shuffle       | 362.902 ms                | 1.813 s                   |
| ProcessBack:UpdateCache   | 1.384 ms                  | 17.187 ms                 |
| ProcessBack:UpsertPq      | 64.203 us                 | 124.814 us                |
| ProcessOneStep            | 371.623 ms                | 2.292 s                   |
| BlockToStepN              | 283.576 us                | 6.112 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:28:38.448179 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
========== Step 298 ========== 
W20240131 14:28:39.161137 21856 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
========== Step 299 ========== 
E20240131 14:28:39.449198 21856 parallel_pq_v2.h:79] insert failed, size(hashtable)=37
Step299:rank0, time: 61.141, per_step: 0.605353
Step299:rank2, time: 61.141, per_step: 0.605352
Step299:rank3, time: 61.141, per_step: 0.605353
Step299:rank1, time: 61.141, per_step: 0.605353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 208.188 us                | 398.834 us                |
| GenInput                  | 76.229 ms                 | 101.872 ms                |
| NN                        | 1.212 ms                  | 15.277 ms                 |
| Forward                   | 1.724 ms                  | 16.811 ms                 |
| Backward                  | 4.903 ms                  | 24.835 ms                 |
| Optimize                  | 303.507 us                | 2.889 ms                  |
| BarrierTimeBeforeRank0    | 1.132 ms                  | 9.134 ms                  |
| AfterBackward             | 371.217 ms                | 2.292 s                   |
| BlockToStepN              | 408.678 us                | 6.319 ms                  |
| OneStep                   | 465.369 ms                | 2.493 s                   |
| E2E-100                   | 59.251 s                  | 61.141 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 14:28:39.627732 21005 grad_async_v2.h:84] call StopThreads. PID = 21005
W20240131 14:28:39.627754 21005 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 14:28:39.627795 21005 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 14:28:39.627808 21005 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240131 14:28:40.114482 21005 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
ERROR [21005 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f68b9608690>
