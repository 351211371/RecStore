WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 17:02:18.587680 12351 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 17:02:18.591054 12351 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [12351 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f3dc01019e0>==========
Worker 1 pid=12499
Worker 2 pid=12500
Worker 3 pid=12501
Worker 4 pid=12502
Worker 5 pid=12503
Worker 6 pid=12504
INFO [12351 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [12499 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12500 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12503 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12501 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [12504 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [12505 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [12502 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [12502 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12505 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:02:36.625588 12505 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:02:36.625593 12502 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [12503 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12501 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12504 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:02:36.629796 12503 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:02:36.629802 12501 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [12351 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12500 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:02:36.630420 12504 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [12499 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:02:36.631013 12351 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:02:36.631251 12499 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:02:36.631250 12500 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 17:02:55.302136 12499 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240131 17:02:55.303975 12502 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1688128, 32]; dev=4; size=206.1 MB
W20240131 17:02:55.304275 12505 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1688128, 32]; dev=7; size=206.1 MB
W20240131 17:02:55.305966 12351 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240131 17:02:55.306130 12503 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1688128, 32]; dev=5; size=206.1 MB
W20240131 17:02:55.306313 12501 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240131 17:02:55.306824 12504 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1688128, 32]; dev=6; size=206.1 MB
W20240131 17:02:55.307180 12500 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240131 17:02:56.041481 12502 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10010196e000 7.629 MB
W20240131 17:02:56.041635 12502 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100102111000 7.629 MB
W20240131 17:02:56.041705 12502 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1001028b4000 122.1 MB
W20240131 17:02:56.041747 12502 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x10010a2c8000 122.1 MB
W20240131 17:02:56.041808 12502 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 17:02:56.045264 12502 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 17:02:56.066372 12505 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100111ce2000 7.629 MB
W20240131 17:02:56.066529 12505 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100112485000 7.629 MB
W20240131 17:02:56.066596 12505 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x100112c28000 122.1 MB
W20240131 17:02:56.066641 12505 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10011a63c000 122.1 MB
W20240131 17:02:56.066696 12505 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 17:02:56.067330 12505 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 17:02:56.080734 12504 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100122056000 7.629 MB
W20240131 17:02:56.080891 12504 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1001227f9000 7.629 MB
W20240131 17:02:56.080993 12504 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100122f9c000 122.1 MB
W20240131 17:02:56.081037 12504 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x10012a9b0000 122.1 MB
W20240131 17:02:56.081087 12504 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 17:02:56.086186 12504 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 17:02:56.096580 12501 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1001323ca000 7.629 MB
W20240131 17:02:56.096776 12501 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100132b6d000 7.629 MB
W20240131 17:02:56.096879 12501 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100133310000 122.1 MB
W20240131 17:02:56.096932 12501 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10013ad24000 122.1 MB
W20240131 17:02:56.096992 12501 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 17:02:56.098290 12501 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 17:02:56.116894 12503 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100142740000 7.629 MB
W20240131 17:02:56.117058 12503 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100142ee3000 7.629 MB
W20240131 17:02:56.117164 12503 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x100143686000 122.1 MB
W20240131 17:02:56.117230 12503 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x10014b09a000 122.1 MB
W20240131 17:02:56.117297 12503 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 17:02:56.117514 12351 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100152aae000 7.629 MB
W20240131 17:02:56.117681 12503 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 17:02:56.117834 12351 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100153253000 7.629 MB
W20240131 17:02:56.117950 12351 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1001539f6000 122.1 MB
W20240131 17:02:56.118104 12351 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10015b40c000 122.1 MB
W20240131 17:02:56.118227 12351 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 17:02:56.118687 12351 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 17:02:56.122761 12499 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100162e26000 7.629 MB
W20240131 17:02:56.123117 12499 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1001635c9000 7.629 MB
W20240131 17:02:56.123171 12499 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100163d6c000 122.1 MB
W20240131 17:02:56.123214 12499 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10016b780000 122.1 MB
W20240131 17:02:56.123271 12499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 17:02:56.123605 12499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 17:02:56.128996 12500 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10017319a000 7.629 MB
W20240131 17:02:56.129096 12500 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10017393d000 7.629 MB
W20240131 17:02:56.129150 12500 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1001740e0000 122.1 MB
W20240131 17:02:56.129194 12500 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10017baf4000 122.1 MB
W20240131 17:02:56.129241 12500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 17:02:56.129585 12500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
Worker 7 pid=12505
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512), (6752512, 8440640), (8440640, 10128768), (10128768, 11816896), (11816896, 13505024)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
W20240131 17:03:03.495502 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10018350c000 7.629 MB
W20240131 17:03:03.495735 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100183caf000 7.629 MB
W20240131 17:03:03.495776 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100184452000 7.629 MB
W20240131 17:03:03.495826 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100184bf5000 7.629 MB
W20240131 17:03:03.495857 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100185398000 7.629 MB
W20240131 17:03:03.495888 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100185b3b000 7.629 MB
W20240131 17:03:03.495918 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1001862de000 7.629 MB
W20240131 17:03:03.495971 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100186a81000 7.629 MB
W20240131 17:03:03.496001 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100187224000 7.629 MB
W20240131 17:03:03.496034 12351 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001879c7000 7.629 MB
W20240131 17:03:03.496093 12351 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10018816a000 80 B 
W20240131 17:03:03.496133 12351 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10018816c000 8 B 
W20240131 17:03:03.496165 12351 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100188911000 8 B 
W20240131 17:03:03.496165 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10018816e000 7.629 MB
W20240131 17:03:03.496322 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100188913000 7.629 MB
W20240131 17:03:03.496389 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1001890b6000 7.629 MB
W20240131 17:03:03.496428 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100189859000 7.629 MB
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
W20240131 17:03:03.496467 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100189ffc000 7.629 MB
W20240131 17:03:03.496515 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10018a79f000 7.629 MB
I20240131 17:03:03.496556 12351 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 17:03:03.496562 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10018af42000 7.629 MB
W20240131 17:03:03.496620 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10018b6e5000 7.629 MB
W20240131 17:03:03.496660 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10018be88000 7.629 MB
W20240131 17:03:03.496716 12501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10018c62b000 7.629 MB
W20240131 17:03:03.496753 12501 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10018cdce000 80 B 
W20240131 17:03:03.496796 12501 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10018cdd0000 8 B 
W20240131 17:03:03.496836 12501 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10018cdd2000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:03.497198 12501 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:03.528601 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10018cdd4000 7.629 MB
W20240131 17:03:03.528879 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10018d577000 7.629 MB
W20240131 17:03:03.528931 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10018dd1a000 7.629 MB
W20240131 17:03:03.528971 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10018e4bd000 7.629 MB
W20240131 17:03:03.529019 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10018ec60000 7.629 MB
W20240131 17:03:03.529094 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10018f403000 7.629 MB
W20240131 17:03:03.529166 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10018fba6000 7.629 MB
W20240131 17:03:03.529258 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100190349000 7.629 MB
W20240131 17:03:03.529297 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100190aec000 7.629 MB
W20240131 17:03:03.529385 12499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10019128f000 7.629 MB
W20240131 17:03:03.529424 12499 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100191a32000 80 B 
W20240131 17:03:03.529465 12499 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100191a34000 8 B 
W20240131 17:03:03.529521 12499 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100191a36000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:03.530066 12499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:04.253540 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x100191a38000 7.629 MB
W20240131 17:03:04.253762 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1001921db000 7.629 MB
W20240131 17:03:04.253823 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10019297e000 7.629 MB
W20240131 17:03:04.253866 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100193121000 7.629 MB
W20240131 17:03:04.253906 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1001938c4000 7.629 MB
W20240131 17:03:04.253962 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100194067000 7.629 MB
W20240131 17:03:04.254011 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10019480a000 7.629 MB
W20240131 17:03:04.254065 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100194fad000 7.629 MB
W20240131 17:03:04.254102 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x100195750000 7.629 MB
W20240131 17:03:04.254148 12505 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100195ef3000 7.629 MB
W20240131 17:03:04.254189 12505 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x100196696000 80 B 
W20240131 17:03:04.254251 12505 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100196698000 8 B 
W20240131 17:03:04.254292 12505 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10019669a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:04.254658 12505 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:04.912575 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10019669c000 7.629 MB
W20240131 17:03:04.912995 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100196e3f000 7.629 MB
W20240131 17:03:04.913048 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1001975e2000 7.629 MB
W20240131 17:03:04.913102 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100197d85000 7.629 MB
W20240131 17:03:04.913148 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100198528000 7.629 MB
W20240131 17:03:04.913198 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x100198ccb000 7.629 MB
W20240131 17:03:04.913250 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10019946e000 7.629 MB
W20240131 17:03:04.913313 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100199c11000 7.629 MB
W20240131 17:03:04.913353 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10019a3b4000 7.629 MB
W20240131 17:03:04.913396 12502 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10019ab57000 7.629 MB
W20240131 17:03:04.913436 12502 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x10019b2fa000 80 B 
W20240131 17:03:04.913479 12502 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10019b2fc000 8 B 
W20240131 17:03:04.913518 12502 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10019b2fe000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:04.914047 12502 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:05.096056 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10019b300000 7.629 MB
W20240131 17:03:05.096233 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10019baa3000 7.629 MB
W20240131 17:03:05.096287 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10019c246000 7.629 MB
W20240131 17:03:05.096328 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10019c9e9000 7.629 MB
W20240131 17:03:05.096369 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10019d18c000 7.629 MB
W20240131 17:03:05.096415 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10019d92f000 7.629 MB
W20240131 17:03:05.096462 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10019e0d2000 7.629 MB
W20240131 17:03:05.096521 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10019e875000 7.629 MB
W20240131 17:03:05.096560 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10019f018000 7.629 MB
W20240131 17:03:05.096604 12504 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10019f7bb000 7.629 MB
W20240131 17:03:05.096658 12504 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x10019ff5e000 80 B 
W20240131 17:03:05.096705 12504 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10019ff60000 8 B 
W20240131 17:03:05.096746 12504 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10019ff62000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:05.097059 12504 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:05.100356 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10019ff64000 7.629 MB
W20240131 17:03:05.100512 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1001a0707000 7.629 MB
W20240131 17:03:05.100560 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001a0eaa000 7.629 MB
W20240131 17:03:05.100598 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1001a164d000 7.629 MB
W20240131 17:03:05.100636 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001a1df0000 7.629 MB
W20240131 17:03:05.100682 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001a2593000 7.629 MB
W20240131 17:03:05.100730 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1001a2d36000 7.629 MB
W20240131 17:03:05.100782 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1001a34d9000 7.629 MB
W20240131 17:03:05.100822 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1001a3c7c000 7.629 MB
W20240131 17:03:05.100869 12500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1001a441f000 7.629 MB
W20240131 17:03:05.100905 12500 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1001a4bc2000 80 B 
W20240131 17:03:05.100946 12500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1001a4bc4000 8 B 
W20240131 17:03:05.100986 12500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1001a4bc6000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:05.101305 12500 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:03:05.426927 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1001a4bc8000 7.629 MB
W20240131 17:03:05.427078 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1001a536b000 7.629 MB
W20240131 17:03:05.427130 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1001a5b0e000 7.629 MB
W20240131 17:03:05.427173 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1001a62b1000 7.629 MB
W20240131 17:03:05.427217 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1001a6a54000 7.629 MB
W20240131 17:03:05.427268 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1001a71f7000 7.629 MB
W20240131 17:03:05.427320 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1001a799a000 7.629 MB
W20240131 17:03:05.427377 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1001a813d000 7.629 MB
W20240131 17:03:05.427418 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1001a88e0000 7.629 MB
W20240131 17:03:05.427464 12503 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1001a9083000 7.629 MB
W20240131 17:03:05.427503 12503 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1001a9826000 80 B 
W20240131 17:03:05.427547 12503 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1001a9828000 8 B 
W20240131 17:03:05.427588 12503 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1001a982a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:03:05.427889 12503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240131 17:03:07.200721 12504 recstore.cc:66] init folly done
E20240131 17:03:07.200749 12503 recstore.cc:66] init folly done
E20240131 17:03:07.200783 12351 recstore.cc:66] init folly done
E20240131 17:03:07.200815 12500 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 17:03:07.200855 12505 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 17:03:07.200862 12499 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 17:03:07.200939 12502 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 17:03:07.200954 12501 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Before Training
Before Training
I20240131 17:03:09.191694 12505 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240131 17:03:09.191772 12351 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:03:09.191799 12500 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:03:09.191825 12504 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 17:03:09.191987 12499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240131 17:03:09.192150 12503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:03:09.192174 12502 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 17:03:09.192353 12501 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 233.228 us                | 233.228 us                |
| GenInput                  | 102.072 ms                | 102.072 ms                |
| NN                        | 151.047 ms                | 151.047 ms                |
| Forward                   | 198.485 ms                | 198.485 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
INFO [12351 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12505 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12502 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12500 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12501 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12504 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12499 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [12503 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 228.185 us                | 631.437 us                |
| GenInput                  | 84.778 ms                 | 112.288 ms                |
| NN                        | 2.972 ms                  | 151.047 ms                |
| Forward                   | 4.439 ms                  | 198.485 ms                |
| Backward                  | 916.234 ms                | 2.631 s                   |
| Optimize                  | 63.551 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 102.382 us                | 128.004 us                |
| BlockToStepN              | 2.025 ms                  | 2.265 ms                  |
| OneStep                   | 1.100 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 233.228 us                | 631.437 us                |
| GenInput                  | 84.778 ms                 | 114.395 ms                |
| NN                        | 2.972 ms                  | 151.047 ms                |
| Forward                   | 4.439 ms                  | 198.485 ms                |
| Backward                  | 901.217 ms                | 2.631 s                   |
| Optimize                  | 63.551 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 87.886 us                 | 135.431 us                |
| BlockToStepN              | 364.569 us                | 2.265 ms                  |
| OneStep                   | 1.082 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 243.622 us                | 631.437 us                |
| GenInput                  | 86.392 ms                 | 114.395 ms                |
| NN                        | 2.094 ms                  | 151.047 ms                |
| Forward                   | 3.085 ms                  | 198.485 ms                |
| Backward                  | 901.217 ms                | 2.631 s                   |
| Optimize                  | 63.275 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 87.138 us                 | 135.431 us                |
| BlockToStepN              | 291.413 us                | 2.265 ms                  |
| OneStep                   | 1.082 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 243.622 us                | 1.154 ms                  |
| GenInput                  | 99.667 ms                 | 123.170 ms                |
| NN                        | 2.094 ms                  | 151.047 ms                |
| Forward                   | 3.085 ms                  | 198.485 ms                |
| Backward                  | 884.662 ms                | 2.631 s                   |
| Optimize                  | 57.476 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 83.022 us                 | 508.679 us                |
| BlockToStepN              | 180.249 us                | 2.265 ms                  |
| OneStep                   | 1.057 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 243.622 us                | 1.154 ms                  |
| GenInput                  | 99.667 ms                 | 129.475 ms                |
| NN                        | 1.953 ms                  | 151.047 ms                |
| Forward                   | 2.854 ms                  | 198.485 ms                |
| Backward                  | 883.439 ms                | 2.631 s                   |
| Optimize                  | 59.085 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 83.022 us                 | 508.679 us                |
| BlockToStepN              | 258.410 us                | 2.265 ms                  |
| OneStep                   | 1.058 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 228.185 us                | 1.154 ms                  |
| GenInput                  | 99.067 ms                 | 129.475 ms                |
| NN                        | 1.928 ms                  | 151.047 ms                |
| Forward                   | 2.789 ms                  | 198.485 ms                |
| Backward                  | 884.662 ms                | 2.631 s                   |
| Optimize                  | 62.276 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 83.022 us                 | 508.679 us                |
| BlockToStepN              | 258.410 us                | 2.265 ms                  |
| OneStep                   | 1.059 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 223.821 us                | 1.154 ms                  |
| GenInput                  | 99.667 ms                 | 129.475 ms                |
| NN                        | 1.902 ms                  | 151.047 ms                |
| Forward                   | 2.692 ms                  | 198.485 ms                |
| Backward                  | 886.290 ms                | 2.631 s                   |
| Optimize                  | 59.085 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 83.022 us                 | 508.679 us                |
| BlockToStepN              | 258.410 us                | 2.265 ms                  |
| OneStep                   | 1.060 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.748 us                | 1.154 ms                  |
| GenInput                  | 99.667 ms                 | 129.475 ms                |
| NN                        | 1.740 ms                  | 151.047 ms                |
| Forward                   | 2.574 ms                  | 198.485 ms                |
| Backward                  | 886.290 ms                | 2.631 s                   |
| Optimize                  | 58.347 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 80.317 us                 | 508.679 us                |
| BlockToStepN              | 226.178 us                | 2.265 ms                  |
| OneStep                   | 1.060 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 219.296 us                | 1.154 ms                  |
| GenInput                  | 99.040 ms                 | 129.475 ms                |
| NN                        | 1.740 ms                  | 151.047 ms                |
| Forward                   | 2.363 ms                  | 198.485 ms                |
| Backward                  | 884.662 ms                | 2.631 s                   |
| Optimize                  | 57.341 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 78.301 us                 | 508.679 us                |
| BlockToStepN              | 226.178 us                | 2.265 ms                  |
| OneStep                   | 1.058 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 219.296 us                | 1.154 ms                  |
| GenInput                  | 99.040 ms                 | 129.475 ms                |
| NN                        | 1.736 ms                  | 151.047 ms                |
| Forward                   | 2.363 ms                  | 198.485 ms                |
| Backward                  | 883.439 ms                | 2.631 s                   |
| Optimize                  | 57.223 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 66.797 us                 | 508.679 us                |
| BlockToStepN              | 258.410 us                | 2.265 ms                  |
| OneStep                   | 1.057 s                   | 3.107 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.637 us                | 725.175 us                |
| GenInput                  | 99.040 ms                 | 128.772 ms                |
| NN                        | 1.679 ms                  | 9.178 ms                  |
| Forward                   | 2.363 ms                  | 13.167 ms                 |
| Backward                  | 884.662 ms                | 950.894 ms                |
| Optimize                  | 57.279 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 78.301 us                 | 477.570 us                |
| BlockToStepN              | 253.530 us                | 2.025 ms                  |
| OneStep                   | 1.058 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.094 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.679 ms                  | 9.178 ms                  |
| Forward                   | 2.363 ms                  | 13.167 ms                 |
| Backward                  | 884.662 ms                | 950.894 ms                |
| Optimize                  | 57.279 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 75.617 us                 | 477.570 us                |
| BlockToStepN              | 226.178 us                | 2.025 ms                  |
| OneStep                   | 1.058 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.094 us                | 725.175 us                |
| GenInput                  | 100.820 ms                | 128.772 ms                |
| NN                        | 1.679 ms                  | 9.178 ms                  |
| Forward                   | 2.363 ms                  | 13.167 ms                 |
| Backward                  | 880.739 ms                | 950.894 ms                |
| Optimize                  | 57.279 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 75.617 us                 | 508.679 us                |
| BlockToStepN              | 226.178 us                | 2.025 ms                  |
| OneStep                   | 1.057 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.637 us                | 725.175 us                |
| GenInput                  | 102.060 ms                | 128.772 ms                |
| NN                        | 1.669 ms                  | 9.178 ms                  |
| Forward                   | 2.332 ms                  | 13.167 ms                 |
| Backward                  | 880.287 ms                | 950.894 ms                |
| Optimize                  | 57.279 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 75.617 us                 | 508.679 us                |
| BlockToStepN              | 226.178 us                | 2.025 ms                  |
| OneStep                   | 1.057 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.782 us                | 725.175 us                |
| GenInput                  | 102.060 ms                | 128.772 ms                |
| NN                        | 1.565 ms                  | 9.178 ms                  |
| Forward                   | 2.300 ms                  | 13.167 ms                 |
| Backward                  | 880.287 ms                | 950.894 ms                |
| Optimize                  | 57.279 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 66.797 us                 | 508.679 us                |
| BlockToStepN              | 221.047 us                | 2.038 ms                  |
| OneStep                   | 1.058 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.637 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.182 ms                 |
| Forward                   | 2.300 ms                  | 16.561 ms                 |
| Backward                  | 879.689 ms                | 950.894 ms                |
| Optimize                  | 57.920 ms                 | 110.539 ms                |
| BarrierTimeBeforeRank0    | 67.353 us                 | 508.679 us                |
| BlockToStepN              | 221.047 us                | 2.265 ms                  |
| OneStep                   | 1.057 s                   | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.637 us                | 725.175 us                |
| GenInput                  | 99.067 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.182 ms                 |
| Forward                   | 2.300 ms                  | 16.561 ms                 |
| Backward                  | 878.968 ms                | 950.894 ms                |
| Optimize                  | 59.085 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 75.617 us                 | 508.679 us                |
| BlockToStepN              | 219.447 us                | 2.265 ms                  |
| OneStep                   | 1.057 s                   | 1.146 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.831 us                | 725.175 us                |
| GenInput                  | 99.067 ms                 | 128.772 ms                |
| NN                        | 1.565 ms                  | 15.940 ms                 |
| Forward                   | 2.363 ms                  | 16.561 ms                 |
| Backward                  | 877.778 ms                | 950.894 ms                |
| Optimize                  | 57.920 ms                 | 171.075 ms                |
| BarrierTimeBeforeRank0    | 71.324 us                 | 508.679 us                |
| BlockToStepN              | 198.047 us                | 2.265 ms                  |
| OneStep                   | 1.055 s                   | 1.146 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.677 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.940 ms                 |
| Forward                   | 2.332 ms                  | 16.561 ms                 |
| Backward                  | 877.778 ms                | 950.894 ms                |
| Optimize                  | 57.543 ms                 | 171.568 ms                |
| BarrierTimeBeforeRank0    | 75.617 us                 | 508.679 us                |
| BlockToStepN              | 180.739 us                | 2.265 ms                  |
| OneStep                   | 1.055 s                   | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.677 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.940 ms                 |
| Forward                   | 2.300 ms                  | 28.977 ms                 |
| Backward                  | 876.951 ms                | 950.894 ms                |
| Optimize                  | 57.476 ms                 | 171.568 ms                |
| BarrierTimeBeforeRank0    | 71.324 us                 | 508.679 us                |
| BlockToStepN              | 180.249 us                | 2.265 ms                  |
| OneStep                   | 1.055 s                   | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.940 ms                 |
| Forward                   | 2.300 ms                  | 28.977 ms                 |
| Backward                  | 876.951 ms                | 950.894 ms                |
| Optimize                  | 57.543 ms                 | 171.568 ms                |
| BarrierTimeBeforeRank0    | 67.353 us                 | 508.679 us                |
| BlockToStepN              | 180.249 us                | 2.265 ms                  |
| OneStep                   | 1.055 s                   | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 99 ========== 
Step99:rank0, time: 118.748, per_step: 1.187483
Step99:rank5, time: 118.749, per_step: 1.187487
Step99:rank2, time: 118.749, per_step: 1.187486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 212.587 us                | 725.175 us                |
| GenInput                  | 99.067 ms                 | 128.772 ms                |
| NN                        | 1.513 ms                  | 15.940 ms                 |
| Forward                   | 2.300 ms                  | 28.977 ms                 |
| Backward                  | 876.591 ms                | 950.894 ms                |
| Optimize                  | 57.543 ms                 | 171.568 ms                |
| BarrierTimeBeforeRank0    | 67.353 us                 | 508.679 us                |
| BlockToStepN              | 180.249 us                | 2.265 ms                  |
| OneStep                   | 1.055 s                   | 1.201 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
Step99:rank4, time: 118.749, per_step: 1.187486
Step99:rank7, time: 118.749, per_step: 1.187487
Step99:rank6, time: 118.748, per_step: 1.187484
Step99:rank3, time: 118.749, per_step: 1.187487
Step99:rank1, time: 118.749, per_step: 1.187486
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.839 ms                 | 128.772 ms                |
| NN                        | 1.500 ms                  | 15.940 ms                 |
| Forward                   | 2.263 ms                  | 28.977 ms                 |
| Backward                  | 876.951 ms                | 950.894 ms                |
| Optimize                  | 57.824 ms                 | 236.791 ms                |
| BarrierTimeBeforeRank0    | 71.324 us                 | 508.679 us                |
| BlockToStepN              | 189.865 us                | 3.578 ms                  |
| OneStep                   | 1.055 s                   | 1.275 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.839 ms                 | 128.772 ms                |
| NN                        | 1.500 ms                  | 15.940 ms                 |
| Forward                   | 2.263 ms                  | 28.977 ms                 |
| Backward                  | 876.591 ms                | 950.894 ms                |
| Optimize                  | 57.543 ms                 | 236.791 ms                |
| BarrierTimeBeforeRank0    | 66.700 us                 | 508.679 us                |
| BlockToStepN              | 180.739 us                | 6.714 ms                  |
| OneStep                   | 1.055 s                   | 1.275 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.667 ms                 | 128.772 ms                |
| NN                        | 1.451 ms                  | 15.940 ms                 |
| Forward                   | 2.214 ms                  | 28.977 ms                 |
| Backward                  | 876.591 ms                | 950.894 ms                |
| Optimize                  | 57.543 ms                 | 250.462 ms                |
| BarrierTimeBeforeRank0    | 66.700 us                 | 508.679 us                |
| BlockToStepN              | 180.249 us                | 6.714 ms                  |
| OneStep                   | 1.055 s                   | 1.275 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.583 ms                 | 128.772 ms                |
| NN                        | 1.430 ms                  | 15.940 ms                 |
| Forward                   | 2.209 ms                  | 28.977 ms                 |
| Backward                  | 876.882 ms                | 950.894 ms                |
| Optimize                  | 57.824 ms                 | 265.565 ms                |
| BarrierTimeBeforeRank0    | 66.797 us                 | 508.679 us                |
| BlockToStepN              | 180.739 us                | 6.714 ms                  |
| OneStep                   | 1.055 s                   | 1.275 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
========== Step 118 ========== 
========== Step 119 ========== 
Successfully xmh
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
INFO [12351 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 215.135 us                | 725.175 us                |
| GenInput                  | 99.067 ms                 | 128.772 ms                |
| NN                        | 1.430 ms                  | 15.940 ms                 |
| Forward                   | 2.209 ms                  | 28.977 ms                 |
| Backward                  | 876.591 ms                | 950.894 ms                |
| Optimize                  | 57.824 ms                 | 265.565 ms                |
| BarrierTimeBeforeRank0    | 66.797 us                 | 508.679 us                |
| BlockToStepN              | 180.739 us                | 6.714 ms                  |
| OneStep                   | 1.055 s                   | 1.275 s                   |
| E2E-100                   | 107.261 s                 | 107.261 s                 |
+---------------------------+---------------------------+---------------------------+
