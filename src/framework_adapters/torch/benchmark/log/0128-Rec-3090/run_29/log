WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 14:07:55.026309 42492 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 14:07:55.030983 42492 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [42492 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f195600d9e0>==========
Worker 1 pid=42892
Worker 2 pid=42893
Worker 3 pid=42894
Worker 4 pid=42895
Worker 5 pid=42896
Worker 6 pid=42897
INFO [42492 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [42892 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [42893 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [42894 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [42897 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [42895 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [42896 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [42898 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [42896 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42898 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42897 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42492 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42894 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42895 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 14:08:01.264874 42898 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.264878 42896 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.265300 42897 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [42892 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42893 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 14:08:01.266352 42895 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.266744 42492 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.266793 42894 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.266794 42892 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:08:01.267098 42893 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 14:08:06.535881 42895 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [472460, 32]; dev=4; size=57.67 MB
W20240131 14:08:06.536288 42896 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [472460, 32]; dev=5; size=57.67 MB
W20240131 14:08:06.536490 42893 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 14:08:06.536517 42897 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [472460, 32]; dev=6; size=57.67 MB
W20240131 14:08:06.537928 42898 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [472460, 32]; dev=7; size=57.67 MB
W20240131 14:08:06.550895 42892 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 14:08:06.551085 42492 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 14:08:06.551086 42894 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 14:08:07.356026 42896 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10004817d000 7.629 MB
W20240131 14:08:07.356227 42896 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100048920000 7.629 MB
W20240131 14:08:07.356294 42896 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1000490c3000 122.1 MB
W20240131 14:08:07.356349 42896 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100050ad7000 122.1 MB
W20240131 14:08:07.356398 42896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 14:08:07.357445 42896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 14:08:07.378557 42895 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000584f1000 7.629 MB
W20240131 14:08:07.378782 42895 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100058c94000 7.629 MB
W20240131 14:08:07.378862 42895 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x100059437000 122.1 MB
W20240131 14:08:07.378911 42895 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100060e4b000 122.1 MB
W20240131 14:08:07.378968 42895 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 14:08:07.385061 42895 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 14:08:07.385072 42892 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100068863000 7.629 MB
W20240131 14:08:07.385233 42892 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100069006000 7.629 MB
W20240131 14:08:07.385308 42892 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000697a9000 122.1 MB
W20240131 14:08:07.385373 42892 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000711bd000 122.1 MB
W20240131 14:08:07.385452 42892 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:08:07.386655 42892 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:08:07.387491 42897 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100078bd9000 7.629 MB
W20240131 14:08:07.387641 42897 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10007937c000 7.629 MB
W20240131 14:08:07.387720 42897 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100079b1f000 122.1 MB
W20240131 14:08:07.387764 42897 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100081533000 122.1 MB
W20240131 14:08:07.387817 42897 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 14:08:07.388274 42897 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 14:08:07.392397 42492 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100088f4d000 7.629 MB
W20240131 14:08:07.392655 42492 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000896f0000 7.629 MB
W20240131 14:08:07.392732 42492 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100089e93000 122.1 MB
W20240131 14:08:07.392812 42492 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000918a7000 122.1 MB
W20240131 14:08:07.392856 42492 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 14:08:07.431741 42492 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 14:08:07.432041 42898 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000992c3000 7.629 MB
W20240131 14:08:07.432103 42893 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100099a66000 7.629 MB
W20240131 14:08:07.432106 42894 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10009a209000 7.629 MB
W20240131 14:08:07.432498 42894 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10009a9ae000 7.629 MB
W20240131 14:08:07.432513 42898 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009b151000 7.629 MB
W20240131 14:08:07.432528 42893 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10009b8f4000 7.629 MB
W20240131 14:08:07.432593 42894 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10009c097000 122.1 MB
W20240131 14:08:07.432613 42893 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000a3aab000 122.1 MB
W20240131 14:08:07.432618 42898 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1000ab4bf000 122.1 MB
W20240131 14:08:07.432663 42894 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000b2ed3000 122.1 MB
W20240131 14:08:07.432668 42893 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000ba8e7000 122.1 MB
W20240131 14:08:07.432686 42898 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000c22fb000 122.1 MB
W20240131 14:08:07.432731 42894 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 14:08:07.432739 42898 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 14:08:07.432746 42893 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:08:07.499244 42893 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:08:07.503242 42894 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 14:08:07.575523 42898 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=42898
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840), (1889840, 2362300), (2362300, 2834760), (2834760, 3307220), (3307220, 3779680)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240131 14:08:12.397173 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000c9d1b000 7.629 MB
W20240131 14:08:12.397375 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000ca4be000 7.629 MB
W20240131 14:08:12.397424 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000cac61000 7.629 MB
W20240131 14:08:12.397498 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000cb404000 7.629 MB
W20240131 14:08:12.397541 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000cbba7000 7.629 MB
W20240131 14:08:12.397595 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000cc34a000 7.629 MB
W20240131 14:08:12.397641 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000ccaed000 7.629 MB
W20240131 14:08:12.397694 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000cd290000 7.629 MB
W20240131 14:08:12.397730 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000cda33000 7.629 MB
W20240131 14:08:12.397800 42896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000ce1d6000 7.629 MB
W20240131 14:08:12.397848 42896 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000ce979000 80 B 
W20240131 14:08:12.397897 42896 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000ce97b000 8 B 
W20240131 14:08:12.397927 42896 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000ce97d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.398348 42896 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.467154 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000ce97f000 7.629 MB
W20240131 14:08:12.467422 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000cf122000 7.629 MB
W20240131 14:08:12.467470 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000cf8c5000 7.629 MB
W20240131 14:08:12.467518 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000d0068000 7.629 MB
W20240131 14:08:12.467554 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000d080b000 7.629 MB
W20240131 14:08:12.467613 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000d0fae000 7.629 MB
W20240131 14:08:12.467659 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000d1751000 7.629 MB
W20240131 14:08:12.467710 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000d1ef4000 7.629 MB
W20240131 14:08:12.467748 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000d2697000 7.629 MB
W20240131 14:08:12.467804 42893 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000d2e3a000 7.629 MB
W20240131 14:08:12.467844 42893 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000d35dd000 80 B 
W20240131 14:08:12.467887 42893 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000d35df000 8 B 
W20240131 14:08:12.467918 42893 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000d35e1000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.468348 42893 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.525833 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d35e3000 7.629 MB
W20240131 14:08:12.525959 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d3d86000 7.629 MB
W20240131 14:08:12.526005 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d4529000 7.629 MB
W20240131 14:08:12.526050 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000d4ccc000 7.629 MB
W20240131 14:08:12.526086 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000d546f000 7.629 MB
W20240131 14:08:12.526142 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000d5c12000 7.629 MB
W20240131 14:08:12.526191 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000d63b5000 7.629 MB
W20240131 14:08:12.526242 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000d6b58000 7.629 MB
W20240131 14:08:12.526281 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000d72fb000 7.629 MB
W20240131 14:08:12.526335 42897 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000d7a9e000 7.629 MB
W20240131 14:08:12.526393 42897 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000d8241000 80 B 
W20240131 14:08:12.526436 42897 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000d8243000 8 B 
W20240131 14:08:12.526468 42897 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000d8245000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.526763 42897 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.623605 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000d8247000 7.629 MB
W20240131 14:08:12.623862 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000d89ea000 7.629 MB
W20240131 14:08:12.623939 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000d918d000 7.629 MB
W20240131 14:08:12.623972 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000d9930000 7.629 MB
W20240131 14:08:12.624039 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000da0d3000 7.629 MB
W20240131 14:08:12.624147 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000da876000 7.629 MB
W20240131 14:08:12.624181 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000db019000 7.629 MB
W20240131 14:08:12.624255 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000db7bc000 7.629 MB
W20240131 14:08:12.624317 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000dbf5f000 7.629 MB
W20240131 14:08:12.624423 42492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000dc702000 7.629 MB
W20240131 14:08:12.624462 42492 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000dcea5000 80 B 
W20240131 14:08:12.624496 42492 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000dcea7000 8 B 
W20240131 14:08:12.624548 42492 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000dcea9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.624943 42492 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.642093 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000dceab000 7.629 MB
W20240131 14:08:12.642204 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000dd64e000 7.629 MB
W20240131 14:08:12.642247 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000dddf1000 7.629 MB
W20240131 14:08:12.642295 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000de594000 7.629 MB
W20240131 14:08:12.642335 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000ded37000 7.629 MB
W20240131 14:08:12.642390 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000df4da000 7.629 MB
W20240131 14:08:12.642437 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000dfc7d000 7.629 MB
W20240131 14:08:12.642483 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e0420000 7.629 MB
W20240131 14:08:12.642522 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e0bc3000 7.629 MB
W20240131 14:08:12.642568 42898 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000e1366000 7.629 MB
W20240131 14:08:12.642612 42898 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000e1b09000 80 B 
W20240131 14:08:12.642650 42898 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000e1b0b000 8 B 
W20240131 14:08:12.642678 42898 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000e1b0d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.642968 42898 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.715751 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000e1b0f000 7.629 MB
W20240131 14:08:12.715888 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000e22b2000 7.629 MB
W20240131 14:08:12.715943 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000e2a55000 7.629 MB
W20240131 14:08:12.715992 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000e31f8000 7.629 MB
W20240131 14:08:12.716032 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e399b000 7.629 MB
W20240131 14:08:12.716099 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e413e000 7.629 MB
W20240131 14:08:12.716176 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e48e1000 7.629 MB
W20240131 14:08:12.716229 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000e5084000 7.629 MB
W20240131 14:08:12.716269 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000e5827000 7.629 MB
W20240131 14:08:12.716327 42895 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000e5fca000 7.629 MB
W20240131 14:08:12.716373 42895 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000e676d000 80 B 
W20240131 14:08:12.716426 42895 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000e676f000 8 B 
W20240131 14:08:12.716460 42895 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000e6771000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.716753 42895 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:12.936931 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000e6773000 7.629 MB
W20240131 14:08:12.937072 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000e6f16000 7.629 MB
W20240131 14:08:12.937120 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000e76b9000 7.629 MB
W20240131 14:08:12.937173 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000e7e5c000 7.629 MB
W20240131 14:08:12.937212 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000e85ff000 7.629 MB
W20240131 14:08:12.937269 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e8da2000 7.629 MB
W20240131 14:08:12.937326 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000e9545000 7.629 MB
W20240131 14:08:12.937379 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000e9ce8000 7.629 MB
W20240131 14:08:12.937415 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ea48b000 7.629 MB
W20240131 14:08:12.937458 42892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000eac2e000 7.629 MB
W20240131 14:08:12.937496 42892 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000eb3d1000 80 B 
W20240131 14:08:12.937530 42892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000eb3d3000 8 B 
W20240131 14:08:12.937559 42892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000eb3d5000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:12.937872 42892 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:13.060870 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000eb3d7000 7.629 MB
W20240131 14:08:13.061030 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000ebb7a000 7.629 MB
W20240131 14:08:13.061075 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000ec31d000 7.629 MB
W20240131 14:08:13.061120 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000ecac0000 7.629 MB
W20240131 14:08:13.061156 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000ed263000 7.629 MB
W20240131 14:08:13.061223 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000eda06000 7.629 MB
W20240131 14:08:13.061276 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000ee1a9000 7.629 MB
W20240131 14:08:13.061323 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000ee94c000 7.629 MB
W20240131 14:08:13.061360 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000ef0ef000 7.629 MB
W20240131 14:08:13.061403 42894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000ef892000 7.629 MB
W20240131 14:08:13.061440 42894 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f0035000 80 B 
W20240131 14:08:13.061482 42894 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f0037000 8 B 
W20240131 14:08:13.061512 42894 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f0039000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:08:13.061791 42894 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:08:13.064340 42492 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 14:08:13.065057 42492 grad_base.h:184] Init GradProcessingBase done
I20240131 14:08:14.225168 42492 grad_async_v2.h:42] Use main thread to update emb.
W20240131 14:08:14.225477 42492 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 14:08:14.225492 42492 kg_controller.h:84] Construct KGCacheController done
E20240131 14:08:15.025483 42897 recstore.cc:66] init folly done
E20240131 14:08:15.025537 42893 recstore.cc:66] init folly done
E20240131 14:08:15.025555 42895 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 14:08:15.025699 42896 recstore.cc:66] init folly done
E20240131 14:08:15.025727 42894 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 14:08:15.026818 42898 recstore.cc:66] init folly done
E20240131 14:08:15.026851 42892 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 14:08:15.026897 42492 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 14:08:15.028199 42492 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 14:08:15.938318 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:08:15.938895 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 14:08:16.938027 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:08:16.948879 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:08:17.938062 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:08:17.978724 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:08:18.938184 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:08:19.009111 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:08:19.938036 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:20.019243 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.607 us                | 233.534 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:20.938107 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=114
W20240131 14:08:21.019259 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
Before Training
Before Training
Before Training
Before Training
I20240131 14:08:22.395262 42892 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240131 14:08:22.395314 42894 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:08:22.395350 42897 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:08:22.395388 42895 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
I20240131 14:08:22.395637 42492 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 14:08:22.395838 42896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:08:22.395972 42898 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:08:22.396003 42893 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
W20240131 14:08:22.398545 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:08:22.398773 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 542.445 us                | 542.445 us                |
| GenInput                  | 1.681 ms                  | 1.681 ms                  |
| NN                        | 223.568 ms                | 223.568 ms                |
| Forward                   | 281.575 ms                | 281.575 ms                |
| Backward                  | 148.438 ms                | 148.438 ms                |
| Optimize                  | 3.875 ms                  | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 31.649 ms                 | 31.649 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:24.049508 44751 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:08:24.582717 42492 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 195.889 us                | 349.977 us                |
| ProcessBack:Shuffle       | 385.173 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 785.427 ms                | 785.427 ms                |
| ProcessBack:UpsertPq      | 532.919 ms                | 532.919 ms                |
| ProcessOneStep            | 1.716 s                   | 1.716 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:25.056843 43842 parallel_pq_v2.h:79] insert failed, size(hashtable)=3359
W20240131 14:08:25.132812 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
INFO [42898 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42894 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42896 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42892 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42897 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42893 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42895 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [42492 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
W20240131 14:08:25.752238 42492 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
========== Step 4 ========== 
E20240131 14:08:26.056075 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:08:26.294040 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
E20240131 14:08:27.056115 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1405
========== Step 8 ========== 
========== Step 9 ========== 
W20240131 14:08:27.541007 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
========== Step 10 ========== 
========== Step 11 ========== 
E20240131 14:08:28.056152 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 180.738 us                | 1.003 ms                  |
| GenInput                  | 1.351 ms                  | 3.977 ms                  |
| NN                        | 1.437 ms                  | 223.568 ms                |
| Forward                   | 1.914 ms                  | 281.575 ms                |
| Backward                  | 4.453 ms                  | 148.438 ms                |
| Optimize                  | 391.483 us                | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 811.513 us                | 31.649 ms                 |
| AfterBackward             | 277.490 ms                | 1.717 s                   |
| BlockToStepN              | 157.259 us                | 547.857 ms                |
| OneStep                   | 289.075 ms                | 2.734 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 12 ========== 
========== Step 13 ========== 
W20240131 14:08:28.693902 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 14 ========== 
E20240131 14:08:29.056028 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1074
E20240131 14:08:29.160574 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=14, sample_step_cpp_seen_[rank]=13
W20240131 14:08:29.967754 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 167.398 us                | 387.342 us                |
| ProcessBack:Shuffle       | 262.144 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 17.497 ms                 | 785.427 ms                |
| ProcessBack:UpsertPq      | 62.958 us                 | 532.919 ms                |
| ProcessOneStep            | 277.434 ms                | 1.716 s                   |
| BlockToStepN              | 56.424 us                 | 547.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:30.056159 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:08:31.056078 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:31.124369 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240131 14:08:32.056226 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:08:32.676196 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240131 14:08:33.056033 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 180.738 us                | 1.003 ms                  |
| GenInput                  | 1.351 ms                  | 3.977 ms                  |
| NN                        | 1.437 ms                  | 223.568 ms                |
| Forward                   | 1.905 ms                  | 281.575 ms                |
| Backward                  | 4.854 ms                  | 148.438 ms                |
| Optimize                  | 391.483 us                | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 901.554 us                | 31.649 ms                 |
| AfterBackward             | 277.490 ms                | 1.717 s                   |
| BlockToStepN              | 143.030 us                | 547.857 ms                |
| OneStep                   | 289.075 ms                | 2.734 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
W20240131 14:08:33.579403 42492 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
W20240131 14:08:33.736260 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 17 ========== 
E20240131 14:08:34.056028 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=85
========== Step 18 ========== 
========== Step 19 ========== 
W20240131 14:08:34.635283 42492 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
W20240131 14:08:34.791832 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
========== Step 21 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 170.766 us                | 32.192 ms                 |
| ProcessBack:Shuffle       | 262.244 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 17.133 ms                 | 785.427 ms                |
| ProcessBack:UpsertPq      | 63.414 us                 | 532.919 ms                |
| ProcessOneStep            | 279.845 ms                | 4.359 s                   |
| BlockToStepN              | 81.199 us                 | 547.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:35.056022 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=137
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
E20240131 14:08:36.056263 43852 parallel_pq_v2.h:79] insert failed, size(hashtable)=213
W20240131 14:08:36.220261 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
========== Step 26 ========== 
========== Step 27 ========== 
E20240131 14:08:36.844570 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=27, sample_step_cpp_seen_[rank]=26
========== Step 28 ========== 
E20240131 14:08:37.056021 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=152
W20240131 14:08:37.884078 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240131 14:08:38.056419 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 175.431 us                | 1.003 ms                  |
| GenInput                  | 1.263 ms                  | 3.977 ms                  |
| NN                        | 1.232 ms                  | 223.568 ms                |
| Forward                   | 1.674 ms                  | 281.575 ms                |
| Backward                  | 4.180 ms                  | 148.438 ms                |
| Optimize                  | 376.940 us                | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 924.044 us                | 31.649 ms                 |
| AfterBackward             | 277.260 ms                | 4.360 s                   |
| BlockToStepN              | 150.908 us                | 547.857 ms                |
| OneStep                   | 288.143 ms                | 4.367 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:08:38.894814 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 14:08:39.056003 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 175.109 us                | 312.300 us                |
| ProcessBack:Shuffle       | 258.224 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 17.031 ms                 | 785.427 ms                |
| ProcessBack:UpsertPq      | 63.414 us                 | 532.919 ms                |
| ProcessOneStep            | 277.225 ms                | 4.359 s                   |
| BlockToStepN              | 77.730 us                 | 547.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:40.056257 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:40.650758 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 14:08:41.056311 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:41.674333 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 29 ========== 
========== Step 30 ========== 
E20240131 14:08:42.056110 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 31 ========== 
========== Step 32 ========== 
W20240131 14:08:42.731412 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 33 ========== 
E20240131 14:08:43.056190 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 1.003 ms                  |
| GenInput                  | 1.253 ms                  | 3.977 ms                  |
| NN                        | 1.265 ms                  | 223.568 ms                |
| Forward                   | 1.714 ms                  | 281.575 ms                |
| Backward                  | 4.180 ms                  | 148.438 ms                |
| Optimize                  | 382.423 us                | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 924.044 us                | 31.649 ms                 |
| AfterBackward             | 276.907 ms                | 4.799 s                   |
| BlockToStepN              | 157.259 us                | 547.857 ms                |
| OneStep                   | 284.043 ms                | 4.807 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
W20240131 14:08:43.773867 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
========== Step 37 ========== 
E20240131 14:08:44.056550 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=106
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
W20240131 14:08:44.865264 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
========== Step 41 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 164.630 us                | 32.192 ms                 |
| ProcessBack:Shuffle       | 252.700 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 17.133 ms                 | 785.427 ms                |
| ProcessBack:UpsertPq      | 63.462 us                 | 532.919 ms                |
| ProcessOneStep            | 273.615 ms                | 4.799 s                   |
| BlockToStepN              | 97.140 us                 | 547.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:45.056095 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=70
E20240131 14:08:45.277137 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=41, sample_step_cpp_seen_[rank]=40
E20240131 14:08:46.056098 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:46.396517 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240131 14:08:47.056702 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:08:48.056066 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 175.431 us                | 1.003 ms                  |
| GenInput                  | 1.007 ms                  | 3.977 ms                  |
| NN                        | 1.221 ms                  | 223.568 ms                |
| Forward                   | 1.660 ms                  | 281.575 ms                |
| Backward                  | 3.644 ms                  | 148.438 ms                |
| Optimize                  | 382.423 us                | 3.875 ms                  |
| BarrierTimeBeforeRank0    | 910.395 us                | 31.649 ms                 |
| AfterBackward             | 273.696 ms                | 4.799 s                   |
| BlockToStepN              | 168.819 us                | 547.857 ms                |
| OneStep                   | 281.749 ms                | 4.807 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:08:48.138983 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240131 14:08:49.056345 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:49.161326 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
W20240131 14:08:49.989893 42492 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 149.831 us                | 31.701 ms                 |
| ProcessBack:Shuffle       | 252.195 ms                | 385.173 ms                |
| ProcessBack:UpdateCache   | 17.161 ms                 | 785.427 ms                |
| ProcessBack:UpsertPq      | 63.533 us                 | 532.919 ms                |
| ProcessOneStep            | 271.546 ms                | 4.799 s                   |
| BlockToStepN              | 97.615 us                 | 547.068 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:50.056010 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=101
W20240131 14:08:50.197053 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
E20240131 14:08:51.056104 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 49 ========== 
========== Step 50 ========== 
W20240131 14:08:51.433683 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 51 ========== 
========== Step 52 ========== 
W20240131 14:08:51.995286 42492 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
E20240131 14:08:52.056259 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=253
========== Step 54 ========== 
E20240131 14:08:52.407670 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=54, sample_step_cpp_seen_[rank]=53
W20240131 14:08:52.764955 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240131 14:08:53.056232 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.848 us                | 602.238 us                |
| GenInput                  | 957.772 us                | 3.582 ms                  |
| NN                        | 1.152 ms                  | 8.977 ms                  |
| Forward                   | 1.565 ms                  | 12.425 ms                 |
| Backward                  | 3.644 ms                  | 12.166 ms                 |
| Optimize                  | 361.919 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 910.395 us                | 13.464 ms                 |
| AfterBackward             | 268.514 ms                | 4.360 s                   |
| BlockToStepN              | 179.207 us                | 1.961 ms                  |
| OneStep                   | 278.314 ms                | 4.367 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:54.056262 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:54.670432 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 144.190 us                | 280.732 us                |
| ProcessBack:Shuffle       | 251.426 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 17.031 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 63.359 us                 | 137.063 us                |
| ProcessOneStep            | 268.458 ms                | 4.359 s                   |
| BlockToStepN              | 106.606 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:08:55.056169 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:08:56.056474 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:08:56.192816 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 55 ========== 
========== Step 56 ========== 
E20240131 14:08:57.056058 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:08:57.236330 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
E20240131 14:08:58.056062 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.330 us                | 602.238 us                |
| GenInput                  | 947.373 us                | 3.582 ms                  |
| NN                        | 1.152 ms                  | 8.977 ms                  |
| Forward                   | 1.565 ms                  | 12.425 ms                 |
| Backward                  | 3.536 ms                  | 12.166 ms                 |
| Optimize                  | 361.919 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 918.040 us                | 13.464 ms                 |
| AfterBackward             | 268.514 ms                | 4.498 s                   |
| BlockToStepN              | 183.965 us                | 4.840 ms                  |
| OneStep                   | 278.314 ms                | 4.507 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:08:58.157409 42492 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
========== Step 61 ========== 
W20240131 14:08:58.653218 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 62 ========== 
========== Step 63 ========== 
E20240131 14:08:59.056107 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 64 ========== 
========== Step 65 ========== 
W20240131 14:08:59.844898 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
W20240131 14:08:59.852403 42492 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.917 us                | 31.852 ms                 |
| ProcessBack:Shuffle       | 251.426 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.905 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 63.462 us                 | 139.032 us                |
| ProcessOneStep            | 268.458 ms                | 4.498 s                   |
| BlockToStepN              | 117.175 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:00.056300 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=111
========== Step 67 ========== 
E20240131 14:09:00.428786 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=67, sample_step_cpp_seen_[rank]=66
W20240131 14:09:00.844198 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
W20240131 14:09:00.844560 42492 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
E20240131 14:09:01.056027 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=74
E20240131 14:09:02.056084 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:09:02.186718 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 14:09:03.056149 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.330 us                | 602.238 us                |
| GenInput                  | 912.556 us                | 4.078 ms                  |
| NN                        | 1.152 ms                  | 8.977 ms                  |
| Forward                   | 1.549 ms                  | 12.425 ms                 |
| Backward                  | 3.536 ms                  | 14.027 ms                 |
| Optimize                  | 354.290 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 901.554 us                | 13.464 ms                 |
| AfterBackward             | 269.263 ms                | 4.498 s                   |
| BlockToStepN              | 192.407 us                | 4.840 ms                  |
| OneStep                   | 279.373 ms                | 4.507 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:09:03.297228 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 69 ========== 
E20240131 14:09:04.056322 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
========== Step 70 ========== 
W20240131 14:09:04.329741 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 71 ========== 
W20240131 14:09:04.812839 42492 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 161.167 us                | 27.942 ms                 |
| ProcessBack:Shuffle       | 252.195 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 63.533 us                 | 147.111 us                |
| ProcessOneStep            | 269.235 ms                | 4.498 s                   |
| BlockToStepN              | 123.239 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:05.056032 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=406
========== Step 73 ========== 
W20240131 14:09:05.332553 42492 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
W20240131 14:09:05.469096 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
========== Step 75 ========== 
========== Step 76 ========== 
E20240131 14:09:06.056079 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
W20240131 14:09:06.894834 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 14:09:07.056084 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=104
========== Step 81 ========== 
E20240131 14:09:07.400298 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=81, sample_step_cpp_seen_[rank]=80
E20240131 14:09:08.056113 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 175.431 us                | 776.255 us                |
| GenInput                  | 898.290 us                | 4.370 ms                  |
| NN                        | 1.156 ms                  | 8.977 ms                  |
| Forward                   | 1.583 ms                  | 12.425 ms                 |
| Backward                  | 3.475 ms                  | 14.027 ms                 |
| Optimize                  | 354.290 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 871.687 us                | 13.464 ms                 |
| AfterBackward             | 267.686 ms                | 4.498 s                   |
| BlockToStepN              | 211.604 us                | 4.840 ms                  |
| OneStep                   | 278.257 ms                | 4.507 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:09:08.152933 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240131 14:09:09.056128 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:09.239114 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
========== Step 82 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 129.494 us                | 255.867 us                |
| ProcessBack:Shuffle       | 251.426 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 64.598 us                 | 619.145 us                |
| ProcessOneStep            | 267.623 ms                | 4.498 s                   |
| BlockToStepN              | 127.236 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:10.056077 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240131 14:09:10.281355 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
E20240131 14:09:11.056095 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=251
W20240131 14:09:11.163004 42492 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
W20240131 14:09:11.416092 42492 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
W20240131 14:09:11.512307 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
E20240131 14:09:12.056083 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=174
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
W20240131 14:09:12.958773 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 94 ========== 
E20240131 14:09:13.056030 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 175.918 us                | 776.255 us                |
| GenInput                  | 898.290 us                | 4.484 ms                  |
| NN                        | 1.154 ms                  | 8.977 ms                  |
| Forward                   | 1.583 ms                  | 12.425 ms                 |
| Backward                  | 3.484 ms                  | 14.027 ms                 |
| Optimize                  | 354.290 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 855.796 us                | 13.464 ms                 |
| AfterBackward             | 267.261 ms                | 4.498 s                   |
| BlockToStepN              | 228.562 us                | 4.840 ms                  |
| OneStep                   | 277.629 ms                | 4.507 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:13.282660 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=94, sample_step_cpp_seen_[rank]=93
E20240131 14:09:14.056066 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:14.188820 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.148 us                | 257.965 us                |
| ProcessBack:Shuffle       | 251.200 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 64.598 us                 | 619.145 us                |
| ProcessOneStep            | 267.220 ms                | 4.498 s                   |
| BlockToStepN              | 146.430 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:15.056151 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:15.301584 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
========== Step 95 ========== 
E20240131 14:09:16.056257 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
========== Step 96 ========== 
W20240131 14:09:16.445447 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 97 ========== 
W20240131 14:09:16.743230 42492 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
========== Step 99 ========== 
E20240131 14:09:17.056035 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=101
Step99:rank5, time: 69.233, per_step: 0.692326
Step99:rank6, time: 69.233, per_step: 0.692327
Step99:rank2, time: 69.233, per_step: 0.692326
Step99:rank7, time: 69.233, per_step: 0.692325
Step99:rank1, time: 69.232, per_step: 0.692325
Step99:rank0, time: 69.233, per_step: 0.692327
Step99:rank4, time: 69.232, per_step: 0.692324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 776.255 us                |
| GenInput                  | 887.989 us                | 4.484 ms                  |
| NN                        | 1.155 ms                  | 8.977 ms                  |
| Forward                   | 1.589 ms                  | 12.425 ms                 |
| Backward                  | 3.456 ms                  | 14.027 ms                 |
| Optimize                  | 354.290 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 828.105 us                | 13.464 ms                 |
| AfterBackward             | 267.203 ms                | 4.498 s                   |
| BlockToStepN              | 247.572 us                | 4.840 ms                  |
| OneStep                   | 276.122 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
Step99:rank3, time: 69.235, per_step: 0.692347
W20240131 14:09:17.591336 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
========== Step 101 ========== 
========== Step 102 ========== 
E20240131 14:09:18.056723 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=62
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 179.338 us                | 776.255 us                |
| GenInput                  | 905.861 us                | 5.110 ms                  |
| NN                        | 1.156 ms                  | 8.977 ms                  |
| Forward                   | 1.592 ms                  | 12.425 ms                 |
| Backward                  | 3.475 ms                  | 14.027 ms                 |
| Optimize                  | 360.966 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 828.105 us                | 13.464 ms                 |
| AfterBackward             | 267.261 ms                | 4.498 s                   |
| BlockToStepN              | 249.419 us                | 4.840 ms                  |
| OneStep                   | 277.629 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 103 ========== 
========== Step 104 ========== 
W20240131 14:09:18.631060 42492 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
W20240131 14:09:18.832890 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
W20240131 14:09:18.903967 42492 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
E20240131 14:09:19.056044 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=269
E20240131 14:09:19.189610 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=106, sample_step_cpp_seen_[rank]=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 138.696 us                | 266.817 us                |
| ProcessBack:Shuffle       | 250.749 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.836 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 65.444 us                 | 619.145 us                |
| ProcessOneStep            | 267.163 ms                | 4.498 s                   |
| BlockToStepN              | 154.325 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:20.056128 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:20.062356 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 14:09:21.056154 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:09:21.158092 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
========== Step 107 ========== 
E20240131 14:09:22.056059 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=319
========== Step 108 ========== 
W20240131 14:09:22.215453 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
E20240131 14:09:23.056201 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.990 us                | 776.255 us                |
| GenInput                  | 898.290 us                | 5.110 ms                  |
| NN                        | 1.156 ms                  | 8.977 ms                  |
| Forward                   | 1.589 ms                  | 12.425 ms                 |
| Backward                  | 3.387 ms                  | 14.027 ms                 |
| Optimize                  | 353.813 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 828.105 us                | 13.464 ms                 |
| AfterBackward             | 267.203 ms                | 4.498 s                   |
| BlockToStepN              | 260.428 us                | 4.840 ms                  |
| OneStep                   | 276.122 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 112 ========== 
W20240131 14:09:23.445044 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
========== Step 113 ========== 
========== Step 114 ========== 
E20240131 14:09:24.056020 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=118
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
W20240131 14:09:24.896384 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 118 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.357 us                | 35.665 ms                 |
| ProcessBack:Shuffle       | 250.316 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.776 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 65.444 us                 | 619.145 us                |
| ProcessOneStep            | 267.163 ms                | 4.498 s                   |
| BlockToStepN              | 169.469 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:25.056083 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=141
W20240131 14:09:25.182881 42492 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
E20240131 14:09:25.473042 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=119, sample_step_cpp_seen_[rank]=118
========== Step 120 ========== 
E20240131 14:09:26.056103 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:09:26.311892 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 14:09:27.056136 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:09:27.544253 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240131 14:09:28.056011 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 820.758 us                |
| GenInput                  | 887.989 us                | 5.110 ms                  |
| NN                        | 1.156 ms                  | 8.977 ms                  |
| Forward                   | 1.589 ms                  | 12.425 ms                 |
| Backward                  | 3.387 ms                  | 14.027 ms                 |
| Optimize                  | 353.813 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 826.644 us                | 13.464 ms                 |
| AfterBackward             | 267.203 ms                | 4.498 s                   |
| BlockToStepN              | 278.358 us                | 4.840 ms                  |
| OneStep                   | 276.122 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:09:28.669512 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 121 ========== 
E20240131 14:09:29.056013 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=93
========== Step 122 ========== 
W20240131 14:09:29.415163 42492 grad_async_v2.h:257] pq is empty
========== Step 123 ========== 
========== Step 124 ========== 
W20240131 14:09:29.698164 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 125 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.472 us                | 28.018 ms                 |
| ProcessBack:Shuffle       | 251.200 ms                | 299.641 ms                |
| ProcessBack:UpdateCache   | 16.759 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 65.444 us                 | 619.145 us                |
| ProcessOneStep            | 267.236 ms                | 4.498 s                   |
| BlockToStepN              | 182.084 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:30.056061 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=115
========== Step 126 ========== 
W20240131 14:09:30.517021 42492 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
W20240131 14:09:31.041919 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 14:09:31.056046 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=70
========== Step 130 ========== 
========== Step 131 ========== 
W20240131 14:09:31.828253 42492 grad_async_v2.h:257] pq is empty
========== Step 132 ========== 
E20240131 14:09:32.056324 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=450
========== Step 133 ========== 
E20240131 14:09:32.370486 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=133, sample_step_cpp_seen_[rank]=132
W20240131 14:09:32.527711 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 14:09:33.056185 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.881 us                | 820.758 us                |
| GenInput                  | 877.416 us                | 5.110 ms                  |
| NN                        | 1.152 ms                  | 8.977 ms                  |
| Forward                   | 1.579 ms                  | 12.425 ms                 |
| Backward                  | 3.373 ms                  | 14.027 ms                 |
| Optimize                  | 349.998 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 858.997 us                | 13.464 ms                 |
| AfterBackward             | 267.369 ms                | 4.498 s                   |
| BlockToStepN              | 297.344 us                | 4.840 ms                  |
| OneStep                   | 276.825 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:09:33.973455 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240131 14:09:34.056142 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:34.983748 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 144.956 us                | 268.820 us                |
| ProcessBack:Shuffle       | 250.449 ms                | 299.641 ms                |
| ProcessBack:UpdateCache   | 16.776 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 64.853 us                 | 619.145 us                |
| ProcessOneStep            | 267.337 ms                | 4.498 s                   |
| BlockToStepN              | 187.795 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:35.056092 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 134 ========== 
W20240131 14:09:35.689352 42492 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
========== Step 136 ========== 
W20240131 14:09:36.030628 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240131 14:09:36.056188 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=421
========== Step 137 ========== 
========== Step 138 ========== 
W20240131 14:09:36.764753 42492 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
E20240131 14:09:37.056748 43851 parallel_pq_v2.h:79] insert failed, size(hashtable)=200
========== Step 140 ========== 
========== Step 141 ========== 
W20240131 14:09:37.407027 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
========== Step 142 ========== 
========== Step 143 ========== 
E20240131 14:09:38.056016 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.990 us                | 820.758 us                |
| GenInput                  | 877.416 us                | 6.271 ms                  |
| NN                        | 1.152 ms                  | 8.977 ms                  |
| Forward                   | 1.579 ms                  | 12.425 ms                 |
| Backward                  | 3.402 ms                  | 17.980 ms                 |
| Optimize                  | 348.091 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 858.997 us                | 13.464 ms                 |
| AfterBackward             | 267.369 ms                | 4.498 s                   |
| BlockToStepN              | 300.941 us                | 4.840 ms                  |
| OneStep                   | 277.647 ms                | 4.507 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
W20240131 14:09:38.559775 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 147 ========== 
E20240131 14:09:39.056007 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=179
E20240131 14:09:39.074487 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=147, sample_step_cpp_seen_[rank]=146
W20240131 14:09:39.913477 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.245 us                | 261.665 us                |
| ProcessBack:Shuffle       | 250.313 ms                | 299.641 ms                |
| ProcessBack:UpdateCache   | 16.648 ms                 | 38.148 ms                 |
| ProcessBack:UpsertPq      | 64.813 us                 | 619.145 us                |
| ProcessOneStep            | 267.220 ms                | 4.498 s                   |
| BlockToStepN              | 201.685 us                | 4.721 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:40.056288 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:40.927685 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
E20240131 14:09:41.056221 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 148 ========== 
========== Step 149 ========== 
W20240131 14:09:41.939427 42492 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
W20240131 14:09:42.045188 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 14:09:42.056087 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
E20240131 14:09:43.064064 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:43.066921 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.369 us                | 776.255 us                |
| GenInput                  | 875.659 us                | 5.110 ms                  |
| NN                        | 1.152 ms                  | 4.212 ms                  |
| Forward                   | 1.579 ms                  | 9.819 ms                  |
| Backward                  | 3.405 ms                  | 14.027 ms                 |
| Optimize                  | 343.561 us                | 1.593 ms                  |
| BarrierTimeBeforeRank0    | 864.358 us                | 7.904 ms                  |
| AfterBackward             | 266.450 ms                | 4.360 s                   |
| BlockToStepN              | 305.001 us                | 1.961 ms                  |
| OneStep                   | 275.823 ms                | 4.367 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
E20240131 14:09:44.064374 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=246
W20240131 14:09:44.135499 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
E20240131 14:09:44.891567 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=160, sample_step_cpp_seen_[rank]=159
========== Step 161 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.415 us                | 31.862 ms                 |
| ProcessBack:Shuffle       | 250.267 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.678 ms                 | 31.734 ms                 |
| ProcessBack:UpsertPq      | 64.598 us                 | 557.677 us                |
| ProcessOneStep            | 267.163 ms                | 4.359 s                   |
| BlockToStepN              | 210.722 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:45.069326 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:45.907801 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240131 14:09:46.069005 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:46.928350 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240131 14:09:47.069893 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:09:48.069394 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 176.194 us                | 776.255 us                |
| GenInput                  | 860.595 us                | 5.110 ms                  |
| NN                        | 1.152 ms                  | 7.351 ms                  |
| Forward                   | 1.579 ms                  | 9.819 ms                  |
| Backward                  | 3.387 ms                  | 14.027 ms                 |
| Optimize                  | 342.607 us                | 1.593 ms                  |
| BarrierTimeBeforeRank0    | 858.997 us                | 7.904 ms                  |
| AfterBackward             | 267.203 ms                | 4.360 s                   |
| BlockToStepN              | 316.323 us                | 1.961 ms                  |
| OneStep                   | 276.122 ms                | 4.367 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:09:48.420245 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240131 14:09:49.069291 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:49.210901 42492 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
W20240131 14:09:49.421144 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 163 ========== 
W20240131 14:09:49.695209 42492 grad_async_v2.h:257] pq is empty
========== Step 164 ========== 
========== Step 165 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 129.051 us                | 27.751 ms                 |
| ProcessBack:Shuffle       | 250.313 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.678 ms                 | 31.734 ms                 |
| ProcessBack:UpsertPq      | 64.663 us                 | 611.276 us                |
| ProcessOneStep            | 267.220 ms                | 4.359 s                   |
| BlockToStepN              | 215.758 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:50.069113 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=132
========== Step 166 ========== 
W20240131 14:09:50.580132 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
========== Step 167 ========== 
========== Step 168 ========== 
E20240131 14:09:51.069064 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=47
========== Step 169 ========== 
W20240131 14:09:51.416190 42492 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
W20240131 14:09:51.600802 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240131 14:09:51.700879 42492 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
W20240131 14:09:51.979318 42492 grad_async_v2.h:257] pq is empty
========== Step 172 ========== 
E20240131 14:09:52.069125 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 173 ========== 
========== Step 174 ========== 
E20240131 14:09:52.795648 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=174, sample_step_cpp_seen_[rank]=173
E20240131 14:09:53.069077 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:09:53.078202 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 176.751 us                | 820.758 us                |
| GenInput                  | 850.833 us                | 5.110 ms                  |
| NN                        | 1.152 ms                  | 7.351 ms                  |
| Forward                   | 1.583 ms                  | 9.819 ms                  |
| Backward                  | 3.402 ms                  | 14.027 ms                 |
| Optimize                  | 343.561 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.904 ms                  |
| AfterBackward             | 267.280 ms                | 4.360 s                   |
| BlockToStepN              | 326.948 us                | 1.961 ms                  |
| OneStep                   | 277.629 ms                | 4.367 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:54.069622 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:54.358969 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.411 us                | 257.813 us                |
| ProcessBack:Shuffle       | 250.316 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.678 ms                 | 31.734 ms                 |
| ProcessBack:UpsertPq      | 64.813 us                 | 611.276 us                |
| ProcessOneStep            | 267.236 ms                | 4.359 s                   |
| BlockToStepN              | 225.693 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:09:55.069059 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:09:55.448038 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 175 ========== 
E20240131 14:09:56.069211 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=123
========== Step 176 ========== 
========== Step 177 ========== 
W20240131 14:09:56.465384 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 178 ========== 
========== Step 179 ========== 
E20240131 14:09:57.069065 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
========== Step 180 ========== 
========== Step 181 ========== 
W20240131 14:09:57.675733 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 182 ========== 
========== Step 183 ========== 
E20240131 14:09:58.069442 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=182
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.132 us                | 820.758 us                |
| GenInput                  | 815.587 us                | 5.110 ms                  |
| NN                        | 1.154 ms                  | 7.351 ms                  |
| Forward                   | 1.589 ms                  | 9.819 ms                  |
| Backward                  | 3.371 ms                  | 14.027 ms                 |
| Optimize                  | 342.607 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.904 ms                  |
| AfterBackward             | 267.369 ms                | 4.360 s                   |
| BlockToStepN              | 331.356 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 184 ========== 
========== Step 185 ========== 
W20240131 14:09:58.719625 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
W20240131 14:09:58.903096 42492 grad_async_v2.h:257] pq is empty
========== Step 186 ========== 
E20240131 14:09:59.069135 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 187 ========== 
E20240131 14:09:59.456558 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=187, sample_step_cpp_seen_[rank]=186
========== Step 188 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.824 us                | 31.873 ms                 |
| ProcessBack:Shuffle       | 250.749 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.686 ms                 | 31.734 ms                 |
| ProcessBack:UpsertPq      | 64.743 us                 | 611.276 us                |
| ProcessOneStep            | 267.521 ms                | 4.359 s                   |
| BlockToStepN              | 238.532 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:00.069201 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:00.098754 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240131 14:10:01.069316 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:01.328068 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240131 14:10:02.069207 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:10:02.448782 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 189 ========== 
========== Step 190 ========== 
E20240131 14:10:03.069319 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.831 us                | 1.003 ms                  |
| GenInput                  | 815.587 us                | 5.110 ms                  |
| NN                        | 1.154 ms                  | 7.351 ms                  |
| Forward                   | 1.589 ms                  | 9.819 ms                  |
| Backward                  | 3.373 ms                  | 14.027 ms                 |
| Optimize                  | 343.561 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.904 ms                  |
| AfterBackward             | 267.576 ms                | 4.360 s                   |
| BlockToStepN              | 334.424 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 54.896 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:03.143062 42492 grad_async_v2.h:257] pq is empty
========== Step 191 ========== 
========== Step 192 ========== 
W20240131 14:10:03.625624 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 193 ========== 
========== Step 194 ========== 
E20240131 14:10:04.069090 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 195 ========== 
========== Step 196 ========== 
W20240131 14:10:04.675520 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
========== Step 197 ========== 
========== Step 198 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 150.496 us                | 31.878 ms                 |
| ProcessBack:Shuffle       | 250.378 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 64.598 us                 | 611.276 us                |
| ProcessOneStep            | 267.337 ms                | 4.359 s                   |
| BlockToStepN              | 242.975 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:05.069120 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
========== Step 199 ========== 
Step199:rank0, time: 48.329, per_step: 0.478506
Step199:rank4, time: 48.329, per_step: 0.478507
Step199:rank6, time: 48.330, per_step: 0.478510
Step199:rank3, time: 48.327, per_step: 0.478487
Step199:rank1, time: 48.329, per_step: 0.478507
Step199:rank5, time: 48.330, per_step: 0.478510
Step199:rank2, time: 48.329, per_step: 0.478510
Step199:rank7, time: 48.329, per_step: 0.478510
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.369 us                | 1.003 ms                  |
| GenInput                  | 793.100 us                | 5.110 ms                  |
| NN                        | 1.155 ms                  | 7.351 ms                  |
| Forward                   | 1.590 ms                  | 9.819 ms                  |
| Backward                  | 3.371 ms                  | 14.027 ms                 |
| Optimize                  | 342.131 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 864.358 us                | 7.904 ms                  |
| AfterBackward             | 267.576 ms                | 4.360 s                   |
| BlockToStepN              | 345.999 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 14:10:05.899420 42492 grad_async_v2.h:257] pq is empty
========== Step 201 ========== 
W20240131 14:10:05.925729 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:10:06.069161 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
========== Step 202 ========== 
E20240131 14:10:06.468228 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=202, sample_step_cpp_seen_[rank]=201
E20240131 14:10:07.069057 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:10:07.364779 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240131 14:10:08.069118 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.831 us                | 1.003 ms                  |
| GenInput                  | 793.100 us                | 5.110 ms                  |
| NN                        | 1.156 ms                  | 7.351 ms                  |
| Forward                   | 1.592 ms                  | 9.819 ms                  |
| Backward                  | 3.371 ms                  | 14.027 ms                 |
| Optimize                  | 343.561 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 866.557 us                | 7.904 ms                  |
| AfterBackward             | 267.576 ms                | 4.360 s                   |
| BlockToStepN              | 346.068 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:08.597424 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 203 ========== 
========== Step 204 ========== 
E20240131 14:10:09.069909 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 205 ========== 
========== Step 206 ========== 
W20240131 14:10:09.670377 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
========== Step 207 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.870 us                | 31.462 ms                 |
| ProcessBack:Shuffle       | 250.749 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.749 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 64.743 us                 | 619.145 us                |
| ProcessOneStep            | 267.546 ms                | 4.359 s                   |
| BlockToStepN              | 248.413 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:10.069171 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=177
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
W20240131 14:10:10.924073 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 211 ========== 
E20240131 14:10:11.069175 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=128
W20240131 14:10:11.264456 42492 grad_async_v2.h:257] pq is empty
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
W20240131 14:10:11.985769 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
========== Step 215 ========== 
E20240131 14:10:12.069087 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
E20240131 14:10:12.270462 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=215, sample_step_cpp_seen_[rank]=214
E20240131 14:10:13.069811 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.831 us                | 1.003 ms                  |
| GenInput                  | 782.894 us                | 6.271 ms                  |
| NN                        | 1.170 ms                  | 7.351 ms                  |
| Forward                   | 1.632 ms                  | 9.819 ms                  |
| Backward                  | 3.373 ms                  | 15.274 ms                 |
| Optimize                  | 342.131 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 858.997 us                | 7.904 ms                  |
| AfterBackward             | 267.611 ms                | 4.360 s                   |
| BlockToStepN              | 359.152 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:13.979267 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240131 14:10:14.069258 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.161 us                | 248.593 us                |
| ProcessBack:Shuffle       | 250.378 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 65.220 us                 | 619.145 us                |
| ProcessOneStep            | 267.546 ms                | 4.359 s                   |
| BlockToStepN              | 261.156 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:15.070129 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:15.740868 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240131 14:10:16.070034 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:10:17.061729 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240131 14:10:17.070345 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:10:17.270056 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=215, sample_step_cpp_seen_[rank]=214
========== Step 216 ========== 
W20240131 14:10:17.819679 42492 grad_async_v2.h:257] pq is empty
========== Step 217 ========== 
E20240131 14:10:18.070024 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=159
========== Step 218 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.881 us                | 1.003 ms                  |
| GenInput                  | 782.894 us                | 6.271 ms                  |
| NN                        | 1.170 ms                  | 7.351 ms                  |
| Forward                   | 1.632 ms                  | 9.819 ms                  |
| Backward                  | 3.402 ms                  | 15.274 ms                 |
| Optimize                  | 342.131 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 864.358 us                | 7.904 ms                  |
| AfterBackward             | 267.611 ms                | 4.498 s                   |
| BlockToStepN              | 359.152 us                | 1.961 ms                  |
| OneStep                   | 277.770 ms                | 4.507 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:18.097214 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
E20240131 14:10:19.070200 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=69
W20240131 14:10:19.145537 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.805 us                | 31.679 ms                 |
| ProcessBack:Shuffle       | 250.749 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.686 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 64.853 us                 | 668.034 us                |
| ProcessOneStep            | 267.883 ms                | 4.498 s                   |
| BlockToStepN              | 263.632 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:20.070133 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=187
W20240131 14:10:20.086710 42492 grad_async_v2.h:257] pq is empty
========== Step 226 ========== 
========== Step 227 ========== 
W20240131 14:10:20.541692 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 228 ========== 
E20240131 14:10:21.070143 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:21.804198 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 14:10:22.070052 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
E20240131 14:10:22.270004 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=228, sample_step_cpp_seen_[rank]=227
W20240131 14:10:22.898361 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 14:10:23.070080 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.990 us                | 1.018 ms                  |
| GenInput                  | 781.324 us                | 7.884 ms                  |
| NN                        | 1.167 ms                  | 7.351 ms                  |
| Forward                   | 1.632 ms                  | 9.819 ms                  |
| Backward                  | 3.373 ms                  | 17.020 ms                 |
| Optimize                  | 338.554 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 866.557 us                | 7.904 ms                  |
| AfterBackward             | 267.918 ms                | 4.498 s                   |
| BlockToStepN              | 372.722 us                | 1.964 ms                  |
| OneStep                   | 277.930 ms                | 4.507 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:23.620741 42492 grad_async_v2.h:257] pq is empty
========== Step 229 ========== 
========== Step 230 ========== 
W20240131 14:10:23.927450 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240131 14:10:24.070437 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=133
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
W20240131 14:10:24.952105 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.329 us                | 31.500 ms                 |
| ProcessBack:Shuffle       | 250.858 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.731 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 65.627 us                 | 668.034 us                |
| ProcessOneStep            | 268.458 ms                | 4.498 s                   |
| BlockToStepN              | 271.284 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 234 ========== 
E20240131 14:10:25.070025 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
W20240131 14:10:25.991350 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240131 14:10:26.070140 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
E20240131 14:10:27.070173 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=183
========== Step 242 ========== 
W20240131 14:10:27.202257 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:10:27.468569 42492 grad_async_v2.h:257] pq is empty
========== Step 243 ========== 
E20240131 14:10:27.762941 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=243, sample_step_cpp_seen_[rank]=242
E20240131 14:10:28.070024 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.831 us                | 1.018 ms                  |
| GenInput                  | 782.894 us                | 7.884 ms                  |
| NN                        | 1.168 ms                  | 7.351 ms                  |
| Forward                   | 1.632 ms                  | 9.819 ms                  |
| Backward                  | 3.370 ms                  | 17.020 ms                 |
| Optimize                  | 333.548 us                | 1.977 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.904 ms                  |
| AfterBackward             | 268.202 ms                | 4.498 s                   |
| BlockToStepN              | 389.459 us                | 1.964 ms                  |
| OneStep                   | 277.930 ms                | 4.507 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:28.633854 43841 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240131 14:10:29.070051 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 14:10:29.658627 43841 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.511 us                | 232.246 us                |
| ProcessBack:Shuffle       | 250.858 ms                | 292.490 ms                |
| ProcessBack:UpdateCache   | 16.678 ms                 | 36.083 ms                 |
| ProcessBack:UpsertPq      | 65.444 us                 | 668.034 us                |
| ProcessOneStep            | 268.163 ms                | 4.498 s                   |
| BlockToStepN              | 281.928 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:30.070302 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
W20240131 14:10:30.749073 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 247 ========== 
E20240131 14:10:31.070253 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=119
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
W20240131 14:10:31.920228 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
========== Step 251 ========== 
E20240131 14:10:32.070163 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 252 ========== 
========== Step 253 ========== 
W20240131 14:10:32.836953 42492 grad_async_v2.h:257] pq is empty
========== Step 254 ========== 
E20240131 14:10:33.070081 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.990 us                | 1.018 ms                  |
| GenInput                  | 795.404 us                | 6.271 ms                  |
| NN                        | 1.170 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.373 ms                  | 17.020 ms                 |
| Optimize                  | 333.548 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 858.997 us                | 7.606 ms                  |
| AfterBackward             | 267.611 ms                | 4.360 s                   |
| BlockToStepN              | 406.782 us                | 1.964 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 255 ========== 
W20240131 14:10:33.157229 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
========== Step 256 ========== 
E20240131 14:10:33.614921 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=256, sample_step_cpp_seen_[rank]=255
E20240131 14:10:34.070343 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:34.379238 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.560 us                | 280.108 us                |
| ProcessBack:Shuffle       | 250.749 ms                | 290.416 ms                |
| ProcessBack:UpdateCache   | 16.663 ms                 | 32.706 ms                 |
| ProcessBack:UpsertPq      | 65.685 us                 | 619.145 us                |
| ProcessOneStep            | 267.521 ms                | 4.359 s                   |
| BlockToStepN              | 293.420 us                | 1.896 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:35.070143 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 14:10:35.461417 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240131 14:10:36.070142 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:36.335649 42492 grad_async_v2.h:257] pq is empty
========== Step 257 ========== 
W20240131 14:10:36.465147 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:10:36.550558 42492 grad_async_v2.h:257] pq is empty
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
E20240131 14:10:37.070111 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=115
========== Step 261 ========== 
========== Step 262 ========== 
W20240131 14:10:37.650182 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
========== Step 263 ========== 
========== Step 264 ========== 
E20240131 14:10:38.070012 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.334 us                | 1.018 ms                  |
| GenInput                  | 795.404 us                | 6.271 ms                  |
| NN                        | 1.172 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.371 ms                  | 17.020 ms                 |
| Optimize                  | 341.892 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 855.796 us                | 7.606 ms                  |
| AfterBackward             | 267.576 ms                | 4.360 s                   |
| BlockToStepN              | 414.938 us                | 2.127 ms                  |
| OneStep                   | 277.647 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 265 ========== 
========== Step 266 ========== 
W20240131 14:10:38.775882 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240131 14:10:38.787029 42492 grad_async_v2.h:257] pq is empty
========== Step 267 ========== 
W20240131 14:10:39.067839 42492 grad_async_v2.h:257] pq is empty
========== Step 268 ========== 
E20240131 14:10:39.070196 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 269 ========== 
E20240131 14:10:39.601140 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=269, sample_step_cpp_seen_[rank]=268
W20240131 14:10:39.693887 42492 grad_async_v2.h:257] pq is empty
========== Step 270 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.371 us                | 39.328 ms                 |
| ProcessBack:Shuffle       | 250.449 ms                | 290.416 ms                |
| ProcessBack:UpdateCache   | 16.648 ms                 | 32.706 ms                 |
| ProcessBack:UpsertPq      | 65.685 us                 | 619.145 us                |
| ProcessOneStep            | 267.521 ms                | 4.359 s                   |
| BlockToStepN              | 304.366 us                | 1.999 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:40.070161 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:40.561753 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 14:10:41.070040 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:10:41.569738 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240131 14:10:42.070302 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:10:43.070077 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.334 us                | 1.018 ms                  |
| GenInput                  | 793.100 us                | 6.271 ms                  |
| NN                        | 1.172 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.373 ms                  | 17.020 ms                 |
| Optimize                  | 340.223 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.606 ms                  |
| AfterBackward             | 267.576 ms                | 4.360 s                   |
| BlockToStepN              | 419.393 us                | 2.127 ms                  |
| OneStep                   | 277.647 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:43.191761 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 271 ========== 
E20240131 14:10:44.070111 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=148
W20240131 14:10:44.201820 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.309 us                | 27.502 ms                 |
| ProcessBack:Shuffle       | 250.378 ms                | 290.416 ms                |
| ProcessBack:UpdateCache   | 16.635 ms                 | 32.706 ms                 |
| ProcessBack:UpsertPq      | 65.730 us                 | 619.145 us                |
| ProcessOneStep            | 267.521 ms                | 4.359 s                   |
| BlockToStepN              | 308.039 us                | 2.444 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:45.070019 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 275 ========== 
W20240131 14:10:45.251251 43841 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
E20240131 14:10:46.070362 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=54
========== Step 279 ========== 
========== Step 280 ========== 
W20240131 14:10:46.540660 43841 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240131 14:10:46.715626 42492 grad_async_v2.h:257] pq is empty
========== Step 281 ========== 
========== Step 282 ========== 
E20240131 14:10:47.070098 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=96
========== Step 283 ========== 
E20240131 14:10:47.555768 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=283, sample_step_cpp_seen_[rank]=282
W20240131 14:10:47.841545 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 14:10:48.070223 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 1.038 ms                  |
| GenInput                  | 781.324 us                | 7.884 ms                  |
| NN                        | 1.175 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.371 ms                  | 17.020 ms                 |
| Optimize                  | 339.746 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.606 ms                  |
| AfterBackward             | 267.686 ms                | 4.360 s                   |
| BlockToStepN              | 441.428 us                | 2.507 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:49.053507 43841 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240131 14:10:49.070351 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.053 us                | 279.567 us                |
| ProcessBack:Shuffle       | 250.749 ms                | 290.416 ms                |
| ProcessBack:UpdateCache   | 16.616 ms                 | 32.706 ms                 |
| ProcessBack:UpsertPq      | 65.627 us                 | 619.145 us                |
| ProcessOneStep            | 267.623 ms                | 4.359 s                   |
| BlockToStepN              | 314.499 us                | 2.444 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 14:10:50.065413 43841 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:10:50.070119 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
E20240131 14:10:51.070303 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=139
========== Step 288 ========== 
W20240131 14:10:51.245679 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
E20240131 14:10:52.070230 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=90
========== Step 292 ========== 
========== Step 293 ========== 
W20240131 14:10:52.440686 43841 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 294 ========== 
========== Step 295 ========== 
E20240131 14:10:53.070263 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 1.038 ms                  |
| GenInput                  | 781.324 us                | 7.884 ms                  |
| NN                        | 1.175 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.373 ms                  | 17.020 ms                 |
| Optimize                  | 338.793 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.606 ms                  |
| AfterBackward             | 267.918 ms                | 4.360 s                   |
| BlockToStepN              | 455.559 us                | 2.507 ms                  |
| OneStep                   | 277.647 ms                | 4.367 s                   |
| E2E-100                   | 48.329 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:53.226392 42492 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=295, sample_step_cpp_seen_[rank]=294
========== Step 296 ========== 
W20240131 14:10:53.815387 43841 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 14:10:54.070137 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 132.089 us                | 269.753 us                |
| ProcessBack:Shuffle       | 250.858 ms                | 290.416 ms                |
| ProcessBack:UpdateCache   | 16.616 ms                 | 32.706 ms                 |
| ProcessBack:UpsertPq      | 65.220 us                 | 619.145 us                |
| ProcessOneStep            | 267.883 ms                | 4.359 s                   |
| BlockToStepN              | 333.543 us                | 2.444 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 14:10:55.070226 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:10:55.145779 43841 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 297 ========== 
========== Step 298 ========== 
E20240131 14:10:56.070180 43841 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 14:10:56.091370 42492 grad_async_v2.h:257] pq is empty
========== Step 299 ========== 
W20240131 14:10:56.172004 43841 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
Step299:rank0, time: 50.744, per_step: 0.502414
Step299:rank3, time: 50.743, per_step: 0.502410
Step299:rank2, time: 50.743, per_step: 0.502410
Step299:rank5, time: 50.743, per_step: 0.502410
Step299:rank7, time: 50.743, per_step: 0.502410
Step299:rank4, time: 50.744, per_step: 0.502413
Step299:rank6, time: 50.744, per_step: 0.502413
Step299:rank1, time: 50.743, per_step: 0.502410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.310 us                | 1.038 ms                  |
| GenInput                  | 782.894 us                | 7.884 ms                  |
| NN                        | 1.175 ms                  | 6.716 ms                  |
| Forward                   | 1.636 ms                  | 8.882 ms                  |
| Backward                  | 3.373 ms                  | 17.020 ms                 |
| Optimize                  | 338.554 us                | 1.746 ms                  |
| BarrierTimeBeforeRank0    | 856.874 us                | 7.606 ms                  |
| AfterBackward             | 267.918 ms                | 4.360 s                   |
| BlockToStepN              | 458.162 us                | 2.507 ms                  |
| OneStep                   | 277.770 ms                | 4.367 s                   |
| E2E-100                   | 50.744 s                  | 54.896 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 14:10:56.365550 42492 grad_async_v2.h:84] call StopThreads. PID = 42492
W20240131 14:10:56.365571 42492 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 14:10:56.365617 42492 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 14:10:56.365625 42492 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
