WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 17:05:47.563814 14996 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 17:05:47.573621 14996 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [14996 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fb829e019e0>==========
Worker 1 pid=15147
Worker 2 pid=15148
Worker 3 pid=15149
Worker 4 pid=15150
Worker 5 pid=15151
Worker 6 pid=15152
INFO [14996 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [15147 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [15148 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [15150 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [15149 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [15151 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [15153 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [15152 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [14996 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15150 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15153 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15152 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15149 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15151 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:06:05.447000 14996 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.447034 15150 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.446926 15153 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.446947 15152 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.447046 15149 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.447767 15151 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [15148 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15147 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 17:06:05.455646 15148 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 17:06:05.455875 15147 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 17:06:24.080679 15147 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240131 17:06:24.080937 15153 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1688128, 32]; dev=7; size=206.1 MB
W20240131 17:06:24.083603 15150 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1688128, 32]; dev=4; size=206.1 MB
W20240131 17:06:24.084575 15151 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1688128, 32]; dev=5; size=206.1 MB
W20240131 17:06:24.084583 15148 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240131 17:06:24.085108 15152 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1688128, 32]; dev=6; size=206.1 MB
W20240131 17:06:24.089471 15149 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240131 17:06:24.093264 14996 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240131 17:06:24.797240 15147 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100101970000 7.629 MB
W20240131 17:06:24.797271 15150 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100102113000 7.629 MB
W20240131 17:06:24.797420 15147 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1001028b6000 7.629 MB
W20240131 17:06:24.797454 15150 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100103059000 7.629 MB
W20240131 17:06:24.797473 15147 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001037fc000 122.1 MB
W20240131 17:06:24.797519 15147 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10010b210000 122.1 MB
W20240131 17:06:24.797554 15150 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x100112c24000 122.1 MB
W20240131 17:06:24.797580 15147 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 17:06:24.797602 15150 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x10011a638000 122.1 MB
W20240131 17:06:24.797688 15150 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 17:06:24.798632 15147 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 17:06:24.798740 15150 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 17:06:24.801756 15153 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100122056000 7.629 MB
W20240131 17:06:24.801947 15153 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1001227f9000 7.629 MB
W20240131 17:06:24.802029 15153 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x100122f9c000 122.1 MB
W20240131 17:06:24.802073 15153 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10012a9b0000 122.1 MB
W20240131 17:06:24.802119 15153 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 17:06:24.802642 15153 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 17:06:24.816386 15152 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1001323ca000 7.629 MB
W20240131 17:06:24.816543 15152 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100132b6d000 7.629 MB
W20240131 17:06:24.816622 15152 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100133310000 122.1 MB
W20240131 17:06:24.816677 15152 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x10013ad24000 122.1 MB
W20240131 17:06:24.816731 15152 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 17:06:24.817170 15152 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 17:06:24.829138 15149 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10014273e000 7.629 MB
W20240131 17:06:24.829278 15149 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100142ee1000 7.629 MB
W20240131 17:06:24.829339 15149 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100143684000 122.1 MB
W20240131 17:06:24.829380 15149 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10014b098000 122.1 MB
W20240131 17:06:24.829428 15149 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 17:06:24.830902 15149 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 17:06:24.831146 15151 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100152ab0000 7.629 MB
W20240131 17:06:24.831272 15151 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100153255000 7.629 MB
W20240131 17:06:24.831329 15151 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1001539f8000 122.1 MB
W20240131 17:06:24.831377 15151 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x10015b40c000 122.1 MB
W20240131 17:06:24.831421 15151 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 17:06:24.831853 15151 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 17:06:24.842635 15148 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100162e26000 7.629 MB
W20240131 17:06:24.842790 15148 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1001635c9000 7.629 MB
W20240131 17:06:24.842862 15148 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100163d6c000 122.1 MB
W20240131 17:06:24.842906 15148 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10016b780000 122.1 MB
W20240131 17:06:24.842955 15148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 17:06:24.843317 15148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 17:06:24.854490 14996 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10017319a000 7.629 MB
W20240131 17:06:24.854777 14996 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10017393d000 7.629 MB
W20240131 17:06:24.854859 14996 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1001740e0000 122.1 MB
W20240131 17:06:24.854915 14996 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10017baf4000 122.1 MB
W20240131 17:06:24.854959 14996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 17:06:24.856263 14996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
Worker 7 pid=15153
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512), (6752512, 8440640), (8440640, 10128768), (10128768, 11816896), (11816896, 13505024)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240131 17:06:32.420922 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10018350c000 7.629 MB
W20240131 17:06:32.421137 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100183caf000 7.629 MB
W20240131 17:06:32.421185 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100184452000 7.629 MB
W20240131 17:06:32.421227 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x100184bf5000 7.629 MB
W20240131 17:06:32.421281 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100185398000 7.629 MB
W20240131 17:06:32.421331 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100185b3b000 7.629 MB
W20240131 17:06:32.421377 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1001862de000 7.629 MB
W20240131 17:06:32.421465 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x100186a81000 7.629 MB
W20240131 17:06:32.421509 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100187224000 7.629 MB
W20240131 17:06:32.421553 15152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1001879c7000 7.629 MB
W20240131 17:06:32.421593 15152 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x10018816a000 80 B 
W20240131 17:06:32.421653 15152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10018816c000 8 B 
W20240131 17:06:32.421695 15152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10018816e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:32.422098 15152 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 17:06:32.464403 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100188170000 7.629 MB
W20240131 17:06:32.464584 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100188913000 7.629 MB
W20240131 17:06:32.464632 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1001890b6000 7.629 MB
W20240131 17:06:32.464669 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100189859000 7.629 MB
W20240131 17:06:32.464710 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100189ffc000 7.629 MB
W20240131 17:06:32.464756 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10018a79f000 7.629 MB
W20240131 17:06:32.464798 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10018af42000 7.629 MB
W20240131 17:06:32.464880 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10018b6e5000 7.629 MB
W20240131 17:06:32.464927 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10018be88000 7.629 MB
W20240131 17:06:32.464977 15150 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10018c62b000 7.629 MB
W20240131 17:06:32.465020 15150 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x10018cdce000 80 B 
W20240131 17:06:32.465061 15150 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10018cdd0000 8 B 
W20240131 17:06:32.465099 15150 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10018cdd2000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:32.465458 15150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:32.612114 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10018cdd4000 7.629 MB
W20240131 17:06:32.612293 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10018d577000 7.629 MB
W20240131 17:06:32.612341 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10018dd1a000 7.629 MB
W20240131 17:06:32.612378 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10018e4bd000 7.629 MB
W20240131 17:06:32.612424 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10018ec60000 7.629 MB
W20240131 17:06:32.612470 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10018f403000 7.629 MB
W20240131 17:06:32.612516 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10018fba6000 7.629 MB
W20240131 17:06:32.612607 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100190349000 7.629 MB
W20240131 17:06:32.612653 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100190aec000 7.629 MB
W20240131 17:06:32.612702 15147 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10019128f000 7.629 MB
W20240131 17:06:32.612741 15147 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100191a32000 80 B 
W20240131 17:06:32.612782 15147 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100191a34000 8 B 
W20240131 17:06:32.612820 15147 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100191a36000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:32.613131 15147 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:32.793963 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100191a38000 7.629 MB
W20240131 17:06:32.794173 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1001921db000 7.629 MB
W20240131 17:06:32.794222 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10019297e000 7.629 MB
W20240131 17:06:32.794256 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100193121000 7.629 MB
W20240131 17:06:32.794301 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1001938c4000 7.629 MB
W20240131 17:06:32.794356 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100194067000 7.629 MB
W20240131 17:06:32.794407 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10019480a000 7.629 MB
W20240131 17:06:32.794524 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x100194fad000 7.629 MB
W20240131 17:06:32.794579 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x100195750000 7.629 MB
W20240131 17:06:32.794622 15151 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x100195ef3000 7.629 MB
W20240131 17:06:32.794658 15151 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x100196696000 80 B 
W20240131 17:06:32.794696 15151 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100196698000 8 B 
W20240131 17:06:32.794734 15151 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10019669a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:32.795105 15151 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:33.440186 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10019669c000 7.629 MB
W20240131 17:06:33.440349 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100196e3f000 7.629 MB
W20240131 17:06:33.440397 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001975e2000 7.629 MB
W20240131 17:06:33.440434 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100197d85000 7.629 MB
W20240131 17:06:33.440479 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100198528000 7.629 MB
W20240131 17:06:33.440524 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100198ccb000 7.629 MB
W20240131 17:06:33.440573 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10019946e000 7.629 MB
W20240131 17:06:33.440652 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100199c11000 7.629 MB
W20240131 17:06:33.440694 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10019a3b4000 7.629 MB
W20240131 17:06:33.440743 15148 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10019ab57000 7.629 MB
W20240131 17:06:33.440783 15148 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10019b2fa000 80 B 
W20240131 17:06:33.440825 15148 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10019b2fc000 8 B 
W20240131 17:06:33.440865 15148 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10019b2fe000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:33.441190 15148 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:33.556892 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10019b300000 7.629 MB
W20240131 17:06:33.557056 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10019baa3000 7.629 MB
W20240131 17:06:33.557102 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10019c246000 7.629 MB
W20240131 17:06:33.557163 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10019c9e9000 7.629 MB
W20240131 17:06:33.557206 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10019d18c000 7.629 MB
W20240131 17:06:33.557256 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10019d92f000 7.629 MB
W20240131 17:06:33.557303 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10019e0d2000 7.629 MB
W20240131 17:06:33.557377 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10019e875000 7.629 MB
W20240131 17:06:33.557441 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x10019f018000 7.629 MB
W20240131 17:06:33.557494 15153 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10019f7bb000 7.629 MB
W20240131 17:06:33.557544 15153 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10019ff5e000 80 B 
W20240131 17:06:33.557585 15153 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10019ff60000 8 B 
W20240131 17:06:33.557624 15153 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10019ff62000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:33.557950 15153 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:33.572551 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10019ff64000 7.629 MB
W20240131 17:06:33.572783 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1001a0707000 7.629 MB
W20240131 17:06:33.572840 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1001a0eaa000 7.629 MB
W20240131 17:06:33.572917 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1001a164d000 7.629 MB
W20240131 17:06:33.572960 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1001a1df0000 7.629 MB
W20240131 17:06:33.573006 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1001a2593000 7.629 MB
W20240131 17:06:33.573046 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1001a2d36000 7.629 MB
W20240131 17:06:33.573140 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1001a34d9000 7.629 MB
W20240131 17:06:33.573180 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1001a3c7c000 7.629 MB
W20240131 17:06:33.573248 14996 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001a441f000 7.629 MB
W20240131 17:06:33.573287 14996 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1001a4bc2000 80 B 
W20240131 17:06:33.573346 14996 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1001a4bc4000 8 B 
W20240131 17:06:33.573387 14996 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1001a4bc6000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:33.573796 14996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:33.908982 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1001a4bc8000 7.629 MB
W20240131 17:06:33.909194 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1001a536b000 7.629 MB
W20240131 17:06:33.909251 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1001a5b0e000 7.629 MB
W20240131 17:06:33.909292 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1001a62b1000 7.629 MB
W20240131 17:06:33.909343 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1001a6a54000 7.629 MB
W20240131 17:06:33.909390 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1001a71f7000 7.629 MB
W20240131 17:06:33.909440 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1001a799a000 7.629 MB
W20240131 17:06:33.909523 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1001a813d000 7.629 MB
W20240131 17:06:33.909564 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1001a88e0000 7.629 MB
W20240131 17:06:33.909610 15149 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1001a9083000 7.629 MB
W20240131 17:06:33.909657 15149 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1001a9826000 80 B 
W20240131 17:06:33.909700 15149 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1001a9828000 8 B 
W20240131 17:06:33.909739 15149 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1001a982a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 17:06:33.910122 15149 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 17:06:33.912881 14996 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 17:06:33.913074 14996 grad_base.h:184] Init GradProcessingBase done
I20240131 17:06:37.940897 14996 grad_async_v2.h:42] Use main thread to update emb.
W20240131 17:06:37.941311 14996 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 17:06:37.941327 14996 kg_controller.h:84] Construct KGCacheController done
E20240131 17:06:38.758071 15149 recstore.cc:66] init folly done
E20240131 17:06:38.758095 15153 recstore.cc:66] init folly done
E20240131 17:06:38.758118 15150 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 17:06:38.758297 15151 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 17:06:38.758481 14996 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 17:06:38.759052 15148 recstore.cc:66] init folly done
E20240131 17:06:38.759056 15152 recstore.cc:66] init folly done
E20240131 17:06:38.759057 15147 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 17:06:38.760417 14996 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 17:06:39.976091 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:06:39.976364 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:06:40.976161 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 17:06:41.064456 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:06:41.976065 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 17:06:42.149271 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:06:42.976022 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:06:43.254053 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 166.032 us                | 317.738 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 17:06:43.976184 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:06:44.324774 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:06:44.976018 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 17:06:45.522080 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:06:45.976019 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 17:06:46.763739 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:06:46.976029 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=172
W20240131 17:06:47.825057 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:06:47.976007 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 169.292 us                | 346.313 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 17:06:48.976027 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 17:06:49.141193 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:06:49.976213 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 17:06:50.521083 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:06:50.976019 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:06:51.626844 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:06:51.976015 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=105
W20240131 17:06:52.694566 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:06:52.976037 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 149.999 us                | 288.420 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 17:06:53.837777 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:06:53.976104 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 17:06:54.885888 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:06:54.976182 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 17:06:55.931324 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:06:55.976016 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=157
E20240131 17:06:56.976042 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
Before Training
I20240131 17:06:57.933940 15148 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
Before Training
I20240131 17:06:57.934221 15147 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 17:06:57.934278 15149 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:06:57.934324 15153 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:06:57.934382 15151 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:06:57.934427 15150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240131 17:06:57.936642 14996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 17:06:57.936684 15152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
W20240131 17:06:57.971547 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:06:57.998517 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.846 us                | 9.975 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 358.661 us                | 358.661 us                |
| GenInput                  | 126.391 ms                | 126.391 ms                |
| NN                        | 192.478 ms                | 192.478 ms                |
| Forward                   | 279.017 ms                | 279.017 ms                |
| Backward                  | 111.588 ms                | 111.588 ms                |
| Optimize                  | 4.611 ms                  | 4.611 ms                  |
| BarrierTimeBeforeRank0    | 22.775 ms                 | 22.775 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 17:06:58.998083 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=125
W20240131 17:06:59.073889 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:07:01.664865 16025 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
E20240131 17:07:02.664137 16026 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
W20240131 17:07:03.456976 14996 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240131 17:07:03.673367 15919 parallel_pq_v2.h:79] insert failed, size(hashtable)=23523
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 252.060 us                | 2.072 ms                  |
| ProcessBack:Shuffle       | 2.287 s                   | 2.287 s                   |
| ProcessBack:UpdateCache   | 877.599 ms                | 877.599 ms                |
| ProcessBack:UpsertPq      | 1.792 s                   | 1.792 s                   |
| ProcessOneStep            | 4.969 s                   | 4.969 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 358.661 us                | 358.661 us                |
| GenInput                  | 126.391 ms                | 126.391 ms                |
| NN                        | 192.478 ms                | 192.478 ms                |
| Forward                   | 279.017 ms                | 279.017 ms                |
| Backward                  | 111.588 ms                | 111.588 ms                |
| Optimize                  | 4.611 ms                  | 4.611 ms                  |
| BarrierTimeBeforeRank0    | 22.775 ms                 | 22.775 ms                 |
| AfterBackward             | 4.969 s                   | 4.969 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
W20240131 17:07:04.233978 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [15152 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15147 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15150 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15148 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15153 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [14996 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15149 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [15151 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
E20240131 17:07:04.673130 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:07:05.391315 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:07:05.673024 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=8037
W20240131 17:07:06.192119 14996 grad_async_v2.h:257] pq is empty
========== Step 2 ========== 
E20240131 17:07:06.673040 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=2091
W20240131 17:07:06.698390 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:07:07.673192 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=8110
W20240131 17:07:07.748780 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 17:07:08.325500 14996 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
E20240131 17:07:08.673368 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 269.441 us                | 47.660 ms                 |
| ProcessBack:Shuffle       | 1.804 s                   | 2.287 s                   |
| ProcessBack:UpdateCache   | 5.095 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 77.803 us                 | 1.792 s                   |
| ProcessOneStep            | 1.811 s                   | 4.969 s                   |
| BlockToStepN              | 77.770 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.729 us                | 29.802 ms                 |
| GenInput                  | 126.391 ms                | 152.534 ms                |
| NN                        | 5.939 ms                  | 192.478 ms                |
| Forward                   | 9.882 ms                  | 279.017 ms                |
| Backward                  | 12.746 ms                 | 111.588 ms                |
| Optimize                  | 600.100 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.012 ms                  | 22.775 ms                 |
| AfterBackward             | 1.812 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.988 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:08.962981 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 17:07:09.673065 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=11492
W20240131 17:07:10.046694 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 17:07:10.673022 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=14742
W20240131 17:07:11.131526 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 5 ========== 
E20240131 17:07:11.673018 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=362
W20240131 17:07:12.277606 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:07:12.673027 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=15520
W20240131 17:07:13.271893 14996 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 17:07:13.304797 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:07:13.673164 15915 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 307.230 us                | 56.998 ms                 |
| ProcessBack:Shuffle       | 1.804 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 5.095 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 76.228 us                 | 1.792 s                   |
| ProcessOneStep            | 1.811 s                   | 4.969 s                   |
| BlockToStepN              | 77.770 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.729 us                | 29.802 ms                 |
| GenInput                  | 126.391 ms                | 152.534 ms                |
| NN                        | 3.444 ms                  | 192.478 ms                |
| Forward                   | 9.882 ms                  | 279.017 ms                |
| Backward                  | 12.746 ms                 | 111.588 ms                |
| Optimize                  | 547.647 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.246 ms                  | 22.775 ms                 |
| AfterBackward             | 1.812 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.988 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:14.400240 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:07:14.673018 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=11752
W20240131 17:07:15.055821 14996 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
W20240131 17:07:15.465235 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:07:15.673224 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=8615
W20240131 17:07:16.732107 14996 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
W20240131 17:07:16.756772 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:07:16.756922 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:07:17.756012 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=965
W20240131 17:07:17.916620 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 17:07:18.337694 14996 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
E20240131 17:07:18.756165 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=802
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 409.281 us                | 59.659 ms                 |
| ProcessBack:Shuffle       | 1.592 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.856 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 76.228 us                 | 1.792 s                   |
| ProcessOneStep            | 1.597 s                   | 4.969 s                   |
| BlockToStepN              | 91.437 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 254.018 us                | 29.802 ms                 |
| GenInput                  | 133.315 ms                | 154.842 ms                |
| NN                        | 1.983 ms                  | 192.478 ms                |
| Forward                   | 3.338 ms                  | 279.017 ms                |
| Backward                  | 12.966 ms                 | 111.588 ms                |
| Optimize                  | 547.647 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.012 ms                  | 22.775 ms                 |
| AfterBackward             | 1.597 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.784 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:18.932107 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:07:19.756206 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=3194
W20240131 17:07:20.024363 14996 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
W20240131 17:07:20.048614 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:07:20.756235 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=4996
W20240131 17:07:21.113731 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 17:07:21.561669 14996 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
E20240131 17:07:21.756088 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=174
W20240131 17:07:22.168735 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:07:22.756186 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=8501
W20240131 17:07:23.193326 14996 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
W20240131 17:07:23.220825 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:07:23.756094 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1456
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 23.761 ms                 | 67.408 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.442 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.814 us                 | 1.792 s                   |
| ProcessOneStep            | 1.515 s                   | 4.969 s                   |
| BlockToStepN              | 91.437 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 256.729 us                | 29.802 ms                 |
| GenInput                  | 136.040 ms                | 154.842 ms                |
| NN                        | 1.983 ms                  | 192.478 ms                |
| Forward                   | 3.338 ms                  | 279.017 ms                |
| Backward                  | 13.849 ms                 | 111.588 ms                |
| Optimize                  | 547.647 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.246 ms                  | 22.775 ms                 |
| AfterBackward             | 1.515 s                   | 4.969 s                   |
| BlockToStepN              | 200.978 us                | 745.385 ms                |
| OneStep                   | 1.676 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:24.313041 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 17:07:24.796322 14996 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
E20240131 17:07:24.828898 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:07:25.313117 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:07:25.828271 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=9715
W20240131 17:07:26.419000 14996 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
W20240131 17:07:26.459591 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:07:26.828107 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=487
W20240131 17:07:27.604004 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:07:27.828188 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=551
W20240131 17:07:28.057142 14996 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
W20240131 17:07:28.761672 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.113 ms                 | 67.408 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.385 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 76.198 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 94.125 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:28.828105 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=631
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 249.383 us                | 29.802 ms                 |
| GenInput                  | 127.361 ms                | 154.842 ms                |
| NN                        | 1.806 ms                  | 192.478 ms                |
| Forward                   | 2.738 ms                  | 279.017 ms                |
| Backward                  | 13.849 ms                 | 111.588 ms                |
| Optimize                  | 501.633 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.416 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 206.686 us                | 745.385 ms                |
| OneStep                   | 1.673 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:29.896997 14996 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
W20240131 17:07:29.920576 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:07:29.920892 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:07:30.920179 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1066
W20240131 17:07:31.179165 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:07:31.924332 15919 parallel_pq_v2.h:79] insert failed, size(hashtable)=419
W20240131 17:07:32.018162 14996 grad_async_v2.h:257] pq is empty
========== Step 17 ========== 
W20240131 17:07:32.396944 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:07:32.924010 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=258
W20240131 17:07:33.557798 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 30.286 ms                 | 60.991 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.385 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 76.198 us                 | 1.792 s                   |
| ProcessOneStep            | 1.515 s                   | 4.969 s                   |
| BlockToStepN              | 94.125 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 133.315 ms                | 154.842 ms                |
| NN                        | 1.806 ms                  | 192.478 ms                |
| Forward                   | 2.738 ms                  | 279.017 ms                |
| Backward                  | 13.777 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.458 ms                  | 22.775 ms                 |
| AfterBackward             | 1.515 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.676 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:33.924016 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=552
W20240131 17:07:34.162176 14996 grad_async_v2.h:257] pq is empty
========== Step 18 ========== 
W20240131 17:07:34.599690 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:07:34.924113 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=4993
W20240131 17:07:35.788653 14996 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
W20240131 17:07:35.830977 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:07:35.924038 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=368
E20240131 17:07:36.924083 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1215
W20240131 17:07:36.925042 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 17:07:37.434578 14996 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
E20240131 17:07:37.924067 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=5494
W20240131 17:07:38.056648 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.113 ms                 | 56.062 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.356 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 70.724 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 94.069 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 148.156 ms                | 159.632 ms                |
| NN                        | 1.863 ms                  | 192.478 ms                |
| Forward                   | 3.032 ms                  | 279.017 ms                |
| Backward                  | 13.849 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.489 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 206.686 us                | 745.385 ms                |
| OneStep                   | 1.673 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:39.016954 14996 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
W20240131 17:07:39.109241 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:07:39.109637 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:07:40.109104 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=368
W20240131 17:07:40.151731 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 17:07:40.612869 14996 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
E20240131 17:07:41.109170 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=170
W20240131 17:07:41.312008 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:07:42.109138 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=938
W20240131 17:07:42.503765 14996 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
W20240131 17:07:42.536756 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:07:43.112155 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:07:43.672333 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.944 ms                 | 51.885 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.256 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 72.435 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 94.471 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 148.156 ms                | 159.632 ms                |
| NN                        | 1.863 ms                  | 192.478 ms                |
| Forward                   | 3.338 ms                  | 279.017 ms                |
| Backward                  | 13.777 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.489 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 206.686 us                | 745.385 ms                |
| OneStep                   | 1.673 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:44.112093 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=340
W20240131 17:07:44.352288 14996 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
W20240131 17:07:44.761902 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:07:45.112027 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=118
W20240131 17:07:45.780156 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 17:07:46.044255 14996 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
E20240131 17:07:46.112039 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=62
W20240131 17:07:46.907601 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:07:47.112746 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=442
W20240131 17:07:47.250264 14996 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
E20240131 17:07:48.112102 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=394
W20240131 17:07:48.217734 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.957 ms                 | 52.122 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.256 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 73.529 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 95.400 us                 | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 148.156 ms                | 159.632 ms                |
| NN                        | 1.863 ms                  | 192.478 ms                |
| Forward                   | 3.338 ms                  | 279.017 ms                |
| Backward                  | 13.849 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 206.686 us                | 745.385 ms                |
| OneStep                   | 1.673 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:49.112701 15923 parallel_pq_v2.h:79] insert failed, size(hashtable)=1199
W20240131 17:07:49.297369 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 17:07:49.569180 14996 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
E20240131 17:07:50.112035 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=4579
W20240131 17:07:50.447701 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 17:07:51.118191 14996 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
E20240131 17:07:51.156767 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:07:51.511080 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:07:52.156194 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=306
W20240131 17:07:52.659456 14996 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
W20240131 17:07:52.700570 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:07:53.156251 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=794
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.777 ms                 | 56.062 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.256 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 101.379 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 17:07:53.784122 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 244.236 us                | 29.802 ms                 |
| GenInput                  | 141.534 ms                | 159.632 ms                |
| NN                        | 1.806 ms                  | 192.478 ms                |
| Forward                   | 3.032 ms                  | 279.017 ms                |
| Backward                  | 13.777 ms                 | 111.588 ms                |
| Optimize                  | 458.956 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.673 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:54.156216 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=126
W20240131 17:07:54.277577 14996 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
W20240131 17:07:54.892805 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:07:55.156016 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=152
W20240131 17:07:55.919479 14996 grad_async_v2.h:257] pq is empty
W20240131 17:07:55.936545 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 31 ========== 
E20240131 17:07:56.156008 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=128
W20240131 17:07:57.091217 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:07:57.156587 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=467
W20240131 17:07:57.773393 14996 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
E20240131 17:07:58.156445 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:07:58.189071 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 24.696 ms                 | 52.122 ms                 |
| ProcessBack:Shuffle       | 1.472 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.185 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.792 s                   |
| ProcessOneStep            | 1.476 s                   | 4.969 s                   |
| BlockToStepN              | 101.379 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.041 us                | 29.802 ms                 |
| GenInput                  | 141.534 ms                | 159.632 ms                |
| NN                        | 1.974 ms                  | 192.478 ms                |
| Forward                   | 3.351 ms                  | 279.017 ms                |
| Backward                  | 13.767 ms                 | 111.588 ms                |
| Optimize                  | 501.633 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 22.775 ms                 |
| AfterBackward             | 1.477 s                   | 4.969 s                   |
| BlockToStepN              | 212.192 us                | 745.385 ms                |
| OneStep                   | 1.646 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:07:59.156188 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=75
W20240131 17:07:59.410888 14996 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
W20240131 17:07:59.460162 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:08:00.156108 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=741
W20240131 17:08:00.520210 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 17:08:00.959816 14996 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
E20240131 17:08:01.156142 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=766
W20240131 17:08:01.549968 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:08:02.156008 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=240
W20240131 17:08:02.762449 14996 grad_async_v2.h:257] pq is empty
W20240131 17:08:02.792945 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 35 ========== 
E20240131 17:08:03.156208 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=549
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.725 ms                 | 56.517 ms                 |
| ProcessBack:Shuffle       | 1.472 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.170 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.287 us                 | 1.792 s                   |
| ProcessOneStep            | 1.476 s                   | 4.969 s                   |
| BlockToStepN              | 102.094 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:03.837227 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 244.318 us                | 29.802 ms                 |
| GenInput                  | 136.040 ms                | 159.632 ms                |
| NN                        | 1.974 ms                  | 192.478 ms                |
| Forward                   | 3.338 ms                  | 279.017 ms                |
| Backward                  | 12.966 ms                 | 111.588 ms                |
| Optimize                  | 458.956 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 22.775 ms                 |
| AfterBackward             | 1.477 s                   | 4.969 s                   |
| BlockToStepN              | 212.742 us                | 745.385 ms                |
| OneStep                   | 1.646 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:04.156188 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1728
W20240131 17:08:04.485029 14996 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
W20240131 17:08:04.920588 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:08:05.156023 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=278
W20240131 17:08:06.149358 14996 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
W20240131 17:08:06.176198 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:08:06.176386 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:08:07.179981 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=106
W20240131 17:08:07.339254 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 17:08:07.819159 14996 grad_async_v2.h:257] pq is empty
========== Step 38 ========== 
E20240131 17:08:08.179126 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=370
W20240131 17:08:08.422832 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.759 ms                 | 56.517 ms                 |
| ProcessBack:Shuffle       | 1.494 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.128 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 73.529 us                 | 1.792 s                   |
| ProcessOneStep            | 1.498 s                   | 4.969 s                   |
| BlockToStepN              | 102.421 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 244.318 us                | 29.802 ms                 |
| GenInput                  | 141.249 ms                | 159.632 ms                |
| NN                        | 1.974 ms                  | 192.478 ms                |
| Forward                   | 3.351 ms                  | 279.017 ms                |
| Backward                  | 13.767 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 10.670 ms                 |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 22.775 ms                 |
| AfterBackward             | 1.499 s                   | 4.969 s                   |
| BlockToStepN              | 222.718 us                | 745.385 ms                |
| OneStep                   | 1.664 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:09.179008 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=2073
W20240131 17:08:09.376178 14996 grad_async_v2.h:257] pq is empty
========== Step 39 ========== 
W20240131 17:08:09.728018 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:08:10.179019 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=626
W20240131 17:08:10.768458 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 17:08:11.047480 14996 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
E20240131 17:08:11.192693 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=425
W20240131 17:08:11.862958 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:08:12.192027 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=850
W20240131 17:08:12.781838 14996 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
W20240131 17:08:13.168298 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:08:13.192247 15907 parallel_pq_v2.h:79] insert failed, size(hashtable)=469
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.962 ms                 | 57.922 ms                 |
| ProcessBack:Shuffle       | 1.500 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.079 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.792 s                   |
| ProcessOneStep            | 1.504 s                   | 4.969 s                   |
| BlockToStepN              | 103.276 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 244.318 us                | 29.802 ms                 |
| GenInput                  | 141.249 ms                | 163.393 ms                |
| NN                        | 1.974 ms                  | 192.478 ms                |
| Forward                   | 3.351 ms                  | 279.017 ms                |
| Backward                  | 12.746 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 10.670 ms                 |
| BarrierTimeBeforeRank0    | 1.489 ms                  | 22.775 ms                 |
| AfterBackward             | 1.504 s                   | 4.969 s                   |
| BlockToStepN              | 228.953 us                | 745.385 ms                |
| OneStep                   | 1.670 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:14.192020 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=819
W20240131 17:08:14.326975 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 17:08:14.579540 14996 grad_async_v2.h:257] pq is empty
========== Step 42 ========== 
E20240131 17:08:15.195976 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:08:15.329107 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:08:16.195070 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=540
W20240131 17:08:16.323053 14996 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
W20240131 17:08:16.336584 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:08:17.195103 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=162
W20240131 17:08:17.430503 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 17:08:18.069770 14996 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
E20240131 17:08:18.204898 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240131 17:08:18.576097 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.953 ms                 | 57.922 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.071 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 105.555 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.041 us                | 29.802 ms                 |
| GenInput                  | 141.249 ms                | 163.393 ms                |
| NN                        | 1.983 ms                  | 192.478 ms                |
| Forward                   | 4.004 ms                  | 279.017 ms                |
| Backward                  | 12.536 ms                 | 111.588 ms                |
| Optimize                  | 501.633 us                | 10.670 ms                 |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 228.953 us                | 745.385 ms                |
| OneStep                   | 1.671 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:19.204023 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=378
W20240131 17:08:19.603816 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 17:08:20.139246 14996 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
E20240131 17:08:20.204928 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:08:20.714432 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:08:21.204017 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1017
W20240131 17:08:21.686945 14996 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
W20240131 17:08:21.966105 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:08:22.204033 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=98
========== Step 47 ========== 
W20240131 17:08:23.015785 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 17:08:23.204352 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.106 ms                 | 59.673 ms                 |
| ProcessBack:Shuffle       | 1.502 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.073 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.655 us                 | 1.792 s                   |
| ProcessOneStep            | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 107.173 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 140.676 ms                | 179.726 ms                |
| NN                        | 1.983 ms                  | 192.478 ms                |
| Forward                   | 3.721 ms                  | 279.017 ms                |
| Backward                  | 12.536 ms                 | 111.588 ms                |
| Optimize                  | 501.633 us                | 10.670 ms                 |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 231.642 us                | 745.385 ms                |
| OneStep                   | 1.671 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:24.204392 15899 parallel_pq_v2.h:79] insert failed, size(hashtable)=327
W20240131 17:08:24.220631 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:08:25.213006 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=408
W20240131 17:08:25.525800 14996 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
W20240131 17:08:25.548739 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:08:26.212674 15901 parallel_pq_v2.h:79] insert failed, size(hashtable)=643
W20240131 17:08:26.646603 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 17:08:27.245735 14996 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
E20240131 17:08:27.278877 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:08:27.672116 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:08:28.278162 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1080
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.202 ms                 | 60.078 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.676 s                   |
| ProcessBack:UpdateCache   | 4.073 ms                  | 877.599 ms                |
| ProcessBack:UpsertPq      | 75.655 us                 | 1.792 s                   |
| ProcessOneStep            | 1.514 s                   | 4.969 s                   |
| BlockToStepN              | 107.298 us                | 744.392 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:28.794734 14996 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
W20240131 17:08:28.836753 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 29.802 ms                 |
| GenInput                  | 140.676 ms                | 179.726 ms                |
| NN                        | 2.105 ms                  | 192.478 ms                |
| Forward                   | 4.004 ms                  | 279.017 ms                |
| Backward                  | 12.426 ms                 | 111.588 ms                |
| Optimize                  | 484.943 us                | 10.670 ms                 |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 22.775 ms                 |
| AfterBackward             | 1.507 s                   | 4.969 s                   |
| BlockToStepN              | 231.642 us                | 745.385 ms                |
| OneStep                   | 1.671 s                   | 6.266 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:29.278028 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=308
W20240131 17:08:29.910373 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:08:30.278060 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=346
W20240131 17:08:30.581497 14996 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
W20240131 17:08:31.061235 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:08:31.278124 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=2138
E20240131 17:08:32.278028 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=334
W20240131 17:08:32.434195 14996 grad_async_v2.h:257] pq is empty
W20240131 17:08:32.456581 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 52 ========== 
E20240131 17:08:33.278038 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=331
W20240131 17:08:33.609771 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.066 ms                 | 59.673 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.049 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.651 us                 | 133.383 us                |
| ProcessOneStep            | 1.514 s                   | 2.683 s                   |
| BlockToStepN              | 109.500 us                | 316.437 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 249.383 us                | 2.022 ms                  |
| GenInput                  | 140.676 ms                | 163.691 ms                |
| NN                        | 2.123 ms                  | 19.791 ms                 |
| Forward                   | 4.134 ms                  | 24.826 ms                 |
| Backward                  | 12.045 ms                 | 31.861 ms                 |
| Optimize                  | 501.633 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 11.651 ms                 |
| AfterBackward             | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 235.915 us                | 513.708 us                |
| OneStep                   | 1.673 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:34.053488 14996 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
E20240131 17:08:34.278287 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=94
W20240131 17:08:34.729977 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:08:35.278084 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=622
W20240131 17:08:35.736936 14996 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
W20240131 17:08:35.755810 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:08:36.278312 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=419
W20240131 17:08:36.915242 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:08:37.279433 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=724
W20240131 17:08:37.547206 14996 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
W20240131 17:08:38.089993 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:08:38.279127 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1080
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.997 ms                 | 59.673 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.071 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.651 us                 | 133.383 us                |
| ProcessOneStep            | 1.514 s                   | 2.683 s                   |
| BlockToStepN              | 111.206 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.497 us                | 2.022 ms                  |
| GenInput                  | 139.614 ms                | 163.691 ms                |
| NN                        | 2.112 ms                  | 19.791 ms                 |
| Forward                   | 4.004 ms                  | 24.826 ms                 |
| Backward                  | 12.426 ms                 | 35.531 ms                 |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 11.651 ms                 |
| AfterBackward             | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 235.915 us                | 708.876 us                |
| OneStep                   | 1.676 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:39.278010 14996 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
W20240131 17:08:39.320062 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:08:39.320217 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 17:08:40.320044 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=326
W20240131 17:08:40.371909 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 17:08:40.809701 14996 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
E20240131 17:08:41.320833 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=124
W20240131 17:08:41.427081 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:08:42.320158 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=37
W20240131 17:08:42.553009 14996 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
W20240131 17:08:42.591221 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:08:43.320019 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=308
W20240131 17:08:43.650646 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.824 ms                 | 57.968 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.049 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.651 us                 | 133.383 us                |
| ProcessOneStep            | 1.514 s                   | 2.683 s                   |
| BlockToStepN              | 113.121 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 249.383 us                | 16.283 ms                 |
| GenInput                  | 139.614 ms                | 166.261 ms                |
| NN                        | 2.112 ms                  | 19.791 ms                 |
| Forward                   | 4.004 ms                  | 24.826 ms                 |
| Backward                  | 12.426 ms                 | 35.531 ms                 |
| Optimize                  | 500.679 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 11.651 ms                 |
| AfterBackward             | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 239.674 us                | 708.876 us                |
| OneStep                   | 1.676 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:44.298002 14996 grad_async_v2.h:257] pq is empty
========== Step 59 ========== 
E20240131 17:08:44.328774 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:08:44.653182 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:08:45.328158 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=283
W20240131 17:08:45.836473 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 17:08:46.167322 14996 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
E20240131 17:08:46.340338 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=175
W20240131 17:08:46.958194 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:08:47.340013 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=123
W20240131 17:08:48.086239 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 17:08:48.353365 14996 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
E20240131 17:08:48.381333 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.009 ms                 | 57.968 ms                 |
| ProcessBack:Shuffle       | 1.511 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.049 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.651 us                 | 133.383 us                |
| ProcessOneStep            | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 116.161 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.497 us                | 16.283 ms                 |
| GenInput                  | 138.267 ms                | 166.261 ms                |
| NN                        | 2.105 ms                  | 19.791 ms                 |
| Forward                   | 3.721 ms                  | 24.826 ms                 |
| Backward                  | 11.514 ms                 | 35.531 ms                 |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 11.651 ms                 |
| AfterBackward             | 1.516 s                   | 2.683 s                   |
| BlockToStepN              | 246.278 us                | 708.876 us                |
| OneStep                   | 1.687 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:49.126014 15894 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 17:08:49.381011 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=333
W20240131 17:08:50.090726 14996 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
W20240131 17:08:50.132064 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:08:50.381639 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=182
W20240131 17:08:51.272488 15894 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 17:08:51.381167 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=452
W20240131 17:08:51.716385 14996 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
W20240131 17:08:52.327040 15894 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 17:08:52.381063 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=276
W20240131 17:08:53.330528 14996 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
W20240131 17:08:53.360504 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 17:08:53.381067 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.775 ms                 | 63.575 ms                 |
| ProcessBack:Shuffle       | 1.510 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.042 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.651 us                 | 133.383 us                |
| ProcessOneStep            | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 116.974 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.497 us                | 16.283 ms                 |
| GenInput                  | 138.267 ms                | 166.261 ms                |
| NN                        | 2.105 ms                  | 19.791 ms                 |
| Forward                   | 3.721 ms                  | 24.826 ms                 |
| Backward                  | 12.045 ms                 | 35.531 ms                 |
| Optimize                  | 484.943 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.562 ms                  | 11.651 ms                 |
| AfterBackward             | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 246.278 us                | 708.876 us                |
| OneStep                   | 1.683 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 17:08:54.388458 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=260
W20240131 17:08:54.577021 15894 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 17:08:55.031178 14996 grad_async_v2.h:257] pq is empty
========== Step 65 ========== 
E20240131 17:08:55.388111 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=277
W20240131 17:08:55.623137 15894 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 17:08:56.388607 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
W20240131 17:08:56.584843 14996 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
W20240131 17:08:56.841224 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 17:08:57.388012 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=145
W20240131 17:08:57.851395 15894 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 17:08:58.396212 14996 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
E20240131 17:08:58.429077 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 29.078 ms                 | 64.185 ms                 |
| ProcessBack:Shuffle       | 1.511 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.042 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.655 us                 | 133.383 us                |
| ProcessOneStep            | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 118.120 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 16.283 ms                 |
| GenInput                  | 135.586 ms                | 166.261 ms                |
| NN                        | 2.105 ms                  | 19.791 ms                 |
| Forward                   | 3.721 ms                  | 24.826 ms                 |
| Backward                  | 12.045 ms                 | 35.531 ms                 |
| Optimize                  | 472.307 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.489 ms                  | 11.651 ms                 |
| AfterBackward             | 1.516 s                   | 2.683 s                   |
| BlockToStepN              | 247.045 us                | 708.876 us                |
| OneStep                   | 1.687 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:08:58.997359 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 17:08:59.433208 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:09:00.084589 15894 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 17:09:00.357625 14996 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
E20240131 17:09:00.456094 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 17:09:01.205317 15894 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 17:09:01.456214 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=209
W20240131 17:09:02.309657 14996 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
W20240131 17:09:02.332604 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:09:02.456007 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=400
W20240131 17:09:03.361788 15894 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 17:09:03.456023 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=302
Successfully xmh
W20240131 17:09:03.616322 14996 grad_async_v2.h:84] call StopThreads. PID = 14996
W20240131 17:09:03.616345 14996 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 17:09:03.616386 14996 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 17:09:03.616393 14996 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.538 ms                 | 56.464 ms                 |
| ProcessBack:Shuffle       | 1.511 s                   | 2.583 s                   |
| ProcessBack:UpdateCache   | 4.042 ms                  | 9.678 ms                  |
| ProcessBack:UpsertPq      | 75.655 us                 | 133.383 us                |
| ProcessOneStep            | 1.515 s                   | 2.683 s                   |
| BlockToStepN              | 119.208 us                | 325.354 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 245.047 us                | 16.283 ms                 |
| GenInput                  | 135.586 ms                | 166.261 ms                |
| NN                        | 2.105 ms                  | 19.791 ms                 |
| Forward                   | 3.721 ms                  | 24.826 ms                 |
| Backward                  | 11.514 ms                 | 35.531 ms                 |
| Optimize                  | 472.307 us                | 9.463 ms                  |
| BarrierTimeBeforeRank0    | 1.489 ms                  | 11.651 ms                 |
| AfterBackward             | 1.516 s                   | 2.683 s                   |
| BlockToStepN              | 247.045 us                | 708.876 us                |
| OneStep                   | 1.687 s                   | 2.853 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 17:09:04.447904 15894 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 17:09:04.456321 15894 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
