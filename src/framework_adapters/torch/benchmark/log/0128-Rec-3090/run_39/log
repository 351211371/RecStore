WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 14:47:27.653170 15744 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 14:47:27.662670 15744 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [15744 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f57340019e0>==========
Worker 1 pid=16114
Worker 2 pid=16115
Worker 3 pid=16116
Worker 4 pid=16117
Worker 5 pid=16118
Worker 6 pid=16119
INFO [15744 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [16114 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [16118 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [16115 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [16119 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [16116 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [16117 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [16120 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [16117 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16119 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16120 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16118 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16116 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16115 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15744 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16114 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 14:47:33.884104 16115 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884105 16119 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884102 16117 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884104 16118 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884111 16120 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884122 16116 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884660 15744 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 14:47:33.884835 16114 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 14:47:39.255504 16116 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 14:47:39.259313 16115 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 14:47:39.259344 16119 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [472460, 32]; dev=6; size=57.67 MB
W20240131 14:47:39.259429 16117 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [472460, 32]; dev=4; size=57.67 MB
W20240131 14:47:39.259958 16118 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [472460, 32]; dev=5; size=57.67 MB
W20240131 14:47:39.260071 15744 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 14:47:39.260879 16114 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 14:47:39.262105 16120 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [472460, 32]; dev=7; size=57.67 MB
W20240131 14:47:39.964439 16117 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10004817d000 7.629 MB
W20240131 14:47:39.964627 16117 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100048920000 7.629 MB
W20240131 14:47:39.964716 16117 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1000490c3000 122.1 MB
W20240131 14:47:39.964773 16117 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100050ad7000 122.1 MB
W20240131 14:47:39.964809 16117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 14:47:39.974545 16117 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 14:47:39.977898 16115 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000584f1000 7.629 MB
W20240131 14:47:39.978050 16115 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100058c94000 7.629 MB
W20240131 14:47:39.978132 16115 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100059437000 122.1 MB
W20240131 14:47:39.978188 16115 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100060e4b000 122.1 MB
W20240131 14:47:39.978231 16115 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:47:39.978593 16115 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 14:47:39.988719 16114 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100068865000 7.629 MB
W20240131 14:47:39.988883 16114 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100069008000 7.629 MB
W20240131 14:47:39.988938 16114 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000697ab000 122.1 MB
W20240131 14:47:39.988997 16114 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000711bf000 122.1 MB
W20240131 14:47:39.989038 16114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:47:39.990372 16114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 14:47:40.002045 16119 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100078bd9000 7.629 MB
W20240131 14:47:40.002209 16119 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10007937c000 7.629 MB
W20240131 14:47:40.002269 16119 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100079b1f000 122.1 MB
W20240131 14:47:40.002348 16119 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100081533000 122.1 MB
W20240131 14:47:40.002394 16119 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 14:47:40.008668 16119 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 14:47:40.021215 16120 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100088f4d000 7.629 MB
W20240131 14:47:40.021391 16120 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000896f0000 7.629 MB
W20240131 14:47:40.021452 16120 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x100089e93000 122.1 MB
W20240131 14:47:40.021512 16120 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000918a7000 122.1 MB
W20240131 14:47:40.021554 16120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 14:47:40.024303 16120 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 14:47:40.039191 16118 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000992c1000 7.629 MB
W20240131 14:47:40.039373 16118 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100099a64000 7.629 MB
W20240131 14:47:40.039433 16118 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10009a207000 122.1 MB
W20240131 14:47:40.039497 16118 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x1000a1c1b000 122.1 MB
W20240131 14:47:40.039537 16118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 14:47:40.187223 16118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 14:47:40.188793 15744 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000a9633000 7.629 MB
W20240131 14:47:40.189366 15744 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000a9dd6000 7.629 MB
W20240131 14:47:40.189586 15744 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1000aa579000 122.1 MB
W20240131 14:47:40.189775 15744 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000b1f8d000 122.1 MB
W20240131 14:47:40.189951 15744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 14:47:40.232141 16116 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000b99a5000 7.629 MB
W20240131 14:47:40.232301 16116 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000ba148000 7.629 MB
W20240131 14:47:40.232357 16116 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000ba8eb000 122.1 MB
W20240131 14:47:40.232414 16116 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000c22ff000 122.1 MB
W20240131 14:47:40.232451 16116 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 14:47:40.237049 16116 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 14:47:40.395927 15744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 7 pid=16120
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840), (1889840, 2362300), (2362300, 2834760), (2834760, 3307220), (3307220, 3779680)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240131 14:47:44.833842 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000c9d1b000 7.629 MB
W20240131 14:47:44.834455 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000ca4be000 7.629 MB
W20240131 14:47:44.834525 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000cac61000 7.629 MB
W20240131 14:47:44.834580 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000cb404000 7.629 MB
W20240131 14:47:44.834661 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000cbba7000 7.629 MB
W20240131 14:47:44.834694 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000cc34a000 7.629 MB
W20240131 14:47:44.834726 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000ccaed000 7.629 MB
W20240131 14:47:44.834868 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000cd290000 7.629 MB
W20240131 14:47:44.834954 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000cda33000 7.629 MB
W20240131 14:47:44.835018 15744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000ce1d6000 7.629 MB
W20240131 14:47:44.835081 15744 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000ce979000 80 B 
W20240131 14:47:44.835147 15744 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000ce97b000 8 B 
W20240131 14:47:44.835176 15744 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000ce97d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:44.836000 15744 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 14:47:45.478955 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000ce97f000 7.629 MB
W20240131 14:47:45.479166 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000cf122000 7.629 MB
W20240131 14:47:45.479246 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000cf8c5000 7.629 MB
W20240131 14:47:45.479310 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d0068000 7.629 MB
W20240131 14:47:45.479357 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000d080b000 7.629 MB
W20240131 14:47:45.479398 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000d0fae000 7.629 MB
W20240131 14:47:45.479454 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000d1751000 7.629 MB
W20240131 14:47:45.479516 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000d1ef4000 7.629 MB
W20240131 14:47:45.479588 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000d2697000 7.629 MB
W20240131 14:47:45.479657 16120 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000d2e3a000 7.629 MB
W20240131 14:47:45.479708 16120 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000d35dd000 80 B 
W20240131 14:47:45.479744 16120 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000d35df000 8 B 
W20240131 14:47:45.479774 16120 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000d35e1000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:45.480377 16120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:45.523880 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000d35e3000 7.629 MB
W20240131 14:47:45.524034 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d3d86000 7.629 MB
W20240131 14:47:45.524128 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d4529000 7.629 MB
W20240131 14:47:45.524174 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000d4ccc000 7.629 MB
W20240131 14:47:45.524246 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000d546f000 7.629 MB
W20240131 14:47:45.524293 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000d5c12000 7.629 MB
W20240131 14:47:45.524350 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000d63b5000 7.629 MB
W20240131 14:47:45.524403 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000d6b58000 7.629 MB
W20240131 14:47:45.524448 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000d72fb000 7.629 MB
W20240131 14:47:45.524497 16114 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000d7a9e000 7.629 MB
W20240131 14:47:45.524539 16114 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000d8241000 80 B 
W20240131 14:47:45.524575 16114 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000d8243000 8 B 
W20240131 14:47:45.524605 16114 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000d8245000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:45.524951 16114 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.564508 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d8247000 7.629 MB
W20240131 14:47:46.564682 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d89ea000 7.629 MB
W20240131 14:47:46.564742 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d918d000 7.629 MB
W20240131 14:47:46.564790 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d9930000 7.629 MB
W20240131 14:47:46.564833 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000da0d3000 7.629 MB
W20240131 14:47:46.564885 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000da876000 7.629 MB
W20240131 14:47:46.564935 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000db019000 7.629 MB
W20240131 14:47:46.564992 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000db7bc000 7.629 MB
W20240131 14:47:46.565037 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000dbf5f000 7.629 MB
W20240131 14:47:46.565079 16118 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000dc702000 7.629 MB
W20240131 14:47:46.565124 16118 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000dcea5000 80 B 
W20240131 14:47:46.565161 16118 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000dcea7000 8 B 
W20240131 14:47:46.565192 16118 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000dcea9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:46.565546 16118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.589816 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000dceab000 7.629 MB
W20240131 14:47:46.589977 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000dd64e000 7.629 MB
W20240131 14:47:46.590034 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000dddf1000 7.629 MB
W20240131 14:47:46.590095 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000de594000 7.629 MB
W20240131 14:47:46.590138 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000ded37000 7.629 MB
W20240131 14:47:46.590179 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000df4da000 7.629 MB
W20240131 14:47:46.590225 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000dfc7d000 7.629 MB
W20240131 14:47:46.590276 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000e0420000 7.629 MB
W20240131 14:47:46.590314 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000e0bc3000 7.629 MB
W20240131 14:47:46.590354 16115 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000e1366000 7.629 MB
W20240131 14:47:46.590410 16115 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000e1b09000 80 B 
W20240131 14:47:46.590443 16115 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000e1b0b000 8 B 
W20240131 14:47:46.590472 16115 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000e1b0d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:46.590842 16115 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.597404 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000e1b0f000 7.629 MB
W20240131 14:47:46.597502 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000e22b2000 7.629 MB
W20240131 14:47:46.597561 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000e2a55000 7.629 MB
W20240131 14:47:46.597604 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000e31f8000 7.629 MB
W20240131 14:47:46.597642 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000e399b000 7.629 MB
W20240131 14:47:46.597687 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e413e000 7.629 MB
W20240131 14:47:46.597730 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e48e1000 7.629 MB
W20240131 14:47:46.597785 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000e5084000 7.629 MB
W20240131 14:47:46.597827 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000e5827000 7.629 MB
W20240131 14:47:46.597865 16119 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000e5fca000 7.629 MB
W20240131 14:47:46.597904 16119 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000e676d000 80 B 
W20240131 14:47:46.597942 16119 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000e676f000 8 B 
W20240131 14:47:46.597971 16119 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000e6771000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:46.598193 16119 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.607215 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000e6773000 7.629 MB
W20240131 14:47:46.607318 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000e6f16000 7.629 MB
W20240131 14:47:46.607373 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000e76b9000 7.629 MB
W20240131 14:47:46.607417 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000e7e5c000 7.629 MB
W20240131 14:47:46.607457 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e85ff000 7.629 MB
W20240131 14:47:46.607497 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e8da2000 7.629 MB
W20240131 14:47:46.607537 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e9545000 7.629 MB
W20240131 14:47:46.607586 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000e9ce8000 7.629 MB
W20240131 14:47:46.607625 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000ea48b000 7.629 MB
W20240131 14:47:46.607672 16117 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000eac2e000 7.629 MB
W20240131 14:47:46.607712 16117 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000eb3d1000 80 B 
W20240131 14:47:46.607743 16117 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000eb3d3000 8 B 
W20240131 14:47:46.607771 16117 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000eb3d5000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:46.607982 16117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.696758 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000eb3d7000 7.629 MB
W20240131 14:47:46.697124 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000ebb7a000 7.629 MB
W20240131 14:47:46.697317 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000ec31d000 7.629 MB
W20240131 14:47:46.697481 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000ecac0000 7.629 MB
W20240131 14:47:46.697631 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000ed263000 7.629 MB
W20240131 14:47:46.697763 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000eda06000 7.629 MB
W20240131 14:47:46.697911 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000ee1a9000 7.629 MB
W20240131 14:47:46.698076 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000ee94c000 7.629 MB
W20240131 14:47:46.698240 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000ef0ef000 7.629 MB
W20240131 14:47:46.698386 16116 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000ef892000 7.629 MB
W20240131 14:47:46.698519 16116 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f0035000 80 B 
W20240131 14:47:46.698642 16116 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f0037000 8 B 
W20240131 14:47:46.698748 16116 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f0039000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 14:47:46.699504 16116 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 14:47:46.703326 15744 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 14:47:46.703653 15744 grad_base.h:184] Init GradProcessingBase done
I20240131 14:47:47.822682 15744 grad_async_v2.h:42] Use main thread to update emb.
W20240131 14:47:47.823000 15744 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 14:47:47.823012 15744 kg_controller.h:84] Construct KGCacheController done
E20240131 14:47:48.594095 15744 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 14:47:48.594491 16119 recstore.cc:66] init folly done
E20240131 14:47:48.594488 16117 recstore.cc:66] init folly done
E20240131 14:47:48.594522 16120 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 14:47:48.594594 16118 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 14:47:48.594947 16115 recstore.cc:66] init folly done
E20240131 14:47:48.594955 16114 recstore.cc:66] init folly done
E20240131 14:47:48.594969 16116 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 14:47:48.596079 15744 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 14:47:49.485240 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:47:49.485594 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:47:50.485033 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=278
W20240131 14:47:50.676755 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:47:51.485023 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:47:51.850983 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:47:52.485186 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:47:53.115715 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:47:53.485113 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 175.756 us                | 328.234 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:47:54.315407 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:47:54.485033 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:47:55.323195 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:47:55.500113 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:47:56.446478 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:47:56.500063 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 14:47:57.447324 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:47:57.500028 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:47:58.500046 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:47:58.591066 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 179.031 us                | 363.604 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:47:59.500394 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:47:59.708557 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:48:00.500164 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:48:00.799777 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:48:01.500087 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=117
W20240131 14:48:01.876545 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:48:02.500030 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:48:02.980497 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 170.659 us                | 336.433 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
Before Training
I20240131 14:48:04.141901 15744 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240131 14:48:04.141969 16119 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 14:48:04.142251 16114 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 14:48:04.142493 16117 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
I20240131 14:48:04.143335 16115 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 14:48:04.143386 16118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:48:04.143433 16116 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 14:48:04.143519 16120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
W20240131 14:48:04.164618 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:48:04.164861 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:48:05.164131 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=84
E20240131 14:48:06.701625 19415 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 282.734 us                | 282.734 us                |
| GenInput                  | 114.616 ms                | 114.616 ms                |
| NN                        | 201.767 ms                | 201.767 ms                |
| Forward                   | 272.198 ms                | 272.198 ms                |
| Backward                  | 135.871 ms                | 135.871 ms                |
| Optimize                  | 5.272 ms                  | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 17.505 ms                 | 17.505 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:07.701051 19422 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 197.275 us                | 401.465 us                |
| ProcessBack:Shuffle       | 1.080 s                   | 1.080 s                   |
| ProcessBack:UpdateCache   | 913.470 ms                | 913.470 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:08.701121 17321 parallel_pq_v2.h:79] insert failed, size(hashtable)=5214
W20240131 14:48:08.881605 15744 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240131 14:48:09.851198 17290 parallel_pq_v2.h:79] insert failed, size(hashtable)=6878
W20240131 14:48:09.881003 15744 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
W20240131 14:48:10.017060 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [15744 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16118 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16115 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16119 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16120 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16114 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16117 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [16116 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
E20240131 14:48:10.850034 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=18371
W20240131 14:48:11.110859 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 14:48:11.307334 15744 grad_async_v2.h:257] pq is empty
========== Step 2 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 282.734 us                | 362.382 us                |
| GenInput                  | 130.949 ms                | 148.541 ms                |
| NN                        | 6.095 ms                  | 201.767 ms                |
| Forward                   | 7.948 ms                  | 272.198 ms                |
| Backward                  | 15.380 ms                 | 135.871 ms                |
| Optimize                  | 598.431 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 17.505 ms                 |
| AfterBackward             | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 320.227 us                | 1.108 s                   |
| OneStep                   | 1.317 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:11.850066 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=4569
W20240131 14:48:12.142436 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:48:12.543689 15744 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
E20240131 14:48:12.850013 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2514
W20240131 14:48:13.265560 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 200.484 us                | 48.017 ms                 |
| ProcessBack:Shuffle       | 1.080 s                   | 1.140 s                   |
| ProcessBack:UpdateCache   | 5.008 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 110.073 us                | 2.182 s                   |
| ProcessOneStep            | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 135.636 us                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:13.823180 15744 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
E20240131 14:48:13.850055 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=82
W20240131 14:48:14.381358 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:48:14.850059 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2218
W20240131 14:48:15.044394 15744 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
W20240131 14:48:15.383633 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:48:15.850090 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=5524
W20240131 14:48:16.374545 15744 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 14:48:16.412612 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 255.178 us                | 362.382 us                |
| GenInput                  | 117.983 ms                | 148.541 ms                |
| NN                        | 1.770 ms                  | 201.767 ms                |
| Forward                   | 2.476 ms                  | 272.198 ms                |
| Backward                  | 26.200 ms                 | 135.871 ms                |
| Optimize                  | 582.933 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.640 ms                  | 17.505 ms                 |
| AfterBackward             | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 195.243 us                | 1.108 s                   |
| OneStep                   | 1.279 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:16.850075 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2562
W20240131 14:48:17.475620 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 14:48:17.809631 15744 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
E20240131 14:48:17.852739 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:48:18.529253 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 241.295 us                | 52.528 ms                 |
| ProcessBack:Shuffle       | 1.114 s                   | 1.284 s                   |
| ProcessBack:UpdateCache   | 4.093 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 84.533 us                 | 2.182 s                   |
| ProcessOneStep            | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 89.058 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:18.852113 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=7422
W20240131 14:48:19.039592 15744 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
W20240131 14:48:19.633488 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:48:19.852063 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=6253
W20240131 14:48:20.286994 15744 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
W20240131 14:48:20.681131 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:48:20.852411 17301 parallel_pq_v2.h:79] insert failed, size(hashtable)=3000
W20240131 14:48:21.594240 15744 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.774 us                | 362.382 us                |
| GenInput                  | 128.325 ms                | 148.541 ms                |
| NN                        | 1.610 ms                  | 201.767 ms                |
| Forward                   | 2.172 ms                  | 272.198 ms                |
| Backward                  | 24.552 ms                 | 135.871 ms                |
| Optimize                  | 364.542 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 17.505 ms                 |
| AfterBackward             | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 184.749 us                | 1.108 s                   |
| OneStep                   | 1.279 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:21.808797 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:48:21.852025 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=492
W20240131 14:48:22.894726 15744 grad_async_v2.h:257] pq is empty
W20240131 14:48:22.936161 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:48:22.936281 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 11 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 289.217 us                | 62.559 ms                 |
| ProcessBack:Shuffle       | 1.093 s                   | 1.284 s                   |
| ProcessBack:UpdateCache   | 3.236 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 89.058 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:23.936137 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2629
W20240131 14:48:23.993081 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 14:48:24.214818 15744 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
E20240131 14:48:24.936374 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=177
W20240131 14:48:25.013747 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:48:25.734194 15744 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
E20240131 14:48:25.936151 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=130
W20240131 14:48:26.069437 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.774 us                | 362.382 us                |
| GenInput                  | 117.983 ms                | 152.178 ms                |
| NN                        | 1.617 ms                  | 201.767 ms                |
| Forward                   | 2.291 ms                  | 272.198 ms                |
| Backward                  | 24.552 ms                 | 135.871 ms                |
| Optimize                  | 372.171 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.370 ms                  | 17.505 ms                 |
| AfterBackward             | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 195.243 us                | 1.108 s                   |
| OneStep                   | 1.307 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:26.995622 15744 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
E20240131 14:48:27.024696 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:48:27.173846 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:48:28.024315 17318 parallel_pq_v2.h:79] insert failed, size(hashtable)=1152
W20240131 14:48:28.247648 15744 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
W20240131 14:48:28.280213 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 20.018 ms                 | 69.534 ms                 |
| ProcessBack:Shuffle       | 1.093 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.236 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 88.737 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:29.024458 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1974
W20240131 14:48:29.287869 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:48:29.534523 15744 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
E20240131 14:48:30.024188 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=366
W20240131 14:48:30.370102 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 14:48:30.767163 15744 grad_async_v2.h:257] pq is empty
========== Step 17 ========== 
E20240131 14:48:31.024112 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 14:48:31.408116 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 217.899 us                | 362.382 us                |
| GenInput                  | 130.922 ms                | 170.042 ms                |
| NN                        | 1.458 ms                  | 201.767 ms                |
| Forward                   | 2.110 ms                  | 272.198 ms                |
| Backward                  | 20.904 ms                 | 135.871 ms                |
| Optimize                  | 372.171 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.570 ms                  | 17.505 ms                 |
| AfterBackward             | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 195.243 us                | 1.108 s                   |
| OneStep                   | 1.287 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:32.024494 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1742
W20240131 14:48:32.203748 15744 grad_async_v2.h:257] pq is empty
========== Step 18 ========== 
W20240131 14:48:32.515069 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:48:33.028240 17323 parallel_pq_v2.h:79] insert failed, size(hashtable)=3444
W20240131 14:48:33.501210 15744 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
W20240131 14:48:33.534351 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.004 ms                 | 69.534 ms                 |
| ProcessBack:Shuffle       | 1.114 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.195 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 91.999 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:34.028090 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1853
W20240131 14:48:34.573743 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 14:48:34.810300 15744 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
E20240131 14:48:35.028239 17319 parallel_pq_v2.h:79] insert failed, size(hashtable)=1135
W20240131 14:48:35.707746 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:48:36.040454 17306 parallel_pq_v2.h:79] insert failed, size(hashtable)=3113
W20240131 14:48:36.122673 15744 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.346 us                | 362.382 us                |
| GenInput                  | 132.828 ms                | 170.042 ms                |
| NN                        | 1.441 ms                  | 201.767 ms                |
| Forward                   | 2.110 ms                  | 272.198 ms                |
| Backward                  | 19.621 ms                 | 135.871 ms                |
| Optimize                  | 370.026 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 17.505 ms                 |
| AfterBackward             | 1.120 s                   | 4.189 s                   |
| BlockToStepN              | 199.317 us                | 1.108 s                   |
| OneStep                   | 1.300 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:36.819834 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:48:37.040191 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=958
W20240131 14:48:37.341495 15744 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
W20240131 14:48:37.850404 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:48:38.040267 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.176 ms                 | 61.517 ms                 |
| ProcessBack:Shuffle       | 1.114 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.189 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.118 s                   | 4.189 s                   |
| BlockToStepN              | 89.058 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:38.781798 15744 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
E20240131 14:48:39.040120 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=977
W20240131 14:48:39.043169 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:48:40.040158 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1024
W20240131 14:48:40.230098 15744 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
W20240131 14:48:40.254920 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:48:41.040128 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=47
W20240131 14:48:41.354265 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 14:48:41.603579 15744 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.578 us                | 362.382 us                |
| GenInput                  | 137.070 ms                | 170.042 ms                |
| NN                        | 1.458 ms                  | 201.767 ms                |
| Forward                   | 2.110 ms                  | 272.198 ms                |
| Backward                  | 15.380 ms                 | 135.871 ms                |
| Optimize                  | 364.542 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.640 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 206.467 us                | 1.108 s                   |
| OneStep                   | 1.307 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:42.040107 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=75
W20240131 14:48:42.435308 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:48:42.808625 15744 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
E20240131 14:48:43.040117 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1282
W20240131 14:48:43.493947 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.226 ms                 | 61.517 ms                 |
| ProcessBack:Shuffle       | 1.114 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 83.159 us                 | 2.182 s                   |
| ProcessOneStep            | 1.120 s                   | 4.189 s                   |
| BlockToStepN              | 98.364 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:44.060302 17320 parallel_pq_v2.h:79] insert failed, size(hashtable)=830
W20240131 14:48:44.152019 15744 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
W20240131 14:48:44.618670 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:48:45.060065 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=610
W20240131 14:48:45.411664 15744 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
W20240131 14:48:45.641544 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:48:46.060896 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.346 us                | 362.382 us                |
| GenInput                  | 140.147 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 15.380 ms                 | 135.871 ms                |
| Optimize                  | 370.026 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.644 ms                  | 17.505 ms                 |
| AfterBackward             | 1.120 s                   | 4.189 s                   |
| BlockToStepN              | 202.030 us                | 1.108 s                   |
| OneStep                   | 1.300 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:46.754421 15744 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
W20240131 14:48:46.780057 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:48:47.060693 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=825
W20240131 14:48:47.997996 15744 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
W20240131 14:48:48.021440 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:48:48.060075 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.199 ms                 | 59.939 ms                 |
| ProcessBack:Shuffle       | 1.114 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.120 s                   | 4.189 s                   |
| BlockToStepN              | 99.068 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:48:49.060693 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=949
W20240131 14:48:49.348282 15744 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
W20240131 14:48:49.388674 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:48:50.060180 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=122
W20240131 14:48:50.419442 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 14:48:50.671947 15744 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
E20240131 14:48:51.060609 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=302
W20240131 14:48:51.545672 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.578 us                | 362.382 us                |
| GenInput                  | 142.320 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 15.380 ms                 | 135.871 ms                |
| Optimize                  | 364.542 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 202.030 us                | 1.108 s                   |
| OneStep                   | 1.307 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:52.059525 15744 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
E20240131 14:48:52.092577 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:48:52.661042 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:48:53.092242 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=327
W20240131 14:48:53.310819 15744 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.346 ms                 | 59.704 ms                 |
| ProcessBack:Shuffle       | 1.117 s                   | 1.361 s                   |
| ProcessBack:UpdateCache   | 3.120 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 99.380 us                 | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:53.662189 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 14:48:54.092011 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=351
W20240131 14:48:54.651944 15744 grad_async_v2.h:257] pq is empty
W20240131 14:48:54.668681 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 35 ========== 
E20240131 14:48:55.092192 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
W20240131 14:48:55.712705 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:48:56.092468 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=179
W20240131 14:48:56.262822 15744 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.578 us                | 362.382 us                |
| GenInput                  | 142.320 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 13.010 ms                 | 135.871 ms                |
| Optimize                  | 369.310 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.570 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 206.467 us                | 1.108 s                   |
| OneStep                   | 1.309 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:56.744577 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 14:48:56.821569 15744 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
E20240131 14:48:57.092147 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1042
========== Step 38 ========== 
W20240131 14:48:57.815161 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240131 14:48:58.092039 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=939
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.063 ms                 | 63.614 ms                 |
| ProcessBack:Shuffle       | 1.117 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.446 us                 | 2.182 s                   |
| ProcessOneStep            | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 100.694 us                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:48:59.067997 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 14:48:59.092039 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=191
W20240131 14:48:59.970921 15744 grad_async_v2.h:257] pq is empty
========== Step 39 ========== 
E20240131 14:49:00.092587 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:49:00.223779 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:49:01.092128 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=190
W20240131 14:49:01.402909 15744 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
W20240131 14:49:01.436717 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 218.578 us                | 564.580 us                |
| GenInput                  | 142.098 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 13.010 ms                 | 135.871 ms                |
| Optimize                  | 370.026 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.617 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 214.047 us                | 1.108 s                   |
| OneStep                   | 1.309 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:02.092350 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=125
W20240131 14:49:02.752198 15744 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
W20240131 14:49:02.813236 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:49:03.092839 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.000 ms                 | 64.786 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 2.207 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.835 us                 | 2.182 s                   |
| ProcessOneStep            | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 102.966 us                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:04.023110 15744 grad_async_v2.h:257] pq is empty
========== Step 42 ========== 
W20240131 14:49:04.080056 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:04.092046 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=68
E20240131 14:49:05.095100 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
W20240131 14:49:05.349973 15744 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
W20240131 14:49:05.360566 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:49:06.095063 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=567
W20240131 14:49:06.591208 15744 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
W20240131 14:49:06.615998 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.682 us                | 564.580 us                |
| GenInput                  | 140.147 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 12.370 ms                 | 135.871 ms                |
| Optimize                  | 369.310 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.626 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 220.262 us                | 1.108 s                   |
| OneStep                   | 1.309 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:07.095094 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=744
W20240131 14:49:07.631970 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 14:49:07.865496 15744 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
E20240131 14:49:08.095142 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.067 ms                 | 66.973 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 2.207 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.446 us                 | 2.182 s                   |
| ProcessOneStep            | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 105.914 us                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:08.742769 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:49:09.137185 15744 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
E20240131 14:49:09.169080 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:49:09.806968 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:49:10.169224 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=406
W20240131 14:49:10.457628 15744 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
W20240131 14:49:10.851876 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:49:11.169471 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.293 us                | 564.580 us                |
| GenInput                  | 138.782 ms                | 170.042 ms                |
| NN                        | 1.465 ms                  | 201.767 ms                |
| Forward                   | 2.144 ms                  | 272.198 ms                |
| Backward                  | 12.367 ms                 | 135.871 ms                |
| Optimize                  | 364.542 us                | 5.272 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 17.505 ms                 |
| AfterBackward             | 1.141 s                   | 4.189 s                   |
| BlockToStepN              | 230.877 us                | 1.108 s                   |
| OneStep                   | 1.309 s                   | 5.846 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:11.756842 15744 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
W20240131 14:49:11.975910 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:49:12.169104 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=123
W20240131 14:49:13.100118 15744 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
W20240131 14:49:13.158783 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:49:13.175194 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 28.019 ms                 | 64.063 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 2.207 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 913.470 ms                |
| ProcessBack:UpsertPq      | 82.446 us                 | 2.182 s                   |
| ProcessOneStep            | 1.146 s                   | 4.189 s                   |
| BlockToStepN              | 106.729 us                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:14.175181 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=54
W20240131 14:49:14.247860 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 14:49:14.507552 15744 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
E20240131 14:49:15.175266 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=225
W20240131 14:49:15.270992 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 14:49:15.974949 15744 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
E20240131 14:49:16.175132 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=199
W20240131 14:49:16.328667 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.293 us                | 385.734 us                |
| GenInput                  | 138.782 ms                | 168.037 ms                |
| NN                        | 1.480 ms                  | 11.369 ms                 |
| Forward                   | 2.172 ms                  | 26.201 ms                 |
| Backward                  | 12.370 ms                 | 31.093 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.626 ms                  | 10.305 ms                 |
| AfterBackward             | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 232.245 us                | 458.051 us                |
| OneStep                   | 1.312 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:17.175046 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=300
W20240131 14:49:17.277523 15744 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
W20240131 14:49:17.473487 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:18.175127 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=240
W20240131 14:49:18.555684 15744 grad_async_v2.h:257] pq is empty
W20240131 14:49:18.572491 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 53 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.832 ms                 | 64.605 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 13.364 ms                 |
| ProcessBack:UpsertPq      | 81.885 us                 | 119.188 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 111.035 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:19.176474 17299 parallel_pq_v2.h:79] insert failed, size(hashtable)=434
W20240131 14:49:19.609448 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 14:49:19.854341 15744 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
E20240131 14:49:20.176057 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
W20240131 14:49:20.645685 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 14:49:21.187510 15744 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
E20240131 14:49:21.221581 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:49:21.667680 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.293 us                | 385.734 us                |
| GenInput                  | 137.070 ms                | 168.037 ms                |
| NN                        | 1.566 ms                  | 11.369 ms                 |
| Forward                   | 2.228 ms                  | 26.201 ms                 |
| Backward                  | 13.010 ms                 | 52.146 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 10.305 ms                 |
| AfterBackward             | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 241.721 us                | 458.051 us                |
| OneStep                   | 1.309 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:22.221139 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=634
W20240131 14:49:22.488381 15744 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
W20240131 14:49:22.769714 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:49:23.221058 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.870 ms                 | 63.377 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 13.364 ms                 |
| ProcessBack:UpsertPq      | 81.885 us                 | 135.500 us                |
| ProcessOneStep            | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 114.754 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:23.798605 15744 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
W20240131 14:49:23.847853 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:49:24.221536 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=117
W20240131 14:49:24.897572 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:49:25.137629 15744 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
E20240131 14:49:25.221025 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=130
W20240131 14:49:25.949694 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:49:26.221101 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=278
W20240131 14:49:26.493248 15744 grad_async_v2.h:257] pq is empty
========== Step 59 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 219.524 us                | 385.734 us                |
| GenInput                  | 136.168 ms                | 168.037 ms                |
| NN                        | 1.551 ms                  | 11.369 ms                 |
| Forward                   | 2.172 ms                  | 26.201 ms                 |
| Backward                  | 15.354 ms                 | 52.146 ms                 |
| Optimize                  | 364.542 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 10.305 ms                 |
| AfterBackward             | 1.149 s                   | 2.214 s                   |
| BlockToStepN              | 243.839 us                | 458.051 us                |
| OneStep                   | 1.310 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:27.076402 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:49:27.221132 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=438
W20240131 14:49:27.730679 15744 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
W20240131 14:49:28.120632 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:49:28.221457 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.875 ms                 | 63.377 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 13.364 ms                 |
| ProcessBack:UpsertPq      | 81.885 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 119.049 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:29.022287 15744 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
E20240131 14:49:29.221076 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=268
W20240131 14:49:29.221652 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 14:49:30.297047 15744 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
W20240131 14:49:30.340061 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:30.340698 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 14:49:31.340037 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=58
W20240131 14:49:31.440135 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 14:49:31.701460 15744 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.174 us                | 475.126 us                |
| GenInput                  | 136.168 ms                | 168.037 ms                |
| NN                        | 1.566 ms                  | 11.369 ms                 |
| Forward                   | 2.228 ms                  | 26.201 ms                 |
| Backward                  | 16.158 ms                 | 52.146 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.640 ms                  | 10.305 ms                 |
| AfterBackward             | 1.149 s                   | 2.214 s                   |
| BlockToStepN              | 250.737 us                | 458.051 us                |
| OneStep                   | 1.309 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:32.340010 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=93
W20240131 14:49:32.545719 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 14:49:32.927143 15744 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
E20240131 14:49:33.340205 17295 parallel_pq_v2.h:79] insert failed, size(hashtable)=392
W20240131 14:49:33.607411 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 16.051 ms                 | 55.709 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 13.364 ms                 |
| ProcessBack:UpsertPq      | 81.978 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 121.586 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:34.415527 15744 grad_async_v2.h:257] pq is empty
E20240131 14:49:34.432564 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 65 ========== 
W20240131 14:49:34.634582 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:49:35.432138 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
W20240131 14:49:35.706442 15744 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
W20240131 14:49:35.723984 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:49:36.432399 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.682 us                | 475.126 us                |
| GenInput                  | 136.168 ms                | 168.037 ms                |
| NN                        | 1.608 ms                  | 11.369 ms                 |
| Forward                   | 2.291 ms                  | 26.201 ms                 |
| Backward                  | 15.380 ms                 | 52.146 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 10.305 ms                 |
| AfterBackward             | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 243.839 us                | 458.051 us                |
| OneStep                   | 1.307 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:36.732829 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 14:49:36.986786 15744 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
E20240131 14:49:37.432179 17321 parallel_pq_v2.h:79] insert failed, size(hashtable)=371
W20240131 14:49:37.744442 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:49:38.367030 15744 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
E20240131 14:49:38.432004 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 25.642 ms                 | 55.709 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.160 ms                  | 13.364 ms                 |
| ProcessBack:UpsertPq      | 81.978 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 122.983 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:38.843966 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:49:39.432179 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
W20240131 14:49:39.635673 15744 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
W20240131 14:49:39.953274 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:49:40.432070 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=177
W20240131 14:49:40.910957 15744 grad_async_v2.h:257] pq is empty
========== Step 70 ========== 
W20240131 14:49:41.122959 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:49:41.432111 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.682 us                | 475.126 us                |
| GenInput                  | 136.148 ms                | 168.037 ms                |
| NN                        | 1.608 ms                  | 11.369 ms                 |
| Forward                   | 2.291 ms                  | 26.201 ms                 |
| Backward                  | 16.263 ms                 | 52.146 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.632 ms                  | 17.505 ms                 |
| AfterBackward             | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 250.737 us                | 458.051 us                |
| OneStep                   | 1.303 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 71 ========== 
W20240131 14:49:42.301187 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:49:42.432034 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=223
W20240131 14:49:43.332015 15744 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
W20240131 14:49:43.364060 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:43.432519 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.660 ms                 | 59.764 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.147 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 82.835 us                 | 135.500 us                |
| ProcessOneStep            | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 124.358 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 14:49:44.432425 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=175
W20240131 14:49:44.571746 15744 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
W20240131 14:49:44.632058 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:49:45.432014 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=132
W20240131 14:49:45.668278 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 14:49:45.910269 15744 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
E20240131 14:49:46.432222 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=49
W20240131 14:49:46.689735 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 222.286 us                | 475.126 us                |
| GenInput                  | 134.985 ms                | 168.037 ms                |
| NN                        | 1.608 ms                  | 11.369 ms                 |
| Forward                   | 2.309 ms                  | 26.201 ms                 |
| Backward                  | 16.263 ms                 | 52.146 ms                 |
| Optimize                  | 367.880 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.632 ms                  | 17.505 ms                 |
| AfterBackward             | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 252.287 us                | 458.051 us                |
| OneStep                   | 1.303 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:47.215287 15744 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
E20240131 14:49:47.432242 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=167
W20240131 14:49:47.724584 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 14:49:48.496501 15744 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
E20240131 14:49:48.561493 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.676 ms                 | 60.005 ms                 |
| ProcessBack:Shuffle       | 1.137 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 83.159 us                 | 135.500 us                |
| ProcessOneStep            | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 126.842 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:48.793503 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:49:49.561014 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:49:49.855348 15744 grad_async_v2.h:257] pq is empty
W20240131 14:49:49.872568 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 77 ========== 
E20240131 14:49:50.561154 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=59
W20240131 14:49:50.890329 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 14:49:51.140640 15744 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
E20240131 14:49:51.561142 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 224.501 us                | 475.126 us                |
| GenInput                  | 134.985 ms                | 170.042 ms                |
| NN                        | 1.601 ms                  | 11.369 ms                 |
| Forward                   | 2.291 ms                  | 26.201 ms                 |
| Backward                  | 16.158 ms                 | 52.146 ms                 |
| Optimize                  | 364.542 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.632 ms                  | 17.505 ms                 |
| AfterBackward             | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 254.143 us                | 458.051 us                |
| OneStep                   | 1.303 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:51.986785 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 14:49:52.538697 15744 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
E20240131 14:49:52.584906 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 14:49:53.039917 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:49:53.584473 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.772 ms                 | 62.535 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.123 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 84.533 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 130.419 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:53.923135 15744 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
W20240131 14:49:54.134323 17289 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 14:49:54.584417 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
W20240131 14:49:55.146409 15744 grad_async_v2.h:257] pq is empty
========== Step 81 ========== 
W20240131 14:49:55.166985 17289 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 14:49:55.584139 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=39
W20240131 14:49:56.384865 15744 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
W20240131 14:49:56.440061 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:56.584233 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 224.501 us                | 475.126 us                |
| GenInput                  | 134.985 ms                | 170.042 ms                |
| NN                        | 1.601 ms                  | 11.369 ms                 |
| Forward                   | 2.291 ms                  | 26.201 ms                 |
| Backward                  | 16.263 ms                 | 52.146 ms                 |
| Optimize                  | 364.542 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.632 ms                  | 22.600 ms                 |
| AfterBackward             | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 258.023 us                | 458.051 us                |
| OneStep                   | 1.303 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:57.529511 17289 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 14:49:57.584326 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
W20240131 14:49:57.767951 15744 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
W20240131 14:49:58.529152 17289 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 14:49:58.584246 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.841 ms                 | 64.017 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.120 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 83.159 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 131.767 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:49:59.077589 15744 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
E20240131 14:49:59.584043 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=59
W20240131 14:49:59.652055 17289 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 14:50:00.420686 15744 grad_async_v2.h:257] pq is empty
========== Step 85 ========== 
E20240131 14:50:00.584092 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=466
W20240131 14:50:00.809062 17289 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 14:50:01.584455 17316 parallel_pq_v2.h:79] insert failed, size(hashtable)=202
W20240131 14:50:01.723145 15744 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 224.501 us                | 484.048 us                |
| GenInput                  | 134.985 ms                | 170.042 ms                |
| NN                        | 1.601 ms                  | 11.369 ms                 |
| Forward                   | 2.291 ms                  | 26.201 ms                 |
| Backward                  | 15.485 ms                 | 52.146 ms                 |
| Optimize                  | 362.396 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.632 ms                  | 22.600 ms                 |
| AfterBackward             | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 263.618 us                | 568.683 us                |
| OneStep                   | 1.305 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:50:01.966112 17289 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 14:50:02.584034 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 14:50:03.150777 15744 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
W20240131 14:50:03.188069 17289 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 14:50:03.584748 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.848 ms                 | 64.017 ms                 |
| ProcessBack:Shuffle       | 1.144 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.147 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 83.159 us                 | 135.500 us                |
| ProcessOneStep            | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 133.716 us                | 327.598 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 14:50:04.429544 15744 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
W20240131 14:50:04.476675 17289 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 14:50:04.584033 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
E20240131 14:50:05.584028 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=198
W20240131 14:50:05.722158 15744 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
W20240131 14:50:05.771170 17289 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 14:50:06.584043 17289 parallel_pq_v2.h:79] insert failed, size(hashtable)=84
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 222.286 us                | 484.048 us                |
| GenInput                  | 135.804 ms                | 170.042 ms                |
| NN                        | 1.601 ms                  | 11.369 ms                 |
| Forward                   | 2.309 ms                  | 26.201 ms                 |
| Backward                  | 15.380 ms                 | 52.146 ms                 |
| Optimize                  | 361.919 us                | 2.344 ms                  |
| BarrierTimeBeforeRank0    | 1.631 ms                  | 22.600 ms                 |
| AfterBackward             | 1.148 s                   | 2.214 s                   |
| BlockToStepN              | 264.878 us                | 614.295 us                |
| OneStep                   | 1.305 s                   | 2.392 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 14:50:07.010965 15744 grad_async_v2.h:257] pq is empty
Successfully xmh
W20240131 14:50:07.011437 15744 grad_async_v2.h:84] call StopThreads. PID = 15744
W20240131 14:50:07.011454 15744 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 14:50:07.011492 15744 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 14:50:07.011500 15744 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240131 14:50:07.080312 15744 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 27.811 ms                 | 64.228 ms                 |
| ProcessBack:Shuffle       | 1.140 s                   | 1.441 s                   |
| ProcessBack:UpdateCache   | 3.147 ms                  | 19.786 ms                 |
| ProcessBack:UpsertPq      | 83.159 us                 | 135.500 us                |
| ProcessOneStep            | 1.146 s                   | 2.214 s                   |
| BlockToStepN              | 133.817 us                | 392.850 us                |
+---------------------------+---------------------------+---------------------------+
