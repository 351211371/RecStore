WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 16:35:10.161901 51935 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 16:35:10.171226 51935 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [51935 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fec4e4b19e0>==========
Worker 1 pid=52085
Worker 2 pid=52086
Worker 3 pid=52087
Worker 4 pid=52088
Worker 5 pid=52089
Worker 6 pid=52090
INFO [51935 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [52085 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52086 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52087 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52088 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52089 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52091 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [52090 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52089 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52091 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52090 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 16:35:28.322890 52089 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.322950 52091 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.322952 52090 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [51935 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52087 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52085 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52086 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52088 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240131 16:35:28.329735 51935 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.329849 52087 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.329921 52085 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.329931 52086 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 16:35:28.329933 52088 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 16:35:47.081283 52091 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1688128, 32]; dev=7; size=206.1 MB
W20240131 16:35:47.085494 51935 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240131 16:35:47.085722 52089 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1688128, 32]; dev=5; size=206.1 MB
W20240131 16:35:47.086145 52088 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1688128, 32]; dev=4; size=206.1 MB
W20240131 16:35:47.086145 52090 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1688128, 32]; dev=6; size=206.1 MB
W20240131 16:35:47.086141 52086 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240131 16:35:47.086741 52087 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240131 16:35:47.086753 52085 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240131 16:35:47.822377 52086 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10010196e000 7.629 MB
W20240131 16:35:47.822544 52086 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100102111000 7.629 MB
W20240131 16:35:47.822638 52086 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1001028b4000 122.1 MB
W20240131 16:35:47.822693 52086 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10010a2c8000 122.1 MB
W20240131 16:35:47.822746 52086 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:35:47.825883 52086 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 16:35:47.861531 52087 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100111ce2000 7.629 MB
W20240131 16:35:47.861759 52087 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100112485000 7.629 MB
W20240131 16:35:47.861832 52087 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100112c28000 122.1 MB
W20240131 16:35:47.861903 52087 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10011a63c000 122.1 MB
W20240131 16:35:47.861959 52087 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:35:47.867287 52087 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 16:35:47.867452 52088 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100122054000 7.629 MB
W20240131 16:35:47.867633 52088 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1001227f7000 7.629 MB
W20240131 16:35:47.867722 52088 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x100122f9a000 122.1 MB
W20240131 16:35:47.867986 52088 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x10012a9ae000 122.1 MB
W20240131 16:35:47.868058 52088 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 16:35:47.869767 51935 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1001323c6000 7.629 MB
W20240131 16:35:47.870083 51935 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100132b69000 7.629 MB
W20240131 16:35:47.870180 51935 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10013330c000 122.1 MB
W20240131 16:35:47.870260 51935 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10013ad20000 122.1 MB
W20240131 16:35:47.870294 51935 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 16:35:47.871861 52088 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240131 16:35:47.872437 51935 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 16:35:47.874850 52091 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10014273e000 7.629 MB
W20240131 16:35:47.874989 52091 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100142ee1000 7.629 MB
W20240131 16:35:47.875056 52091 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x100143684000 122.1 MB
W20240131 16:35:47.875109 52091 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10014b098000 122.1 MB
W20240131 16:35:47.875167 52091 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 16:35:47.876499 52091 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240131 16:35:47.883345 52085 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100152ab2000 7.629 MB
W20240131 16:35:47.883505 52085 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100153255000 7.629 MB
W20240131 16:35:47.883567 52085 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001539f8000 122.1 MB
W20240131 16:35:47.883615 52085 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10015b40c000 122.1 MB
W20240131 16:35:47.883673 52085 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:35:47.884296 52085 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 16:35:47.903028 52090 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100162e26000 7.629 MB
W20240131 16:35:47.903232 52090 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1001635c9000 7.629 MB
W20240131 16:35:47.903306 52090 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100163d6c000 122.1 MB
W20240131 16:35:47.903369 52090 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x10016b780000 122.1 MB
W20240131 16:35:47.903422 52090 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 16:35:47.905692 52090 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240131 16:35:47.925745 52089 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10017319a000 7.629 MB
W20240131 16:35:47.925895 52089 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10017393d000 7.629 MB
W20240131 16:35:47.925967 52089 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1001740e0000 122.1 MB
W20240131 16:35:47.926048 52089 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x10017baf4000 122.1 MB
W20240131 16:35:47.926103 52089 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240131 16:35:47.926434 52089 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
Worker 7 pid=52091
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512), (6752512, 8440640), (8440640, 10128768), (10128768, 11816896), (11816896, 13505024)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240131 16:35:55.197789 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10018350c000 7.629 MB
W20240131 16:35:55.198046 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100183caf000 7.629 MB
W20240131 16:35:55.198086 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100184452000 7.629 MB
W20240131 16:35:55.198135 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100184bf5000 7.629 MB
W20240131 16:35:55.198179 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100185398000 7.629 MB
W20240131 16:35:55.198218 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100185b3b000 7.629 MB
W20240131 16:35:55.198269 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1001862de000 7.629 MB
W20240131 16:35:55.198324 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100186a81000 7.629 MB
W20240131 16:35:55.198372 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100187224000 7.629 MB
W20240131 16:35:55.198436 51935 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001879c7000 7.629 MB
W20240131 16:35:55.198477 51935 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10018816a000 80 B 
W20240131 16:35:55.198518 51935 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10018816c000 8 B 
W20240131 16:35:55.198555 51935 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10018816e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:55.199050 51935 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240131 16:35:55.426882 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x100188170000 7.629 MB
W20240131 16:35:55.427186 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100188913000 7.629 MB
W20240131 16:35:55.427242 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1001890b6000 7.629 MB
W20240131 16:35:55.427321 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100189859000 7.629 MB
W20240131 16:35:55.427372 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100189ffc000 7.629 MB
W20240131 16:35:55.427456 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10018a79f000 7.629 MB
W20240131 16:35:55.427525 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10018af42000 7.629 MB
W20240131 16:35:55.427603 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10018b6e5000 7.629 MB
W20240131 16:35:55.427677 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x10018be88000 7.629 MB
W20240131 16:35:55.427745 52091 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10018c62b000 7.629 MB
W20240131 16:35:55.427824 52091 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10018cdce000 80 B 
W20240131 16:35:55.427862 52091 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10018cdd0000 8 B 
W20240131 16:35:55.427922 52091 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10018cdd2000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:55.428439 52091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:55.718008 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10018cdd4000 7.629 MB
W20240131 16:35:55.718191 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10018d577000 7.629 MB
W20240131 16:35:55.718252 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10018dd1a000 7.629 MB
W20240131 16:35:55.718295 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10018e4bd000 7.629 MB
W20240131 16:35:55.718333 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x10018ec60000 7.629 MB
W20240131 16:35:55.718372 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10018f403000 7.629 MB
W20240131 16:35:55.718421 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10018fba6000 7.629 MB
W20240131 16:35:55.718479 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x100190349000 7.629 MB
W20240131 16:35:55.718519 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x100190aec000 7.629 MB
W20240131 16:35:55.718559 52089 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10019128f000 7.629 MB
W20240131 16:35:55.718602 52089 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x100191a32000 80 B 
W20240131 16:35:55.718637 52089 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100191a34000 8 B 
W20240131 16:35:55.718683 52089 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100191a36000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:55.719022 52089 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:56.268783 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100191a38000 7.629 MB
W20240131 16:35:56.268970 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1001921db000 7.629 MB
W20240131 16:35:56.269029 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10019297e000 7.629 MB
W20240131 16:35:56.269078 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100193121000 7.629 MB
W20240131 16:35:56.269119 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1001938c4000 7.629 MB
W20240131 16:35:56.269176 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100194067000 7.629 MB
W20240131 16:35:56.269227 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10019480a000 7.629 MB
W20240131 16:35:56.269289 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100194fad000 7.629 MB
W20240131 16:35:56.269332 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100195750000 7.629 MB
W20240131 16:35:56.269378 52085 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100195ef3000 7.629 MB
W20240131 16:35:56.269439 52085 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100196696000 80 B 
W20240131 16:35:56.269479 52085 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100196698000 8 B 
W20240131 16:35:56.269520 52085 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10019669a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:56.269868 52085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:56.814046 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10019669c000 7.629 MB
W20240131 16:35:56.814280 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100196e3f000 7.629 MB
W20240131 16:35:56.814327 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1001975e2000 7.629 MB
W20240131 16:35:56.814394 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100197d85000 7.629 MB
W20240131 16:35:56.814435 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100198528000 7.629 MB
W20240131 16:35:56.814476 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x100198ccb000 7.629 MB
W20240131 16:35:56.814515 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10019946e000 7.629 MB
W20240131 16:35:56.814571 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100199c11000 7.629 MB
W20240131 16:35:56.814613 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10019a3b4000 7.629 MB
W20240131 16:35:56.814653 52088 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10019ab57000 7.629 MB
W20240131 16:35:56.814697 52088 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x10019b2fa000 80 B 
W20240131 16:35:56.814730 52088 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10019b2fc000 8 B 
W20240131 16:35:56.814766 52088 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10019b2fe000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:56.815095 52088 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:57.239393 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10019b300000 7.629 MB
W20240131 16:35:57.239778 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10019baa3000 7.629 MB
W20240131 16:35:57.239934 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10019c246000 7.629 MB
W20240131 16:35:57.240157 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10019c9e9000 7.629 MB
W20240131 16:35:57.240295 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10019d18c000 7.629 MB
W20240131 16:35:57.240434 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10019d92f000 7.629 MB
W20240131 16:35:57.240572 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10019e0d2000 7.629 MB
W20240131 16:35:57.240741 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10019e875000 7.629 MB
W20240131 16:35:57.240877 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10019f018000 7.629 MB
W20240131 16:35:57.241010 52087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10019f7bb000 7.629 MB
W20240131 16:35:57.241187 52087 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10019ff5e000 80 B 
W20240131 16:35:57.241305 52087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10019ff60000 8 B 
W20240131 16:35:57.241426 52087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10019ff62000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:57.242100 52087 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:57.296598 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10019ff64000 7.629 MB
W20240131 16:35:57.296838 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1001a0707000 7.629 MB
W20240131 16:35:57.296888 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001a0eaa000 7.629 MB
W20240131 16:35:57.296938 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1001a164d000 7.629 MB
W20240131 16:35:57.296986 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001a1df0000 7.629 MB
W20240131 16:35:57.297030 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001a2593000 7.629 MB
W20240131 16:35:57.297077 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1001a2d36000 7.629 MB
W20240131 16:35:57.297132 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1001a34d9000 7.629 MB
W20240131 16:35:57.297174 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1001a3c7c000 7.629 MB
W20240131 16:35:57.297219 52086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1001a441f000 7.629 MB
W20240131 16:35:57.297271 52086 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1001a4bc2000 80 B 
W20240131 16:35:57.297308 52086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1001a4bc4000 8 B 
W20240131 16:35:57.297344 52086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1001a4bc6000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:57.297681 52086 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:57.517577 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1001a4bc8000 7.629 MB
W20240131 16:35:57.517912 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1001a536b000 7.629 MB
W20240131 16:35:57.518067 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1001a5b0e000 7.629 MB
W20240131 16:35:57.518265 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1001a62b1000 7.629 MB
W20240131 16:35:57.518399 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1001a6a54000 7.629 MB
W20240131 16:35:57.518541 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1001a71f7000 7.629 MB
W20240131 16:35:57.518679 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1001a799a000 7.629 MB
W20240131 16:35:57.518837 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1001a813d000 7.629 MB
W20240131 16:35:57.518977 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1001a88e0000 7.629 MB
W20240131 16:35:57.519120 52090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1001a9083000 7.629 MB
W20240131 16:35:57.519279 52090 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1001a9826000 80 B 
W20240131 16:35:57.519394 52090 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1001a9828000 8 B 
W20240131 16:35:57.519519 52090 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1001a982a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 16:35:57.520141 52090 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240131 16:35:57.524776 51935 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 16:35:57.525099 51935 grad_base.h:184] Init GradProcessingBase done
I20240131 16:36:01.443807 51935 grad_async_v2.h:42] Use main thread to update emb.
W20240131 16:36:01.444332 51935 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 16:36:01.444347 51935 kg_controller.h:84] Construct KGCacheController done
E20240131 16:36:03.200615 52089 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 16:36:03.200675 52090 recstore.cc:66] init folly done
E20240131 16:36:03.200662 52091 recstore.cc:66] init folly done
E20240131 16:36:03.200695 52087 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 16:36:03.200829 52088 recstore.cc:66] init folly done
E20240131 16:36:03.200877 52086 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 16:36:03.200950 51935 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 16:36:03.201387 52085 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
I20240131 16:36:03.202441 51935 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 16:36:04.427925 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:36:04.428437 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 16:36:05.428014 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240131 16:36:05.548353 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 16:36:06.428033 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:36:06.641680 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 16:36:07.428043 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:36:07.650213 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.783 us                | 270.624 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 16:36:08.428026 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:36:08.659277 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 16:36:09.428079 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:09.661015 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 16:36:10.428032 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240131 16:36:10.682287 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 16:36:11.428413 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:36:11.732411 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 160.420 us                | 474.686 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
Before Training
I20240131 16:36:13.290810 52088 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240131 16:36:13.290971 52091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:36:13.291030 52087 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
Before Training
I20240131 16:36:13.291802 52085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:36:13.291846 52086 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:36:13.291898 52089 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240131 16:36:13.291935 52090 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240131 16:36:13.295135 51935 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240131 16:36:13.298413 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 16:36:13.298666 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 0 ========== 
E20240131 16:36:15.139305 52948 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:36:15.643224 51935 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240131 16:36:16.057096 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
INFO [52088 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52090 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52091 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52087 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52086 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52085 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [52089 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [51935 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
E20240131 16:36:16.140118 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
W20240131 16:36:17.073498 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240131 16:36:17.141611 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4812
========== Step 5 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.988 us                | 937.910 us                |
| GenInput                  | 1.959 ms                  | 4.850 ms                  |
| NN                        | 1.465 ms                  | 171.787 ms                |
| Forward                   | 1.971 ms                  | 250.806 ms                |
| Backward                  | 3.460 ms                  | 195.908 ms                |
| Optimize                  | 424.147 us                | 11.446 ms                 |
| BarrierTimeBeforeRank0    | 1.227 ms                  | 28.475 ms                 |
| AfterBackward             | 280.077 ms                | 1.853 s                   |
| BlockToStepN              | 162.347 us                | 411.573 ms                |
| OneStep                   | 304.272 ms                | 2.758 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 6 ========== 
========== Step 7 ========== 
W20240131 16:36:18.061107 51935 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
E20240131 16:36:18.141011 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1400
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 271.175 us                | 32.084 ms                 |
| ProcessBack:Shuffle       | 253.394 ms                | 522.547 ms                |
| ProcessBack:UpdateCache   | 17.791 ms                 | 804.545 ms                |
| ProcessBack:UpsertPq      | 72.370 us                 | 503.767 ms                |
| ProcessOneStep            | 271.907 ms                | 1.853 s                   |
| BlockToStepN              | 67.589 us                 | 410.822 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 9 ========== 
W20240131 16:36:18.541229 51935 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
W20240131 16:36:18.643859 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
========== Step 11 ========== 
========== Step 12 ========== 
E20240131 16:36:19.141027 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=124
E20240131 16:36:19.340255 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=12, sample_step_cpp_seen_[rank]=11
========== Step 13 ========== 
E20240131 16:36:20.141180 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=132
W20240131 16:36:20.328223 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 16:36:21.141069 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:36:21.755041 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240131 16:36:22.141074 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.615 us                | 1.294 ms                  |
| GenInput                  | 1.097 ms                  | 9.601 ms                  |
| NN                        | 1.465 ms                  | 171.787 ms                |
| Forward                   | 1.971 ms                  | 250.806 ms                |
| Backward                  | 3.460 ms                  | 195.908 ms                |
| Optimize                  | 332.117 us                | 11.446 ms                 |
| BarrierTimeBeforeRank0    | 1.114 ms                  | 28.475 ms                 |
| AfterBackward             | 267.471 ms                | 1.853 s                   |
| BlockToStepN              | 162.347 us                | 411.573 ms                |
| OneStep                   | 279.870 ms                | 2.758 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:22.812976 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 14 ========== 
W20240131 16:36:23.090124 51935 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
E20240131 16:36:23.156065 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 186.787 us                | 20.112 ms                 |
| ProcessBack:Shuffle       | 245.624 ms                | 522.547 ms                |
| ProcessBack:UpdateCache   | 14.758 ms                 | 804.545 ms                |
| ProcessBack:UpsertPq      | 72.342 us                 | 503.767 ms                |
| ProcessOneStep            | 267.423 ms                | 3.240 s                   |
| BlockToStepN              | 88.287 us                 | 410.822 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
E20240131 16:36:24.156057 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=927
W20240131 16:36:24.158239 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
E20240131 16:36:25.156193 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:25.393692 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
E20240131 16:36:26.156291 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2760
E20240131 16:36:26.202229 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=25, sample_step_cpp_seen_[rank]=24
========== Step 26 ========== 
W20240131 16:36:27.131774 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240131 16:36:27.156160 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 196.704 us                | 1.294 ms                  |
| GenInput                  | 1.113 ms                  | 9.601 ms                  |
| NN                        | 1.465 ms                  | 171.787 ms                |
| Forward                   | 1.971 ms                  | 250.806 ms                |
| Backward                  | 3.857 ms                  | 195.908 ms                |
| Optimize                  | 364.065 us                | 11.446 ms                 |
| BarrierTimeBeforeRank0    | 1.058 ms                  | 28.475 ms                 |
| AfterBackward             | 273.909 ms                | 3.240 s                   |
| BlockToStepN              | 172.846 us                | 411.573 ms                |
| OneStep                   | 287.475 ms                | 3.259 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 16:36:28.156069 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 145.072 us                | 323.349 us                |
| ProcessBack:Shuffle       | 252.904 ms                | 522.547 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 804.545 ms                |
| ProcessBack:UpsertPq      | 72.370 us                 | 503.767 ms                |
| ProcessOneStep            | 273.869 ms                | 3.240 s                   |
| BlockToStepN              | 83.507 us                 | 410.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:28.591459 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240131 16:36:29.156528 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:29.596652 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 27 ========== 
========== Step 28 ========== 
E20240131 16:36:30.156425 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1614
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
W20240131 16:36:30.997911 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240131 16:36:31.156105 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=899
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
W20240131 16:36:32.100307 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
========== Step 36 ========== 
E20240131 16:36:32.159503 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 196.704 us                | 1.294 ms                  |
| GenInput                  | 1.040 ms                  | 9.601 ms                  |
| NN                        | 1.474 ms                  | 171.787 ms                |
| Forward                   | 2.191 ms                  | 250.806 ms                |
| Backward                  | 3.520 ms                  | 195.908 ms                |
| Optimize                  | 366.688 us                | 11.446 ms                 |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 28.475 ms                 |
| AfterBackward             | 271.947 ms                | 3.389 s                   |
| BlockToStepN              | 208.239 us                | 411.573 ms                |
| OneStep                   | 287.350 ms                | 3.395 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 38 ========== 
========== Step 39 ========== 
E20240131 16:36:33.164103 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.574 us                | 35.884 ms                 |
| ProcessBack:Shuffle       | 251.203 ms                | 522.547 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 804.545 ms                |
| ProcessBack:UpsertPq      | 74.580 us                 | 503.767 ms                |
| ProcessOneStep            | 271.155 ms                | 3.388 s                   |
| BlockToStepN              | 94.796 us                 | 410.822 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 16:36:33.239756 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=39, sample_step_cpp_seen_[rank]=38
W20240131 16:36:33.798956 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240131 16:36:34.164007 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 16:36:35.126989 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240131 16:36:35.164149 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:36.133725 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 16:36:36.164014 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
E20240131 16:36:37.164180 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1197
========== Step 44 ========== 
W20240131 16:36:37.402137 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 179.495 us                | 1.294 ms                  |
| GenInput                  | 1.066 ms                  | 9.601 ms                  |
| NN                        | 1.474 ms                  | 171.787 ms                |
| Forward                   | 2.165 ms                  | 250.806 ms                |
| Backward                  | 3.520 ms                  | 195.908 ms                |
| Optimize                  | 385.761 us                | 11.446 ms                 |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 28.475 ms                 |
| AfterBackward             | 271.168 ms                | 3.389 s                   |
| BlockToStepN              | 214.473 us                | 411.573 ms                |
| OneStep                   | 281.310 ms                | 3.395 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 45 ========== 
W20240131 16:36:37.777365 51935 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
========== Step 47 ========== 
E20240131 16:36:38.164029 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1021
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.003 us                | 31.984 ms                 |
| ProcessBack:Shuffle       | 251.203 ms                | 522.547 ms                |
| ProcessBack:UpdateCache   | 17.155 ms                 | 804.545 ms                |
| ProcessBack:UpsertPq      | 73.859 us                 | 503.767 ms                |
| ProcessOneStep            | 271.155 ms                | 3.388 s                   |
| BlockToStepN              | 114.813 us                | 410.822 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 48 ========== 
W20240131 16:36:38.608503 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
E20240131 16:36:39.164036 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
E20240131 16:36:39.431371 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=51, sample_step_cpp_seen_[rank]=50
W20240131 16:36:39.742744 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 52 ========== 
E20240131 16:36:40.164093 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2238
E20240131 16:36:41.164022 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:36:41.469501 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240131 16:36:42.164031 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.970 us                | 937.910 us                |
| GenInput                  | 1.040 ms                  | 8.017 ms                  |
| NN                        | 1.474 ms                  | 9.738 ms                  |
| Forward                   | 2.165 ms                  | 22.219 ms                 |
| Backward                  | 3.676 ms                  | 11.925 ms                 |
| Optimize                  | 385.284 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 967.020 us                | 2.250 ms                  |
| AfterBackward             | 270.719 ms                | 3.245 s                   |
| BlockToStepN              | 224.428 us                | 901.313 us                |
| OneStep                   | 280.148 ms                | 3.259 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:42.661127 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240131 16:36:43.164646 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 142.032 us                | 275.041 us                |
| ProcessBack:Shuffle       | 251.203 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.829 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.852 us                 | 437.145 us                |
| ProcessOneStep            | 270.675 ms                | 3.245 s                   |
| BlockToStepN              | 119.441 us                | 501.232 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:43.241585 51935 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
W20240131 16:36:43.753098 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 56 ========== 
E20240131 16:36:44.164073 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=576
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
W20240131 16:36:44.970153 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
========== Step 60 ========== 
E20240131 16:36:45.164182 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=507
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
E20240131 16:36:46.151469 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=63, sample_step_cpp_seen_[rank]=62
E20240131 16:36:46.164265 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=79
W20240131 16:36:46.522789 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 16:36:47.164110 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 179.214 us                | 937.910 us                |
| GenInput                  | 1.004 ms                  | 8.017 ms                  |
| NN                        | 1.465 ms                  | 9.738 ms                  |
| Forward                   | 1.984 ms                  | 22.219 ms                 |
| Backward                  | 3.520 ms                  | 11.925 ms                 |
| Optimize                  | 364.065 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 953.817 us                | 2.250 ms                  |
| AfterBackward             | 268.847 ms                | 3.350 s                   |
| BlockToStepN              | 230.884 us                | 901.313 us                |
| OneStep                   | 279.870 ms                | 3.359 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:48.002285 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240131 16:36:48.164278 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.936 us                | 324.148 us                |
| ProcessBack:Shuffle       | 249.869 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.262 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 74.580 us                 | 632.691 us                |
| ProcessOneStep            | 268.793 ms                | 3.350 s                   |
| BlockToStepN              | 133.893 us                | 501.232 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:49.114993 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240131 16:36:49.164295 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 64 ========== 
========== Step 65 ========== 
W20240131 16:36:50.079509 51935 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
E20240131 16:36:50.164113 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=278
W20240131 16:36:50.286258 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240131 16:36:50.347512 51935 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
E20240131 16:36:51.164024 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 71 ========== 
W20240131 16:36:51.608547 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
W20240131 16:36:51.681528 51935 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
W20240131 16:36:51.952283 51935 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
E20240131 16:36:52.164023 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=330
========== Step 74 ========== 
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.687 us                | 937.910 us                |
| GenInput                  | 1.019 ms                  | 8.017 ms                  |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.832 ms                  | 22.219 ms                 |
| Backward                  | 3.634 ms                  | 11.925 ms                 |
| Optimize                  | 349.283 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.014 ms                  | 2.250 ms                  |
| AfterBackward             | 268.177 ms                | 3.389 s                   |
| BlockToStepN              | 239.060 us                | 901.313 us                |
| OneStep                   | 277.975 ms                | 3.395 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:52.624348 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 16:36:52.756536 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=75, sample_step_cpp_seen_[rank]=74
========== Step 76 ========== 
E20240131 16:36:53.164034 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 162.250 us                | 31.880 ms                 |
| ProcessBack:Shuffle       | 249.736 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.779 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 73.542 us                 | 1.035 ms                  |
| ProcessOneStep            | 268.060 ms                | 3.388 s                   |
| BlockToStepN              | 135.262 us                | 725.678 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:53.665882 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 16:36:54.164381 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:36:55.164324 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:55.198072 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240131 16:36:56.106314 51935 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
E20240131 16:36:56.164299 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:36:56.200611 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 78 ========== 
========== Step 79 ========== 
W20240131 16:36:56.957917 51935 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
E20240131 16:36:57.164017 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=236
W20240131 16:36:57.220105 51935 grad_async_v2.h:257] pq is empty
========== Step 81 ========== 
========== Step 82 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.705 us                | 937.910 us                |
| GenInput                  | 1.019 ms                  | 8.017 ms                  |
| NN                        | 1.388 ms                  | 9.738 ms                  |
| Forward                   | 1.910 ms                  | 22.219 ms                 |
| Backward                  | 3.615 ms                  | 11.925 ms                 |
| Optimize                  | 366.688 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 2.250 ms                  |
| AfterBackward             | 268.177 ms                | 3.389 s                   |
| BlockToStepN              | 251.245 us                | 901.313 us                |
| OneStep                   | 277.975 ms                | 3.395 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:36:57.548024 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
========== Step 83 ========== 
W20240131 16:36:58.032187 51935 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
E20240131 16:36:58.164022 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 140.860 us                | 32.149 ms                 |
| ProcessBack:Shuffle       | 249.426 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.829 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 75.721 us                 | 1.035 ms                  |
| ProcessOneStep            | 267.456 ms                | 3.388 s                   |
| BlockToStepN              | 145.520 us                | 725.678 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
W20240131 16:36:58.912933 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 88 ========== 
E20240131 16:36:59.172078 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:36:59.364518 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=88, sample_step_cpp_seen_[rank]=87
E20240131 16:37:00.172262 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:00.533638 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 16:37:01.172122 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240131 16:37:01.727448 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240131 16:37:02.172031 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
========== Step 89 ========== 
========== Step 90 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.705 us                | 937.910 us                |
| GenInput                  | 1.005 ms                  | 8.017 ms                  |
| NN                        | 1.383 ms                  | 9.738 ms                  |
| Forward                   | 1.909 ms                  | 22.219 ms                 |
| Backward                  | 3.576 ms                  | 11.925 ms                 |
| Optimize                  | 373.125 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.014 ms                  | 2.250 ms                  |
| AfterBackward             | 267.499 ms                | 3.389 s                   |
| BlockToStepN              | 261.983 us                | 901.313 us                |
| OneStep                   | 277.975 ms                | 3.395 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:02.759438 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 91 ========== 
========== Step 92 ========== 
E20240131 16:37:03.172097 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=565
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 284.549 us                | 28.120 ms                 |
| ProcessBack:Shuffle       | 249.024 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.829 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 74.580 us                 | 1.035 ms                  |
| ProcessOneStep            | 267.456 ms                | 3.388 s                   |
| BlockToStepN              | 155.846 us                | 725.678 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
W20240131 16:37:04.071233 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
========== Step 96 ========== 
E20240131 16:37:04.172017 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=567
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
Step99:rank4, time: 75.665, per_step: 0.756648
Step99:rank6, time: 75.664, per_step: 0.756645
Step99:rank5, time: 75.665, per_step: 0.756646
Step99:rank7, time: 75.665, per_step: 0.756647
Step99:rank2, time: 75.664, per_step: 0.756643
Step99:rank1, time: 75.664, per_step: 0.756643
Step99:rank0, time: 75.664, per_step: 0.756643
Step99:rank3, time: 75.664, per_step: 0.756643
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.232 us                | 937.910 us                |
| GenInput                  | 951.157 us                | 8.017 ms                  |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.871 ms                  | 22.219 ms                 |
| Backward                  | 3.520 ms                  | 11.925 ms                 |
| Optimize                  | 364.065 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 2.250 ms                  |
| AfterBackward             | 267.279 ms                | 3.389 s                   |
| BlockToStepN              | 283.259 us                | 901.313 us                |
| OneStep                   | 276.641 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 16:37:05.172638 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=41
W20240131 16:37:05.315310 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 101 ========== 
E20240131 16:37:05.631528 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=101, sample_step_cpp_seen_[rank]=100
E20240131 16:37:06.172345 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:06.997783 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240131 16:37:07.172087 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.232 us                | 937.910 us                |
| GenInput                  | 951.157 us                | 8.017 ms                  |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.849 ms                  | 22.219 ms                 |
| Backward                  | 3.569 ms                  | 11.925 ms                 |
| Optimize                  | 362.635 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.014 ms                  | 2.250 ms                  |
| AfterBackward             | 267.471 ms                | 3.389 s                   |
| BlockToStepN              | 283.738 us                | 901.313 us                |
| OneStep                   | 276.641 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:37:08.172094 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 16:37:08.199505 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.646 us                | 268.390 us                |
| ProcessBack:Shuffle       | 248.382 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 16.262 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 75.721 us                 | 1.035 ms                  |
| ProcessOneStep            | 267.423 ms                | 3.388 s                   |
| BlockToStepN              | 165.826 us                | 725.678 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 102 ========== 
========== Step 103 ========== 
E20240131 16:37:09.172024 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=190
W20240131 16:37:09.298581 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
E20240131 16:37:10.178890 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=41
========== Step 108 ========== 
========== Step 109 ========== 
W20240131 16:37:10.820500 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
========== Step 110 ========== 
E20240131 16:37:11.178043 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=937
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
E20240131 16:37:12.018949 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=113, sample_step_cpp_seen_[rank]=112
E20240131 16:37:12.178042 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 16:37:12.298235 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 114 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.705 us                | 1.294 ms                  |
| GenInput                  | 992.697 us                | 16.433 ms                 |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.840 ms                  | 22.219 ms                 |
| Backward                  | 3.676 ms                  | 11.925 ms                 |
| Optimize                  | 351.667 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 2.250 ms                  |
| AfterBackward             | 267.454 ms                | 3.389 s                   |
| BlockToStepN              | 303.109 us                | 1.483 ms                  |
| OneStep                   | 278.552 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:37:13.178225 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.002 us                | 293.293 us                |
| ProcessBack:Shuffle       | 248.354 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 17.155 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 75.852 us                 | 1.035 ms                  |
| ProcessOneStep            | 267.410 ms                | 3.388 s                   |
| BlockToStepN              | 184.686 us                | 725.678 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:13.950022 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240131 16:37:14.178124 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:14.964875 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 16:37:15.178020 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 115 ========== 
========== Step 116 ========== 
W20240131 16:37:16.044014 51935 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
W20240131 16:37:16.103906 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 16:37:16.178045 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=119
========== Step 118 ========== 
W20240131 16:37:16.572693 51935 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
E20240131 16:37:17.178033 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=105
========== Step 122 ========== 
W20240131 16:37:17.445255 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
========== Step 123 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.705 us                | 1.294 ms                  |
| GenInput                  | 948.988 us                | 16.433 ms                 |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.840 ms                  | 22.219 ms                 |
| Backward                  | 3.676 ms                  | 13.347 ms                 |
| Optimize                  | 351.667 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.029 ms                  | 2.250 ms                  |
| AfterBackward             | 267.279 ms                | 3.389 s                   |
| BlockToStepN              | 318.262 us                | 1.483 ms                  |
| OneStep                   | 278.552 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:17.796873 51935 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
========== Step 125 ========== 
E20240131 16:37:18.178362 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=230
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 152.644 us                | 31.861 ms                 |
| ProcessBack:Shuffle       | 248.350 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 76.605 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.580 ms                | 3.388 s                   |
| BlockToStepN              | 218.655 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 126 ========== 
E20240131 16:37:18.511541 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=126, sample_step_cpp_seen_[rank]=125
W20240131 16:37:18.947109 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240131 16:37:19.178213 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:37:20.178155 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 16:37:20.401667 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240131 16:37:21.178337 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:21.420647 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
E20240131 16:37:22.178139 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=766
========== Step 130 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 177.705 us                | 1.294 ms                  |
| GenInput                  | 951.157 us                | 16.433 ms                 |
| NN                        | 1.355 ms                  | 9.738 ms                  |
| Forward                   | 1.849 ms                  | 22.219 ms                 |
| Backward                  | 3.653 ms                  | 13.347 ms                 |
| Optimize                  | 351.667 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 2.250 ms                  |
| AfterBackward             | 267.279 ms                | 3.389 s                   |
| BlockToStepN              | 328.822 us                | 1.576 ms                  |
| OneStep                   | 278.552 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 131 ========== 
W20240131 16:37:22.780572 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
========== Step 132 ========== 
========== Step 133 ========== 
E20240131 16:37:23.178256 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 186.865 us                | 31.894 ms                 |
| ProcessBack:Shuffle       | 248.350 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 17.111 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 76.605 us                 | 1.403 ms                  |
| ProcessOneStep            | 267.237 ms                | 3.388 s                   |
| BlockToStepN              | 223.664 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 134 ========== 
========== Step 135 ========== 
W20240131 16:37:23.917191 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
========== Step 136 ========== 
E20240131 16:37:24.178089 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=235
========== Step 137 ========== 
========== Step 138 ========== 
W20240131 16:37:24.812037 51935 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
E20240131 16:37:25.052945 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=139, sample_step_cpp_seen_[rank]=138
E20240131 16:37:25.178073 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:25.557512 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240131 16:37:26.178015 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:37:27.034619 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240131 16:37:27.178037 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.232 us                | 1.294 ms                  |
| GenInput                  | 918.677 us                | 16.433 ms                 |
| NN                        | 1.347 ms                  | 9.738 ms                  |
| Forward                   | 1.835 ms                  | 22.219 ms                 |
| Backward                  | 3.599 ms                  | 13.347 ms                 |
| Optimize                  | 345.707 us                | 2.095 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 2.250 ms                  |
| AfterBackward             | 267.454 ms                | 3.389 s                   |
| BlockToStepN              | 340.572 us                | 1.576 ms                  |
| OneStep                   | 278.552 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:28.054145 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 140 ========== 
E20240131 16:37:28.184165 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.651 us                | 278.326 us                |
| ProcessBack:Shuffle       | 248.350 ms                | 314.208 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 31.265 ms                 |
| ProcessBack:UpsertPq      | 75.852 us                 | 1.403 ms                  |
| ProcessOneStep            | 267.410 ms                | 3.388 s                   |
| BlockToStepN              | 229.343 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
E20240131 16:37:29.184253 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=458
========== Step 144 ========== 
W20240131 16:37:29.478127 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
========== Step 145 ========== 
========== Step 146 ========== 
W20240131 16:37:29.916719 51935 grad_async_v2.h:257] pq is empty
========== Step 147 ========== 
========== Step 148 ========== 
E20240131 16:37:30.184880 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 149 ========== 
========== Step 150 ========== 
W20240131 16:37:30.993090 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
========== Step 151 ========== 
E20240131 16:37:31.184017 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=538
E20240131 16:37:31.289242 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=151, sample_step_cpp_seen_[rank]=150
W20240131 16:37:32.132759 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240131 16:37:32.184207 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.735 us                | 1.290 ms                  |
| GenInput                  | 918.677 us                | 14.747 ms                 |
| NN                        | 1.335 ms                  | 6.510 ms                  |
| Forward                   | 1.821 ms                  | 11.032 ms                 |
| Backward                  | 3.615 ms                  | 12.578 ms                 |
| Optimize                  | 344.038 us                | 1.304 ms                  |
| BarrierTimeBeforeRank0    | 1.014 ms                  | 2.082 ms                  |
| AfterBackward             | 266.614 ms                | 3.350 s                   |
| BlockToStepN              | 350.297 us                | 1.483 ms                  |
| OneStep                   | 277.975 ms                | 3.359 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:37:33.184010 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.294 us                | 292.739 us                |
| ProcessBack:Shuffle       | 246.600 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.721 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.580 ms                | 3.350 s                   |
| BlockToStepN              | 238.759 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:33.391287 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240131 16:37:34.185139 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:34.503010 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240131 16:37:35.185195 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:35.896008 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 152 ========== 
E20240131 16:37:36.185021 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
W20240131 16:37:37.084164 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240131 16:37:37.185292 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=174
========== Step 156 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.735 us                | 1.290 ms                  |
| GenInput                  | 915.093 us                | 14.747 ms                 |
| NN                        | 1.335 ms                  | 6.510 ms                  |
| Forward                   | 1.821 ms                  | 11.032 ms                 |
| Backward                  | 3.615 ms                  | 12.578 ms                 |
| Optimize                  | 344.038 us                | 1.304 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 2.082 ms                  |
| AfterBackward             | 267.279 ms                | 3.389 s                   |
| BlockToStepN              | 354.416 us                | 1.576 ms                  |
| OneStep                   | 278.180 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
E20240131 16:37:38.185019 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 140.457 us                | 31.934 ms                 |
| ProcessBack:Shuffle       | 248.350 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.011 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.035 ms                  |
| ProcessOneStep            | 267.237 ms                | 3.388 s                   |
| BlockToStepN              | 246.477 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 160 ========== 
W20240131 16:37:38.558341 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
========== Step 161 ========== 
========== Step 162 ========== 
E20240131 16:37:39.185024 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=75
========== Step 163 ========== 
========== Step 164 ========== 
E20240131 16:37:39.724265 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=164, sample_step_cpp_seen_[rank]=163
E20240131 16:37:40.185110 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:40.213462 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240131 16:37:41.185029 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 16:37:41.641170 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240131 16:37:42.185014 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.687 us                | 1.290 ms                  |
| GenInput                  | 907.561 us                | 14.747 ms                 |
| NN                        | 1.303 ms                  | 6.510 ms                  |
| Forward                   | 1.789 ms                  | 11.032 ms                 |
| Backward                  | 3.634 ms                  | 13.089 ms                 |
| Optimize                  | 341.892 us                | 1.304 ms                  |
| BarrierTimeBeforeRank0    | 1.014 ms                  | 2.082 ms                  |
| AfterBackward             | 266.610 ms                | 3.389 s                   |
| BlockToStepN              | 368.897 us                | 1.576 ms                  |
| OneStep                   | 277.658 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:42.668386 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 165 ========== 
========== Step 166 ========== 
E20240131 16:37:43.196105 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=58
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 130.153 us                | 20.342 ms                 |
| ProcessBack:Shuffle       | 248.223 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.011 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.852 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.580 ms                | 3.388 s                   |
| BlockToStepN              | 253.853 us                | 1.092 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
W20240131 16:37:43.976405 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
========== Step 170 ========== 
E20240131 16:37:44.196063 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
W20240131 16:37:45.188171 51935 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
E20240131 16:37:45.196027 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 16:37:45.314110 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
========== Step 175 ========== 
E20240131 16:37:45.692855 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=175, sample_step_cpp_seen_[rank]=174
E20240131 16:37:46.196375 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:46.864315 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240131 16:37:47.196061 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.085 us                | 1.290 ms                  |
| GenInput                  | 884.476 us                | 14.747 ms                 |
| NN                        | 1.303 ms                  | 6.510 ms                  |
| Forward                   | 1.789 ms                  | 11.032 ms                 |
| Backward                  | 3.653 ms                  | 13.089 ms                 |
| Optimize                  | 342.369 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 980.612 us                | 3.044 ms                  |
| AfterBackward             | 266.610 ms                | 3.389 s                   |
| BlockToStepN              | 374.709 us                | 1.576 ms                  |
| OneStep                   | 277.658 ms                | 3.395 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:48.160864 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240131 16:37:48.196130 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 132.530 us                | 283.530 us                |
| ProcessBack:Shuffle       | 247.660 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.011 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.852 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.576 ms                | 3.388 s                   |
| BlockToStepN              | 283.554 us                | 1.247 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 176 ========== 
E20240131 16:37:49.199990 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 16:37:49.218783 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 177 ========== 
W20240131 16:37:49.655714 51935 grad_async_v2.h:257] pq is empty
========== Step 178 ========== 
========== Step 179 ========== 
E20240131 16:37:50.199110 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=417
========== Step 180 ========== 
========== Step 181 ========== 
W20240131 16:37:50.487870 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 182 ========== 
========== Step 183 ========== 
E20240131 16:37:51.199157 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=87
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
W20240131 16:37:51.962710 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240131 16:37:51.997407 51935 grad_async_v2.h:257] pq is empty
========== Step 187 ========== 
E20240131 16:37:52.199216 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=30
E20240131 16:37:52.267944 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=187, sample_step_cpp_seen_[rank]=186
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.195 us                | 1.290 ms                  |
| GenInput                  | 876.260 us                | 14.747 ms                 |
| NN                        | 1.255 ms                  | 6.510 ms                  |
| Forward                   | 1.784 ms                  | 11.032 ms                 |
| Backward                  | 3.639 ms                  | 13.089 ms                 |
| Optimize                  | 334.978 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 1.029 ms                  | 3.044 ms                  |
| AfterBackward             | 266.382 ms                | 3.643 s                   |
| BlockToStepN              | 383.754 us                | 1.576 ms                  |
| OneStep                   | 276.576 ms                | 3.652 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:37:53.199015 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.129 us                | 271.588 us                |
| ProcessBack:Shuffle       | 247.660 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.111 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.651 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.331 ms                | 3.643 s                   |
| BlockToStepN              | 286.904 us                | 1.247 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:37:53.568292 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 16:37:54.199334 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:37:54.761049 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
E20240131 16:37:55.199034 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:37:55.257619 51935 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
========== Step 189 ========== 
W20240131 16:37:55.801890 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240131 16:37:55.853257 51935 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
========== Step 191 ========== 
E20240131 16:37:56.199018 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=34
W20240131 16:37:56.385057 51935 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
E20240131 16:37:57.204018 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=110
W20240131 16:37:57.291220 52820 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
========== Step 196 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.780 us                | 1.290 ms                  |
| GenInput                  | 871.259 us                | 14.747 ms                 |
| NN                        | 1.250 ms                  | 6.813 ms                  |
| Forward                   | 1.780 ms                  | 11.032 ms                 |
| Backward                  | 3.676 ms                  | 13.089 ms                 |
| Optimize                  | 334.978 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 3.044 ms                  |
| AfterBackward             | 266.382 ms                | 3.643 s                   |
| BlockToStepN              | 398.803 us                | 1.602 ms                  |
| OneStep                   | 276.576 ms                | 3.652 s                   |
| E2E-100                   | 51.875 s                  | 51.875 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 197 ========== 
========== Step 198 ========== 
E20240131 16:37:58.204421 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.639 us                | 31.881 ms                 |
| ProcessBack:Shuffle       | 248.223 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.019 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.301 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.400 ms                | 3.643 s                   |
| BlockToStepN              | 294.143 us                | 1.450 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 199 ========== 
E20240131 16:37:58.578907 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=199, sample_step_cpp_seen_[rank]=198
W20240131 16:37:58.872826 52820 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240131 16:37:59.204252 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:38:00.204442 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:38:00.934837 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240131 16:38:01.204138 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 16:38:02.204052 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 16:38:02.274271 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 16:38:02.543007 51935 grad_async_v2.h:257] pq is empty
Step199:rank2, time: 57.374, per_step: 0.568055
Step199:rank4, time: 57.374, per_step: 0.568059
Step199:rank0, time: 57.374, per_step: 0.568055
Step199:rank7, time: 57.374, per_step: 0.568055
Step199:rank1, time: 57.374, per_step: 0.568055
Step199:rank6, time: 57.374, per_step: 0.568059
Step199:rank5, time: 57.374, per_step: 0.568059
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.615 us                | 1.294 ms                  |
| GenInput                  | 871.259 us                | 14.747 ms                 |
| NN                        | 1.250 ms                  | 6.813 ms                  |
| Forward                   | 1.780 ms                  | 11.032 ms                 |
| Backward                  | 3.653 ms                  | 13.089 ms                 |
| Optimize                  | 335.217 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 980.612 us                | 3.044 ms                  |
| AfterBackward             | 266.457 ms                | 3.651 s                   |
| BlockToStepN              | 406.703 us                | 1.602 ms                  |
| OneStep                   | 277.365 ms                | 3.652 s                   |
| E2E-100                   | 51.875 s                  | 57.374 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
Step199:rank3, time: 57.376, per_step: 0.568077
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.615 us                | 1.294 ms                  |
| GenInput                  | 871.259 us                | 14.747 ms                 |
| NN                        | 1.250 ms                  | 6.813 ms                  |
| Forward                   | 1.780 ms                  | 11.032 ms                 |
| Backward                  | 3.653 ms                  | 13.089 ms                 |
| Optimize                  | 335.217 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 980.612 us                | 3.044 ms                  |
| AfterBackward             | 266.457 ms                | 3.651 s                   |
| BlockToStepN              | 406.703 us                | 1.602 ms                  |
| OneStep                   | 277.365 ms                | 3.659 s                   |
| E2E-100                   | 51.875 s                  | 57.374 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:38:02.827944 51935 grad_async_v2.h:257] pq is empty
========== Step 201 ========== 
========== Step 202 ========== 
E20240131 16:38:03.204066 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.902 us                | 27.583 ms                 |
| ProcessBack:Shuffle       | 248.223 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.155 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.301 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.400 ms                | 3.651 s                   |
| BlockToStepN              | 294.143 us                | 1.450 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 203 ========== 
W20240131 16:38:03.507902 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
E20240131 16:38:04.236289 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 207 ========== 
W20240131 16:38:04.589747 52820 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
E20240131 16:38:05.236110 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 211 ========== 
W20240131 16:38:05.591861 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
========== Step 212 ========== 
E20240131 16:38:05.911114 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=212, sample_step_cpp_seen_[rank]=211
E20240131 16:38:06.236096 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 16:38:07.214774 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240131 16:38:07.236191 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.997 us                | 1.724 ms                  |
| GenInput                  | 870.851 us                | 14.747 ms                 |
| NN                        | 1.250 ms                  | 9.738 ms                  |
| Forward                   | 1.751 ms                  | 13.159 ms                 |
| Backward                  | 3.653 ms                  | 13.347 ms                 |
| Optimize                  | 334.501 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 1.022 ms                  | 3.044 ms                  |
| AfterBackward             | 266.232 ms                | 3.651 s                   |
| BlockToStepN              | 416.762 us                | 1.865 ms                  |
| OneStep                   | 276.554 ms                | 3.659 s                   |
| E2E-100                   | 51.875 s                  | 57.374 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.269 us                | 248.612 us                |
| ProcessBack:Shuffle       | 248.172 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.238 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.301 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.197 ms                | 3.651 s                   |
| BlockToStepN              | 308.297 us                | 1.746 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:38:08.236259 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:38:08.268934 52820 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
E20240131 16:38:09.240209 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=168
========== Step 216 ========== 
W20240131 16:38:09.436558 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
========== Step 217 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
E20240131 16:38:10.240195 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 220 ========== 
========== Step 221 ========== 
W20240131 16:38:10.615087 52820 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
========== Step 222 ========== 
========== Step 223 ========== 
E20240131 16:38:11.240036 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=131
========== Step 224 ========== 
E20240131 16:38:11.561976 51935 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=224, sample_step_cpp_seen_[rank]=223
W20240131 16:38:11.634582 52820 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 225 ========== 
E20240131 16:38:12.240026 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.572 us                | 1.724 ms                  |
| GenInput                  | 829.886 us                | 14.747 ms                 |
| NN                        | 1.235 ms                  | 9.738 ms                  |
| Forward                   | 1.715 ms                  | 13.159 ms                 |
| Backward                  | 3.676 ms                  | 13.347 ms                 |
| Optimize                  | 332.594 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 3.044 ms                  |
| AfterBackward             | 266.050 ms                | 3.651 s                   |
| BlockToStepN              | 429.240 us                | 1.865 ms                  |
| OneStep                   | 275.273 ms                | 3.659 s                   |
| E2E-100                   | 51.875 s                  | 57.374 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 16:38:12.931879 52820 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.906 us                | 288.439 us                |
| ProcessBack:Shuffle       | 246.600 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.238 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.340 us                 | 1.035 ms                  |
| ProcessOneStep            | 266.012 ms                | 3.651 s                   |
| BlockToStepN              | 317.557 us                | 1.746 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:38:13.240041 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 16:38:14.202627 52820 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240131 16:38:14.240021 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 16:38:15.241375 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:38:15.741322 52820 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 16:38:16.241595 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
W20240131 16:38:16.852046 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
W20240131 16:38:17.068861 51935 grad_async_v2.h:257] pq is empty
========== Step 229 ========== 
E20240131 16:38:17.241214 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=165
Successfully xmh
W20240131 16:38:17.315553 51935 grad_async_v2.h:84] call StopThreads. PID = 51935
W20240131 16:38:17.315577 51935 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 16:38:17.315622 51935 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 16:38:17.315629 51935 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.586 us                | 1.724 ms                  |
| GenInput                  | 829.886 us                | 14.747 ms                 |
| NN                        | 1.242 ms                  | 9.738 ms                  |
| Forward                   | 1.725 ms                  | 13.159 ms                 |
| Backward                  | 3.676 ms                  | 13.347 ms                 |
| Optimize                  | 332.832 us                | 1.829 ms                  |
| BarrierTimeBeforeRank0    | 1.008 ms                  | 3.044 ms                  |
| AfterBackward             | 265.629 ms                | 4.246 s                   |
| BlockToStepN              | 430.527 us                | 2.129 ms                  |
| OneStep                   | 275.261 ms                | 4.264 s                   |
| E2E-100                   | 51.875 s                  | 57.374 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 144.724 us                | 301.575 us                |
| ProcessBack:Shuffle       | 246.420 ms                | 292.873 ms                |
| ProcessBack:UpdateCache   | 17.314 ms                 | 26.107 ms                 |
| ProcessBack:UpsertPq      | 75.340 us                 | 1.035 ms                  |
| ProcessOneStep            | 265.540 ms                | 4.245 s                   |
| BlockToStepN              | 321.486 us                | 1.853 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 16:38:18.241129 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:38:18.369565 52820 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240131 16:38:19.241060 52820 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 16:38:19.743952 51935 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
