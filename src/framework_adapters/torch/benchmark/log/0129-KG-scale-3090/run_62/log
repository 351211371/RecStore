WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 21:46:26.574921 30691 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_14', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [30691 sampler.py:454] Start PreSampling
WARNING [30691 sampler.py:532] Before construct renumbering_dict
WARNING [30691 sampler.py:555] PreSampling done
W20240129 22:05:31.900291 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 22:05:31.900475 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 22:05:31.900519 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 22:05:31.900554 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 22:05:31.900589 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 22:05:31.900619 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 22:05:31.900645 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 22:05:31.900686 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 22:05:31.900725 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 22:05:31.900754 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 22:05:31.900790 30691 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 22:05:31.900818 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 22:05:31.900842 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 22:05:31.901000 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 22:05:31.901042 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 22:05:31.901075 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 22:05:31.901118 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 22:05:31.901146 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 22:05:31.901181 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 22:05:31.901208 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 22:05:31.901249 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 22:05:31.901284 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 22:05:31.901319 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 22:05:31.901350 30691 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 22:05:31.901371 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 22:05:31.901396 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 22:05:31.901449 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 22:05:31.901485 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 22:05:31.901522 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 22:05:31.901547 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 22:05:31.901575 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 22:05:31.901605 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 22:05:31.901641 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 22:05:31.901674 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 22:05:31.901706 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 22:05:31.901733 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 22:05:31.901762 30691 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 22:05:31.901784 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 22:05:31.901808 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 22:05:31.901868 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 22:05:31.901907 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 22:05:31.901940 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 22:05:31.901966 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 22:05:31.901997 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 22:05:31.902031 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 22:05:31.902062 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 22:05:31.902098 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 22:05:31.902140 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 22:05:31.902166 30691 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 22:05:31.902199 30691 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 22:05:31.902220 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 22:05:31.902244 30691 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 22:05:32.288350 30691 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240129 22:05:32.288501 30691 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Rank2: cached key size 2151353
Rank3: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 8605412,  8605413,   111837,  ..., 58581135, 18176978,  4707330]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1651.924 seconds
[Rank1] pid = 31622
[Rank2] pid = 31718
INFO [30691 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [31718 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [31622 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [31786 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [31718 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [31786 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [31622 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 22:14:03.953931 31719 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240129 22:14:03.953977 31623 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240129 22:14:03.953980 31787 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
INFO [30691 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 22:14:03.959976 31850 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240129 22:14:04.031733 31787 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036dbc000 7.629 MB
W20240129 22:14:04.031735 31719 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203755f000 7.629 MB
W20240129 22:14:04.031730 31850 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036619000 7.629 MB
W20240129 22:14:04.031739 31623 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102037d02000 7.629 MB
W20240129 22:14:04.031888 31787 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020384a5000 7.629 MB
W20240129 22:14:04.031889 31850 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102038c48000 7.629 MB
W20240129 22:14:04.031903 31719 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020393eb000 7.629 MB
W20240129 22:14:04.031915 31623 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102039b8e000 7.629 MB
W20240129 22:14:04.031934 31850 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10203a331000 1.49 GB
W20240129 22:14:04.031967 31787 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102099914000 1.49 GB
W20240129 22:14:04.031973 31719 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1020f8ef7000 1.49 GB
W20240129 22:14:04.031976 31850 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021584da000 1.49 GB
W20240129 22:14:04.031996 31623 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021b7abd000 1.49 GB
W20240129 22:14:04.032019 31787 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1022170a0000 1.49 GB
W20240129 22:14:04.032029 31719 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102276683000 1.49 GB
W20240129 22:14:04.032030 31850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 22:14:04.032043 31623 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022d5c66000 1.49 GB
W20240129 22:14:04.032074 31787 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 22:14:04.032079 31719 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 22:14:04.032097 31623 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 22:14:04.038349 31850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 22:14:04.038380 31787 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 22:14:04.038383 31719 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 22:14:04.038393 31623 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [31718 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
[Rank3] pid = 31786
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [30691 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [31622 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [31786 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 22:14:38.247226 31787 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 22:14:38.247607 31719 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 22:14:38.247762 31850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 22:14:38.247900 31623 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240129 22:14:38.251109 31850 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 22:14:38.251394 31850 grad_base.h:184] Init GradProcessingBase done
I20240129 22:14:50.827226 31850 grad_async_v1.h:199] Use main thread to update emb.
W20240129 22:14:50.827335 31850 kg_controller.h:75] after init GradAsyncProcessing
I20240129 22:14:50.827344 31850 kg_controller.h:84] Construct KGCacheController done
E20240129 22:14:51.288902 31787 recstore.cc:66] init folly done
E20240129 22:14:51.288924 31850 recstore.cc:66] init folly done
E20240129 22:14:51.288923 31623 recstore.cc:66] init folly done
E20240129 22:14:51.288954 31719 recstore.cc:66] init folly done
I20240129 22:14:51.290118 31850 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 22:15:03.633735 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 22:15:05.454691 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 22:15:08.771623 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240129 22:15:08.818894 31787 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
W20240129 22:15:12.202191 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240129 22:15:12.247108 31719 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 22:15:12.450798 31623 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 22:15:13.118527 31850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 22:15:13.225699 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.766 ms                 | 25.766 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:14.559284 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240129 22:15:15.002508 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:15:15.559010 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240129 22:15:16.197736 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.127 ms                  | 178.243 ms                |
| ProcessBack:UpdateCache   | 2.881 ms                  | 313.206 ms                |
| ProcessBack:UpsertPq      | 19.416 ms                 | 25.442 ms                 |
| ProcessOneStep            | 26.429 ms                 | 586.137 ms                |
| BlockToStepN              | 3.100 ms                  | 484.217 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:16.559007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240129 22:15:17.203907 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 22:15:17.560467 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240129 22:15:18.244177 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.774 ms                 | 118.774 ms                |
| Forward                   | 5.178 ms                  | 622.836 ms                |
| Backward                  | 11.702 ms                 | 192.659 ms                |
| Optimize                  | 2.535 ms                  | 9.841 ms                  |
| BarrierTimeBeforeRank0    | 37.997 us                 | 32.473 ms                 |
| AfterBackward             | 25.820 ms                 | 586.321 ms                |
| BlockToStepN              | 3.664 ms                  | 484.322 ms                |
| OneStep                   | 155.886 ms                | 1.881 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:18.560007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240129 22:15:19.311139 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 22:15:19.560009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240129 22:15:20.356462 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:15:20.560009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.727 ms                  | 178.243 ms                |
| ProcessBack:UpdateCache   | 2.827 ms                  | 313.206 ms                |
| ProcessBack:UpsertPq      | 17.056 ms                 | 25.442 ms                 |
| ProcessOneStep            | 24.498 ms                 | 586.137 ms                |
| BlockToStepN              | 3.903 ms                  | 484.217 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:21.405391 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:15:21.560009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240129 22:15:22.410423 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:15:22.560009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.381 ms                 | 118.774 ms                |
| Forward                   | 4.995 ms                  | 622.836 ms                |
| Backward                  | 11.585 ms                 | 192.659 ms                |
| Optimize                  | 2.491 ms                  | 9.841 ms                  |
| BarrierTimeBeforeRank0    | 33.988 us                 | 32.473 ms                 |
| AfterBackward             | 24.448 ms                 | 586.321 ms                |
| BlockToStepN              | 3.951 ms                  | 484.322 ms                |
| OneStep                   | 155.886 ms                | 1.881 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:23.471801 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:15:23.625125 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240129 22:15:24.552387 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:15:24.693395 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240129 22:15:25.672274 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 22:15:25.751845 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=40, pq.top=40
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.685 ms                  | 138.842 ms                |
| ProcessBack:UpdateCache   | 2.827 ms                  | 312.743 ms                |
| ProcessBack:UpsertPq      | 16.317 ms                 | 25.442 ms                 |
| ProcessOneStep            | 24.418 ms                 | 586.137 ms                |
| BlockToStepN              | 3.903 ms                  | 484.217 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:26.705117 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:15:26.778277 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240129 22:15:27.758055 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 22:15:27.778002 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.955 ms                 | 105.101 ms                |
| Forward                   | 4.940 ms                  | 15.170 ms                 |
| Backward                  | 11.585 ms                 | 13.581 ms                 |
| Optimize                  | 2.537 ms                  | 5.351 ms                  |
| BarrierTimeBeforeRank0    | 78.044 us                 | 29.739 ms                 |
| AfterBackward             | 24.418 ms                 | 36.245 ms                 |
| BlockToStepN              | 3.951 ms                  | 484.322 ms                |
| OneStep                   | 155.886 ms                | 1.881 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:28.778009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240129 22:15:28.793503 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:15:29.778005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240129 22:15:29.835637 32150 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 22:15:30.778007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240129 22:15:30.843292 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.628 ms                  | 138.842 ms                |
| ProcessBack:UpdateCache   | 2.674 ms                  | 312.743 ms                |
| ProcessBack:UpsertPq      | 16.774 ms                 | 37.093 ms                 |
| ProcessOneStep            | 24.498 ms                 | 43.921 ms                 |
| BlockToStepN              | 3.903 ms                  | 438.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:31.778007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240129 22:15:31.955096 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:15:32.778008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240129 22:15:32.989514 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.174 ms                  | 105.101 ms                |
| Forward                   | 4.822 ms                  | 15.170 ms                 |
| Backward                  | 11.465 ms                 | 13.581 ms                 |
| Optimize                  | 2.556 ms                  | 5.351 ms                  |
| BarrierTimeBeforeRank0    | 49.244 us                 | 29.739 ms                 |
| AfterBackward             | 24.989 ms                 | 43.954 ms                 |
| BlockToStepN              | 3.951 ms                  | 439.924 ms                |
| OneStep                   | 155.886 ms                | 609.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:33.782306 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240129 22:15:33.994350 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:15:34.782013 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240129 22:15:35.003252 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 22:15:35.782008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240129 22:15:36.041107 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.628 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.666 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 17.017 ms                 | 34.254 ms                 |
| ProcessOneStep            | 24.516 ms                 | 43.921 ms                 |
| BlockToStepN              | 5.563 ms                  | 438.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:36.782007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240129 22:15:37.043289 32150 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 22:15:37.782008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240129 22:15:38.105265 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.011 ms                  | 105.101 ms                |
| Forward                   | 4.797 ms                  | 15.170 ms                 |
| Backward                  | 11.303 ms                 | 13.581 ms                 |
| Optimize                  | 2.556 ms                  | 5.351 ms                  |
| BarrierTimeBeforeRank0    | 43.512 us                 | 29.739 ms                 |
| AfterBackward             | 24.527 ms                 | 43.954 ms                 |
| BlockToStepN              | 5.619 ms                  | 439.924 ms                |
| OneStep                   | 155.886 ms                | 609.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:38.782007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240129 22:15:39.234055 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:15:39.782006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
-------Step 0-------
tensor([ 1493532,   762795, 44980363,  2074312,   494118,   762840,   762890,
          229917,  1493580,  1493617]) tensor([ 9075404, 27503768,  1030902, 57393318, 59421822,  1779849, 76350293,
        78690143, 54250042, 83605268])
-------Step 1-------
tensor([ 1493532,   762795, 44980363,  2074312,   494118,   762840,   762890,
          229917,  1493580,  1493617]) tensor([31527003, 79635778, 81323552, 14113368, 54153679, 12748068, 79182849,
        69020911, 21065060, 38093227])
-------Step 2-------
tensor([  873598,  1508311, 77201567,  1508352,   873649,   873670,   873703,
        47447334,   873764,   873804]) tensor([39162638,  9086731, 56519004, 13863631, 19273680, 16477831, 57195159,
        13260639, 54590677, 37880750])
-------Step 3-------
tensor([  873598,  1508311, 77201567,  1508352,   873649,   873670,   873703,
        47447334,   873764,   873804]) tensor([  355154, 48360060,  1448419, 42265338, 17819923, 64473661, 74950797,
        67336666, 25154711, 79857966])
-------Step 4-------
tensor([ 983475, 1523858,  983518,  983563, 1523896,  983604, 1523937,  983646,
        1523968,  983687]) tensor([ 3785340, 44276516, 20881056,  1692440, 51915950, 50001580, 81929523,
        52031115, 51475068, 13034294])
-------Step 5-------
tensor([ 983475, 1523858,  983518,  983563, 1523896,  983604, 1523937,  983646,
        1523968,  983687]) tensor([39164312, 50710664, 77415162, 13132683, 40337705,   416963, 37308842,
        65836015, 80624043,  1826391])
-------Step 6-------
tensor([64952132,  1092672,  1092717,  1092760,  8609542,  1092784,  1092816,
         1092849,  1092893,   235671]) tensor([28974132, 42481709, 29037356, 22620216, 79831352, 51454638, 45424558,
        18081168, 68958175, 12391306])
-------Step 7-------
tensor([64952132,  1092672,  1092717,  1092760,  8609542,  1092784,  1092816,
         1092849,  1092893,   235671]) tensor([42373456, 78678439, 48801171, 75219221, 63694166,  2756918, 21146258,
        54439567, 24554531, 18634925])
-------Step 8-------
tensor([ 1202397,  1554529,  1202437, 37906123,  2088489,  1202465,  1202511,
         1202556,   237440,  2088496]) tensor([29836460, 50315230, 44350842, 85705193, 82989929, 55535473, 54167042,
        81912292, 14312678,  7774120])
-------Step 9-------
tensor([ 1202397,  1554529,  1202437, 37906123,  2088489,  1202465,  1202511,
         1202556,   237440,  2088496]) tensor([78204526, 58668553, 28992919, 41567953, 15703938,  2150917, 24986368,
        17830970, 81999627, 45690947])
before start barrier
start train
[proc 0] 100 steps, total: 27.058, sample: 1.796, forward: 1.115, backward: 1.300, update: 0.292
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 31.358, sample: 1.469, forward: 1.069, backward: 1.208, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.930, sample: 1.594, forward: 1.047, backward: 1.181, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.726, sample: 1.584, forward: 1.043, backward: 1.238, update: 0.237
W20240129 22:15:40.268980 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:15:40.844746 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240129 22:15:41.282560 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.611 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.666 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 16.617 ms                 | 34.254 ms                 |
| ProcessOneStep            | 24.440 ms                 | 43.921 ms                 |
| BlockToStepN              | 338.705 ms                | 438.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:41.844007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240129 22:15:42.344012 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 22:15:42.844008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.159 ms                  | 105.101 ms                |
| Forward                   | 4.766 ms                  | 15.170 ms                 |
| Backward                  | 11.059 ms                 | 13.581 ms                 |
| Optimize                  | 2.535 ms                  | 5.351 ms                  |
| BarrierTimeBeforeRank0    | 41.876 us                 | 32.473 ms                 |
| AfterBackward             | 24.293 ms                 | 43.954 ms                 |
| BlockToStepN              | 5.619 ms                  | 439.924 ms                |
| OneStep                   | 155.886 ms                | 609.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:43.492149 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:15:43.844008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240129 22:15:44.523100 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:15:44.844007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240129 22:15:45.536319 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:15:45.844008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.641 ms                  | 17.546 ms                 |
| ProcessBack:UpdateCache   | 2.666 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.317 ms                 | 37.890 ms                 |
| ProcessOneStep            | 24.312 ms                 | 51.492 ms                 |
| BlockToStepN              | 5.563 ms                  | 438.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:46.567972 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 22:15:46.844005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240129 22:15:47.567880 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 22:15:47.872131 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.351 ms                  | 118.774 ms                |
| Forward                   | 4.766 ms                  | 15.170 ms                 |
| Backward                  | 11.036 ms                 | 13.581 ms                 |
| Optimize                  | 2.535 ms                  | 5.351 ms                  |
| BarrierTimeBeforeRank0    | 44.927 us                 | 32.473 ms                 |
| AfterBackward             | 24.293 ms                 | 51.535 ms                 |
| BlockToStepN              | 337.493 ms                | 439.924 ms                |
| OneStep                   | 382.418 ms                | 609.554 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:48.880066 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:15:48.930430 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240129 22:15:49.917608 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:15:49.930001 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240129 22:15:50.918280 32150 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 22:15:50.930001 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.644 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.662 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 16.110 ms                 | 37.093 ms                 |
| ProcessOneStep            | 24.136 ms                 | 51.492 ms                 |
| BlockToStepN              | 5.563 ms                  | 438.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:51.930007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240129 22:15:52.044186 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 22:15:52.930007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240129 22:15:53.073258 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.758 ms                  | 105.101 ms                |
| Forward                   | 4.762 ms                  | 10.914 ms                 |
| Backward                  | 11.032 ms                 | 13.502 ms                 |
| Optimize                  | 2.570 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 48.420 us                 | 32.473 ms                 |
| AfterBackward             | 24.173 ms                 | 51.535 ms                 |
| BlockToStepN              | 9.474 ms                  | 435.132 ms                |
| OneStep                   | 155.886 ms                | 568.248 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:53.930007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240129 22:15:54.088596 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 22:15:55.050763 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240129 22:15:55.164917 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:15:56.059334 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.650 ms                  | 17.546 ms                 |
| ProcessBack:UpdateCache   | 2.666 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.338 ms                 | 37.890 ms                 |
| ProcessOneStep            | 24.387 ms                 | 51.492 ms                 |
| BlockToStepN              | 9.436 ms                  | 435.060 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:56.432533 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:15:57.059006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240129 22:15:57.479547 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 22:15:58.059006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.535 ms                  | 105.101 ms                |
| Forward                   | 4.762 ms                  | 10.914 ms                 |
| Backward                  | 11.032 ms                 | 13.581 ms                 |
| Optimize                  | 2.579 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 44.927 us                 | 32.473 ms                 |
| AfterBackward             | 24.291 ms                 | 51.535 ms                 |
| BlockToStepN              | 330.040 ms                | 435.132 ms                |
| OneStep                   | 382.418 ms                | 568.248 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:15:58.657017 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:15:59.059007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240129 22:15:59.665016 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:00.059006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240129 22:16:00.680639 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:01.059018 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.641 ms                  | 8.211 ms                  |
| ProcessBack:UpdateCache   | 2.660 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.258 ms                 | 37.093 ms                 |
| ProcessOneStep            | 24.165 ms                 | 51.492 ms                 |
| BlockToStepN              | 9.436 ms                  | 435.060 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:01.742226 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 22:16:02.086761 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240129 22:16:02.867527 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:03.086006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.743 ms                  | 105.101 ms                |
| Forward                   | 4.749 ms                  | 10.914 ms                 |
| Backward                  | 11.036 ms                 | 13.581 ms                 |
| Optimize                  | 2.579 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 42.374 us                 | 41.344 ms                 |
| AfterBackward             | 24.291 ms                 | 51.535 ms                 |
| BlockToStepN              | 9.474 ms                  | 435.132 ms                |
| OneStep                   | 155.886 ms                | 568.248 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:03.934401 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 1] 200 steps, total: 23.815, sample: 1.321, forward: 0.473, backward: 1.037, update: 0.229
[proc 2] 200 steps, total: 23.815, sample: 1.360, forward: 0.467, backward: 0.965, update: 0.270
[proc 0] 200 steps, total: 23.816, sample: 1.381, forward: 0.467, backward: 1.129, update: 0.288
[proc 3] 200 steps, total: 23.816, sample: 1.666, forward: 0.473, backward: 1.026, update: 0.249
W20240129 22:16:04.086004 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240129 22:16:04.936174 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240129 22:16:05.086006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240129 22:16:05.982151 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 22:16:06.086002 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.628 ms                  | 8.211 ms                  |
| ProcessBack:UpdateCache   | 2.625 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.258 ms                 | 37.093 ms                 |
| ProcessOneStep            | 24.136 ms                 | 51.492 ms                 |
| BlockToStepN              | 9.436 ms                  | 435.060 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:07.086007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240129 22:16:07.140923 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:16:08.086006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240129 22:16:08.205358 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.723 ms                  | 105.101 ms                |
| Forward                   | 4.749 ms                  | 10.914 ms                 |
| Backward                  | 10.896 ms                 | 13.581 ms                 |
| Optimize                  | 2.589 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 44.927 us                 | 41.344 ms                 |
| AfterBackward             | 24.059 ms                 | 51.535 ms                 |
| BlockToStepN              | 9.474 ms                  | 435.132 ms                |
| OneStep                   | 155.886 ms                | 568.248 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:09.115232 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240129 22:16:09.268024 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:16:10.115005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240129 22:16:10.375643 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:16:11.115005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.624 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.625 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 16.170 ms                 | 35.997 ms                 |
| ProcessOneStep            | 23.963 ms                 | 51.492 ms                 |
| BlockToStepN              | 9.436 ms                  | 435.060 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:11.427983 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:12.115007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240129 22:16:12.443647 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 22:16:13.115006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.524 ms                  | 105.101 ms                |
| Forward                   | 4.729 ms                  | 10.914 ms                 |
| Backward                  | 10.896 ms                 | 13.581 ms                 |
| Optimize                  | 2.579 ms                  | 5.306 ms                  |
| BarrierTimeBeforeRank0    | 48.420 us                 | 48.610 ms                 |
| AfterBackward             | 23.955 ms                 | 51.535 ms                 |
| BlockToStepN              | 330.040 ms                | 435.132 ms                |
| OneStep                   | 382.418 ms                | 568.248 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:13.649330 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:14.128931 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240129 22:16:14.651708 32150 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 22:16:15.155006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240129 22:16:15.686523 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:16:16.155005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.611 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.597 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 16.008 ms                 | 35.997 ms                 |
| ProcessOneStep            | 23.868 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 430.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:16.891017 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:17.155009 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240129 22:16:17.897011 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:16:18.155005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.473 ms                  | 105.087 ms                |
| Forward                   | 4.728 ms                  | 8.028 ms                  |
| Backward                  | 10.799 ms                 | 13.502 ms                 |
| Optimize                  | 2.574 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 54.720 us                 | 41.344 ms                 |
| AfterBackward             | 23.801 ms                 | 46.457 ms                 |
| BlockToStepN              | 9.474 ms                  | 430.334 ms                |
| OneStep                   | 155.886 ms                | 558.143 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:18.918547 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:16:19.155006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240129 22:16:19.955749 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 22:16:20.155006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240129 22:16:21.141222 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:16:21.187327 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.592 ms                  | 6.544 ms                  |
| ProcessBack:UpdateCache   | 2.603 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 15.895 ms                 | 37.093 ms                 |
| ProcessOneStep            | 23.756 ms                 | 46.430 ms                 |
| BlockToStepN              | 9.436 ms                  | 430.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:22.176959 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 22:16:22.257331 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240129 22:16:23.179025 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 22:16:23.257005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.526 ms                  | 105.101 ms                |
| Forward                   | 4.700 ms                  | 8.028 ms                  |
| Backward                  | 10.698 ms                 | 13.502 ms                 |
| Optimize                  | 2.570 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 54.534 us                 | 42.568 ms                 |
| AfterBackward             | 23.768 ms                 | 46.457 ms                 |
| BlockToStepN              | 9.474 ms                  | 430.334 ms                |
| OneStep                   | 155.886 ms                | 558.143 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:24.202152 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 22:16:24.257004 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240129 22:16:25.257005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240129 22:16:25.399365 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:26.257005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.568 ms                  | 6.472 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 15.733 ms                 | 35.997 ms                 |
| ProcessOneStep            | 23.724 ms                 | 46.430 ms                 |
| BlockToStepN              | 9.436 ms                  | 430.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:26.436259 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:27.257006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 0] 300 steps, total: 23.410, sample: 1.154, forward: 0.463, backward: 1.074, update: 0.280
[proc 3] 300 steps, total: 23.410, sample: 1.628, forward: 0.497, backward: 1.043, update: 0.251
[proc 1] 300 steps, total: 23.410, sample: 1.138, forward: 0.475, backward: 1.029, update: 0.229
[proc 2] 300 steps, total: 23.410, sample: 1.155, forward: 0.461, backward: 0.970, update: 0.242
W20240129 22:16:27.484606 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.516 ms                  | 105.101 ms                |
| Forward                   | 4.712 ms                  | 8.028 ms                  |
| Backward                  | 10.698 ms                 | 13.581 ms                 |
| Optimize                  | 2.567 ms                  | 5.306 ms                  |
| BarrierTimeBeforeRank0    | 221.116 us                | 42.568 ms                 |
| AfterBackward             | 23.686 ms                 | 46.457 ms                 |
| BlockToStepN              | 330.040 ms                | 430.334 ms                |
| OneStep                   | 381.281 ms                | 558.143 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:28.298853 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240129 22:16:28.692483 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:29.298007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240129 22:16:29.696656 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 22:16:30.375988 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240129 22:16:30.713025 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.569 ms                  | 6.472 ms                  |
| ProcessBack:UpdateCache   | 2.597 ms                  | 5.246 ms                  |
| ProcessBack:UpsertPq      | 15.897 ms                 | 35.997 ms                 |
| ProcessOneStep            | 23.742 ms                 | 46.430 ms                 |
| BlockToStepN              | 9.436 ms                  | 430.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:31.375005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240129 22:16:31.759557 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 22:16:32.375006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240129 22:16:32.929450 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.275 ms                  | 105.101 ms                |
| Forward                   | 4.700 ms                  | 10.914 ms                 |
| Backward                  | 10.697 ms                 | 13.581 ms                 |
| Optimize                  | 2.562 ms                  | 5.306 ms                  |
| BarrierTimeBeforeRank0    | 144.387 us                | 48.610 ms                 |
| AfterBackward             | 23.821 ms                 | 46.457 ms                 |
| BlockToStepN              | 9.474 ms                  | 430.334 ms                |
| OneStep                   | 155.886 ms                | 558.143 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:33.375005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240129 22:16:33.986315 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:16:34.375008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240129 22:16:35.036916 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 22:16:35.400609 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240129 22:16:36.219237 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.572 ms                  | 6.188 ms                  |
| ProcessBack:UpdateCache   | 2.598 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.012 ms                 | 34.254 ms                 |
| ProcessOneStep            | 23.835 ms                 | 46.430 ms                 |
| BlockToStepN              | 9.436 ms                  | 430.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:36.400004 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240129 22:16:37.238759 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:37.400007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.275 ms                  | 105.101 ms                |
| Forward                   | 4.699 ms                  | 10.914 ms                 |
| Backward                  | 10.672 ms                 | 13.581 ms                 |
| Optimize                  | 2.552 ms                  | 5.306 ms                  |
| BarrierTimeBeforeRank0    | 129.230 us                | 53.980 ms                 |
| AfterBackward             | 23.821 ms                 | 46.457 ms                 |
| BlockToStepN              | 9.474 ms                  | 430.334 ms                |
| OneStep                   | 155.886 ms                | 558.143 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:38.270169 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 22:16:38.404242 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240129 22:16:39.291985 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:16:39.404006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240129 22:16:40.404006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240129 22:16:40.550979 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.572 ms                  | 6.328 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 5.246 ms                  |
| ProcessBack:UpsertPq      | 16.008 ms                 | 34.254 ms                 |
| ProcessOneStep            | 23.835 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 419.953 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:41.404003 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240129 22:16:41.653750 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 22:16:42.404006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240129 22:16:42.660521 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.524 ms                  | 105.087 ms                |
| Forward                   | 4.696 ms                  | 9.689 ms                  |
| Backward                  | 10.682 ms                 | 13.502 ms                 |
| Optimize                  | 2.535 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 54.534 us                 | 52.276 ms                 |
| AfterBackward             | 23.813 ms                 | 43.954 ms                 |
| BlockToStepN              | 9.474 ms                  | 420.031 ms                |
| OneStep                   | 155.886 ms                | 551.377 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:43.404003 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240129 22:16:43.960912 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 22:16:44.447439 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240129 22:16:44.988912 32150 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 22:16:45.478843 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=376, pq.top=376
W20240129 22:16:45.990914 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.569 ms                  | 6.188 ms                  |
| ProcessBack:UpdateCache   | 2.582 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 16.008 ms                 | 33.983 ms                 |
| ProcessOneStep            | 23.756 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 419.953 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:46.478005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240129 22:16:47.222344 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 22:16:47.478005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240129 22:16:48.242098 32150 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.445 ms                  | 105.087 ms                |
| Forward                   | 4.707 ms                  | 9.689 ms                  |
| Backward                  | 10.698 ms                 | 13.502 ms                 |
| Optimize                  | 2.535 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 54.720 us                 | 52.276 ms                 |
| AfterBackward             | 23.758 ms                 | 43.954 ms                 |
| BlockToStepN              | 9.474 ms                  | 420.031 ms                |
| OneStep                   | 155.886 ms                | 551.377 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:48.478003 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240129 22:16:49.252173 32150 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 22:16:49.478003 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=395, pq.top=395
[proc 1] 400 steps, total: 22.658, sample: 1.084, forward: 0.472, backward: 1.037, update: 0.217
[proc 0] 400 steps, total: 22.658, sample: 1.163, forward: 0.493, backward: 1.071, update: 0.268
[proc 2] 400 steps, total: 22.658, sample: 1.086, forward: 0.470, backward: 0.946, update: 0.236
[proc 3] 400 steps, total: 22.658, sample: 1.576, forward: 0.481, backward: 0.566, update: 0.221
W20240129 22:16:50.280802 32150 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 22:16:50.478006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=403, pq.top=403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.562 ms                  | 6.188 ms                  |
| ProcessBack:UpdateCache   | 2.562 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 15.897 ms                 | 33.983 ms                 |
| ProcessOneStep            | 23.724 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 419.953 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:51.322660 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:16:51.478006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240129 22:16:52.374483 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:16:52.478003 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=413, pq.top=413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.303 ms                  | 105.087 ms                |
| Forward                   | 4.697 ms                  | 9.689 ms                  |
| Backward                  | 10.698 ms                 | 13.502 ms                 |
| Optimize                  | 2.531 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 46.137 us                 | 52.276 ms                 |
| AfterBackward             | 23.736 ms                 | 43.954 ms                 |
| BlockToStepN              | 9.474 ms                  | 420.031 ms                |
| OneStep                   | 155.886 ms                | 551.377 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:53.478004 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240129 22:16:53.498584 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:16:54.512414 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:16:54.573690 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240129 22:16:55.523933 32150 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 22:16:55.573004 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.551 ms                  | 5.495 ms                  |
| ProcessBack:UpdateCache   | 2.526 ms                  | 4.236 ms                  |
| ProcessBack:UpsertPq      | 15.782 ms                 | 33.810 ms                 |
| ProcessOneStep            | 23.659 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 419.953 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:56.573007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240129 22:16:56.583786 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:16:57.573006 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240129 22:16:57.655395 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.219 ms                  | 105.087 ms                |
| Forward                   | 4.697 ms                  | 9.689 ms                  |
| Backward                  | 10.697 ms                 | 13.502 ms                 |
| Optimize                  | 2.531 ms                  | 5.285 ms                  |
| BarrierTimeBeforeRank0    | 45.188 us                 | 53.980 ms                 |
| AfterBackward             | 23.656 ms                 | 43.954 ms                 |
| BlockToStepN              | 9.474 ms                  | 420.031 ms                |
| OneStep                   | 155.886 ms                | 551.377 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:16:58.594955 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240129 22:16:58.694615 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240129 22:16:59.603984 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240129 22:16:59.716441 32150 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 22:17:00.603008 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240129 22:17:00.741895 32150 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.549 ms                  | 6.188 ms                  |
| ProcessBack:UpdateCache   | 2.516 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 15.738 ms                 | 33.983 ms                 |
| ProcessOneStep            | 23.659 ms                 | 43.921 ms                 |
| BlockToStepN              | 9.436 ms                  | 419.639 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:17:01.603005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240129 22:17:01.763515 32150 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 22:17:02.603005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240129 22:17:02.785027 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.138 ms                  | 104.423 ms                |
| Forward                   | 4.691 ms                  | 8.173 ms                  |
| Backward                  | 10.671 ms                 | 13.110 ms                 |
| Optimize                  | 2.533 ms                  | 5.273 ms                  |
| BarrierTimeBeforeRank0    | 49.244 us                 | 53.980 ms                 |
| AfterBackward             | 23.656 ms                 | 44.297 ms                 |
| BlockToStepN              | 24.366 ms                 | 419.714 ms                |
| OneStep                   | 155.886 ms                | 544.549 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:17:03.643352 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=472, pq.top=472
W20240129 22:17:03.805482 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:17:04.643005 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240129 22:17:04.946918 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:17:05.643007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240129 22:17:05.955929 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.546 ms                  | 6.180 ms                  |
| ProcessBack:UpdateCache   | 2.498 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 15.668 ms                 | 34.254 ms                 |
| ProcessOneStep            | 23.618 ms                 | 46.430 ms                 |
| BlockToStepN              | 12.245 ms                 | 419.639 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:17:06.643007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240129 22:17:07.322122 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:17:07.643007 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=489, pq.top=489
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.097 ms                  | 104.423 ms                |
| Forward                   | 4.685 ms                  | 8.173 ms                  |
| Backward                  | 10.672 ms                 | 13.110 ms                 |
| Optimize                  | 2.525 ms                  | 5.273 ms                  |
| BarrierTimeBeforeRank0    | 54.720 us                 | 53.980 ms                 |
| AfterBackward             | 23.644 ms                 | 46.457 ms                 |
| BlockToStepN              | 24.366 ms                 | 419.714 ms                |
| OneStep                   | 155.886 ms                | 544.549 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 22:17:08.333684 32150 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 22:17:08.689376 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240129 22:17:09.582783 32150 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 22:17:09.730829 31850 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 0] 500 steps, total: 20.106, sample: 0.979, forward: 0.466, backward: 1.056, update: 0.277
[proc 1] 500 steps, total: 20.106, sample: 0.879, forward: 0.448, backward: 1.019, update: 0.190
Successfully xmh. training takes 117.04761362075806 seconds
before call kg_cache_controller.StopThreads()
[proc 2] 500 steps, total: 20.106, sample: 1.028, forward: 0.455, backward: 0.957, update: 0.246
[proc 3] 500 steps, total: 20.106, sample: 1.418, forward: 0.473, backward: 1.006, update: 0.231
W20240129 22:17:10.166131 31850 grad_async_v1.h:230] call StopThreads. PID = 30691
W20240129 22:17:10.166158 31850 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 22:17:10.171989 31850 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 22:17:10.172003 31850 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 22:17:10.187301 31850 grad_async_v1.h:251] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.543 ms                  | 6.180 ms                  |
| ProcessBack:UpdateCache   | 2.490 ms                  | 4.587 ms                  |
| ProcessBack:UpsertPq      | 15.694 ms                 | 34.254 ms                 |
| ProcessOneStep            | 23.622 ms                 | 46.430 ms                 |
| BlockToStepN              | 52.833 ms                 | 419.639 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.076 ms                  | 104.423 ms                |
| Forward                   | 4.686 ms                  | 8.720 ms                  |
| Backward                  | 10.683 ms                 | 13.110 ms                 |
| Optimize                  | 2.531 ms                  | 5.273 ms                  |
| BarrierTimeBeforeRank0    | 54.534 us                 | 53.980 ms                 |
| AfterBackward             | 23.653 ms                 | 46.457 ms                 |
| BlockToStepN              | 52.883 ms                 | 419.714 ms                |
| OneStep                   | 155.886 ms                | 544.549 ms                |
+---------------------------+---------------------------+---------------------------+
