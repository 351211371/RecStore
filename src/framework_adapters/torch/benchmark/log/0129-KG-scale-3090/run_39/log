WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 13:56:49.163095  3839 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_43', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='None', use_my_emb=False, cache_ratio=0.05, shuffle=False, backwardMode='CppSync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [3839 sampler.py:454] Start PreSampling
WARNING [3839 sampler.py:532] Before construct renumbering_dict
WARNING [3839 sampler.py:555] PreSampling done
W20240129 13:56:53.853507  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 13:56:53.853747  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 13:56:53.853791  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 13:56:53.853821  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 13:56:53.853853  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 13:56:53.853881  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 13:56:53.853914  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 13:56:53.853960  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 13:56:53.853993  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 13:56:53.854041  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 13:56:53.854096  3839 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 13:56:53.854122  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 13:56:53.854156  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 13:56:53.854324  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 13:56:53.854368  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 13:56:53.854411  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 13:56:53.854450  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 13:56:53.854475  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 13:56:53.854501  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 13:56:53.854523  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 13:56:53.854547  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 13:56:53.854574  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 13:56:53.854605  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 13:56:53.854631  3839 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 13:56:53.854653  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 13:56:53.854674  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 13:56:53.854732  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 13:56:53.854760  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 13:56:53.854794  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 13:56:53.854835  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 13:56:53.854868  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 13:56:53.854905  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 13:56:53.854931  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 13:56:53.854971  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 13:56:53.854996  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 13:56:53.855043  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 13:56:53.855068  3839 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 13:56:53.855089  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 13:56:53.855109  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 13:56:53.855160  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 13:56:53.855188  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 13:56:53.855221  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 13:56:53.855244  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 13:56:53.855273  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 13:56:53.855296  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 13:56:53.855325  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 13:56:53.855356  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 13:56:53.855384  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 13:56:53.855412  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 13:56:53.855434  3839 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 13:56:53.855456  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 13:56:53.855484  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 13:56:53.855551  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 13:56:53.855588  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 13:56:53.855613  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 13:56:53.855638  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 13:56:53.855670  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 13:56:53.855695  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 13:56:53.855718  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 13:56:53.855775  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 13:56:53.855818  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 13:56:53.855860  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 13:56:53.855890  3839 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 13:56:53.855912  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 13:56:53.855940  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 13:56:53.855988  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 13:56:53.856019  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 13:56:53.856062  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 13:56:53.856109  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 13:56:53.856135  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 13:56:53.856159  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 13:56:53.856189  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 13:56:53.856220  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 13:56:53.856251  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 13:56:53.856285  3839 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 13:56:53.856309  3839 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 13:56:53.856330  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 13:56:53.856359  3839 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  954,  1238,  1443,  ...,  2625,  2160, 11771]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.991 seconds
[Rank1] pid = 4155
[Rank2] pid = 4184
[Rank3] pid = 4283
[Rank4] pid = 4349
INFO [3839 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [4184 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [4155 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [4283 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [4369 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [4349 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [4283 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [4369 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [4349 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [4184 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [4155 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [3839 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
E20240129 13:56:56.382514  4350 recstore.cc:66] init folly done
E20240129 13:56:56.382594  4284 recstore.cc:66] init folly done
E20240129 13:56:56.382745  4220 recstore.cc:66] init folly done
E20240129 13:56:56.382797  4156 recstore.cc:66] init folly done
E20240129 13:56:56.382741  4415 recstore.cc:66] init folly done
E20240129 13:56:56.382871  4426 recstore.cc:66] init folly done
I20240129 13:56:56.467387  4415 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240129 13:56:56.469918  4220 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 13:56:56.475070  4156 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 13:56:56.476449  4284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 13:56:56.479700  4426 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 13:56:56.481117  4350 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
[Rank5] pid = 4369
train_sampler.Prefill()
-------Step 0-------
tensor([   98,  8340,  8966,   943, 11590,  7170,   121,  8903, 10208,  2974]) tensor([ 1443,   115,  4822,  9252,   107, 10887, 14136, 13647,  1215,  9437])
-------Step 1-------
tensor([   98,  8340,  8966,   943, 11590,  7170,   121,  8903, 10208,  2974]) tensor([ 8787,  4728,   391,  7503,  5004,  8843,  1706, 10910, 14813,  9823])
-------Step 2-------
tensor([ 1211,  3715, 11590,  5869, 10119, 14375,     2, 14071, 12520,  4926]) tensor([ 6097, 14243,  5874, 12596,  8403,  8870,  7077,  3648,  2123, 11893])
-------Step 3-------
tensor([ 1211,  3715, 11590,  5869, 10119, 14375,     2, 14071, 12520,  4926]) tensor([ 5667,  4282,  2525, 10645,  5466,   471,  7499,  4563,   206,  2893])
-------Step 4-------
tensor([   64,  5670, 10690,  8376, 10564,  2002, 11590,  6038,  7458, 12291]) tensor([ 3074,  4842,  2231,  1240,  8380, 11494,  7104,  7076, 14355,  3058])
-------Step 5-------
tensor([   64,  5670, 10690,  8376, 10564,  2002, 11590,  6038,  7458, 12291]) tensor([ 6672, 12602,   604, 11400,  5207,  8139,  8740,   516,  9980,  2247])
-------Step 6-------
tensor([ 4436, 14734, 14157,  2331,  4091,   130,    51, 10975,    64,   106]) tensor([ 7279,  5858,  2546,  8808,  1055,   447,  2813, 12668,  1909,  5014])
-------Step 7-------
tensor([ 4436, 14734, 14157,  2331,  4091,   130,    51, 10975,    64,   106]) tensor([ 8274,   270,  9170,  5523, 13916,  8879, 11558,  8349,  5635,  5451])
-------Step 8-------
tensor([3658, 3669, 1351,  732, 3895, 1589, 6287,  114, 6155,   51]) tensor([12893,  2322,  1770,  9895, 13289,  6455,  9545,  7136,  2773, 11653])
-------Step 9-------
tensor([3658, 3669, 1351,  732, 3895, 1589, 6287,  114, 6155,   51]) tensor([ 9805, 12272,  9776, 10517,  2424,  8526,   456,  6402,  6133,  2427])
before start barrier
start train
[proc 0] 100 steps, total: 3.974, sample: 0.446, forward: 1.421, backward: 0.772, update: 0.845
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 3.965, sample: 0.451, forward: 1.413, backward: 0.761, update: 0.910
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 3.971, sample: 0.511, forward: 1.377, backward: 0.752, update: 0.864
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 3.961, sample: 0.450, forward: 1.377, backward: 0.768, update: 0.900
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 3.960, sample: 0.460, forward: 1.407, backward: 0.651, update: 0.873
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 3.966, sample: 0.444, forward: 1.387, backward: 0.772, update: 0.907
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.428 ms                  | 37.047 ms                 |
| Forward                   | 8.844 ms                  | 19.040 ms                 |
| Backward                  | 5.975 ms                  | 16.956 ms                 |
| Optimize                  | 8.117 ms                  | 13.337 ms                 |
| OneStep                   | 29.687 ms                 | 68.919 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 4.525, sample: 0.579, forward: 0.969, backward: 0.612, update: 1.023
[proc 2] 200 steps, total: 4.525, sample: 0.615, forward: 0.943, backward: 0.600, update: 0.941
[proc 3] 200 steps, total: 4.525, sample: 0.530, forward: 0.964, backward: 0.462, update: 0.986
[proc 0] 200 steps, total: 4.525, sample: 0.598, forward: 1.092, backward: 0.609, update: 0.909
[proc 1] 200 steps, total: 4.525, sample: 0.582, forward: 0.948, backward: 0.609, update: 1.010
[proc 4] 200 steps, total: 4.525, sample: 0.569, forward: 0.972, backward: 0.605, update: 1.022
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.774 ms                  | 38.988 ms                 |
| Forward                   | 9.326 ms                  | 20.708 ms                 |
| Backward                  | 6.021 ms                  | 15.958 ms                 |
| Optimize                  | 8.522 ms                  | 17.048 ms                 |
| OneStep                   | 35.036 ms                 | 68.919 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 4.372, sample: 0.645, forward: 0.906, backward: 0.603, update: 0.969
[proc 2] 300 steps, total: 4.372, sample: 0.564, forward: 0.898, backward: 0.602, update: 0.910
[proc 1] 300 steps, total: 4.371, sample: 0.549, forward: 0.914, backward: 0.607, update: 0.958
[proc 3] 300 steps, total: 4.372, sample: 0.598, forward: 0.956, backward: 0.614, update: 1.024
[proc 4] 300 steps, total: 4.371, sample: 0.539, forward: 0.915, backward: 0.504, update: 0.943
[proc 0] 300 steps, total: 4.372, sample: 0.545, forward: 1.082, backward: 0.598, update: 0.945
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.846 ms                  | 39.554 ms                 |
| Forward                   | 9.542 ms                  | 20.708 ms                 |
| Backward                  | 6.025 ms                  | 11.649 ms                 |
| Optimize                  | 8.596 ms                  | 16.661 ms                 |
| OneStep                   | 36.001 ms                 | 69.257 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 4.274, sample: 0.572, forward: 0.907, backward: 0.591, update: 0.920
[proc 3] 400 steps, total: 4.274, sample: 0.628, forward: 0.937, backward: 0.602, update: 0.993
[proc 0] 400 steps, total: 4.274, sample: 0.595, forward: 1.044, backward: 0.596, update: 0.933
[proc 5] 400 steps, total: 4.275, sample: 0.594, forward: 0.920, backward: 0.609, update: 1.022
[proc 4] 400 steps, total: 4.274, sample: 0.562, forward: 0.891, backward: 0.607, update: 0.971
[proc 1] 400 steps, total: 4.274, sample: 0.495, forward: 0.923, backward: 0.676, update: 0.987
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.932 ms                  | 39.554 ms                 |
| Forward                   | 9.737 ms                  | 20.708 ms                 |
| Backward                  | 6.025 ms                  | 10.805 ms                 |
| Optimize                  | 8.766 ms                  | 15.844 ms                 |
| OneStep                   | 41.630 ms                 | 69.257 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 4.460, sample: 0.571, forward: 0.916, backward: 0.608, update: 1.024
[proc 2] 500 steps, total: 4.461, sample: 0.535, forward: 0.930, backward: 0.591, update: 0.944
[proc 5] 500 steps, total: 4.460, sample: 0.531, forward: 0.968, backward: 0.617, update: 1.077
[proc 4] 500 steps, total: 4.460, sample: 0.584, forward: 0.911, backward: 0.608, update: 0.992
[proc 1] 500 steps, total: 4.460, sample: 0.566, forward: 0.921, backward: 0.694, update: 0.995
[proc 0] 500 steps, total: 4.460, sample: 0.510, forward: 1.134, backward: 0.592, update: 0.938
Successfully xmh. training takes 21.606597661972046 seconds
before call kg_cache_controller.StopThreads()
KGCacheControllerWrapperDummy.StopThreads
