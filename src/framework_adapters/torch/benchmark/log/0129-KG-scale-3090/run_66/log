WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 23:44:19.626314 51082 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_18', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [51082 sampler.py:454] Start PreSampling
WARNING [51082 sampler.py:532] Before construct renumbering_dict
WARNING [51082 sampler.py:555] PreSampling done
W20240130 00:04:58.694046 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 00:04:58.694254 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 00:04:58.694293 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 00:04:58.694329 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 00:04:58.694370 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 00:04:58.694401 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 00:04:58.694432 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 00:04:58.694494 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 00:04:58.694535 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 00:04:58.694566 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 00:04:58.694602 51082 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 00:04:58.694636 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 00:04:58.694669 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 00:04:58.694829 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 00:04:58.694869 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 00:04:58.694895 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 00:04:58.694936 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 00:04:58.694970 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 00:04:58.694998 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 00:04:58.695037 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 00:04:58.695075 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 00:04:58.695107 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 00:04:58.695140 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 00:04:58.695165 51082 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 00:04:58.695188 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 00:04:58.695209 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 00:04:58.695261 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 00:04:58.695294 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 00:04:58.695329 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 00:04:58.695356 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 00:04:58.695389 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 00:04:58.695415 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 00:04:58.695447 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 00:04:58.695482 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 00:04:58.695509 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 00:04:58.695538 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 00:04:58.695570 51082 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 00:04:58.695593 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 00:04:58.695616 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 00:04:58.695672 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 00:04:58.695699 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 00:04:58.695734 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 00:04:58.695770 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 00:04:58.695801 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 00:04:58.695837 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 00:04:58.695875 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 00:04:58.695901 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 00:04:58.695935 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 00:04:58.695969 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 00:04:58.695997 51082 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 00:04:58.696019 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 00:04:58.696043 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 00:04:58.696127 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 00:04:58.696163 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 00:04:58.696192 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 00:04:58.696221 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 00:04:58.696255 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 00:04:58.696291 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 00:04:58.696319 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 00:04:58.696349 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 00:04:58.696379 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 00:04:58.696408 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 00:04:58.696439 51082 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 00:04:58.696462 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 00:04:58.696485 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 00:04:58.696537 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 00:04:58.696581 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 00:04:58.696615 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 00:04:58.696645 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 00:04:58.696682 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 00:04:58.696712 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 00:04:58.696741 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 00:04:58.696770 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 00:04:58.696805 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 00:04:58.696833 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 00:04:58.696869 51082 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 00:04:58.696893 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 00:04:58.696921 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 00:04:58.696990 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240130 00:04:58.697026 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240130 00:04:58.697057 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240130 00:04:58.697088 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240130 00:04:58.697118 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240130 00:04:58.697167 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240130 00:04:58.697197 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240130 00:04:58.697234 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240130 00:04:58.697265 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240130 00:04:58.697296 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240130 00:04:58.697333 51082 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240130 00:04:58.697357 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240130 00:04:58.697381 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240130 00:04:58.697429 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240130 00:04:58.697464 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240130 00:04:58.697496 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240130 00:04:58.697531 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240130 00:04:58.697563 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240130 00:04:58.697590 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240130 00:04:58.697624 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240130 00:04:58.697657 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240130 00:04:58.697688 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240130 00:04:58.697716 51082 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240130 00:04:58.697743 51082 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240130 00:04:58.697767 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240130 00:04:58.697789 51082 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240130 00:04:59.212819 51082 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240130 00:04:59.212981 51082 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605418,  8605444,    71702,  ..., 60698090, 63893179,  9416218]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1749.254 seconds
[Rank1] pid = 51984
[Rank2] pid = 52080
[Rank3] pid = 52149
[Rank4] pid = 52216
[Rank5] pid = 52283
[Rank6] pid = 52350
INFO [51082 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51984 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52080 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52149 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52216 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52283 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52419 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [52350 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52419 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52350 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52283 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52080 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52149 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [52216 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240130 00:13:40.679018 52150 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240130 00:13:40.679075 52483 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240130 00:13:40.679085 52351 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240130 00:13:40.679077 52284 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240130 00:13:40.679092 52081 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240130 00:13:40.679569 52217 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
INFO [51082 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51984 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240130 00:13:40.685365 52420 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240130 00:13:40.687032 51985 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240130 00:13:40.809726 52483 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497ab000 7.629 MB
W20240130 00:13:40.809748 52351 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102049f4e000 7.629 MB
W20240130 00:13:40.809842 52081 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204a6f1000 7.629 MB
W20240130 00:13:40.809854 52217 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204ae94000 7.629 MB
W20240130 00:13:40.809895 52284 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204b637000 7.629 MB
W20240130 00:13:40.835000 52483 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204bdda000 7.629 MB
W20240130 00:13:40.835103 52351 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204c581000 7.629 MB
W20240130 00:13:40.835124 52081 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204cd24000 7.629 MB
W20240130 00:13:40.835130 52483 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204d4c7000 1.49 GB
W20240130 00:13:40.835191 51985 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020acaaa000 7.629 MB
W20240130 00:13:40.835207 52483 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1020ad24d000 1.49 GB
W20240130 00:13:40.835235 52081 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10210cfd3000 1.49 GB
W20240130 00:13:40.835233 52284 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210c830000 7.629 MB
W20240130 00:13:40.835276 52150 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10216c5b6000 7.629 MB
W20240130 00:13:40.835294 52081 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10216d4fc000 1.49 GB
W20240130 00:13:40.835294 52217 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10216cd59000 7.629 MB
W20240130 00:13:40.835346 52081 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 00:13:40.835371 51985 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10222c0c2000 7.629 MB
W20240130 00:13:40.835356 52351 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1021ccadf000 1.49 GB
W20240130 00:13:40.835383 52483 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 00:13:40.835428 52150 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10222c865000 7.629 MB
W20240130 00:13:40.835470 51985 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10228c5eb000 1.49 GB
W20240130 00:13:40.835466 52284 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222d008000 1.49 GB
W20240130 00:13:40.835512 52150 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1022ebbce000 1.49 GB
W20240130 00:13:40.835526 52351 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10234b1b1000 1.49 GB
W20240130 00:13:40.835551 51985 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1023aa794000 1.49 GB
W20240130 00:13:40.835582 52150 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102409d77000 1.49 GB
W20240130 00:13:40.835597 51985 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 00:13:40.835611 52217 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10246935a000 1.49 GB
W20240130 00:13:40.835649 52150 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 00:13:40.835661 52284 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1024c893d000 1.49 GB
W20240130 00:13:40.835716 52351 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 00:13:40.835762 52217 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102527f20000 1.49 GB
W20240130 00:13:40.835819 52284 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 00:13:40.835896 52217 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 00:13:40.836988 52420 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102587505000 7.629 MB
W20240130 00:13:40.837098 52420 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102587ca8000 7.629 MB
W20240130 00:13:40.837170 52420 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10258844b000 1.49 GB
W20240130 00:13:40.837217 52420 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240130 00:13:40.837280 52420 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 00:13:40.856544 52081 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 00:13:40.856590 52150 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 00:13:40.856595 52420 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 00:13:40.856601 52483 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 00:13:40.856608 52284 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 00:13:40.856626 52351 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 00:13:40.856635 51985 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 00:13:40.856631 52217 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [52283 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [52350 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [51984 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [52149 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [52216 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [52419 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [52080 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 52419
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [51082 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 00:14:33.008298 52420 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.008430 52081 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.008467 52217 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.008510 52483 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.008601 52351 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.009070 52284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.009275 51985 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:14:33.009338 52150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240130 00:14:33.010851 52420 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240130 00:14:33.010987 52420 grad_base.h:184] Init GradProcessingBase done
I20240130 00:14:45.861860 52420 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240130 00:14:45.862170 52420 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 00:14:45.862181 52420 kg_controller.h:84] Construct KGCacheController done
E20240130 00:14:47.625221 51985 recstore.cc:66] init folly done
E20240130 00:14:47.625221 52284 recstore.cc:66] init folly done
E20240130 00:14:47.625576 52150 recstore.cc:66] init folly done
E20240130 00:14:47.625764 52081 recstore.cc:66] init folly done
E20240130 00:14:47.626025 52483 recstore.cc:66] init folly done
E20240130 00:14:47.626050 52217 recstore.cc:66] init folly done
E20240130 00:14:47.626556 52351 recstore.cc:66] init folly done
E20240130 00:14:47.626565 52420 recstore.cc:66] init folly done
I20240130 00:14:47.627626 52420 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 00:15:06.550561 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 00:15:06.550915 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:07.892799 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 00:15:07.892925 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:09.142056 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 00:15:09.142179 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240130 00:15:09.577121 52217 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
E20240130 00:15:10.142011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 00:15:12.693390 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:12.706555 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 00:15:12.903532 52483 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:15:12.903806 52284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 00:15:13.867344 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 00:15:13.867447 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:14.920184 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:14.935453 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 00:15:15.135290 52081 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 00:15:16.549971 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:16.574533 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240130 00:15:16.741829 51985 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:15:17.080849 52420 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 00:15:21.550899 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:21.564750 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 00:15:21.737619 52351 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 00:15:24.194927 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:24.213423 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 00:15:24.430900 52150 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 445.270 ms                | 487.933 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:27.680814 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 24.836 ms                 | 24.836 ms                 |
| Forward                   | 935.071 ms                | 935.071 ms                |
| Backward                  | 235.089 ms                | 235.089 ms                |
| Optimize                  | 2.624 ms                  | 2.624 ms                  |
| BarrierTimeBeforeRank0    | 296.187 ms                | 296.187 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:28.185784 52420 grad_async_v2.h:237] pq is empty
W20240130 00:15:28.195111 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:15:28.680008 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=4089
W20240130 00:15:28.833112 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240130 00:15:29.097132 52420 grad_async_v2.h:237] pq is empty
W20240130 00:15:29.295277 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 00:15:29.681602 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 00:15:30.113839 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240130 00:15:30.296551 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end8
W20240130 00:15:30.433204 52420 grad_async_v2.h:237] pq is empty
E20240130 00:15:30.681017 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=48948
W20240130 00:15:31.360679 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240130 00:15:31.391170 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end3
E20240130 00:15:31.681286 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:32.457998 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240130 00:15:32.622205 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.469 ms                  | 487.933 ms                |
| ProcessBack:UpdateCache   | 13.816 ms                 | 961.515 ms                |
| ProcessBack:UpsertPq      | 80.065 ms                 | 502.590 ms                |
| ProcessOneStep            | 124.018 ms                | 2.257 s                   |
| BlockToStepN              | 95.350 us                 | 155.521 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:32.681007 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.447 ms                 | 135.991 ms                |
| Forward                   | 5.313 ms                  | 935.071 ms                |
| Backward                  | 4.589 ms                  | 235.089 ms                |
| Optimize                  | 2.311 ms                  | 38.310 ms                 |
| BarrierTimeBeforeRank0    | 4.844 ms                  | 296.187 ms                |
| AfterBackward             | 117.265 ms                | 2.260 s                   |
| BlockToStepN              | 210.794 us                | 155.623 ms                |
| OneStep                   | 228.873 ms                | 3.756 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:33.691123 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:33.760385 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end4
W20240130 00:15:34.624732 52420 grad_async_v2.h:237] pq is empty
E20240130 00:15:34.691013 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=4771
W20240130 00:15:34.752328 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240130 00:15:34.777055 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 00:15:35.691011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=51132
W20240130 00:15:35.781745 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
W20240130 00:15:35.784583 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=30, pq.top=30
E20240130 00:15:36.691011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=32344
W20240130 00:15:36.846994 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240130 00:15:36.880934 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.469 ms                  | 445.270 ms                |
| ProcessBack:UpdateCache   | 12.962 ms                 | 961.432 ms                |
| ProcessBack:UpsertPq      | 50.283 ms                 | 275.045 ms                |
| ProcessOneStep            | 93.129 ms                 | 2.257 s                   |
| BlockToStepN              | 7.798 ms                  | 155.521 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:37.691006 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=49164
W20240130 00:15:37.866595 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=40, pq.top=40
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.444 ms                 | 295.066 ms                |
| Forward                   | 5.409 ms                  | 935.071 ms                |
| Backward                  | 4.575 ms                  | 235.089 ms                |
| Optimize                  | 2.296 ms                  | 38.310 ms                 |
| BarrierTimeBeforeRank0    | 3.587 ms                  | 296.187 ms                |
| AfterBackward             | 91.142 ms                 | 2.260 s                   |
| BlockToStepN              | 7.877 ms                  | 155.623 ms                |
| OneStep                   | 228.873 ms                | 3.756 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:38.117928 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
E20240130 00:15:38.691009 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=35097
W20240130 00:15:38.922045 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240130 00:15:39.283350 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240130 00:15:39.701579 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:40.260655 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=50, pq.top=50
W20240130 00:15:40.300952 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 00:15:40.701011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=24002
W20240130 00:15:41.260038 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240130 00:15:41.340061 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 00:15:41.701010 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=43837
W20240130 00:15:42.269183 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240130 00:15:42.425103 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.344 ms                  | 445.270 ms                |
| ProcessBack:UpdateCache   | 11.247 ms                 | 961.432 ms                |
| ProcessBack:UpsertPq      | 33.611 ms                 | 275.045 ms                |
| ProcessOneStep            | 78.832 ms                 | 1.113 s                   |
| BlockToStepN              | 29.837 ms                 | 124.728 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:42.701011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=37477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.976 ms                 | 255.004 ms                |
| Forward                   | 5.533 ms                  | 11.519 ms                 |
| Backward                  | 4.627 ms                  | 5.465 ms                  |
| Optimize                  | 2.295 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 49.560 us                 | 148.296 ms                |
| AfterBackward             | 78.389 ms                 | 1.113 s                   |
| BlockToStepN              | 29.960 ms                 | 143.372 ms                |
| OneStep                   | 218.258 ms                | 1.241 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:43.269075 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=66, pq.top=66
W20240130 00:15:43.573671 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end8
E20240130 00:15:43.701009 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=7367
W20240130 00:15:44.415078 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=71, pq.top=71
E20240130 00:15:44.701012 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=10110
W20240130 00:15:44.729547 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end3
W20240130 00:15:45.496090 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=76, pq.top=76
E20240130 00:15:45.701009 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=45084
W20240130 00:15:45.843384 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end8
E20240130 00:15:46.701012 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=785
W20240130 00:15:46.964315 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end2
W20240130 00:15:47.513475 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.332 ms                  | 68.150 ms                 |
| ProcessBack:UpdateCache   | 11.139 ms                 | 54.775 ms                 |
| ProcessBack:UpsertPq      | 29.536 ms                 | 243.905 ms                |
| ProcessOneStep            | 77.338 ms                 | 1.113 s                   |
| BlockToStepN              | 54.512 ms                 | 156.942 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:47.701012 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=516
W20240130 00:15:47.969405 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.118 ms                 | 255.004 ms                |
| Forward                   | 5.527 ms                  | 11.519 ms                 |
| Backward                  | 4.627 ms                  | 5.557 ms                  |
| Optimize                  | 2.295 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 52.165 us                 | 148.296 ms                |
| AfterBackward             | 77.378 ms                 | 1.113 s                   |
| BlockToStepN              | 54.675 ms                 | 196.402 ms                |
| OneStep                   | 218.258 ms                | 1.241 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:48.513026 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=87, pq.top=87
E20240130 00:15:48.704221 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:15:48.975139 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end0
W20240130 00:15:49.603134 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240130 00:15:49.704012 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=39539
W20240130 00:15:50.021983 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
E20240130 00:15:50.704010 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1729
W20240130 00:15:50.772284 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 38.057, sample: 1.608, forward: 1.513, backward: 0.780, update: 0.267
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 29.223, sample: 1.581, forward: 1.367, backward: 0.833, update: 0.256
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 38.058, sample: 2.183, forward: 1.479, backward: 0.821, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.530, sample: 1.579, forward: 1.785, backward: 0.773, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 41.384, sample: 1.644, forward: 1.382, backward: 0.784, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 35.826, sample: 1.670, forward: 1.716, backward: 0.750, update: 0.242
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 34.219, sample: 1.733, forward: 1.601, backward: 0.737, update: 0.242
train_sampler.Prefill()
-------Step 0-------
tensor([  213427,   213456,   213496,   213525, 10178931,  1060907, 60694596,
        21801984, 23095964,   213555]) tensor([ 9466952, 19470980, 59366453, 74204093, 22432853, 36115479, 36562085,
        73498570, 70514215, 30124778])
-------Step 1-------
tensor([  213427,   213456,   213496,   213525, 10178931,  1060907, 60694596,
        21801984, 23095964,   213555]) tensor([ 3648418, 28390447, 14238893, 79825171, 81991119, 47677863, 72236330,
        49447905, 38999370, 17407478])
-------Step 2-------
tensor([  293230,   293263,   293293,   314326,   293320,   293371, 85826095,
        31367672,   293395,   293427]) tensor([72361231, 29284199, 81314434, 50098325, 47647085, 29330291, 73272806,
        39540769, 17133428, 46751897])
-------Step 3-------
tensor([  293230,   293263,   293293,   314326,   293320,   293371, 85826095,
        31367672,   293395,   293427]) tensor([49594303, 82446538, 37098443, 42495641, 66298298, 64444136, 42754864,
        20516690, 27686752,  1565476])
-------Step 4-------
tensor([  371381, 47647950,   371421,  1068395,   371458,  1068403,   371491,
        44155124,   371526,   371545]) tensor([78850845, 14078696, 81458777, 20503218, 69135878, 46589788, 66539846,
        41796630, 73624036, 51056577])
-------Step 5-------
tensor([  371381, 47647950,   371421,  1068395,   371458,  1068403,   371491,
        44155124,   371526,   371545]) tensor([36092278,  1430582,   705854, 85716285, 59512047, 53059922, 17685493,
        14525976, 68017910, 40257734])
-------Step 6-------
tensor([  450338,   346651, 36468021,   450378, 32922433, 74504717,   450401,
          450440, 50380815, 40737722]) tensor([16306171, 40098339, 39780104, 81449446, 34478504, 36605586, 30508390,
        11148785, 69058687, 71783067])
-------Step 7-------
tensor([  450338,   346651, 36468021,   450378, 32922433, 74504717,   450401,
          450440, 50380815, 40737722]) tensor([30228275, 51807677, 71068923, 65849939, 85568256, 49912600, 52063741,
        56000220, 37813158,   815668])
-------Step 8-------
tensor([  527613, 29499355,   527649,  1073685,   527674,   362321,   527705,
          527755,   527785,   527831]) tensor([47451195, 26374085, 35984575,  3612458, 48895138,   142165, 17764558,
          600896,  3130007, 67404323])
-------Step 9-------
tensor([  527613, 29499355,   527649,  1073685,   527674,   362321,   527705,
          527755,   527785,   527831]) tensor([55151880,  2064186, 19214927, 53790075, 12571848, 44717941,   812388,
        41719958, 78959575, 68528456])
before start barrier
start train
[proc 0] 100 steps, total: 33.880, sample: 3.084, forward: 1.490, backward: 0.695, update: 0.284
W20240130 00:15:51.037596 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
E20240130 00:15:51.704013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=31821
W20240130 00:15:51.896961 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240130 00:15:52.170075 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.437 ms                  | 68.150 ms                 |
| ProcessBack:UpdateCache   | 11.139 ms                 | 54.775 ms                 |
| ProcessBack:UpsertPq      | 35.378 ms                 | 243.905 ms                |
| ProcessOneStep            | 78.270 ms                 | 1.113 s                   |
| BlockToStepN              | 56.583 ms                 | 206.122 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:52.704010 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.630 ms                 | 255.004 ms                |
| Forward                   | 5.541 ms                  | 11.519 ms                 |
| Backward                  | 4.665 ms                  | 5.557 ms                  |
| Optimize                  | 2.311 ms                  | 11.597 ms                 |
| BarrierTimeBeforeRank0    | 53.489 us                 | 148.296 ms                |
| AfterBackward             | 78.307 ms                 | 1.113 s                   |
| BlockToStepN              | 56.712 ms                 | 206.234 ms                |
| OneStep                   | 216.805 ms                | 1.241 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:53.216367 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
W20240130 00:15:53.696784 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=107, pq.top=107
E20240130 00:15:53.705906 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=19986
W20240130 00:15:54.241200 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end0
W20240130 00:15:54.697767 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240130 00:15:54.705024 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=14175
W20240130 00:15:55.408339 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
W20240130 00:15:55.697067 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240130 00:15:55.705004 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=40088
W20240130 00:15:56.435238 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
E20240130 00:15:56.705011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=10755
W20240130 00:15:56.877266 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240130 00:15:57.462275 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.550 ms                  | 68.150 ms                 |
| ProcessBack:UpdateCache   | 11.127 ms                 | 54.775 ms                 |
| ProcessBack:UpsertPq      | 33.859 ms                 | 243.905 ms                |
| ProcessOneStep            | 78.345 ms                 | 1.384 s                   |
| BlockToStepN              | 60.217 ms                 | 218.899 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:15:57.705013 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=41006
W20240130 00:15:57.946341 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.118 ms                 | 295.066 ms                |
| Forward                   | 5.543 ms                  | 11.519 ms                 |
| Backward                  | 4.679 ms                  | 5.557 ms                  |
| Optimize                  | 2.295 ms                  | 11.597 ms                 |
| BarrierTimeBeforeRank0    | 34.692 us                 | 148.296 ms                |
| AfterBackward             | 78.307 ms                 | 1.384 s                   |
| BlockToStepN              | 60.301 ms                 | 219.017 ms                |
| OneStep                   | 216.805 ms                | 1.507 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:15:58.511507 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end0
E20240130 00:15:58.705009 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=4235
W20240130 00:15:58.974994 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240130 00:15:59.671137 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end5
E20240130 00:15:59.705016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=8533
E20240130 00:16:00.705018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 00:16:00.901376 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end6
E20240130 00:16:01.705018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
W20240130 00:16:01.888823 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240130 00:16:01.906961 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.469 ms                  | 44.783 ms                 |
| ProcessBack:UpdateCache   | 11.110 ms                 | 32.576 ms                 |
| ProcessBack:UpsertPq      | 32.774 ms                 | 232.745 ms                |
| ProcessOneStep            | 77.665 ms                 | 1.841 s                   |
| BlockToStepN              | 60.217 ms                 | 234.158 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:02.705009 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=10188
W20240130 00:16:02.888046 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=142, pq.top=141
W20240130 00:16:02.914538 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.388 ms                 | 317.608 ms                |
| Forward                   | 5.541 ms                  | 11.519 ms                 |
| Backward                  | 4.665 ms                  | 5.557 ms                  |
| Optimize                  | 2.311 ms                  | 11.597 ms                 |
| BarrierTimeBeforeRank0    | 33.643 us                 | 148.296 ms                |
| AfterBackward             | 77.701 ms                 | 1.841 s                   |
| BlockToStepN              | 60.301 ms                 | 234.450 ms                |
| OneStep                   | 216.805 ms                | 1.948 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:03.705015 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=33748
W20240130 00:16:03.993520 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
E20240130 00:16:04.705021 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=743
W20240130 00:16:05.154325 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end8
E20240130 00:16:05.705291 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:06.028602 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240130 00:16:06.174764 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end0
E20240130 00:16:06.705011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=22308
W20240130 00:16:07.058382 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240130 00:16:07.187724 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.448 ms                  | 44.783 ms                 |
| ProcessBack:UpdateCache   | 10.946 ms                 | 32.576 ms                 |
| ProcessBack:UpsertPq      | 32.000 ms                 | 232.745 ms                |
| ProcessOneStep            | 77.070 ms                 | 1.841 s                   |
| BlockToStepN              | 60.396 ms                 | 232.124 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:07.705010 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=17146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.388 ms                 | 317.608 ms                |
| Forward                   | 5.543 ms                  | 10.080 ms                 |
| Backward                  | 4.665 ms                  | 5.465 ms                  |
| Optimize                  | 2.322 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 32.796 us                 | 77.773 ms                 |
| AfterBackward             | 77.107 ms                 | 1.841 s                   |
| BlockToStepN              | 67.206 ms                 | 232.233 ms                |
| OneStep                   | 214.689 ms                | 1.948 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:08.058174 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240130 00:16:08.399303 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
E20240130 00:16:08.713157 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:09.669556 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end4
E20240130 00:16:09.713012 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5591
E20240130 00:16:10.713016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1119
W20240130 00:16:10.721172 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end4
W20240130 00:16:10.848595 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=164, pq.top=164
E20240130 00:16:11.718503 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:11.791160 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end8
W20240130 00:16:11.955883 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.432 ms                  | 44.783 ms                 |
| ProcessBack:UpdateCache   | 10.881 ms                 | 32.576 ms                 |
| ProcessBack:UpsertPq      | 30.614 ms                 | 232.745 ms                |
| ProcessOneStep            | 76.695 ms                 | 1.841 s                   |
| BlockToStepN              | 67.091 ms                 | 232.124 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:12.718014 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=18366
W20240130 00:16:12.961091 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
W20240130 00:16:13.011796 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.426 ms                 | 326.730 ms                |
| Forward                   | 5.543 ms                  | 10.080 ms                 |
| Backward                  | 4.679 ms                  | 5.465 ms                  |
| Optimize                  | 2.312 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 33.065 us                 | 77.773 ms                 |
| AfterBackward             | 76.622 ms                 | 1.841 s                   |
| BlockToStepN              | 67.206 ms                 | 232.233 ms                |
| OneStep                   | 211.959 ms                | 1.948 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:13.724457 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:14.139217 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end8
E20240130 00:16:14.724023 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=523
W20240130 00:16:15.173455 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end8
W20240130 00:16:15.331208 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240130 00:16:15.724015 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=102532
W20240130 00:16:16.331096 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240130 00:16:16.370565 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
E20240130 00:16:16.724013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=57154
W20240130 00:16:17.331032 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.431 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.841 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 30.604 ms                 | 208.257 ms                |
| ProcessOneStep            | 76.278 ms                 | 1.841 s                   |
| BlockToStepN              | 60.396 ms                 | 232.140 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:17.710953 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end1
E20240130 00:16:17.724004 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=18386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.444 ms                 | 326.730 ms                |
| Forward                   | 5.566 ms                  | 10.080 ms                 |
| Backward                  | 4.727 ms                  | 5.465 ms                  |
| Optimize                  | 2.332 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 33.643 us                 | 77.773 ms                 |
| AfterBackward             | 76.608 ms                 | 1.841 s                   |
| BlockToStepN              | 65.470 ms                 | 232.264 ms                |
| OneStep                   | 211.722 ms                | 1.948 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:18.733423 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:18.758098 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end2
E20240130 00:16:19.733016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4253
W20240130 00:16:19.800740 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
E20240130 00:16:20.733013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5672
W20240130 00:16:20.854317 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end3
W20240130 00:16:20.867143 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=193, pq.top=193
E20240130 00:16:21.733126 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=9186
W20240130 00:16:21.877328 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end8
W20240130 00:16:22.298319 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.401 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.826 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 30.614 ms                 | 208.257 ms                |
| ProcessOneStep            | 76.582 ms                 | 2.148 s                   |
| BlockToStepN              | 65.359 ms                 | 232.140 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 31.760, sample: 1.233, forward: 0.549, backward: 0.602, update: 0.248
[proc 3] 200 steps, total: 31.760, sample: 1.869, forward: 0.481, backward: 0.611, update: 0.254
[proc 2] 200 steps, total: 31.760, sample: 1.397, forward: 0.503, backward: 0.551, update: 0.223
[proc 7] 200 steps, total: 31.760, sample: 1.634, forward: 0.552, backward: 0.702, update: 0.251
[proc 1] 200 steps, total: 31.760, sample: 1.705, forward: 0.650, backward: 0.528, update: 0.329
[proc 0] 200 steps, total: 31.758, sample: 4.380, forward: 0.550, backward: 0.467, update: 0.263
[proc 5] 200 steps, total: 31.760, sample: 1.460, forward: 0.603, backward: 0.648, update: 0.268
[proc 4] 200 steps, total: 31.760, sample: 1.430, forward: 0.588, backward: 0.652, update: 0.268
E20240130 00:16:22.733148 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=9844
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.888 ms                 | 340.521 ms                |
| Forward                   | 5.566 ms                  | 10.080 ms                 |
| Backward                  | 4.727 ms                  | 5.465 ms                  |
| Optimize                  | 2.332 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 33.329 us                 | 77.773 ms                 |
| AfterBackward             | 76.608 ms                 | 2.148 s                   |
| BlockToStepN              | 60.510 ms                 | 232.264 ms                |
| OneStep                   | 211.543 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:23.081743 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
W20240130 00:16:23.413913 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240130 00:16:23.733013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=8537
W20240130 00:16:24.378000 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end6
E20240130 00:16:24.746193 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:25.391937 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
E20240130 00:16:25.746019 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1993
W20240130 00:16:25.851052 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240130 00:16:26.403369 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end9
E20240130 00:16:26.746022 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=357
W20240130 00:16:26.922381 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.421 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.841 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 30.567 ms                 | 208.257 ms                |
| ProcessOneStep            | 76.582 ms                 | 2.257 s                   |
| BlockToStepN              | 65.359 ms                 | 232.140 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:27.634361 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end4
E20240130 00:16:27.746023 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2131
W20240130 00:16:27.969090 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.976 ms                 | 350.244 ms                |
| Forward                   | 5.557 ms                  | 10.080 ms                 |
| Backward                  | 4.766 ms                  | 7.656 ms                  |
| Optimize                  | 2.316 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 33.167 us                 | 77.773 ms                 |
| AfterBackward             | 76.733 ms                 | 2.260 s                   |
| BlockToStepN              | 65.470 ms                 | 232.264 ms                |
| OneStep                   | 211.722 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:28.663221 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end9
E20240130 00:16:28.746013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=85
W20240130 00:16:29.209303 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240130 00:16:29.746026 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
W20240130 00:16:30.025794 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end2
E20240130 00:16:30.746016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=689
W20240130 00:16:31.070201 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
W20240130 00:16:31.315482 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=223, pq.top=223
E20240130 00:16:31.746016 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=36799
W20240130 00:16:32.238938 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
W20240130 00:16:32.315070 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.375 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 10.844 ms                 | 17.741 ms                 |
| ProcessBack:UpsertPq      | 29.328 ms                 | 185.990 ms                |
| ProcessOneStep            | 77.070 ms                 | 2.257 s                   |
| BlockToStepN              | 60.523 ms                 | 232.140 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:32.746021 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=16702
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.265 ms                 | 350.244 ms                |
| Forward                   | 5.545 ms                  | 10.080 ms                 |
| Backward                  | 4.789 ms                  | 7.832 ms                  |
| Optimize                  | 2.312 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 32.394 us                 | 77.773 ms                 |
| AfterBackward             | 77.324 ms                 | 2.260 s                   |
| BlockToStepN              | 60.646 ms                 | 232.264 ms                |
| OneStep                   | 211.543 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:33.314621 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end3
W20240130 00:16:33.424183 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=233, pq.top=233
E20240130 00:16:33.746016 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=12978
W20240130 00:16:34.634531 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
E20240130 00:16:34.752396 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 00:16:35.752024 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5215
W20240130 00:16:35.769485 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
W20240130 00:16:36.060472 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240130 00:16:36.759812 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=15372
W20240130 00:16:36.781991 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
W20240130 00:16:37.162248 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.437 ms                  | 33.366 ms                 |
| ProcessBack:UpdateCache   | 10.824 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 29.069 ms                 | 185.990 ms                |
| ProcessOneStep            | 77.665 ms                 | 2.257 s                   |
| BlockToStepN              | 66.639 ms                 | 234.158 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:37.759048 52616 parallel_pq_v2.h:76] insert failed, size(hashtable)=44948
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.265 ms                 | 350.244 ms                |
| Forward                   | 5.543 ms                  | 10.080 ms                 |
| Backward                  | 4.831 ms                  | 7.832 ms                  |
| Optimize                  | 2.316 ms                  | 7.525 ms                  |
| BarrierTimeBeforeRank0    | 32.000 us                 | 77.773 ms                 |
| AfterBackward             | 77.378 ms                 | 2.260 s                   |
| BlockToStepN              | 66.751 ms                 | 234.450 ms                |
| OneStep                   | 211.722 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:38.158142 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
W20240130 00:16:38.202852 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240130 00:16:38.759011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=241
W20240130 00:16:39.364831 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end0
E20240130 00:16:39.759020 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=224
W20240130 00:16:40.506546 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
W20240130 00:16:40.709661 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=250, pq.top=250
E20240130 00:16:40.759013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=15835
W20240130 00:16:41.641595 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
W20240130 00:16:41.709496 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=255, pq.top=255
E20240130 00:16:41.759011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=49361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.433 ms                  | 33.366 ms                 |
| ProcessBack:UpdateCache   | 10.838 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 28.803 ms                 | 185.990 ms                |
| ProcessOneStep            | 77.665 ms                 | 2.148 s                   |
| BlockToStepN              | 66.639 ms                 | 234.158 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:42.711012 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
W20240130 00:16:42.727185 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=261, pq.top=261
E20240130 00:16:42.759006 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=10366
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.317 ms                 | 341.747 ms                |
| Forward                   | 5.545 ms                  | 9.783 ms                  |
| Backward                  | 4.897 ms                  | 7.828 ms                  |
| Optimize                  | 2.322 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.858 us                 | 63.554 ms                 |
| AfterBackward             | 77.378 ms                 | 2.148 s                   |
| BlockToStepN              | 66.751 ms                 | 234.450 ms                |
| OneStep                   | 211.543 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:43.759017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2708
W20240130 00:16:43.937943 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end4
E20240130 00:16:44.759047 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:45.164573 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end4
E20240130 00:16:45.759011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=16470
W20240130 00:16:45.889627 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240130 00:16:46.289655 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
E20240130 00:16:46.759011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=29862
W20240130 00:16:46.929394 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240130 00:16:47.322343 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.437 ms                  | 33.366 ms                 |
| ProcessBack:UpdateCache   | 10.823 ms                 | 19.431 ms                 |
| ProcessBack:UpsertPq      | 29.377 ms                 | 185.990 ms                |
| ProcessOneStep            | 77.710 ms                 | 2.198 s                   |
| BlockToStepN              | 65.359 ms                 | 234.158 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:47.759008 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=23203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.317 ms                 | 341.747 ms                |
| Forward                   | 5.546 ms                  | 9.783 ms                  |
| Backward                  | 4.915 ms                  | 7.834 ms                  |
| Optimize                  | 2.316 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.186 us                 | 63.554 ms                 |
| AfterBackward             | 77.751 ms                 | 2.198 s                   |
| BlockToStepN              | 66.751 ms                 | 234.450 ms                |
| OneStep                   | 211.543 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:48.604364 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end6
E20240130 00:16:48.759016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=3488
W20240130 00:16:49.737303 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
E20240130 00:16:49.759011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240130 00:16:50.316251 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240130 00:16:50.759017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2544
W20240130 00:16:50.808362 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end9
W20240130 00:16:51.316762 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240130 00:16:51.759011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=54541
W20240130 00:16:51.900921 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end5
W20240130 00:16:52.333276 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.448 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.818 ms                 | 17.741 ms                 |
| ProcessBack:UpsertPq      | 29.069 ms                 | 155.889 ms                |
| ProcessOneStep            | 77.710 ms                 | 2.257 s                   |
| BlockToStepN              | 66.639 ms                 | 234.158 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:52.759009 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=894
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.419 ms                 | 341.747 ms                |
| Forward                   | 5.551 ms                  | 9.783 ms                  |
| Backward                  | 4.944 ms                  | 7.837 ms                  |
| Optimize                  | 2.319 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.805 us                 | 63.554 ms                 |
| AfterBackward             | 77.751 ms                 | 2.260 s                   |
| BlockToStepN              | 67.206 ms                 | 234.450 ms                |
| OneStep                   | 211.238 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:16:53.113619 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end0
E20240130 00:16:53.759013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2836
W20240130 00:16:54.345975 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
E20240130 00:16:54.759018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2471
W20240130 00:16:55.123396 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240130 00:16:55.422878 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end3
E20240130 00:16:55.759016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 00:16:56.270366 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240130 00:16:56.617370 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end8
E20240130 00:16:56.759022 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=87554
[proc 2] 300 steps, total: 34.419, sample: 1.321, forward: 0.571, backward: 0.525, update: 0.270
[proc 3] 300 steps, total: 34.419, sample: 1.448, forward: 0.509, backward: 0.672, update: 0.229
[proc 0] 300 steps, total: 34.419, sample: 3.810, forward: 0.550, backward: 0.712, update: 0.243
[proc 7] 300 steps, total: 34.419, sample: 1.370, forward: 0.539, backward: 0.725, update: 0.245
[proc 4] 300 steps, total: 34.419, sample: 1.337, forward: 0.540, backward: 0.542, update: 0.240
[proc 5] 300 steps, total: 34.419, sample: 1.103, forward: 0.552, backward: 0.759, update: 0.279
[proc 1] 300 steps, total: 34.419, sample: 1.338, forward: 0.538, backward: 0.776, update: 0.238
[proc 6] 300 steps, total: 34.419, sample: 1.526, forward: 0.596, backward: 0.626, update: 0.277
W20240130 00:16:57.272665 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.448 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.790 ms                 | 17.741 ms                 |
| ProcessBack:UpsertPq      | 29.322 ms                 | 155.889 ms                |
| ProcessOneStep            | 77.710 ms                 | 2.257 s                   |
| BlockToStepN              | 66.639 ms                 | 239.293 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:57.759027 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=35583
W20240130 00:16:58.020375 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.419 ms                 | 341.747 ms                |
| Forward                   | 5.546 ms                  | 9.783 ms                  |
| Backward                  | 4.961 ms                  | 7.930 ms                  |
| Optimize                  | 2.327 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.858 us                 | 63.554 ms                 |
| AfterBackward             | 77.701 ms                 | 2.260 s                   |
| BlockToStepN              | 66.751 ms                 | 239.408 ms                |
| OneStep                   | 211.238 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:16:58.761080 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:16:59.232218 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end6
E20240130 00:16:59.761013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=995
W20240130 00:17:00.092948 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240130 00:17:00.270074 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end9
E20240130 00:17:00.761395 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=227
W20240130 00:17:01.199226 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240130 00:17:01.362349 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
E20240130 00:17:01.761011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=17081
W20240130 00:17:02.255679 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240130 00:17:02.493646 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.437 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.775 ms                 | 17.741 ms                 |
| ProcessBack:UpsertPq      | 28.803 ms                 | 155.889 ms                |
| ProcessOneStep            | 77.023 ms                 | 2.257 s                   |
| BlockToStepN              | 67.091 ms                 | 239.378 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:02.761009 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=2939
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.976 ms                 | 341.747 ms                |
| Forward                   | 5.541 ms                  | 9.783 ms                  |
| Backward                  | 4.951 ms                  | 7.930 ms                  |
| Optimize                  | 2.337 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.874 us                 | 63.554 ms                 |
| AfterBackward             | 77.063 ms                 | 2.260 s                   |
| BlockToStepN              | 67.353 ms                 | 239.493 ms                |
| OneStep                   | 211.543 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:03.668644 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end0
E20240130 00:17:03.761009 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4683
W20240130 00:17:04.681375 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end0
E20240130 00:17:04.761008 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1165
W20240130 00:17:04.810185 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240130 00:17:05.761018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=57793
W20240130 00:17:05.781303 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
W20240130 00:17:06.052740 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=327, pq.top=327
E20240130 00:17:06.761008 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1896
W20240130 00:17:06.912425 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
W20240130 00:17:07.112380 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.449 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.788 ms                 | 15.890 ms                 |
| ProcessBack:UpsertPq      | 28.667 ms                 | 149.154 ms                |
| ProcessOneStep            | 76.256 ms                 | 2.257 s                   |
| BlockToStepN              | 67.233 ms                 | 245.004 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:07.761016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=3589
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.444 ms                 | 341.747 ms                |
| Forward                   | 5.527 ms                  | 9.783 ms                  |
| Backward                  | 4.943 ms                  | 7.930 ms                  |
| Optimize                  | 2.357 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.858 us                 | 63.554 ms                 |
| AfterBackward             | 76.295 ms                 | 2.260 s                   |
| BlockToStepN              | 67.353 ms                 | 245.132 ms                |
| OneStep                   | 209.294 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:08.157845 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240130 00:17:08.761011 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
W20240130 00:17:09.188489 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
W20240130 00:17:09.345695 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=335, pq.top=335
E20240130 00:17:09.761010 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=38283
W20240130 00:17:10.265995 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end1
W20240130 00:17:10.345037 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=341, pq.top=341
E20240130 00:17:10.761014 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=19113
W20240130 00:17:11.392031 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240130 00:17:11.603297 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end7
E20240130 00:17:11.761011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=118662
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.460 ms                  | 33.366 ms                 |
| ProcessBack:UpdateCache   | 10.775 ms                 | 17.133 ms                 |
| ProcessBack:UpsertPq      | 28.550 ms                 | 149.154 ms                |
| ProcessOneStep            | 75.725 ms                 | 2.257 s                   |
| BlockToStepN              | 68.546 ms                 | 247.532 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:12.761023 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5040
W20240130 00:17:12.995473 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.388 ms                 | 341.747 ms                |
| Forward                   | 5.509 ms                  | 10.080 ms                 |
| Backward                  | 4.941 ms                  | 7.930 ms                  |
| Optimize                  | 2.367 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.186 us                 | 63.554 ms                 |
| AfterBackward             | 75.762 ms                 | 2.260 s                   |
| BlockToStepN              | 68.678 ms                 | 247.651 ms                |
| OneStep                   | 208.927 ms                | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:13.761009 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=5919
W20240130 00:17:14.035434 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end9
W20240130 00:17:14.081513 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240130 00:17:14.761008 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=13051
W20240130 00:17:15.118582 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end4
W20240130 00:17:15.165990 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=354, pq.top=354
E20240130 00:17:15.761018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=153360
W20240130 00:17:16.165225 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240130 00:17:16.450764 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
E20240130 00:17:16.761008 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=12957
W20240130 00:17:17.508126 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=364, pq.top=364
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.464 ms                  | 33.366 ms                 |
| ProcessBack:UpdateCache   | 10.729 ms                 | 17.133 ms                 |
| ProcessBack:UpsertPq      | 28.154 ms                 | 149.154 ms                |
| ProcessOneStep            | 75.301 ms                 | 2.198 s                   |
| BlockToStepN              | 68.546 ms                 | 253.093 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:17.761020 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=6698
W20240130 00:17:17.893252 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.577 ms                 | 340.521 ms                |
| Forward                   | 5.505 ms                  | 9.783 ms                  |
| Backward                  | 4.934 ms                  | 7.930 ms                  |
| Optimize                  | 2.374 ms                  | 5.795 ms                  |
| BarrierTimeBeforeRank0    | 30.874 us                 | 57.463 ms                 |
| AfterBackward             | 75.341 ms                 | 2.198 s                   |
| BlockToStepN              | 68.678 ms                 | 253.202 ms                |
| OneStep                   | 208.927 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:18.761025 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=100
W20240130 00:17:19.002885 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end5
W20240130 00:17:19.383493 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240130 00:17:19.761009 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=37097
W20240130 00:17:20.041635 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
W20240130 00:17:20.426689 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=372, pq.top=372
E20240130 00:17:20.761016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=362
W20240130 00:17:21.341056 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end4
W20240130 00:17:21.558706 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240130 00:17:21.761011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=39414
W20240130 00:17:22.561776 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.474 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.713 ms                 | 15.890 ms                 |
| ProcessBack:UpsertPq      | 28.556 ms                 | 147.936 ms                |
| ProcessOneStep            | 75.301 ms                 | 2.198 s                   |
| BlockToStepN              | 67.724 ms                 | 270.408 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:22.771998 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.476 ms                 | 340.521 ms                |
| Forward                   | 5.505 ms                  | 10.080 ms                 |
| Backward                  | 4.958 ms                  | 7.930 ms                  |
| Optimize                  | 2.377 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.994 us                 | 57.463 ms                 |
| AfterBackward             | 75.341 ms                 | 2.198 s                   |
| BlockToStepN              | 67.835 ms                 | 270.513 ms                |
| OneStep                   | 208.728 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:23.754292 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end8
E20240130 00:17:23.771009 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240130 00:17:24.162416 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=378, pq.top=378
E20240130 00:17:24.771013 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=115712
W20240130 00:17:24.813055 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end3
W20240130 00:17:25.162346 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=384, pq.top=384
E20240130 00:17:25.771059 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=74840
W20240130 00:17:25.922015 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
W20240130 00:17:26.162595 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=387, pq.top=387
E20240130 00:17:26.771018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=17090
W20240130 00:17:27.162745 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240130 00:17:27.237164 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.482 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.725 ms                 | 15.890 ms                 |
| ProcessBack:UpsertPq      | 28.550 ms                 | 147.936 ms                |
| ProcessOneStep            | 75.627 ms                 | 2.198 s                   |
| BlockToStepN              | 68.546 ms                 | 309.238 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:27.771014 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.476 ms                 | 340.521 ms                |
| Forward                   | 5.494 ms                  | 10.080 ms                 |
| Backward                  | 4.976 ms                  | 8.032 ms                  |
| Optimize                  | 2.373 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 31.104 us                 | 57.463 ms                 |
| AfterBackward             | 75.672 ms                 | 2.198 s                   |
| BlockToStepN              | 68.678 ms                 | 309.351 ms                |
| OneStep                   | 208.927 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:28.303705 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
E20240130 00:17:28.771018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4461
W20240130 00:17:29.180533 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=392, pq.top=392
W20240130 00:17:29.339771 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end3
E20240130 00:17:29.771014 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=36840
W20240130 00:17:30.180290 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240130 00:17:30.431357 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
[proc 3] 400 steps, total: 33.542, sample: 1.316, forward: 0.528, backward: 0.750, update: 0.249
[proc 0] 400 steps, total: 33.542, sample: 2.515, forward: 0.582, backward: 0.576, update: 0.262
[proc 5] 400 steps, total: 33.542, sample: 1.454, forward: 0.617, backward: 0.547, update: 0.299
[proc 1] 400 steps, total: 33.542, sample: 1.100, forward: 0.555, backward: 0.566, update: 0.240
[proc 7] 400 steps, total: 33.542, sample: 1.305, forward: 0.553, backward: 0.532, update: 0.245
[proc 2] 400 steps, total: 33.542, sample: 1.556, forward: 0.620, backward: 0.585, update: 0.287
[proc 4] 400 steps, total: 33.542, sample: 1.177, forward: 0.561, backward: 0.565, update: 0.247
[proc 6] 400 steps, total: 33.542, sample: 1.249, forward: 0.572, backward: 0.565, update: 0.261
E20240130 00:17:30.771009 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=66992
W20240130 00:17:31.180392 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240130 00:17:31.593094 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240130 00:17:31.771015 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=127176
W20240130 00:17:32.180907 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.489 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.798 ms                 | 15.890 ms                 |
| ProcessBack:UpsertPq      | 28.556 ms                 | 147.936 ms                |
| ProcessOneStep            | 75.946 ms                 | 2.198 s                   |
| BlockToStepN              | 68.502 ms                 | 314.036 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:32.771009 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=51612
W20240130 00:17:32.865365 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.580 ms                 | 340.521 ms                |
| Forward                   | 5.509 ms                  | 10.176 ms                 |
| Backward                  | 5.014 ms                  | 8.032 ms                  |
| Optimize                  | 2.374 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.910 us                 | 57.463 ms                 |
| AfterBackward             | 75.986 ms                 | 2.198 s                   |
| BlockToStepN              | 68.610 ms                 | 314.150 ms                |
| OneStep                   | 208.927 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:33.771015 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4109
W20240130 00:17:33.970705 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
E20240130 00:17:34.771021 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=6334
W20240130 00:17:34.898066 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240130 00:17:34.977780 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:17:35.771015 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240130 00:17:35.898929 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240130 00:17:36.024549 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end8
E20240130 00:17:36.771013 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=75316
W20240130 00:17:36.898522 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240130 00:17:37.309266 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.487 ms                  | 32.693 ms                 |
| ProcessBack:UpdateCache   | 10.790 ms                 | 15.890 ms                 |
| ProcessBack:UpsertPq      | 28.341 ms                 | 147.936 ms                |
| ProcessOneStep            | 75.946 ms                 | 2.198 s                   |
| BlockToStepN              | 68.546 ms                 | 322.329 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:37.771020 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=262
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.462 ms                 | 340.521 ms                |
| Forward                   | 5.515 ms                  | 10.176 ms                 |
| Backward                  | 5.056 ms                  | 8.032 ms                  |
| Optimize                  | 2.374 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.874 us                 | 57.463 ms                 |
| AfterBackward             | 75.986 ms                 | 2.198 s                   |
| BlockToStepN              | 68.678 ms                 | 322.472 ms                |
| OneStep                   | 209.294 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:38.446820 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end4
E20240130 00:17:38.776335 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 00:17:39.320076 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240130 00:17:39.481587 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 00:17:39.776016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=11205
W20240130 00:17:40.320784 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240130 00:17:40.502491 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
E20240130 00:17:40.776017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=6808
W20240130 00:17:41.406183 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=435, pq.top=435
E20240130 00:17:41.776015 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=141083
W20240130 00:17:41.862325 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.486 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.802 ms                 | 15.777 ms                 |
| ProcessBack:UpsertPq      | 28.083 ms                 | 144.668 ms                |
| ProcessOneStep            | 75.946 ms                 | 2.198 s                   |
| BlockToStepN              | 68.546 ms                 | 322.329 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:42.776016 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=583
W20240130 00:17:43.021064 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.929 ms                 | 340.521 ms                |
| Forward                   | 5.525 ms                  | 10.176 ms                 |
| Backward                  | 5.079 ms                  | 8.032 ms                  |
| Optimize                  | 2.377 ms                  | 6.761 ms                  |
| BarrierTimeBeforeRank0    | 30.858 us                 | 57.463 ms                 |
| AfterBackward             | 75.986 ms                 | 2.198 s                   |
| BlockToStepN              | 68.678 ms                 | 322.472 ms                |
| OneStep                   | 209.294 ms                | 2.275 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:43.620138 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240130 00:17:43.776010 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=96
W20240130 00:17:44.036358 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end2
W20240130 00:17:44.624037 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240130 00:17:44.776017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=198720
W20240130 00:17:45.349471 53030 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end9
W20240130 00:17:45.656605 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=450, pq.top=449
E20240130 00:17:45.776010 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=96098
W20240130 00:17:46.627404 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
E20240130 00:17:46.776026 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4039
W20240130 00:17:47.634570 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.490 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.801 ms                 | 15.777 ms                 |
| ProcessBack:UpsertPq      | 28.079 ms                 | 144.668 ms                |
| ProcessOneStep            | 75.946 ms                 | 2.148 s                   |
| BlockToStepN              | 67.233 ms                 | 322.329 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:47.644192 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=453, pq.top=453
E20240130 00:17:47.776016 52616 parallel_pq_v2.h:76] insert failed, size(hashtable)=60076
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.662 ms                 | 326.730 ms                |
| Forward                   | 5.543 ms                  | 10.080 ms                 |
| Backward                  | 5.106 ms                  | 8.023 ms                  |
| Optimize                  | 2.377 ms                  | 5.795 ms                  |
| BarrierTimeBeforeRank0    | 30.874 us                 | 51.607 ms                 |
| AfterBackward             | 75.986 ms                 | 2.148 s                   |
| BlockToStepN              | 67.353 ms                 | 322.472 ms                |
| OneStep                   | 207.060 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:48.644174 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240130 00:17:48.732439 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end8
E20240130 00:17:48.776014 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=50861
W20240130 00:17:49.757184 53030 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end5
E20240130 00:17:49.776005 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=14981
W20240130 00:17:49.802152 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=465, pq.top=465
E20240130 00:17:50.776018 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=519
W20240130 00:17:50.966812 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end6
E20240130 00:17:51.776022 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=648
W20240130 00:17:52.049432 53030 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end6
W20240130 00:17:52.214424 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.510 ms                  | 27.258 ms                 |
| ProcessBack:UpdateCache   | 10.798 ms                 | 15.777 ms                 |
| ProcessBack:UpsertPq      | 28.341 ms                 | 144.668 ms                |
| ProcessOneStep            | 75.957 ms                 | 2.148 s                   |
| BlockToStepN              | 67.233 ms                 | 376.000 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:52.776010 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=33566
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.272 ms                 | 326.730 ms                |
| Forward                   | 5.545 ms                  | 10.080 ms                 |
| Backward                  | 5.134 ms                  | 8.023 ms                  |
| Optimize                  | 2.374 ms                  | 5.795 ms                  |
| BarrierTimeBeforeRank0    | 30.858 us                 | 51.607 ms                 |
| AfterBackward             | 75.986 ms                 | 2.148 s                   |
| BlockToStepN              | 67.353 ms                 | 376.114 ms                |
| OneStep                   | 207.060 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:53.137117 53030 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
W20240130 00:17:53.214448 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=471, pq.top=471
E20240130 00:17:53.776014 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=838
W20240130 00:17:54.279327 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240130 00:17:54.341768 53030 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
E20240130 00:17:54.776017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=150073
W20240130 00:17:55.485096 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end1
E20240130 00:17:55.776021 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5338
W20240130 00:17:56.356631 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240130 00:17:56.530793 53030 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 00:17:56.776010 52420 parallel_pq_v2.h:76] insert failed, size(hashtable)=205
W20240130 00:17:57.450739 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240130 00:17:57.591675 53030 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.515 ms                  | 25.889 ms                 |
| ProcessBack:UpdateCache   | 10.802 ms                 | 15.621 ms                 |
| ProcessBack:UpsertPq      | 28.083 ms                 | 135.443 ms                |
| ProcessOneStep            | 76.147 ms                 | 2.148 s                   |
| BlockToStepN              | 67.091 ms                 | 376.000 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 00:17:57.776011 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=59991
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.882 ms                 | 326.730 ms                |
| Forward                   | 5.546 ms                  | 10.080 ms                 |
| Backward                  | 5.190 ms                  | 8.023 ms                  |
| Optimize                  | 2.380 ms                  | 5.795 ms                  |
| BarrierTimeBeforeRank0    | 30.874 us                 | 51.607 ms                 |
| AfterBackward             | 76.123 ms                 | 2.148 s                   |
| BlockToStepN              | 67.206 ms                 | 376.114 ms                |
| OneStep                   | 207.060 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 00:17:58.501145 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=492, pq.top=492
E20240130 00:17:58.776017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=20878
W20240130 00:17:58.795310 53030 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end2
W20240130 00:17:59.501864 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=495, pq.top=495
E20240130 00:17:59.776191 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=4462
W20240130 00:17:59.910681 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end7
E20240130 00:18:00.776017 53030 parallel_pq_v2.h:76] insert failed, size(hashtable)=5186
W20240130 00:18:01.082394 53030 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end7
W20240130 00:18:01.444465 52420 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240130 00:18:01.776010 53029 parallel_pq_v2.h:76] insert failed, size(hashtable)=14829
[proc 0] 500 steps, total: 31.270, sample: 2.183, forward: 0.554, backward: 0.745, update: 0.244
[proc 4] 500 steps, total: 31.270, sample: 1.121, forward: 0.570, backward: 0.580, update: 0.243
Successfully xmh. training takes 164.8715944290161 seconds
[proc 2] 500 steps, total: 31.270, sample: 1.420, forward: 0.595, backward: 0.545, update: 0.264
[proc 1] 500 steps, total: 31.270, sample: 1.221, forward: 0.500, backward: 0.602, update: 0.264
[proc 6] 500 steps, total: 31.270, sample: 1.382, forward: 0.594, backward: 0.729, update: 0.277
[proc 5] 500 steps, total: 31.270, sample: 1.166, forward: 0.531, backward: 0.629, update: 0.256
before call kg_cache_controller.StopThreads()
[proc 7] 500 steps, total: 31.270, sample: 1.166, forward: 0.561, backward: 0.526, update: 0.260
[proc 3] 500 steps, total: 31.270, sample: 1.272, forward: 0.558, backward: 0.632, update: 0.249
W20240130 00:18:01.952522 52420 grad_async_v2.h:71] call StopThreads. PID = 51082
W20240130 00:18:01.952560 52420 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 00:18:01.952896 52420 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 00:18:01.952912 52420 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240130 00:18:02.119705 53030 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end0
W20240130 00:18:02.191403 52420 grad_async_v2.h:92] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.519 ms                  | 25.889 ms                 |
| ProcessBack:UpdateCache   | 10.802 ms                 | 15.621 ms                 |
| ProcessBack:UpsertPq      | 27.997 ms                 | 144.668 ms                |
| ProcessOneStep            | 76.147 ms                 | 2.148 s                   |
| BlockToStepN              | 67.091 ms                 | 377.517 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.734 ms                 | 326.730 ms                |
| Forward                   | 5.547 ms                  | 10.080 ms                 |
| Backward                  | 5.214 ms                  | 8.023 ms                  |
| Optimize                  | 2.379 ms                  | 5.795 ms                  |
| BarrierTimeBeforeRank0    | 30.031 us                 | 51.607 ms                 |
| AfterBackward             | 76.192 ms                 | 2.148 s                   |
| BlockToStepN              | 67.206 ms                 | 377.772 ms                |
| OneStep                   | 206.909 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
