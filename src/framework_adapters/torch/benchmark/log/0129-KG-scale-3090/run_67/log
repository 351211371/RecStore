WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 00:19:01.847661 59590 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_19', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [59590 sampler.py:454] Start PreSampling
WARNING [59590 sampler.py:532] Before construct renumbering_dict
WARNING [59590 sampler.py:555] PreSampling done
W20240130 00:39:21.404846 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 00:39:21.405030 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 00:39:21.405071 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 00:39:21.405107 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 00:39:21.405139 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 00:39:21.405165 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 00:39:21.405193 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 00:39:21.405233 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 00:39:21.405267 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 00:39:21.405299 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 00:39:21.405342 59590 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 00:39:21.405368 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 00:39:21.405395 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 00:39:21.405555 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 00:39:21.405598 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 00:39:21.405628 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 00:39:21.405676 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 00:39:21.405709 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 00:39:21.405738 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 00:39:21.405772 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 00:39:21.405807 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 00:39:21.405843 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 00:39:21.405875 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 00:39:21.405903 59590 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 00:39:21.405926 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 00:39:21.405949 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 00:39:21.406002 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 00:39:21.406036 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 00:39:21.406066 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 00:39:21.406092 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 00:39:21.406123 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 00:39:21.406155 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 00:39:21.406188 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 00:39:21.406214 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 00:39:21.406245 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 00:39:21.406271 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 00:39:21.406296 59590 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 00:39:21.406319 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 00:39:21.406347 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 00:39:21.406407 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 00:39:21.406445 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 00:39:21.406472 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 00:39:21.406498 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 00:39:21.406527 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 00:39:21.406559 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 00:39:21.406589 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 00:39:21.406615 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 00:39:21.406642 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 00:39:21.406675 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 00:39:21.406708 59590 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 00:39:21.406730 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 00:39:21.406751 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 00:39:21.406816 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 00:39:21.406852 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 00:39:21.406879 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 00:39:21.406906 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 00:39:21.406939 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 00:39:21.406970 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 00:39:21.406997 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 00:39:21.407025 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 00:39:21.407055 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 00:39:21.407083 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 00:39:21.407109 59590 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 00:39:21.407131 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 00:39:21.407155 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 00:39:21.407209 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 00:39:21.407238 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 00:39:21.407274 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 00:39:21.407301 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 00:39:21.407328 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 00:39:21.407361 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 00:39:21.407389 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 00:39:21.407421 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 00:39:21.407449 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 00:39:21.407482 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 00:39:21.407509 59590 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 00:39:21.407531 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 00:39:21.407553 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 00:39:21.407603 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240130 00:39:21.407634 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240130 00:39:21.407663 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240130 00:39:21.407694 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240130 00:39:21.407727 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240130 00:39:21.407768 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240130 00:39:21.407796 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240130 00:39:21.407825 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240130 00:39:21.407860 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240130 00:39:21.407896 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240130 00:39:21.407928 59590 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240130 00:39:21.407953 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240130 00:39:21.407974 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240130 00:39:21.408025 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240130 00:39:21.408064 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240130 00:39:21.408102 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240130 00:39:21.408139 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240130 00:39:21.408171 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240130 00:39:21.408205 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240130 00:39:21.408242 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240130 00:39:21.408277 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240130 00:39:21.408308 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240130 00:39:21.408336 59590 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240130 00:39:21.408370 59590 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240130 00:39:21.408392 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240130 00:39:21.408417 59590 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240130 00:39:21.826157 59590 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240130 00:39:21.826318 59590 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605410,  8605414,    60823,  ..., 67121126, 63409460,  9129493]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1730.657 seconds
[Rank1] pid = 60490
[Rank2] pid = 60585
[Rank3] pid = 60652
[Rank4] pid = 60719
[Rank5] pid = 60788
[Rank6] pid = 60855
INFO [59590 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [60490 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [60585 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [60652 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [60719 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [60855 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [60923 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [60788 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [60855 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60585 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60923 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60652 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60788 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60719 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59590 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [60490 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240130 00:48:04.629065 60857 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240130 00:48:04.629179 60586 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240130 00:48:04.629182 60653 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240130 00:48:04.629170 60789 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240130 00:48:04.629177 60924 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240130 00:48:04.629187 60720 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240130 00:48:04.631726 60932 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240130 00:48:04.636960 60491 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240130 00:48:04.669068 60924 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497a3000 7.629 MB
W20240130 00:48:04.669252 60924 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x102049f46000 7.629 MB
W20240130 00:48:04.669317 60924 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204a6e9000 1.49 GB
W20240130 00:48:04.669358 60924 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1020a9ccc000 1.49 GB
W20240130 00:48:04.669399 60924 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 00:48:04.751106 60924 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 00:48:04.751276 60932 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1021092bd000 7.629 MB
W20240130 00:48:04.751302 60857 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10210a203000 7.629 MB
W20240130 00:48:04.751299 60720 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102109a60000 7.629 MB
W20240130 00:48:04.751317 60789 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10210a9a6000 7.629 MB
W20240130 00:48:04.751329 60653 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10210b149000 7.629 MB
W20240130 00:48:04.751406 60932 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210b8ec000 7.629 MB
W20240130 00:48:04.751423 60586 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10210c08f000 7.629 MB
W20240130 00:48:04.751454 60789 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210c832000 7.629 MB
W20240130 00:48:04.751458 60720 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210cfd5000 7.629 MB
W20240130 00:48:04.751463 60653 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210d778000 7.629 MB
W20240130 00:48:04.751468 60857 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210df1b000 7.629 MB
W20240130 00:48:04.751482 60932 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210e6be000 1.49 GB
W20240130 00:48:04.751521 60932 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10216dca1000 1.49 GB
W20240130 00:48:04.751538 60789 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021cd284000 1.49 GB
W20240130 00:48:04.751544 60720 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10222c867000 1.49 GB
W20240130 00:48:04.751549 60653 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10228be4a000 1.49 GB
W20240130 00:48:04.751561 60857 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1022eb42d000 1.49 GB
W20240130 00:48:04.751595 60932 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 00:48:04.751597 60586 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10234aa10000 7.629 MB
W20240130 00:48:04.751603 60789 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10234b1b3000 1.49 GB
W20240130 00:48:04.751610 60857 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023aa796000 1.49 GB
W20240130 00:48:04.751616 60720 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102409d79000 1.49 GB
W20240130 00:48:04.751629 60653 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10246935c000 1.49 GB
W20240130 00:48:04.751665 60789 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 00:48:04.751669 60857 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 00:48:04.751674 60653 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 00:48:04.751684 60586 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1024c893f000 1.49 GB
W20240130 00:48:04.751693 60720 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 00:48:04.751731 60586 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102527f22000 1.49 GB
W20240130 00:48:04.751777 60586 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 00:48:04.762591 60789 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 00:48:04.762603 60720 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 00:48:04.762602 60653 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 00:48:04.762605 60932 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 00:48:04.762622 60586 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 00:48:04.762624 60857 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 00:48:04.794687 60491 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102587521000 7.629 MB
W20240130 00:48:04.794837 60491 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102587cc4000 7.629 MB
W20240130 00:48:04.794896 60491 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102588467000 1.49 GB
W20240130 00:48:04.794940 60491 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025e7a4a000 1.49 GB
W20240130 00:48:04.794986 60491 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 00:48:04.796648 60491 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [60652 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [60490 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [60788 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [60719 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [60585 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [60855 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [60923 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 60923
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [59590 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 00:48:56.067823 60932 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068364 60720 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068454 60857 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068538 60789 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068621 60491 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068683 60924 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068728 60586 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 00:48:56.068804 60653 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240130 00:48:56.869220 60653 recstore.cc:66] init folly done
E20240130 00:48:56.869225 60857 recstore.cc:66] init folly done
E20240130 00:48:56.869233 60924 recstore.cc:66] init folly done
E20240130 00:48:56.869233 60586 recstore.cc:66] init folly done
E20240130 00:48:56.869235 60720 recstore.cc:66] init folly done
E20240130 00:48:56.869242 60789 recstore.cc:66] init folly done
E20240130 00:48:56.869235 60491 recstore.cc:66] init folly done
E20240130 00:48:56.869354 60932 recstore.cc:66] init folly done
I20240130 00:49:03.329936 60924 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240130 00:49:03.614243 60720 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:03.990911 60586 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:04.173817 60789 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:05.348220 60653 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:06.027783 60857 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:06.752645 60932 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 00:49:06.893858 60491 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.385 ms                 | 33.253 ms                 |
| Forward                   | 5.244 ms                  | 566.176 ms                |
| Backward                  | 3.264 s                   | 3.264 s                   |
| Optimize                  | 127.299 ms                | 127.299 ms                |
| BarrierTimeBeforeRank0    | 45.286 us                 | 45.286 us                 |
| BlockToStepN              | 58.048 us                 | 58.048 us                 |
| OneStep                   | 3.992 s                   | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.264 ms                 | 245.957 ms                |
| Forward                   | 5.156 ms                  | 566.176 ms                |
| Backward                  | 427.502 ms                | 3.264 s                   |
| Optimize                  | 123.570 ms                | 184.512 ms                |
| BarrierTimeBeforeRank0    | 50.931 us                 | 89.195 us                 |
| BlockToStepN              | 58.048 us                 | 22.668 ms                 |
| OneStep                   | 572.501 ms                | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.109 ms                  | 245.957 ms                |
| Forward                   | 5.156 ms                  | 566.176 ms                |
| Backward                  | 434.007 ms                | 3.264 s                   |
| Optimize                  | 121.801 ms                | 184.512 ms                |
| BarrierTimeBeforeRank0    | 50.034 us                 | 89.195 us                 |
| BlockToStepN              | 63.454 us                 | 22.668 ms                 |
| OneStep                   | 571.604 ms                | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 245.957 ms                |
| Forward                   | 5.058 ms                  | 566.176 ms                |
| Backward                  | 430.529 ms                | 3.264 s                   |
| Optimize                  | 121.801 ms                | 184.512 ms                |
| BarrierTimeBeforeRank0    | 50.034 us                 | 89.195 us                 |
| BlockToStepN              | 58.048 us                 | 22.668 ms                 |
| OneStep                   | 569.978 ms                | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 245.957 ms                |
| Forward                   | 4.993 ms                  | 566.176 ms                |
| Backward                  | 427.502 ms                | 3.264 s                   |
| Optimize                  | 122.069 ms                | 184.512 ms                |
| BarrierTimeBeforeRank0    | 48.967 us                 | 89.195 us                 |
| BlockToStepN              | 56.999 us                 | 22.668 ms                 |
| OneStep                   | 564.692 ms                | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.314 ms                  | 245.957 ms                |
| Forward                   | 4.979 ms                  | 566.176 ms                |
| Backward                  | 425.970 ms                | 3.264 s                   |
| Optimize                  | 122.033 ms                | 184.512 ms                |
| BarrierTimeBeforeRank0    | 48.967 us                 | 89.195 us                 |
| BlockToStepN              | 57.246 us                 | 22.668 ms                 |
| OneStep                   | 563.429 ms                | 3.992 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.783 ms                  | 127.650 ms                |
| Forward                   | 4.993 ms                  | 8.418 ms                  |
| Backward                  | 417.212 ms                | 500.775 ms                |
| Optimize                  | 122.033 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 46.818 us                 | 68.930 us                 |
| BlockToStepN              | 58.218 us                 | 15.209 ms                 |
| OneStep                   | 559.580 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.802 ms                  | 144.727 ms                |
| Forward                   | 4.993 ms                  | 12.445 ms                 |
| Backward                  | 413.706 ms                | 500.775 ms                |
| Optimize                  | 122.029 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 45.286 us                 | 71.162 us                 |
| BlockToStepN              | 57.246 us                 | 15.209 ms                 |
| OneStep                   | 555.716 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 144.727 ms                |
| Forward                   | 4.993 ms                  | 12.445 ms                 |
| Backward                  | 403.960 ms                | 500.775 ms                |
| Optimize                  | 121.930 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 43.362 us                 | 71.162 us                 |
| BlockToStepN              | 55.154 us                 | 15.209 ms                 |
| OneStep                   | 549.945 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.802 ms                  | 144.727 ms                |
| Forward                   | 4.986 ms                  | 12.445 ms                 |
| Backward                  | 393.642 ms                | 500.775 ms                |
| Optimize                  | 121.384 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 42.448 us                 | 71.162 us                 |
| BlockToStepN              | 53.875 us                 | 15.209 ms                 |
| OneStep                   | 538.848 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 144.727 ms                |
| Forward                   | 4.989 ms                  | 13.827 ms                 |
| Backward                  | 385.511 ms                | 500.775 ms                |
| Optimize                  | 121.801 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 41.876 us                 | 71.162 us                 |
| BlockToStepN              | 55.207 us                 | 15.209 ms                 |
| OneStep                   | 521.693 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 59.468, sample: 1.712, forward: 1.064, backward: 20.538, update: 0.315
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 58.111, sample: 1.686, forward: 1.071, backward: 20.555, update: 0.298
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 59.845, sample: 1.328, forward: 1.122, backward: 20.587, update: 0.300
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 59.285, sample: 1.592, forward: 1.114, backward: 20.331, update: 0.314
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 56.565, sample: 1.711, forward: 1.038, backward: 21.035, update: 0.317
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 57.431, sample: 1.384, forward: 1.082, backward: 20.532, update: 0.310
train_sampler.Prefill()
-------Step 0-------
tensor([  170007,   170035,   170061,   170088, 10211934,   984983, 63382687,
        23391185, 27231315,   170112]) tensor([ 9546438, 17900587, 68076911, 67899109, 25745274, 38118334, 44354773,
        70218500, 64599034, 35671348])
-------Step 1-------
tensor([  170007,   170035,   170061,   170088, 10211934,   984983, 63382687,
        23391185, 27231315,   170112]) tensor([ 3638972, 28515669, 15971379, 73718586, 83861605, 50020889, 64847497,
        43601320, 42670545, 18303249])
-------Step 2-------
tensor([  233398,   233425,   233455,   276947,   233477,   233507, 85792846,
        30147274,   233531,   233557]) tensor([65558665, 25533314, 72683477, 56464609, 40800282, 35123546, 78220415,
        38843793, 16976611, 49099205])
-------Step 3-------
tensor([  233398,   233425,   233455,   276947,   233477,   233507, 85792846,
        30147274,   233531,   233557]) tensor([54031432, 83739369, 41144432, 45307332, 73609182, 59184356, 42903215,
        21912127, 32573725,  1600085])
-------Step 4-------
tensor([  298128, 43147310,   298153,   998231,   298180,   998240,   298210,
        47115147,   298234,   298263]) tensor([82082140, 14780814, 85835514, 23578830, 77047987, 38999044, 71736824,
        44514347, 73931523, 48590692])
-------Step 5-------
tensor([  298128, 43147310,   298153,   998231,   298180,   998240,   298210,
        47115147,   298234,   298263]) tensor([40661570,  1361599,   926412, 85594621, 53000376, 50159942, 17527946,
        13271170, 78481635, 38713529])
-------Step 6-------
tensor([  364904,   306493, 40582602,   364936, 31814388, 79105055,   364956,
          364987, 48500092, 43337543]) tensor([18629927, 44746136, 34344791, 74025243, 38775620, 44403478, 29245579,
        10946537, 62341752, 72197545])
-------Step 7-------
tensor([  364904,   306493, 40582602,   364936, 31814388, 79105055,   364956,
          364987, 48500092, 43337543]) tensor([26280745, 48984541, 65245303, 55101431, 84119761, 57300728, 61149332,
        61531101, 42002663,  1004474])
-------Step 8-------
tensor([  427536, 30792457,   427558,  1008987,   427587,   320966,   427625,
          427655,   427689,   427714]) tensor([51975924, 25924762, 39503037,  3524672, 46654380,   139798, 20750919,
          593876,  3141802, 57037067])
-------Step 9-------
tensor([  427536, 30792457,   427558,  1008987,   427587,   320966,   427625,
          427655,   427689,   427714]) tensor([58780857,  2074932, 18136187, 50749364, 13530557, 38785887,   803484,
        36886338, 85580468, 76861911])
before start barrier
start train
[proc 0] 100 steps, total: 56.706, sample: 2.043, forward: 1.078, backward: 41.421, update: 11.803
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 60.129, sample: 1.334, forward: 1.069, backward: 20.905, update: 0.298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 181.846 ms                |
| Forward                   | 4.999 ms                  | 13.827 ms                 |
| Backward                  | 374.203 ms                | 500.775 ms                |
| Optimize                  | 121.384 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 41.876 us                 | 71.162 us                 |
| BlockToStepN              | 53.041 us                 | 15.209 ms                 |
| OneStep                   | 518.027 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.193 ms                  | 181.846 ms                |
| Forward                   | 5.010 ms                  | 13.827 ms                 |
| Backward                  | 370.365 ms                | 500.775 ms                |
| Optimize                  | 121.801 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 40.747 us                 | 80.257 us                 |
| BlockToStepN              | 53.844 us                 | 19.018 ms                 |
| OneStep                   | 508.396 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.375 ms                  | 181.846 ms                |
| Forward                   | 5.056 ms                  | 13.827 ms                 |
| Backward                  | 367.623 ms                | 500.775 ms                |
| Optimize                  | 121.930 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 40.483 us                 | 80.257 us                 |
| BlockToStepN              | 53.041 us                 | 19.018 ms                 |
| OneStep                   | 507.571 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.428 ms                  | 181.846 ms                |
| Forward                   | 5.063 ms                  | 21.170 ms                 |
| Backward                  | 360.842 ms                | 500.775 ms                |
| Optimize                  | 121.801 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 41.258 us                 | 80.257 us                 |
| BlockToStepN              | 53.875 us                 | 19.018 ms                 |
| OneStep                   | 505.100 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.375 ms                  | 181.846 ms                |
| Forward                   | 5.077 ms                  | 21.170 ms                 |
| Backward                  | 356.436 ms                | 500.775 ms                |
| Optimize                  | 121.792 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 40.483 us                 | 87.965 us                 |
| BlockToStepN              | 52.690 us                 | 19.018 ms                 |
| OneStep                   | 500.676 ms                | 812.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.428 ms                  | 181.846 ms                |
| Forward                   | 5.077 ms                  | 13.827 ms                 |
| Backward                  | 353.943 ms                | 489.132 ms                |
| Optimize                  | 121.527 ms                | 141.718 ms                |
| BarrierTimeBeforeRank0    | 40.249 us                 | 80.257 us                 |
| BlockToStepN              | 52.614 us                 | 16.803 ms                 |
| OneStep                   | 498.708 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.478 ms                  | 204.279 ms                |
| Forward                   | 5.077 ms                  | 13.827 ms                 |
| Backward                  | 353.943 ms                | 489.132 ms                |
| Optimize                  | 120.982 ms                | 141.718 ms                |
| BarrierTimeBeforeRank0    | 40.019 us                 | 80.257 us                 |
| BlockToStepN              | 52.690 us                 | 16.803 ms                 |
| OneStep                   | 497.983 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.478 ms                  | 204.279 ms                |
| Forward                   | 5.079 ms                  | 13.827 ms                 |
| Backward                  | 356.917 ms                | 489.132 ms                |
| Optimize                  | 121.017 ms                | 141.718 ms                |
| BarrierTimeBeforeRank0    | 39.710 us                 | 80.257 us                 |
| BlockToStepN              | 53.844 us                 | 16.803 ms                 |
| OneStep                   | 498.720 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.428 ms                  | 204.279 ms                |
| Forward                   | 5.084 ms                  | 21.170 ms                 |
| Backward                  | 358.972 ms                | 489.132 ms                |
| Optimize                  | 120.900 ms                | 141.718 ms                |
| BarrierTimeBeforeRank0    | 39.531 us                 | 80.257 us                 |
| BlockToStepN              | 52.614 us                 | 16.803 ms                 |
| OneStep                   | 500.676 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.421 ms                  | 204.279 ms                |
| Forward                   | 5.079 ms                  | 21.170 ms                 |
| Backward                  | 356.917 ms                | 489.132 ms                |
| Optimize                  | 120.900 ms                | 141.718 ms                |
| BarrierTimeBeforeRank0    | 39.531 us                 | 80.257 us                 |
| BlockToStepN              | 51.462 us                 | 16.803 ms                 |
| OneStep                   | 498.708 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 49.126, sample: 1.274, forward: 0.545, backward: 17.185, update: 0.305
[proc 1] 200 steps, total: 49.127, sample: 1.580, forward: 0.570, backward: 17.239, update: 0.307
[proc 4] 200 steps, total: 49.127, sample: 1.236, forward: 0.567, backward: 16.927, update: 0.317
[proc 3] 200 steps, total: 49.127, sample: 1.424, forward: 0.506, backward: 16.997, update: 0.296
[proc 2] 200 steps, total: 49.127, sample: 1.444, forward: 0.494, backward: 17.029, update: 0.317
[proc 5] 200 steps, total: 49.127, sample: 1.478, forward: 0.536, backward: 16.746, update: 0.304
[proc 6] 200 steps, total: 49.127, sample: 1.263, forward: 0.553, backward: 16.960, update: 0.303
[proc 0] 200 steps, total: 49.127, sample: 2.200, forward: 0.554, backward: 34.536, update: 11.581
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.428 ms                  | 204.279 ms                |
| Forward                   | 5.080 ms                  | 21.170 ms                 |
| Backward                  | 358.972 ms                | 489.132 ms                |
| Optimize                  | 120.900 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.318 us                 | 87.965 us                 |
| BlockToStepN              | 51.564 us                 | 16.803 ms                 |
| OneStep                   | 498.720 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.478 ms                  | 204.279 ms                |
| Forward                   | 5.084 ms                  | 21.170 ms                 |
| Backward                  | 360.842 ms                | 489.132 ms                |
| Optimize                  | 120.900 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.359 us                 | 87.965 us                 |
| BlockToStepN              | 52.625 us                 | 16.803 ms                 |
| OneStep                   | 502.120 ms                | 743.943 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.386 ms                  | 204.279 ms                |
| Forward                   | 5.098 ms                  | 21.170 ms                 |
| Backward                  | 359.892 ms                | 489.132 ms                |
| Optimize                  | 121.304 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.318 us                 | 87.965 us                 |
| BlockToStepN              | 51.910 us                 | 16.803 ms                 |
| OneStep                   | 500.676 ms                | 743.943 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.386 ms                  | 204.279 ms                |
| Forward                   | 5.098 ms                  | 21.170 ms                 |
| Backward                  | 359.892 ms                | 489.132 ms                |
| Optimize                  | 121.304 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.463 us                 | 87.965 us                 |
| BlockToStepN              | 51.910 us                 | 16.803 ms                 |
| OneStep                   | 500.676 ms                | 743.943 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.258 ms                  | 204.279 ms                |
| Forward                   | 5.097 ms                  | 21.170 ms                 |
| Backward                  | 360.842 ms                | 489.132 ms                |
| Optimize                  | 121.304 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.463 us                 | 87.965 us                 |
| BlockToStepN              | 52.607 us                 | 16.803 ms                 |
| OneStep                   | 500.676 ms                | 743.943 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.060 ms                  | 181.846 ms                |
| Forward                   | 5.086 ms                  | 13.827 ms                 |
| Backward                  | 361.120 ms                | 486.970 ms                |
| Optimize                  | 120.982 ms                | 143.920 ms                |
| BarrierTimeBeforeRank0    | 39.426 us                 | 80.257 us                 |
| BlockToStepN              | 52.690 us                 | 16.333 ms                 |
| OneStep                   | 500.651 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.817 ms                  | 181.846 ms                |
| Forward                   | 5.106 ms                  | 13.827 ms                 |
| Backward                  | 360.842 ms                | 486.970 ms                |
| Optimize                  | 120.900 ms                | 143.920 ms                |
| BarrierTimeBeforeRank0    | 39.463 us                 | 80.257 us                 |
| BlockToStepN              | 52.371 us                 | 16.333 ms                 |
| OneStep                   | 500.651 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.809 ms                  | 181.846 ms                |
| Forward                   | 5.109 ms                  | 13.827 ms                 |
| Backward                  | 359.892 ms                | 486.970 ms                |
| Optimize                  | 120.791 ms                | 143.920 ms                |
| BarrierTimeBeforeRank0    | 39.463 us                 | 80.257 us                 |
| BlockToStepN              | 51.741 us                 | 16.333 ms                 |
| OneStep                   | 498.622 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.764 ms                  | 181.846 ms                |
| Forward                   | 5.108 ms                  | 13.827 ms                 |
| Backward                  | 359.644 ms                | 486.970 ms                |
| Optimize                  | 120.900 ms                | 143.920 ms                |
| BarrierTimeBeforeRank0    | 39.531 us                 | 80.257 us                 |
| BlockToStepN              | 52.154 us                 | 16.333 ms                 |
| OneStep                   | 498.270 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.505 ms                  | 181.846 ms                |
| Forward                   | 5.106 ms                  | 13.827 ms                 |
| Backward                  | 359.644 ms                | 486.970 ms                |
| Optimize                  | 120.900 ms                | 144.621 ms                |
| BarrierTimeBeforeRank0    | 39.706 us                 | 80.257 us                 |
| BlockToStepN              | 52.629 us                 | 16.333 ms                 |
| OneStep                   | 497.983 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 50.414, sample: 1.126, forward: 0.537, backward: 16.834, update: 0.298
[proc 6] 300 steps, total: 50.414, sample: 1.144, forward: 0.539, backward: 16.583, update: 0.306
[proc 4] 300 steps, total: 50.414, sample: 1.137, forward: 0.543, backward: 16.603, update: 0.298
[proc 2] 300 steps, total: 50.414, sample: 1.278, forward: 0.507, backward: 16.744, update: 0.330
[proc 3] 300 steps, total: 50.414, sample: 1.174, forward: 0.528, backward: 16.799, update: 0.287
[proc 1] 300 steps, total: 50.414, sample: 1.317, forward: 0.523, backward: 17.047, update: 0.299
[proc 5] 300 steps, total: 50.414, sample: 1.134, forward: 0.529, backward: 16.640, update: 0.299
[proc 0] 300 steps, total: 50.414, sample: 1.564, forward: 0.518, backward: 36.461, update: 11.732
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.025 ms                  | 181.846 ms                |
| Forward                   | 5.114 ms                  | 13.827 ms                 |
| Backward                  | 357.935 ms                | 486.970 ms                |
| Optimize                  | 120.982 ms                | 145.284 ms                |
| BarrierTimeBeforeRank0    | 39.706 us                 | 87.965 us                 |
| BlockToStepN              | 52.154 us                 | 16.333 ms                 |
| OneStep                   | 496.002 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.341 ms                  | 181.846 ms                |
| Forward                   | 5.114 ms                  | 13.827 ms                 |
| Backward                  | 357.624 ms                | 486.970 ms                |
| Optimize                  | 121.017 ms                | 145.284 ms                |
| BarrierTimeBeforeRank0    | 39.895 us                 | 87.965 us                 |
| BlockToStepN              | 51.910 us                 | 16.333 ms                 |
| OneStep                   | 495.858 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.946 ms                  | 181.846 ms                |
| Forward                   | 5.115 ms                  | 13.827 ms                 |
| Backward                  | 356.917 ms                | 486.970 ms                |
| Optimize                  | 121.384 ms                | 147.137 ms                |
| BarrierTimeBeforeRank0    | 40.019 us                 | 87.965 us                 |
| BlockToStepN              | 52.371 us                 | 19.018 ms                 |
| OneStep                   | 495.476 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.690 ms                  | 181.846 ms                |
| Forward                   | 5.126 ms                  | 13.827 ms                 |
| Backward                  | 356.163 ms                | 486.970 ms                |
| Optimize                  | 121.527 ms                | 147.137 ms                |
| BarrierTimeBeforeRank0    | 40.019 us                 | 87.965 us                 |
| BlockToStepN              | 52.690 us                 | 19.018 ms                 |
| OneStep                   | 494.862 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.540 ms                  | 181.846 ms                |
| Forward                   | 5.133 ms                  | 21.170 ms                 |
| Backward                  | 354.450 ms                | 486.970 ms                |
| Optimize                  | 121.442 ms                | 147.137 ms                |
| BarrierTimeBeforeRank0    | 40.069 us                 | 87.965 us                 |
| BlockToStepN              | 52.607 us                 | 19.018 ms                 |
| OneStep                   | 494.862 ms                | 721.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.647 ms                  | 179.739 ms                |
| Forward                   | 5.126 ms                  | 13.827 ms                 |
| Backward                  | 354.020 ms                | 486.521 ms                |
| Optimize                  | 121.442 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.121 us                 | 80.257 us                 |
| BlockToStepN              | 52.625 us                 | 18.397 ms                 |
| OneStep                   | 493.681 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.244 ms                  | 179.739 ms                |
| Forward                   | 5.127 ms                  | 13.827 ms                 |
| Backward                  | 353.941 ms                | 486.521 ms                |
| Optimize                  | 121.442 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.176 us                 | 80.257 us                 |
| BlockToStepN              | 52.625 us                 | 18.397 ms                 |
| OneStep                   | 492.753 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.148 ms                  | 179.739 ms                |
| Forward                   | 5.123 ms                  | 13.827 ms                 |
| Backward                  | 353.941 ms                | 486.521 ms                |
| Optimize                  | 121.527 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.246 us                 | 80.257 us                 |
| BlockToStepN              | 52.969 us                 | 18.397 ms                 |
| OneStep                   | 492.545 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.772 ms                  | 179.739 ms                |
| Forward                   | 5.135 ms                  | 13.827 ms                 |
| Backward                  | 353.775 ms                | 486.521 ms                |
| Optimize                  | 121.527 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.390 us                 | 80.257 us                 |
| BlockToStepN              | 52.629 us                 | 18.397 ms                 |
| OneStep                   | 492.545 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.860 ms                  | 179.739 ms                |
| Forward                   | 5.133 ms                  | 13.827 ms                 |
| Backward                  | 353.411 ms                | 486.521 ms                |
| Optimize                  | 121.792 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.483 us                 | 87.965 us                 |
| BlockToStepN              | 52.625 us                 | 19.018 ms                 |
| OneStep                   | 492.545 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 48.620, sample: 1.067, forward: 0.545, backward: 16.368, update: 0.302
[proc 0] 400 steps, total: 48.620, sample: 1.340, forward: 0.553, backward: 34.426, update: 12.006
[proc 2] 400 steps, total: 48.620, sample: 1.151, forward: 0.520, backward: 16.598, update: 0.311
[proc 3] 400 steps, total: 48.620, sample: 1.089, forward: 0.514, backward: 16.692, update: 0.301
[proc 7] 400 steps, total: 48.620, sample: 1.086, forward: 0.531, backward: 16.591, update: 0.305
[proc 4] 400 steps, total: 48.620, sample: 1.060, forward: 0.554, backward: 16.358, update: 0.300
[proc 1] 400 steps, total: 48.620, sample: 1.147, forward: 0.542, backward: 17.085, update: 0.304
[proc 5] 400 steps, total: 48.620, sample: 1.033, forward: 0.534, backward: 16.425, update: 0.302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.006 ms                  | 179.739 ms                |
| Forward                   | 5.133 ms                  | 13.827 ms                 |
| Backward                  | 353.439 ms                | 486.521 ms                |
| Optimize                  | 121.801 ms                | 145.962 ms                |
| BarrierTimeBeforeRank0    | 40.599 us                 | 87.965 us                 |
| BlockToStepN              | 52.783 us                 | 19.018 ms                 |
| OneStep                   | 492.753 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.668 ms                  | 179.739 ms                |
| Forward                   | 5.133 ms                  | 13.827 ms                 |
| Backward                  | 353.775 ms                | 486.521 ms                |
| Optimize                  | 121.801 ms                | 150.453 ms                |
| BarrierTimeBeforeRank0    | 40.599 us                 | 87.965 us                 |
| BlockToStepN              | 53.015 us                 | 19.018 ms                 |
| OneStep                   | 492.753 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.504 ms                  | 179.739 ms                |
| Forward                   | 5.136 ms                  | 13.827 ms                 |
| Backward                  | 353.941 ms                | 486.521 ms                |
| Optimize                  | 121.801 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.614 us                 | 87.965 us                 |
| BlockToStepN              | 53.015 us                 | 19.018 ms                 |
| OneStep                   | 492.753 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.508 ms                  | 179.739 ms                |
| Forward                   | 5.135 ms                  | 13.827 ms                 |
| Backward                  | 353.439 ms                | 486.521 ms                |
| Optimize                  | 121.834 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.662 us                 | 87.965 us                 |
| BlockToStepN              | 53.041 us                 | 19.018 ms                 |
| OneStep                   | 491.923 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.440 ms                  | 179.739 ms                |
| Forward                   | 5.133 ms                  | 13.827 ms                 |
| Backward                  | 353.411 ms                | 486.521 ms                |
| Optimize                  | 121.834 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.662 us                 | 87.965 us                 |
| BlockToStepN              | 53.085 us                 | 19.018 ms                 |
| OneStep                   | 491.923 ms                | 699.636 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.318 ms                  | 164.394 ms                |
| Forward                   | 5.135 ms                  | 12.445 ms                 |
| Backward                  | 353.411 ms                | 484.585 ms                |
| Optimize                  | 121.834 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.747 us                 | 82.073 us                 |
| BlockToStepN              | 53.202 us                 | 18.397 ms                 |
| OneStep                   | 491.559 ms                | 684.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.119 ms                  | 164.394 ms                |
| Forward                   | 5.141 ms                  | 12.445 ms                 |
| Backward                  | 353.398 ms                | 484.585 ms                |
| Optimize                  | 122.016 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.877 us                 | 82.073 us                 |
| BlockToStepN              | 53.202 us                 | 18.397 ms                 |
| OneStep                   | 491.429 ms                | 684.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.140 ms                  | 164.394 ms                |
| Forward                   | 5.148 ms                  | 12.445 ms                 |
| Backward                  | 352.185 ms                | 484.585 ms                |
| Optimize                  | 122.033 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.886 us                 | 87.965 us                 |
| BlockToStepN              | 53.161 us                 | 18.397 ms                 |
| OneStep                   | 490.179 ms                | 684.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.140 ms                  | 164.394 ms                |
| Forward                   | 5.149 ms                  | 12.445 ms                 |
| Backward                  | 352.185 ms                | 484.585 ms                |
| Optimize                  | 122.025 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.771 us                 | 87.965 us                 |
| BlockToStepN              | 53.324 us                 | 18.397 ms                 |
| OneStep                   | 490.170 ms                | 684.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.065 ms                  | 164.394 ms                |
| Forward                   | 5.153 ms                  | 13.072 ms                 |
| Backward                  | 352.185 ms                | 484.585 ms                |
| Optimize                  | 122.069 ms                | 150.469 ms                |
| BarrierTimeBeforeRank0    | 40.771 us                 | 87.965 us                 |
| BlockToStepN              | 53.679 us                 | 18.397 ms                 |
| OneStep                   | 490.170 ms                | 684.271 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 500 steps, total: 49.548, sample: 1.094, forward: 0.505, backward: 16.269, update: 0.346
[proc 7] 500 steps, total: 49.548, sample: 1.100, forward: 0.512, backward: 16.507, update: 0.292
[proc 5] 500 steps, total: 49.548, sample: 1.056, forward: 0.502, backward: 16.224, update: 0.303
[proc 2] 500 steps, total: 49.548, sample: 1.089, forward: 0.545, backward: 16.463, update: 0.305
[proc 3] 500 steps, total: 49.548, sample: 1.116, forward: 0.516, backward: 16.440, update: 0.313
[proc 1] 500 steps, total: 49.548, sample: 1.078, forward: 0.469, backward: 17.059, update: 0.285
[proc 4] 500 steps, total: 49.548, sample: 1.111, forward: 0.546, backward: 16.152, update: 0.304
[proc 0] 500 steps, total: 49.548, sample: 1.251, forward: 0.527, backward: 35.508, update: 12.057
Successfully xmh. training takes 254.41612601280212 seconds
before call kg_cache_controller.StopThreads()
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
INFO [59590 controller_process.py:421] call rank0 to StopThreads
