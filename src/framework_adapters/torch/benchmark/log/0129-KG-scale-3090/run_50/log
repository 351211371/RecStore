WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 15:23:06.478045 19621 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_2', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [19621 sampler.py:454] Start PreSampling
WARNING [19621 sampler.py:532] Before construct renumbering_dict
WARNING [19621 sampler.py:555] PreSampling done
W20240129 15:41:26.157958 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 15:41:26.158144 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 15:41:26.158183 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 15:41:26.158214 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 15:41:26.158244 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 15:41:26.158283 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 15:41:26.158314 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 15:41:26.158368 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 15:41:26.158411 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 15:41:26.158444 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 15:41:26.158483 19621 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 15:41:26.158510 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 15:41:26.158541 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 15:41:26.158710 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 15:41:26.158752 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 15:41:26.158797 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 15:41:26.158854 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 15:41:26.158883 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 15:41:26.158916 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 15:41:26.158949 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 15:41:26.158993 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 15:41:26.159030 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 15:41:26.159057 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 15:41:26.159085 19621 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 15:41:26.159108 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 15:41:26.159133 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 15:41:26.159196 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 15:41:26.159238 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 15:41:26.159266 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 15:41:26.159298 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 15:41:26.159324 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 15:41:26.159351 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 15:41:26.159385 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 15:41:26.159412 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 15:41:26.159446 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 15:41:26.159477 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 15:41:26.159509 19621 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 15:41:26.159531 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 15:41:26.159554 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 15:41:26.159616 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 15:41:26.159647 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 15:41:26.159682 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 15:41:26.159714 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 15:41:26.159749 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 15:41:26.159776 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 15:41:26.159804 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 15:41:26.159832 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 15:41:26.159869 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 15:41:26.159899 19621 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 15:41:26.159933 19621 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 15:41:26.159956 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 15:41:26.159978 19621 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 15:41:26.567924 19621 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240129 15:41:26.568071 19621 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302705,   128216,  ..., 67596373, 16292635, 74593835]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1316.119 seconds
[Rank1] pid = 20415
[Rank2] pid = 20509
INFO [19621 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [19621 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20509 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [20576 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [20415 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20509 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20576 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20415 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 15:45:06.391497 20577 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240129 15:45:06.392730 20510 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240129 15:45:06.392796 20640 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240129 15:45:06.392803 20416 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240129 15:45:06.457007 20577 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036619000 7.629 MB
W20240129 15:45:06.457023 20510 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203755f000 7.629 MB
W20240129 15:45:06.457018 20640 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036dbc000 7.629 MB
W20240129 15:45:06.457078 20416 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102037d02000 7.629 MB
W20240129 15:45:06.457170 20577 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020384a5000 7.629 MB
W20240129 15:45:06.457202 20510 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102038c48000 7.629 MB
W20240129 15:45:06.457206 20640 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020393eb000 7.629 MB
W20240129 15:45:06.457221 20577 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102039b8e000 1.49 GB
W20240129 15:45:06.457269 20577 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102099914000 1.49 GB
W20240129 15:45:06.457267 20416 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102099171000 7.629 MB
W20240129 15:45:06.457286 20510 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1020f8ef7000 1.49 GB
W20240129 15:45:06.457291 20640 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021584da000 1.49 GB
W20240129 15:45:06.457334 20577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 15:45:06.457345 20416 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021b7abd000 1.49 GB
W20240129 15:45:06.457362 20510 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022170a0000 1.49 GB
W20240129 15:45:06.457369 20640 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102276683000 1.49 GB
W20240129 15:45:06.457410 20416 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022d5c66000 1.49 GB
W20240129 15:45:06.457427 20510 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 15:45:06.457433 20640 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 15:45:06.457460 20416 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 15:45:06.465024 20577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 15:45:06.465042 20510 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 15:45:06.465055 20640 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 15:45:06.465090 20416 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [20576 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 20576
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [19621 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [20509 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [20415 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 15:45:39.668522 20416 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 15:45:39.668612 20510 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 15:45:39.668713 20577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 15:45:39.668808 20640 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240129 15:45:39.670572 20577 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 15:45:39.670861 20577 grad_base.h:184] Init GradProcessingBase done
I20240129 15:45:52.756795 20577 grad_async_v1.h:199] Use main thread to update emb.
W20240129 15:45:52.757097 20577 kg_controller.h:75] after init GradAsyncProcessing
I20240129 15:45:52.757107 20577 kg_controller.h:84] Construct KGCacheController done
E20240129 15:45:54.200737 20416 recstore.cc:66] init folly done
E20240129 15:45:54.200752 20640 recstore.cc:66] init folly done
E20240129 15:45:54.200873 20577 recstore.cc:66] init folly done
E20240129 15:45:54.200876 20510 recstore.cc:66] init folly done
I20240129 15:45:54.201745 20577 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 15:46:06.703785 20940 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 15:46:08.693140 20940 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 15:46:12.807082 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240129 15:46:12.917737 20640 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
W20240129 15:46:15.564373 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240129 15:46:15.669119 20416 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 15:46:16.572057 20577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 15:46:16.699728 20940 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end0
W20240129 15:46:18.041282 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240129 15:46:18.148444 20510 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 15:46:19.615798 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.077 ms                  | 8.077 ms                  |
| Forward                   | 709.305 ms                | 709.305 ms                |
| Backward                  | 187.974 ms                | 187.974 ms                |
| Optimize                  | 4.842 ms                  | 4.842 ms                  |
| BarrierTimeBeforeRank0    | 103.126 us                | 103.126 us                |
| AfterBackward             | 556.098 ms                | 556.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:20.001173 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:46:20.666704 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240129 15:46:21.009501 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 15:46:21.977300 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240129 15:46:22.015308 20940 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 15:46:22.977007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240129 15:46:23.027299 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:46:23.977008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240129 15:46:24.191830 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.399 ms                  | 170.988 ms                |
| ProcessBack:UpdateCache   | 2.529 ms                  | 264.927 ms                |
| ProcessBack:UpsertPq      | 18.538 ms                 | 36.932 ms                 |
| ProcessOneStep            | 25.827 ms                 | 555.843 ms                |
| BlockToStepN              | 319.410 ms                | 375.892 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.077 ms                  | 92.741 ms                 |
| Forward                   | 5.224 ms                  | 709.305 ms                |
| Backward                  | 9.722 ms                  | 187.974 ms                |
| Optimize                  | 2.618 ms                  | 5.963 ms                  |
| BarrierTimeBeforeRank0    | 833.072 us                | 205.921 ms                |
| AfterBackward             | 26.590 ms                 | 556.098 ms                |
| BlockToStepN              | 5.780 ms                  | 376.717 ms                |
| OneStep                   | 309.703 ms                | 1.844 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:24.977007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240129 15:46:25.218067 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:46:25.977008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240129 15:46:26.273216 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 15:46:26.977007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240129 15:46:27.309491 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240129 15:46:27.977016 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240129 15:46:28.407099 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:46:28.977008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.399 ms                  | 130.569 ms                |
| ProcessBack:UpdateCache   | 2.616 ms                  | 264.135 ms                |
| ProcessBack:UpsertPq      | 20.041 ms                 | 45.490 ms                 |
| ProcessOneStep            | 29.938 ms                 | 555.843 ms                |
| BlockToStepN              | 5.739 ms                  | 429.203 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.019 ms                  | 103.651 ms                |
| Forward                   | 5.257 ms                  | 709.305 ms                |
| Backward                  | 9.792 ms                  | 187.974 ms                |
| Optimize                  | 2.567 ms                  | 5.963 ms                  |
| BarrierTimeBeforeRank0    | 76.029 us                 | 205.921 ms                |
| AfterBackward             | 30.045 ms                 | 556.098 ms                |
| BlockToStepN              | 211.605 ms                | 429.283 ms                |
| OneStep                   | 309.703 ms                | 1.844 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:29.683050 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:46:29.977010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240129 15:46:30.746837 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:46:30.977011 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240129 15:46:31.804802 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:46:31.977010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240129 15:46:32.819568 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:46:32.977008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240129 15:46:33.820325 20940 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 15:46:34.047400 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.641 ms                  | 130.569 ms                |
| ProcessBack:UpdateCache   | 2.759 ms                  | 264.135 ms                |
| ProcessBack:UpsertPq      | 19.352 ms                 | 45.490 ms                 |
| ProcessOneStep            | 28.236 ms                 | 66.969 ms                 |
| BlockToStepN              | 5.739 ms                  | 431.579 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.891 ms                  | 99.387 ms                 |
| Forward                   | 5.195 ms                  | 11.488 ms                 |
| Backward                  | 9.794 ms                  | 16.927 ms                 |
| Optimize                  | 2.751 ms                  | 5.963 ms                  |
| BarrierTimeBeforeRank0    | 52.441 us                 | 63.730 ms                 |
| AfterBackward             | 28.276 ms                 | 67.003 ms                 |
| BlockToStepN              | 5.780 ms                  | 431.651 ms                |
| OneStep                   | 223.043 ms                | 569.179 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:34.821782 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 15:46:35.047010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240129 15:46:35.841945 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:46:36.139981 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240129 15:46:36.841706 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:46:37.231662 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240129 15:46:38.006721 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:46:38.231007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240129 15:46:39.086216 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.788 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.982 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 19.839 ms                 | 37.945 ms                 |
| ProcessOneStep            | 28.491 ms                 | 66.969 ms                 |
| BlockToStepN              | 5.739 ms                  | 431.579 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:39.231009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.390 ms                  | 99.387 ms                 |
| Forward                   | 5.101 ms                  | 11.488 ms                 |
| Backward                  | 12.300 ms                 | 17.055 ms                 |
| Optimize                  | 2.940 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 42.107 us                 | 63.730 ms                 |
| AfterBackward             | 28.527 ms                 | 67.003 ms                 |
| BlockToStepN              | 5.780 ms                  | 431.651 ms                |
| OneStep                   | 204.419 ms                | 569.179 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:40.120229 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 15:46:40.231009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.674, sample: 1.271, forward: 1.180, backward: 1.198, update: 0.259
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.443, sample: 1.529, forward: 1.166, backward: 1.210, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.922, sample: 1.196, forward: 1.193, backward: 1.008, update: 0.239
train_sampler.Prefill()
-------Step 0-------
tensor([ 1041601,   475482, 37425583,   475503,   551445,   475528,   475552,
          260741,    72548,    72587]) tensor([ 5065435, 31931622, 19459110, 63987027, 65878264, 36226533, 73126244,
        78612236, 49545505, 67108885])
-------Step 1-------
tensor([ 1041601,   475482, 37425583,   475503,   551445,   475528,   475552,
          260741,    72548,    72587]) tensor([23901034, 62093156, 79992478, 11557096, 70928661,  9751762, 74071661,
        65918227, 17011958, 41470473])
-------Step 2-------
tensor([543829,  87931,  87973,  88021, 543854, 543877, 543900, 556671, 543925,
        543948]) tensor([42808403,  5137167, 48142924, 11947384, 19248086, 13548524, 51618742,
         8374259, 65275878, 26238322])
-------Step 3-------
tensor([543829,  87931,  87973,  88021, 543854, 543877, 543900, 556671, 543925,
        543948]) tensor([15565749, 54845235, 84658486, 31658350, 16529281, 58516802, 64077600,
        70677437, 18950759, 79514235])
-------Step 4-------
tensor([611047, 104536, 611074, 611095, 104581, 611123, 104625, 611143, 104667,
        611164]) tensor([73815174, 33320708, 20209163, 15623447, 66778617, 36917791, 81385380,
        54575260, 46072401,  9930545])
-------Step 5-------
tensor([611047, 104536, 611074, 611095, 104581, 611123, 104625, 611143, 104667,
        611164]) tensor([41030852, 37529282, 72824745, 10395856, 44082358, 25547009, 44918545,
        57298627, 85470675,   586725])
-------Step 6-------
tensor([61919877,   678837,   678862,   678888,  4308779,   678911,   678931,
          678959,   678982,   267078]) tensor([22660842, 50561664, 27165435, 25844533, 80469022, 46050393, 51033358,
        16940908, 75097518,  7460640])
-------Step 7-------
tensor([61919877,   678837,   678862,   678888,  4308779,   678911,   678931,
          678959,   678982,   267078]) tensor([42063459, 85630840, 63134788, 58355989, 75331935,  1742744, 20514949,
        62213263, 17236480, 13376107])
-------Step 8-------
tensor([  745457,   138078,   745483, 28072076,   745505,   952745,   745526,
          745551,   268902,   745579]) tensor([32204377, 48302881, 55905218, 84363425, 82040100, 52162695, 51971889,
        80501680, 11788062, 13262873])
-------Step 9-------
tensor([  745457,   138078,   745483, 28072076,   745505,   952745,   745526,
          745551,   268902,   745579]) tensor([60800772, 52526421, 20911673, 32687697, 10344327,  1008816, 23148426,
        16039017, 81462608, 41435425])
before start barrier
start train
[proc 0] 100 steps, total: 24.019, sample: 1.580, forward: 1.227, backward: 1.333, update: 0.321
W20240129 15:46:41.136102 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:46:41.231007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240129 15:46:42.194605 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 15:46:42.231002 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240129 15:46:43.231009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240129 15:46:43.308254 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.743 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.877 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 19.005 ms                 | 38.274 ms                 |
| ProcessOneStep            | 27.539 ms                 | 66.969 ms                 |
| BlockToStepN              | 6.777 ms                  | 431.579 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:44.231009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240129 15:46:44.403101 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.465 ms                  | 99.387 ms                 |
| Forward                   | 5.077 ms                  | 11.488 ms                 |
| Backward                  | 12.326 ms                 | 17.055 ms                 |
| Optimize                  | 2.911 ms                  | 9.371 ms                  |
| BarrierTimeBeforeRank0    | 41.093 us                 | 63.730 ms                 |
| AfterBackward             | 27.495 ms                 | 67.003 ms                 |
| BlockToStepN              | 6.830 ms                  | 431.651 ms                |
| OneStep                   | 203.165 ms                | 569.179 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:45.250288 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240129 15:46:45.529137 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end1
W20240129 15:46:46.250010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240129 15:46:46.561004 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end7
W20240129 15:46:47.250010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240129 15:46:47.693514 20940 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end1
W20240129 15:46:48.250011 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240129 15:46:48.714012 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.714 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.841 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 18.992 ms                 | 54.187 ms                 |
| ProcessOneStep            | 27.539 ms                 | 83.189 ms                 |
| BlockToStepN              | 6.777 ms                  | 431.579 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:49.250008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.526 ms                  | 99.387 ms                 |
| Forward                   | 5.084 ms                  | 11.488 ms                 |
| Backward                  | 12.327 ms                 | 17.452 ms                 |
| Optimize                  | 2.885 ms                  | 9.371 ms                  |
| BarrierTimeBeforeRank0    | 40.728 us                 | 63.730 ms                 |
| AfterBackward             | 27.546 ms                 | 83.223 ms                 |
| BlockToStepN              | 6.830 ms                  | 431.651 ms                |
| OneStep                   | 203.165 ms                | 569.179 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:49.776583 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:46:50.250010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240129 15:46:50.819885 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:46:51.250011 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240129 15:46:51.822583 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 15:46:52.252892 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240129 15:46:52.902590 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:46:53.252033 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240129 15:46:54.174659 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.722 ms                  | 7.117 ms                  |
| ProcessBack:UpdateCache   | 2.799 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 18.754 ms                 | 56.139 ms                 |
| ProcessOneStep            | 27.500 ms                 | 68.576 ms                 |
| BlockToStepN              | 147.308 ms                | 429.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:54.252007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=168, pq.top=168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.783 ms                  | 98.936 ms                 |
| Forward                   | 5.041 ms                  | 9.530 ms                  |
| Backward                  | 12.148 ms                 | 17.055 ms                 |
| Optimize                  | 2.852 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 36.377 us                 | 57.529 ms                 |
| AfterBackward             | 27.530 ms                 | 68.616 ms                 |
| BlockToStepN              | 147.366 ms                | 429.283 ms                |
| OneStep                   | 203.364 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:55.201256 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 15:46:55.252003 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240129 15:46:56.248807 20940 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 15:46:56.252003 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240129 15:46:57.252007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240129 15:46:57.326525 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:46:58.252009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240129 15:46:58.342207 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.695 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.791 ms                  | 6.154 ms                  |
| ProcessBack:UpsertPq      | 18.532 ms                 | 54.187 ms                 |
| ProcessOneStep            | 27.004 ms                 | 68.576 ms                 |
| BlockToStepN              | 147.308 ms                | 429.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:46:59.279903 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240129 15:46:59.356066 20940 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.465 ms                  | 98.936 ms                 |
| Forward                   | 4.988 ms                  | 9.530 ms                  |
| Backward                  | 11.986 ms                 | 17.055 ms                 |
| Optimize                  | 2.805 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 38.065 us                 | 57.529 ms                 |
| AfterBackward             | 27.014 ms                 | 68.616 ms                 |
| BlockToStepN              | 147.366 ms                | 429.283 ms                |
| OneStep                   | 203.364 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:00.279008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240129 15:47:00.539736 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 15:47:01.279006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240129 15:47:01.589819 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 1] 200 steps, total: 21.056, sample: 1.204, forward: 0.446, backward: 0.914, update: 0.223
[proc 0] 200 steps, total: 21.056, sample: 1.379, forward: 0.499, backward: 1.044, update: 0.303
[proc 3] 200 steps, total: 21.056, sample: 1.099, forward: 0.459, backward: 1.046, update: 0.216
[proc 2] 200 steps, total: 21.056, sample: 1.476, forward: 0.491, backward: 1.007, update: 0.222
W20240129 15:47:02.279007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240129 15:47:02.611479 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:47:03.279006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240129 15:47:03.826004 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.647 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.780 ms                  | 6.154 ms                  |
| ProcessBack:UpsertPq      | 18.226 ms                 | 54.187 ms                 |
| ProcessOneStep            | 26.276 ms                 | 68.576 ms                 |
| BlockToStepN              | 6.777 ms                  | 429.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:04.279006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.465 ms                  | 98.936 ms                 |
| Forward                   | 4.968 ms                  | 9.530 ms                  |
| Backward                  | 11.081 ms                 | 17.055 ms                 |
| Optimize                  | 2.768 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 44.337 us                 | 63.730 ms                 |
| AfterBackward             | 26.220 ms                 | 68.616 ms                 |
| BlockToStepN              | 6.830 ms                  | 429.283 ms                |
| OneStep                   | 203.165 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:04.838578 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:47:05.279006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240129 15:47:05.848513 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:06.279008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240129 15:47:06.872071 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:47:07.379773 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240129 15:47:07.897416 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:08.379005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240129 15:47:08.935319 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.571 ms                  | 5.349 ms                  |
| ProcessBack:UpdateCache   | 2.774 ms                  | 6.097 ms                  |
| ProcessBack:UpsertPq      | 17.748 ms                 | 53.391 ms                 |
| ProcessOneStep            | 25.481 ms                 | 68.576 ms                 |
| BlockToStepN              | 6.777 ms                  | 429.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:09.379006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.425 ms                  | 98.936 ms                 |
| Forward                   | 4.982 ms                  | 11.488 ms                 |
| Backward                  | 10.328 ms                 | 17.055 ms                 |
| Optimize                  | 2.746 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 55.627 us                 | 63.730 ms                 |
| AfterBackward             | 25.512 ms                 | 68.616 ms                 |
| BlockToStepN              | 6.830 ms                  | 429.283 ms                |
| OneStep                   | 196.596 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:10.053645 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end6
W20240129 15:47:10.492758 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240129 15:47:11.175459 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end4
W20240129 15:47:11.492005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240129 15:47:12.176009 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end2
W20240129 15:47:12.562929 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240129 15:47:13.296804 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end1
W20240129 15:47:13.583971 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.552 ms                  | 5.349 ms                  |
| ProcessBack:UpdateCache   | 2.772 ms                  | 5.985 ms                  |
| ProcessBack:UpsertPq      | 17.440 ms                 | 52.021 ms                 |
| ProcessOneStep            | 25.163 ms                 | 66.969 ms                 |
| BlockToStepN              | 6.777 ms                  | 421.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:14.402411 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.851 ms                  | 94.856 ms                 |
| Forward                   | 4.977 ms                  | 9.530 ms                  |
| Backward                  | 10.254 ms                 | 17.052 ms                 |
| Optimize                  | 2.728 ms                  | 5.993 ms                  |
| BarrierTimeBeforeRank0    | 61.027 us                 | 57.529 ms                 |
| AfterBackward             | 25.167 ms                 | 67.003 ms                 |
| BlockToStepN              | 6.830 ms                  | 421.976 ms                |
| OneStep                   | 195.764 ms                | 543.923 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:14.706187 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240129 15:47:15.508852 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end7
W20240129 15:47:15.706005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240129 15:47:16.597993 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end5
W20240129 15:47:16.839602 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=297, pq.top=297
[proc 0] 300 steps, total: 15.631, sample: 1.031, forward: 0.502, backward: 0.760, update: 0.276
[proc 1] 300 steps, total: 15.631, sample: 1.142, forward: 0.470, backward: 0.814, update: 0.222
[proc 2] 300 steps, total: 15.630, sample: 1.396, forward: 0.479, backward: 0.922, update: 0.243
[proc 3] 300 steps, total: 15.631, sample: 1.006, forward: 0.467, backward: 1.025, update: 0.224
W20240129 15:47:17.736814 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end4
W20240129 15:47:17.839010 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240129 15:47:18.743710 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:18.839008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.548 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.742 ms                  | 5.985 ms                  |
| ProcessBack:UpsertPq      | 17.238 ms                 | 52.021 ms                 |
| ProcessOneStep            | 24.996 ms                 | 68.576 ms                 |
| BlockToStepN              | 6.777 ms                  | 421.901 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.676 ms                  | 94.856 ms                 |
| Forward                   | 4.965 ms                  | 9.530 ms                  |
| Backward                  | 10.407 ms                 | 17.055 ms                 |
| Optimize                  | 2.700 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 61.027 us                 | 57.529 ms                 |
| AfterBackward             | 25.030 ms                 | 68.616 ms                 |
| BlockToStepN              | 6.830 ms                  | 421.976 ms                |
| OneStep                   | 164.265 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:19.744990 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240129 15:47:19.899178 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240129 15:47:20.762079 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 15:47:20.899005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240129 15:47:21.786000 20940 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 15:47:21.899003 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240129 15:47:22.866580 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:22.969830 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240129 15:47:23.879243 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 15:47:23.990024 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.529 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.735 ms                  | 5.985 ms                  |
| ProcessBack:UpsertPq      | 17.311 ms                 | 50.999 ms                 |
| ProcessOneStep            | 24.996 ms                 | 68.576 ms                 |
| BlockToStepN              | 6.777 ms                  | 421.901 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.765 ms                  | 94.856 ms                 |
| Forward                   | 4.944 ms                  | 10.388 ms                 |
| Backward                  | 10.375 ms                 | 17.055 ms                 |
| Optimize                  | 2.657 ms                  | 7.165 ms                  |
| BarrierTimeBeforeRank0    | 58.086 us                 | 57.529 ms                 |
| AfterBackward             | 25.054 ms                 | 68.616 ms                 |
| BlockToStepN              | 6.830 ms                  | 421.976 ms                |
| OneStep                   | 159.009 ms                | 555.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:24.898175 20940 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 15:47:24.990003 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240129 15:47:25.905400 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:47:25.990005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240129 15:47:26.990006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240129 15:47:27.250900 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:27.990007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240129 15:47:28.258530 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:47:28.990018 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.526 ms                  | 6.270 ms                  |
| ProcessBack:UpdateCache   | 2.726 ms                  | 5.985 ms                  |
| ProcessBack:UpsertPq      | 17.198 ms                 | 50.999 ms                 |
| ProcessOneStep            | 24.980 ms                 | 66.969 ms                 |
| BlockToStepN              | 6.777 ms                  | 410.570 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:29.435271 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.673 ms                  | 92.741 ms                 |
| Forward                   | 4.933 ms                  | 9.530 ms                  |
| Backward                  | 10.382 ms                 | 17.052 ms                 |
| Optimize                  | 2.648 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 61.156 us                 | 50.183 ms                 |
| AfterBackward             | 25.030 ms                 | 67.003 ms                 |
| BlockToStepN              | 6.830 ms                  | 410.641 ms                |
| OneStep                   | 159.009 ms                | 543.923 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:29.990006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240129 15:47:30.449637 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:47:30.990006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240129 15:47:31.520758 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:31.990006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240129 15:47:32.527212 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:33.038672 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240129 15:47:33.534937 20940 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 15:47:34.038007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.526 ms                  | 6.238 ms                  |
| ProcessBack:UpdateCache   | 2.714 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 17.231 ms                 | 50.839 ms                 |
| ProcessOneStep            | 25.000 ms                 | 66.969 ms                 |
| BlockToStepN              | 6.777 ms                  | 410.570 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:34.676577 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.608 ms                  | 92.741 ms                 |
| Forward                   | 4.933 ms                  | 9.530 ms                  |
| Backward                  | 10.432 ms                 | 17.052 ms                 |
| Optimize                  | 2.621 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 53.035 us                 | 50.183 ms                 |
| AfterBackward             | 25.030 ms                 | 67.003 ms                 |
| BlockToStepN              | 100.916 ms                | 410.641 ms                |
| OneStep                   | 159.159 ms                | 543.923 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 17.449, sample: 1.002, forward: 0.452, backward: 0.807, update: 0.248
[proc 2] 400 steps, total: 17.449, sample: 1.057, forward: 0.476, backward: 0.903, update: 0.254
[proc 3] 400 steps, total: 17.449, sample: 1.046, forward: 0.463, backward: 1.027, update: 0.227
[proc 0] 400 steps, total: 17.449, sample: 1.134, forward: 0.486, backward: 1.013, update: 0.281
W20240129 15:47:35.038007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=401, pq.top=401
W20240129 15:47:35.683633 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:47:36.038007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240129 15:47:36.684182 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:37.038007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240129 15:47:37.726781 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240129 15:47:38.038007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240129 15:47:38.893720 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:39.038005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.525 ms                  | 6.238 ms                  |
| ProcessBack:UpdateCache   | 2.707 ms                  | 5.171 ms                  |
| ProcessBack:UpsertPq      | 17.169 ms                 | 50.839 ms                 |
| ProcessOneStep            | 24.978 ms                 | 66.969 ms                 |
| BlockToStepN              | 38.720 ms                 | 410.570 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.567 ms                  | 92.741 ms                 |
| Forward                   | 4.931 ms                  | 9.530 ms                  |
| Backward                  | 10.397 ms                 | 17.052 ms                 |
| Optimize                  | 2.617 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 53.035 us                 | 50.183 ms                 |
| AfterBackward             | 24.996 ms                 | 67.003 ms                 |
| BlockToStepN              | 41.593 ms                 | 410.641 ms                |
| OneStep                   | 159.009 ms                | 543.923 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:39.900143 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:40.066538 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240129 15:47:40.907164 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240129 15:47:41.066005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240129 15:47:42.066006 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240129 15:47:42.101540 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:43.066007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=436, pq.top=436
W20240129 15:47:43.119002 20940 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 15:47:44.137642 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:44.191747 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=441, pq.top=441
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.516 ms                  | 5.349 ms                  |
| ProcessBack:UpdateCache   | 2.699 ms                  | 5.113 ms                  |
| ProcessBack:UpsertPq      | 17.076 ms                 | 50.561 ms                 |
| ProcessOneStep            | 24.887 ms                 | 66.969 ms                 |
| BlockToStepN              | 41.557 ms                 | 410.570 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.488 ms                  | 92.741 ms                 |
| Forward                   | 4.924 ms                  | 9.530 ms                  |
| Backward                  | 10.397 ms                 | 17.052 ms                 |
| Optimize                  | 2.598 ms                  | 6.370 ms                  |
| BarrierTimeBeforeRank0    | 72.053 us                 | 57.529 ms                 |
| AfterBackward             | 24.867 ms                 | 67.003 ms                 |
| BlockToStepN              | 41.593 ms                 | 410.641 ms                |
| OneStep                   | 159.009 ms                | 543.923 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:45.151427 20940 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 15:47:45.191002 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240129 15:47:46.191007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240129 15:47:46.291461 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:47.205902 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240129 15:47:47.487329 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 15:47:48.205008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240129 15:47:48.741487 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:49.206411 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=464, pq.top=464
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.520 ms                  | 6.238 ms                  |
| ProcessBack:UpdateCache   | 2.690 ms                  | 5.113 ms                  |
| ProcessBack:UpsertPq      | 16.911 ms                 | 50.561 ms                 |
| ProcessOneStep            | 24.779 ms                 | 59.530 ms                 |
| BlockToStepN              | 100.868 ms                | 401.397 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.358 ms                  | 84.939 ms                 |
| Forward                   | 4.922 ms                  | 9.232 ms                  |
| Backward                  | 10.375 ms                 | 16.927 ms                 |
| Optimize                  | 2.587 ms                  | 5.993 ms                  |
| BarrierTimeBeforeRank0    | 112.373 us                | 50.183 ms                 |
| AfterBackward             | 24.811 ms                 | 59.569 ms                 |
| BlockToStepN              | 41.593 ms                 | 401.456 ms                |
| OneStep                   | 159.009 ms                | 535.282 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:50.038498 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:50.206009 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240129 15:47:51.082098 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:51.206007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240129 15:47:52.206005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240129 15:47:52.401923 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 15:47:53.206005 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240129 15:47:53.403915 20940 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 15:47:54.206007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=485, pq.top=485
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.511 ms                  | 5.349 ms                  |
| ProcessBack:UpdateCache   | 2.683 ms                  | 5.094 ms                  |
| ProcessBack:UpsertPq      | 16.929 ms                 | 50.561 ms                 |
| ProcessOneStep            | 24.881 ms                 | 60.761 ms                 |
| BlockToStepN              | 54.712 ms                 | 401.397 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:54.408546 20940 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.427 ms                  | 89.585 ms                 |
| Forward                   | 4.916 ms                  | 9.232 ms                  |
| Backward                  | 10.397 ms                 | 16.927 ms                 |
| Optimize                  | 2.589 ms                  | 5.993 ms                  |
| BarrierTimeBeforeRank0    | 103.126 us                | 50.183 ms                 |
| AfterBackward             | 24.915 ms                 | 60.791 ms                 |
| BlockToStepN              | 54.755 ms                 | 401.456 ms                |
| OneStep                   | 159.009 ms                | 535.282 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 15:47:55.206007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240129 15:47:55.433887 20940 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 15:47:56.206008 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240129 15:47:56.453728 20940 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 15:47:57.206007 20577 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240129 15:47:57.504447 20940 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
[proc 0] 500 steps, total: 23.361, sample: 1.051, forward: 0.479, backward: 0.964, update: 0.276
[proc 3] 500 steps, total: 23.361, sample: 0.961, forward: 0.484, backward: 0.986, update: 0.231
[proc 1] 500 steps, total: 23.361, sample: 1.002, forward: 0.455, backward: 0.969, update: 0.221
Successfully xmh. training takes 101.51695203781128 seconds
[proc 2] 500 steps, total: 23.361, sample: 1.311, forward: 0.488, backward: 0.966, update: 0.245
before call kg_cache_controller.StopThreads()
W20240129 15:47:58.089032 20577 grad_async_v1.h:230] call StopThreads. PID = 19621
W20240129 15:47:58.089057 20577 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 15:47:58.093853 20577 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 15:47:58.093868 20577 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 15:47:58.105619 20577 grad_async_v1.h:251] StopThreads done.
