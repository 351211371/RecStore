WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 00:54:15.391907  2468 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_20', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2468 sampler.py:454] Start PreSampling
WARNING [2468 sampler.py:532] Before construct renumbering_dict
WARNING [2468 sampler.py:555] PreSampling done
W20240130 01:14:33.767184  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 01:14:33.767410  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 01:14:33.767448  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 01:14:33.767485  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 01:14:33.767519  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 01:14:33.767546  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 01:14:33.767586  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 01:14:33.767625  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 01:14:33.767652  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 01:14:33.767680  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 01:14:33.767717  2468 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 01:14:33.767746  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 01:14:33.767783  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 01:14:33.767956  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 01:14:33.768002  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 01:14:33.768041  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 01:14:33.768101  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 01:14:33.768137  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 01:14:33.768177  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 01:14:33.768205  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 01:14:33.768230  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 01:14:33.768260  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 01:14:33.768290  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 01:14:33.768328  2468 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 01:14:33.768352  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 01:14:33.768373  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 01:14:33.768427  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 01:14:33.768456  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 01:14:33.768481  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 01:14:33.768507  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 01:14:33.768532  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 01:14:33.768566  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 01:14:33.768611  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 01:14:33.768637  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 01:14:33.768668  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 01:14:33.768700  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 01:14:33.768729  2468 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 01:14:33.768751  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 01:14:33.768777  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 01:14:33.768836  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 01:14:33.768864  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 01:14:33.768891  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 01:14:33.768920  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 01:14:33.768945  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 01:14:33.768971  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 01:14:33.769016  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 01:14:33.769047  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 01:14:33.769078  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 01:14:33.769112  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 01:14:33.769140  2468 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 01:14:33.769162  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 01:14:33.769188  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 01:14:33.769256  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 01:14:33.769286  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 01:14:33.769316  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 01:14:33.769344  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 01:14:33.769372  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 01:14:33.769404  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 01:14:33.769433  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 01:14:33.769459  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 01:14:33.769493  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 01:14:33.769526  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 01:14:33.769554  2468 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 01:14:33.769577  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 01:14:33.769598  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 01:14:33.769661  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 01:14:33.769694  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 01:14:33.769726  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 01:14:33.769757  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 01:14:33.769791  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 01:14:33.769820  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 01:14:33.769846  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 01:14:33.769878  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 01:14:33.769912  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 01:14:33.769942  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 01:14:33.769975  2468 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 01:14:33.769997  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 01:14:33.770020  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 01:14:33.770067  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240130 01:14:33.770113  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240130 01:14:33.770148  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240130 01:14:33.770176  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240130 01:14:33.770203  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240130 01:14:33.770236  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240130 01:14:33.770268  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240130 01:14:33.770303  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240130 01:14:33.770331  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240130 01:14:33.770371  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240130 01:14:33.770407  2468 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240130 01:14:33.770431  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240130 01:14:33.770457  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240130 01:14:33.770506  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240130 01:14:33.770543  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240130 01:14:33.770581  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240130 01:14:33.770609  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240130 01:14:33.770650  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240130 01:14:33.770677  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240130 01:14:33.770720  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240130 01:14:33.770750  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240130 01:14:33.770797  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240130 01:14:33.770831  2468 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240130 01:14:33.770862  2468 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240130 01:14:33.770885  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240130 01:14:33.770907  2468 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240130 01:14:34.264346  2468 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240130 01:14:34.264514  2468 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605410,  8605423,    73076,  ..., 60986827, 57135617,  9209783]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1726.866 seconds
[Rank1] pid = 3379
[Rank2] pid = 3473
[Rank3] pid = 3540
[Rank4] pid = 3607
[Rank5] pid = 3676
[Rank6] pid = 3743
INFO [2468 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3473 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3540 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3379 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3607 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [3676 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [3810 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [3743 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [3810 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3676 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3743 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3473 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3540 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3379 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [3607 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2468 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240130 01:23:13.388113  3811 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240130 01:23:13.389004  3608 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240130 01:23:13.389146  3744 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240130 01:23:13.389155  3474 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240130 01:23:13.389158  3541 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240130 01:23:13.389158  3677 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240130 01:23:13.389163  3380 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240130 01:23:13.389163  3874 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240130 01:23:13.528740  3811 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204b63d000 7.629 MB
W20240130 01:23:13.528730  3608 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102049f54000 7.629 MB
W20240130 01:23:13.528729  3677 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020497b1000 7.629 MB
W20240130 01:23:13.528735  3380 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204a6f7000 7.629 MB
W20240130 01:23:13.528738  3874 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204ae9a000 7.629 MB
W20240130 01:23:13.528836  3541 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204bde0000 7.629 MB
W20240130 01:23:13.528841  3744 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204c583000 7.629 MB
W20240130 01:23:13.528844  3474 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204cd26000 7.629 MB
W20240130 01:23:13.529412  3744 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204d4c9000 7.629 MB
W20240130 01:23:13.529430  3474 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204dc6c000 7.629 MB
W20240130 01:23:13.529435  3677 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10204e40f000 7.629 MB
W20240130 01:23:13.529440  3608 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204ebb2000 7.629 MB
W20240130 01:23:13.529451  3541 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204f355000 7.629 MB
W20240130 01:23:13.529456  3380 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204faf8000 7.629 MB
W20240130 01:23:13.529467  3874 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10205029b000 7.629 MB
W20240130 01:23:13.529500  3811 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102050a3e000 7.629 MB
W20240130 01:23:13.529536  3380 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1020511e1000 1.49 GB
W20240130 01:23:13.529608  3874 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1020b07c4000 1.49 GB
W20240130 01:23:13.529613  3380 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10210fda7000 1.49 GB
W20240130 01:23:13.529628  3608 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10216f38a000 1.49 GB
W20240130 01:23:13.529634  3677 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021ce96d000 1.49 GB
W20240130 01:23:13.529640  3541 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10222df50000 1.49 GB
W20240130 01:23:13.529642  3811 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10228d533000 1.49 GB
W20240130 01:23:13.529649  3474 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1022ecb16000 1.49 GB
W20240130 01:23:13.529664  3744 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10234c0f9000 1.49 GB
W20240130 01:23:13.529682  3811 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240130 01:23:13.529695  3874 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10240acbf000 1.49 GB
W20240130 01:23:13.529709  3608 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10246a2a2000 1.49 GB
W20240130 01:23:13.529714  3677 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1024c9885000 1.49 GB
W20240130 01:23:13.529731  3541 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102528e68000 1.49 GB
W20240130 01:23:13.529737  3744 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10258844b000 1.49 GB
W20240130 01:23:13.529750  3474 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240130 01:23:13.529752  3811 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 01:23:13.529762  3380 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 01:23:13.529785  3608 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 01:23:13.529786  3744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 01:23:13.529788  3677 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 01:23:13.529790  3474 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 01:23:13.529790  3874 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 01:23:13.529795  3541 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 01:23:13.542853  3380 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 01:23:13.542874  3811 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 01:23:13.542879  3608 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 01:23:13.542889  3541 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 01:23:13.542894  3474 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 01:23:13.542901  3874 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240130 01:23:13.542901  3744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240130 01:23:13.542917  3677 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [3607 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [3743 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [3540 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [3473 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [3379 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [3676 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [3810 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 3810
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [2468 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 01:24:04.647351  3811 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.647847  3380 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.647953  3874 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.648013  3677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.648196  3744 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.648334  3608 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.648461  3474 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 01:24:04.648579  3541 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240130 01:24:04.650480  3811 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240130 01:24:04.650621  3811 grad_base.h:184] Init GradProcessingBase done
I20240130 01:24:17.761929  3811 grad_async_v1.h:199] Use main thread to update emb.
W20240130 01:24:17.762214  3811 kg_controller.h:75] after init GradAsyncProcessing
I20240130 01:24:17.762225  3811 kg_controller.h:84] Construct KGCacheController done
E20240130 01:24:18.524753  3744 recstore.cc:66] init folly done
E20240130 01:24:18.524758  3874 recstore.cc:66] init folly done
E20240130 01:24:18.525230  3474 recstore.cc:66] init folly done
E20240130 01:24:18.525238  3677 recstore.cc:66] init folly done
E20240130 01:24:18.525254  3608 recstore.cc:66] init folly done
E20240130 01:24:18.525238  3811 recstore.cc:66] init folly done
E20240130 01:24:18.525384  3541 recstore.cc:66] init folly done
E20240130 01:24:18.526018  3380 recstore.cc:66] init folly done
I20240130 01:24:18.527278  3811 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 01:24:37.307076  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 01:24:38.476262  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 01:24:40.206020  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 01:24:40.247027  3608 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240130 01:24:40.425235  3874 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 01:24:40.466630  3677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 01:24:41.607281  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 01:24:41.645887  3474 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 01:24:42.460068  3380 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 01:24:42.579463  3541 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 01:24:42.682662  4397 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end0
I20240130 01:24:42.843423  3811 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 01:24:43.532510  3744 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240130 01:24:43.712352  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.815 ms                  | 6.815 ms                  |
| Forward                   | 706.813 ms                | 706.813 ms                |
| Backward                  | 203.832 ms                | 203.832 ms                |
| Optimize                  | 4.915 ms                  | 4.915 ms                  |
| BarrierTimeBeforeRank0    | 71.805 ms                 | 71.805 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:45.876497  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240130 01:24:46.749112  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:24:46.968598  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240130 01:24:47.770570  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:24:47.968008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.512 ms                 | 386.409 ms                |
| ProcessBack:UpdateCache   | 9.275 ms                  | 648.098 ms                |
| ProcessBack:UpsertPq      | 38.059 ms                 | 55.580 ms                 |
| ProcessOneStep            | 72.020 ms                 | 1.349 s                   |
| BlockToStepN              | 7.971 ms                  | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:48.799885  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:24:49.101397  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.815 ms                  | 89.714 ms                 |
| Forward                   | 5.604 ms                  | 706.813 ms                |
| Backward                  | 9.864 ms                  | 203.832 ms                |
| Optimize                  | 2.581 ms                  | 4.915 ms                  |
| BarrierTimeBeforeRank0    | 4.195 ms                  | 71.805 ms                 |
| AfterBackward             | 69.491 ms                 | 1.349 s                   |
| BlockToStepN              | 8.016 ms                  | 865.898 ms                |
| OneStep                   | 101.325 ms                | 3.214 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:49.960664  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:24:50.151448  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=8, pq.top=8
W20240130 01:24:51.074270  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:24:51.160064  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240130 01:24:52.160012  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240130 01:24:52.198702  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:24:53.160012  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240130 01:24:53.282261  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.987 ms                  | 386.409 ms                |
| ProcessBack:UpdateCache   | 9.697 ms                  | 648.098 ms                |
| ProcessBack:UpsertPq      | 44.340 ms                 | 112.844 ms                |
| ProcessOneStep            | 69.452 ms                 | 1.349 s                   |
| BlockToStepN              | 7.971 ms                  | 939.395 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:54.160008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240130 01:24:54.399578  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.815 ms                  | 89.714 ms                 |
| Forward                   | 5.189 ms                  | 706.813 ms                |
| Backward                  | 10.293 ms                 | 203.832 ms                |
| Optimize                  | 2.583 ms                  | 5.264 ms                  |
| BarrierTimeBeforeRank0    | 2.369 ms                  | 92.819 ms                 |
| AfterBackward             | 72.059 ms                 | 1.349 s                   |
| BlockToStepN              | 8.016 ms                  | 939.529 ms                |
| OneStep                   | 234.775 ms                | 3.214 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:55.160027  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240130 01:24:55.498562  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:24:56.160008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240130 01:24:56.504411  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:24:57.411646  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240130 01:24:57.509361  4397 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 01:24:58.411008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240130 01:24:58.526285  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.789 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 43.742 ms                 | 112.844 ms                |
| ProcessOneStep            | 69.859 ms                 | 1.349 s                   |
| BlockToStepN              | 384.481 ms                | 939.395 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:24:59.411010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240130 01:24:59.547417  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.144 ms                  | 111.005 ms                |
| Forward                   | 5.330 ms                  | 706.813 ms                |
| Backward                  | 9.944 ms                  | 203.832 ms                |
| Optimize                  | 2.583 ms                  | 5.264 ms                  |
| BarrierTimeBeforeRank0    | 4.195 ms                  | 92.819 ms                 |
| AfterBackward             | 69.418 ms                 | 1.349 s                   |
| BlockToStepN              | 20.254 ms                 | 939.529 ms                |
| OneStep                   | 234.775 ms                | 3.214 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:00.489841  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240130 01:25:00.573581  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 01:25:01.537923  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240130 01:25:01.592211  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 01:25:02.537009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240130 01:25:02.603991  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.766 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 38.074 ms                 | 90.686 ms                 |
| ProcessOneStep            | 64.409 ms                 | 1.349 s                   |
| BlockToStepN              | 20.200 ms                 | 939.395 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:03.537006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240130 01:25:03.606062  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 01:25:04.540796  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240130 01:25:04.627327  4397 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.815 ms                  | 111.005 ms                |
| Forward                   | 5.562 ms                  | 706.813 ms                |
| Backward                  | 9.876 ms                  | 203.832 ms                |
| Optimize                  | 2.612 ms                  | 5.593 ms                  |
| BarrierTimeBeforeRank0    | 1.534 ms                  | 92.819 ms                 |
| AfterBackward             | 63.779 ms                 | 1.349 s                   |
| BlockToStepN              | 20.254 ms                 | 939.529 ms                |
| OneStep                   | 234.775 ms                | 3.214 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:05.581709  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240130 01:25:05.650913  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 01:25:06.591460  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240130 01:25:06.692312  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 01:25:07.591007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240130 01:25:07.720343  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.766 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 36.194 ms                 | 90.686 ms                 |
| ProcessOneStep            | 62.252 ms                 | 1.349 s                   |
| BlockToStepN              | 20.200 ms                 | 939.395 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:08.591006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240130 01:25:08.740254  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 01:25:09.591009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.287 ms                  | 111.005 ms                |
| Forward                   | 5.604 ms                  | 706.813 ms                |
| Backward                  | 9.860 ms                  | 203.832 ms                |
| Optimize                  | 2.635 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 903.715 us                | 92.819 ms                 |
| AfterBackward             | 61.856 ms                 | 1.349 s                   |
| BlockToStepN              | 20.254 ms                 | 939.529 ms                |
| OneStep                   | 234.775 ms                | 3.214 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:09.769454  4397 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 01:25:10.591008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240130 01:25:10.770279  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 01:25:11.591009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240130 01:25:12.238075  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:12.591008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240130 01:25:13.353060  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.766 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 34.875 ms                 | 90.686 ms                 |
| ProcessOneStep            | 59.499 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:13.591006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240130 01:25:14.411582  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:25:14.604475  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.119 ms                  | 89.714 ms                 |
| Forward                   | 5.608 ms                  | 22.684 ms                 |
| Backward                  | 9.860 ms                  | 11.020 ms                 |
| Optimize                  | 2.693 ms                  | 5.621 ms                  |
| BarrierTimeBeforeRank0    | 1.303 ms                  | 71.805 ms                 |
| AfterBackward             | 61.739 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 234.775 ms                | 1.033 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:15.444957  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:25:15.616145  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240130 01:25:16.447057  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:25:16.616007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240130 01:25:17.477499  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:17.616007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240130 01:25:18.499428  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.775 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 36.399 ms                 | 90.686 ms                 |
| ProcessOneStep            | 61.813 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:18.616007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240130 01:25:19.567976  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240130 01:25:19.616003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.287 ms                  | 89.714 ms                 |
| Forward                   | 5.608 ms                  | 22.684 ms                 |
| Backward                  | 9.854 ms                  | 16.361 ms                 |
| Optimize                  | 2.710 ms                  | 5.621 ms                  |
| BarrierTimeBeforeRank0    | 721.608 us                | 71.805 ms                 |
| AfterBackward             | 62.292 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 234.775 ms                | 1.033 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:20.569644  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:25:20.903425  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240130 01:25:21.730819  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:25:21.919567  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240130 01:25:22.804432  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:22.991072  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.101 ms                  | 352.520 ms                |
| ProcessBack:UpdateCache   | 9.789 ms                  | 647.154 ms                |
| ProcessBack:UpsertPq      | 37.800 ms                 | 90.686 ms                 |
| ProcessOneStep            | 63.556 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:23.838176  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:25:23.991007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.816 ms                  | 149.043 ms                |
| Forward                   | 5.818 ms                  | 22.684 ms                 |
| Backward                  | 9.860 ms                  | 16.361 ms                 |
| Optimize                  | 2.687 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 179.356 us                | 71.805 ms                 |
| AfterBackward             | 63.317 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:24.847748  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:25:24.991006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240130 01:25:25.850895  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 01:25:25.991006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240130 01:25:26.902673  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 01:25:26.991005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240130 01:25:27.926683  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240130 01:25:27.991008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.065 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.789 ms                  | 13.756 ms                 |
| ProcessBack:UpsertPq      | 36.321 ms                 | 80.751 ms                 |
| ProcessOneStep            | 61.813 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:28.957780  4397 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 01:25:29.042428  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.041 ms                  | 261.581 ms                |
| Forward                   | 5.608 ms                  | 22.684 ms                 |
| Backward                  | 9.853 ms                  | 16.361 ms                 |
| Optimize                  | 2.627 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 62.793 us                 | 71.805 ms                 |
| AfterBackward             | 61.799 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:29.971493  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:25:30.067351  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240130 01:25:31.005088  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 01:25:31.067003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240130 01:25:32.014211  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 01:25:32.067006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240130 01:25:33.020005  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240130 01:25:33.067003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 32.393 ms                 |
| ProcessBack:UpdateCache   | 9.847 ms                  | 13.756 ms                 |
| ProcessBack:UpsertPq      | 34.268 ms                 | 80.751 ms                 |
| ProcessOneStep            | 59.989 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:34.051087  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 01:25:34.067003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.064 ms                  | 261.581 ms                |
| Forward                   | 5.595 ms                  | 22.684 ms                 |
| Backward                  | 9.845 ms                  | 16.361 ms                 |
| Optimize                  | 2.605 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 63.041 us                 | 71.805 ms                 |
| AfterBackward             | 59.554 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:35.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=99, pq.top=99
W20240130 01:25:35.111690  4397 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 52.192, sample: 1.404, forward: 1.251, backward: 1.151, update: 0.262
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.264, sample: 1.381, forward: 1.271, backward: 1.107, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.145, sample: 1.622, forward: 1.251, backward: 1.155, update: 0.250
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.299, sample: 1.700, forward: 1.216, backward: 1.161, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.477, sample: 1.600, forward: 1.218, backward: 1.005, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.258, sample: 1.343, forward: 1.233, backward: 1.087, update: 0.249
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 54.079, sample: 1.469, forward: 1.139, backward: 0.769, update: 0.225
train_sampler.Prefill()
-------Step 0-------
tensor([  250625,   250664,   250706,   250747, 10063882,   757396, 59470836,
        22993945, 23611856,   250783]) tensor([ 9475568, 18201459, 63440423, 72181051, 21644634, 33117008, 37594020,
        78937867, 70923835, 35332171])
-------Step 1-------
tensor([  250625,   250664,   250706,   250747, 10063882,   757396, 59470836,
        22993945, 23611856,   250783]) tensor([ 3620808, 34714330, 14016541, 81834185, 79505987, 45384694, 70935997,
        47825616, 41651560, 18018448])
-------Step 2-------
tensor([  343241,   343284,   343326,   325723,   343370,   343408, 84971402,
        31636463,   343451,   343485]) tensor([72505535, 23930891, 85600454, 50183966, 45575732, 29339882, 66590871,
        45093618, 17628840, 44721148])
-------Step 3-------
tensor([  343241,   343284,   343326,   325723,   343370,   343408, 84971402,
        31636463,   343451,   343485]) tensor([50838422, 84630921, 33112325, 40747429, 63981521, 63443309, 41518055,
        21531382, 32384744,  1792898])
-------Step 4-------
tensor([  437249, 44892063,   437291,   779163,   437324,   779189,   437363,
        42733823,   437415,   437471]) tensor([82858018, 14597017, 84968027, 19797961, 68451011, 46178304, 70830843,
        39879049, 79825688, 53563809])
-------Step 5-------
tensor([  437249, 44892063,   437291,   779163,   437324,   779189,   437363,
        42733823,   437415,   437471]) tensor([32259209,  1334188,   923909, 84770405, 58125417, 53517945, 18159382,
        13126407, 75133529, 38436865])
-------Step 6-------
tensor([  526770,   359785, 38793259,   526810, 33241342, 81459199,   526839,
          526873, 53671589, 38587337]) tensor([15811215, 36652956, 40753895, 77467121, 30782627, 37642029, 30749916,
        10773145, 69428106, 78209324])
-------Step 7-------
tensor([  526770,   359785, 38793259,   526810, 33241342, 81459199,   526839,
          526873, 53671589, 38587337]) tensor([24601344, 53842114, 74338724, 59028740, 77552342, 49855261, 51698669,
        56799853, 33767771,  1006031])
-------Step 8-------
tensor([  632049, 27088549,   632091,   800242,   632134,   376426,   632161,
          632202,   632246,   632281]) tensor([47162345, 31379658, 39051854,  3680214, 51635578,   250115, 18043424,
          842175,  3140027, 62352796])
-------Step 9-------
tensor([  632049, 27088549,   632091,   800242,   632134,   376426,   632161,
          632202,   632246,   632281]) tensor([55605662,  2077241, 18993321, 60118705, 13609878, 44990599,   832203,
        36580037, 83055969, 67801643])
before start barrier
start train
[proc 0] 100 steps, total: 52.881, sample: 2.233, forward: 1.302, backward: 1.191, update: 0.296
W20240130 01:25:36.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240130 01:25:36.121531  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 01:25:37.067006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240130 01:25:37.753103  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:38.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 32.393 ms                 |
| ProcessBack:UpdateCache   | 9.847 ms                  | 13.756 ms                 |
| ProcessBack:UpsertPq      | 33.821 ms                 | 80.751 ms                 |
| ProcessOneStep            | 58.974 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:38.758383  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:25:39.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.144 ms                  | 261.581 ms                |
| Forward                   | 5.562 ms                  | 22.684 ms                 |
| Backward                  | 9.828 ms                  | 16.361 ms                 |
| Optimize                  | 2.605 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 55.063 us                 | 71.805 ms                 |
| AfterBackward             | 59.076 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:39.786984  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:25:40.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240130 01:25:40.803411  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:25:41.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240130 01:25:41.824039  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:25:42.067009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240130 01:25:42.856091  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:43.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 32.393 ms                 |
| ProcessBack:UpdateCache   | 9.847 ms                  | 13.756 ms                 |
| ProcessBack:UpsertPq      | 34.875 ms                 | 84.574 ms                 |
| ProcessOneStep            | 59.499 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:43.870115  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:25:44.067008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.760 ms                  | 261.581 ms                |
| Forward                   | 5.542 ms                  | 22.684 ms                 |
| Backward                  | 9.828 ms                  | 16.361 ms                 |
| Optimize                  | 2.604 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 55.063 us                 | 71.805 ms                 |
| AfterBackward             | 60.028 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:44.903425  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:25:45.259552  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240130 01:25:46.072916  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:25:46.325943  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240130 01:25:47.096630  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:25:47.325007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240130 01:25:48.128473  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:25:48.325007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 32.393 ms                 |
| ProcessBack:UpdateCache   | 9.847 ms                  | 13.756 ms                 |
| ProcessBack:UpsertPq      | 35.188 ms                 | 84.574 ms                 |
| ProcessOneStep            | 59.989 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:49.159492  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 01:25:49.325008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.946 ms                  | 304.341 ms                |
| Forward                   | 5.542 ms                  | 22.684 ms                 |
| Backward                  | 9.845 ms                  | 16.361 ms                 |
| Optimize                  | 2.605 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 54.279 us                 | 71.805 ms                 |
| AfterBackward             | 59.554 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:50.211465  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240130 01:25:50.325004  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240130 01:25:51.260922  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 01:25:51.325006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240130 01:25:52.286039  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 01:25:52.325003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240130 01:25:53.314517  4397 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 01:25:53.325002  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.794 ms                  | 13.224 ms                 |
| ProcessBack:UpsertPq      | 34.212 ms                 | 80.960 ms                 |
| ProcessOneStep            | 59.035 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:54.325007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240130 01:25:54.347975  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.151 ms                  | 304.341 ms                |
| Forward                   | 5.509 ms                  | 22.684 ms                 |
| Backward                  | 9.822 ms                  | 16.361 ms                 |
| Optimize                  | 2.598 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 50.872 us                 | 71.805 ms                 |
| AfterBackward             | 59.010 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:55.325008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240130 01:25:55.395177  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240130 01:25:56.325008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240130 01:25:56.402381  4397 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 01:25:57.325009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240130 01:25:57.415287  4397 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 01:25:58.325009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.789 ms                  | 13.224 ms                 |
| ProcessBack:UpsertPq      | 33.690 ms                 | 80.960 ms                 |
| ProcessOneStep            | 58.185 ms                 | 131.436 ms                |
| BlockToStepN              | 20.200 ms                 | 863.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:58.829084  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:25:59.325009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.151 ms                  | 304.341 ms                |
| Forward                   | 5.471 ms                  | 22.684 ms                 |
| Backward                  | 9.792 ms                  | 16.361 ms                 |
| Optimize                  | 2.591 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 43.514 us                 | 71.805 ms                 |
| AfterBackward             | 57.633 ms                 | 131.479 ms                |
| BlockToStepN              | 20.254 ms                 | 865.898 ms                |
| OneStep                   | 236.627 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:25:59.864985  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:00.325009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240130 01:26:00.894415  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:01.325006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240130 01:26:02.113282  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:02.325007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240130 01:26:03.116209  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:03.327564  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.789 ms                  | 13.224 ms                 |
| ProcessBack:UpsertPq      | 33.421 ms                 | 80.960 ms                 |
| ProcessOneStep            | 57.044 ms                 | 109.402 ms                |
| BlockToStepN              | 88.817 ms                 | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:04.132793  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:04.327008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.405 ms                  | 261.581 ms                |
| Forward                   | 5.468 ms                  | 12.217 ms                 |
| Backward                  | 9.781 ms                  | 14.476 ms                 |
| Optimize                  | 2.583 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 42.366 us                 | 49.066 ms                 |
| AfterBackward             | 57.012 ms                 | 109.447 ms                |
| BlockToStepN              | 88.877 ms                 | 823.860 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:05.141029  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:05.327008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240130 01:26:06.148504  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:06.349442  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240130 01:26:07.151985  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:07.389755  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240130 01:26:08.156209  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:08.443435  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.224 ms                 |
| ProcessBack:UpsertPq      | 33.394 ms                 | 80.960 ms                 |
| ProcessOneStep            | 57.044 ms                 | 109.402 ms                |
| BlockToStepN              | 97.839 ms                 | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:09.210732  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:09.651613  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.405 ms                  | 261.581 ms                |
| Forward                   | 5.458 ms                  | 12.217 ms                 |
| Backward                  | 9.773 ms                  | 14.476 ms                 |
| Optimize                  | 2.598 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 43.514 us                 | 49.066 ms                 |
| AfterBackward             | 57.080 ms                 | 109.447 ms                |
| BlockToStepN              | 97.915 ms                 | 823.860 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:10.456054  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:10.655826  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240130 01:26:11.487766  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:11.710943  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240130 01:26:12.517225  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:12.729717  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240130 01:26:13.529160  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 28.462 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.224 ms                 |
| ProcessBack:UpsertPq      | 33.455 ms                 | 80.960 ms                 |
| ProcessOneStep            | 57.593 ms                 | 109.402 ms                |
| BlockToStepN              | 384.481 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:13.787645  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240130 01:26:14.560318  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.687 ms                  | 261.581 ms                |
| Forward                   | 5.444 ms                  | 12.217 ms                 |
| Backward                  | 9.768 ms                  | 16.361 ms                 |
| Optimize                  | 2.590 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 43.514 us                 | 49.066 ms                 |
| AfterBackward             | 58.015 ms                 | 109.447 ms                |
| BlockToStepN              | 384.571 ms                | 829.468 ms                |
| OneStep                   | 477.453 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:14.868997  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240130 01:26:15.630218  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:15.921952  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240130 01:26:16.682997  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:16.977734  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240130 01:26:17.751060  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:18.330574  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.926 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.126 ms                 |
| ProcessBack:UpsertPq      | 33.480 ms                 | 80.751 ms                 |
| ProcessOneStep            | 58.091 ms                 | 109.402 ms                |
| BlockToStepN              | 119.443 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:19.126457  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:19.357762  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.534 ms                  | 297.644 ms                |
| Forward                   | 5.433 ms                  | 12.217 ms                 |
| Backward                  | 9.756 ms                  | 16.361 ms                 |
| Optimize                  | 2.590 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 42.366 us                 | 49.066 ms                 |
| AfterBackward             | 58.015 ms                 | 109.447 ms                |
| BlockToStepN              | 119.514 ms                | 829.468 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:20.135025  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:20.359138  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240130 01:26:21.159953  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:21.359009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240130 01:26:22.173918  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:22.391404  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240130 01:26:23.189919  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:23.463285  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.926 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.126 ms                 |
| ProcessBack:UpsertPq      | 33.455 ms                 | 80.751 ms                 |
| ProcessOneStep            | 58.266 ms                 | 109.402 ms                |
| BlockToStepN              | 119.443 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:24.225746  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:24.507020  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.582 ms                  | 297.644 ms                |
| Forward                   | 5.458 ms                  | 12.217 ms                 |
| Backward                  | 9.748 ms                  | 16.361 ms                 |
| Optimize                  | 2.598 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 40.375 us                 | 49.066 ms                 |
| AfterBackward             | 58.224 ms                 | 109.447 ms                |
| BlockToStepN              | 119.514 ms                | 829.468 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:25.272368  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:25.583784  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240130 01:26:26.365443  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:26.858739  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240130 01:26:27.656891  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 2] 200 steps, total: 52.073, sample: 1.336, forward: 0.507, backward: 0.569, update: 0.243
[proc 4] 200 steps, total: 52.073, sample: 1.591, forward: 0.511, backward: 0.963, update: 0.248
[proc 7] 200 steps, total: 52.073, sample: 1.658, forward: 0.490, backward: 0.992, update: 0.247
[proc 3] 200 steps, total: 52.073, sample: 1.543, forward: 0.492, backward: 1.039, update: 0.239
[proc 1] 200 steps, total: 52.073, sample: 1.404, forward: 0.517, backward: 0.551, update: 0.270
[proc 6] 200 steps, total: 52.073, sample: 1.341, forward: 0.529, backward: 1.050, update: 0.266
[proc 5] 200 steps, total: 52.073, sample: 1.086, forward: 0.469, backward: 1.051, update: 0.211
[proc 0] 200 steps, total: 52.073, sample: 3.173, forward: 0.546, backward: 0.990, update: 0.320
W20240130 01:26:27.883404  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.926 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.126 ms                 |
| ProcessBack:UpsertPq      | 33.448 ms                 | 80.751 ms                 |
| ProcessOneStep            | 57.761 ms                 | 109.402 ms                |
| BlockToStepN              | 129.889 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:28.659433  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:28.883008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.582 ms                  | 297.644 ms                |
| Forward                   | 5.444 ms                  | 12.217 ms                 |
| Backward                  | 9.734 ms                  | 16.361 ms                 |
| Optimize                  | 2.591 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 39.947 us                 | 49.066 ms                 |
| AfterBackward             | 57.709 ms                 | 109.447 ms                |
| BlockToStepN              | 384.571 ms                | 829.468 ms                |
| OneStep                   | 477.453 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:29.690054  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:29.883006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240130 01:26:30.714129  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:30.944425  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240130 01:26:31.746222  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:32.015370  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240130 01:26:32.786934  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:33.085386  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.926 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.126 ms                 |
| ProcessBack:UpsertPq      | 33.399 ms                 | 80.751 ms                 |
| ProcessOneStep            | 57.511 ms                 | 109.402 ms                |
| BlockToStepN              | 138.450 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:33.858232  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:34.154330  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.648 ms                  | 297.644 ms                |
| Forward                   | 5.433 ms                  | 12.217 ms                 |
| Backward                  | 9.724 ms                  | 16.361 ms                 |
| Optimize                  | 2.591 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 37.307 us                 | 49.066 ms                 |
| AfterBackward             | 57.464 ms                 | 109.447 ms                |
| BlockToStepN              | 138.507 ms                | 829.468 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:34.924880  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:35.413981  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240130 01:26:36.211912  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:36.413007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240130 01:26:37.229815  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:37.413007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240130 01:26:38.239688  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:38.483407  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 17.926 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 13.126 ms                 |
| ProcessBack:UpsertPq      | 33.262 ms                 | 80.751 ms                 |
| ProcessOneStep            | 56.845 ms                 | 109.402 ms                |
| BlockToStepN              | 144.258 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:39.260507  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:39.483009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=222, pq.top=222
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.678 ms                  | 297.644 ms                |
| Forward                   | 5.423 ms                  | 12.217 ms                 |
| Backward                  | 9.723 ms                  | 16.361 ms                 |
| Optimize                  | 2.598 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 36.458 us                 | 49.066 ms                 |
| AfterBackward             | 56.884 ms                 | 109.447 ms                |
| BlockToStepN              | 146.555 ms                | 829.468 ms                |
| OneStep                   | 236.627 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:40.366600  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:40.483007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240130 01:26:41.482416  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:41.568289  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=226, pq.top=226
W20240130 01:26:42.568010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240130 01:26:42.593549  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.236 ms                 | 79.755 ms                 |
| ProcessOneStep            | 56.766 ms                 | 109.402 ms                |
| BlockToStepN              | 146.485 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:43.568006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240130 01:26:43.717558  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:44.568008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.678 ms                  | 297.644 ms                |
| Forward                   | 5.414 ms                  | 12.217 ms                 |
| Backward                  | 9.721 ms                  | 16.361 ms                 |
| Optimize                  | 2.600 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 36.458 us                 | 49.066 ms                 |
| AfterBackward             | 56.803 ms                 | 109.447 ms                |
| BlockToStepN              | 146.555 ms                | 829.468 ms                |
| OneStep                   | 247.845 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:44.987655  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:45.568009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240130 01:26:46.007162  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:46.568008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240130 01:26:47.053570  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:26:47.568008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240130 01:26:48.150768  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.166 ms                 | 79.755 ms                 |
| ProcessOneStep            | 56.829 ms                 | 109.402 ms                |
| BlockToStepN              | 159.592 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:48.568003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240130 01:26:49.242627  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:49.574376  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.678 ms                  | 297.644 ms                |
| Forward                   | 5.396 ms                  | 22.684 ms                 |
| Backward                  | 9.719 ms                  | 16.361 ms                 |
| Optimize                  | 2.604 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 37.758 us                 | 49.066 ms                 |
| AfterBackward             | 56.873 ms                 | 109.447 ms                |
| BlockToStepN              | 164.671 ms                | 829.468 ms                |
| OneStep                   | 248.119 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:50.341065  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:50.574007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240130 01:26:51.455581  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:51.574007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240130 01:26:52.574010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240130 01:26:52.576185  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.163 ms                 | 79.755 ms                 |
| ProcessOneStep            | 56.750 ms                 | 109.402 ms                |
| BlockToStepN              | 181.088 ms                | 829.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:53.574005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240130 01:26:53.902040  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:54.574009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.678 ms                  | 297.644 ms                |
| Forward                   | 5.383 ms                  | 22.684 ms                 |
| Backward                  | 9.715 ms                  | 16.361 ms                 |
| Optimize                  | 2.604 ms                  | 8.449 ms                  |
| BarrierTimeBeforeRank0    | 40.022 us                 | 49.066 ms                 |
| AfterBackward             | 56.803 ms                 | 109.447 ms                |
| BlockToStepN              | 181.153 ms                | 829.468 ms                |
| OneStep                   | 256.601 ms                | 1.162 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:54.915165  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:26:55.574008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240130 01:26:55.975988  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:26:56.574007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240130 01:26:57.112430  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:26:57.574008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240130 01:26:58.249378  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.900 ms                  | 17.483 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.272 ms                 | 79.755 ms                 |
| ProcessOneStep            | 56.845 ms                 | 106.101 ms                |
| BlockToStepN              | 183.958 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:26:58.597608  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240130 01:26:59.369310  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:26:59.597007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.958 ms                  | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.701 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 39.947 us                 | 47.668 ms                 |
| AfterBackward             | 57.012 ms                 | 106.157 ms                |
| BlockToStepN              | 184.033 ms                | 823.860 ms                |
| OneStep                   | 267.199 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:00.480203  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:00.597007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240130 01:27:01.597023  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240130 01:27:01.606542  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:02.597008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240130 01:27:02.995359  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.940 ms                  | 17.483 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.790 ms                 |
| ProcessBack:UpsertPq      | 33.296 ms                 | 79.755 ms                 |
| ProcessOneStep            | 57.419 ms                 | 106.101 ms                |
| BlockToStepN              | 183.958 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:03.597004  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240130 01:27:04.011598  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:04.597008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.227 ms                 | 261.581 ms                |
| Forward                   | 5.383 ms                  | 12.217 ms                 |
| Backward                  | 9.692 ms                  | 14.476 ms                 |
| Optimize                  | 2.600 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 37.307 us                 | 47.668 ms                 |
| AfterBackward             | 57.464 ms                 | 106.157 ms                |
| BlockToStepN              | 184.033 ms                | 823.860 ms                |
| OneStep                   | 276.514 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:05.066962  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:05.597008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240130 01:27:06.200907  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:06.597007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240130 01:27:07.328897  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:07.597007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240130 01:27:08.460971  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.940 ms                  | 17.483 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.790 ms                 |
| ProcessBack:UpsertPq      | 33.394 ms                 | 79.755 ms                 |
| ProcessOneStep            | 57.419 ms                 | 106.101 ms                |
| BlockToStepN              | 384.481 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:08.597003  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240130 01:27:09.589378  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:09.664186  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.067 ms                 | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.680 ms                  | 14.476 ms                 |
| Optimize                  | 2.604 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 37.307 us                 | 47.668 ms                 |
| AfterBackward             | 57.164 ms                 | 106.157 ms                |
| BlockToStepN              | 384.571 ms                | 823.860 ms                |
| OneStep                   | 477.453 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:10.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240130 01:27:10.719218  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:11.664007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240130 01:27:12.049528  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:12.664007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240130 01:27:13.068920  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.940 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.797 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.309 ms                 | 76.180 ms                 |
| ProcessOneStep            | 57.044 ms                 | 106.101 ms                |
| BlockToStepN              | 197.800 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:13.664005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240130 01:27:14.126646  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:14.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 261.581 ms                |
| Forward                   | 5.372 ms                  | 12.217 ms                 |
| Backward                  | 9.670 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 36.994 us                 | 47.668 ms                 |
| AfterBackward             | 57.051 ms                 | 106.157 ms                |
| BlockToStepN              | 201.937 ms                | 823.860 ms                |
| OneStep                   | 277.710 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:15.276100  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:15.664007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240130 01:27:16.398517  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:16.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240130 01:27:17.536445  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:17.664007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=290, pq.top=290
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.940 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.846 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.296 ms                 | 76.180 ms                 |
| ProcessOneStep            | 56.829 ms                 | 106.101 ms                |
| BlockToStepN              | 201.866 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:18.664005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240130 01:27:18.697369  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:19.664011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 261.581 ms                |
| Forward                   | 5.372 ms                  | 12.217 ms                 |
| Backward                  | 9.663 ms                  | 14.476 ms                 |
| Optimize                  | 2.600 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 37.758 us                 | 47.668 ms                 |
| AfterBackward             | 56.803 ms                 | 106.157 ms                |
| BlockToStepN              | 201.937 ms                | 823.860 ms                |
| OneStep                   | 292.220 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:19.820154  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:20.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240130 01:27:21.136062  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:21.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240130 01:27:22.137606  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:22.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=299, pq.top=299
W20240130 01:27:23.242316  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 3] 300 steps, total: 55.725, sample: 1.226, forward: 0.488, backward: 1.031, update: 0.250
[proc 4] 300 steps, total: 55.726, sample: 1.280, forward: 0.509, backward: 1.058, update: 0.257
[proc 1] 300 steps, total: 55.725, sample: 1.316, forward: 0.491, backward: 0.545, update: 0.258
[proc 7] 300 steps, total: 55.726, sample: 1.277, forward: 0.481, backward: 1.001, update: 0.255
[proc 6] 300 steps, total: 55.725, sample: 1.147, forward: 0.514, backward: 1.026, update: 0.251
[proc 0] 300 steps, total: 55.725, sample: 2.342, forward: 0.556, backward: 0.651, update: 0.327
[proc 5] 300 steps, total: 55.725, sample: 0.958, forward: 0.461, backward: 1.050, update: 0.211
[proc 2] 300 steps, total: 55.726, sample: 1.098, forward: 0.493, backward: 0.549, update: 0.264
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.940 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.864 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.262 ms                 | 76.180 ms                 |
| ProcessOneStep            | 56.707 ms                 | 106.101 ms                |
| BlockToStepN              | 206.007 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:23.664008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240130 01:27:24.379726  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.655 ms                  | 14.476 ms                 |
| Optimize                  | 2.600 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 38.120 us                 | 47.668 ms                 |
| AfterBackward             | 56.714 ms                 | 106.157 ms                |
| BlockToStepN              | 206.109 ms                | 823.860 ms                |
| OneStep                   | 292.220 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:24.748901  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240130 01:27:25.523555  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:25.748010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240130 01:27:26.726413  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:26.803969  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240130 01:27:27.803009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240130 01:27:27.904211  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.867 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.272 ms                 | 76.180 ms                 |
| ProcessOneStep            | 56.673 ms                 | 106.101 ms                |
| BlockToStepN              | 207.896 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:28.803005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240130 01:27:29.105132  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.366 ms                 | 261.581 ms                |
| Forward                   | 5.370 ms                  | 12.217 ms                 |
| Backward                  | 9.647 ms                  | 14.476 ms                 |
| Optimize                  | 2.604 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 40.375 us                 | 47.668 ms                 |
| AfterBackward             | 56.714 ms                 | 106.157 ms                |
| BlockToStepN              | 207.956 ms                | 829.355 ms                |
| OneStep                   | 293.914 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:29.803004  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240130 01:27:30.432765  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:30.803009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240130 01:27:31.433751  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:31.803009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240130 01:27:32.581868  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:32.803009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=316, pq.top=316
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.819 ms                 |
| ProcessBack:UpdateCache   | 9.877 ms                  | 12.672 ms                 |
| ProcessBack:UpsertPq      | 33.270 ms                 | 76.180 ms                 |
| ProcessOneStep            | 56.660 ms                 | 106.101 ms                |
| BlockToStepN              | 210.290 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:33.735222  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:33.826658  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.067 ms                 | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.642 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 41.171 us                 | 47.668 ms                 |
| AfterBackward             | 56.698 ms                 | 106.157 ms                |
| BlockToStepN              | 213.208 ms                | 829.355 ms                |
| OneStep                   | 306.171 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:34.826005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240130 01:27:34.905469  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:35.826010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240130 01:27:36.079969  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:36.826010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240130 01:27:37.248489  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:37.826007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240130 01:27:38.433558  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.309 ms                 | 74.282 ms                 |
| ProcessOneStep            | 56.660 ms                 | 106.101 ms                |
| BlockToStepN              | 384.481 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:38.972754  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.019 ms                 | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.639 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 43.611 us                 | 47.668 ms                 |
| AfterBackward             | 56.713 ms                 | 106.157 ms                |
| BlockToStepN              | 243.269 ms                | 829.355 ms                |
| OneStep                   | 323.424 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:39.754889  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:40.031473  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240130 01:27:40.813401  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:41.031006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240130 01:27:41.991494  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:42.072113  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240130 01:27:43.072008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240130 01:27:43.187916  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.890 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.399 ms                 | 74.282 ms                 |
| ProcessOneStep            | 56.707 ms                 | 106.101 ms                |
| BlockToStepN              | 243.190 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:44.072008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240130 01:27:44.359208  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.019 ms                 | 261.581 ms                |
| Forward                   | 5.369 ms                  | 12.217 ms                 |
| Backward                  | 9.635 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 45.303 us                 | 47.668 ms                 |
| AfterBackward             | 56.749 ms                 | 106.157 ms                |
| BlockToStepN              | 243.269 ms                | 829.355 ms                |
| OneStep                   | 323.424 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:45.072010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240130 01:27:45.532797  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:46.072018  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240130 01:27:46.734218  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:47.118913  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240130 01:27:47.920230  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:48.118006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=342, pq.top=342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.888 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.420 ms                 | 74.282 ms                 |
| ProcessOneStep            | 56.766 ms                 | 106.101 ms                |
| BlockToStepN              | 243.190 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:49.118006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240130 01:27:49.337481  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.354 ms                 | 261.581 ms                |
| Forward                   | 5.370 ms                  | 12.217 ms                 |
| Backward                  | 9.635 ms                  | 14.476 ms                 |
| Optimize                  | 2.605 ms                  | 8.391 ms                  |
| BarrierTimeBeforeRank0    | 43.611 us                 | 47.668 ms                 |
| AfterBackward             | 56.873 ms                 | 106.157 ms                |
| BlockToStepN              | 243.269 ms                | 829.355 ms                |
| OneStep                   | 339.962 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:50.118005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240130 01:27:50.359315  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:51.118007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240130 01:27:51.570623  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:52.118008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240130 01:27:52.773613  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:53.193015  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.898 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.425 ms                 | 74.282 ms                 |
| ProcessOneStep            | 56.974 ms                 | 104.760 ms                |
| BlockToStepN              | 243.190 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:53.966292  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:27:54.193010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.354 ms                 | 243.847 ms                |
| Forward                   | 5.370 ms                  | 11.641 ms                 |
| Backward                  | 9.635 ms                  | 13.719 ms                 |
| Optimize                  | 2.605 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 43.514 us                 | 38.081 ms                 |
| AfterBackward             | 57.012 ms                 | 104.808 ms                |
| BlockToStepN              | 243.269 ms                | 823.860 ms                |
| OneStep                   | 339.962 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:55.148695  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:27:55.234661  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240130 01:27:56.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240130 01:27:56.341781  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:27:57.234010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240130 01:27:57.537637  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:27:58.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.890 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.455 ms                 | 74.282 ms                 |
| ProcessOneStep            | 57.016 ms                 | 104.760 ms                |
| BlockToStepN              | 243.190 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:58.881242  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:27:59.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=361, pq.top=361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.354 ms                 | 243.847 ms                |
| Forward                   | 5.369 ms                  | 11.641 ms                 |
| Backward                  | 9.629 ms                  | 13.719 ms                 |
| Optimize                  | 2.605 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.601 us                 | 38.081 ms                 |
| AfterBackward             | 57.051 ms                 | 104.808 ms                |
| BlockToStepN              | 243.269 ms                | 823.860 ms                |
| OneStep                   | 339.962 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:27:59.921873  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:00.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240130 01:28:01.103646  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:01.234007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=364, pq.top=364
W20240130 01:28:02.234010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240130 01:28:02.301410  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:03.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240130 01:28:03.486398  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 16.649 ms                 |
| ProcessBack:UpdateCache   | 9.898 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.451 ms                 | 74.282 ms                 |
| ProcessOneStep            | 57.044 ms                 | 104.760 ms                |
| BlockToStepN              | 384.481 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:04.234009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240130 01:28:04.665127  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.354 ms                 | 243.847 ms                |
| Forward                   | 5.363 ms                  | 11.641 ms                 |
| Backward                  | 9.629 ms                  | 13.719 ms                 |
| Optimize                  | 2.608 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.375 us                 | 38.081 ms                 |
| AfterBackward             | 57.080 ms                 | 104.808 ms                |
| BlockToStepN              | 384.571 ms                | 823.860 ms                |
| OneStep                   | 477.453 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:05.234010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240130 01:28:05.857412  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:06.270262  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240130 01:28:07.056602  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:07.270009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240130 01:28:08.270010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240130 01:28:08.438738  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.955 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.890 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.471 ms                 | 74.282 ms                 |
| ProcessOneStep            | 57.044 ms                 | 104.760 ms                |
| BlockToStepN              | 384.481 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:09.270009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240130 01:28:09.506254  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 243.847 ms                |
| Forward                   | 5.360 ms                  | 11.641 ms                 |
| Backward                  | 9.629 ms                  | 13.719 ms                 |
| Optimize                  | 2.608 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.375 us                 | 38.384 ms                 |
| AfterBackward             | 57.083 ms                 | 104.808 ms                |
| BlockToStepN              | 384.571 ms                | 823.860 ms                |
| OneStep                   | 477.453 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:10.270011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240130 01:28:10.727481  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:28:11.270011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240130 01:28:11.947434  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:12.270009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240130 01:28:13.171315  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:13.270006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=384, pq.top=384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.987 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.480 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.126 ms                 | 104.760 ms                |
| BlockToStepN              | 259.281 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:14.270009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240130 01:28:14.389802  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.067 ms                 | 243.847 ms                |
| Forward                   | 5.352 ms                  | 11.641 ms                 |
| Backward                  | 9.629 ms                  | 13.719 ms                 |
| Optimize                  | 2.605 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.601 us                 | 38.384 ms                 |
| AfterBackward             | 57.191 ms                 | 104.808 ms                |
| BlockToStepN              | 384.571 ms                | 823.860 ms                |
| OneStep                   | 477.453 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:15.270015  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240130 01:28:15.631142  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:16.270010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240130 01:28:16.861676  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:28:17.389169  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240130 01:28:18.193392  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:18.389007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=392, pq.top=392
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.987 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.481 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.338 ms                 | 104.760 ms                |
| BlockToStepN              | 259.281 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:19.309139  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:19.394665  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=394, pq.top=394
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.019 ms                 | 243.847 ms                |
| Forward                   | 5.351 ms                  | 11.641 ms                 |
| Backward                  | 9.635 ms                  | 13.719 ms                 |
| Optimize                  | 2.607 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.375 us                 | 38.384 ms                 |
| AfterBackward             | 57.377 ms                 | 104.808 ms                |
| BlockToStepN              | 259.388 ms                | 823.860 ms                |
| OneStep                   | 352.412 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:20.394009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240130 01:28:20.525635  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:21.394011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240130 01:28:21.771018  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:22.394008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=399, pq.top=399
W20240130 01:28:23.008790  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 5] 400 steps, total: 59.833, sample: 1.054, forward: 0.493, backward: 1.059, update: 0.242
[proc 0] 400 steps, total: 59.833, sample: 2.114, forward: 0.534, backward: 0.803, update: 0.308
[proc 1] 400 steps, total: 59.833, sample: 1.325, forward: 0.483, backward: 1.046, update: 0.272
[proc 7] 400 steps, total: 59.833, sample: 1.202, forward: 0.494, backward: 1.014, update: 0.286
[proc 4] 400 steps, total: 59.833, sample: 1.111, forward: 0.485, backward: 1.059, update: 0.250
[proc 6] 400 steps, total: 59.833, sample: 1.047, forward: 0.480, backward: 1.053, update: 0.217
[proc 3] 400 steps, total: 59.833, sample: 1.262, forward: 0.495, backward: 1.055, update: 0.254
[proc 2] 400 steps, total: 59.833, sample: 1.183, forward: 0.479, backward: 0.624, update: 0.264
W20240130 01:28:23.461524  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=401, pq.top=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.987 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.624 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.419 ms                 | 104.760 ms                |
| BlockToStepN              | 259.281 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:24.241668  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:24.461009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=402, pq.top=402
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.015 ms                 | 243.847 ms                |
| Forward                   | 5.344 ms                  | 11.641 ms                 |
| Backward                  | 9.635 ms                  | 13.719 ms                 |
| Optimize                  | 2.608 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 40.022 us                 | 38.384 ms                 |
| AfterBackward             | 57.464 ms                 | 104.808 ms                |
| BlockToStepN              | 259.388 ms                | 823.860 ms                |
| OneStep                   | 352.412 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:25.456770  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:25.555181  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240130 01:28:26.555011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240130 01:28:26.688073  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:27.555009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240130 01:28:28.051522  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.012 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.685 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.526 ms                 | 104.760 ms                |
| BlockToStepN              | 259.281 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:28.555006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240130 01:28:29.154134  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:28:29.587777  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.022 ms                 | 243.847 ms                |
| Forward                   | 5.338 ms                  | 11.641 ms                 |
| Backward                  | 9.629 ms                  | 13.719 ms                 |
| Optimize                  | 2.608 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 38.120 us                 | 38.384 ms                 |
| AfterBackward             | 57.566 ms                 | 104.808 ms                |
| BlockToStepN              | 259.388 ms                | 823.860 ms                |
| OneStep                   | 352.412 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:30.367832  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:30.587007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240130 01:28:31.581178  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:31.665413  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240130 01:28:32.665015  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240130 01:28:32.806926  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.012 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.877 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.685 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.559 ms                 | 104.760 ms                |
| BlockToStepN              | 265.150 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:33.665005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240130 01:28:34.062139  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:34.665007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.332 ms                 | 243.847 ms                |
| Forward                   | 5.330 ms                  | 11.641 ms                 |
| Backward                  | 9.628 ms                  | 13.719 ms                 |
| Optimize                  | 2.607 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 38.081 us                 | 38.384 ms                 |
| AfterBackward             | 57.633 ms                 | 104.808 ms                |
| BlockToStepN              | 268.713 ms                | 823.860 ms                |
| OneStep                   | 363.329 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:35.319859  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:28:35.665009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240130 01:28:36.564152  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:36.665007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=422, pq.top=422
W20240130 01:28:37.665009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240130 01:28:37.943776  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.012 ms                  | 15.133 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 12.589 ms                 |
| ProcessBack:UpsertPq      | 33.690 ms                 | 72.779 ms                 |
| ProcessOneStep            | 57.761 ms                 | 104.760 ms                |
| BlockToStepN              | 270.137 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:38.665005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240130 01:28:39.063627  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:39.665009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 243.847 ms                |
| Forward                   | 5.330 ms                  | 11.641 ms                 |
| Backward                  | 9.628 ms                  | 13.719 ms                 |
| Optimize                  | 2.605 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 38.018 us                 | 38.384 ms                 |
| AfterBackward             | 57.798 ms                 | 104.808 ms                |
| BlockToStepN              | 270.225 ms                | 823.860 ms                |
| OneStep                   | 363.329 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:40.292155  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:40.733006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240130 01:28:41.535959  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:28:41.732007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240130 01:28:42.732009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240130 01:28:42.774189  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.769 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.773 ms                 | 104.760 ms                |
| BlockToStepN              | 270.137 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:43.732005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240130 01:28:44.003800  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 243.847 ms                |
| Forward                   | 5.328 ms                  | 11.641 ms                 |
| Backward                  | 9.624 ms                  | 13.719 ms                 |
| Optimize                  | 2.605 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 37.758 us                 | 38.384 ms                 |
| AfterBackward             | 57.817 ms                 | 104.808 ms                |
| BlockToStepN              | 270.225 ms                | 823.860 ms                |
| OneStep                   | 363.329 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:44.732005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240130 01:28:45.231420  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:45.732008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240130 01:28:46.473906  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:46.732007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240130 01:28:47.732010  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240130 01:28:47.829367  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.765 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.773 ms                 | 104.760 ms                |
| BlockToStepN              | 270.137 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:48.732007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240130 01:28:48.947139  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.332 ms                 | 243.847 ms                |
| Forward                   | 5.322 ms                  | 11.641 ms                 |
| Backward                  | 9.619 ms                  | 13.719 ms                 |
| Optimize                  | 2.606 ms                  | 8.085 ms                  |
| BarrierTimeBeforeRank0    | 37.856 us                 | 38.384 ms                 |
| AfterBackward             | 57.798 ms                 | 104.808 ms                |
| BlockToStepN              | 270.225 ms                | 823.860 ms                |
| OneStep                   | 363.329 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:49.732004  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240130 01:28:50.161967  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:50.732008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240130 01:28:51.408443  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:51.732008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240130 01:28:52.650081  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:52.746928  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=448, pq.top=448
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.729 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.761 ms                 | 104.760 ms                |
| BlockToStepN              | 270.137 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:53.746006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240130 01:28:53.891288  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.067 ms                 | 227.989 ms                |
| Forward                   | 5.314 ms                  | 10.592 ms                 |
| Backward                  | 9.622 ms                  | 13.314 ms                 |
| Optimize                  | 2.606 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 37.307 us                 | 38.081 ms                 |
| AfterBackward             | 57.798 ms                 | 103.905 ms                |
| BlockToStepN              | 270.225 ms                | 823.860 ms                |
| OneStep                   | 363.329 ms                | 1.119 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:54.746006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240130 01:28:55.135135  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:28:55.746008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240130 01:28:56.385576  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:28:56.924610  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240130 01:28:57.719802  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:28:57.924007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=456, pq.top=456
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.729 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.735 ms                 | 103.867 ms                |
| BlockToStepN              | 270.137 ms                | 821.434 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:58.871271  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:28:58.953361  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.067 ms                 | 227.989 ms                |
| Forward                   | 5.311 ms                  | 10.592 ms                 |
| Backward                  | 9.622 ms                  | 13.314 ms                 |
| Optimize                  | 2.606 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 37.735 us                 | 38.081 ms                 |
| AfterBackward             | 57.775 ms                 | 103.905 ms                |
| BlockToStepN              | 273.228 ms                | 821.566 ms                |
| OneStep                   | 368.362 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:28:59.953006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240130 01:29:00.109282  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:29:00.953011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240130 01:29:01.375675  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:29:01.953008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240130 01:29:02.653694  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:29:02.953008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=464, pq.top=464
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.765 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.761 ms                 | 103.867 ms                |
| BlockToStepN              | 289.146 ms                | 821.434 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:03.897511  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:29:03.979493  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.016 ms                 | 227.989 ms                |
| Forward                   | 5.310 ms                  | 10.592 ms                 |
| Backward                  | 9.627 ms                  | 13.322 ms                 |
| Optimize                  | 2.606 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 37.735 us                 | 38.081 ms                 |
| AfterBackward             | 57.798 ms                 | 103.905 ms                |
| BlockToStepN              | 289.233 ms                | 821.566 ms                |
| OneStep                   | 381.763 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:04.979005  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240130 01:29:05.180683  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:29:05.979009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240130 01:29:06.445981  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:29:06.993285  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240130 01:29:07.796428  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:29:07.993008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=472, pq.top=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.485 ms                 |
| ProcessBack:UpsertPq      | 33.774 ms                 | 71.347 ms                 |
| ProcessOneStep            | 57.809 ms                 | 103.867 ms                |
| BlockToStepN              | 289.146 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:08.993011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240130 01:29:09.004209  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.008 ms                 | 227.989 ms                |
| Forward                   | 5.310 ms                  | 10.592 ms                 |
| Backward                  | 9.627 ms                  | 13.322 ms                 |
| Optimize                  | 2.606 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 36.994 us                 | 38.081 ms                 |
| AfterBackward             | 57.854 ms                 | 103.905 ms                |
| BlockToStepN              | 289.233 ms                | 823.860 ms                |
| OneStep                   | 381.763 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:09.993006  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=475, pq.top=475
W20240130 01:29:10.286574  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:29:10.993009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240130 01:29:11.548285  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:29:12.006070  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240130 01:29:12.805454  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 01:29:13.006009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=480, pq.top=480
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.024 ms                  | 14.862 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 12.451 ms                 |
| ProcessBack:UpsertPq      | 33.774 ms                 | 69.859 ms                 |
| ProcessOneStep            | 57.896 ms                 | 103.867 ms                |
| BlockToStepN              | 291.195 ms                | 823.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:14.006008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240130 01:29:14.080916  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.939 ms                  | 227.989 ms                |
| Forward                   | 5.305 ms                  | 10.592 ms                 |
| Backward                  | 9.624 ms                  | 13.322 ms                 |
| Optimize                  | 2.605 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 36.833 us                 | 38.081 ms                 |
| AfterBackward             | 57.935 ms                 | 103.905 ms                |
| BlockToStepN              | 291.296 ms                | 823.860 ms                |
| OneStep                   | 381.763 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:15.006004  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240130 01:29:15.343828  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:29:16.006009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240130 01:29:16.639851  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:29:17.006008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240130 01:29:18.031596  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 01:29:18.180128  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=488, pq.top=488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.050 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 12.451 ms                 |
| ProcessBack:UpsertPq      | 33.785 ms                 | 69.859 ms                 |
| ProcessOneStep            | 57.904 ms                 | 103.867 ms                |
| BlockToStepN              | 291.195 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:19.180008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240130 01:29:19.224750  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.939 ms                  | 227.989 ms                |
| Forward                   | 5.304 ms                  | 10.592 ms                 |
| Backward                  | 9.619 ms                  | 13.322 ms                 |
| Optimize                  | 2.600 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 36.458 us                 | 38.384 ms                 |
| AfterBackward             | 57.944 ms                 | 103.905 ms                |
| BlockToStepN              | 302.098 ms                | 829.355 ms                |
| OneStep                   | 394.686 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:20.180011  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240130 01:29:20.529378  4397 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 01:29:21.180009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240130 01:29:21.813125  4397 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 01:29:22.180009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240130 01:29:23.096096  4397 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 01:29:23.180008  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=496, pq.top=496
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.050 ms                  | 14.948 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 12.451 ms                 |
| ProcessBack:UpsertPq      | 33.832 ms                 | 69.859 ms                 |
| ProcessOneStep            | 57.933 ms                 | 103.867 ms                |
| BlockToStepN              | 302.004 ms                | 829.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:24.180009  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240130 01:29:24.376953  4397 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.988 ms                  | 227.989 ms                |
| Forward                   | 5.303 ms                  | 11.641 ms                 |
| Backward                  | 9.618 ms                  | 13.322 ms                 |
| Optimize                  | 2.598 ms                  | 5.668 ms                  |
| BarrierTimeBeforeRank0    | 35.975 us                 | 38.384 ms                 |
| AfterBackward             | 57.971 ms                 | 103.905 ms                |
| BlockToStepN              | 384.571 ms                | 829.355 ms                |
| OneStep                   | 477.453 ms                | 1.086 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 01:29:25.180007  3811 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=499, pq.top=499
W20240130 01:29:25.660564  4397 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 0] 500 steps, total: 62.683, sample: 1.941, forward: 0.532, backward: 0.952, update: 0.305
[proc 4] 500 steps, total: 62.683, sample: 1.048, forward: 0.490, backward: 1.069, update: 0.226
[proc 6] 500 steps, total: 62.683, sample: 1.055, forward: 0.502, backward: 1.038, update: 0.225
[proc 7] 500 steps, total: 62.683, sample: 1.250, forward: 0.533, backward: 0.997, update: 0.271
[proc 3] 500 steps, total: 62.683, sample: 1.201, forward: 0.492, backward: 1.040, update: 0.258
[proc 1] 500 steps, total: 62.683, sample: 1.215, forward: 0.497, backward: 1.047, update: 0.247
[proc 2] 500 steps, total: 62.683, sample: 1.203, forward: 0.513, backward: 0.542, update: 0.237
Successfully xmh. training takes 283.1954905986786 seconds
[proc 5] 500 steps, total: 62.683, sample: 1.182, forward: 0.542, backward: 1.039, update: 0.259
before call kg_cache_controller.StopThreads()
W20240130 01:29:26.038959  3811 grad_async_v1.h:230] call StopThreads. PID = 2468
W20240130 01:29:26.038986  3811 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 01:29:26.044046  3811 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 01:29:26.044091  3811 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240130 01:29:26.057746  3811 grad_async_v1.h:251] StopThreads done.
