WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 13:40:59.856230 45964 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_36', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [45964 sampler.py:454] Start PreSampling
WARNING [45964 sampler.py:532] Before construct renumbering_dict
WARNING [45964 sampler.py:555] PreSampling done
W20240129 13:41:04.619372 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 13:41:04.619525 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 13:41:04.619561 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 13:41:04.619603 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 13:41:04.619645 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 13:41:04.619675 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 13:41:04.619706 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 13:41:04.619745 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 13:41:04.619787 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 13:41:04.619822 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 13:41:04.619854 45964 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 13:41:04.619884 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 13:41:04.619913 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 13:41:04.620026 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 13:41:04.620098 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 13:41:04.620136 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 13:41:04.620185 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 13:41:04.620219 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 13:41:04.620260 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 13:41:04.620298 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 13:41:04.620332 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 13:41:04.620364 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 13:41:04.620409 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 13:41:04.620442 45964 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 13:41:04.620471 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 13:41:04.620505 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 13:41:04.620572 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 13:41:04.620618 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 13:41:04.620656 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 13:41:04.620689 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 13:41:04.620723 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 13:41:04.620755 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 13:41:04.620796 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 13:41:04.620831 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 13:41:04.620863 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 13:41:04.620908 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 13:41:04.620940 45964 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 13:41:04.620970 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 13:41:04.621003 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 13:41:04.621075 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 13:41:04.621111 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 13:41:04.621145 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 13:41:04.621201 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 13:41:04.621253 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 13:41:04.621285 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 13:41:04.621320 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 13:41:04.621356 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 13:41:04.621392 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 13:41:04.621426 45964 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 13:41:04.621459 45964 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 13:41:04.621484 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 13:41:04.621512 45964 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 13:41:04.867359 45964 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240129 13:41:04.867551 45964 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 858,  934,  961,  ..., 5311, 4081, 5102]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.120 seconds
[Rank1] pid = 46391
[Rank2] pid = 46433
INFO [45964 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [46433 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [46519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [46391 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [46519 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [46391 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [45964 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [46433 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 13:41:06.848347 46520 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240129 13:41:06.848934 46521 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240129 13:41:06.849092 46392 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240129 13:41:06.849177 46456 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240129 13:41:06.877522 46521 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100014876000 7.629 MB
W20240129 13:41:06.877687 46521 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100015019000 7.629 MB
W20240129 13:41:06.877763 46521 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000157bc000 1.49 GB
W20240129 13:41:06.877838 46521 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100074d9f000 1.49 GB
W20240129 13:41:06.877893 46521 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 13:41:06.880703 46521 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 13:41:06.880702 46520 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000d438a000 7.629 MB
W20240129 13:41:06.880846 46520 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000d4b2d000 7.629 MB
W20240129 13:41:06.880856 46392 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000d52d0000 7.629 MB
W20240129 13:41:06.880910 46456 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000d5a73000 7.629 MB
W20240129 13:41:06.880926 46520 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1000d6216000 1.49 GB
W20240129 13:41:06.880988 46520 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001357f9000 1.49 GB
W20240129 13:41:06.881035 46392 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100194ddc000 7.629 MB
W20240129 13:41:06.881038 46520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 13:41:06.881062 46456 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10019557f000 7.629 MB
W20240129 13:41:06.881110 46392 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x100195d22000 1.49 GB
W20240129 13:41:06.881136 46456 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1001f5305000 1.49 GB
W20240129 13:41:06.881175 46392 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1002548e8000 1.49 GB
W20240129 13:41:06.881213 46456 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1002b3ecb000 1.49 GB
W20240129 13:41:06.881232 46392 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 13:41:06.881261 46456 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 13:41:06.887214 46520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 13:41:06.887218 46392 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 13:41:06.887252 46456 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [46391 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [46519 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [46433 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 46519
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [45964 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 13:41:08.428728 46520 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 13:41:08.428956 46521 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 13:41:08.429265 46456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 13:41:08.430236 46392 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240129 13:41:08.432617 46520 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 13:41:08.432796 46520 grad_base.h:184] Init GradProcessingBase done
I20240129 13:41:08.435082 46520 grad_async_v1.h:199] Use main thread to update emb.
W20240129 13:41:08.435115 46520 kg_controller.h:75] after init GradAsyncProcessing
I20240129 13:41:08.435122 46520 kg_controller.h:84] Construct KGCacheController done
E20240129 13:41:08.920377 46456 recstore.cc:66] init folly done
E20240129 13:41:08.920688 46392 recstore.cc:66] init folly done
E20240129 13:41:08.920711 46521 recstore.cc:66] init folly done
E20240129 13:41:08.920744 46520 recstore.cc:66] init folly done
I20240129 13:41:08.921622 46520 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 13:41:09.251413 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
I20240129 13:41:09.294994 46520 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240129 13:41:09.304955 46392 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 13:41:09.307126 46456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 13:41:09.343480 46521 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 13:41:10.690410 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240129 13:41:10.826871 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:41:11.717399 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240129 13:41:11.954382 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end8
W20240129 13:41:12.717020 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240129 13:41:13.198911 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.447 ms                  | 26.815 ms                 |
| Forward                   | 5.865 ms                  | 555.511 ms                |
| Backward                  | 9.357 ms                  | 198.521 ms                |
| Optimize                  | 2.436 ms                  | 5.416 ms                  |
| BarrierTimeBeforeRank0    | 932.507 us                | 7.652 ms                  |
| AfterBackward             | 14.077 ms                 | 585.052 ms                |
| BlockToStepN              | 13.208 ms                 | 551.541 ms                |
| OneStep                   | 56.417 ms                 | 1.482 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:13.717017 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.355 ms                  | 156.729 ms                |
| ProcessBack:UpdateCache   | 2.638 ms                  | 303.198 ms                |
| ProcessBack:UpsertPq      | 8.102 ms                  | 33.368 ms                 |
| ProcessOneStep            | 14.045 ms                 | 584.469 ms                |
| BlockToStepN              | 26.579 ms                 | 551.352 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:14.201557 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:41:14.733083 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240129 13:41:15.363720 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:41:15.733011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240129 13:41:16.445902 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:16.733006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240129 13:41:17.574230 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:41:17.733011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.590 ms                  | 27.045 ms                 |
| Forward                   | 5.817 ms                  | 555.511 ms                |
| Backward                  | 9.352 ms                  | 198.521 ms                |
| Optimize                  | 2.325 ms                  | 5.416 ms                  |
| BarrierTimeBeforeRank0    | 271.375 us                | 13.785 ms                 |
| AfterBackward             | 14.240 ms                 | 585.052 ms                |
| BlockToStepN              | 162.325 ms                | 551.541 ms                |
| OneStep                   | 199.312 ms                | 1.482 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:18.644259 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:18.733011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 138.267 ms                |
| ProcessBack:UpdateCache   | 2.567 ms                  | 302.348 ms                |
| ProcessBack:UpsertPq      | 8.455 ms                  | 30.194 ms                 |
| ProcessOneStep            | 14.614 ms                 | 584.469 ms                |
| BlockToStepN              | 167.667 ms                | 551.352 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:19.733012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=52, pq.top=52
W20240129 13:41:19.756925 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:41:20.733014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240129 13:41:20.896615 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:21.733006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240129 13:41:21.901043 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:41:22.733013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240129 13:41:22.906100 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.494 ms                  | 26.815 ms                 |
| Forward                   | 5.559 ms                  | 9.099 ms                  |
| Backward                  | 9.299 ms                  | 11.077 ms                 |
| Optimize                  | 2.336 ms                  | 4.620 ms                  |
| BarrierTimeBeforeRank0    | 178.333 us                | 7.652 ms                  |
| AfterBackward             | 14.077 ms                 | 67.019 ms                 |
| BlockToStepN              | 179.137 ms                | 400.266 ms                |
| OneStep                   | 216.720 ms                | 587.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:23.733011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240129 13:41:23.919381 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.478 ms                  | 138.267 ms                |
| ProcessBack:UpdateCache   | 2.579 ms                  | 302.348 ms                |
| ProcessBack:UpsertPq      | 8.381 ms                  | 30.194 ms                 |
| ProcessOneStep            | 14.045 ms                 | 66.976 ms                 |
| BlockToStepN              | 179.193 ms                | 400.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:24.733021 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240129 13:41:24.937949 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:41:25.733032 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240129 13:41:25.948817 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:26.738951 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240129 13:41:26.955476 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:41:27.763298 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240129 13:41:27.985752 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.600 ms                  | 26.815 ms                 |
| Forward                   | 5.534 ms                  | 9.099 ms                  |
| Backward                  | 9.299 ms                  | 11.077 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 178.333 us                | 7.652 ms                  |
| AfterBackward             | 14.096 ms                 | 67.019 ms                 |
| BlockToStepN              | 186.904 ms                | 400.266 ms                |
| OneStep                   | 229.326 ms                | 587.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:28.763020 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=88, pq.top=88
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.480 ms                  | 5.146 ms                  |
| ProcessBack:UpdateCache   | 2.544 ms                  | 3.516 ms                  |
| ProcessBack:UpsertPq      | 8.384 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.102 ms                 | 66.976 ms                 |
| BlockToStepN              | 188.957 ms                | 400.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:29.037307 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:41:29.763006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240129 13:41:30.044749 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:41:30.763017 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=96, pq.top=96
W20240129 13:41:31.057492 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:31.763005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.518, sample: 0.385, forward: 1.056, backward: 0.980, update: 0.245
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.557, sample: 0.382, forward: 1.039, backward: 1.102, update: 0.249
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.555, sample: 0.395, forward: 1.042, backward: 1.133, update: 0.243
train_sampler.Prefill()
-------Step 0-------
tensor([ 7093,  7463, 10428,  5869,    77,  4366, 10763,    93,  6382, 12234]) tensor([  961, 11274,  3032, 14062,  3099,  6191,  4462,  7211,  5067, 14084])
-------Step 1-------
tensor([ 7093,  7463, 10428,  5869,    77,  4366, 10763,    93,  6382, 12234]) tensor([ 2435, 13554,  7713,  5652, 13265,  5112,   980, 11509,   835,  7454])
-------Step 2-------
tensor([10826,    28,  1520,   107,  9379,  2705, 14891,   854,  9197,  4192]) tensor([ 5139,  3518,  6771,  4340,  9234,  6795, 13291,  9209, 10173,  8389])
-------Step 3-------
tensor([10826,    28,  1520,   107,  9379,  2705, 14891,   854,  9197,  4192]) tensor([ 7073,  8805, 11223,  8415,   706,  9225, 11814,  6218,  2723, 13218])
-------Step 4-------
tensor([   71,  4947, 13318, 12690, 10699,  7145, 11436,  1835, 10000,  2387]) tensor([10541,  1158,  2010,  1293,  8453, 10260,   856,  1666,  6632,  4388])
-------Step 5-------
tensor([   71,  4947, 13318, 12690, 10699,  7145, 11436,  1835, 10000,  2387]) tensor([ 1216, 13819,  1281,  3827,  3880,    29, 14741,  4293,  3999, 11861])
-------Step 6-------
tensor([11597,  8962,  6224,   113,  1062, 13571,   109,  8649,  7135,    34]) tensor([ 5088, 13163,   749,  2994,  2654,  2488,  1099,  2242,  2451, 13682])
-------Step 7-------
tensor([11597,  8962,  6224,   113,  1062, 13571,   109,  8649,  7135,    34]) tensor([ 7235,  5190, 14367, 10152,  7532,  1460, 11823,  4224,  4091, 10291])
-------Step 8-------
tensor([ 7096,  9283,  5822, 10234,  2857,  5980, 12256, 14562,   108, 10877]) tensor([ 2161, 10021,  6425,   493,  5785, 13530,  4496,  8717,  6715, 11507])
-------Step 9-------
tensor([ 7096,  9283,  5822, 10234,  2857,  5980, 12256, 14562,   108, 10877]) tensor([ 2904,   450,  8618,  9113,  2054,  2784,  8836,  3807,   488, 13747])
before start barrier
start train
[proc 0] 100 steps, total: 22.567, sample: 0.457, forward: 1.091, backward: 1.062, update: 0.260
W20240129 13:41:32.150652 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:41:32.763015 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240129 13:41:33.161289 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.600 ms                  | 26.815 ms                 |
| Forward                   | 5.442 ms                  | 9.099 ms                  |
| Backward                  | 9.299 ms                  | 11.077 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 145.179 us                | 7.652 ms                  |
| AfterBackward             | 14.248 ms                 | 67.019 ms                 |
| BlockToStepN              | 196.899 ms                | 400.266 ms                |
| OneStep                   | 238.018 ms                | 587.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:33.763006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=108, pq.top=108
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.486 ms                  | 5.146 ms                  |
| ProcessBack:UpdateCache   | 2.545 ms                  | 3.516 ms                  |
| ProcessBack:UpsertPq      | 8.403 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.216 ms                 | 66.976 ms                 |
| BlockToStepN              | 199.364 ms                | 400.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:34.232606 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:41:34.775910 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240129 13:41:35.265738 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:41:35.775007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240129 13:41:36.424299 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:36.790290 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240129 13:41:37.596438 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:41:37.790006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.577 ms                  | 26.815 ms                 |
| Forward                   | 5.411 ms                  | 9.099 ms                  |
| Backward                  | 9.291 ms                  | 11.077 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 171.725 us                | 9.753 ms                  |
| AfterBackward             | 14.162 ms                 | 67.019 ms                 |
| BlockToStepN              | 204.248 ms                | 400.266 ms                |
| OneStep                   | 242.822 ms                | 587.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:38.619550 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:41:38.790005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=126, pq.top=126
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.485 ms                  | 5.105 ms                  |
| ProcessBack:UpdateCache   | 2.546 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.455 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.133 ms                 | 66.976 ms                 |
| BlockToStepN              | 204.193 ms                | 400.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:39.711784 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:41:39.790010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240129 13:41:40.790005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240129 13:41:40.829465 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:41:41.790015 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240129 13:41:41.973446 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:42.790005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240129 13:41:43.185454 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.523 ms                  | 26.815 ms                 |
| Forward                   | 5.415 ms                  | 9.099 ms                  |
| Backward                  | 9.289 ms                  | 11.077 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 170.098 us                | 13.785 ms                 |
| AfterBackward             | 14.190 ms                 | 67.019 ms                 |
| BlockToStepN              | 207.334 ms                | 400.266 ms                |
| OneStep                   | 248.364 ms                | 587.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:43.790006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=144, pq.top=144
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.493 ms                  | 5.105 ms                  |
| ProcessBack:UpdateCache   | 2.544 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.491 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.164 ms                 | 66.976 ms                 |
| BlockToStepN              | 208.196 ms                | 400.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:44.347548 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:41:44.790014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240129 13:41:45.347523 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:41:45.790006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240129 13:41:46.478997 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:41:46.790014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240129 13:41:47.627526 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:41:47.790006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.543 ms                  | 27.045 ms                 |
| Forward                   | 5.411 ms                  | 7.032 ms                  |
| Backward                  | 9.291 ms                  | 10.991 ms                 |
| Optimize                  | 2.366 ms                  | 4.620 ms                  |
| BarrierTimeBeforeRank0    | 165.907 us                | 13.785 ms                 |
| AfterBackward             | 14.267 ms                 | 37.953 ms                 |
| BlockToStepN              | 212.700 ms                | 304.274 ms                |
| OneStep                   | 250.427 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:48.790005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240129 13:41:48.811782 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.493 ms                  | 5.105 ms                  |
| ProcessBack:UpdateCache   | 2.534 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.516 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.225 ms                 | 37.907 ms                 |
| BlockToStepN              | 212.633 ms                | 304.133 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:49.790020 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240129 13:41:49.918010 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:41:50.828408 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240129 13:41:51.071460 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:41:51.828006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240129 13:41:52.232648 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:41:52.854226 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240129 13:41:53.383872 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.569 ms                  | 27.283 ms                 |
| Forward                   | 5.403 ms                  | 7.032 ms                  |
| Backward                  | 9.293 ms                  | 10.991 ms                 |
| Optimize                  | 2.365 ms                  | 4.620 ms                  |
| BarrierTimeBeforeRank0    | 112.129 us                | 20.413 ms                 |
| AfterBackward             | 14.267 ms                 | 37.953 ms                 |
| BlockToStepN              | 216.652 ms                | 304.274 ms                |
| OneStep                   | 255.653 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:53.854007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.495 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.522 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.516 ms                  | 16.192 ms                 |
| ProcessOneStep            | 14.237 ms                 | 37.907 ms                 |
| BlockToStepN              | 216.914 ms                | 304.133 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:54.569242 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:41:54.854012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240129 13:41:55.571748 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:41:55.880807 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240129 13:41:56.778936 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:41:56.880005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240129 13:41:57.880014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240129 13:41:57.890018 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.569 ms                  | 27.283 ms                 |
| Forward                   | 5.401 ms                  | 7.032 ms                  |
| Backward                  | 9.291 ms                  | 10.991 ms                 |
| Optimize                  | 2.366 ms                  | 4.620 ms                  |
| BarrierTimeBeforeRank0    | 156.289 us                | 23.387 ms                 |
| AfterBackward             | 14.248 ms                 | 37.953 ms                 |
| BlockToStepN              | 220.269 ms                | 306.679 ms                |
| OneStep                   | 261.092 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:58.880004 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.492 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.501 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.496 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.225 ms                 | 37.907 ms                 |
| BlockToStepN              | 220.449 ms                | 306.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:41:59.069485 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:41:59.880009 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=198, pq.top=198
W20240129 13:42:00.349011 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 0] 200 steps, total: 28.807, sample: 0.535, forward: 0.527, backward: 0.922, update: 0.245
[proc 2] 200 steps, total: 28.807, sample: 0.465, forward: 0.517, backward: 0.978, update: 0.255
[proc 3] 200 steps, total: 28.807, sample: 0.424, forward: 0.498, backward: 0.900, update: 0.241
[proc 1] 200 steps, total: 28.807, sample: 0.418, forward: 0.492, backward: 0.954, update: 0.246
W20240129 13:42:00.880007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240129 13:42:01.353262 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:42:01.903905 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240129 13:42:02.481503 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:42:02.903014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=208, pq.top=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.564 ms                  | 33.352 ms                 |
| Forward                   | 5.386 ms                  | 7.796 ms                  |
| Backward                  | 9.293 ms                  | 10.991 ms                 |
| Optimize                  | 2.365 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 171.725 us                | 24.842 ms                 |
| AfterBackward             | 14.267 ms                 | 37.953 ms                 |
| BlockToStepN              | 225.319 ms                | 306.679 ms                |
| OneStep                   | 265.267 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:03.719026 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:42:03.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.497 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.492 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.493 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.237 ms                 | 37.907 ms                 |
| BlockToStepN              | 225.273 ms                | 306.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:04.734504 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:42:04.903008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240129 13:42:05.843958 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:05.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240129 13:42:06.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240129 13:42:07.018904 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:07.903017 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240129 13:42:08.136355 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.577 ms                  | 33.352 ms                 |
| Forward                   | 5.399 ms                  | 7.796 ms                  |
| Backward                  | 9.293 ms                  | 10.991 ms                 |
| Optimize                  | 2.367 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 190.113 us                | 25.436 ms                 |
| AfterBackward             | 14.240 ms                 | 37.953 ms                 |
| BlockToStepN              | 227.736 ms                | 311.638 ms                |
| OneStep                   | 267.844 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:08.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.492 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.480 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.490 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.192 ms                 | 37.907 ms                 |
| BlockToStepN              | 227.934 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:09.302865 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:42:09.903012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240129 13:42:10.325384 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:42:10.903013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240129 13:42:11.545377 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:42:11.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240129 13:42:12.545822 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:42:12.903014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.598 ms                  | 33.352 ms                 |
| Forward                   | 5.386 ms                  | 7.796 ms                  |
| Backward                  | 9.293 ms                  | 10.991 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 252.472 us                | 25.436 ms                 |
| AfterBackward             | 14.214 ms                 | 37.953 ms                 |
| BlockToStepN              | 231.896 ms                | 311.638 ms                |
| OneStep                   | 270.127 ms                | 445.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:13.738147 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:42:13.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.491 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.469 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.493 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.216 ms                 | 37.907 ms                 |
| BlockToStepN              | 232.078 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:14.765632 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:42:14.903012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240129 13:42:15.903014 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240129 13:42:15.970980 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:42:16.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240129 13:42:17.235455 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:17.903012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240129 13:42:18.235544 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.625 ms                  | 29.474 ms                 |
| Forward                   | 5.380 ms                  | 7.032 ms                  |
| Backward                  | 9.296 ms                  | 11.077 ms                 |
| Optimize                  | 2.366 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 252.472 us                | 25.031 ms                 |
| AfterBackward             | 14.248 ms                 | 26.099 ms                 |
| BlockToStepN              | 233.473 ms                | 311.638 ms                |
| OneStep                   | 274.297 ms                | 370.246 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:18.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.489 ms                  | 4.595 ms                  |
| ProcessBack:UpdateCache   | 2.462 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.493 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.225 ms                 | 26.058 ms                 |
| BlockToStepN              | 234.118 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:19.399423 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:19.903013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240129 13:42:20.399821 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:20.903009 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240129 13:42:21.559923 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:42:21.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240129 13:42:22.560418 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:22.903009 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.600 ms                  | 29.474 ms                 |
| Forward                   | 5.363 ms                  | 7.032 ms                  |
| Backward                  | 9.299 ms                  | 11.077 ms                 |
| Optimize                  | 2.374 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 287.645 us                | 25.031 ms                 |
| AfterBackward             | 14.240 ms                 | 26.099 ms                 |
| BlockToStepN              | 235.837 ms                | 311.638 ms                |
| OneStep                   | 278.501 ms                | 370.246 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:23.757998 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:42:23.903008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.486 ms                  | 4.521 ms                  |
| ProcessBack:UpdateCache   | 2.456 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.485 ms                  | 16.192 ms                 |
| ProcessOneStep            | 14.193 ms                 | 26.058 ms                 |
| BlockToStepN              | 237.192 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:24.765904 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:42:24.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240129 13:42:25.903020 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240129 13:42:26.017985 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:42:26.903010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240129 13:42:27.268080 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:42:27.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240129 13:42:28.269429 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.598 ms                  | 29.474 ms                 |
| Forward                   | 5.361 ms                  | 7.032 ms                  |
| Backward                  | 9.299 ms                  | 11.077 ms                 |
| Optimize                  | 2.375 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 287.645 us                | 25.470 ms                 |
| AfterBackward             | 14.212 ms                 | 26.099 ms                 |
| BlockToStepN              | 239.749 ms                | 311.638 ms                |
| OneStep                   | 280.018 ms                | 370.246 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:28.903013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=292, pq.top=292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.486 ms                  | 4.521 ms                  |
| ProcessBack:UpdateCache   | 2.454 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.475 ms                  | 16.192 ms                 |
| ProcessOneStep            | 14.184 ms                 | 26.058 ms                 |
| BlockToStepN              | 239.926 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:29.467164 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:42:29.903007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240129 13:42:30.469503 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:42:30.903010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=298, pq.top=298
[proc 1] 300 steps, total: 31.002, sample: 0.390, forward: 0.505, backward: 0.873, update: 0.250
[proc 3] 300 steps, total: 31.002, sample: 0.396, forward: 0.493, backward: 0.922, update: 0.242
[proc 2] 300 steps, total: 31.002, sample: 0.405, forward: 0.511, backward: 0.979, update: 0.267
[proc 0] 300 steps, total: 31.002, sample: 0.472, forward: 0.508, backward: 0.928, update: 0.249
W20240129 13:42:31.672195 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:42:31.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240129 13:42:32.674643 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:42:32.903005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=304, pq.top=304
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.600 ms                  | 29.474 ms                 |
| Forward                   | 5.335 ms                  | 7.032 ms                  |
| Backward                  | 9.300 ms                  | 11.077 ms                 |
| Optimize                  | 2.375 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 287.645 us                | 25.470 ms                 |
| AfterBackward             | 14.209 ms                 | 26.099 ms                 |
| BlockToStepN              | 242.600 ms                | 311.638 ms                |
| OneStep                   | 282.509 ms                | 370.246 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:33.868508 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:33.903009 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=308, pq.top=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.487 ms                  | 4.521 ms                  |
| ProcessBack:UpdateCache   | 2.449 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.481 ms                  | 16.192 ms                 |
| ProcessOneStep            | 14.181 ms                 | 26.058 ms                 |
| BlockToStepN              | 242.661 ms                | 311.557 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:34.876551 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:42:34.926777 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240129 13:42:35.878746 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:42:35.926008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240129 13:42:36.926005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240129 13:42:37.100589 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:37.926007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240129 13:42:38.130635 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.600 ms                  | 33.582 ms                 |
| Forward                   | 5.328 ms                  | 7.032 ms                  |
| Backward                  | 9.301 ms                  | 11.077 ms                 |
| Optimize                  | 2.377 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 271.375 us                | 25.470 ms                 |
| AfterBackward             | 14.209 ms                 | 26.099 ms                 |
| BlockToStepN              | 243.404 ms                | 332.404 ms                |
| OneStep                   | 283.523 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:38.926012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.489 ms                  | 4.521 ms                  |
| ProcessBack:UpdateCache   | 2.449 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.490 ms                  | 16.192 ms                 |
| ProcessOneStep            | 14.171 ms                 | 26.058 ms                 |
| BlockToStepN              | 243.286 ms                | 332.347 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:39.284409 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:39.926007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240129 13:42:40.293002 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:40.926013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240129 13:42:41.539335 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:41.926007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240129 13:42:42.541895 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:42.926005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.627 ms                  | 33.582 ms                 |
| Forward                   | 5.321 ms                  | 7.032 ms                  |
| Backward                  | 9.306 ms                  | 11.077 ms                 |
| Optimize                  | 2.390 ms                  | 4.694 ms                  |
| BarrierTimeBeforeRank0    | 287.645 us                | 25.470 ms                 |
| AfterBackward             | 14.205 ms                 | 26.099 ms                 |
| BlockToStepN              | 245.983 ms                | 344.456 ms                |
| OneStep                   | 284.250 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:43.550406 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:43.926016 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=339, pq.top=339
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.489 ms                  | 4.390 ms                  |
| ProcessBack:UpdateCache   | 2.448 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.479 ms                  | 14.916 ms                 |
| ProcessOneStep            | 14.164 ms                 | 26.058 ms                 |
| BlockToStepN              | 245.997 ms                | 344.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:44.721721 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:44.926005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240129 13:42:45.740949 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:45.926012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240129 13:42:46.926012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240129 13:42:46.964277 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:42:47.926007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=352, pq.top=352
W20240129 13:42:48.192564 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.635 ms                  | 33.352 ms                 |
| Forward                   | 5.312 ms                  | 7.003 ms                  |
| Backward                  | 9.300 ms                  | 10.991 ms                 |
| Optimize                  | 2.403 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 302.310 us                | 25.436 ms                 |
| AfterBackward             | 14.190 ms                 | 23.723 ms                 |
| BlockToStepN              | 246.918 ms                | 334.579 ms                |
| OneStep                   | 286.303 ms                | 404.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:48.926012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.492 ms                  | 4.390 ms                  |
| ProcessBack:UpdateCache   | 2.449 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.464 ms                  | 14.916 ms                 |
| ProcessOneStep            | 14.164 ms                 | 23.687 ms                 |
| BlockToStepN              | 247.497 ms                | 334.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:49.208989 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:42:49.926008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240129 13:42:50.211422 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:42:50.953572 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240129 13:42:51.233054 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:51.953019 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=364, pq.top=364
W20240129 13:42:52.260728 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:52.964529 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240129 13:42:53.277344 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.637 ms                  | 33.352 ms                 |
| Forward                   | 5.294 ms                  | 7.003 ms                  |
| Backward                  | 9.299 ms                  | 10.991 ms                 |
| Optimize                  | 2.394 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 295.587 us                | 25.470 ms                 |
| AfterBackward             | 14.190 ms                 | 23.723 ms                 |
| BlockToStepN              | 249.543 ms                | 344.456 ms                |
| OneStep                   | 289.076 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.489 ms                  | 4.390 ms                  |
| ProcessBack:UpdateCache   | 2.449 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.475 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.171 ms                 | 23.687 ms                 |
| BlockToStepN              | 249.487 ms                | 344.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:53.964011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=370, pq.top=370
W20240129 13:42:54.591926 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:42:54.977092 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240129 13:42:55.597780 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:42:55.977006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=376, pq.top=376
W20240129 13:42:56.603737 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:42:56.977012 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240129 13:42:57.617158 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:42:57.977008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=382, pq.top=382
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.652 ms                  | 33.352 ms                 |
| Forward                   | 5.300 ms                  | 7.003 ms                  |
| Backward                  | 9.300 ms                  | 10.991 ms                 |
| Optimize                  | 2.390 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 295.436 us                | 26.060 ms                 |
| AfterBackward             | 14.212 ms                 | 23.723 ms                 |
| BlockToStepN              | 250.788 ms                | 344.456 ms                |
| OneStep                   | 290.780 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:58.835947 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.488 ms                  | 3.604 ms                  |
| ProcessBack:UpdateCache   | 2.448 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.491 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.189 ms                 | 23.687 ms                 |
| BlockToStepN              | 250.839 ms                | 344.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:42:58.977005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240129 13:42:59.977015 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240129 13:43:00.066977 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:43:00.977010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240129 13:43:01.088088 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:43:01.977007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240129 13:43:02.101748 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:43:02.977007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240129 13:43:03.342456 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.656 ms                  | 33.352 ms                 |
| Forward                   | 5.286 ms                  | 7.003 ms                  |
| Backward                  | 9.299 ms                  | 10.991 ms                 |
| Optimize                  | 2.383 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 268.395 us                | 26.060 ms                 |
| AfterBackward             | 14.215 ms                 | 23.723 ms                 |
| BlockToStepN              | 251.772 ms                | 344.456 ms                |
| OneStep                   | 292.460 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.486 ms                  | 3.604 ms                  |
| ProcessBack:UpdateCache   | 2.446 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.493 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.189 ms                 | 23.687 ms                 |
| BlockToStepN              | 251.964 ms                | 344.350 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:03.977010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 3] 400 steps, total: 32.320, sample: 0.391, forward: 0.500, backward: 0.914, update: 0.240
[proc 0] 400 steps, total: 32.320, sample: 0.498, forward: 0.498, backward: 0.921, update: 0.244
[proc 2] 400 steps, total: 32.320, sample: 0.413, forward: 0.497, backward: 0.805, update: 0.226
[proc 1] 400 steps, total: 32.321, sample: 0.420, forward: 0.505, backward: 0.961, update: 0.251
W20240129 13:43:04.355356 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:43:04.977005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240129 13:43:05.375674 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:43:05.977008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240129 13:43:06.419737 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:43:06.977016 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240129 13:43:07.515823 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:43:07.977010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=412, pq.top=412
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.665 ms                  | 33.352 ms                 |
| Forward                   | 5.285 ms                  | 7.003 ms                  |
| Backward                  | 9.300 ms                  | 10.991 ms                 |
| Optimize                  | 2.379 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 276.110 us                | 26.060 ms                 |
| AfterBackward             | 14.222 ms                 | 23.723 ms                 |
| BlockToStepN              | 252.829 ms                | 349.565 ms                |
| OneStep                   | 293.496 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:08.558769 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.486 ms                  | 3.604 ms                  |
| ProcessBack:UpdateCache   | 2.446 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.515 ms                  | 16.745 ms                 |
| ProcessOneStep            | 14.193 ms                 | 23.687 ms                 |
| BlockToStepN              | 254.050 ms                | 349.506 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:08.977010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240129 13:43:09.602056 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:43:09.990262 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=418, pq.top=418
W20240129 13:43:10.681807 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:43:10.990007 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240129 13:43:11.713443 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:43:11.990010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240129 13:43:12.716068 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:43:13.006836 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.670 ms                  | 33.352 ms                 |
| Forward                   | 5.285 ms                  | 7.003 ms                  |
| Backward                  | 9.300 ms                  | 10.991 ms                 |
| Optimize                  | 2.377 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 257.762 us                | 26.614 ms                 |
| AfterBackward             | 14.256 ms                 | 26.099 ms                 |
| BlockToStepN              | 255.558 ms                | 349.565 ms                |
| OneStep                   | 296.010 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:13.910188 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.487 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.443 ms                  | 3.198 ms                  |
| ProcessBack:UpsertPq      | 8.537 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.237 ms                 | 26.058 ms                 |
| BlockToStepN              | 256.441 ms                | 349.506 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:14.006006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240129 13:43:14.972991 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:43:15.006009 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240129 13:43:15.991271 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:43:16.046988 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=436, pq.top=436
W20240129 13:43:17.001325 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:43:17.055819 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240129 13:43:18.053606 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:43:18.090504 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=442, pq.top=442
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 33.352 ms                 |
| Forward                   | 5.280 ms                  | 7.003 ms                  |
| Backward                  | 9.300 ms                  | 10.991 ms                 |
| Optimize                  | 2.375 ms                  | 4.670 ms                  |
| BarrierTimeBeforeRank0    | 258.598 us                | 26.614 ms                 |
| AfterBackward             | 14.316 ms                 | 26.099 ms                 |
| BlockToStepN              | 258.693 ms                | 349.565 ms                |
| OneStep                   | 296.986 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.484 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.439 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.562 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.282 ms                 | 26.058 ms                 |
| BlockToStepN              | 258.582 ms                | 349.506 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:19.070636 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:43:19.090001 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240129 13:43:20.083053 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:43:20.090003 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=448, pq.top=448
W20240129 13:43:21.090019 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240129 13:43:21.391685 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:43:22.092406 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=454, pq.top=454
W20240129 13:43:22.394096 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:43:23.110991 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240129 13:43:23.442754 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.684 ms                  | 29.933 ms                 |
| Forward                   | 5.270 ms                  | 7.003 ms                  |
| Backward                  | 9.301 ms                  | 10.991 ms                 |
| Optimize                  | 2.374 ms                  | 4.637 ms                  |
| BarrierTimeBeforeRank0    | 268.395 us                | 26.060 ms                 |
| AfterBackward             | 14.346 ms                 | 23.723 ms                 |
| BlockToStepN              | 259.490 ms                | 349.565 ms                |
| OneStep                   | 298.163 ms                | 404.519 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.485 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.443 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.594 ms                  | 16.956 ms                 |
| ProcessOneStep            | 14.328 ms                 | 23.687 ms                 |
| BlockToStepN              | 259.370 ms                | 349.506 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:24.110013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240129 13:43:24.446290 47202 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:43:25.110008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240129 13:43:25.449947 47202 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:43:26.110018 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240129 13:43:26.499341 47202 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:43:27.110011 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240129 13:43:27.674151 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:43:28.110006 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.692 ms                  | 33.582 ms                 |
| Forward                   | 5.270 ms                  | 7.003 ms                  |
| Backward                  | 9.299 ms                  | 10.991 ms                 |
| Optimize                  | 2.366 ms                  | 4.637 ms                  |
| BarrierTimeBeforeRank0    | 258.598 us                | 26.060 ms                 |
| AfterBackward             | 14.368 ms                 | 25.568 ms                 |
| BlockToStepN              | 260.287 ms                | 351.353 ms                |
| OneStep                   | 300.540 ms                | 407.126 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:28.688053 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.487 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.443 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.603 ms                  | 17.187 ms                 |
| ProcessOneStep            | 14.362 ms                 | 25.544 ms                 |
| BlockToStepN              | 260.194 ms                | 351.238 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:29.110008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240129 13:43:29.694948 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:43:30.110013 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240129 13:43:30.846390 47202 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:43:31.110010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240129 13:43:31.852253 47202 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:43:32.110010 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240129 13:43:33.004182 47202 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:43:33.110008 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=486, pq.top=486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.719 ms                  | 33.582 ms                 |
| Forward                   | 5.265 ms                  | 7.003 ms                  |
| Backward                  | 9.301 ms                  | 10.991 ms                 |
| Optimize                  | 2.367 ms                  | 4.637 ms                  |
| BarrierTimeBeforeRank0    | 257.762 us                | 26.060 ms                 |
| AfterBackward             | 14.409 ms                 | 25.568 ms                 |
| BlockToStepN              | 260.671 ms                | 352.107 ms                |
| OneStep                   | 301.115 ms                | 412.844 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.493 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.445 ms                  | 3.379 ms                  |
| ProcessBack:UpsertPq      | 8.603 ms                  | 17.149 ms                 |
| ProcessOneStep            | 14.383 ms                 | 25.544 ms                 |
| BlockToStepN              | 260.753 ms                | 351.950 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:43:34.091365 47202 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:43:34.127705 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240129 13:43:35.092936 47202 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:43:35.127005 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240129 13:43:36.125679 47202 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:43:36.130072 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=495, pq.top=495
W20240129 13:43:37.139540 46520 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=498, pq.top=498
W20240129 13:43:37.143451 47202 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
[proc 1] 500 steps, total: 34.072, sample: 0.433, forward: 0.479, backward: 0.902, update: 0.252
[proc 3] 500 steps, total: 34.072, sample: 0.394, forward: 0.503, backward: 0.817, update: 0.236
[proc 0] 500 steps, total: 34.072, sample: 0.520, forward: 0.510, backward: 0.902, update: 0.230
[proc 2] 500 steps, total: 34.072, sample: 0.447, forward: 0.506, backward: 0.981, update: 0.243
Successfully xmh. training takes 148.7690794467926 seconds
before call kg_cache_controller.StopThreads()
W20240129 13:43:38.064060 46520 grad_async_v1.h:230] call StopThreads. PID = 45964
W20240129 13:43:38.064105 46520 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 13:43:38.069917 46520 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 13:43:38.069937 46520 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 13:43:38.091418 46520 grad_async_v1.h:251] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f94557af590>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.719 ms                  | 33.582 ms                 |
| Forward                   | 5.264 ms                  | 7.003 ms                  |
| Backward                  | 9.306 ms                  | 10.991 ms                 |
| Optimize                  | 2.361 ms                  | 4.637 ms                  |
| BarrierTimeBeforeRank0    | 257.762 us                | 26.614 ms                 |
| AfterBackward             | 14.455 ms                 | 25.568 ms                 |
| BlockToStepN              | 261.597 ms                | 352.107 ms                |
| OneStep                   | 303.157 ms                | 412.844 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.492 ms                  | 3.548 ms                  |
| ProcessBack:UpdateCache   | 2.442 ms                  | 3.465 ms                  |
| ProcessBack:UpsertPq      | 8.611 ms                  | 17.149 ms                 |
| ProcessOneStep            | 14.430 ms                 | 25.544 ms                 |
| BlockToStepN              | 261.530 ms                | 351.950 ms                |
+---------------------------+---------------------------+---------------------------+
