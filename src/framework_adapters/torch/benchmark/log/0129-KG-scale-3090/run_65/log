WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 23:13:46.363983 47436 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_17', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [47436 sampler.py:454] Start PreSampling
WARNING [47436 sampler.py:532] Before construct renumbering_dict
WARNING [47436 sampler.py:555] PreSampling done
W20240129 23:33:01.681594 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 23:33:01.681793 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 23:33:01.681828 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 23:33:01.681864 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 23:33:01.681895 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 23:33:01.681921 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 23:33:01.681948 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 23:33:01.681989 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 23:33:01.682024 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 23:33:01.682061 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 23:33:01.682099 47436 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 23:33:01.682128 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 23:33:01.682154 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 23:33:01.682318 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 23:33:01.682358 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 23:33:01.682390 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 23:33:01.682438 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 23:33:01.682474 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 23:33:01.682499 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 23:33:01.682534 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 23:33:01.682561 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 23:33:01.682591 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 23:33:01.682621 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 23:33:01.682647 47436 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 23:33:01.682672 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 23:33:01.682694 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 23:33:01.682755 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 23:33:01.682790 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 23:33:01.682816 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 23:33:01.682847 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 23:33:01.682878 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 23:33:01.682911 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 23:33:01.682943 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 23:33:01.682977 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 23:33:01.683003 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 23:33:01.683035 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 23:33:01.683060 47436 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 23:33:01.683085 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 23:33:01.683108 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 23:33:01.683172 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 23:33:01.683207 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 23:33:01.683234 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 23:33:01.683269 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 23:33:01.683301 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 23:33:01.683343 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 23:33:01.683379 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 23:33:01.683406 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 23:33:01.683437 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 23:33:01.683465 47436 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 23:33:01.683490 47436 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 23:33:01.683512 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 23:33:01.683540 47436 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 23:33:02.180719 47436 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240129 23:33:02.180886 47436 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Rank2: cached key size 2151353
Rank3: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 8605454,  8605491,   115600,  ..., 75425014, 15873612,  4708050]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1664.517 seconds
[Rank1] pid = 48306
[Rank2] pid = 48401
INFO [47436 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [48306 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48470 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [48401 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [48401 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48470 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48306 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [47436 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [48401 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48306 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48470 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [47436 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 23:41:53.349778 48471 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 23:41:53.350275 48307 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 23:41:53.350629 48402 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 23:41:53.350822 48534 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240129 23:41:54.833235 48534 recstore.cc:66] init folly done
E20240129 23:41:54.833842 48402 recstore.cc:66] init folly done
E20240129 23:41:54.834033 48307 recstore.cc:66] init folly done
E20240129 23:41:54.834053 48471 recstore.cc:66] init folly done
I20240129 23:42:06.560762 48534 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240129 23:42:10.004595 48402 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 23:42:10.087270 48307 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 23:42:11.485679 48471 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.250 ms                  | 7.250 ms                  |
| bucket keys               | 2.121 ms                  | 122.966 ms                |
| forward: a2a keys         | 62.455 ms                 | 852.943 ms                |
| forward: search cache     | 227.752 us                | 20.631 ms                 |
| forward: a2a values       | 4.288 ms                  | 19.216 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 1.636 s                   | 1.636 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.205 ms                  | 94.962 ms                 |
| bucket keys               | 2.121 ms                  | 122.966 ms                |
| forward: a2a keys         | 1.974 ms                  | 852.943 ms                |
| forward: search cache     | 223.667 us                | 20.631 ms                 |
| forward: a2a values       | 4.288 ms                  | 19.216 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 34.175 ms                 | 1.636 s                   |
| back: aggr dram keys      | 17.691 ms                 | 452.141 ms                |
| back: set dram grad       | 5.662 ms                  | 14.462 ms                 |
| back: a2a grad            | 6.688 ms                  | 22.035 ms                 |
| back: grad sum & grad cache  | 2.992 ms                  | 51.213 ms                 |
| Backward                  | 117.491 ms                | 726.939 ms                |
| Optimize                  | 16.993 ms                 | 22.726 ms                 |
| BarrierTimeBeforeRank0    | 50.669 us                 | 99.861 us                 |
| BlockToStepN              | 16.276 us                 | 140.308 us                |
| OneStep                   | 176.656 ms                | 2.394 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.997 ms                  | 83.881 ms                 |
| bucket keys               | 2.121 ms                  | 4.799 ms                  |
| forward: a2a keys         | 1.677 ms                  | 62.455 ms                 |
| forward: search cache     | 226.185 us                | 317.605 us                |
| forward: a2a values       | 4.288 ms                  | 14.793 ms                 |
| forward: join             | 1.403 ms                  | 2.458 ms                  |
| Forward                   | 33.935 ms                 | 65.160 ms                 |
| back: aggr dram keys      | 35.697 ms                 | 72.949 ms                 |
| back: set dram grad       | 5.836 ms                  | 15.180 ms                 |
| back: a2a grad            | 11.216 ms                 | 21.982 ms                 |
| back: grad sum & grad cache  | 3.041 ms                  | 47.091 ms                 |
| Backward                  | 117.826 ms                | 180.082 ms                |
| Optimize                  | 16.327 ms                 | 22.637 ms                 |
| BarrierTimeBeforeRank0    | 46.229 us                 | 90.127 us                 |
| BlockToStepN              | 15.735 us                 | 140.308 us                |
| OneStep                   | 178.254 ms                | 300.061 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.233 ms                  | 94.962 ms                 |
| bucket keys               | 2.781 ms                  | 6.301 ms                  |
| forward: a2a keys         | 1.456 ms                  | 41.721 ms                 |
| forward: search cache     | 225.332 us                | 303.675 us                |
| forward: a2a values       | 4.288 ms                  | 13.066 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 34.103 ms                 | 83.737 ms                 |
| back: aggr dram keys      | 39.975 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.800 ms                  | 14.462 ms                 |
| back: a2a grad            | 11.150 ms                 | 22.035 ms                 |
| back: grad sum & grad cache  | 3.565 ms                  | 46.946 ms                 |
| Backward                  | 117.135 ms                | 180.082 ms                |
| Optimize                  | 16.001 ms                 | 24.605 ms                 |
| BarrierTimeBeforeRank0    | 45.053 us                 | 90.127 us                 |
| BlockToStepN              | 17.389 us                 | 9.567 ms                  |
| OneStep                   | 179.275 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.063, sample: 1.081, forward: 6.260, backward: 9.520, update: 0.427
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.507, sample: 1.450, forward: 5.892, backward: 9.577, update: 0.357
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.981, sample: 1.081, forward: 6.221, backward: 9.924, update: 0.335
[Rank3] pid = 48470
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 1084003,   713079, 58193279,  1713375,   436881,   713112,   713137,
          224803,  1084030,  1084058]) tensor([ 9078484, 38320758,  1459495, 42663773, 69550466,  1629459, 72183253,
        63435112, 44998072, 80409015])
-------Step 1-------
tensor([ 1084003,   713079, 58193279,  1713375,   436881,   713112,   713137,
          224803,  1084030,  1084058]) tensor([38798041, 79419336, 84228446, 12936722, 47968291, 11819914, 85700233,
        63598857, 18184786, 41117084])
-------Step 2-------
tensor([  816499,  1093979, 79078091,  1094006,   816543,   816573,   816603,
        52358945,   816631,   816689]) tensor([47111269,  9430697, 74177044, 16613207, 17358743, 18464178, 74496856,
        14896384, 71828057, 28344555])
-------Step 3-------
tensor([  816499,  1093979, 79078091,  1094006,   816543,   816573,   816603,
        52358945,   816631,   816689]) tensor([  490577, 57697909,  1200219, 33428412, 15995599, 79727186, 79166454,
        54345170, 30829212, 60803835])
-------Step 4-------
tensor([ 918878, 1104374,  918928,  918973, 1104400,  919010, 1104424,  919045,
        1104450,  919083]) tensor([ 4146815, 52531786, 25233469,  1452554, 71437313, 55426141, 63750874,
        39998289, 46939562, 14582079])
-------Step 5-------
tensor([ 918878, 1104374,  918928,  918973, 1104400,  919010, 1104424,  919045,
        1104450,  919083]) tensor([46711207, 56187340, 85374990, 12247051, 48500398,   583862, 32008853,
        78693965, 71023168,  1833759])
-------Step 6-------
tensor([59833723,  1019384,  1019423,  1019454,  8612060,  1019490,  1019539,
         1019574,  1019609,   230344]) tensor([39490366, 55542222, 23928750, 28360196, 80302473, 46920509, 53964331,
        16230255, 54693715, 13496061])
-------Step 7-------
tensor([59833723,  1019384,  1019423,  1019454,  8612060,  1019490,  1019539,
         1019574,  1019609,   230344]) tensor([33479625, 85553079, 43605053, 77504735, 76389404,  2499646, 25536176,
        60019272, 31120433, 23805162])
-------Step 8-------
tensor([ 1122120,  1125420,  1122172, 30379388,  1755503,  1122203,  1122234,
         1122261,   231968,  1755524]) tensor([31704266, 70672135, 61972073, 85907793, 64459604, 51208571, 72791196,
        84479996, 13076618,  7390715])
-------Step 9-------
tensor([ 1122120,  1125420,  1122172, 30379388,  1755503,  1122203,  1122234,
         1122261,   231968,  1755524]) tensor([78744969, 52647466, 37271986, 35050452, 18876320,  1715046, 20345853,
        15622384, 63880118, 37808011])
before start barrier
start train
[proc 0] 100 steps, total: 21.582, sample: 1.478, forward: 5.319, backward: 12.991, update: 1.661
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.907 ms                  | 109.574 ms                |
| bucket keys               | 2.781 ms                  | 6.301 ms                  |
| forward: a2a keys         | 1.842 ms                  | 41.721 ms                 |
| forward: search cache     | 225.234 us                | 303.675 us                |
| forward: a2a values       | 4.288 ms                  | 13.066 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 34.264 ms                 | 83.737 ms                 |
| back: aggr dram keys      | 39.975 ms                 | 66.690 ms                 |
| back: set dram grad       | 5.850 ms                  | 14.462 ms                 |
| back: a2a grad            | 11.216 ms                 | 22.035 ms                 |
| back: grad sum & grad cache  | 3.565 ms                  | 46.946 ms                 |
| Backward                  | 117.491 ms                | 180.082 ms                |
| Optimize                  | 15.965 ms                 | 29.395 ms                 |
| BarrierTimeBeforeRank0    | 45.539 us                 | 108.792 us                |
| BlockToStepN              | 17.642 us                 | 9.567 ms                  |
| OneStep                   | 180.189 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.017 ms                  | 111.942 ms                |
| bucket keys               | 2.781 ms                  | 4.799 ms                  |
| forward: a2a keys         | 2.009 ms                  | 33.374 ms                 |
| forward: search cache     | 225.538 us                | 299.710 us                |
| forward: a2a values       | 4.288 ms                  | 11.213 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 34.559 ms                 | 83.737 ms                 |
| back: aggr dram keys      | 39.975 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.836 ms                  | 8.182 ms                  |
| back: a2a grad            | 11.150 ms                 | 21.982 ms                 |
| back: grad sum & grad cache  | 3.565 ms                  | 45.326 ms                 |
| Backward                  | 116.389 ms                | 180.082 ms                |
| Optimize                  | 15.791 ms                 | 29.395 ms                 |
| BarrierTimeBeforeRank0    | 44.493 us                 | 108.792 us                |
| BlockToStepN              | 17.389 us                 | 9.567 ms                  |
| OneStep                   | 180.189 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.997 ms                  | 109.574 ms                |
| bucket keys               | 2.781 ms                  | 4.799 ms                  |
| forward: a2a keys         | 2.023 ms                  | 33.374 ms                 |
| forward: search cache     | 225.683 us                | 303.675 us                |
| forward: a2a values       | 4.288 ms                  | 11.213 ms                 |
| forward: join             | 1.403 ms                  | 2.461 ms                  |
| Forward                   | 34.651 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 38.000 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.833 ms                  | 8.182 ms                  |
| back: a2a grad            | 11.151 ms                 | 22.035 ms                 |
| back: grad sum & grad cache  | 3.565 ms                  | 47.091 ms                 |
| Backward                  | 116.194 ms                | 175.599 ms                |
| Optimize                  | 15.751 ms                 | 29.395 ms                 |
| BarrierTimeBeforeRank0    | 43.747 us                 | 99.861 us                 |
| BlockToStepN              | 17.312 us                 | 9.361 ms                  |
| OneStep                   | 179.783 ms                | 313.380 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.667 ms                  | 109.574 ms                |
| bucket keys               | 2.785 ms                  | 4.799 ms                  |
| forward: a2a keys         | 2.018 ms                  | 33.267 ms                 |
| forward: search cache     | 226.103 us                | 308.944 us                |
| forward: a2a values       | 4.288 ms                  | 11.051 ms                 |
| forward: join             | 2.176 ms                  | 2.501 ms                  |
| Forward                   | 34.685 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 38.000 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.829 ms                  | 7.163 ms                  |
| back: a2a grad            | 11.150 ms                 | 26.456 ms                 |
| back: grad sum & grad cache  | 3.582 ms                  | 46.946 ms                 |
| Backward                  | 116.064 ms                | 175.599 ms                |
| Optimize                  | 15.764 ms                 | 32.477 ms                 |
| BarrierTimeBeforeRank0    | 43.647 us                 | 99.861 us                 |
| BlockToStepN              | 17.363 us                 | 9.567 ms                  |
| OneStep                   | 179.783 ms                | 313.380 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 19.291, sample: 1.784, forward: 4.158, backward: 8.793, update: 0.349
[proc 1] 200 steps, total: 19.291, sample: 1.560, forward: 4.377, backward: 9.124, update: 0.307
[proc 2] 200 steps, total: 19.291, sample: 1.547, forward: 4.380, backward: 8.759, update: 0.427
[proc 0] 200 steps, total: 19.291, sample: 1.745, forward: 3.778, backward: 11.986, update: 1.659
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.976 ms                  | 111.942 ms                |
| bucket keys               | 2.781 ms                  | 4.799 ms                  |
| forward: a2a keys         | 1.994 ms                  | 34.221 ms                 |
| forward: search cache     | 225.715 us                | 308.944 us                |
| forward: a2a values       | 9.108 ms                  | 11.213 ms                 |
| forward: join             | 2.176 ms                  | 2.501 ms                  |
| Forward                   | 34.636 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 37.809 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.833 ms                  | 8.327 ms                  |
| back: a2a grad            | 11.151 ms                 | 26.456 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 46.946 ms                 |
| Backward                  | 116.194 ms                | 175.599 ms                |
| Optimize                  | 15.795 ms                 | 32.477 ms                 |
| BarrierTimeBeforeRank0    | 44.060 us                 | 106.467 us                |
| BlockToStepN              | 17.405 us                 | 12.016 ms                 |
| OneStep                   | 180.189 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.997 ms                  | 112.081 ms                |
| bucket keys               | 2.779 ms                  | 4.754 ms                  |
| forward: a2a keys         | 2.018 ms                  | 34.932 ms                 |
| forward: search cache     | 226.035 us                | 307.040 us                |
| forward: a2a values       | 8.837 ms                  | 11.051 ms                 |
| forward: join             | 2.176 ms                  | 2.492 ms                  |
| Forward                   | 34.646 ms                 | 81.914 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 64.135 ms                 |
| back: set dram grad       | 5.829 ms                  | 8.182 ms                  |
| back: a2a grad            | 11.150 ms                 | 26.456 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 45.326 ms                 |
| Backward                  | 116.026 ms                | 175.599 ms                |
| Optimize                  | 15.965 ms                 | 32.477 ms                 |
| BarrierTimeBeforeRank0    | 44.219 us                 | 106.467 us                |
| BlockToStepN              | 17.559 us                 | 12.016 ms                 |
| OneStep                   | 181.315 ms                | 327.055 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.997 ms                  | 111.942 ms                |
| bucket keys               | 2.640 ms                  | 4.990 ms                  |
| forward: a2a keys         | 2.016 ms                  | 34.932 ms                 |
| forward: search cache     | 226.637 us                | 308.944 us                |
| forward: a2a values       | 7.514 ms                  | 11.213 ms                 |
| forward: join             | 2.176 ms                  | 2.607 ms                  |
| Forward                   | 34.578 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.836 ms                  | 8.182 ms                  |
| back: a2a grad            | 10.444 ms                 | 28.113 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 46.946 ms                 |
| Backward                  | 115.844 ms                | 162.531 ms                |
| Optimize                  | 16.327 ms                 | 32.763 ms                 |
| BarrierTimeBeforeRank0    | 44.219 us                 | 99.861 us                 |
| BlockToStepN              | 17.519 us                 | 9.567 ms                  |
| OneStep                   | 180.154 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.859 ms                  | 111.942 ms                |
| bucket keys               | 2.676 ms                  | 4.990 ms                  |
| forward: a2a keys         | 1.952 ms                  | 34.221 ms                 |
| forward: search cache     | 227.280 us                | 308.944 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.942 ms                  |
| Forward                   | 34.386 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 64.135 ms                 |
| back: set dram grad       | 5.833 ms                  | 8.182 ms                  |
| back: a2a grad            | 10.348 ms                 | 26.456 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 46.946 ms                 |
| Backward                  | 115.662 ms                | 162.531 ms                |
| Optimize                  | 16.327 ms                 | 35.623 ms                 |
| BarrierTimeBeforeRank0    | 44.060 us                 | 99.861 us                 |
| BlockToStepN              | 17.391 us                 | 9.567 ms                  |
| OneStep                   | 179.721 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 18.733, sample: 1.440, forward: 3.618, backward: 11.859, update: 1.731
[proc 1] 300 steps, total: 18.733, sample: 1.156, forward: 4.174, backward: 9.273, update: 0.250
[proc 2] 300 steps, total: 18.733, sample: 1.290, forward: 4.148, backward: 8.821, update: 0.380
[proc 3] 300 steps, total: 18.733, sample: 1.400, forward: 4.021, backward: 8.851, update: 0.348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.900 ms                  | 111.942 ms                |
| bucket keys               | 2.773 ms                  | 5.013 ms                  |
| forward: a2a keys         | 1.914 ms                  | 34.221 ms                 |
| forward: search cache     | 227.256 us                | 317.605 us                |
| forward: a2a values       | 7.514 ms                  | 13.066 ms                 |
| forward: join             | 2.176 ms                  | 2.984 ms                  |
| Forward                   | 34.223 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 64.135 ms                 |
| back: set dram grad       | 5.840 ms                  | 8.182 ms                  |
| back: a2a grad            | 10.366 ms                 | 28.113 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 47.091 ms                 |
| Backward                  | 115.585 ms                | 162.895 ms                |
| Optimize                  | 16.350 ms                 | 35.623 ms                 |
| BarrierTimeBeforeRank0    | 43.747 us                 | 99.861 us                 |
| BlockToStepN              | 17.420 us                 | 12.016 ms                 |
| OneStep                   | 179.721 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.961 ms                  | 111.942 ms                |
| bucket keys               | 2.773 ms                  | 4.990 ms                  |
| forward: a2a keys         | 1.900 ms                  | 33.374 ms                 |
| forward: search cache     | 227.730 us                | 316.507 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.942 ms                  |
| Forward                   | 34.119 ms                 | 73.615 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 66.690 ms                 |
| back: set dram grad       | 5.840 ms                  | 7.865 ms                  |
| back: a2a grad            | 10.335 ms                 | 28.113 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 46.977 ms                 |
| Backward                  | 115.437 ms                | 175.599 ms                |
| Optimize                  | 16.088 ms                 | 35.623 ms                 |
| BarrierTimeBeforeRank0    | 43.677 us                 | 99.861 us                 |
| BlockToStepN              | 17.642 us                 | 12.016 ms                 |
| OneStep                   | 178.988 ms                | 327.055 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.859 ms                  | 110.372 ms                |
| bucket keys               | 2.773 ms                  | 4.990 ms                  |
| forward: a2a keys         | 1.887 ms                  | 33.374 ms                 |
| forward: search cache     | 227.659 us                | 317.605 us                |
| forward: a2a values       | 7.514 ms                  | 13.066 ms                 |
| forward: join             | 2.176 ms                  | 2.984 ms                  |
| Forward                   | 34.113 ms                 | 73.336 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 66.690 ms                 |
| back: set dram grad       | 5.843 ms                  | 8.787 ms                  |
| back: a2a grad            | 10.336 ms                 | 30.229 ms                 |
| back: grad sum & grad cache  | 3.610 ms                  | 46.977 ms                 |
| Backward                  | 115.479 ms                | 171.555 ms                |
| Optimize                  | 16.144 ms                 | 32.763 ms                 |
| BarrierTimeBeforeRank0    | 43.747 us                 | 92.705 us                 |
| BlockToStepN              | 17.842 us                 | 9.567 ms                  |
| OneStep                   | 179.236 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.787 ms                  | 110.372 ms                |
| bucket keys               | 2.771 ms                  | 5.027 ms                  |
| forward: a2a keys         | 1.803 ms                  | 33.267 ms                 |
| forward: search cache     | 227.443 us                | 317.045 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.984 ms                  |
| Forward                   | 34.034 ms                 | 73.336 ms                 |
| back: aggr dram keys      | 36.325 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.836 ms                  | 8.327 ms                  |
| back: a2a grad            | 10.347 ms                 | 28.113 ms                 |
| back: grad sum & grad cache  | 3.993 ms                  | 46.946 ms                 |
| Backward                  | 115.212 ms                | 171.555 ms                |
| Optimize                  | 16.001 ms                 | 32.763 ms                 |
| BarrierTimeBeforeRank0    | 43.663 us                 | 92.705 us                 |
| BlockToStepN              | 18.575 us                 | 9.567 ms                  |
| OneStep                   | 177.860 ms                | 313.425 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 18.851, sample: 1.301, forward: 3.439, backward: 12.371, update: 1.628
[proc 3] 400 steps, total: 18.851, sample: 1.203, forward: 3.830, backward: 9.268, update: 0.288
[proc 2] 400 steps, total: 18.851, sample: 1.128, forward: 3.987, backward: 9.140, update: 0.293
[proc 1] 400 steps, total: 18.851, sample: 1.060, forward: 3.980, backward: 9.596, update: 0.300
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.787 ms                  | 111.942 ms                |
| bucket keys               | 2.769 ms                  | 5.027 ms                  |
| forward: a2a keys         | 1.731 ms                  | 33.267 ms                 |
| forward: search cache     | 227.136 us                | 317.605 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.984 ms                  |
| Forward                   | 33.825 ms                 | 73.336 ms                 |
| back: aggr dram keys      | 36.325 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.829 ms                  | 8.787 ms                  |
| back: a2a grad            | 10.348 ms                 | 30.346 ms                 |
| back: grad sum & grad cache  | 3.993 ms                  | 46.946 ms                 |
| Backward                  | 115.191 ms                | 175.599 ms                |
| Optimize                  | 16.001 ms                 | 32.763 ms                 |
| BarrierTimeBeforeRank0    | 43.646 us                 | 92.705 us                 |
| BlockToStepN              | 19.111 us                 | 12.016 ms                 |
| OneStep                   | 177.193 ms                | 327.055 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.801 ms                  | 112.081 ms                |
| bucket keys               | 2.765 ms                  | 5.013 ms                  |
| forward: a2a keys         | 1.636 ms                  | 31.161 ms                 |
| forward: search cache     | 226.961 us                | 317.045 us                |
| forward: a2a values       | 7.514 ms                  | 11.213 ms                 |
| forward: join             | 2.176 ms                  | 2.963 ms                  |
| Forward                   | 33.674 ms                 | 73.336 ms                 |
| back: aggr dram keys      | 36.447 ms                 | 66.180 ms                 |
| back: set dram grad       | 5.818 ms                  | 8.327 ms                  |
| back: a2a grad            | 10.348 ms                 | 30.229 ms                 |
| back: grad sum & grad cache  | 3.993 ms                  | 46.831 ms                 |
| Backward                  | 115.200 ms                | 175.599 ms                |
| Optimize                  | 15.976 ms                 | 32.763 ms                 |
| BarrierTimeBeforeRank0    | 43.647 us                 | 92.705 us                 |
| BlockToStepN              | 20.559 us                 | 12.016 ms                 |
| OneStep                   | 177.079 ms                | 327.055 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.812 ms                  | 112.081 ms                |
| bucket keys               | 2.768 ms                  | 5.013 ms                  |
| forward: a2a keys         | 1.589 ms                  | 31.161 ms                 |
| forward: search cache     | 226.712 us                | 317.605 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.963 ms                  |
| Forward                   | 33.674 ms                 | 72.504 ms                 |
| back: aggr dram keys      | 36.447 ms                 | 66.690 ms                 |
| back: set dram grad       | 5.829 ms                  | 8.787 ms                  |
| back: a2a grad            | 10.358 ms                 | 30.346 ms                 |
| back: grad sum & grad cache  | 22.232 ms                 | 46.977 ms                 |
| Backward                  | 115.171 ms                | 175.599 ms                |
| Optimize                  | 15.936 ms                 | 32.477 ms                 |
| BarrierTimeBeforeRank0    | 43.676 us                 | 92.705 us                 |
| BlockToStepN              | 22.792 us                 | 11.618 ms                 |
| OneStep                   | 176.656 ms                | 326.010 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.802 ms                  | 112.081 ms                |
| bucket keys               | 2.768 ms                  | 4.990 ms                  |
| forward: a2a keys         | 1.564 ms                  | 30.979 ms                 |
| forward: search cache     | 226.712 us                | 317.605 us                |
| forward: a2a values       | 7.514 ms                  | 11.214 ms                 |
| forward: join             | 2.176 ms                  | 2.963 ms                  |
| Forward                   | 33.660 ms                 | 72.504 ms                 |
| back: aggr dram keys      | 36.449 ms                 | 66.196 ms                 |
| back: set dram grad       | 5.840 ms                  | 8.327 ms                  |
| back: a2a grad            | 10.364 ms                 | 30.229 ms                 |
| back: grad sum & grad cache  | 22.232 ms                 | 46.977 ms                 |
| Backward                  | 115.159 ms                | 175.599 ms                |
| Optimize                  | 15.933 ms                 | 32.477 ms                 |
| BarrierTimeBeforeRank0    | 43.676 us                 | 92.705 us                 |
| BlockToStepN              | 25.790 us                 | 11.618 ms                 |
| OneStep                   | 176.567 ms                | 326.010 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 18.684, sample: 0.969, forward: 4.064, backward: 8.933, update: 0.267
[proc 0] 500 steps, total: 18.684, sample: 1.385, forward: 3.380, backward: 12.151, update: 1.644
[proc 2] 500 steps, total: 18.684, sample: 1.053, forward: 4.040, backward: 8.803, update: 0.359
[proc 1] 500 steps, total: 18.684, sample: 1.066, forward: 3.997, backward: 9.238, update: 0.337
Successfully xmh. training takes 97.14196372032166 seconds
before call kg_cache_controller.StopThreads()
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
INFO [47436 controller_process.py:421] call rank0 to StopThreads
