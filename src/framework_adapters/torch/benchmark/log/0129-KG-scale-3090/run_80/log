WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 10:10:17.819941 37449 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_34', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [37449 sampler.py:454] Start PreSampling
WARNING [37449 sampler.py:532] Before construct renumbering_dict
WARNING [37449 sampler.py:555] PreSampling done
W20240130 10:28:47.659198 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 10:28:47.659379 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 10:28:47.659415 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 10:28:47.659444 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 10:28:47.659472 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 10:28:47.659500 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 10:28:47.659533 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 10:28:47.659570 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 10:28:47.659606 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 10:28:47.659647 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 10:28:47.659685 37449 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 10:28:47.659710 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 10:28:47.659742 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 10:28:47.659917 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 10:28:47.659960 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 10:28:47.659987 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 10:28:47.660025 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 10:28:47.660065 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 10:28:47.660099 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 10:28:47.660131 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 10:28:47.660169 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 10:28:47.660207 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 10:28:47.660233 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 10:28:47.660261 37449 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 10:28:47.660284 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 10:28:47.660308 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 10:28:47.660365 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 10:28:47.660401 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 10:28:47.660427 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 10:28:47.660455 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 10:28:47.660480 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 10:28:47.660518 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 10:28:47.660557 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 10:28:47.660585 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 10:28:47.660619 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 10:28:47.660647 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 10:28:47.660672 37449 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 10:28:47.660694 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 10:28:47.660720 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 10:28:47.660782 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 10:28:47.660810 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 10:28:47.660840 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 10:28:47.660866 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 10:28:47.660897 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 10:28:47.660924 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 10:28:47.660952 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 10:28:47.660981 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 10:28:47.661011 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 10:28:47.661044 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 10:28:47.661077 37449 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 10:28:47.661101 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 10:28:47.661123 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 10:28:47.661181 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 10:28:47.661221 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 10:28:47.661250 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 10:28:47.661283 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 10:28:47.661319 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 10:28:47.661348 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 10:28:47.661382 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 10:28:47.661410 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 10:28:47.661445 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 10:28:47.661480 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 10:28:47.661513 37449 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 10:28:47.661537 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 10:28:47.661561 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 10:28:47.661609 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 10:28:47.661648 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 10:28:47.661685 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 10:28:47.661717 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 10:28:47.661744 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 10:28:47.661779 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 10:28:47.661815 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 10:28:47.661850 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 10:28:47.661877 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 10:28:47.661908 37449 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 10:28:47.661938 37449 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 10:28:47.661960 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 10:28:47.661984 37449 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 10:28:48.049726 37449 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10001ca5a000 128.2 GB
W20240130 10:28:48.049880 37449 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10202b692000 328.3 MB
{0: Graph(num_nodes=16391033, num_edges=60554486,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22850318, num_edges=74912573,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16459669, num_edges=67428404,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17554345, num_edges=53272616,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=17824082, num_edges=71836124,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=18730250, num_edges=46391216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16391033 N 60554486 E
MertisPartition: part 1 has 22850318 N 74912573 E
MertisPartition: part 2 has 16459669 N 67428404 E
MertisPartition: part 3 has 17554345 N 53272616 E
MertisPartition: part 4 has 17824082 N 71836124 E
MertisPartition: part 5 has 18730250 N 46391216 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,       14,  ..., 12367661, 70093925, 61280605]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4302828,  4302849,   613797,  ..., 47167865,  8967156, 78082514]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1616.969 seconds
[Rank1] pid = 38300
[Rank2] pid = 38395
[Rank3] pid = 38462
[Rank4] pid = 38529
INFO [37449 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [38300 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38462 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [38395 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38596 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [38529 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [38529 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38596 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38462 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38395 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [37449 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38300 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240130 10:37:21.541250 38530 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240130 10:37:21.543586 38597 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240130 10:37:21.544003 38301 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240130 10:37:21.544351 38463 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240130 10:37:21.544361 38396 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240130 10:37:21.544636 38662 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240130 10:37:21.615661 38530 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10203fee5000 7.629 MB
W20240130 10:37:21.615900 38530 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102040e2b000 7.629 MB
W20240130 10:37:21.615898 38463 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102040688000 7.629 MB
W20240130 10:37:21.615911 38662 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020415ce000 7.629 MB
W20240130 10:37:21.615984 38597 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102041d71000 7.629 MB
W20240130 10:37:21.616007 38530 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102042cb7000 1.49 GB
W20240130 10:37:21.616005 38301 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102042514000 7.629 MB
W20240130 10:37:21.616046 38396 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020a229a000 7.629 MB
W20240130 10:37:21.616070 38530 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020a2a3d000 1.49 GB
W20240130 10:37:21.616127 38530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 10:37:21.617888 38530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 10:37:21.617899 38597 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102102022000 7.629 MB
W20240130 10:37:21.617916 38301 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021027c5000 7.629 MB
W20240130 10:37:21.617952 38396 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102102f68000 7.629 MB
W20240130 10:37:21.617957 38463 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210370b000 7.629 MB
W20240130 10:37:21.617978 38662 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102103eae000 7.629 MB
W20240130 10:37:21.617995 38597 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102104651000 1.49 GB
W20240130 10:37:21.618023 38301 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102163c34000 1.49 GB
W20240130 10:37:21.618057 38597 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021c3217000 1.49 GB
W20240130 10:37:21.618075 38301 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022227fa000 1.49 GB
W20240130 10:37:21.619448 38662 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x102281ddd000 1.49 GB
W20240130 10:37:21.619558 38463 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1022e13c0000 1.49 GB
W20240130 10:37:21.619575 38662 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1023409a3000 1.49 GB
W20240130 10:37:21.619606 38396 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10239ff88000 1.49 GB
W20240130 10:37:21.619618 38597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 10:37:21.619623 38463 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1023ff56b000 1.49 GB
W20240130 10:37:21.619648 38662 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 10:37:21.619652 38301 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 10:37:21.619658 38463 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 10:37:21.619670 38396 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10245eb4e000 1.49 GB
W20240130 10:37:21.619717 38396 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 10:37:21.628495 38597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 10:37:21.628537 38463 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 10:37:21.628542 38301 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 10:37:21.628558 38396 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 10:37:21.628558 38662 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [38529 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [38596 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [38300 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 38596
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [37449 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [38462 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [38395 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 10:38:02.142000 38396 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240130 10:38:02.142405 38530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 10:38:02.142495 38662 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 10:38:02.142627 38597 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 10:38:02.142699 38463 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 10:38:02.142746 38301 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240130 10:38:02.145326 38597 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240130 10:38:02.145612 38597 grad_base.h:184] Init GradProcessingBase done
I20240130 10:38:15.105508 38597 grad_async_v1.h:199] Use main thread to update emb.
W20240130 10:38:15.105646 38597 kg_controller.h:75] after init GradAsyncProcessing
I20240130 10:38:15.105655 38597 kg_controller.h:84] Construct KGCacheController done
E20240130 10:38:16.694046 38396 recstore.cc:66] init folly done
E20240130 10:38:16.694126 38530 recstore.cc:66] init folly done
E20240130 10:38:16.694144 38597 recstore.cc:66] init folly done
E20240130 10:38:16.694218 38463 recstore.cc:66] init folly done
E20240130 10:38:16.694331 38662 recstore.cc:66] init folly done
E20240130 10:38:16.695042 38301 recstore.cc:66] init folly done
I20240130 10:38:16.696043 38597 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 10:38:30.899927 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:38:32.426947 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:38:34.283793 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 10:38:34.428171 38662 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
W20240130 10:38:35.367704 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 10:38:35.410423 38463 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240130 10:38:36.565714 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 10:38:36.613242 38597 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240130 10:38:37.280155 38396 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240130 10:38:38.084879 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 10:38:38.204245 38530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240130 10:38:38.380697 38301 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240130 10:38:40.327772 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240130 10:38:41.023375 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:38:41.327006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.907 ms                  | 258.217 ms                |
| ProcessBack:UpdateCache   | 5.523 ms                  | 500.636 ms                |
| ProcessBack:UpsertPq      | 25.560 ms                 | 32.365 ms                 |
| ProcessOneStep            | 39.324 ms                 | 970.247 ms                |
| BlockToStepN              | 6.806 ms                  | 690.606 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:42.040899 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.058 ms                  | 6.915 ms                  |
| Forward                   | 5.875 ms                  | 656.069 ms                |
| Backward                  | 9.773 ms                  | 273.905 ms                |
| Optimize                  | 2.488 ms                  | 5.078 ms                  |
| BarrierTimeBeforeRank0    | 8.190 ms                  | 33.733 ms                 |
| AfterBackward             | 39.358 ms                 | 970.507 ms                |
| BlockToStepN              | 6.848 ms                  | 691.952 ms                |
| OneStep                   | 72.919 ms                 | 2.640 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:42.327004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240130 10:38:43.327008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240130 10:38:43.410120 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:38:44.327008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240130 10:38:44.451169 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:38:45.327020 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240130 10:38:45.497387 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:38:46.327006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240130 10:38:46.499348 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.719 ms                  | 258.217 ms                |
| ProcessBack:UpdateCache   | 5.626 ms                  | 500.636 ms                |
| ProcessBack:UpsertPq      | 25.712 ms                 | 35.796 ms                 |
| ProcessOneStep            | 40.853 ms                 | 970.247 ms                |
| BlockToStepN              | 6.806 ms                  | 690.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 83.338 ms                 |
| Forward                   | 5.052 ms                  | 656.069 ms                |
| Backward                  | 9.666 ms                  | 273.905 ms                |
| Optimize                  | 2.488 ms                  | 5.078 ms                  |
| BarrierTimeBeforeRank0    | 5.441 ms                  | 33.733 ms                 |
| AfterBackward             | 40.883 ms                 | 970.507 ms                |
| BlockToStepN              | 6.848 ms                  | 691.952 ms                |
| OneStep                   | 132.245 ms                | 2.640 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:47.327004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240130 10:38:47.530432 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:38:48.472883 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240130 10:38:48.558229 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:38:49.472005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240130 10:38:49.569694 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:38:50.472543 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240130 10:38:50.592898 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:38:51.533964 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240130 10:38:51.639923 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.734 ms                  | 217.610 ms                |
| ProcessBack:UpdateCache   | 5.857 ms                  | 499.999 ms                |
| ProcessBack:UpsertPq      | 28.989 ms                 | 62.148 ms                 |
| ProcessOneStep            | 44.157 ms                 | 970.247 ms                |
| BlockToStepN              | 6.806 ms                  | 690.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 83.338 ms                 |
| Forward                   | 4.991 ms                  | 656.069 ms                |
| Backward                  | 9.773 ms                  | 273.905 ms                |
| Optimize                  | 2.397 ms                  | 5.078 ms                  |
| BarrierTimeBeforeRank0    | 4.459 ms                  | 33.733 ms                 |
| AfterBackward             | 44.187 ms                 | 970.507 ms                |
| BlockToStepN              | 502.106 ms                | 691.952 ms                |
| OneStep                   | 595.557 ms                | 2.640 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:52.533006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240130 10:38:52.826426 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:38:53.533028 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240130 10:38:53.829027 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 10:38:54.621448 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240130 10:38:55.184500 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:38:55.621006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240130 10:38:56.209290 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.976 ms                  | 217.610 ms                |
| ProcessBack:UpdateCache   | 6.086 ms                  | 499.999 ms                |
| ProcessBack:UpsertPq      | 31.408 ms                 | 66.348 ms                 |
| ProcessOneStep            | 47.961 ms                 | 970.247 ms                |
| BlockToStepN              | 6.806 ms                  | 690.606 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:56.721225 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.743 ms                  | 117.105 ms                |
| Forward                   | 5.069 ms                  | 656.069 ms                |
| Backward                  | 9.869 ms                  | 273.905 ms                |
| Optimize                  | 2.514 ms                  | 13.167 ms                 |
| BarrierTimeBeforeRank0    | 1.035 ms                  | 33.733 ms                 |
| AfterBackward             | 48.664 ms                 | 970.507 ms                |
| BlockToStepN              | 6.848 ms                  | 691.952 ms                |
| OneStep                   | 152.099 ms                | 2.640 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 10:38:57.260478 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:38:57.721007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240130 10:38:58.277349 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:38:58.740077 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240130 10:38:59.306766 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:38:59.740006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240130 10:39:00.326189 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:39:00.740006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240130 10:39:01.476263 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.132 ms                  | 217.610 ms                |
| ProcessBack:UpdateCache   | 6.115 ms                  | 499.999 ms                |
| ProcessBack:UpsertPq      | 28.868 ms                 | 66.348 ms                 |
| ProcessOneStep            | 43.717 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:01.740003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.332 ms                  | 93.434 ms                 |
| Forward                   | 5.085 ms                  | 11.808 ms                 |
| Backward                  | 9.773 ms                  | 11.536 ms                 |
| Optimize                  | 2.520 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 134.823 us                | 29.971 ms                 |
| AfterBackward             | 43.755 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 152.099 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:02.504829 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:39:02.740003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240130 10:39:03.557066 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:03.740005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240130 10:39:04.559423 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 10:39:04.740006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240130 10:39:05.688967 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:39:05.759585 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.129 ms                  | 217.610 ms                |
| ProcessBack:UpdateCache   | 6.086 ms                  | 499.999 ms                |
| ProcessBack:UpsertPq      | 28.104 ms                 | 66.348 ms                 |
| ProcessOneStep            | 42.755 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:06.703403 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 10:39:06.759006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.358 ms                  | 93.434 ms                 |
| Forward                   | 5.088 ms                  | 11.808 ms                 |
| Backward                  | 9.745 ms                  | 11.536 ms                 |
| Optimize                  | 2.520 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 54.464 us                 | 33.733 ms                 |
| AfterBackward             | 42.778 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 152.099 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:07.759007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240130 10:39:07.891455 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:39:08.759006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240130 10:39:08.896275 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:39:09.759006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240130 10:39:09.931917 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:39:10.842159 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240130 10:39:10.931084 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.161 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.116 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 28.868 ms                 | 66.348 ms                 |
| ProcessOneStep            | 44.157 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:11.842003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240130 10:39:12.097389 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.456 ms                  | 95.206 ms                 |
| Forward                   | 5.037 ms                  | 11.808 ms                 |
| Backward                  | 9.708 ms                  | 11.536 ms                 |
| Optimize                  | 2.490 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 340.594 us                | 33.733 ms                 |
| AfterBackward             | 44.187 ms                 | 89.214 ms                 |
| BlockToStepN              | 471.745 ms                | 628.684 ms                |
| OneStep                   | 582.691 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:12.972548 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240130 10:39:13.112612 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:39:13.972005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240130 10:39:14.118839 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:14.972015 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240130 10:39:15.129460 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:15.972008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=99, pq.top=99
W20240130 10:39:16.154605 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 37.983, sample: 1.258, forward: 1.096, backward: 1.277, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 37.807, sample: 1.318, forward: 1.080, backward: 1.241, update: 0.267
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 38.908, sample: 1.300, forward: 1.084, backward: 1.244, update: 0.249
train_sampler.Prefill()
-------Step 0-------
tensor([25038938,   685950,   429847,   685963,   685968,   685980,  4990622,
          685986,   685991,   304388]) tensor([  163041, 37896231, 49061377,  5255096, 72894925, 29042128, 50064746,
        17604904, 68518196,  3794536])
-------Step 1-------
tensor([25038938,   685950,   429847,   685963,   685968,   685980,  4990622,
          685986,   685991,   304388]) tensor([81516050, 76226451,  4662281,  1251423, 52980698, 58897217, 29279302,
        52686347, 51655145, 36127052])
-------Step 2-------
tensor([   20754,    20783,    20822,    24656, 35726707,    20854, 27182288,
           20885, 25038938, 85142252]) tensor([ 8418077, 40940928, 25884354, 72821140, 53014318, 49692095, 45183798,
        34240741,  7310082, 18928365])
-------Step 3-------
tensor([   20754,    20783,    20822,    24656, 35726707,    20854, 27182288,
           20885, 25038938, 85142252]) tensor([27845372, 20918476,  9279677, 81073923, 10999873, 13999823, 11038202,
        75670617, 81739707, 68431521])
-------Step 4-------
tensor([ 599201,   35200,  110616, 9867075,  110657,  308009,  110711, 4428570,
         110735,  599221]) tensor([58274526, 80461614, 15741973, 32699521, 45912556, 69801385, 82271986,
        24027292, 30786258, 82967716])
-------Step 5-------
tensor([ 599201,   35200,  110616, 9867075,  110657,  308009,  110711, 4428570,
         110735,  599221]) tensor([ 4215241,   140735,  8106845, 77125524, 84438403, 36765879, 56802856,
        54310853, 53465085, 24578093])
-------Step 6-------
tensor([  199928,   199972, 25038938,   200007,    29885,   200064,   438395,
          438431, 35088118,  4421770]) tensor([40257662, 34286676, 38977311, 73590977, 52018556,  1031899, 10994232,
         4907889, 53945246, 18499432])
-------Step 7-------
tensor([  199928,   199972, 25038938,   200007,    29885,   200064,   438395,
          438431, 35088118,  4421770]) tensor([26070493, 25836788, 41407991, 64874866, 82916221, 14335214,  2029984,
        45162191, 50708682, 20347602])
-------Step 8-------
tensor([  354402,   288011,   288053,  5255401,  4308210,    70003,    64662,
           64698,   288095, 39592400]) tensor([71179166, 23246899, 63309272, 60555001,  6888504, 16792186, 29522448,
        31840943, 75419536, 27558598])
-------Step 9-------
tensor([  354402,   288011,   288053,  5255401,  4308210,    70003,    64662,
           64698,   288095, 39592400]) tensor([  620562, 44425052, 78765176, 41454670, 72880906, 58760845, 46264074,
        32968812, 70787165, 12505468])
before start barrier
start train
[proc 0] 100 steps, total: 39.574, sample: 1.588, forward: 1.174, backward: 1.238, update: 0.318
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 40.777, sample: 1.386, forward: 1.114, backward: 1.261, update: 0.236
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 41.759, sample: 1.525, forward: 1.070, backward: 1.074, update: 0.227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.172 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.116 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 28.989 ms                 | 66.348 ms                 |
| ProcessOneStep            | 44.157 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:17.054824 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.175 ms                  | 117.105 ms                |
| Forward                   | 5.030 ms                  | 11.808 ms                 |
| Backward                  | 9.699 ms                  | 11.536 ms                 |
| Optimize                  | 2.507 ms                  | 12.905 ms                 |
| BarrierTimeBeforeRank0    | 50.071 us                 | 33.733 ms                 |
| AfterBackward             | 44.098 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 161.633 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:17.619976 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:18.054006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240130 10:39:18.642865 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:19.093986 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240130 10:39:19.644150 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:39:20.093006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240130 10:39:20.947944 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:21.093006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.185 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.114 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 28.381 ms                 | 66.348 ms                 |
| ProcessOneStep            | 42.698 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:22.093008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.436 ms                  | 117.105 ms                |
| Forward                   | 4.978 ms                  | 11.808 ms                 |
| Backward                  | 9.704 ms                  | 11.536 ms                 |
| Optimize                  | 2.507 ms                  | 12.905 ms                 |
| BarrierTimeBeforeRank0    | 49.497 us                 | 33.733 ms                 |
| AfterBackward             | 42.724 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 161.633 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:22.246737 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:39:23.143272 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240130 10:39:23.288009 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 10:39:24.143007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240130 10:39:24.356967 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:25.143007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240130 10:39:25.366071 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:26.143007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240130 10:39:26.384792 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.193 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.114 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 27.941 ms                 | 62.952 ms                 |
| ProcessOneStep            | 41.393 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:27.143005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.858 ms                  | 138.069 ms                |
| Forward                   | 4.947 ms                  | 23.846 ms                 |
| Backward                  | 9.682 ms                  | 11.536 ms                 |
| Optimize                  | 2.514 ms                  | 12.905 ms                 |
| BarrierTimeBeforeRank0    | 47.773 us                 | 33.733 ms                 |
| AfterBackward             | 41.412 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 161.633 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:27.641237 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:28.143005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240130 10:39:28.686213 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:29.171619 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240130 10:39:29.789194 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:39:30.171007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240130 10:39:30.802309 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:39:31.311383 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.198 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.108 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 27.598 ms                 | 62.952 ms                 |
| ProcessOneStep            | 41.159 ms                 | 89.160 ms                 |
| BlockToStepN              | 6.806 ms                  | 628.603 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:31.883229 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.803 ms                  | 138.069 ms                |
| Forward                   | 4.947 ms                  | 23.846 ms                 |
| Backward                  | 9.682 ms                  | 11.536 ms                 |
| Optimize                  | 2.518 ms                  | 12.905 ms                 |
| BarrierTimeBeforeRank0    | 49.681 us                 | 33.733 ms                 |
| AfterBackward             | 41.396 ms                 | 89.214 ms                 |
| BlockToStepN              | 6.848 ms                  | 628.684 ms                |
| OneStep                   | 161.633 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:32.311005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240130 10:39:32.896418 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:39:33.657425 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240130 10:39:34.188162 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:39:34.657006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240130 10:39:35.223840 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end5
W20240130 10:39:35.657080 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240130 10:39:36.470885 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:39:36.657006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.205 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.111 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 27.952 ms                 | 62.952 ms                 |
| ProcessOneStep            | 41.791 ms                 | 83.293 ms                 |
| BlockToStepN              | 6.806 ms                  | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.058 ms                  | 148.724 ms                |
| Forward                   | 4.947 ms                  | 11.808 ms                 |
| Backward                  | 9.702 ms                  | 11.276 ms                 |
| Optimize                  | 2.518 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 46.275 us                 | 31.295 ms                 |
| AfterBackward             | 41.822 ms                 | 83.328 ms                 |
| BlockToStepN              | 6.848 ms                  | 600.072 ms                |
| OneStep                   | 282.039 ms                | 752.882 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:37.507344 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:39:37.657004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240130 10:39:38.536728 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:38.686559 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240130 10:39:39.551230 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:39.686003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240130 10:39:40.686007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240130 10:39:40.817850 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:39:41.686007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.240 ms                  | 12.899 ms                 |
| ProcessBack:UpdateCache   | 6.114 ms                  | 9.706 ms                  |
| ProcessBack:UpsertPq      | 27.941 ms                 | 62.952 ms                 |
| ProcessOneStep            | 41.530 ms                 | 83.293 ms                 |
| BlockToStepN              | 6.806 ms                  | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:42.103921 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.536 ms                  | 206.674 ms                |
| Forward                   | 4.928 ms                  | 11.808 ms                 |
| Backward                  | 9.717 ms                  | 11.276 ms                 |
| Optimize                  | 2.515 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 42.026 us                 | 31.295 ms                 |
| AfterBackward             | 41.558 ms                 | 83.328 ms                 |
| BlockToStepN              | 471.745 ms                | 600.072 ms                |
| OneStep                   | 565.540 ms                | 772.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:42.686007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240130 10:39:43.108382 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:43.686007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240130 10:39:44.137857 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 10:39:44.747042 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240130 10:39:45.557346 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:45.747006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.224 ms                  | 11.790 ms                 |
| ProcessBack:UpdateCache   | 6.086 ms                  | 9.658 ms                  |
| ProcessBack:UpsertPq      | 27.567 ms                 | 62.148 ms                 |
| ProcessOneStep            | 41.066 ms                 | 83.293 ms                 |
| BlockToStepN              | 6.806 ms                  | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:46.747004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240130 10:39:46.866912 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.730 ms                  | 206.674 ms                |
| Forward                   | 4.905 ms                  | 11.808 ms                 |
| Backward                  | 9.718 ms                  | 11.276 ms                 |
| Optimize                  | 2.515 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 42.256 us                 | 31.295 ms                 |
| AfterBackward             | 40.925 ms                 | 83.328 ms                 |
| BlockToStepN              | 6.848 ms                  | 600.072 ms                |
| OneStep                   | 282.039 ms                | 772.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:47.747005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240130 10:39:47.884919 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:39:48.747007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240130 10:39:48.913837 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:49.747006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240130 10:39:50.161686 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:39:50.747007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 4] 200 steps, total: 34.934, sample: 1.242, forward: 0.452, backward: 1.057, update: 0.236
[proc 2] 200 steps, total: 34.934, sample: 1.273, forward: 0.499, backward: 1.011, update: 0.241
[proc 1] 200 steps, total: 34.934, sample: 1.238, forward: 0.499, backward: 0.988, update: 0.249
[proc 5] 200 steps, total: 34.934, sample: 1.356, forward: 0.435, backward: 0.987, update: 0.233
[proc 3] 200 steps, total: 34.934, sample: 1.223, forward: 0.493, backward: 0.977, update: 0.240
[proc 0] 200 steps, total: 34.934, sample: 2.590, forward: 0.505, backward: 0.960, update: 0.299
W20240130 10:39:51.209612 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.205 ms                  | 11.790 ms                 |
| ProcessBack:UpdateCache   | 6.080 ms                  | 9.658 ms                  |
| ProcessBack:UpsertPq      | 27.089 ms                 | 62.148 ms                 |
| ProcessOneStep            | 40.801 ms                 | 83.293 ms                 |
| BlockToStepN              | 6.806 ms                  | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:51.780418 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=202, pq.top=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.731 ms                  | 206.674 ms                |
| Forward                   | 4.877 ms                  | 11.808 ms                 |
| Backward                  | 9.746 ms                  | 11.276 ms                 |
| Optimize                  | 2.514 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 42.026 us                 | 31.295 ms                 |
| AfterBackward             | 40.823 ms                 | 83.328 ms                 |
| BlockToStepN              | 6.848 ms                  | 600.072 ms                |
| OneStep                   | 282.039 ms                | 772.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:52.360052 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:39:52.780005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240130 10:39:53.364478 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:39:53.838845 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240130 10:39:54.378908 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:39:54.838006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240130 10:39:55.397374 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:39:55.868896 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.254 ms                  | 11.790 ms                 |
| ProcessBack:UpdateCache   | 6.062 ms                  | 9.658 ms                  |
| ProcessBack:UpsertPq      | 27.081 ms                 | 62.952 ms                 |
| ProcessOneStep            | 40.801 ms                 | 83.293 ms                 |
| BlockToStepN              | 471.680 ms                | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:56.737385 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:39:56.938050 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.743 ms                  | 206.674 ms                |
| Forward                   | 4.841 ms                  | 11.808 ms                 |
| Backward                  | 9.745 ms                  | 11.276 ms                 |
| Optimize                  | 2.514 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 39.880 us                 | 31.295 ms                 |
| AfterBackward             | 40.849 ms                 | 83.328 ms                 |
| BlockToStepN              | 58.285 ms                 | 600.072 ms                |
| OneStep                   | 282.039 ms                | 773.962 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:39:57.758010 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:39:57.938006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240130 10:39:58.788445 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:39:58.956328 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240130 10:39:59.798282 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:39:59.956003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240130 10:40:00.944613 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:40:01.057374 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.240 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 6.040 ms                  | 8.920 ms                  |
| ProcessBack:UpsertPq      | 27.157 ms                 | 62.148 ms                 |
| ProcessOneStep            | 40.816 ms                 | 83.293 ms                 |
| BlockToStepN              | 471.680 ms                | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:01.977900 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:40:02.126570 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.243 ms                  | 218.636 ms                |
| Forward                   | 4.845 ms                  | 11.808 ms                 |
| Backward                  | 9.730 ms                  | 11.276 ms                 |
| Optimize                  | 2.507 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 37.488 us                 | 33.733 ms                 |
| AfterBackward             | 40.852 ms                 | 83.328 ms                 |
| BlockToStepN              | 58.285 ms                 | 600.072 ms                |
| OneStep                   | 282.039 ms                | 773.962 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:02.997040 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 10:40:03.126004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240130 10:40:04.126008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240130 10:40:04.140224 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:40:05.126008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240130 10:40:05.161924 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:40:06.126006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240130 10:40:06.293511 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.254 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.998 ms                  | 8.920 ms                  |
| ProcessBack:UpsertPq      | 27.037 ms                 | 62.148 ms                 |
| ProcessOneStep            | 40.800 ms                 | 83.293 ms                 |
| BlockToStepN              | 79.105 ms                 | 599.993 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:07.126005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.243 ms                  | 218.636 ms                |
| Forward                   | 4.850 ms                  | 11.808 ms                 |
| Backward                  | 9.712 ms                  | 11.276 ms                 |
| Optimize                  | 2.506 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 34.795 us                 | 33.733 ms                 |
| AfterBackward             | 40.776 ms                 | 83.328 ms                 |
| BlockToStepN              | 471.745 ms                | 600.072 ms                |
| OneStep                   | 565.540 ms                | 795.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:07.307545 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:08.180696 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240130 10:40:08.750382 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:40:09.180007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240130 10:40:09.759544 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:40:10.228433 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240130 10:40:10.784978 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:40:11.228006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.240 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.986 ms                  | 8.920 ms                  |
| ProcessBack:UpsertPq      | 26.779 ms                 | 62.148 ms                 |
| ProcessOneStep            | 40.316 ms                 | 77.382 ms                 |
| BlockToStepN              | 83.571 ms                 | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:11.795112 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.430 ms                  | 206.674 ms                |
| Forward                   | 4.834 ms                  | 9.979 ms                  |
| Backward                  | 9.710 ms                  | 11.179 ms                 |
| Optimize                  | 2.506 ms                  | 8.920 ms                  |
| BarrierTimeBeforeRank0    | 33.639 us                 | 31.295 ms                 |
| AfterBackward             | 40.346 ms                 | 77.412 ms                 |
| BlockToStepN              | 83.621 ms                 | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:12.242568 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240130 10:40:12.898972 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:40:13.242007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240130 10:40:13.919345 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:40:14.242005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240130 10:40:15.199481 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:40:15.272413 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240130 10:40:16.272007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240130 10:40:16.520181 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.961 ms                  | 8.920 ms                  |
| ProcessBack:UpsertPq      | 26.421 ms                 | 62.148 ms                 |
| ProcessOneStep            | 40.179 ms                 | 77.382 ms                 |
| BlockToStepN              | 83.571 ms                 | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.442 ms                  | 206.674 ms                |
| Forward                   | 4.822 ms                  | 9.979 ms                  |
| Backward                  | 9.709 ms                  | 11.179 ms                 |
| Optimize                  | 2.490 ms                  | 8.920 ms                  |
| BarrierTimeBeforeRank0    | 32.184 us                 | 33.733 ms                 |
| AfterBackward             | 40.206 ms                 | 77.412 ms                 |
| BlockToStepN              | 83.621 ms                 | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:17.272006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240130 10:40:17.940752 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:40:18.272006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240130 10:40:18.940876 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:40:19.272004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240130 10:40:20.289805 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:40:20.385897 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240130 10:40:21.318779 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:40:21.385002 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 9.791 ms                  |
| ProcessBack:UpdateCache   | 5.951 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 26.173 ms                 | 60.826 ms                 |
| ProcessOneStep            | 39.947 ms                 | 77.382 ms                 |
| BlockToStepN              | 471.680 ms                | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.468 ms                  | 206.674 ms                |
| Forward                   | 4.818 ms                  | 9.979 ms                  |
| Backward                  | 9.704 ms                  | 11.179 ms                 |
| Optimize                  | 2.490 ms                  | 8.920 ms                  |
| BarrierTimeBeforeRank0    | 31.155 us                 | 33.733 ms                 |
| AfterBackward             | 39.984 ms                 | 77.412 ms                 |
| BlockToStepN              | 90.791 ms                 | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:22.337662 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:40:22.401001 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240130 10:40:23.344905 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:40:23.400004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240130 10:40:24.400007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240130 10:40:24.584820 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:40:25.412268 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240130 10:40:25.606410 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:26.445648 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240130 10:40:26.640800 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.941 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.970 ms                 | 60.826 ms                 |
| ProcessOneStep            | 39.856 ms                 | 77.382 ms                 |
| BlockToStepN              | 99.651 ms                 | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.468 ms                  | 206.674 ms                |
| Forward                   | 4.807 ms                  | 9.979 ms                  |
| Backward                  | 9.699 ms                  | 11.179 ms                 |
| Optimize                  | 2.492 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 31.155 us                 | 33.733 ms                 |
| AfterBackward             | 39.881 ms                 | 77.412 ms                 |
| BlockToStepN              | 99.719 ms                 | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:27.445006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=299, pq.top=299
W20240130 10:40:27.665603 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 1] 300 steps, total: 36.707, sample: 1.270, forward: 0.477, backward: 1.003, update: 0.261
[proc 5] 300 steps, total: 36.707, sample: 1.162, forward: 0.433, backward: 0.961, update: 0.236
[proc 4] 300 steps, total: 36.707, sample: 1.148, forward: 0.473, backward: 1.049, update: 0.237
[proc 0] 300 steps, total: 36.706, sample: 2.117, forward: 0.480, backward: 0.949, update: 0.304
[proc 2] 300 steps, total: 36.707, sample: 1.119, forward: 0.467, backward: 0.994, update: 0.250
[proc 3] 300 steps, total: 36.707, sample: 1.099, forward: 0.487, backward: 0.978, update: 0.241
W20240130 10:40:28.477887 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240130 10:40:28.675535 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:40:29.477005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240130 10:40:30.015163 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:40:30.477006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240130 10:40:31.024183 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:40:31.477007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.911 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 26.022 ms                 | 60.826 ms                 |
| ProcessOneStep            | 39.857 ms                 | 77.382 ms                 |
| BlockToStepN              | 112.144 ms                | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.442 ms                  | 206.674 ms                |
| Forward                   | 4.806 ms                  | 9.979 ms                  |
| Backward                  | 9.702 ms                  | 11.179 ms                 |
| Optimize                  | 2.493 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 30.596 us                 | 33.733 ms                 |
| AfterBackward             | 39.963 ms                 | 77.412 ms                 |
| BlockToStepN              | 112.212 ms                | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:32.446292 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:40:32.604749 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240130 10:40:33.461961 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:33.604004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240130 10:40:34.544463 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:40:34.620326 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240130 10:40:35.567087 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:40:35.620002 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240130 10:40:36.620007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240130 10:40:36.685320 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 10.070 ms                 |
| ProcessBack:UpdateCache   | 5.884 ms                  | 8.920 ms                  |
| ProcessBack:UpsertPq      | 25.970 ms                 | 60.826 ms                 |
| ProcessOneStep            | 39.856 ms                 | 77.382 ms                 |
| BlockToStepN              | 471.680 ms                | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.709 ms                  | 206.674 ms                |
| Forward                   | 4.797 ms                  | 10.011 ms                 |
| Backward                  | 9.697 ms                  | 11.179 ms                 |
| Optimize                  | 2.491 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 30.599 us                 | 33.733 ms                 |
| AfterBackward             | 39.881 ms                 | 77.412 ms                 |
| BlockToStepN              | 112.212 ms                | 585.634 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:37.703964 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:40:37.856120 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240130 10:40:38.755230 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:40:38.856003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240130 10:40:39.794584 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:40:39.865780 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240130 10:40:40.820389 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:40.870385 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 9.791 ms                  |
| ProcessBack:UpdateCache   | 5.861 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.969 ms                 | 59.934 ms                 |
| ProcessOneStep            | 39.857 ms                 | 77.382 ms                 |
| BlockToStepN              | 120.248 ms                | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:41.870004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=337, pq.top=337
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.750 ms                  | 206.674 ms                |
| Forward                   | 4.807 ms                  | 10.011 ms                 |
| Backward                  | 9.697 ms                  | 11.276 ms                 |
| Optimize                  | 2.490 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 30.976 us                 | 33.733 ms                 |
| AfterBackward             | 39.888 ms                 | 77.412 ms                 |
| BlockToStepN              | 120.304 ms                | 585.634 ms                |
| OneStep                   | 282.039 ms                | 786.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:42.188256 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:40:42.870007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240130 10:40:43.194346 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:40:43.870007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240130 10:40:44.198168 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:40:44.898152 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240130 10:40:45.430137 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:40:45.898007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240130 10:40:46.456643 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 9.791 ms                  |
| ProcessBack:UpdateCache   | 5.837 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.788 ms                 | 59.934 ms                 |
| ProcessOneStep            | 39.770 ms                 | 77.382 ms                 |
| BlockToStepN              | 127.968 ms                | 585.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:46.898003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.926 ms                  | 197.267 ms                |
| Forward                   | 4.800 ms                  | 9.979 ms                  |
| Backward                  | 9.692 ms                  | 11.179 ms                 |
| Optimize                  | 2.490 ms                  | 8.920 ms                  |
| BarrierTimeBeforeRank0    | 30.378 us                 | 32.797 ms                 |
| AfterBackward             | 39.768 ms                 | 75.187 ms                 |
| BlockToStepN              | 128.041 ms                | 585.634 ms                |
| OneStep                   | 282.039 ms                | 786.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:47.718711 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:40:47.951349 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240130 10:40:48.730605 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:48.951006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240130 10:40:49.951006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240130 10:40:50.098341 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:40:50.951009 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240130 10:40:51.124159 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 9.791 ms                  |
| ProcessBack:UpdateCache   | 5.831 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.657 ms                 | 59.934 ms                 |
| ProcessOneStep            | 39.689 ms                 | 75.149 ms                 |
| BlockToStepN              | 127.968 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:51.966228 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.926 ms                  | 197.267 ms                |
| Forward                   | 4.797 ms                  | 9.979 ms                  |
| Backward                  | 9.686 ms                  | 11.179 ms                 |
| Optimize                  | 2.482 ms                  | 8.920 ms                  |
| BarrierTimeBeforeRank0    | 29.988 us                 | 32.797 ms                 |
| AfterBackward             | 39.673 ms                 | 75.187 ms                 |
| BlockToStepN              | 128.041 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:52.533305 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:40:52.966007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240130 10:40:53.548038 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:40:53.966009 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240130 10:40:54.572552 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:40:54.966007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240130 10:40:55.795176 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:40:55.966006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=372, pq.top=372
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.203 ms                  | 9.791 ms                  |
| ProcessBack:UpdateCache   | 5.812 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.524 ms                 | 59.934 ms                 |
| ProcessOneStep            | 39.599 ms                 | 75.149 ms                 |
| BlockToStepN              | 471.680 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:56.875981 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:40:56.983438 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.926 ms                  | 197.267 ms                |
| Forward                   | 4.796 ms                  | 9.979 ms                  |
| Backward                  | 9.682 ms                  | 11.179 ms                 |
| Optimize                  | 2.482 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.988 us                 | 32.797 ms                 |
| AfterBackward             | 39.626 ms                 | 75.187 ms                 |
| BlockToStepN              | 142.270 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:40:57.882639 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:40:57.983002 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240130 10:40:58.983006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240130 10:40:59.024489 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:41:00.035014 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240130 10:41:00.054068 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:41:01.035006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240130 10:41:01.368858 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.800 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.308 ms                 | 54.993 ms                 |
| ProcessOneStep            | 39.522 ms                 | 75.149 ms                 |
| BlockToStepN              | 142.213 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:02.035003 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.750 ms                  | 197.267 ms                |
| Forward                   | 4.793 ms                  | 9.979 ms                  |
| Backward                  | 9.680 ms                  | 11.179 ms                 |
| Optimize                  | 2.486 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 30.140 us                 | 33.733 ms                 |
| AfterBackward             | 39.548 ms                 | 75.187 ms                 |
| BlockToStepN              | 471.745 ms                | 585.500 ms                |
| OneStep                   | 563.849 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:02.375661 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:03.035004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240130 10:41:03.389333 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:41:04.047057 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240130 10:41:04.560487 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:41:05.047006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240130 10:41:05.586994 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:41:06.047005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.781 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.560 ms                 | 54.993 ms                 |
| ProcessOneStep            | 39.601 ms                 | 75.149 ms                 |
| BlockToStepN              | 142.213 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:06.831454 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 1] 400 steps, total: 39.191, sample: 1.201, forward: 0.477, backward: 0.970, update: 0.247
[proc 4] 400 steps, total: 39.191, sample: 1.069, forward: 0.458, backward: 1.068, update: 0.254
[proc 5] 400 steps, total: 39.191, sample: 1.148, forward: 0.443, backward: 0.976, update: 0.236
[proc 3] 400 steps, total: 39.191, sample: 1.061, forward: 0.506, backward: 1.010, update: 0.246
[proc 2] 400 steps, total: 39.191, sample: 1.130, forward: 0.477, backward: 0.974, update: 0.249
[proc 0] 400 steps, total: 39.191, sample: 1.944, forward: 0.489, backward: 0.952, update: 0.309
W20240130 10:41:07.095571 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=401, pq.top=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.709 ms                  | 197.267 ms                |
| Forward                   | 4.796 ms                  | 9.979 ms                  |
| Backward                  | 9.679 ms                  | 11.179 ms                 |
| Optimize                  | 2.486 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 29.988 us                 | 33.733 ms                 |
| AfterBackward             | 39.648 ms                 | 75.187 ms                 |
| BlockToStepN              | 142.270 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:07.858440 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:41:08.095006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240130 10:41:09.095007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240130 10:41:09.124881 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:41:10.147419 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:41:10.161190 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240130 10:41:11.161012 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240130 10:41:11.486691 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.199 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.769 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.560 ms                 | 54.993 ms                 |
| ProcessOneStep            | 39.689 ms                 | 75.149 ms                 |
| BlockToStepN              | 142.213 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:12.161006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=413, pq.top=413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.839 ms                  | 197.267 ms                |
| Forward                   | 4.797 ms                  | 9.979 ms                  |
| Backward                  | 9.676 ms                  | 11.179 ms                 |
| Optimize                  | 2.482 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 29.874 us                 | 33.733 ms                 |
| AfterBackward             | 39.725 ms                 | 75.187 ms                 |
| BlockToStepN              | 142.270 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:12.506971 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:41:13.161005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=416, pq.top=416
W20240130 10:41:13.825644 39072 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 10:41:14.161006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240130 10:41:14.827423 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:41:15.161005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240130 10:41:15.834079 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:41:16.161005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.202 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.762 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.575 ms                 | 54.993 ms                 |
| ProcessOneStep            | 39.772 ms                 | 75.149 ms                 |
| BlockToStepN              | 142.213 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:17.006381 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:41:17.161006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=426, pq.top=426
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.823 ms                  | 197.267 ms                |
| Forward                   | 4.796 ms                  | 9.979 ms                  |
| Backward                  | 9.666 ms                  | 11.179 ms                 |
| Optimize                  | 2.486 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 29.874 us                 | 33.733 ms                 |
| AfterBackward             | 39.800 ms                 | 75.187 ms                 |
| BlockToStepN              | 471.745 ms                | 585.500 ms                |
| OneStep                   | 563.849 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:18.030139 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:18.161006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240130 10:41:19.046116 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:41:19.161005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240130 10:41:20.161007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240130 10:41:20.294857 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:41:21.161006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=436, pq.top=436
W20240130 10:41:21.306150 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.198 ms                  | 9.585 ms                  |
| ProcessBack:UpdateCache   | 5.756 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.594 ms                 | 54.666 ms                 |
| ProcessOneStep            | 39.854 ms                 | 75.149 ms                 |
| BlockToStepN              | 158.523 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.709 ms                  | 197.267 ms                |
| Forward                   | 4.799 ms                  | 9.979 ms                  |
| Backward                  | 9.664 ms                  | 11.276 ms                 |
| Optimize                  | 2.486 ms                  | 10.002 ms                 |
| BarrierTimeBeforeRank0    | 29.988 us                 | 33.733 ms                 |
| AfterBackward             | 39.881 ms                 | 75.187 ms                 |
| BlockToStepN              | 158.603 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:22.238616 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240130 10:41:22.784299 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:41:23.238006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240130 10:41:23.784107 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 10:41:24.259248 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240130 10:41:24.995913 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:41:25.259135 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240130 10:41:26.024295 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:26.259006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.198 ms                  | 9.585 ms                  |
| ProcessBack:UpdateCache   | 5.736 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.560 ms                 | 54.666 ms                 |
| ProcessOneStep            | 39.854 ms                 | 75.149 ms                 |
| BlockToStepN              | 471.680 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.542 ms                  | 195.631 ms                |
| Forward                   | 4.798 ms                  | 9.878 ms                  |
| Backward                  | 9.664 ms                  | 11.179 ms                 |
| Optimize                  | 2.486 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.874 us                 | 32.797 ms                 |
| AfterBackward             | 39.881 ms                 | 74.191 ms                 |
| BlockToStepN              | 158.603 ms                | 585.500 ms                |
| OneStep                   | 282.039 ms                | 783.877 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:27.259006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240130 10:41:27.355927 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:41:28.259006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=454, pq.top=454
W20240130 10:41:28.433557 39072 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 10:41:29.287232 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240130 10:41:29.445358 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:41:30.287007 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240130 10:41:30.611343 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 10:41:31.287009 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240130 10:41:31.656309 39072 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.197 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.725 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.560 ms                 | 54.666 ms                 |
| ProcessOneStep            | 39.893 ms                 | 74.164 ms                 |
| BlockToStepN              | 177.149 ms                | 584.579 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.509 ms                  | 195.631 ms                |
| Forward                   | 4.801 ms                  | 9.979 ms                  |
| Backward                  | 9.658 ms                  | 11.179 ms                 |
| Optimize                  | 2.482 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.671 us                 | 32.797 ms                 |
| AfterBackward             | 39.933 ms                 | 74.191 ms                 |
| BlockToStepN              | 177.250 ms                | 584.680 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:32.323573 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=464, pq.top=464
W20240130 10:41:33.085666 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:41:33.353826 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240130 10:41:34.118062 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:34.353006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240130 10:41:35.124421 39072 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 10:41:35.353008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240130 10:41:36.353008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240130 10:41:36.369580 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.193 ms                  | 9.734 ms                  |
| ProcessBack:UpdateCache   | 5.701 ms                  | 8.499 ms                  |
| ProcessBack:UpsertPq      | 25.575 ms                 | 54.666 ms                 |
| ProcessOneStep            | 40.026 ms                 | 74.164 ms                 |
| BlockToStepN              | 179.886 ms                | 584.579 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.468 ms                  | 195.631 ms                |
| Forward                   | 4.809 ms                  | 9.979 ms                  |
| Backward                  | 9.657 ms                  | 11.179 ms                 |
| Optimize                  | 2.490 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.874 us                 | 32.797 ms                 |
| AfterBackward             | 40.054 ms                 | 74.191 ms                 |
| BlockToStepN              | 179.972 ms                | 584.680 ms                |
| OneStep                   | 282.039 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:37.353006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=476, pq.top=476
W20240130 10:41:37.373816 39072 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 10:41:38.353006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240130 10:41:38.376924 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:39.353005 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240130 10:41:39.812669 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:41:40.353008 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240130 10:41:40.817387 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:41:41.353006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=485, pq.top=485
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.193 ms                  | 9.585 ms                  |
| ProcessBack:UpdateCache   | 5.687 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.634 ms                 | 54.666 ms                 |
| ProcessOneStep            | 40.119 ms                 | 75.149 ms                 |
| BlockToStepN              | 471.680 ms                | 584.579 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:41.958232 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.369 ms                  | 195.631 ms                |
| Forward                   | 4.811 ms                  | 9.979 ms                  |
| Backward                  | 9.648 ms                  | 11.179 ms                 |
| Optimize                  | 2.490 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.645 us                 | 32.797 ms                 |
| AfterBackward             | 40.182 ms                 | 75.187 ms                 |
| BlockToStepN              | 179.972 ms                | 584.680 ms                |
| OneStep                   | 282.131 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:42.353004 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240130 10:41:42.980093 39072 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 10:41:43.353006 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240130 10:41:44.314113 39072 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 10:41:44.375988 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240130 10:41:45.344116 39072 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 10:41:45.375002 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240130 10:41:46.365233 39072 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 10:41:46.375002 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=497, pq.top=497
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.193 ms                  | 9.585 ms                  |
| ProcessBack:UpdateCache   | 5.682 ms                  | 8.462 ms                  |
| ProcessBack:UpsertPq      | 25.664 ms                 | 54.993 ms                 |
| ProcessOneStep            | 40.179 ms                 | 75.149 ms                 |
| BlockToStepN              | 181.194 ms                | 585.430 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.442 ms                  | 195.631 ms                |
| Forward                   | 4.811 ms                  | 9.979 ms                  |
| Backward                  | 9.642 ms                  | 11.179 ms                 |
| Optimize                  | 2.488 ms                  | 9.699 ms                  |
| BarrierTimeBeforeRank0    | 29.433 us                 | 32.797 ms                 |
| AfterBackward             | 40.206 ms                 | 75.187 ms                 |
| BlockToStepN              | 181.275 ms                | 585.500 ms                |
| OneStep                   | 282.131 ms                | 782.976 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 10:41:47.375013 38597 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=499, pq.top=499
W20240130 10:41:47.743172 39072 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 5] 500 steps, total: 40.960, sample: 1.198, forward: 0.449, backward: 0.970, update: 0.241
[proc 1] 500 steps, total: 40.960, sample: 1.180, forward: 0.481, backward: 0.988, update: 0.250
[proc 4] 500 steps, total: 40.960, sample: 1.085, forward: 0.458, backward: 1.048, update: 0.244
[proc 2] 500 steps, total: 40.960, sample: 1.096, forward: 0.493, backward: 1.014, update: 0.253
[proc 0] 500 steps, total: 40.960, sample: 1.700, forward: 0.504, backward: 0.956, update: 0.282
[proc 3] 500 steps, total: 40.960, sample: 1.059, forward: 0.535, backward: 1.017, update: 0.250
Successfully xmh. training takes 191.3666684627533 seconds
before call kg_cache_controller.StopThreads()
W20240130 10:41:47.979933 38597 grad_async_v1.h:230] call StopThreads. PID = 37449
W20240130 10:41:47.979959 38597 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 10:41:47.991344 38597 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 10:41:47.991402 38597 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240130 10:41:48.018317 38597 grad_async_v1.h:251] StopThreads done.
