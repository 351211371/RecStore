WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 08:55:47.177968 22429 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_32', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[09:15:10] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 86054151 nodes and 421063214 edges into 6 parts and get 26059019 edge cuts
WARNING [22429 sampler.py:454] Start PreSampling
WARNING [22429 sampler.py:532] Before construct renumbering_dict
WARNING [22429 sampler.py:555] PreSampling done
W20240130 09:25:32.043350 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 09:25:32.043540 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 09:25:32.043588 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 09:25:32.043624 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 09:25:32.043651 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 09:25:32.043684 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 09:25:32.043716 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 09:25:32.043756 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 09:25:32.043790 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 09:25:32.043823 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 09:25:32.043865 22429 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 09:25:32.043890 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 09:25:32.043921 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 09:25:32.044093 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 09:25:32.044155 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 09:25:32.044189 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 09:25:32.044234 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 09:25:32.044260 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 09:25:32.044299 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 09:25:32.044337 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 09:25:32.044373 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 09:25:32.044404 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 09:25:32.044440 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 09:25:32.044471 22429 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 09:25:32.044494 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 09:25:32.044525 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 09:25:32.044587 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 09:25:32.044621 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 09:25:32.044659 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 09:25:32.044693 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 09:25:32.044730 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 09:25:32.044767 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 09:25:32.044798 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 09:25:32.044826 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 09:25:32.044852 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 09:25:32.044891 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 09:25:32.044927 22429 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 09:25:32.044950 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 09:25:32.044977 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 09:25:32.045038 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 09:25:32.045068 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 09:25:32.045099 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 09:25:32.045137 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 09:25:32.045167 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 09:25:32.045202 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 09:25:32.045228 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 09:25:32.045254 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 09:25:32.045282 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 09:25:32.045313 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 09:25:32.045344 22429 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 09:25:32.045370 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 09:25:32.045394 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 09:25:32.045451 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 09:25:32.045493 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 09:25:32.045523 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 09:25:32.045560 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 09:25:32.045591 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 09:25:32.045619 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 09:25:32.045653 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 09:25:32.045684 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 09:25:32.045714 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 09:25:32.045748 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 09:25:32.045779 22429 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 09:25:32.045801 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 09:25:32.045825 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 09:25:32.045883 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 09:25:32.045918 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 09:25:32.045945 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 09:25:32.045979 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 09:25:32.046008 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 09:25:32.046046 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 09:25:32.046077 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 09:25:32.046103 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 09:25:32.046136 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 09:25:32.046167 22429 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 09:25:32.046196 22429 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 09:25:32.046219 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 09:25:32.046249 22429 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 09:25:32.926676 22429 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10001ca5a000 128.2 GB
W20240130 09:25:32.926833 22429 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10202b692000 328.3 MB
Convert a graph into a bidirected graph: 54.091 seconds, peak memory: 265.172 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 265.172 GB
Metis partitioning: 448.599 seconds, peak memory: 276.572 GB
Split the graph: 110.176 seconds
Construct subgraphs: 20.769 seconds
MertisPartition: part 0 has 16391033 N 60554486 E
MertisPartition: part 1 has 22850318 N 74912573 E
MertisPartition: part 2 has 16459669 N 67428404 E
MertisPartition: part 3 has 17554345 N 53272616 E
MertisPartition: part 4 has 17824082 N 71836124 E
MertisPartition: part 5 has 18730250 N 46391216 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,       14,  ..., 12367661, 70093925, 61280605]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4302815,  4302859,   557154,  ..., 61197657, 10684093, 59435364]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2294.764 seconds
[Rank1] pid = 23621
[Rank2] pid = 23715
[Rank3] pid = 23784
[Rank4] pid = 23852
INFO [22429 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [23621 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [23784 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [23715 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [23919 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [23852 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [23715 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23919 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23852 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22429 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23621 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23784 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240130 09:34:11.831128 23920 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240130 09:34:11.831422 23716 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240130 09:34:11.832532 23962 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240130 09:34:11.835253 23785 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240130 09:34:11.835507 23853 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240130 09:34:11.835523 23622 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240130 09:34:11.900967 23920 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10203fee5000 7.629 MB
W20240130 09:34:11.901046 23853 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102040688000 7.629 MB
W20240130 09:34:11.901145 23920 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102040e2b000 7.629 MB
W20240130 09:34:11.901201 23920 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020415ce000 1.49 GB
W20240130 09:34:11.901247 23853 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020a0bb1000 7.629 MB
W20240130 09:34:11.901274 23962 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020a1354000 7.629 MB
W20240130 09:34:11.901316 23716 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020a1af7000 7.629 MB
W20240130 09:34:11.901342 23622 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020a229a000 7.629 MB
W20240130 09:34:11.901365 23920 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020a2a3d000 1.49 GB
W20240130 09:34:11.901384 23853 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102102020000 1.49 GB
W20240130 09:34:11.901430 23785 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102161603000 7.629 MB
W20240130 09:34:11.901449 23853 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102161da6000 1.49 GB
W20240130 09:34:11.901476 23920 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 09:34:11.901520 23853 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 09:34:11.904444 23785 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1021c1389000 7.629 MB
W20240130 09:34:11.904451 23962 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021c1b2c000 7.629 MB
W20240130 09:34:11.904531 23622 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021c22cf000 7.629 MB
W20240130 09:34:11.904536 23716 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021c2a72000 7.629 MB
W20240130 09:34:11.904616 23622 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021c3215000 1.49 GB
W20240130 09:34:11.904654 23716 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1022227f8000 1.49 GB
W20240130 09:34:11.904690 23622 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102281ddd000 1.49 GB
W20240130 09:34:11.904711 23716 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022e13c0000 1.49 GB
W20240130 09:34:11.904742 23962 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1023409a5000 1.49 GB
W20240130 09:34:11.904747 23920 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 09:34:11.904758 23785 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10239ff88000 1.49 GB
W20240130 09:34:11.904801 23962 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1023ff56b000 1.49 GB
W20240130 09:34:11.904846 23785 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10245eb4e000 1.49 GB
W20240130 09:34:11.904868 23853 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240130 09:34:11.904901 23785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 09:34:11.906252 23962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 09:34:11.907739 23716 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 09:34:11.907754 23622 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 09:34:11.914909 23785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240130 09:34:11.914927 23962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240130 09:34:11.914928 23716 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240130 09:34:11.914973 23622 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [23919 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [23852 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [23621 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [23715 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [23784 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 23919
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [22429 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 09:34:53.014070 23920 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240130 09:34:53.014245 23716 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 09:34:53.014288 23962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 09:34:53.014366 23622 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 09:34:53.014436 23785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240130 09:34:53.014463 23853 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240130 09:34:53.015815 23920 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240130 09:34:53.015928 23920 grad_base.h:184] Init GradProcessingBase done
I20240130 09:35:05.554435 23920 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240130 09:35:05.554625 23920 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 09:35:05.554636 23920 kg_controller.h:84] Construct KGCacheController done
E20240130 09:35:06.117774 23716 recstore.cc:66] init folly done
E20240130 09:35:06.117805 23853 recstore.cc:66] init folly done
E20240130 09:35:06.117808 23962 recstore.cc:66] init folly done
E20240130 09:35:06.118130 23920 recstore.cc:66] init folly done
E20240130 09:35:06.118377 23622 recstore.cc:66] init folly done
E20240130 09:35:06.118647 23785 recstore.cc:66] init folly done
I20240130 09:35:06.119472 23920 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 09:35:21.572664 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 09:35:21.573199 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 09:35:25.004837 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 09:35:25.025141 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 09:35:25.145087 23962 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
W20240130 09:35:26.408290 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 09:35:26.408479 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 09:35:28.743772 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 09:35:28.743892 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 09:35:32.811197 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 09:35:32.836658 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 09:35:33.047611 23785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240130 09:35:33.212654 23920 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240130 09:35:33.836591 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 09:35:34.719691 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 09:35:34.837721 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 09:35:34.882997 23716 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240130 09:35:37.773662 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 09:35:37.793345 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240130 09:35:37.921223 23853 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240130 09:35:38.501161 23622 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240130 09:35:38.793550 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 09:35:38.971880 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 09:35:40.919399 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 272.025 ms                | 313.199 ms                |
| ProcessBack:UpdateCache   | 672.385 ms                | 672.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:41.151087 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240130 09:35:41.173666 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240130 09:35:41.919018 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 09:35:42.250813 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240130 09:35:42.418932 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end7
E20240130 09:35:42.919034 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.804 ms                 | 166.773 ms                |
| Forward                   | 6.208 ms                  | 925.978 ms                |
| Backward                  | 5.313 ms                  | 228.722 ms                |
| Optimize                  | 2.129 ms                  | 4.870 ms                  |
| BarrierTimeBeforeRank0    | 8.622 ms                  | 45.385 ms                 |
| AfterBackward             | 93.717 ms                 | 1.434 s                   |
| BlockToStepN              | 12.710 ms                 | 58.301 ms                 |
| OneStep                   | 213.183 ms                | 2.658 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:43.250018 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240130 09:35:43.575206 24422 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end5
E20240130 09:35:43.919016 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 09:35:44.250010 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=19, pq.top=19
E20240130 09:35:44.919009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 09:35:44.921285 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end4
W20240130 09:35:45.335925 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=27, pq.top=27
E20240130 09:35:45.919009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=2292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.709 ms                  | 272.025 ms                |
| ProcessBack:UpdateCache   | 5.838 ms                  | 672.385 ms                |
| ProcessBack:UpsertPq      | 31.284 ms                 | 213.715 ms                |
| ProcessOneStep            | 77.695 ms                 | 1.433 s                   |
| BlockToStepN              | 9.993 ms                  | 61.096 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:46.134244 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end2
E20240130 09:35:46.919009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
W20240130 09:35:47.194742 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end3
W20240130 09:35:47.326581 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=33, pq.top=33
E20240130 09:35:47.919014 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=33910
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.513 ms                  | 166.773 ms                |
| Forward                   | 7.954 ms                  | 925.978 ms                |
| Backward                  | 5.434 ms                  | 228.722 ms                |
| Optimize                  | 3.477 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 546.841 us                | 45.385 ms                 |
| AfterBackward             | 77.750 ms                 | 1.434 s                   |
| BlockToStepN              | 13.679 ms                 | 61.193 ms                 |
| OneStep                   | 133.702 ms                | 2.658 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:48.301169 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
W20240130 09:35:48.326056 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=39, pq.top=39
E20240130 09:35:48.919010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=23900
W20240130 09:35:49.307381 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end7
W20240130 09:35:49.359589 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=47, pq.top=47
E20240130 09:35:49.919054 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=18094
W20240130 09:35:50.659451 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end0
E20240130 09:35:50.919015 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.272 ms                  | 272.025 ms                |
| ProcessBack:UpdateCache   | 6.445 ms                  | 672.385 ms                |
| ProcessBack:UpsertPq      | 30.705 ms                 | 213.715 ms                |
| ProcessOneStep            | 76.255 ms                 | 1.433 s                   |
| BlockToStepN              | 13.154 ms                 | 77.456 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:51.295362 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240130 09:35:51.704149 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end4
E20240130 09:35:51.919008 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240130 09:35:52.368880 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240130 09:35:52.865262 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end1
E20240130 09:35:52.919004 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=31848
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.608 ms                 | 148.868 ms                |
| Forward                   | 6.208 ms                  | 21.552 ms                 |
| Backward                  | 5.353 ms                  | 6.198 ms                  |
| Optimize                  | 3.100 ms                  | 16.389 ms                 |
| BarrierTimeBeforeRank0    | 62.480 us                 | 44.744 ms                 |
| AfterBackward             | 75.800 ms                 | 1.172 s                   |
| BlockToStepN              | 14.373 ms                 | 77.540 ms                 |
| OneStep                   | 145.866 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 09:35:53.919013 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=126
W20240130 09:35:53.919732 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
W20240130 09:35:54.749686 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240130 09:35:54.936036 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=81
W20240130 09:35:54.961933 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end6
W20240130 09:35:55.782065 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=70, pq.top=69
E20240130 09:35:55.952863 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.898 ms                  | 272.025 ms                |
| ProcessBack:UpdateCache   | 6.741 ms                  | 672.385 ms                |
| ProcessBack:UpsertPq      | 30.705 ms                 | 213.715 ms                |
| ProcessOneStep            | 75.414 ms                 | 1.433 s                   |
| BlockToStepN              | 19.233 ms                 | 122.596 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:56.142611 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end1
W20240130 09:35:56.782153 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240130 09:35:56.952009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=18065
W20240130 09:35:57.151818 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
W20240130 09:35:57.837821 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240130 09:35:57.957137 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.373 ms                  | 148.868 ms                |
| Forward                   | 5.860 ms                  | 46.209 ms                 |
| Backward                  | 5.406 ms                  | 6.198 ms                  |
| Optimize                  | 2.632 ms                  | 16.389 ms                 |
| BarrierTimeBeforeRank0    | 65.083 us                 | 44.744 ms                 |
| AfterBackward             | 75.683 ms                 | 1.434 s                   |
| BlockToStepN              | 24.124 ms                 | 201.536 ms                |
| OneStep                   | 173.423 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:35:58.034221 23920 grad_async_v2.h:237] pq is empty
W20240130 09:35:58.365115 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
E20240130 09:35:58.957015 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=44
W20240130 09:35:59.534657 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end7
W20240130 09:35:59.912894 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=87, pq.top=87
E20240130 09:35:59.957010 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=25809
W20240130 09:36:00.558380 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end2
W20240130 09:36:00.912096 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=94, pq.top=94
E20240130 09:36:00.957012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=16637
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.775 ms                  | 36.227 ms                 |
| ProcessBack:UpdateCache   | 6.816 ms                  | 10.295 ms                 |
| ProcessBack:UpsertPq      | 30.278 ms                 | 136.458 ms                |
| ProcessOneStep            | 73.716 ms                 | 1.433 s                   |
| BlockToStepN              | 24.063 ms                 | 201.450 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:01.671185 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
W20240130 09:36:01.912075 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=98, pq.top=98
E20240130 09:36:01.957007 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=69
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.860, sample: 2.003, forward: 1.369, backward: 0.766, update: 0.228
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 29.314, sample: 1.735, forward: 1.418, backward: 0.785, update: 0.249
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.478, sample: 1.659, forward: 1.315, backward: 0.803, update: 0.222
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 24.440, sample: 1.495, forward: 1.381, backward: 0.988, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 37.216, sample: 1.546, forward: 1.243, backward: 0.871, update: 0.228
train_sampler.Prefill()
-------Step 0-------
tensor([27264960,   564504,   440530,   564531,   564554,   564581,  5250646,
          564606,   564625,   408865]) tensor([  168462, 37177633, 36795957,  5244072, 74867746, 31999420, 53695335,
        14679338, 61397119,  3810654])
-------Step 1-------
tensor([27264960,   564504,   440530,   564531,   564554,   564581,  5250646,
          564606,   564625,   408865]) tensor([82594017, 85573654,  4601741,  1397502, 69491690, 47737205, 30805392,
        53383747, 63078470, 38498750])
-------Step 2-------
tensor([   18364,    18387,    18413,    32488, 40052621,    18436, 31331455,
           18464, 27264960, 85826676]) tensor([ 9303610, 33221160, 18816214, 74025390, 53812523, 40169027, 43978817,
        39420607,  6655447, 21548568])
-------Step 3-------
tensor([   18364,    18387,    18413,    32488, 40052621,    18436, 31331455,
           18464, 27264960, 85826676]) tensor([27554787, 26790669,  9147648, 81945096, 10096534, 12116695, 13371724,
        84504992, 81407340, 77258699])
-------Step 4-------
tensor([  692562,    36518,    83795, 10672544,    83821,   414132,    83846,
         4472495,    83873,   692581]) tensor([48591027, 82679903, 15180448, 26061806, 48397296, 56624957, 63661582,
        28869759, 32515302, 84263102])
-------Step 5-------
tensor([  692562,    36518,    83795, 10672544,    83821,   414132,    83846,
         4472495,    83873,   692581]) tensor([ 3996104,   154994,  7541553, 79552659, 67652072, 35627175, 74964057,
        58406920, 68154006, 24346101])
-------Step 6-------
tensor([  148631,   148660, 27264960,   148688,    39519,   148719,   447942,
          447982, 46406750,  4463189]) tensor([42808517, 43670595, 31393563, 71433172, 65436767,  1247483, 10885108,
         4963040, 59468479, 18145316])
-------Step 7-------
tensor([  148631,   148660, 27264960,   148688,    39519,   148719,   447942,
          447982, 46406750,  4463189]) tensor([28492318, 25533929, 41118844, 48620676, 80088625, 11040193,  2136017,
        45707458, 53399758, 21084190])
-------Step 8-------
tensor([  224928,   221721,   221747,  5352252,  4311108,    93071,    68058,
           68116,   221780, 44658539]) tensor([72033441, 29972396, 64374426, 74604385,  6696356, 18073427, 21567675,
        31277079, 82332007, 27191183])
-------Step 9-------
tensor([  224928,   221721,   221747,  5352252,  4311108,    93071,    68058,
           68116,   221780, 44658539]) tensor([  398399, 47379702, 81289642, 29912262, 79662401, 61637361, 60260876,
        32350568, 60351490, 13380159])
before start barrier
start train
[proc 0] 100 steps, total: 29.149, sample: 2.734, forward: 1.595, backward: 0.757, update: 0.330
W20240130 09:36:02.715392 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end2
E20240130 09:36:02.957007 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=5791
W20240130 09:36:02.997769 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.101 ms                 | 210.371 ms                |
| Forward                   | 5.860 ms                  | 46.209 ms                 |
| Backward                  | 5.383 ms                  | 6.198 ms                  |
| Optimize                  | 2.503 ms                  | 16.389 ms                 |
| BarrierTimeBeforeRank0    | 54.239 us                 | 44.744 ms                 |
| AfterBackward             | 68.041 ms                 | 1.434 s                   |
| BlockToStepN              | 32.954 ms                 | 201.536 ms                |
| OneStep                   | 173.129 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:03.732908 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end6
E20240130 09:36:03.957012 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=22033
W20240130 09:36:03.997081 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240130 09:36:04.747412 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240130 09:36:04.957011 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=40551
W20240130 09:36:05.037539 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240130 09:36:05.766368 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 09:36:05.957012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=8456
W20240130 09:36:06.071105 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=117, pq.top=116
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.678 ms                  | 36.227 ms                 |
| ProcessBack:UpdateCache   | 6.195 ms                  | 10.295 ms                 |
| ProcessBack:UpsertPq      | 27.932 ms                 | 136.458 ms                |
| ProcessOneStep            | 64.190 ms                 | 1.433 s                   |
| BlockToStepN              | 44.312 ms                 | 202.577 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:06.877403 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end0
E20240130 09:36:06.957062 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
W20240130 09:36:07.071153 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240130 09:36:07.907555 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end5
E20240130 09:36:07.957007 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=6718
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.274 ms                 | 210.371 ms                |
| Forward                   | 5.702 ms                  | 46.209 ms                 |
| Backward                  | 5.383 ms                  | 6.198 ms                  |
| Optimize                  | 2.401 ms                  | 16.389 ms                 |
| BarrierTimeBeforeRank0    | 46.325 us                 | 44.744 ms                 |
| AfterBackward             | 58.215 ms                 | 1.434 s                   |
| BlockToStepN              | 47.170 ms                 | 312.119 ms                |
| OneStep                   | 178.850 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:08.071305 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240130 09:36:08.929270 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end9
E20240130 09:36:08.957008 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=25057
W20240130 09:36:09.071007 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=129, pq.top=129
E20240130 09:36:09.961903 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 09:36:09.974987 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end4
W20240130 09:36:10.338896 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240130 09:36:10.961011 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=31553
W20240130 09:36:11.010296 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.603 ms                  | 22.261 ms                 |
| ProcessBack:UpdateCache   | 6.025 ms                  | 10.295 ms                 |
| ProcessBack:UpsertPq      | 26.617 ms                 | 116.993 ms                |
| ProcessOneStep            | 57.193 ms                 | 1.433 s                   |
| BlockToStepN              | 48.995 ms                 | 312.006 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:11.338078 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=141, pq.top=141
E20240130 09:36:11.961011 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=39138
W20240130 09:36:12.072152 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end6
W20240130 09:36:12.338304 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=147, pq.top=147
E20240130 09:36:12.961011 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=554
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.310 ms                 | 237.144 ms                |
| Forward                   | 5.731 ms                  | 46.209 ms                 |
| Backward                  | 5.407 ms                  | 10.108 ms                 |
| Optimize                  | 2.397 ms                  | 16.389 ms                 |
| BarrierTimeBeforeRank0    | 39.697 us                 | 44.744 ms                 |
| AfterBackward             | 56.789 ms                 | 1.434 s                   |
| BlockToStepN              | 51.954 ms                 | 312.119 ms                |
| OneStep                   | 179.155 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:13.144917 24422 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end0
W20240130 09:36:13.338326 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240130 09:36:13.961014 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=18931
W20240130 09:36:14.200119 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end6
W20240130 09:36:14.353863 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240130 09:36:14.961009 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=29462
W20240130 09:36:15.221395 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
W20240130 09:36:15.508397 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240130 09:36:15.961036 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=899
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.539 ms                  | 22.261 ms                 |
| ProcessBack:UpdateCache   | 5.978 ms                  | 10.295 ms                 |
| ProcessBack:UpsertPq      | 26.969 ms                 | 116.993 ms                |
| ProcessOneStep            | 57.193 ms                 | 1.172 s                   |
| BlockToStepN              | 52.112 ms                 | 202.577 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:16.254555 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end7
E20240130 09:36:16.961073 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=6277
W20240130 09:36:17.261384 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240130 09:36:17.289507 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end9
E20240130 09:36:17.961010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=31647
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.310 ms                 | 342.486 ms                |
| Forward                   | 5.762 ms                  | 21.552 ms                 |
| Backward                  | 5.445 ms                  | 6.198 ms                  |
| Optimize                  | 2.397 ms                  | 15.989 ms                 |
| BarrierTimeBeforeRank0    | 39.563 us                 | 41.031 ms                 |
| AfterBackward             | 57.616 ms                 | 1.172 s                   |
| BlockToStepN              | 56.068 ms                 | 202.690 ms                |
| OneStep                   | 179.318 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:18.261024 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240130 09:36:18.332918 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end5
E20240130 09:36:18.961010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=23495
W20240130 09:36:19.261466 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240130 09:36:19.432768 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end2
E20240130 09:36:19.961011 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=28836
W20240130 09:36:20.261044 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240130 09:36:20.497298 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
E20240130 09:36:20.961010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=39930
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.539 ms                  | 21.027 ms                 |
| ProcessBack:UpdateCache   | 6.014 ms                  | 10.277 ms                 |
| ProcessBack:UpsertPq      | 26.471 ms                 | 110.846 ms                |
| ProcessOneStep            | 55.871 ms                 | 1.172 s                   |
| BlockToStepN              | 55.985 ms                 | 202.577 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:21.261381 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240130 09:36:21.550768 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
E20240130 09:36:21.961020 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=34864
W20240130 09:36:22.261085 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240130 09:36:22.575251 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
[proc 4] 200 steps, total: 20.575, sample: 1.287, forward: 0.536, backward: 0.536, update: 0.227
[proc 2] 200 steps, total: 20.575, sample: 1.426, forward: 0.503, backward: 0.711, update: 0.210
[proc 1] 200 steps, total: 20.575, sample: 1.796, forward: 0.563, backward: 0.536, update: 0.245
[proc 5] 200 steps, total: 20.575, sample: 1.315, forward: 0.516, backward: 0.533, update: 0.232
[proc 3] 200 steps, total: 20.575, sample: 1.717, forward: 0.487, backward: 0.651, update: 0.277
[proc 0] 200 steps, total: 20.570, sample: 4.190, forward: 0.572, backward: 0.541, update: 0.237
E20240130 09:36:22.961012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=7225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.234 ms                 | 368.158 ms                |
| Forward                   | 5.762 ms                  | 21.552 ms                 |
| Backward                  | 5.452 ms                  | 6.198 ms                  |
| Optimize                  | 2.382 ms                  | 15.989 ms                 |
| BarrierTimeBeforeRank0    | 31.901 us                 | 41.031 ms                 |
| AfterBackward             | 55.112 ms                 | 1.172 s                   |
| BlockToStepN              | 56.100 ms                 | 202.690 ms                |
| OneStep                   | 179.295 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:23.289333 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240130 09:36:23.709753 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
E20240130 09:36:23.961012 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=48320
W20240130 09:36:24.289176 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240130 09:36:24.891993 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
E20240130 09:36:24.961009 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=53
W20240130 09:36:25.498131 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240130 09:36:25.899156 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end7
E20240130 09:36:25.961009 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=36875
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.491 ms                  | 21.027 ms                 |
| ProcessBack:UpdateCache   | 6.012 ms                  | 10.277 ms                 |
| ProcessBack:UpsertPq      | 24.770 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.801 ms                 | 1.172 s                   |
| BlockToStepN              | 56.123 ms                 | 205.757 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:26.498308 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240130 09:36:26.909811 24422 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end3
E20240130 09:36:26.961009 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=19897
W20240130 09:36:27.605599 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240130 09:36:27.946053 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end9
E20240130 09:36:27.961006 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=22802
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.234 ms                 | 373.506 ms                |
| Forward                   | 5.731 ms                  | 46.209 ms                 |
| Backward                  | 5.428 ms                  | 9.458 ms                  |
| Optimize                  | 2.360 ms                  | 15.989 ms                 |
| BarrierTimeBeforeRank0    | 28.116 us                 | 41.031 ms                 |
| AfterBackward             | 54.341 ms                 | 1.172 s                   |
| BlockToStepN              | 58.028 ms                 | 205.883 ms                |
| OneStep                   | 179.155 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:28.605515 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=231, pq.top=231
E20240130 09:36:28.961009 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=3992
W20240130 09:36:29.021173 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end3
W20240130 09:36:29.671970 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240130 09:36:29.961009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=9993
W20240130 09:36:30.141119 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end9
W20240130 09:36:30.718963 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=244, pq.top=244
E20240130 09:36:30.961009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.456 ms                  | 16.238 ms                 |
| ProcessBack:UpdateCache   | 5.939 ms                  | 10.041 ms                 |
| ProcessBack:UpsertPq      | 23.843 ms                 | 103.196 ms                |
| ProcessOneStep            | 54.156 ms                 | 1.172 s                   |
| BlockToStepN              | 57.919 ms                 | 312.006 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:31.344527 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
W20240130 09:36:31.955447 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240130 09:36:31.961010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=24374
W20240130 09:36:32.377342 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
W20240130 09:36:32.955464 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240130 09:36:32.961004 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=30890
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.274 ms                 | 380.718 ms                |
| Forward                   | 5.714 ms                  | 21.552 ms                 |
| Backward                  | 5.407 ms                  | 6.691 ms                  |
| Optimize                  | 2.331 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 27.456 us                 | 41.031 ms                 |
| AfterBackward             | 54.341 ms                 | 1.097 s                   |
| BlockToStepN              | 57.988 ms                 | 247.441 ms                |
| OneStep                   | 179.155 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:33.400658 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240130 09:36:33.964470 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 09:36:34.254284 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240130 09:36:34.407917 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end6
E20240130 09:36:34.964433 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=8447
W20240130 09:36:35.254375 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240130 09:36:35.452674 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end2
E20240130 09:36:35.964015 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.445 ms                  | 16.238 ms                 |
| ProcessBack:UpdateCache   | 6.005 ms                  | 10.041 ms                 |
| ProcessBack:UpsertPq      | 23.701 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.156 ms                 | 1.097 s                   |
| BlockToStepN              | 57.500 ms                 | 247.321 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:36.263090 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240130 09:36:36.490258 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end8
E20240130 09:36:36.964012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=4590
W20240130 09:36:37.263448 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240130 09:36:37.513507 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
E20240130 09:36:37.964010 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=7690
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.576 ms                 | 380.718 ms                |
| Forward                   | 5.702 ms                  | 21.552 ms                 |
| Backward                  | 5.368 ms                  | 8.163 ms                  |
| Optimize                  | 2.307 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 27.160 us                 | 41.031 ms                 |
| AfterBackward             | 54.341 ms                 | 1.097 s                   |
| BlockToStepN              | 57.988 ms                 | 312.119 ms                |
| OneStep                   | 178.799 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:38.517464 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240130 09:36:38.602253 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end9
E20240130 09:36:38.964008 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=8918
W20240130 09:36:39.602248 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240130 09:36:39.714232 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end6
E20240130 09:36:39.964007 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=2264
W20240130 09:36:40.636431 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240130 09:36:40.821730 24422 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end2
E20240130 09:36:40.964010 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=5535
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.417 ms                  | 14.494 ms                 |
| ProcessBack:UpdateCache   | 6.084 ms                  | 10.025 ms                 |
| ProcessBack:UpsertPq      | 23.327 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.303 ms                 | 1.097 s                   |
| BlockToStepN              | 59.215 ms                 | 312.006 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:41.687786 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240130 09:36:41.848150 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
E20240130 09:36:41.964013 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=55754
[proc 2] 300 steps, total: 19.282, sample: 1.182, forward: 0.497, backward: 0.695, update: 0.215
[proc 5] 300 steps, total: 19.282, sample: 0.994, forward: 0.516, backward: 0.563, update: 0.236
[proc 4] 300 steps, total: 19.282, sample: 1.070, forward: 0.486, backward: 0.655, update: 0.221
[proc 0] 300 steps, total: 19.282, sample: 3.943, forward: 0.555, backward: 0.511, update: 0.228
[proc 3] 300 steps, total: 19.282, sample: 1.447, forward: 0.496, backward: 0.683, update: 0.265
[proc 1] 300 steps, total: 19.282, sample: 1.635, forward: 0.565, backward: 0.572, update: 0.260
W20240130 09:36:42.760493 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240130 09:36:42.952739 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240130 09:36:42.964004 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=9046
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.698 ms                 | 380.718 ms                |
| Forward                   | 5.691 ms                  | 21.552 ms                 |
| Backward                  | 5.331 ms                  | 8.163 ms                  |
| Optimize                  | 2.286 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 26.942 us                 | 41.031 ms                 |
| AfterBackward             | 54.195 ms                 | 1.097 s                   |
| BlockToStepN              | 58.301 ms                 | 312.119 ms                |
| OneStep                   | 178.263 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 09:36:43.964010 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=86879
W20240130 09:36:44.051337 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240130 09:36:44.081897 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240130 09:36:44.964012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=42647
W20240130 09:36:45.071110 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240130 09:36:45.113049 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end3
E20240130 09:36:45.964008 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=886
W20240130 09:36:46.124773 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.408 ms                  | 15.840 ms                 |
| ProcessBack:UpdateCache   | 6.182 ms                  | 10.025 ms                 |
| ProcessBack:UpsertPq      | 22.765 ms                 | 116.993 ms                |
| ProcessOneStep            | 53.993 ms                 | 1.097 s                   |
| BlockToStepN              | 59.544 ms                 | 330.245 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:46.131016 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=319, pq.top=319
E20240130 09:36:46.964016 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=68924
W20240130 09:36:47.131664 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240130 09:36:47.235373 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end6
E20240130 09:36:47.964010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=56925
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.982 ms                 | 380.718 ms                |
| Forward                   | 5.682 ms                  | 21.552 ms                 |
| Backward                  | 5.333 ms                  | 9.458 ms                  |
| Optimize                  | 2.286 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 26.942 us                 | 44.744 ms                 |
| AfterBackward             | 54.067 ms                 | 1.097 s                   |
| BlockToStepN              | 61.193 ms                 | 330.367 ms                |
| OneStep                   | 178.683 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:48.136435 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240130 09:36:48.267022 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
E20240130 09:36:48.964007 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=5686
W20240130 09:36:49.276307 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240130 09:36:49.445084 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end7
E20240130 09:36:49.964008 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=112974
W20240130 09:36:50.276074 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240130 09:36:50.653224 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
E20240130 09:36:50.964012 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=63958
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.401 ms                  | 14.494 ms                 |
| ProcessBack:UpdateCache   | 6.197 ms                  | 9.836 ms                  |
| ProcessBack:UpsertPq      | 22.540 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.303 ms                 | 1.097 s                   |
| BlockToStepN              | 61.123 ms                 | 336.140 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:51.277765 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240130 09:36:51.756101 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end8
E20240130 09:36:51.965720 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=175
W20240130 09:36:52.316308 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=351, pq.top=351
E20240130 09:36:52.965008 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=2876
W20240130 09:36:52.998687 24422 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.487 ms                 | 378.142 ms                |
| Forward                   | 5.682 ms                  | 17.042 ms                 |
| Backward                  | 5.355 ms                  | 8.163 ms                  |
| Optimize                  | 2.315 ms                  | 5.890 ms                  |
| BarrierTimeBeforeRank0    | 27.301 us                 | 45.385 ms                 |
| AfterBackward             | 54.341 ms                 | 1.086 s                   |
| BlockToStepN              | 61.250 ms                 | 330.367 ms                |
| OneStep                   | 176.901 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:53.320266 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240130 09:36:53.965008 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=13093
W20240130 09:36:54.244045 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end0
W20240130 09:36:54.838857 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240130 09:36:54.965009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=62284
W20240130 09:36:55.263113 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
W20240130 09:36:55.838423 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=370, pq.top=370
E20240130 09:36:55.966200 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=19726
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.395 ms                  | 16.238 ms                 |
| ProcessBack:UpdateCache   | 6.250 ms                  | 9.836 ms                  |
| ProcessBack:UpsertPq      | 22.276 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.156 ms                 | 1.085 s                   |
| BlockToStepN              | 60.687 ms                 | 330.245 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:56.271526 24422 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end0
W20240130 09:36:56.838521 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240130 09:36:56.966007 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240130 09:36:57.290359 24422 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end5
W20240130 09:36:57.838629 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=377, pq.top=377
E20240130 09:36:57.966024 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.616 ms                 | 378.142 ms                |
| Forward                   | 5.682 ms                  | 17.042 ms                 |
| Backward                  | 5.353 ms                  | 8.163 ms                  |
| Optimize                  | 2.308 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 27.384 us                 | 45.385 ms                 |
| AfterBackward             | 54.341 ms                 | 1.086 s                   |
| BlockToStepN              | 60.675 ms                 | 336.277 ms                |
| OneStep                   | 176.144 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:36:58.309973 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
W20240130 09:36:58.884996 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240130 09:36:58.966018 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=174060
W20240130 09:36:59.344054 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
W20240130 09:36:59.884373 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=389, pq.top=388
E20240130 09:36:59.966038 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=80594
W20240130 09:37:00.529098 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
E20240130 09:37:00.966017 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=15271
W20240130 09:37:00.979816 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=395, pq.top=395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.420 ms                  | 15.840 ms                 |
| ProcessBack:UpdateCache   | 6.275 ms                  | 9.740 ms                  |
| ProcessBack:UpsertPq      | 21.963 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.156 ms                 | 1.085 s                   |
| BlockToStepN              | 60.687 ms                 | 357.650 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 19.499, sample: 1.270, forward: 0.485, backward: 0.621, update: 0.230
[proc 1] 400 steps, total: 19.499, sample: 1.485, forward: 0.643, backward: 0.760, update: 0.285
[proc 5] 400 steps, total: 19.500, sample: 1.040, forward: 0.514, backward: 0.528, update: 0.239
[proc 2] 400 steps, total: 19.500, sample: 1.149, forward: 0.510, backward: 0.513, update: 0.218
[proc 4] 400 steps, total: 19.500, sample: 1.269, forward: 0.541, backward: 0.630, update: 0.252
[proc 0] 400 steps, total: 19.500, sample: 3.260, forward: 0.570, backward: 0.565, update: 0.256
W20240130 09:37:01.819437 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end1
E20240130 09:37:01.966014 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=24852
W20240130 09:37:01.979300 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240130 09:37:02.966010 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=47915
W20240130 09:37:02.979627 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240130 09:37:03.020635 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.487 ms                 | 378.142 ms                |
| Forward                   | 5.668 ms                  | 17.042 ms                 |
| Backward                  | 5.313 ms                  | 8.163 ms                  |
| Optimize                  | 2.307 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 27.301 us                 | 47.055 ms                 |
| AfterBackward             | 54.195 ms                 | 1.086 s                   |
| BlockToStepN              | 61.102 ms                 | 384.088 ms                |
| OneStep                   | 175.947 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 09:37:03.966012 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=65915
W20240130 09:37:03.979756 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240130 09:37:04.163789 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end3
E20240130 09:37:04.966012 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=21298
W20240130 09:37:04.979316 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240130 09:37:05.374274 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240130 09:37:05.966023 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=17863
W20240130 09:37:05.979955 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.470 ms                  | 15.840 ms                 |
| ProcessBack:UpdateCache   | 6.293 ms                  | 9.740 ms                  |
| ProcessBack:UpsertPq      | 21.423 ms                 | 110.846 ms                |
| ProcessOneStep            | 54.021 ms                 | 1.085 s                   |
| BlockToStepN              | 60.687 ms                 | 383.956 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:06.540254 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end4
E20240130 09:37:06.966010 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=10969
W20240130 09:37:06.979318 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240130 09:37:07.565701 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end9
E20240130 09:37:07.966010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=19899
W20240130 09:37:07.979521 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.234 ms                 | 378.142 ms                |
| Forward                   | 5.666 ms                  | 17.042 ms                 |
| Backward                  | 5.279 ms                  | 8.163 ms                  |
| Optimize                  | 2.315 ms                  | 6.926 ms                  |
| BarrierTimeBeforeRank0    | 27.969 us                 | 47.055 ms                 |
| AfterBackward             | 54.067 ms                 | 1.086 s                   |
| BlockToStepN              | 60.926 ms                 | 384.088 ms                |
| OneStep                   | 175.541 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:08.599509 24422 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
E20240130 09:37:08.966009 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=34848
W20240130 09:37:08.979338 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240130 09:37:09.602643 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
E20240130 09:37:09.966369 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=27800
W20240130 09:37:10.076400 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240130 09:37:10.715831 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end9
E20240130 09:37:10.966013 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=7954
W20240130 09:37:11.076419 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=450, pq.top=450
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.506 ms                  | 14.494 ms                 |
| ProcessBack:UpdateCache   | 6.321 ms                  | 9.544 ms                  |
| ProcessBack:UpsertPq      | 21.370 ms                 | 104.219 ms                |
| ProcessOneStep            | 53.993 ms                 | 1.085 s                   |
| BlockToStepN              | 61.096 ms                 | 383.956 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:11.950003 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end4
E20240130 09:37:11.966010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=52
W20240130 09:37:12.142558 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240130 09:37:12.966010 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=906
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.531 ms                 | 373.506 ms                |
| Forward                   | 5.650 ms                  | 12.097 ms                 |
| Backward                  | 5.231 ms                  | 7.588 ms                  |
| Optimize                  | 2.308 ms                  | 5.890 ms                  |
| BarrierTimeBeforeRank0    | 28.031 us                 | 45.385 ms                 |
| AfterBackward             | 54.195 ms                 | 905.178 ms                |
| BlockToStepN              | 61.250 ms                 | 384.088 ms                |
| OneStep                   | 175.541 ms                | 1.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:13.046468 24422 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end0
W20240130 09:37:13.142374 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240130 09:37:13.966014 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=10707
W20240130 09:37:14.142726 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240130 09:37:14.268711 24422 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
E20240130 09:37:14.966010 23920 parallel_pq_v2.h:76] insert failed, size(hashtable)=733
W20240130 09:37:15.178139 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=470, pq.top=470
W20240130 09:37:15.421083 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
E20240130 09:37:15.966207 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=7779
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.538 ms                  | 15.840 ms                 |
| ProcessBack:UpdateCache   | 6.341 ms                  | 9.836 ms                  |
| ProcessBack:UpsertPq      | 21.370 ms                 | 104.219 ms                |
| ProcessOneStep            | 54.156 ms                 | 904.877 ms                |
| BlockToStepN              | 61.614 ms                 | 396.461 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:16.196337 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=474, pq.top=473
W20240130 09:37:16.495730 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end6
E20240130 09:37:16.966009 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=3008
W20240130 09:37:17.231858 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=480, pq.top=479
W20240130 09:37:17.546053 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end2
E20240130 09:37:17.966008 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=116713
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.953 ms                 | 373.506 ms                |
| Forward                   | 5.650 ms                  | 12.097 ms                 |
| Backward                  | 5.204 ms                  | 7.588 ms                  |
| Optimize                  | 2.317 ms                  | 5.890 ms                  |
| BarrierTimeBeforeRank0    | 30.239 us                 | 45.385 ms                 |
| AfterBackward             | 54.195 ms                 | 905.178 ms                |
| BlockToStepN              | 61.250 ms                 | 396.586 ms                |
| OneStep                   | 175.541 ms                | 1.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:18.434468 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240130 09:37:18.599023 24422 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
E20240130 09:37:18.966013 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=120108
W20240130 09:37:19.434670 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240130 09:37:19.628559 24422 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
E20240130 09:37:19.966013 24422 parallel_pq_v2.h:76] insert failed, size(hashtable)=85858
W20240130 09:37:20.435175 23920 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240130 09:37:20.789175 24422 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
E20240130 09:37:20.966012 24421 parallel_pq_v2.h:76] insert failed, size(hashtable)=112965
[proc 4] 500 steps, total: 19.281, sample: 1.451, forward: 0.639, backward: 0.637, update: 0.295
[proc 5] 500 steps, total: 19.282, sample: 0.966, forward: 0.530, backward: 0.552, update: 0.328
[proc 0] 500 steps, total: 19.281, sample: 2.477, forward: 0.547, backward: 0.461, update: 0.228
[proc 1] 500 steps, total: 19.282, sample: 1.274, forward: 0.502, backward: 0.709, update: 0.215
[proc 3] 500 steps, total: 19.282, sample: 1.123, forward: 0.535, backward: 0.574, update: 0.222
[proc 2] 500 steps, total: 19.282, sample: 1.186, forward: 0.542, backward: 0.546, update: 0.235
Successfully xmh. training takes 107.787269115448 seconds
before call kg_cache_controller.StopThreads()
W20240130 09:37:20.999802 23920 grad_async_v2.h:71] call StopThreads. PID = 22429
W20240130 09:37:20.999836 23920 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 09:37:21.000288 23920 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 09:37:21.000303 23920 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.586 ms                  | 14.494 ms                 |
| ProcessBack:UpdateCache   | 6.349 ms                  | 9.784 ms                  |
| ProcessBack:UpsertPq      | 21.387 ms                 | 104.056 ms                |
| ProcessOneStep            | 54.156 ms                 | 904.877 ms                |
| BlockToStepN              | 62.416 ms                 | 396.461 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 09:37:21.527200 23920 grad_async_v2.h:92] StopThreads done.
