WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 19:42:37.168233 11059 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_10', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [11059 sampler.py:454] Start PreSampling
WARNING [11059 sampler.py:532] Before construct renumbering_dict
WARNING [11059 sampler.py:555] PreSampling done
W20240129 20:01:46.053763 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 20:01:46.053963 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 20:01:46.054003 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 20:01:46.054042 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 20:01:46.054080 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 20:01:46.054107 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 20:01:46.054136 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 20:01:46.054175 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 20:01:46.054208 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 20:01:46.054241 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 20:01:46.054280 11059 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 20:01:46.054311 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 20:01:46.054334 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 20:01:46.054491 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 20:01:46.054528 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 20:01:46.054563 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 20:01:46.054605 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 20:01:46.054637 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 20:01:46.054665 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 20:01:46.054698 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 20:01:46.054728 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 20:01:46.054766 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 20:01:46.054798 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 20:01:46.054824 11059 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 20:01:46.054847 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 20:01:46.054870 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 20:01:46.054929 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 20:01:46.054968 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 20:01:46.055001 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 20:01:46.055028 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 20:01:46.055053 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 20:01:46.055086 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 20:01:46.055114 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 20:01:46.055142 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 20:01:46.055167 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 20:01:46.055197 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 20:01:46.055223 11059 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 20:01:46.055245 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 20:01:46.055272 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 20:01:46.055335 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 20:01:46.055374 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 20:01:46.055400 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 20:01:46.055429 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 20:01:46.055464 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 20:01:46.055496 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 20:01:46.055524 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 20:01:46.055550 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 20:01:46.055583 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 20:01:46.055613 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 20:01:46.055639 11059 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 20:01:46.055661 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 20:01:46.055684 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 20:01:46.055739 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 20:01:46.055778 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 20:01:46.055804 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 20:01:46.055830 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 20:01:46.055862 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 20:01:46.055889 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 20:01:46.055924 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 20:01:46.055956 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 20:01:46.055989 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 20:01:46.056015 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 20:01:46.056046 11059 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 20:01:46.056079 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 20:01:46.056106 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 20:01:46.056155 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 20:01:46.056185 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 20:01:46.056216 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 20:01:46.056248 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 20:01:46.056277 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 20:01:46.056303 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 20:01:46.056332 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 20:01:46.056366 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 20:01:46.056396 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 20:01:46.056432 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 20:01:46.056460 11059 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 20:01:46.056483 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 20:01:46.056504 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 20:01:46.056560 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 20:01:46.056596 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 20:01:46.056628 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 20:01:46.056655 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 20:01:46.056684 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 20:01:46.056710 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 20:01:46.056744 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 20:01:46.056782 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 20:01:46.056810 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 20:01:46.056841 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 20:01:46.056874 11059 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 20:01:46.056897 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 20:01:46.056921 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 20:01:46.056972 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 20:01:46.057003 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 20:01:46.057032 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 20:01:46.057060 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 20:01:46.057092 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 20:01:46.057121 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 20:01:46.057158 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 20:01:46.057193 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 20:01:46.057227 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 20:01:46.057262 11059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 20:01:46.057294 11059 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 20:01:46.057317 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 20:01:46.057345 11059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 20:01:46.490980 11059 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240129 20:01:46.491137 11059 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302730,  4302761,    68753,  ..., 69198038, 48754539,  4940890]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1658.242 seconds
[Rank1] pid = 11995
[Rank2] pid = 12090
[Rank3] pid = 12159
[Rank4] pid = 12226
[Rank5] pid = 12293
[Rank6] pid = 12360
INFO [11059 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [11995 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12090 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12159 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [12226 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [12293 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12429 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [12360 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [12429 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12360 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12293 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12226 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [11995 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12090 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [12360 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [12429 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [11059 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [12293 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [12159 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [12090 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [11995 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [12226 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [12159 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [11059 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 20:10:27.003609 12441 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.003782 12430 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.003948 11996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.004118 12091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.004269 12361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.004424 12160 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.006548 12227 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:10:27.006724 12294 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240129 20:10:27.808976 12361 recstore.cc:66] init folly done
E20240129 20:10:27.809005 12091 recstore.cc:66] init folly done
E20240129 20:10:27.809023 11996 recstore.cc:66] init folly done
E20240129 20:10:27.809062 12294 recstore.cc:66] init folly done
E20240129 20:10:27.809504 12430 recstore.cc:66] init folly done
E20240129 20:10:27.809633 12160 recstore.cc:66] init folly done
E20240129 20:10:27.809649 12441 recstore.cc:66] init folly done
E20240129 20:10:27.809651 12227 recstore.cc:66] init folly done
I20240129 20:10:33.205899 12294 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240129 20:10:33.400545 12430 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:33.591907 12227 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:34.677650 12091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:35.625947 11996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:36.109815 12441 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:36.160715 12160 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:10:36.874343 12361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.205 ms                 | 21.205 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.041 ms                 | 92.830 ms                 |
| Forward                   | 11.141 ms                 | 640.807 ms                |
| Backward                  | 239.825 ms                | 462.820 ms                |
| Optimize                  | 3.579 ms                  | 5.387 ms                  |
| BarrierTimeBeforeRank0    | 39.589 ms                 | 319.005 ms                |
| BlockToStepN              | 33.115 us                 | 39.967 us                 |
| OneStep                   | 305.092 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.106 ms                  | 92.830 ms                 |
| Forward                   | 10.510 ms                 | 640.807 ms                |
| Backward                  | 239.825 ms                | 462.820 ms                |
| Optimize                  | 3.802 ms                  | 5.387 ms                  |
| BarrierTimeBeforeRank0    | 38.410 ms                 | 319.005 ms                |
| BlockToStepN              | 33.115 us                 | 21.476 ms                 |
| OneStep                   | 299.924 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.551 ms                  | 127.817 ms                |
| Forward                   | 10.529 ms                 | 640.807 ms                |
| Backward                  | 236.850 ms                | 462.820 ms                |
| Optimize                  | 3.802 ms                  | 5.387 ms                  |
| BarrierTimeBeforeRank0    | 38.410 ms                 | 319.005 ms                |
| BlockToStepN              | 33.115 us                 | 25.418 ms                 |
| OneStep                   | 298.400 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.203 ms                  | 103.011 ms                |
| Forward                   | 10.513 ms                 | 13.500 ms                 |
| Backward                  | 230.076 ms                | 462.820 ms                |
| Optimize                  | 3.324 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 42.414 ms                 | 260.285 ms                |
| BlockToStepN              | 33.747 us                 | 21.476 ms                 |
| OneStep                   | 297.103 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.687 ms                  | 103.011 ms                |
| Forward                   | 10.481 ms                 | 33.638 ms                 |
| Backward                  | 229.091 ms                | 462.820 ms                |
| Optimize                  | 3.153 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 43.527 ms                 | 319.005 ms                |
| BlockToStepN              | 34.440 us                 | 21.476 ms                 |
| OneStep                   | 296.149 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.915 ms                  | 103.011 ms                |
| Forward                   | 10.472 ms                 | 33.638 ms                 |
| Backward                  | 224.806 ms                | 462.820 ms                |
| Optimize                  | 3.127 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 46.376 ms                 | 319.005 ms                |
| BlockToStepN              | 34.440 us                 | 21.476 ms                 |
| OneStep                   | 289.448 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 36.460, sample: 1.806, forward: 2.746, backward: 24.121, update: 0.394
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 32.986, sample: 1.881, forward: 2.751, backward: 25.278, update: 0.433
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 36.268, sample: 1.809, forward: 2.739, backward: 24.357, update: 0.429
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 33.699, sample: 1.656, forward: 2.845, backward: 25.810, update: 0.362
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 35.182, sample: 1.482, forward: 2.646, backward: 21.779, update: 0.305
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 34.234, sample: 1.293, forward: 2.729, backward: 22.899, update: 0.447
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 36.654, sample: 1.536, forward: 2.762, backward: 25.267, update: 0.392
[Rank7] pid = 12429
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   45036,    45072,    45097,    45121,  5547845,   145927, 60041698,
        19899705, 18657306,    45140]) tensor([ 5036073, 16355367, 53372680, 67576812, 18209911, 35413793, 43992607,
        83399000, 74327844, 32389555])
-------Step 1-------
tensor([   45036,    45072,    45097,    45121,  5547845,   145927, 60041698,
        19899705, 18657306,    45140]) tensor([76785801, 31956858,  9839064, 80346591, 70067201, 46570020, 78325714,
        42632887, 41858131, 14020312])
-------Step 2-------
tensor([  108969,   108985,   109007,    23911,   109034,   109056,   109084,
        21678629,   109111,   109136]) tensor([79701663, 21330549, 72288647, 43433765, 36290223, 24360506, 76987445,
        46295428, 16384298, 45705733])
-------Step 3-------
tensor([  108969,   108985,   109007,    23911,   109034,   109056,   109084,
        21678629,   109111,   109136]) tensor([55161861, 85169445, 30069299, 41408457, 71006810, 58345078, 31453116,
        18206888, 29251470,   706701])
-------Step 4-------
tensor([  176098, 39466830,   176124,   184123,   176149,   184157,   176169,
        43383704,   176195,   176225]) tensor([83806414, 10394900, 85916987, 16220659, 78461207, 45717374, 72977297,
        40674556, 84903762, 52896105])
-------Step 5-------
tensor([  176098, 39466830,   176124,   184123,   176149,   184157,   176169,
        43383704,   176195,   176225]) tensor([30887482, 71031518,   217755, 82873724, 63430285, 61624513, 17107750,
         8925706, 62891222, 45108967])
-------Step 6-------
tensor([  240801,    61931,   240824,   240847,    61980, 79393182,   240875,
          240901,   202969, 39861889]) tensor([11884493, 32852555, 31211284, 74857885, 29259913, 44042117, 20990738,
         6337768, 77177949, 84227463])
-------Step 7-------
tensor([  240801,    61931,   240824,   240847,    61980, 79393182,   240875,
          240901,   202969, 39861889]) tensor([22076674, 47337827, 63401690, 51974194, 72615311, 44455718, 47875526,
        63480830, 30744248, 28263517])
-------Step 8-------
tensor([  304155, 26866424,   304183,   220981,   304223,    81069,   304253,
          304280,   304296,   304322]) tensor([48542005, 22594794, 38688991,  1905356, 44772891, 72219149, 16778234,
        78966020,  1565932, 56242493])
-------Step 9-------
tensor([  304155, 26866424,   304183,   220981,   304223,    81069,   304253,
          304280,   304296,   304322]) tensor([58464991, 39394090, 12488798, 48040536,  9540380, 35723406, 28946102,
        40541346, 76386890, 56302245])
before start barrier
start train
[proc 0] 100 steps, total: 33.750, sample: 1.345, forward: 1.721, backward: 23.032, update: 0.313
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.004 ms                  | 127.817 ms                |
| Forward                   | 10.472 ms                 | 33.638 ms                 |
| Backward                  | 225.364 ms                | 462.820 ms                |
| Optimize                  | 3.127 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 46.135 ms                 | 319.005 ms                |
| BlockToStepN              | 34.440 us                 | 21.476 ms                 |
| OneStep                   | 291.209 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.915 ms                  | 127.817 ms                |
| Forward                   | 10.481 ms                 | 33.638 ms                 |
| Backward                  | 224.582 ms                | 462.820 ms                |
| Optimize                  | 3.265 ms                  | 5.387 ms                  |
| BarrierTimeBeforeRank0    | 41.673 ms                 | 319.005 ms                |
| BlockToStepN              | 34.365 us                 | 21.476 ms                 |
| OneStep                   | 289.116 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.687 ms                  | 127.817 ms                |
| Forward                   | 10.509 ms                 | 33.638 ms                 |
| Backward                  | 224.806 ms                | 462.820 ms                |
| Optimize                  | 3.324 ms                  | 5.387 ms                  |
| BarrierTimeBeforeRank0    | 39.355 ms                 | 319.005 ms                |
| BlockToStepN              | 34.211 us                 | 21.476 ms                 |
| OneStep                   | 288.755 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.316 ms                  | 110.522 ms                |
| Forward                   | 10.526 ms                 | 16.145 ms                 |
| Backward                  | 225.310 ms                | 377.037 ms                |
| Optimize                  | 3.234 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 39.060 ms                 | 260.285 ms                |
| BlockToStepN              | 34.287 us                 | 13.502 ms                 |
| OneStep                   | 288.037 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.430 ms                  | 127.817 ms                |
| Forward                   | 10.527 ms                 | 16.145 ms                 |
| Backward                  | 225.364 ms                | 377.037 ms                |
| Optimize                  | 3.163 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 38.833 ms                 | 260.285 ms                |
| BlockToStepN              | 34.211 us                 | 14.690 ms                 |
| OneStep                   | 288.037 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.430 ms                  | 127.817 ms                |
| Forward                   | 10.529 ms                 | 16.145 ms                 |
| Backward                  | 225.310 ms                | 377.037 ms                |
| Optimize                  | 3.154 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 40.102 ms                 | 260.285 ms                |
| BlockToStepN              | 34.139 us                 | 14.690 ms                 |
| OneStep                   | 288.755 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 30.357, sample: 1.411, forward: 1.078, backward: 23.036, update: 0.348
[proc 3] 200 steps, total: 30.357, sample: 1.414, forward: 1.958, backward: 24.824, update: 0.317
[proc 2] 200 steps, total: 30.357, sample: 1.335, forward: 1.719, backward: 22.520, update: 0.307
[proc 6] 200 steps, total: 30.357, sample: 1.457, forward: 1.982, backward: 23.362, update: 0.386
[proc 1] 200 steps, total: 30.357, sample: 1.213, forward: 1.834, backward: 23.077, update: 0.409
[proc 5] 200 steps, total: 30.357, sample: 1.681, forward: 1.896, backward: 23.363, update: 0.335
[proc 4] 200 steps, total: 30.357, sample: 1.499, forward: 1.816, backward: 23.109, update: 0.418
[proc 7] 200 steps, total: 30.357, sample: 1.966, forward: 1.860, backward: 22.567, update: 0.419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.390 ms                  | 127.817 ms                |
| Forward                   | 10.527 ms                 | 33.638 ms                 |
| Backward                  | 225.079 ms                | 413.513 ms                |
| Optimize                  | 3.129 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 41.051 ms                 | 260.285 ms                |
| BlockToStepN              | 33.829 us                 | 14.690 ms                 |
| OneStep                   | 289.507 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.111 ms                  | 127.817 ms                |
| Forward                   | 10.513 ms                 | 33.638 ms                 |
| Backward                  | 224.806 ms                | 413.513 ms                |
| Optimize                  | 3.085 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 41.051 ms                 | 260.285 ms                |
| BlockToStepN              | 33.699 us                 | 16.649 ms                 |
| OneStep                   | 289.507 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.121 ms                  | 131.966 ms                |
| Forward                   | 10.540 ms                 | 33.638 ms                 |
| Backward                  | 224.435 ms                | 413.513 ms                |
| Optimize                  | 3.057 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 40.101 ms                 | 260.285 ms                |
| BlockToStepN              | 33.585 us                 | 16.649 ms                 |
| OneStep                   | 288.755 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.145 ms                  | 127.817 ms                |
| Forward                   | 10.564 ms                 | 27.085 ms                 |
| Backward                  | 225.310 ms                | 413.513 ms                |
| Optimize                  | 3.110 ms                  | 5.104 ms                  |
| BarrierTimeBeforeRank0    | 38.833 ms                 | 225.127 ms                |
| BlockToStepN              | 33.610 us                 | 14.690 ms                 |
| OneStep                   | 287.550 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.072 ms                  | 127.817 ms                |
| Forward                   | 10.574 ms                 | 27.085 ms                 |
| Backward                  | 225.394 ms                | 413.513 ms                |
| Optimize                  | 3.061 ms                  | 5.104 ms                  |
| BarrierTimeBeforeRank0    | 37.915 ms                 | 225.127 ms                |
| BlockToStepN              | 33.439 us                 | 14.690 ms                 |
| OneStep                   | 286.652 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.933 ms                  | 127.817 ms                |
| Forward                   | 10.599 ms                 | 27.085 ms                 |
| Backward                  | 226.395 ms                | 413.513 ms                |
| Optimize                  | 3.033 ms                  | 5.104 ms                  |
| BarrierTimeBeforeRank0    | 36.301 ms                 | 225.127 ms                |
| BlockToStepN              | 33.288 us                 | 16.649 ms                 |
| OneStep                   | 286.283 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 29.784, sample: 1.143, forward: 1.837, backward: 21.967, update: 0.309
[proc 3] 300 steps, total: 29.784, sample: 1.150, forward: 2.088, backward: 24.476, update: 0.314
[proc 6] 300 steps, total: 29.784, sample: 1.210, forward: 1.970, backward: 23.338, update: 0.337
[proc 1] 300 steps, total: 29.784, sample: 0.997, forward: 2.006, backward: 23.034, update: 0.354
[proc 0] 300 steps, total: 29.784, sample: 1.311, forward: 1.158, backward: 23.559, update: 0.307
[proc 7] 300 steps, total: 29.784, sample: 1.361, forward: 1.766, backward: 22.292, update: 0.425
[proc 4] 300 steps, total: 29.784, sample: 1.118, forward: 1.902, backward: 23.448, update: 0.417
[proc 5] 300 steps, total: 29.784, sample: 1.172, forward: 1.845, backward: 23.975, update: 0.310
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.072 ms                  | 131.966 ms                |
| Forward                   | 10.620 ms                 | 33.638 ms                 |
| Backward                  | 226.925 ms                | 413.513 ms                |
| Optimize                  | 3.085 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 34.928 ms                 | 225.127 ms                |
| BlockToStepN              | 33.115 us                 | 16.649 ms                 |
| OneStep                   | 285.768 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.121 ms                  | 131.966 ms                |
| Forward                   | 10.660 ms                 | 33.638 ms                 |
| Backward                  | 226.748 ms                | 413.513 ms                |
| Optimize                  | 3.135 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 34.716 ms                 | 225.127 ms                |
| BlockToStepN              | 32.647 us                 | 16.649 ms                 |
| OneStep                   | 283.851 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.040 ms                  | 131.966 ms                |
| Forward                   | 10.668 ms                 | 33.638 ms                 |
| Backward                  | 227.176 ms                | 413.513 ms                |
| Optimize                  | 3.185 ms                  | 5.271 ms                  |
| BarrierTimeBeforeRank0    | 34.622 ms                 | 260.285 ms                |
| BlockToStepN              | 32.628 us                 | 16.649 ms                 |
| OneStep                   | 283.722 ms                | 759.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.975 ms                  | 127.817 ms                |
| Forward                   | 10.708 ms                 | 27.085 ms                 |
| Backward                  | 226.748 ms                | 391.939 ms                |
| Optimize                  | 3.243 ms                  | 5.246 ms                  |
| BarrierTimeBeforeRank0    | 34.140 ms                 | 225.127 ms                |
| BlockToStepN              | 32.628 us                 | 16.649 ms                 |
| OneStep                   | 283.528 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.040 ms                  | 127.817 ms                |
| Forward                   | 10.725 ms                 | 27.085 ms                 |
| Backward                  | 226.404 ms                | 391.939 ms                |
| Optimize                  | 3.269 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 34.131 ms                 | 225.127 ms                |
| BlockToStepN              | 32.578 us                 | 16.649 ms                 |
| OneStep                   | 283.468 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.072 ms                  | 127.817 ms                |
| Forward                   | 10.740 ms                 | 27.085 ms                 |
| Backward                  | 225.889 ms                | 391.939 ms                |
| Optimize                  | 3.354 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 34.928 ms                 | 225.127 ms                |
| BlockToStepN              | 32.479 us                 | 16.649 ms                 |
| OneStep                   | 285.557 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 30.757, sample: 1.002, forward: 1.783, backward: 22.120, update: 0.323
[proc 5] 400 steps, total: 30.756, sample: 0.973, forward: 1.882, backward: 23.327, update: 0.304
[proc 6] 400 steps, total: 30.756, sample: 1.211, forward: 1.910, backward: 23.196, update: 0.349
[proc 7] 400 steps, total: 30.756, sample: 1.137, forward: 1.914, backward: 23.331, update: 0.431
[proc 1] 400 steps, total: 30.757, sample: 0.988, forward: 1.849, backward: 23.135, update: 0.383
[proc 0] 400 steps, total: 30.757, sample: 1.299, forward: 1.152, backward: 23.360, update: 0.409
[proc 4] 400 steps, total: 30.756, sample: 1.230, forward: 2.057, backward: 24.838, update: 0.422
[proc 3] 400 steps, total: 30.757, sample: 1.133, forward: 1.899, backward: 24.230, update: 0.346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.072 ms                  | 127.817 ms                |
| Forward                   | 10.762 ms                 | 27.085 ms                 |
| Backward                  | 225.943 ms                | 413.513 ms                |
| Optimize                  | 3.512 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 34.987 ms                 | 235.992 ms                |
| BlockToStepN              | 32.460 us                 | 16.649 ms                 |
| OneStep                   | 285.807 ms                | 759.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.989 ms                  | 127.817 ms                |
| Forward                   | 10.770 ms                 | 27.085 ms                 |
| Backward                  | 225.889 ms                | 413.513 ms                |
| Optimize                  | 3.587 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 35.244 ms                 | 235.992 ms                |
| BlockToStepN              | 32.333 us                 | 16.649 ms                 |
| OneStep                   | 285.689 ms                | 759.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.111 ms                  | 127.817 ms                |
| Forward                   | 10.795 ms                 | 27.085 ms                 |
| Backward                  | 225.992 ms                | 413.513 ms                |
| Optimize                  | 3.673 ms                  | 6.291 ms                  |
| BarrierTimeBeforeRank0    | 34.854 ms                 | 235.992 ms                |
| BlockToStepN              | 32.395 us                 | 16.649 ms                 |
| OneStep                   | 284.181 ms                | 759.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.134 ms                  | 113.796 ms                |
| Forward                   | 10.811 ms                 | 26.018 ms                 |
| Backward                  | 226.019 ms                | 391.939 ms                |
| Optimize                  | 3.764 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 34.140 ms                 | 225.127 ms                |
| BlockToStepN              | 32.416 us                 | 14.690 ms                 |
| OneStep                   | 283.528 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.121 ms                  | 113.796 ms                |
| Forward                   | 10.823 ms                 | 26.018 ms                 |
| Backward                  | 226.345 ms                | 391.939 ms                |
| Optimize                  | 3.884 ms                  | 5.488 ms                  |
| BarrierTimeBeforeRank0    | 33.858 ms                 | 225.127 ms                |
| BlockToStepN              | 32.464 us                 | 14.690 ms                 |
| OneStep                   | 283.465 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.121 ms                  | 113.796 ms                |
| Forward                   | 10.847 ms                 | 26.018 ms                 |
| Backward                  | 226.404 ms                | 391.939 ms                |
| Optimize                  | 4.045 ms                  | 6.291 ms                  |
| BarrierTimeBeforeRank0    | 33.651 ms                 | 225.127 ms                |
| BlockToStepN              | 32.416 us                 | 14.690 ms                 |
| OneStep                   | 283.048 ms                | 629.718 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 28.712, sample: 1.046, forward: 1.762, backward: 15.015, update: 0.363
[proc 3] 500 steps, total: 28.712, sample: 1.191, forward: 1.810, backward: 23.876, update: 0.378
[proc 6] 500 steps, total: 28.713, sample: 1.314, forward: 1.899, backward: 23.205, update: 0.395
[proc 5] 500 steps, total: 28.713, sample: 1.055, forward: 1.763, backward: 23.002, update: 0.324
[proc 7] 500 steps, total: 28.712, sample: 1.025, forward: 1.815, backward: 22.419, update: 0.422
[proc 2] 500 steps, total: 28.713, sample: 0.980, forward: 1.687, backward: 19.391, update: 0.301
[proc 0] 500 steps, total: 28.712, sample: 1.166, forward: 1.155, backward: 22.941, update: 0.399
[proc 1] 500 steps, total: 28.713, sample: 1.121, forward: 1.786, backward: 23.177, update: 0.419
Successfully xmh. training takes 153.36083889007568 seconds
before call kg_cache_controller.StopThreads()
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
INFO [11059 controller_process.py:421] call rank0 to StopThreads
