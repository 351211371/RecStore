WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 07:56:39.425262 42487 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_30', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [42487 sampler.py:454] Start PreSampling
WARNING [42487 sampler.py:532] Before construct renumbering_dict
WARNING [42487 sampler.py:555] PreSampling done
W20240130 08:14:28.072137 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 08:14:28.072364 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 08:14:28.072404 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 08:14:28.072433 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 08:14:28.072466 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 08:14:28.072505 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 08:14:28.072540 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 08:14:28.072578 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 08:14:28.072613 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 08:14:28.072650 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 08:14:28.072690 42487 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 08:14:28.072716 42487 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 08:14:28.072741 42487 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 08:14:28.072911 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 08:14:28.072957 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 08:14:28.072984 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 08:14:28.073024 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 08:14:28.073050 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 08:14:28.073087 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 08:14:28.073119 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 08:14:28.073151 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 08:14:28.073185 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 08:14:28.073228 42487 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 08:14:28.073253 42487 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 08:14:28.073276 42487 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 08:14:28.073299 42487 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 08:14:28.522313 42487 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000098ca000 128.2 GB
W20240130 08:14:28.522468 42487 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102018502000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4302749,  4302794,   644459,  ..., 21916534, 34486591, 77141667]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1580.933 seconds
INFO [6245 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [42487 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [42487 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [6245 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING [42487 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [6245 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 08:23:03.048192  6247 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240130 08:23:03.048286  6310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
E20240130 08:23:03.266569  6310 recstore.cc:66] init folly done
E20240130 08:23:03.266582  6247 recstore.cc:66] init folly done
I20240130 08:23:28.354763  6310 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240130 08:23:29.490765  6247 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.231 ms                 | 103.945 ms                |
| Forward                   | 8.665 ms                  | 599.324 ms                |
| Backward                  | 197.478 ms                | 396.089 ms                |
| Optimize                  | 4.117 ms                  | 6.343 ms                  |
| BarrierTimeBeforeRank0    | 15.422 ms                 | 36.458 ms                 |
| BlockToStepN              | 24.435 us                 | 72.119 us                 |
| OneStep                   | 242.114 ms                | 1.022 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.656 ms                 | 112.108 ms                |
| Forward                   | 8.632 ms                  | 599.324 ms                |
| Backward                  | 192.279 ms                | 396.089 ms                |
| Optimize                  | 3.481 ms                  | 6.343 ms                  |
| BarrierTimeBeforeRank0    | 6.913 ms                  | 36.458 ms                 |
| BlockToStepN              | 28.792 us                 | 72.119 us                 |
| OneStep                   | 233.475 ms                | 1.022 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.117 ms                 | 103.945 ms                |
| Forward                   | 8.902 ms                  | 11.699 ms                 |
| Backward                  | 193.353 ms                | 396.089 ms                |
| Optimize                  | 3.491 ms                  | 5.368 ms                  |
| BarrierTimeBeforeRank0    | 1.061 ms                  | 30.741 ms                 |
| BlockToStepN              | 28.792 us                 | 37.102 us                 |
| OneStep                   | 229.699 ms                | 635.109 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.191 ms                 | 103.945 ms                |
| Forward                   | 9.016 ms                  | 12.337 ms                 |
| Backward                  | 193.297 ms                | 396.089 ms                |
| Optimize                  | 3.439 ms                  | 6.343 ms                  |
| BarrierTimeBeforeRank0    | 121.891 us                | 36.458 ms                 |
| BlockToStepN              | 27.580 us                 | 37.102 us                 |
| OneStep                   | 230.436 ms                | 635.109 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.035 ms                 | 103.945 ms                |
| Forward                   | 9.059 ms                  | 13.779 ms                 |
| Backward                  | 193.991 ms                | 396.089 ms                |
| Optimize                  | 3.491 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 89.382 us                 | 36.458 ms                 |
| BlockToStepN              | 27.580 us                 | 37.102 us                 |
| OneStep                   | 228.791 ms                | 635.109 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.059, sample: 1.978, forward: 2.759, backward: 18.824, update: 0.351
[Rank1] pid = 6245
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
train_sampler.Prefill()
-------Step 0-------
tensor([1212506, 1212538, 1212568, 1584805, 1212593, 1212615, 1212644,   16171,
        1212686, 1212710]) tensor([  169731,  4629772, 19105733, 42580372, 38861106, 17458098, 79584866,
         9195306, 43462580, 72841203])
-------Step 1-------
tensor([1212506, 1212538, 1212568, 1584805, 1212593, 1212615, 1212644,   16171,
        1212686, 1212710]) tensor([76968397, 72220002, 76199403, 45751503, 36904380,   199066, 32391498,
        59674651, 66193251, 69124294])
-------Step 2-------
tensor([1295833, 1295859, 1295881, 1295914, 1295946, 1295971, 1296003, 1296028,
        1594345, 1296064]) tensor([18407967, 17505748, 36199996, 78833440, 30621346,  1995562, 34071071,
        54787267, 72805534, 13991067])
-------Step 3-------
tensor([1295833, 1295859, 1295881, 1295914, 1295946, 1295971, 1296003, 1296028,
        1594345, 1296064]) tensor([43373639, 72736362,  2304534, 31655513, 48817893, 47734085, 37276218,
        42075347, 57983981, 21608362])
-------Step 4-------
tensor([ 1379962,  1379994,   259065,  1380031,   259093, 61030617,  1080400,
         1380058,  1380086,  1380114]) tensor([  796104, 68594145, 24324574, 31139854, 84570901, 48013351, 44792861,
        27116641, 30113217, 43915768])
-------Step 5-------
tensor([ 1379962,  1379994,   259065,  1380031,   259093, 61030617,  1080400,
         1380058,  1380086,  1380114]) tensor([44298974, 40926954, 63937559, 14809701, 21112084, 60325630, 44277918,
        11568731, 62583533, 83136337])
-------Step 6-------
tensor([ 1462478,  1462506,  1462534,   449888,  1462571,  1462597,  1462623,
        16793685,  1462657,  4339837]) tensor([14677504, 36463900,  5860256,  1544587, 19403730, 18517590,  2774247,
         1883261, 70362244, 19394704])
-------Step 7-------
tensor([ 1462478,  1462506,  1462534,   449888,  1462571,  1462597,  1462623,
        16793685,  1462657,  4339837]) tensor([75066653, 64939643, 56579237,  2031127, 10101838, 43805329, 76947997,
        76411170, 55426175, 10588810])
-------Step 8-------
tensor([1551436, 1551459, 1551488,  452745, 1551522, 1551542, 1551574,  261391,
        1551597, 1551628]) tensor([69512983, 69475019,   482670,  4361669, 37481174, 29718625, 61381744,
        71131726, 41879182, 21935586])
-------Step 9-------
tensor([1551436, 1551459, 1551488,  452745, 1551522, 1551542, 1551574,  261391,
        1551597, 1551628]) tensor([  651047, 43723072, 21544917, 57665421, 38665841,  1718484, 22627082,
        42282233, 24728967, 77629227])
before start barrier
start train
[proc 0] 100 steps, total: 24.922, sample: 1.944, forward: 1.532, backward: 20.334, update: 0.356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.066 ms                 | 103.945 ms                |
| Forward                   | 9.059 ms                  | 13.779 ms                 |
| Backward                  | 194.116 ms                | 396.089 ms                |
| Optimize                  | 3.439 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 236.434 us                | 36.458 ms                 |
| BlockToStepN              | 27.829 us                 | 40.276 us                 |
| OneStep                   | 227.358 ms                | 635.109 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.350 ms                 | 103.945 ms                |
| Forward                   | 9.313 ms                  | 13.779 ms                 |
| Backward                  | 194.161 ms                | 396.089 ms                |
| Optimize                  | 3.479 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 85.589 us                 | 117.899 ms                |
| BlockToStepN              | 27.591 us                 | 45.008 us                 |
| OneStep                   | 226.570 ms                | 635.109 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.683 ms                  | 103.945 ms                |
| Forward                   | 9.551 ms                  | 13.779 ms                 |
| Backward                  | 194.876 ms                | 324.375 ms                |
| Optimize                  | 3.600 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 72.342 us                 | 36.458 ms                 |
| BlockToStepN              | 27.591 us                 | 43.392 us                 |
| OneStep                   | 226.776 ms                | 430.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.872 ms                  | 108.790 ms                |
| Forward                   | 9.581 ms                  | 15.029 ms                 |
| Backward                  | 194.992 ms                | 324.375 ms                |
| Optimize                  | 3.698 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 70.571 us                 | 36.458 ms                 |
| BlockToStepN              | 27.650 us                 | 43.392 us                 |
| OneStep                   | 226.483 ms                | 430.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.066 ms                 | 108.790 ms                |
| Forward                   | 9.607 ms                  | 15.029 ms                 |
| Backward                  | 195.240 ms                | 334.736 ms                |
| Optimize                  | 4.025 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 72.342 us                 | 73.494 ms                 |
| BlockToStepN              | 27.668 us                 | 43.392 us                 |
| OneStep                   | 226.483 ms                | 430.425 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 23.817, sample: 1.899, forward: 1.016, backward: 20.068, update: 0.373
[proc 1] 200 steps, total: 23.817, sample: 1.871, forward: 1.807, backward: 18.716, update: 0.373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.073 ms                 | 108.790 ms                |
| Forward                   | 9.742 ms                  | 16.716 ms                 |
| Backward                  | 195.306 ms                | 334.736 ms                |
| Optimize                  | 4.135 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 62.387 us                 | 73.494 ms                 |
| BlockToStepN              | 27.580 us                 | 43.392 us                 |
| OneStep                   | 226.161 ms                | 430.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.073 ms                 | 108.790 ms                |
| Forward                   | 9.901 ms                  | 16.716 ms                 |
| Backward                  | 195.306 ms                | 334.736 ms                |
| Optimize                  | 4.167 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 60.822 us                 | 73.494 ms                 |
| BlockToStepN              | 27.488 us                 | 43.392 us                 |
| OneStep                   | 226.161 ms                | 430.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.334 ms                 | 107.509 ms                |
| Forward                   | 9.925 ms                  | 15.029 ms                 |
| Backward                  | 195.600 ms                | 324.375 ms                |
| Optimize                  | 4.198 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 61.136 us                 | 73.494 ms                 |
| BlockToStepN              | 27.580 us                 | 41.018 us                 |
| OneStep                   | 226.335 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.350 ms                 | 107.509 ms                |
| Forward                   | 9.982 ms                  | 15.029 ms                 |
| Backward                  | 195.987 ms                | 324.375 ms                |
| Optimize                  | 4.214 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 61.672 us                 | 73.494 ms                 |
| BlockToStepN              | 27.668 us                 | 43.392 us                 |
| OneStep                   | 226.384 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 23.804, sample: 1.496, forward: 1.735, backward: 18.735, update: 0.388
[proc 0] 300 steps, total: 23.804, sample: 1.799, forward: 1.071, backward: 20.244, update: 0.406
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.066 ms                 | 108.790 ms                |
| Forward                   | 10.013 ms                 | 15.029 ms                 |
| Backward                  | 196.326 ms                | 333.660 ms                |
| Optimize                  | 4.214 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 61.136 us                 | 73.494 ms                 |
| BlockToStepN              | 27.796 us                 | 55.240 us                 |
| OneStep                   | 226.038 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.066 ms                 | 108.790 ms                |
| Forward                   | 10.013 ms                 | 16.518 ms                 |
| Backward                  | 196.618 ms                | 333.660 ms                |
| Optimize                  | 4.214 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 60.729 us                 | 88.206 ms                 |
| BlockToStepN              | 27.745 us                 | 72.119 us                 |
| OneStep                   | 226.401 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.073 ms                 | 108.790 ms                |
| Forward                   | 10.013 ms                 | 16.518 ms                 |
| Backward                  | 196.707 ms                | 334.736 ms                |
| Optimize                  | 4.217 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 60.729 us                 | 88.206 ms                 |
| BlockToStepN              | 27.668 us                 | 72.119 us                 |
| OneStep                   | 226.570 ms                | 394.193 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.150 ms                 | 108.790 ms                |
| Forward                   | 10.059 ms                 | 15.029 ms                 |
| Backward                  | 197.283 ms                | 333.660 ms                |
| Optimize                  | 4.217 ms                  | 7.567 ms                  |
| BarrierTimeBeforeRank0    | 60.090 us                 | 73.494 ms                 |
| BlockToStepN              | 27.580 us                 | 64.354 us                 |
| OneStep                   | 228.004 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.148 ms                 | 108.790 ms                |
| Forward                   | 10.134 ms                 | 15.029 ms                 |
| Backward                  | 197.404 ms                | 333.660 ms                |
| Optimize                  | 4.218 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.895 us                 | 73.494 ms                 |
| BlockToStepN              | 27.492 us                 | 64.354 us                 |
| OneStep                   | 228.583 ms                | 364.280 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 26.004, sample: 1.280, forward: 1.545, backward: 18.447, update: 0.320
[proc 0] 400 steps, total: 26.005, sample: 1.876, forward: 1.055, backward: 22.360, update: 0.394
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.150 ms                 | 110.570 ms                |
| Forward                   | 10.134 ms                 | 15.029 ms                 |
| Backward                  | 197.710 ms                | 334.736 ms                |
| Optimize                  | 4.217 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.808 us                 | 88.206 ms                 |
| BlockToStepN              | 27.469 us                 | 67.228 us                 |
| OneStep                   | 229.390 ms                | 373.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.858 ms                  | 110.570 ms                |
| Forward                   | 10.078 ms                 | 15.029 ms                 |
| Backward                  | 197.573 ms                | 334.736 ms                |
| Optimize                  | 4.202 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.895 us                 | 88.206 ms                 |
| BlockToStepN              | 27.498 us                 | 72.119 us                 |
| OneStep                   | 229.600 ms                | 373.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.872 ms                  | 110.570 ms                |
| Forward                   | 10.077 ms                 | 16.518 ms                 |
| Backward                  | 197.822 ms                | 339.291 ms                |
| Optimize                  | 4.193 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.533 us                 | 88.206 ms                 |
| BlockToStepN              | 27.456 us                 | 72.119 us                 |
| OneStep                   | 229.966 ms                | 378.543 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.663 ms                  | 108.790 ms                |
| Forward                   | 10.096 ms                 | 16.518 ms                 |
| Backward                  | 198.239 ms                | 334.736 ms                |
| Optimize                  | 4.191 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.444 us                 | 88.206 ms                 |
| BlockToStepN              | 27.412 us                 | 70.373 us                 |
| OneStep                   | 230.976 ms                | 373.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.822 ms                  | 108.790 ms                |
| Forward                   | 10.053 ms                 | 16.518 ms                 |
| Backward                  | 198.385 ms                | 334.736 ms                |
| Optimize                  | 4.179 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.273 us                 | 88.206 ms                 |
| BlockToStepN              | 27.375 us                 | 70.373 us                 |
| OneStep                   | 231.385 ms                | 376.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.663 ms                  | 108.790 ms                |
| Forward                   | 10.043 ms                 | 16.518 ms                 |
| Backward                  | 199.023 ms                | 339.291 ms                |
| Optimize                  | 4.175 ms                  | 7.603 ms                  |
| BarrierTimeBeforeRank0    | 59.185 us                 | 88.206 ms                 |
| BlockToStepN              | 27.372 us                 | 72.119 us                 |
| OneStep                   | 232.792 ms                | 378.543 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 25.072, sample: 1.368, forward: 1.554, backward: 18.842, update: 0.375
[proc 0] 500 steps, total: 25.072, sample: 1.568, forward: 1.001, backward: 21.713, update: 0.312
Successfully xmh. training takes 123.62045788764954 seconds
before call kg_cache_controller.StopThreads()
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
INFO [42487 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
