WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 13:25:55.643982 65447 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_27', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [65447 sampler.py:454] Start PreSampling
WARNING [65447 sampler.py:532] Before construct renumbering_dict
WARNING [65447 sampler.py:555] PreSampling done
W20240129 13:26:01.226097 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 13:26:01.226321 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 13:26:01.226361 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 13:26:01.226397 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 13:26:01.226433 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 13:26:01.226465 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 13:26:01.226495 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 13:26:01.226560 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 13:26:01.226593 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 13:26:01.226627 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 13:26:01.226675 65447 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 13:26:01.226712 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 13:26:01.226738 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 13:26:01.226956 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 13:26:01.226997 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 13:26:01.227034 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 13:26:01.227097 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 13:26:01.227141 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 13:26:01.227177 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 13:26:01.227214 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 13:26:01.227252 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 13:26:01.227285 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 13:26:01.227329 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 13:26:01.227368 65447 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 13:26:01.227393 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 13:26:01.227429 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 13:26:01.227496 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 13:26:01.227536 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 13:26:01.227568 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 13:26:01.227605 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 13:26:01.227645 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 13:26:01.227690 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 13:26:01.227734 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 13:26:01.227782 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 13:26:01.227824 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 13:26:01.227855 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 13:26:01.227883 65447 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 13:26:01.227908 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 13:26:01.227933 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 13:26:01.228003 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 13:26:01.228039 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 13:26:01.228078 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 13:26:01.228138 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 13:26:01.228175 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 13:26:01.228214 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 13:26:01.228248 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 13:26:01.228279 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 13:26:01.228317 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 13:26:01.228348 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 13:26:01.228385 65447 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 13:26:01.228415 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 13:26:01.228451 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 13:26:01.228516 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 13:26:01.228549 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 13:26:01.228577 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 13:26:01.228615 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 13:26:01.228644 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 13:26:01.228673 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 13:26:01.228720 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 13:26:01.228760 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 13:26:01.228801 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 13:26:01.228829 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 13:26:01.228858 65447 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 13:26:01.228884 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 13:26:01.228909 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 13:26:01.228960 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 13:26:01.229018 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 13:26:01.229058 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 13:26:01.229086 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 13:26:01.229121 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 13:26:01.229156 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 13:26:01.229195 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 13:26:01.229233 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 13:26:01.229269 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 13:26:01.229298 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 13:26:01.229326 65447 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 13:26:01.229351 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 13:26:01.229375 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 13:26:01.229429 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 13:26:01.229465 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 13:26:01.229499 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 13:26:01.229529 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 13:26:01.229561 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 13:26:01.229596 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 13:26:01.229625 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 13:26:01.229666 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 13:26:01.229696 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 13:26:01.229736 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 13:26:01.229780 65447 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 13:26:01.229806 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 13:26:01.229831 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 13:26:01.229885 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 13:26:01.229923 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 13:26:01.229952 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 13:26:01.229987 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 13:26:01.230017 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 13:26:01.230062 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 13:26:01.230103 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 13:26:01.230142 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 13:26:01.230172 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 13:26:01.230206 65447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 13:26:01.230237 65447 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 13:26:01.230262 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 13:26:01.230297 65447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 13:26:01.430483 65447 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240129 13:26:01.430624 65447 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([1501, 1897, 2327,  ..., 9129, 9698, 7249]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.819 seconds
[Rank1] pid = 861
[Rank2] pid = 928
[Rank3] pid = 1000
[Rank4] pid = 1069
[Rank5] pid = 1135
[Rank6] pid = 1146
INFO [65447 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [861 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [928 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1069 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [1000 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1135 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [1146 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [1345 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [928 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1135 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65447 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1146 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1069 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1345 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1000 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [861 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [65447 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1000 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1135 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [861 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1345 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [928 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1146 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1069 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 13:26:04.019984  1346 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020056  1001 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020107   929 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020159  1143 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020206  1072 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020253  1347 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020303  1279 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 13:26:04.020350   862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240129 13:26:04.865031  1001 recstore.cc:66] init folly done
E20240129 13:26:04.865073   929 recstore.cc:66] init folly done
E20240129 13:26:04.865113  1279 recstore.cc:66] init folly done
E20240129 13:26:04.865121  1346 recstore.cc:66] init folly done
E20240129 13:26:04.865113  1347 recstore.cc:66] init folly done
E20240129 13:26:04.865140  1143 recstore.cc:66] init folly done
E20240129 13:26:04.865144  1072 recstore.cc:66] init folly done
E20240129 13:26:04.865232   862 recstore.cc:66] init folly done
I20240129 13:26:04.929014   862 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240129 13:26:04.930799  1279 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.932034  1001 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.932216  1143 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.932665   929 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.932713  1347 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.933735  1072 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 13:26:04.935777  1346 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.743 ms                  | 3.496 ms                  |
| bucket keys               | 2.572 ms                  | 206.417 ms                |
| forward: a2a keys         | 2.595 ms                  | 1.462 s                   |
| forward: search cache     | 479.723 us                | 23.823 ms                 |
| forward: a2a values       | 5.139 ms                  | 14.723 ms                 |
| forward: join             | 1.499 ms                  | 2.610 ms                  |
| Forward                   | 35.652 ms                 | 2.285 s                   |
| back: aggr dram keys      | 35.378 ms                 | 986.081 ms                |
| back: set dram grad       | 1.952 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.381 ms                  | 22.371 ms                 |
| back: grad sum & grad cache  | 6.244 ms                  | 15.767 ms                 |
| Backward                  | 108.306 ms                | 1.258 s                   |
| Optimize                  | 14.163 ms                 | 19.263 ms                 |
| BarrierTimeBeforeRank0    | 81.922 us                 | 295.330 us                |
| BlockToStepN              | 29.928 us                 | 172.948 us                |
| OneStep                   | 160.013 ms                | 3.566 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.430 ms                  | 23.328 ms                 |
| bucket keys               | 2.558 ms                  | 5.355 ms                  |
| forward: a2a keys         | 2.943 ms                  | 48.338 ms                 |
| forward: search cache     | 495.864 us                | 817.913 us                |
| forward: a2a values       | 5.196 ms                  | 12.726 ms                 |
| forward: join             | 1.466 ms                  | 2.479 ms                  |
| Forward                   | 35.652 ms                 | 2.285 s                   |
| back: aggr dram keys      | 31.871 ms                 | 40.253 ms                 |
| back: set dram grad       | 1.966 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.597 ms                  | 15.278 ms                 |
| back: grad sum & grad cache  | 6.737 ms                  | 12.655 ms                 |
| Backward                  | 99.886 ms                 | 1.258 s                   |
| Optimize                  | 12.489 ms                 | 30.721 ms                 |
| BarrierTimeBeforeRank0    | 77.133 us                 | 295.330 us                |
| BlockToStepN              | 37.016 us                 | 172.948 us                |
| OneStep                   | 156.002 ms                | 3.566 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.483 ms                  | 26.482 ms                 |
| bucket keys               | 2.622 ms                  | 9.085 ms                  |
| forward: a2a keys         | 2.778 ms                  | 48.338 ms                 |
| forward: search cache     | 493.945 us                | 835.355 us                |
| forward: a2a values       | 5.174 ms                  | 12.726 ms                 |
| forward: join             | 1.450 ms                  | 2.610 ms                  |
| Forward                   | 34.545 ms                 | 57.644 ms                 |
| back: aggr dram keys      | 31.589 ms                 | 40.253 ms                 |
| back: set dram grad       | 1.921 ms                  | 3.833 ms                  |
| back: a2a grad            | 8.727 ms                  | 17.742 ms                 |
| back: grad sum & grad cache  | 7.018 ms                  | 12.655 ms                 |
| Backward                  | 97.882 ms                 | 116.240 ms                |
| Optimize                  | 12.608 ms                 | 26.392 ms                 |
| BarrierTimeBeforeRank0    | 74.713 us                 | 133.269 us                |
| BlockToStepN              | 34.896 us                 | 103.453 us                |
| OneStep                   | 153.634 ms                | 190.543 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.878, sample: 0.378, forward: 5.968, backward: 10.665, update: 0.279
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.877, sample: 0.414, forward: 5.924, backward: 10.657, update: 0.345
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.880, sample: 0.429, forward: 5.919, backward: 10.684, update: 0.371
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.878, sample: 0.412, forward: 5.919, backward: 10.716, update: 0.330
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.878, sample: 0.416, forward: 5.918, backward: 10.661, update: 0.333
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.881, sample: 0.389, forward: 5.956, backward: 10.715, update: 0.325
[Rank7] pid = 1345
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
train_sampler.Prefill()
-------Step 0-------
tensor([  147,    51,  3978,   102, 12471, 12696,  1837,  8627, 13792, 13029]) tensor([ 2327, 10509,  6142, 12615,    45,  1711,  1274,  5377,  1096, 13561])
-------Step 1-------
tensor([  147,    51,  3978,   102, 12471, 12696,  1837,  8627, 13792, 13029]) tensor([  948,   249, 14583,  2051,  1730,  8135, 13170, 10916,  5174, 11831])
-------Step 2-------
tensor([ 7079, 12338,  5564,  4731,   161,  9534, 10790,  5361, 10739,  1618]) tensor([ 4216,  5509,  4084,  7321,   345,  8777, 13283, 10624, 12437,  9823])
-------Step 3-------
tensor([ 7079, 12338,  5564,  4731,   161,  9534, 10790,  5361, 10739,  1618]) tensor([ 7877,  5791,  7525, 10993,  6459,  1382,   583,  2867, 12422,  2751])
-------Step 4-------
tensor([   51, 12547, 11612,  6019,  6322,  4054,    88,  7729,   156,  1772]) tensor([1218, 1873,  561, 4000, 3201, 3540, 8627, 7224, 6452, 2471])
-------Step 5-------
tensor([   51, 12547, 11612,  6019,  6322,  4054,    88,  7729,   156,  1772]) tensor([12257,  5879,   538,  2549,  3920,  1565,  1555,  2008,  6290,  6711])
-------Step 6-------
tensor([ 2406,  8497,   117,    53,  8673,  3541,  8204, 11993, 13777,    98]) tensor([12338,  3782,  7996,  5047,  9189, 10486,  5094,  9566, 10750, 11980])
-------Step 7-------
tensor([ 2406,  8497,   117,    53,  8673,  3541,  8204, 11993, 13777,    98]) tensor([12765,   788,  4209,  5713,  2161,  1426,  6575,  4248,  8680,  1412])
-------Step 8-------
tensor([ 3836,  6292,  6039, 12475,    20,    79,  8050, 10408,     7,  2768]) tensor([ 6872,  5965,  5433,  8737,  3588, 14147, 10767,  2109,  9979,  3905])
-------Step 9-------
tensor([ 3836,  6292,  6039, 12475,    20,    79,  8050, 10408,     7,  2768]) tensor([12617,  4549, 14186,  8492, 14462,   801, 14483, 10916,  1415, 10893])
before start barrier
start train
[proc 0] 100 steps, total: 18.875, sample: 0.493, forward: 5.885, backward: 11.073, update: 1.273
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.878, sample: 0.432, forward: 5.853, backward: 10.730, update: 0.369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.364 ms                  | 26.697 ms                 |
| bucket keys               | 2.643 ms                  | 6.075 ms                  |
| forward: a2a keys         | 2.852 ms                  | 14.489 ms                 |
| forward: search cache     | 488.068 us                | 849.205 us                |
| forward: a2a values       | 5.199 ms                  | 12.438 ms                 |
| forward: join             | 1.442 ms                  | 3.605 ms                  |
| Forward                   | 34.853 ms                 | 57.644 ms                 |
| back: aggr dram keys      | 31.589 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.907 ms                  | 3.833 ms                  |
| back: a2a grad            | 8.737 ms                  | 15.817 ms                 |
| back: grad sum & grad cache  | 7.177 ms                  | 12.338 ms                 |
| Backward                  | 97.875 ms                 | 116.240 ms                |
| Optimize                  | 12.323 ms                 | 26.392 ms                 |
| BarrierTimeBeforeRank0    | 69.995 us                 | 157.120 us                |
| BlockToStepN              | 34.922 us                 | 104.154 us                |
| OneStep                   | 152.594 ms                | 191.380 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.383 ms                  | 28.184 ms                 |
| bucket keys               | 2.640 ms                  | 5.355 ms                  |
| forward: a2a keys         | 2.776 ms                  | 12.667 ms                 |
| forward: search cache     | 488.068 us                | 835.355 us                |
| forward: a2a values       | 5.116 ms                  | 12.416 ms                 |
| forward: join             | 1.449 ms                  | 3.605 ms                  |
| Forward                   | 34.414 ms                 | 57.644 ms                 |
| back: aggr dram keys      | 31.501 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.901 ms                  | 3.748 ms                  |
| back: a2a grad            | 8.673 ms                  | 15.278 ms                 |
| back: grad sum & grad cache  | 7.277 ms                  | 12.655 ms                 |
| Backward                  | 97.483 ms                 | 116.240 ms                |
| Optimize                  | 12.714 ms                 | 26.392 ms                 |
| BarrierTimeBeforeRank0    | 71.241 us                 | 295.330 us                |
| BlockToStepN              | 33.848 us                 | 104.154 us                |
| OneStep                   | 151.174 ms                | 191.380 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.403 ms                  | 27.067 ms                 |
| bucket keys               | 2.643 ms                  | 6.075 ms                  |
| forward: a2a keys         | 2.824 ms                  | 25.213 ms                 |
| forward: search cache     | 484.952 us                | 849.205 us                |
| forward: a2a values       | 5.139 ms                  | 12.416 ms                 |
| forward: join             | 1.449 ms                  | 4.172 ms                  |
| Forward                   | 34.838 ms                 | 59.155 ms                 |
| back: aggr dram keys      | 31.378 ms                 | 40.253 ms                 |
| back: set dram grad       | 1.892 ms                  | 3.748 ms                  |
| back: a2a grad            | 8.710 ms                  | 15.278 ms                 |
| back: grad sum & grad cache  | 7.392 ms                  | 13.763 ms                 |
| Backward                  | 97.362 ms                 | 115.799 ms                |
| Optimize                  | 13.061 ms                 | 25.382 ms                 |
| BarrierTimeBeforeRank0    | 72.240 us                 | 207.023 us                |
| BlockToStepN              | 33.806 us                 | 143.132 us                |
| OneStep                   | 151.912 ms                | 190.543 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.406 ms                  | 27.067 ms                 |
| bucket keys               | 2.663 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.818 ms                  | 25.213 ms                 |
| forward: search cache     | 482.075 us                | 835.355 us                |
| forward: a2a values       | 5.049 ms                  | 11.445 ms                 |
| forward: join             | 1.448 ms                  | 4.172 ms                  |
| Forward                   | 35.018 ms                 | 59.809 ms                 |
| back: aggr dram keys      | 31.392 ms                 | 40.253 ms                 |
| back: set dram grad       | 1.892 ms                  | 3.567 ms                  |
| back: a2a grad            | 8.699 ms                  | 15.278 ms                 |
| back: grad sum & grad cache  | 7.392 ms                  | 13.511 ms                 |
| Backward                  | 97.287 ms                 | 117.020 ms                |
| Optimize                  | 13.091 ms                 | 25.382 ms                 |
| BarrierTimeBeforeRank0    | 71.241 us                 | 207.023 us                |
| BlockToStepN              | 33.768 us                 | 143.132 us                |
| OneStep                   | 152.775 ms                | 190.543 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 15.673, sample: 0.446, forward: 3.924, backward: 9.321, update: 0.325
[proc 0] 200 steps, total: 15.673, sample: 0.572, forward: 3.849, backward: 9.751, update: 1.343
[proc 2] 200 steps, total: 15.673, sample: 0.442, forward: 3.898, backward: 9.369, update: 0.359
[proc 7] 200 steps, total: 15.673, sample: 0.442, forward: 3.937, backward: 9.346, update: 0.324
[proc 4] 200 steps, total: 15.674, sample: 0.435, forward: 3.941, backward: 9.301, update: 0.309
[proc 5] 200 steps, total: 15.674, sample: 0.454, forward: 3.945, backward: 9.288, update: 0.322
[proc 1] 200 steps, total: 15.674, sample: 0.406, forward: 3.954, backward: 9.373, update: 0.322
[proc 6] 200 steps, total: 15.674, sample: 0.463, forward: 3.930, backward: 9.314, update: 0.342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.440 ms                  | 27.067 ms                 |
| bucket keys               | 2.652 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.852 ms                  | 26.600 ms                 |
| forward: search cache     | 482.481 us                | 835.355 us                |
| forward: a2a values       | 5.048 ms                  | 10.001 ms                 |
| forward: join             | 1.445 ms                  | 3.605 ms                  |
| Forward                   | 35.161 ms                 | 64.623 ms                 |
| back: aggr dram keys      | 31.392 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.895 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.688 ms                  | 15.188 ms                 |
| back: grad sum & grad cache  | 7.400 ms                  | 13.511 ms                 |
| Backward                  | 97.330 ms                 | 117.020 ms                |
| Optimize                  | 13.091 ms                 | 25.382 ms                 |
| BarrierTimeBeforeRank0    | 71.306 us                 | 207.023 us                |
| BlockToStepN              | 33.848 us                 | 210.998 us                |
| OneStep                   | 153.904 ms                | 190.543 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.426 ms                  | 27.949 ms                 |
| bucket keys               | 2.645 ms                  | 6.075 ms                  |
| forward: a2a keys         | 2.853 ms                  | 28.374 ms                 |
| forward: search cache     | 482.632 us                | 915.543 us                |
| forward: a2a values       | 5.025 ms                  | 10.001 ms                 |
| forward: join             | 1.435 ms                  | 4.172 ms                  |
| Forward                   | 35.567 ms                 | 62.133 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 40.253 ms                 |
| back: set dram grad       | 1.901 ms                  | 3.748 ms                  |
| back: a2a grad            | 8.698 ms                  | 15.188 ms                 |
| back: grad sum & grad cache  | 7.397 ms                  | 13.511 ms                 |
| Backward                  | 97.330 ms                 | 117.020 ms                |
| Optimize                  | 13.021 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 69.812 us                 | 164.525 us                |
| BlockToStepN              | 33.856 us                 | 193.920 us                |
| OneStep                   | 156.002 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.430 ms                  | 28.184 ms                 |
| bucket keys               | 2.644 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.887 ms                  | 28.374 ms                 |
| forward: search cache     | 481.639 us                | 849.205 us                |
| forward: a2a values       | 5.018 ms                  | 9.667 ms                  |
| forward: join             | 1.426 ms                  | 3.605 ms                  |
| Forward                   | 35.852 ms                 | 64.278 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.905 ms                  | 3.567 ms                  |
| back: a2a grad            | 8.700 ms                  | 15.170 ms                 |
| back: grad sum & grad cache  | 7.390 ms                  | 13.370 ms                 |
| Backward                  | 97.124 ms                 | 117.020 ms                |
| Optimize                  | 12.771 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 69.689 us                 | 164.525 us                |
| BlockToStepN              | 33.798 us                 | 193.920 us                |
| OneStep                   | 156.418 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 16.093, sample: 0.417, forward: 4.445, backward: 9.359, update: 0.333
[proc 1] 300 steps, total: 16.093, sample: 0.420, forward: 4.461, backward: 9.403, update: 0.306
[proc 7] 300 steps, total: 16.093, sample: 0.467, forward: 4.415, backward: 9.385, update: 0.340
[proc 2] 300 steps, total: 16.093, sample: 0.435, forward: 4.398, backward: 9.434, update: 0.357
[proc 6] 300 steps, total: 16.093, sample: 0.438, forward: 4.432, backward: 9.388, update: 0.347
[proc 3] 300 steps, total: 16.093, sample: 0.441, forward: 4.433, backward: 9.352, update: 0.342
[proc 5] 300 steps, total: 16.093, sample: 0.424, forward: 4.442, backward: 9.363, update: 0.338
[proc 0] 300 steps, total: 16.093, sample: 0.517, forward: 4.404, backward: 9.780, update: 1.235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.458 ms                  | 28.328 ms                 |
| bucket keys               | 2.641 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.870 ms                  | 28.374 ms                 |
| forward: search cache     | 479.417 us                | 915.543 us                |
| forward: a2a values       | 5.025 ms                  | 9.667 ms                  |
| forward: join             | 1.426 ms                  | 3.605 ms                  |
| Forward                   | 36.297 ms                 | 64.278 ms                 |
| back: aggr dram keys      | 31.538 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.907 ms                  | 3.748 ms                  |
| back: a2a grad            | 8.727 ms                  | 15.170 ms                 |
| back: grad sum & grad cache  | 7.389 ms                  | 13.370 ms                 |
| Backward                  | 97.124 ms                 | 117.020 ms                |
| Optimize                  | 13.048 ms                 | 24.588 ms                 |
| BarrierTimeBeforeRank0    | 69.972 us                 | 207.023 us                |
| BlockToStepN              | 33.078 us                 | 210.998 us                |
| OneStep                   | 157.783 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.455 ms                  | 28.328 ms                 |
| bucket keys               | 2.607 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.893 ms                  | 29.005 ms                 |
| forward: search cache     | 476.741 us                | 849.205 us                |
| forward: a2a values       | 5.040 ms                  | 9.330 ms                  |
| forward: join             | 1.411 ms                  | 3.605 ms                  |
| Forward                   | 36.681 ms                 | 62.133 ms                 |
| back: aggr dram keys      | 31.538 ms                 | 39.889 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.567 ms                  |
| back: a2a grad            | 8.740 ms                  | 15.170 ms                 |
| back: grad sum & grad cache  | 7.389 ms                  | 13.370 ms                 |
| Backward                  | 96.863 ms                 | 117.020 ms                |
| Optimize                  | 12.746 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 69.102 us                 | 207.023 us                |
| BlockToStepN              | 33.364 us                 | 210.998 us                |
| OneStep                   | 158.222 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.473 ms                  | 28.328 ms                 |
| bucket keys               | 2.602 ms                  | 5.725 ms                  |
| forward: a2a keys         | 2.890 ms                  | 28.374 ms                 |
| forward: search cache     | 476.162 us                | 849.205 us                |
| forward: a2a values       | 5.045 ms                  | 8.949 ms                  |
| forward: join             | 1.406 ms                  | 3.531 ms                  |
| Forward                   | 36.794 ms                 | 62.133 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 39.889 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.790 ms                  | 15.063 ms                 |
| back: grad sum & grad cache  | 7.365 ms                  | 13.271 ms                 |
| Backward                  | 96.900 ms                 | 117.020 ms                |
| Optimize                  | 12.923 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 69.689 us                 | 269.597 us                |
| BlockToStepN              | 32.996 us                 | 210.998 us                |
| OneStep                   | 158.486 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 15.986, sample: 0.417, forward: 4.337, backward: 9.378, update: 0.291
[proc 7] 400 steps, total: 15.986, sample: 0.435, forward: 4.344, backward: 9.365, update: 0.346
[proc 5] 400 steps, total: 15.986, sample: 0.469, forward: 4.303, backward: 9.341, update: 0.318
[proc 1] 400 steps, total: 15.986, sample: 0.500, forward: 4.289, backward: 9.382, update: 0.320
[proc 6] 400 steps, total: 15.986, sample: 0.494, forward: 4.279, backward: 9.351, update: 0.347
[proc 4] 400 steps, total: 15.986, sample: 0.462, forward: 4.321, backward: 9.301, update: 0.306
[proc 3] 400 steps, total: 15.986, sample: 0.452, forward: 4.316, backward: 9.323, update: 0.337
[proc 0] 400 steps, total: 15.986, sample: 0.552, forward: 4.247, backward: 9.756, update: 1.275
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.483 ms                  | 28.330 ms                 |
| bucket keys               | 2.595 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.876 ms                  | 28.374 ms                 |
| forward: search cache     | 474.511 us                | 849.205 us                |
| forward: a2a values       | 5.046 ms                  | 9.299 ms                  |
| forward: join             | 1.403 ms                  | 3.531 ms                  |
| Forward                   | 36.794 ms                 | 62.133 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.797 ms                  | 15.063 ms                 |
| back: grad sum & grad cache  | 7.389 ms                  | 13.271 ms                 |
| Backward                  | 96.782 ms                 | 117.020 ms                |
| Optimize                  | 12.977 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 69.972 us                 | 295.330 us                |
| BlockToStepN              | 32.829 us                 | 210.998 us                |
| OneStep                   | 158.484 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.515 ms                  | 28.901 ms                 |
| bucket keys               | 2.595 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.865 ms                  | 28.236 ms                 |
| forward: search cache     | 474.124 us                | 849.205 us                |
| forward: a2a values       | 5.048 ms                  | 8.949 ms                  |
| forward: join             | 1.398 ms                  | 3.490 ms                  |
| Forward                   | 36.794 ms                 | 62.133 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.310 ms                  |
| back: a2a grad            | 8.808 ms                  | 15.002 ms                 |
| back: grad sum & grad cache  | 7.389 ms                  | 12.833 ms                 |
| Backward                  | 96.863 ms                 | 117.020 ms                |
| Optimize                  | 13.021 ms                 | 24.587 ms                 |
| BarrierTimeBeforeRank0    | 71.047 us                 | 295.330 us                |
| BlockToStepN              | 32.427 us                 | 224.451 us                |
| OneStep                   | 158.394 ms                | 190.130 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.526 ms                  | 28.330 ms                 |
| bucket keys               | 2.594 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.865 ms                  | 27.742 ms                 |
| forward: search cache     | 473.591 us                | 853.400 us                |
| forward: a2a values       | 5.049 ms                  | 8.814 ms                  |
| forward: join             | 1.395 ms                  | 3.488 ms                  |
| Forward                   | 36.747 ms                 | 61.635 ms                 |
| back: aggr dram keys      | 31.472 ms                 | 39.889 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.543 ms                  |
| back: a2a grad            | 8.811 ms                  | 14.657 ms                 |
| back: grad sum & grad cache  | 7.392 ms                  | 13.271 ms                 |
| Backward                  | 96.725 ms                 | 116.850 ms                |
| Optimize                  | 13.021 ms                 | 24.415 ms                 |
| BarrierTimeBeforeRank0    | 71.204 us                 | 295.330 us                |
| BlockToStepN              | 32.799 us                 | 224.451 us                |
| OneStep                   | 157.985 ms                | 189.601 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 15.695, sample: 0.407, forward: 4.071, backward: 9.285, update: 0.326
[proc 1] 500 steps, total: 15.696, sample: 0.419, forward: 4.080, backward: 9.337, update: 0.312
[proc 6] 500 steps, total: 15.696, sample: 0.412, forward: 4.072, backward: 9.305, update: 0.325
[proc 3] 500 steps, total: 15.695, sample: 0.414, forward: 4.072, backward: 9.278, update: 0.328
[proc 7] 500 steps, total: 15.696, sample: 0.457, forward: 4.031, backward: 9.331, update: 0.344
[proc 5] 500 steps, total: 15.696, sample: 0.425, forward: 4.057, backward: 9.295, update: 0.349
[proc 2] 500 steps, total: 15.696, sample: 0.458, forward: 4.028, backward: 9.321, update: 0.351
[proc 0] 500 steps, total: 15.695, sample: 0.543, forward: 3.948, backward: 9.754, update: 1.299
Successfully xmh. training takes 82.32421922683716 seconds
before call kg_cache_controller.StopThreads()
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
INFO [65447 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.525 ms                  | 28.330 ms                 |
| bucket keys               | 2.594 ms                  | 5.883 ms                  |
| forward: a2a keys         | 2.869 ms                  | 27.742 ms                 |
| forward: search cache     | 473.270 us                | 853.400 us                |
| forward: a2a values       | 5.069 ms                  | 8.949 ms                  |
| forward: join             | 1.394 ms                  | 3.488 ms                  |
| Forward                   | 36.805 ms                 | 61.635 ms                 |
| back: aggr dram keys      | 31.501 ms                 | 40.033 ms                 |
| back: set dram grad       | 1.904 ms                  | 3.567 ms                  |
| back: a2a grad            | 8.815 ms                  | 14.657 ms                 |
| back: grad sum & grad cache  | 7.392 ms                  | 13.271 ms                 |
| Backward                  | 96.651 ms                 | 116.850 ms                |
| Optimize                  | 13.048 ms                 | 24.415 ms                 |
| BarrierTimeBeforeRank0    | 69.995 us                 | 295.330 us                |
| BlockToStepN              | 32.427 us                 | 224.451 us                |
| OneStep                   | 157.827 ms                | 189.601 ms                |
+---------------------------+---------------------------+---------------------------+
