WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 07:02:41.258409 59164 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_28', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [59164 sampler.py:454] Start PreSampling
WARNING [59164 sampler.py:532] Before construct renumbering_dict
WARNING [59164 sampler.py:555] PreSampling done
W20240130 07:20:34.785723 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 07:20:34.785926 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 07:20:34.785959 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 07:20:34.785985 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 07:20:34.786013 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 07:20:34.786041 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 07:20:34.786062 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 07:20:34.786098 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 07:20:34.786126 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 07:20:34.786161 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 07:20:34.786193 59164 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 07:20:34.786216 59164 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 07:20:34.786231 59164 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 07:20:34.786396 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 07:20:34.786430 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 07:20:34.786449 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 07:20:34.786489 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 07:20:34.786513 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 07:20:34.786531 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 07:20:34.786556 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 07:20:34.786581 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 07:20:34.786600 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 07:20:34.786628 59164 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 07:20:34.786653 59164 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 07:20:34.786667 59164 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 07:20:34.786686 59164 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 07:20:35.263307 59164 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000098ca000 128.2 GB
W20240130 07:20:35.263474 59164 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102018502000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4302718,  4302739,   523052,  ..., 31101507, 26165200, 55215151]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1247.314 seconds
INFO [9749 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [9749 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [59164 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [59164 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
W20240130 07:23:30.401342  9834 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240130 07:23:30.401726  9759 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240130 07:23:30.438040  9759 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10202cd4d000 7.629 MB
W20240130 07:23:30.438042  9834 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10202d4f0000 7.629 MB
W20240130 07:23:30.438217  9759 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10202dc93000 7.629 MB
W20240130 07:23:30.438230  9834 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10202e436000 7.629 MB
W20240130 07:23:30.438284  9759 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10202ebd9000 1.49 GB
W20240130 07:23:30.438295  9834 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10208e1bc000 1.49 GB
W20240130 07:23:30.438318  9759 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020ed79f000 1.49 GB
W20240130 07:23:30.438349  9834 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10214cd82000 1.49 GB
W20240130 07:23:30.438359  9759 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 07:23:30.438387  9834 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240130 07:23:30.441386  9759 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240130 07:23:30.441423  9834 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
[Rank1] pid = 9749
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
cudaHostRegister 0x1000098ca000
0: KnownLocalCachedEmbedding init done
WARNING [59164 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x1000098ca000
1: KnownLocalCachedEmbedding init done
WARNING [9749 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 07:23:53.485706  9834 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240130 07:23:53.485842  9759 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
W20240130 07:23:53.487267  9759 grad_base.h:55] KGCacheController, config={
        "num_gpus": 2,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240130 07:23:53.487546  9759 grad_base.h:184] Init GradProcessingBase done
I20240130 07:24:06.776178  9759 grad_async_v1.h:199] Use main thread to update emb.
W20240130 07:24:06.776419  9759 kg_controller.h:75] after init GradAsyncProcessing
I20240130 07:24:06.776430  9759 kg_controller.h:84] Construct KGCacheController done
E20240130 07:24:08.064594  9834 recstore.cc:66] init folly done
E20240130 07:24:08.064808  9759 recstore.cc:66] init folly done
I20240130 07:24:08.065526  9759 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 07:24:22.799214 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 07:24:23.803164 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 07:24:34.529107 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 07:24:34.662055  9834 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
W20240130 07:24:36.652928 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
I20240130 07:24:36.712714  9759 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
W20240130 07:24:37.698799  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240130 07:24:37.912876 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 789.667 us                | 79.365 ms                 |
| ProcessBack:UpdateCache   | 755.689 us                | 82.158 ms                 |
| ProcessBack:UpsertPq      | 10.176 ms                 | 13.701 ms                 |
| ProcessOneStep            | 12.035 ms                 | 188.754 ms                |
| BlockToStepN              | 411.137 us                | 208.687 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.202 ms                  | 9.170 ms                  |
| Forward                   | 4.781 ms                  | 606.099 ms                |
| Backward                  | 9.580 ms                  | 176.671 ms                |
| Optimize                  | 2.327 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 70.610 us                 | 867.511 us                |
| AfterBackward             | 11.618 ms                 | 188.972 ms                |
| BlockToStepN              | 1.237 ms                  | 209.207 ms                |
| OneStep                   | 39.396 ms                 | 1.195 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:38.698027  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240130 07:24:38.989975 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:24:39.698006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240130 07:24:40.063427 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:24:40.698005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240130 07:24:41.161355 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:24:41.698005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240130 07:24:42.179085 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:24:42.718111  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 697.429 us                | 50.498 ms                 |
| ProcessBack:UpdateCache   | 623.252 us                | 81.375 ms                 |
| ProcessBack:UpsertPq      | 9.297 ms                  | 17.037 ms                 |
| ProcessOneStep            | 11.591 ms                 | 188.754 ms                |
| BlockToStepN              | 1.202 ms                  | 231.599 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:43.242216 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.339 ms                  | 123.719 ms                |
| Forward                   | 4.246 ms                  | 606.099 ms                |
| Backward                  | 9.491 ms                  | 176.671 ms                |
| Optimize                  | 2.164 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 27.204 us                 | 867.511 us                |
| AfterBackward             | 11.618 ms                 | 188.972 ms                |
| BlockToStepN              | 1.237 ms                  | 231.677 ms                |
| OneStep                   | 157.029 ms                | 1.195 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:43.718005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240130 07:24:44.273355 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:24:44.718005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240130 07:24:45.321043 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:24:45.718008  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240130 07:24:46.343394 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:24:46.718006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240130 07:24:47.387189 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:24:47.729947  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=74, pq.top=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 697.429 us                | 1.459 ms                  |
| ProcessBack:UpdateCache   | 626.092 us                | 1.355 ms                  |
| ProcessBack:UpsertPq      | 8.773 ms                  | 17.037 ms                 |
| ProcessOneStep            | 11.413 ms                 | 30.260 ms                 |
| BlockToStepN              | 4.916 ms                  | 208.687 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:48.441525 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.056 ms                  | 117.110 ms                |
| Forward                   | 4.066 ms                  | 6.666 ms                  |
| Backward                  | 9.372 ms                  | 13.192 ms                 |
| Optimize                  | 2.182 ms                  | 5.271 ms                  |
| BarrierTimeBeforeRank0    | 24.445 us                 | 9.098 ms                  |
| AfterBackward             | 11.441 ms                 | 30.294 ms                 |
| BlockToStepN              | 161.339 ms                | 209.207 ms                |
| OneStep                   | 199.111 ms                | 384.895 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:48.748018  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240130 07:24:49.595280 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:24:49.748005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240130 07:24:50.625654 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 07:24:50.748039  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=97, pq.top=97
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.448, sample: 1.084, forward: 0.977, backward: 1.183, update: 0.203
train_sampler.Prefill()
-------Step 0-------
tensor([ 873591,  873609,  873627, 1713452,  873646,  873667,  873700,   23679,
         873721,  873741]) tensor([  304895,  4782978, 14426879, 57813930, 44707205, 18999556, 76086967,
        10064020, 57692048, 50273419])
-------Step 1-------
tensor([ 873591,  873609,  873627, 1713452,  873646,  873667,  873700,   23679,
         873721,  873741]) tensor([55012272, 50548561, 73567136, 31973442, 35991133,   286791, 37584620,
        67564959, 63190822, 81938435])
-------Step 2-------
tensor([ 940205,  940225,  940244,  940273,  940311,  940359,  940381,  940403,
        1718859,  940428]) tensor([14437231, 13113809, 53489608, 79313062, 28233739,  1962175, 50433691,
        38947850, 51034200, 16078409])
-------Step 3-------
tensor([ 940205,  940225,  940244,  940273,  940311,  940359,  940381,  940403,
        1718859,  940428]) tensor([60624393, 83473492,  2373276, 22418280, 66968129, 50697731, 26105421,
        38722421, 46390291, 28945552])
-------Step 4-------
tensor([ 1008000,  1008015,   285155,  1008045,   285183, 65162169,   835260,
         1008069,  1008092,  1008116]) tensor([ 1213708, 65624250, 33083054, 40441580, 65186775, 66497009, 42145949,
        39923525, 21289902, 30679576])
-------Step 5-------
tensor([ 1008000,  1008015,   285155,  1008045,   285183, 65162169,   835260,
         1008069,  1008092,  1008116]) tensor([41685683, 32070273, 68324907, 15198947, 23427441, 79979731, 68066096,
        12801532, 50503378, 83907810])
-------Step 6-------
tensor([ 1074446,  1074466,  1074489,   404335,  1074507,  1074555,  1074575,
        12625696,  1074597,  4327565]) tensor([18678339, 25523066,  6694590,  1519600, 14446177, 14219134,  3019200,
         1465171, 65771761, 18404868])
-------Step 7-------
tensor([ 1074446,  1074466,  1074489,   404335,  1074507,  1074555,  1074575,
        12625696,  1074597,  4327565]) tensor([56464604, 76836475, 60394306,  1222254,  8130541, 30728639, 77778041,
        79386818, 76308846,  8764341])
-------Step 8-------
tensor([1141292, 1141308, 1141333,  406112, 1141364, 1141379, 1141423,  286646,
        1141449, 1141470]) tensor([84789608, 72004533,   252589,  4346393, 36519571, 37249570, 56902900,
        79826058, 47435652, 31128902])
-------Step 9-------
tensor([1141292, 1141308, 1141333,  406112, 1141364, 1141379, 1141423,  286646,
        1141449, 1141470]) tensor([  875271, 30675354, 24309370, 53247883, 43473028,  1990559, 16952614,
        47106145, 35922236, 61652110])
before start barrier
start train
[proc 0] 100 steps, total: 14.397, sample: 1.714, forward: 1.026, backward: 1.131, update: 0.259
W20240130 07:24:51.669221 10517 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 07:24:51.758981  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240130 07:24:52.706274 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end8
W20240130 07:24:52.769953  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 719.675 us                | 20.006 ms                 |
| ProcessBack:UpdateCache   | 649.135 us                | 18.581 ms                 |
| ProcessBack:UpsertPq      | 8.785 ms                  | 20.200 ms                 |
| ProcessOneStep            | 11.512 ms                 | 35.531 ms                 |
| BlockToStepN              | 12.766 ms                 | 208.687 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.674 ms                  | 117.110 ms                |
| Forward                   | 4.212 ms                  | 6.666 ms                  |
| Backward                  | 9.522 ms                  | 14.323 ms                 |
| Optimize                  | 2.277 ms                  | 5.613 ms                  |
| BarrierTimeBeforeRank0    | 24.577 us                 | 24.635 ms                 |
| AfterBackward             | 11.551 ms                 | 35.570 ms                 |
| BlockToStepN              | 12.816 ms                 | 209.207 ms                |
| OneStep                   | 115.838 ms                | 384.895 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:53.769006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240130 07:24:53.868718 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end1
W20240130 07:24:54.769006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240130 07:24:55.000188 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end1
W20240130 07:24:55.836099  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240130 07:24:56.000257 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:24:56.883903  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240130 07:24:57.067662 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:24:57.883008  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 755.604 us                | 3.641 ms                  |
| ProcessBack:UpdateCache   | 668.646 us                | 1.355 ms                  |
| ProcessBack:UpsertPq      | 9.354 ms                  | 24.171 ms                 |
| ProcessOneStep            | 11.996 ms                 | 31.884 ms                 |
| BlockToStepN              | 12.766 ms                 | 206.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:58.081893 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.327 ms                  | 107.614 ms                |
| Forward                   | 4.325 ms                  | 6.013 ms                  |
| Backward                  | 9.895 ms                  | 16.174 ms                 |
| Optimize                  | 2.365 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 25.393 us                 | 9.098 ms                  |
| AfterBackward             | 12.071 ms                 | 31.911 ms                 |
| BlockToStepN              | 12.816 ms                 | 206.971 ms                |
| OneStep                   | 117.526 ms                | 318.097 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:24:58.883004  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240130 07:24:59.117252 10517 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240130 07:24:59.897743  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240130 07:25:00.121820 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:25:00.897006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240130 07:25:01.129369 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:25:01.897004  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 1] 200 steps, total: 10.938, sample: 1.555, forward: 0.423, backward: 0.990, update: 0.199
[proc 0] 200 steps, total: 10.938, sample: 1.765, forward: 0.442, backward: 1.095, update: 0.258
W20240130 07:25:02.130618 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 07:25:02.897006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 750.442 us                | 1.963 ms                  |
| ProcessBack:UpdateCache   | 653.277 us                | 1.039 ms                  |
| ProcessBack:UpsertPq      | 9.065 ms                  | 23.667 ms                 |
| ProcessOneStep            | 11.820 ms                 | 31.884 ms                 |
| BlockToStepN              | 12.766 ms                 | 206.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:03.135485 10517 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.466 ms                  | 107.614 ms                |
| Forward                   | 4.316 ms                  | 6.144 ms                  |
| Backward                  | 9.669 ms                  | 16.174 ms                 |
| Optimize                  | 2.379 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 25.393 us                 | 9.098 ms                  |
| AfterBackward             | 11.822 ms                 | 31.911 ms                 |
| BlockToStepN              | 12.816 ms                 | 206.971 ms                |
| OneStep                   | 117.526 ms                | 318.097 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:03.908321  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240130 07:25:04.170130 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end7
W20240130 07:25:04.923619  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240130 07:25:05.184834 10517 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 07:25:06.002230  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240130 07:25:06.222620 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:25:07.002005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240130 07:25:07.293606 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 07:25:08.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 745.851 us                | 1.963 ms                  |
| ProcessBack:UpdateCache   | 644.633 us                | 1.036 ms                  |
| ProcessBack:UpsertPq      | 8.870 ms                  | 22.563 ms                 |
| ProcessOneStep            | 11.647 ms                 | 32.767 ms                 |
| BlockToStepN              | 12.766 ms                 | 206.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:08.365885 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.577 ms                  | 107.614 ms                |
| Forward                   | 4.291 ms                  | 17.090 ms                 |
| Backward                  | 9.580 ms                  | 16.174 ms                 |
| Optimize                  | 2.379 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 25.552 us                 | 19.381 ms                 |
| AfterBackward             | 11.694 ms                 | 32.800 ms                 |
| BlockToStepN              | 12.816 ms                 | 206.971 ms                |
| OneStep                   | 117.526 ms                | 318.097 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:09.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240130 07:25:09.393626 10517 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 07:25:10.002005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240130 07:25:10.394277 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:25:11.002005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240130 07:25:11.397821 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end3
W20240130 07:25:12.002010  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240130 07:25:12.453787 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 07:25:13.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 745.793 us                | 1.627 ms                  |
| ProcessBack:UpdateCache   | 647.909 us                | 1.036 ms                  |
| ProcessBack:UpsertPq      | 8.867 ms                  | 21.542 ms                 |
| ProcessOneStep            | 11.593 ms                 | 31.884 ms                 |
| BlockToStepN              | 12.766 ms                 | 198.939 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:13.463249 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.632 ms                  | 107.405 ms                |
| Forward                   | 4.249 ms                  | 6.666 ms                  |
| Backward                  | 9.496 ms                  | 14.323 ms                 |
| Optimize                  | 2.371 ms                  | 5.613 ms                  |
| BarrierTimeBeforeRank0    | 25.301 us                 | 19.381 ms                 |
| AfterBackward             | 11.551 ms                 | 31.911 ms                 |
| BlockToStepN              | 12.816 ms                 | 199.001 ms                |
| OneStep                   | 117.526 ms                | 300.281 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:14.002005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240130 07:25:14.551831 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:25:15.002005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 0] 300 steps, total: 13.038, sample: 1.196, forward: 0.441, backward: 0.943, update: 0.264
[proc 1] 300 steps, total: 13.038, sample: 1.135, forward: 0.410, backward: 1.019, update: 0.201
W20240130 07:25:15.597931 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:25:16.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240130 07:25:16.747838 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:25:17.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240130 07:25:17.826205 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240130 07:25:18.002007  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=321, pq.top=321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 746.305 us                | 1.627 ms                  |
| ProcessBack:UpdateCache   | 653.277 us                | 1.039 ms                  |
| ProcessBack:UpsertPq      | 8.949 ms                  | 25.494 ms                 |
| ProcessOneStep            | 11.749 ms                 | 32.767 ms                 |
| BlockToStepN              | 12.766 ms                 | 198.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.393 ms                  | 107.405 ms                |
| Forward                   | 4.264 ms                  | 6.666 ms                  |
| Backward                  | 9.488 ms                  | 14.323 ms                 |
| Optimize                  | 2.376 ms                  | 5.613 ms                  |
| BarrierTimeBeforeRank0    | 25.915 us                 | 19.381 ms                 |
| AfterBackward             | 11.705 ms                 | 32.800 ms                 |
| BlockToStepN              | 12.816 ms                 | 199.001 ms                |
| OneStep                   | 117.526 ms                | 304.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:18.983708 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:25:19.016661  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240130 07:25:19.994764 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:25:20.024015  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=336, pq.top=336
W20240130 07:25:21.024014  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240130 07:25:21.124521 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:25:22.024006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240130 07:25:22.143584 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:25:23.024005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 747.530 us                | 1.459 ms                  |
| ProcessBack:UpdateCache   | 655.726 us                | 1.036 ms                  |
| ProcessBack:UpsertPq      | 8.909 ms                  | 24.171 ms                 |
| ProcessOneStep            | 11.678 ms                 | 32.699 ms                 |
| BlockToStepN              | 12.766 ms                 | 197.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:23.235035 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.520 ms                  | 106.050 ms                |
| Forward                   | 4.266 ms                  | 6.144 ms                  |
| Backward                  | 9.471 ms                  | 14.323 ms                 |
| Optimize                  | 2.378 ms                  | 5.391 ms                  |
| BarrierTimeBeforeRank0    | 25.915 us                 | 17.729 ms                 |
| AfterBackward             | 11.705 ms                 | 32.729 ms                 |
| BlockToStepN              | 70.721 ms                 | 197.213 ms                |
| OneStep                   | 117.833 ms                | 311.965 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:24.036934  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240130 07:25:24.248966 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:25:25.136905  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240130 07:25:25.358836 10517 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240130 07:25:26.154570  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240130 07:25:26.364017 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240130 07:25:27.222451  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240130 07:25:27.434777 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 751.379 us                | 1.627 ms                  |
| ProcessBack:UpdateCache   | 658.492 us                | 1.039 ms                  |
| ProcessBack:UpsertPq      | 8.895 ms                  | 23.667 ms                 |
| ProcessOneStep            | 11.749 ms                 | 32.699 ms                 |
| BlockToStepN              | 12.766 ms                 | 197.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:28.222004  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 1] 400 steps, total: 13.321, sample: 1.242, forward: 0.422, backward: 1.016, update: 0.200
[proc 0] 400 steps, total: 13.321, sample: 1.298, forward: 0.430, backward: 0.958, update: 0.270
W20240130 07:25:28.448339 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.370 ms                  | 106.050 ms                |
| Forward                   | 4.272 ms                  | 6.144 ms                  |
| Backward                  | 9.432 ms                  | 14.323 ms                 |
| Optimize                  | 2.389 ms                  | 6.961 ms                  |
| BarrierTimeBeforeRank0    | 26.160 us                 | 19.381 ms                 |
| AfterBackward             | 11.755 ms                 | 32.729 ms                 |
| BlockToStepN              | 12.816 ms                 | 197.213 ms                |
| OneStep                   | 117.526 ms                | 311.965 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:29.241725  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240130 07:25:29.468546 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:25:30.248816  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240130 07:25:30.527366 10517 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 07:25:31.271214  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240130 07:25:31.562297 10517 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240130 07:25:32.271008  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240130 07:25:32.670200 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 754.749 us                | 1.459 ms                  |
| ProcessBack:UpdateCache   | 657.655 us                | 1.036 ms                  |
| ProcessBack:UpsertPq      | 8.819 ms                  | 22.563 ms                 |
| ProcessOneStep            | 11.716 ms                 | 32.699 ms                 |
| BlockToStepN              | 12.766 ms                 | 197.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:33.298605  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=439, pq.top=439
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.083 ms                  | 106.050 ms                |
| Forward                   | 4.249 ms                  | 6.144 ms                  |
| Backward                  | 9.415 ms                  | 14.323 ms                 |
| Optimize                  | 2.384 ms                  | 6.961 ms                  |
| BarrierTimeBeforeRank0    | 26.160 us                 | 19.760 ms                 |
| AfterBackward             | 11.744 ms                 | 32.729 ms                 |
| BlockToStepN              | 70.721 ms                 | 197.213 ms                |
| OneStep                   | 117.833 ms                | 311.965 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:33.744338 10517 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240130 07:25:34.298005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240130 07:25:34.783748 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 07:25:35.298005  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240130 07:25:35.788830 10517 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240130 07:25:36.300925  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240130 07:25:36.820802 10517 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240130 07:25:37.325997  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=470, pq.top=470
W20240130 07:25:37.868419 10517 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 756.628 us                | 1.761 ms                  |
| ProcessBack:UpdateCache   | 658.406 us                | 1.039 ms                  |
| ProcessBack:UpsertPq      | 8.754 ms                  | 24.171 ms                 |
| ProcessOneStep            | 11.678 ms                 | 32.699 ms                 |
| BlockToStepN              | 12.766 ms                 | 197.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:38.325004  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=477, pq.top=477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.848 ms                  | 100.073 ms                |
| Forward                   | 4.259 ms                  | 6.064 ms                  |
| Backward                  | 9.399 ms                  | 14.323 ms                 |
| Optimize                  | 2.382 ms                  | 6.961 ms                  |
| BarrierTimeBeforeRank0    | 27.017 us                 | 19.381 ms                 |
| AfterBackward             | 11.705 ms                 | 32.729 ms                 |
| BlockToStepN              | 12.816 ms                 | 197.213 ms                |
| OneStep                   | 117.526 ms                | 306.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 07:25:38.927078 10517 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240130 07:25:39.326107  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240130 07:25:39.980681 10517 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240130 07:25:40.326006  9759 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240130 07:25:41.090133 10517 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 0] 500 steps, total: 12.713, sample: 0.987, forward: 0.418, backward: 0.944, update: 0.246
[proc 1] 500 steps, total: 12.713, sample: 1.130, forward: 0.413, backward: 1.012, update: 0.196
Successfully xmh. training takes 64.40815711021423 seconds
before call kg_cache_controller.StopThreads()
W20240130 07:25:41.120891  9759 grad_async_v1.h:230] call StopThreads. PID = 59164
W20240130 07:25:41.120915  9759 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 07:25:41.125746  9759 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 07:25:41.125805  9759 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240130 07:25:41.173777  9759 grad_async_v1.h:251] StopThreads done.
