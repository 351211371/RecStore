WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 14:04:35.987717 49152 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_47', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [49152 sampler.py:454] Start PreSampling
WARNING [49152 sampler.py:532] Before construct renumbering_dict
WARNING [49152 sampler.py:555] PreSampling done
W20240129 14:04:40.810997 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 14:04:40.811203 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 14:04:40.811264 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 14:04:40.811309 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 14:04:40.811352 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 14:04:40.811396 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 14:04:40.811443 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 14:04:40.811515 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 14:04:40.811578 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 14:04:40.811635 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 14:04:40.811691 49152 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 14:04:40.811734 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 14:04:40.811779 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 14:04:40.811971 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 14:04:40.812031 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 14:04:40.812085 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 14:04:40.812142 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 14:04:40.812199 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 14:04:40.812256 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 14:04:40.812310 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 14:04:40.812362 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 14:04:40.812420 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 14:04:40.812479 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 14:04:40.812522 49152 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 14:04:40.812561 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 14:04:40.812602 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 14:04:40.812687 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 14:04:40.812742 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 14:04:40.812794 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 14:04:40.812839 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 14:04:40.812888 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 14:04:40.812949 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 14:04:40.813004 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 14:04:40.813051 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 14:04:40.813097 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 14:04:40.813143 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 14:04:40.813192 49152 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 14:04:40.813230 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 14:04:40.813274 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 14:04:40.813359 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 14:04:40.813418 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 14:04:40.813463 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 14:04:40.813519 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 14:04:40.813565 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 14:04:40.813618 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 14:04:40.813666 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 14:04:40.813719 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 14:04:40.813771 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 14:04:40.813824 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 14:04:40.813870 49152 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 14:04:40.813910 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 14:04:40.813948 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 14:04:40.814044 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 14:04:40.814103 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 14:04:40.814153 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 14:04:40.814203 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 14:04:40.814250 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 14:04:40.814308 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 14:04:40.814368 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 14:04:40.814417 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 14:04:40.814464 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 14:04:40.814517 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 14:04:40.814570 49152 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 14:04:40.814610 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 14:04:40.814647 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 14:04:40.814728 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 14:04:40.814775 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 14:04:40.814821 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 14:04:40.814882 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 14:04:40.814931 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 14:04:40.814986 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 14:04:40.815042 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 14:04:40.815093 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 14:04:40.815146 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 14:04:40.815196 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 14:04:40.815243 49152 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 14:04:40.815281 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 14:04:40.815327 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 14:04:40.815409 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 14:04:40.815466 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 14:04:40.815513 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 14:04:40.815559 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 14:04:40.815613 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 14:04:40.815666 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 14:04:40.815712 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 14:04:40.815770 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 14:04:40.815820 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 14:04:40.815867 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 14:04:40.815924 49152 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 14:04:40.815963 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 14:04:40.816015 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 14:04:40.816118 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 14:04:40.816182 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 14:04:40.816231 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 14:04:40.816277 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 14:04:40.816327 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 14:04:40.816375 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 14:04:40.816421 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 14:04:40.816468 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 14:04:40.816519 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 14:04:40.816570 49152 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 14:04:40.816619 49152 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 14:04:40.816658 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 14:04:40.816704 49152 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 14:04:41.067203 49152 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240129 14:04:41.067376 49152 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 748, 1104, 1580,  ..., 8905, 9699, 7476]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.182 seconds
[Rank1] pid = 49576
[Rank2] pid = 49602
[Rank3] pid = 49707
[Rank4] pid = 49708
[Rank5] pid = 49835
[Rank6] pid = 49836
INFO [49152 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [49576 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [49602 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [49707 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [49708 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [49836 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [49837 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [49835 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [49836 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49835 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49837 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49708 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49707 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49602 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49152 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49576 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240129 14:04:43.623601 49942 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240129 14:04:43.624681 49905 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240129 14:04:43.624778 49838 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240129 14:04:43.625064 49710 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240129 14:04:43.625180 49709 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240129 14:04:43.625146 49908 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240129 14:04:43.625533 49642 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240129 14:04:43.627034 49577 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240129 14:04:43.664906 49942 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100027a0a000 7.629 MB
W20240129 14:04:43.665031 49905 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000281b5000 7.629 MB
W20240129 14:04:43.665050 49908 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100028958000 7.629 MB
W20240129 14:04:43.665155 49709 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000290fb000 7.629 MB
W20240129 14:04:43.665161 49710 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10002989e000 7.629 MB
W20240129 14:04:43.665164 49838 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10002a041000 7.629 MB
W20240129 14:04:43.665203 49908 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10002a7e4000 7.629 MB
W20240129 14:04:43.665223 49942 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10002b72a000 7.629 MB
W20240129 14:04:43.665221 49642 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10002af87000 7.629 MB
W20240129 14:04:43.665241 49905 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002becd000 7.629 MB
W20240129 14:04:43.665302 49838 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10002c670000 7.629 MB
W20240129 14:04:43.665325 49908 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002ce13000 1.49 GB
W20240129 14:04:43.665334 49709 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10008c3f6000 7.629 MB
W20240129 14:04:43.665341 49942 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10008cb99000 1.49 GB
W20240129 14:04:43.665357 49905 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1000ec17c000 1.49 GB
W20240129 14:04:43.665365 49710 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10014b75f000 7.629 MB
W20240129 14:04:43.665376 49838 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10014bf02000 1.49 GB
W20240129 14:04:43.665421 49908 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1001ab4e5000 1.49 GB
W20240129 14:04:43.665429 49838 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10020aac8000 1.49 GB
W20240129 14:04:43.665448 49942 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10026a0ab000 1.49 GB
W20240129 14:04:43.665457 49905 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1002c968e000 1.49 GB
W20240129 14:04:43.665480 49642 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100328c71000 7.629 MB
W20240129 14:04:43.665484 49838 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 14:04:43.665490 49908 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 14:04:43.665499 49710 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100329414000 1.49 GB
W20240129 14:04:43.665508 49942 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 14:04:43.665515 49905 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 14:04:43.665524 49709 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1003889f7000 1.49 GB
W20240129 14:04:43.665556 49710 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1003e7fda000 1.49 GB
W20240129 14:04:43.665582 49642 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1004475bd000 1.49 GB
W20240129 14:04:43.665591 49709 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1004a6ba0000 1.49 GB
W20240129 14:04:43.665612 49710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 14:04:43.665652 49709 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 14:04:43.665654 49642 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100506183000 1.49 GB
W20240129 14:04:43.665704 49642 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 14:04:43.677708 49838 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 14:04:43.677714 49908 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 14:04:43.677721 49942 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 14:04:43.677752 49710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 14:04:43.677763 49642 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 14:04:43.677776 49905 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 14:04:43.677780 49709 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 14:04:43.678098 49577 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100565776000 7.629 MB
W20240129 14:04:43.678246 49577 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100565f19000 7.629 MB
W20240129 14:04:43.678359 49577 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1005666bc000 1.49 GB
W20240129 14:04:43.678434 49577 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005c5c9f000 1.49 GB
W20240129 14:04:43.678550 49577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 14:04:43.691192 49577 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [49708 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [49837 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [49576 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [49602 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 49837
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [49152 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [49836 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [49835 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [49707 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 14:04:45.973973 49709 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.974567 49710 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.974905 49908 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.975046 49942 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.975193 49905 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.975376 49642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.977514 49838 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:04:45.977715 49577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240129 14:04:47.785780 49942 recstore.cc:66] init folly done
E20240129 14:04:47.785852 49908 recstore.cc:66] init folly done
E20240129 14:04:47.786078 49905 recstore.cc:66] init folly done
E20240129 14:04:47.786531 49838 recstore.cc:66] init folly done
E20240129 14:04:47.786701 49709 recstore.cc:66] init folly done
E20240129 14:04:47.786734 49710 recstore.cc:66] init folly done
E20240129 14:04:47.787287 49577 recstore.cc:66] init folly done
E20240129 14:04:47.787652 49642 recstore.cc:66] init folly done
I20240129 14:04:47.875849 49942 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240129 14:04:47.875963 49577 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.876457 49642 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.879343 49905 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.882099 49709 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.882874 49710 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.882997 49908 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:04:47.897804 49838 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.091 us                | 805.091 us                |
| Forward                   | 657.847 ms                | 657.847 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.740 ms                  | 35.395 ms                 |
| Forward                   | 5.971 ms                  | 657.847 ms                |
| Backward                  | 174.758 ms                | 2.658 s                   |
| Optimize                  | 46.383 ms                 | 76.759 ms                 |
| BarrierTimeBeforeRank0    | 61.607 us                 | 409.731 us                |
| BlockToStepN              | 51.027 us                 | 228.337 us                |
| OneStep                   | 237.379 ms                | 3.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.958 ms                  | 35.395 ms                 |
| Forward                   | 5.974 ms                  | 657.847 ms                |
| Backward                  | 166.262 ms                | 2.658 s                   |
| Optimize                  | 40.037 ms                 | 76.759 ms                 |
| BarrierTimeBeforeRank0    | 55.525 us                 | 409.731 us                |
| BlockToStepN              | 37.641 us                 | 228.337 us                |
| OneStep                   | 219.757 ms                | 3.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.855 ms                  | 28.653 ms                 |
| Forward                   | 5.884 ms                  | 15.673 ms                 |
| Backward                  | 165.212 ms                | 209.031 ms                |
| Optimize                  | 36.864 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 52.281 us                 | 180.107 us                |
| BlockToStepN              | 34.610 us                 | 228.337 us                |
| OneStep                   | 214.830 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.836 ms                  | 28.953 ms                 |
| Forward                   | 5.852 ms                  | 15.673 ms                 |
| Backward                  | 166.262 ms                | 209.031 ms                |
| Optimize                  | 36.864 ms                 | 75.408 ms                 |
| BarrierTimeBeforeRank0    | 52.932 us                 | 180.107 us                |
| BlockToStepN              | 40.633 us                 | 1.079 ms                  |
| OneStep                   | 215.196 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 25.075, sample: 0.476, forward: 1.184, backward: 14.699, update: 0.461
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 25.068, sample: 0.422, forward: 1.159, backward: 14.806, update: 0.470
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 25.068, sample: 0.449, forward: 1.104, backward: 14.850, update: 0.466
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 25.071, sample: 0.473, forward: 1.178, backward: 14.679, update: 0.459
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.075, sample: 0.472, forward: 1.124, backward: 14.793, update: 0.484
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 25.074, sample: 0.509, forward: 1.134, backward: 14.676, update: 0.378
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 25.068, sample: 0.413, forward: 1.120, backward: 14.824, update: 0.486
train_sampler.Prefill()
-------Step 0-------
tensor([ 1994,    58,  3292,    84, 12748, 13743,  1139,  7136, 12180, 11308]) tensor([ 1580,  9088,  5759, 10878, 11592,  1041,  5235,  4811,   538, 12432])
-------Step 1-------
tensor([ 1994,    58,  3292,    84, 12748, 13743,  1139,  7136, 12180, 11308]) tensor([ 5883, 10757, 10790,  4874,  1840,  9236, 10520,  3813, 11925,  9625])
-------Step 2-------
tensor([ 1609, 13870,  6201, 11919, 13567,  6050, 12671,  7753,  5808, 12380]) tensor([ 8422,  4275,  1588,  6578, 14327,  3133,   156,  3599,   181, 14519])
-------Step 3-------
tensor([ 1609, 13870,  6201, 11919, 13567,  6050, 12671,  7753,  5808, 12380]) tensor([ 9192, 10764,  7768,  8923,  6174, 10708,  8375, 11677,  8992, 11414])
-------Step 4-------
tensor([ 4576,    88, 12299, 11974,  5106, 12757, 12658,  3425,     4,  9029]) tensor([ 7945,  7231,   525, 11522, 11467, 12103, 10786,  3882, 10892,   454])
-------Step 5-------
tensor([ 4576,    88, 12299, 11974,  5106, 12757, 12658,  3425,     4,  9029]) tensor([ 2919,  2439, 10451,  1166,  4402, 13894,  9443, 14702,  4616, 12745])
-------Step 6-------
tensor([ 6913, 11395,  5440,  6324,  7288,   987,  6776,  8715, 13192,  8240]) tensor([10947, 11795, 12948,  2040,  2346,  3425,  7808,  3194,  3634,  4156])
-------Step 7-------
tensor([ 6913, 11395,  5440,  6324,  7288,   987,  6776,  8715, 13192,  8240]) tensor([ 9818, 11437,  7653,  7397, 14632,  1815, 10537,   261, 12727, 14518])
-------Step 8-------
tensor([11582,  3113, 13041, 12081,  2680, 10754, 11974,  3258,  4103,   812]) tensor([ 2698,  9282,  1633,  4705,  9116, 13057,  9870,  6496, 12051,  4556])
-------Step 9-------
tensor([11582,  3113, 13041, 12081,  2680, 10754, 11974,  3258,  4103,   812]) tensor([ 8772,  9591,  9517,   240,  8997,  6305,  2911,  3277,  2660, 13942])
before start barrier
start train
[proc 0] 100 steps, total: 25.053, sample: 0.508, forward: 1.251, backward: 19.242, update: 3.913
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.714 ms                  | 29.046 ms                 |
| Forward                   | 5.696 ms                  | 15.673 ms                 |
| Backward                  | 166.274 ms                | 209.031 ms                |
| Optimize                  | 36.468 ms                 | 75.408 ms                 |
| BarrierTimeBeforeRank0    | 52.281 us                 | 180.107 us                |
| BlockToStepN              | 37.234 us                 | 1.079 ms                  |
| OneStep                   | 217.149 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.654 ms                  | 29.046 ms                 |
| Forward                   | 5.662 ms                  | 15.673 ms                 |
| Backward                  | 167.227 ms                | 209.031 ms                |
| Optimize                  | 35.333 ms                 | 75.408 ms                 |
| BarrierTimeBeforeRank0    | 51.155 us                 | 180.107 us                |
| BlockToStepN              | 34.618 us                 | 1.079 ms                  |
| OneStep                   | 217.415 ms                | 272.267 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.652 ms                  | 29.883 ms                 |
| Forward                   | 5.671 ms                  | 15.673 ms                 |
| Backward                  | 166.667 ms                | 207.442 ms                |
| Optimize                  | 36.754 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 49.902 us                 | 134.030 us                |
| BlockToStepN              | 34.813 us                 | 1.019 ms                  |
| OneStep                   | 217.149 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 29.883 ms                 |
| Forward                   | 5.618 ms                  | 15.673 ms                 |
| Backward                  | 167.227 ms                | 209.031 ms                |
| Optimize                  | 35.989 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 50.815 us                 | 134.030 us                |
| BlockToStepN              | 34.941 us                 | 1.019 ms                  |
| OneStep                   | 217.086 ms                | 272.267 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 22.062, sample: 0.389, forward: 0.493, backward: 12.883, update: 0.449
[proc 7] 200 steps, total: 22.063, sample: 0.434, forward: 0.517, backward: 12.819, update: 0.420
[proc 5] 200 steps, total: 22.062, sample: 0.439, forward: 0.516, backward: 12.751, update: 0.434
[proc 1] 200 steps, total: 22.062, sample: 0.441, forward: 0.527, backward: 12.870, update: 0.427
[proc 3] 200 steps, total: 22.062, sample: 0.430, forward: 0.537, backward: 12.930, update: 0.469
[proc 0] 200 steps, total: 22.062, sample: 0.488, forward: 0.563, backward: 17.061, update: 3.816
[proc 4] 200 steps, total: 22.062, sample: 0.445, forward: 0.488, backward: 12.918, update: 0.477
[proc 6] 200 steps, total: 22.062, sample: 0.445, forward: 0.516, backward: 12.893, update: 0.467
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 29.883 ms                 |
| Forward                   | 5.618 ms                  | 15.673 ms                 |
| Backward                  | 167.336 ms                | 209.031 ms                |
| Optimize                  | 35.989 ms                 | 69.583 ms                 |
| BarrierTimeBeforeRank0    | 51.241 us                 | 165.907 us                |
| BlockToStepN              | 35.336 us                 | 1.019 ms                  |
| OneStep                   | 217.086 ms                | 272.267 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.692 ms                  | 29.883 ms                 |
| Forward                   | 5.589 ms                  | 15.673 ms                 |
| Backward                  | 167.371 ms                | 209.031 ms                |
| Optimize                  | 36.042 ms                 | 69.583 ms                 |
| BarrierTimeBeforeRank0    | 52.281 us                 | 165.907 us                |
| BlockToStepN              | 35.390 us                 | 1.019 ms                  |
| OneStep                   | 217.086 ms                | 272.267 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.700 ms                  | 29.575 ms                 |
| Forward                   | 5.582 ms                  | 12.030 ms                 |
| Backward                  | 167.371 ms                | 207.442 ms                |
| Optimize                  | 35.853 ms                 | 69.583 ms                 |
| BarrierTimeBeforeRank0    | 52.281 us                 | 180.107 us                |
| BlockToStepN              | 35.776 us                 | 1.019 ms                  |
| OneStep                   | 217.086 ms                | 272.267 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.679 ms                  | 29.575 ms                 |
| Forward                   | 5.575 ms                  | 14.542 ms                 |
| Backward                  | 167.336 ms                | 207.442 ms                |
| Optimize                  | 35.661 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 52.281 us                 | 165.907 us                |
| BlockToStepN              | 35.825 us                 | 767.447 us                |
| OneStep                   | 215.666 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.679 ms                  | 29.575 ms                 |
| Forward                   | 5.575 ms                  | 14.542 ms                 |
| Backward                  | 167.371 ms                | 209.031 ms                |
| Optimize                  | 35.772 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 52.066 us                 | 165.907 us                |
| BlockToStepN              | 36.040 us                 | 767.447 us                |
| OneStep                   | 215.196 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 21.524, sample: 0.448, forward: 0.523, backward: 12.551, update: 0.439
[proc 6] 300 steps, total: 21.524, sample: 0.390, forward: 0.547, backward: 12.602, update: 0.501
[proc 3] 300 steps, total: 21.524, sample: 0.411, forward: 0.495, backward: 12.617, update: 0.463
[proc 5] 300 steps, total: 21.524, sample: 0.427, forward: 0.513, backward: 12.400, update: 0.437
[proc 1] 300 steps, total: 21.524, sample: 0.380, forward: 0.516, backward: 12.659, update: 0.367
[proc 2] 300 steps, total: 21.524, sample: 0.399, forward: 0.506, backward: 12.435, update: 0.444
[proc 7] 300 steps, total: 21.524, sample: 0.425, forward: 0.518, backward: 12.410, update: 0.410
[proc 0] 300 steps, total: 21.524, sample: 0.479, forward: 0.558, backward: 16.640, update: 3.713
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.666 ms                  | 29.575 ms                 |
| Forward                   | 5.590 ms                  | 14.542 ms                 |
| Backward                  | 167.371 ms                | 209.031 ms                |
| Optimize                  | 35.772 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 52.066 us                 | 165.907 us                |
| BlockToStepN              | 35.825 us                 | 915.277 us                |
| OneStep                   | 214.830 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.657 ms                  | 29.883 ms                 |
| Forward                   | 5.582 ms                  | 14.542 ms                 |
| Backward                  | 167.227 ms                | 209.031 ms                |
| Optimize                  | 35.560 ms                 | 69.376 ms                 |
| BarrierTimeBeforeRank0    | 51.837 us                 | 165.907 us                |
| BlockToStepN              | 35.894 us                 | 915.277 us                |
| OneStep                   | 214.489 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.666 ms                  | 29.575 ms                 |
| Forward                   | 5.575 ms                  | 12.030 ms                 |
| Backward                  | 166.703 ms                | 207.442 ms                |
| Optimize                  | 35.560 ms                 | 66.793 ms                 |
| BarrierTimeBeforeRank0    | 51.589 us                 | 134.030 us                |
| BlockToStepN              | 35.945 us                 | 767.447 us                |
| OneStep                   | 214.351 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.657 ms                  | 29.575 ms                 |
| Forward                   | 5.547 ms                  | 12.030 ms                 |
| Backward                  | 167.336 ms                | 209.031 ms                |
| Optimize                  | 35.661 ms                 | 66.793 ms                 |
| BarrierTimeBeforeRank0    | 51.837 us                 | 134.030 us                |
| BlockToStepN              | 36.024 us                 | 767.447 us                |
| OneStep                   | 214.351 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 21.429, sample: 0.394, forward: 0.489, backward: 12.646, update: 0.481
[proc 7] 400 steps, total: 21.428, sample: 0.426, forward: 0.516, backward: 12.419, update: 0.446
[proc 6] 400 steps, total: 21.429, sample: 0.429, forward: 0.513, backward: 12.601, update: 0.415
[proc 1] 400 steps, total: 21.428, sample: 0.418, forward: 0.507, backward: 12.613, update: 0.412
[proc 2] 400 steps, total: 21.428, sample: 0.426, forward: 0.489, backward: 12.461, update: 0.401
[proc 5] 400 steps, total: 21.429, sample: 0.417, forward: 0.512, backward: 12.438, update: 0.414
[proc 3] 400 steps, total: 21.429, sample: 0.406, forward: 0.489, backward: 12.619, update: 0.485
[proc 0] 400 steps, total: 21.428, sample: 0.465, forward: 0.541, backward: 16.596, update: 3.698
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.668 ms                  | 29.575 ms                 |
| Forward                   | 5.562 ms                  | 12.030 ms                 |
| Backward                  | 167.336 ms                | 209.031 ms                |
| Optimize                  | 35.639 ms                 | 66.793 ms                 |
| BarrierTimeBeforeRank0    | 51.837 us                 | 134.030 us                |
| BlockToStepN              | 35.894 us                 | 767.447 us                |
| OneStep                   | 214.321 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 30.557 ms                 |
| Forward                   | 5.589 ms                  | 12.730 ms                 |
| Backward                  | 167.226 ms                | 209.459 ms                |
| Optimize                  | 35.772 ms                 | 66.793 ms                 |
| BarrierTimeBeforeRank0    | 52.006 us                 | 134.030 us                |
| BlockToStepN              | 35.574 us                 | 915.277 us                |
| OneStep                   | 214.351 ms                | 269.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.688 ms                  | 29.883 ms                 |
| Forward                   | 5.591 ms                  | 12.030 ms                 |
| Backward                  | 166.461 ms                | 209.031 ms                |
| Optimize                  | 35.951 ms                 | 64.305 ms                 |
| BarrierTimeBeforeRank0    | 52.257 us                 | 131.881 us                |
| BlockToStepN              | 35.825 us                 | 767.447 us                |
| OneStep                   | 214.045 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 29.883 ms                 |
| Forward                   | 5.588 ms                  | 12.030 ms                 |
| Backward                  | 166.274 ms                | 209.031 ms                |
| Optimize                  | 35.951 ms                 | 64.305 ms                 |
| BarrierTimeBeforeRank0    | 51.837 us                 | 131.881 us                |
| BlockToStepN              | 35.825 us                 | 767.447 us                |
| OneStep                   | 213.679 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 500 steps, total: 21.333, sample: 0.400, forward: 0.516, backward: 12.337, update: 0.439
[proc 5] 500 steps, total: 21.333, sample: 0.379, forward: 0.537, backward: 12.205, update: 0.350
[proc 3] 500 steps, total: 21.333, sample: 0.355, forward: 0.482, backward: 12.396, update: 0.478
[proc 2] 500 steps, total: 21.333, sample: 0.390, forward: 0.496, backward: 12.288, update: 0.431
[proc 1] 500 steps, total: 21.333, sample: 0.409, forward: 0.502, backward: 12.352, update: 0.457
[proc 7] 500 steps, total: 21.333, sample: 0.388, forward: 0.528, backward: 12.213, update: 0.409
[proc 4] 500 steps, total: 21.333, sample: 0.419, forward: 0.489, backward: 12.342, update: 0.477
[proc 0] 500 steps, total: 21.333, sample: 0.432, forward: 0.568, backward: 16.341, update: 3.851
Successfully xmh. training takes 111.40157771110535 seconds
before call kg_cache_controller.StopThreads()
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
INFO [49152 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 29.883 ms                 |
| Forward                   | 5.588 ms                  | 12.030 ms                 |
| Backward                  | 166.184 ms                | 209.031 ms                |
| Optimize                  | 35.977 ms                 | 64.305 ms                 |
| BarrierTimeBeforeRank0    | 51.837 us                 | 131.881 us                |
| BlockToStepN              | 35.776 us                 | 767.447 us                |
| OneStep                   | 213.679 ms                | 268.475 ms                |
+---------------------------+---------------------------+---------------------------+
