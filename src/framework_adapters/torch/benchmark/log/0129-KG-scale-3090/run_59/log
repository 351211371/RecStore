WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 20:13:33.685107 13733 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_11', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [13733 sampler.py:454] Start PreSampling
WARNING [13733 sampler.py:532] Before construct renumbering_dict
WARNING [13733 sampler.py:555] PreSampling done
W20240129 20:32:46.622004 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 20:32:46.622195 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 20:32:46.622236 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 20:32:46.622272 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 20:32:46.622308 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 20:32:46.622341 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 20:32:46.622381 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 20:32:46.622424 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 20:32:46.622454 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 20:32:46.622485 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 20:32:46.622519 13733 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 20:32:46.622546 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 20:32:46.622576 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 20:32:46.622730 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 20:32:46.622761 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 20:32:46.622787 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 20:32:46.622833 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 20:32:46.622860 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 20:32:46.622897 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 20:32:46.622926 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 20:32:46.622953 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 20:32:46.622988 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 20:32:46.623020 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 20:32:46.623049 13733 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 20:32:46.623070 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 20:32:46.623092 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 20:32:46.623142 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 20:32:46.623172 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 20:32:46.623203 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 20:32:46.623229 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 20:32:46.623255 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 20:32:46.623289 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 20:32:46.623317 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 20:32:46.623349 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 20:32:46.623389 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 20:32:46.623425 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 20:32:46.623453 13733 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 20:32:46.623476 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 20:32:46.623497 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 20:32:46.623550 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 20:32:46.623582 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 20:32:46.623608 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 20:32:46.623637 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 20:32:46.623665 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 20:32:46.623694 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 20:32:46.623732 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 20:32:46.623760 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 20:32:46.623786 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 20:32:46.623816 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 20:32:46.623840 13733 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 20:32:46.623862 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 20:32:46.623884 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 20:32:46.623940 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 20:32:46.623983 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 20:32:46.624011 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 20:32:46.624037 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 20:32:46.624080 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 20:32:46.624116 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 20:32:46.624152 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 20:32:46.624179 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 20:32:46.624212 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 20:32:46.624246 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 20:32:46.624280 13733 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 20:32:46.624303 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 20:32:46.624329 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 20:32:46.624380 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 20:32:46.624416 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 20:32:46.624450 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 20:32:46.624480 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 20:32:46.624506 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 20:32:46.624545 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 20:32:46.624580 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 20:32:46.624614 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 20:32:46.624641 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 20:32:46.624677 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 20:32:46.624706 13733 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 20:32:46.624729 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 20:32:46.624751 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 20:32:46.624804 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 20:32:46.624833 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 20:32:46.624866 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 20:32:46.624898 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 20:32:46.624927 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 20:32:46.624961 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 20:32:46.624998 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 20:32:46.625032 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 20:32:46.625061 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 20:32:46.625090 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 20:32:46.625121 13733 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 20:32:46.625144 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 20:32:46.625167 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 20:32:46.625217 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 20:32:46.625253 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 20:32:46.625289 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 20:32:46.625329 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 20:32:46.625365 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 20:32:46.625397 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 20:32:46.625425 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 20:32:46.625452 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 20:32:46.625489 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 20:32:46.625524 13733 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 20:32:46.625551 13733 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 20:32:46.625574 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 20:32:46.625597 13733 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 20:32:47.028805 13733 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240129 20:32:47.028954 13733 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302765,  4302814,    98963,  ..., 61186779, 68271145,  4916069]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1662.205 seconds
[Rank1] pid = 14719
[Rank2] pid = 14814
[Rank3] pid = 14881
[Rank4] pid = 14950
[Rank5] pid = 15017
[Rank6] pid = 15084
INFO [13733 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [14719 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [15084 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [14881 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [15151 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [14950 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [15017 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [14814 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [13733 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14814 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14881 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15017 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15084 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14950 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [15151 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14719 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [13733 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14814 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14719 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [15017 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [15084 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14881 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [15151 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14950 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 20:41:36.998337 14951 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 20:41:36.998661 14720 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:36.998941 15152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:36.999140 15085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:36.999972 15018 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:37.000165 15215 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:37.000322 14882 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 20:41:37.000486 14815 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240129 20:41:38.733475 14882 recstore.cc:66] init folly done
E20240129 20:41:38.733479 15152 recstore.cc:66] init folly done
E20240129 20:41:38.733573 14815 recstore.cc:66] init folly done
E20240129 20:41:38.733587 15085 recstore.cc:66] init folly done
E20240129 20:41:38.733628 15018 recstore.cc:66] init folly done
E20240129 20:41:38.733631 14720 recstore.cc:66] init folly done
E20240129 20:41:38.733675 15215 recstore.cc:66] init folly done
E20240129 20:41:38.733688 14951 recstore.cc:66] init folly done
I20240129 20:41:44.600992 15152 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240129 20:41:44.687182 14951 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:45.170881 15018 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:46.826535 14882 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:47.293969 15215 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:47.531047 14720 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:47.823709 14815 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 20:41:48.012907 15085 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 27.747 ms                 | 29.506 ms                 |
| bucket keys               | 2.920 ms                  | 123.553 ms                |
| forward: a2a keys         | 6.740 ms                  | 1.217 s                   |
| forward: search cache     | 457.986 us                | 23.830 ms                 |
| forward: a2a values       | 7.760 ms                  | 43.000 ms                 |
| forward: join             | 1.766 ms                  | 2.847 ms                  |
| Forward                   | 57.089 ms                 | 1.939 s                   |
| back: aggr dram keys      | 63.733 ms                 | 914.341 ms                |
| back: set dram grad       | 5.756 ms                  | 13.105 ms                 |
| back: a2a grad            | 11.103 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 5.072 ms                  | 178.497 ms                |
| Backward                  | 315.606 ms                | 1.379 s                   |
| Optimize                  | 26.519 ms                 | 34.618 ms                 |
| BarrierTimeBeforeRank0    | 46.736 us                 | 53.559 us                 |
| BlockToStepN              | 38.373 us                 | 41.903 us                 |
| OneStep                   | 412.858 ms                | 3.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.046 ms                 | 108.749 ms                |
| bucket keys               | 2.961 ms                  | 123.553 ms                |
| forward: a2a keys         | 6.881 ms                  | 1.217 s                   |
| forward: search cache     | 469.485 us                | 23.830 ms                 |
| forward: a2a values       | 17.774 ms                 | 49.360 ms                 |
| forward: join             | 1.766 ms                  | 4.118 ms                  |
| Forward                   | 53.251 ms                 | 1.939 s                   |
| back: aggr dram keys      | 38.794 ms                 | 914.341 ms                |
| back: set dram grad       | 4.399 ms                  | 13.105 ms                 |
| back: a2a grad            | 22.825 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 5.523 ms                  | 178.497 ms                |
| Backward                  | 264.668 ms                | 1.379 s                   |
| Optimize                  | 26.519 ms                 | 40.964 ms                 |
| BarrierTimeBeforeRank0    | 48.673 us                 | 67.394 us                 |
| BlockToStepN              | 41.734 us                 | 9.138 ms                  |
| OneStep                   | 384.953 ms                | 3.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.480 ms                 | 108.749 ms                |
| bucket keys               | 2.961 ms                  | 5.030 ms                  |
| forward: a2a keys         | 7.096 ms                  | 206.834 ms                |
| forward: search cache     | 469.815 us                | 1.144 ms                  |
| forward: a2a values       | 17.774 ms                 | 43.000 ms                 |
| forward: join             | 2.276 ms                  | 3.228 ms                  |
| Forward                   | 54.274 ms                 | 1.939 s                   |
| back: aggr dram keys      | 38.794 ms                 | 117.777 ms                |
| back: set dram grad       | 4.399 ms                  | 12.491 ms                 |
| back: a2a grad            | 25.326 ms                 | 52.389 ms                 |
| back: grad sum & grad cache  | 8.421 ms                  | 169.742 ms                |
| Backward                  | 279.400 ms                | 1.379 s                   |
| Optimize                  | 26.519 ms                 | 42.434 ms                 |
| BarrierTimeBeforeRank0    | 48.673 us                 | 67.394 us                 |
| BlockToStepN              | 43.509 us                 | 9.138 ms                  |
| OneStep                   | 385.438 ms                | 3.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.393 ms                  | 114.409 ms                |
| bucket keys               | 3.588 ms                  | 5.136 ms                  |
| forward: a2a keys         | 6.740 ms                  | 206.834 ms                |
| forward: search cache     | 470.023 us                | 1.144 ms                  |
| forward: a2a values       | 17.081 ms                 | 49.360 ms                 |
| forward: join             | 2.522 ms                  | 4.118 ms                  |
| Forward                   | 53.362 ms                 | 1.939 s                   |
| back: aggr dram keys      | 38.794 ms                 | 136.737 ms                |
| back: set dram grad       | 4.399 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.326 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 8.421 ms                  | 169.742 ms                |
| Backward                  | 273.914 ms                | 1.379 s                   |
| Optimize                  | 26.220 ms                 | 42.434 ms                 |
| BarrierTimeBeforeRank0    | 46.736 us                 | 67.394 us                 |
| BlockToStepN              | 46.907 us                 | 9.138 ms                  |
| OneStep                   | 381.012 ms                | 3.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.296 ms                  | 108.749 ms                |
| bucket keys               | 3.337 ms                  | 11.383 ms                 |
| forward: a2a keys         | 7.110 ms                  | 206.834 ms                |
| forward: search cache     | 469.705 us                | 1.144 ms                  |
| forward: a2a values       | 16.569 ms                 | 49.360 ms                 |
| forward: join             | 2.522 ms                  | 4.118 ms                  |
| Forward                   | 55.396 ms                 | 255.871 ms                |
| back: aggr dram keys      | 45.685 ms                 | 136.737 ms                |
| back: set dram grad       | 4.399 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.326 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 8.421 ms                  | 169.742 ms                |
| Backward                  | 273.891 ms                | 332.339 ms                |
| Optimize                  | 26.197 ms                 | 40.964 ms                 |
| BarrierTimeBeforeRank0    | 45.961 us                 | 75.233 us                 |
| BlockToStepN              | 49.117 us                 | 10.921 ms                 |
| OneStep                   | 378.848 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.764 ms                  | 108.749 ms                |
| bucket keys               | 3.588 ms                  | 11.383 ms                 |
| forward: a2a keys         | 7.432 ms                  | 206.834 ms                |
| forward: search cache     | 469.322 us                | 1.144 ms                  |
| forward: a2a values       | 16.569 ms                 | 49.360 ms                 |
| forward: join             | 2.527 ms                  | 4.118 ms                  |
| Forward                   | 56.853 ms                 | 255.871 ms                |
| back: aggr dram keys      | 45.685 ms                 | 136.737 ms                |
| back: set dram grad       | 4.399 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.326 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 8.421 ms                  | 169.742 ms                |
| Backward                  | 273.016 ms                | 332.339 ms                |
| Optimize                  | 26.230 ms                 | 40.964 ms                 |
| BarrierTimeBeforeRank0    | 42.343 us                 | 75.233 us                 |
| BlockToStepN              | 46.907 us                 | 10.921 ms                 |
| OneStep                   | 376.267 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.261 ms                  | 108.749 ms                |
| bucket keys               | 3.588 ms                  | 5.136 ms                  |
| forward: a2a keys         | 7.362 ms                  | 186.140 ms                |
| forward: search cache     | 469.214 us                | 1.048 ms                  |
| forward: a2a values       | 16.569 ms                 | 43.654 ms                 |
| forward: join             | 2.527 ms                  | 3.337 ms                  |
| Forward                   | 56.853 ms                 | 255.871 ms                |
| back: aggr dram keys      | 45.685 ms                 | 117.777 ms                |
| back: set dram grad       | 4.399 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.579 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 8.421 ms                  | 169.039 ms                |
| Backward                  | 274.824 ms                | 351.673 ms                |
| Optimize                  | 26.519 ms                 | 42.434 ms                 |
| BarrierTimeBeforeRank0    | 40.527 us                 | 75.233 us                 |
| BlockToStepN              | 46.667 us                 | 10.921 ms                 |
| OneStep                   | 378.732 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.443 ms                  | 108.749 ms                |
| bucket keys               | 3.588 ms                  | 6.021 ms                  |
| forward: a2a keys         | 7.250 ms                  | 186.140 ms                |
| forward: search cache     | 469.374 us                | 1.048 ms                  |
| forward: a2a values       | 16.761 ms                 | 49.360 ms                 |
| forward: join             | 2.527 ms                  | 3.337 ms                  |
| Forward                   | 57.190 ms                 | 255.871 ms                |
| back: aggr dram keys      | 46.473 ms                 | 117.777 ms                |
| back: set dram grad       | 4.653 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.800 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 169.039 ms                |
| Backward                  | 276.539 ms                | 365.636 ms                |
| Optimize                  | 28.655 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 40.135 us                 | 75.233 us                 |
| BlockToStepN              | 47.973 us                 | 11.178 ms                 |
| OneStep                   | 384.953 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 45.716, sample: 1.742, forward: 9.327, backward: 15.707, update: 0.494
[Rank7] pid = 15151
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   92048,    92087,    92135,   162126,  5827421,   162171, 66328016,
        19363053,    92185,    92238]) tensor([ 5146551, 13357664, 69365613, 80597458, 21849770, 37472476, 43477634,
        73206097, 59574750, 25042251])
-------Step 1-------
tensor([   92048,    92087,    92135,   162126,  5827421,   162171, 66328016,
        19363053,    92185,    92238]) tensor([76722306, 23904737, 10953260, 69253438, 70223838, 36478752, 60146237,
        61834295, 33800156, 14159012])
-------Step 2-------
tensor([  203778,   203817,   184711,    29378,   203870,   203918,   203972,
        31075171,   204032,   204078]) tensor([78581177, 28829371, 68104444, 56050386, 42992739, 24413664, 76900736,
        34453014, 12619751, 35794928])
-------Step 3-------
tensor([  203778,   203817,   184711,    29378,   203870,   203918,   203972,
        31075171,   204032,   204078]) tensor([47339123, 71689890, 39365966, 45985677, 54334054, 77021278, 44794572,
        17824099, 22766738,   799995])
-------Step 4-------
tensor([  310719, 54362473,   310755,   310804,   310847,   310900,   206249,
        47892903,   310948,   206285]) tensor([68176418, 10511522, 85812727, 19287013, 72671213, 35212231, 58054030,
        45231393, 71980407, 60969070])
-------Step 5-------
tensor([  310719, 54362473,   310755,   310804,   310847,   310900,   206249,
        47892903,   310948,   206285]) tensor([44356724, 79724543,   360854, 85314604, 48912507, 54928044, 13150514,
        11239339, 77562491, 37920576])
-------Step 6-------
tensor([  410202,   284776,   410229,   410255,    63448, 65401307,   410277,
          410302,   410322, 43912430]) tensor([13660583, 43280443, 29663104, 85355522, 42008301, 43532665, 29992127,
         6920325, 76466312, 70169237])
-------Step 7-------
tensor([  410202,   284776,   410229,   410255,    63448, 65401307,   410277,
          410302,   410322, 43912430]) tensor([30058916, 65771566, 80724859, 56538653, 83229740, 64378370, 60685846,
        55319365, 40310176, 41362871])
-------Step 8-------
tensor([  461290, 28482413,   461310,   461330,   461355,    80058,   461376,
          461398,   461418,   461441]) tensor([49424804, 31112383, 30004689, 26555534, 62766393, 55037218, 17964484,
        73495740,  1452427, 51911434])
-------Step 9-------
tensor([  461290, 28482413,   461310,   461330,   461355,    80058,   461376,
          461398,   461418,   461441]) tensor([46918907, 31207756, 16048774, 45847100,  8181693, 33918614, 22813518,
        31720948, 82320307, 56468453])
before start barrier
start train
[proc 0] 100 steps, total: 43.109, sample: 1.626, forward: 8.902, backward: 28.720, update: 2.958
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 42.872, sample: 2.107, forward: 8.977, backward: 16.535, update: 0.410
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 42.390, sample: 1.418, forward: 9.718, backward: 15.712, update: 0.450
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 45.232, sample: 1.720, forward: 9.347, backward: 15.762, update: 0.468
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 43.577, sample: 1.453, forward: 9.621, backward: 15.985, update: 0.488
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 42.579, sample: 2.320, forward: 8.801, backward: 15.978, update: 0.513
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 45.802, sample: 1.347, forward: 9.732, backward: 15.964, update: 0.464
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.956 ms                  | 108.749 ms                |
| bucket keys               | 3.067 ms                  | 6.021 ms                  |
| forward: a2a keys         | 7.459 ms                  | 186.140 ms                |
| forward: search cache     | 468.823 us                | 1.048 ms                  |
| forward: a2a values       | 16.078 ms                 | 49.360 ms                 |
| forward: join             | 1.905 ms                  | 3.337 ms                  |
| Forward                   | 57.217 ms                 | 255.871 ms                |
| back: aggr dram keys      | 46.473 ms                 | 117.777 ms                |
| back: set dram grad       | 4.523 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.579 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 169.039 ms                |
| Backward                  | 275.524 ms                | 365.636 ms                |
| Optimize                  | 27.371 ms                 | 59.021 ms                 |
| BarrierTimeBeforeRank0    | 40.354 us                 | 88.327 us                 |
| BlockToStepN              | 48.480 us                 | 11.178 ms                 |
| OneStep                   | 381.012 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.633 ms                  | 108.749 ms                |
| bucket keys               | 3.067 ms                  | 6.021 ms                  |
| forward: a2a keys         | 7.560 ms                  | 186.140 ms                |
| forward: search cache     | 468.823 us                | 1.144 ms                  |
| forward: a2a values       | 16.078 ms                 | 49.360 ms                 |
| forward: join             | 1.905 ms                  | 3.337 ms                  |
| Forward                   | 56.867 ms                 | 255.871 ms                |
| back: aggr dram keys      | 45.685 ms                 | 117.777 ms                |
| back: set dram grad       | 4.292 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.493 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 169.039 ms                |
| Backward                  | 273.914 ms                | 365.636 ms                |
| Optimize                  | 26.857 ms                 | 59.021 ms                 |
| BarrierTimeBeforeRank0    | 40.354 us                 | 88.327 us                 |
| BlockToStepN              | 49.121 us                 | 11.178 ms                 |
| OneStep                   | 372.922 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.845 ms                  | 108.749 ms                |
| bucket keys               | 3.064 ms                  | 5.564 ms                  |
| forward: a2a keys         | 7.417 ms                  | 180.985 ms                |
| forward: search cache     | 468.633 us                | 1.048 ms                  |
| forward: a2a values       | 16.078 ms                 | 45.107 ms                 |
| forward: join             | 1.905 ms                  | 3.228 ms                  |
| Forward                   | 56.522 ms                 | 255.871 ms                |
| back: aggr dram keys      | 40.093 ms                 | 113.923 ms                |
| back: set dram grad       | 4.292 ms                  | 12.721 ms                 |
| back: a2a grad            | 25.493 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 168.322 ms                |
| Backward                  | 271.088 ms                | 365.636 ms                |
| Optimize                  | 26.801 ms                 | 59.021 ms                 |
| BarrierTimeBeforeRank0    | 40.130 us                 | 88.327 us                 |
| BlockToStepN              | 47.829 us                 | 11.178 ms                 |
| OneStep                   | 370.437 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.539 ms                  | 108.749 ms                |
| bucket keys               | 3.064 ms                  | 6.278 ms                  |
| forward: a2a keys         | 7.338 ms                  | 180.985 ms                |
| forward: search cache     | 468.949 us                | 1.048 ms                  |
| forward: a2a values       | 16.078 ms                 | 45.107 ms                 |
| forward: join             | 1.905 ms                  | 3.303 ms                  |
| Forward                   | 56.555 ms                 | 255.871 ms                |
| back: aggr dram keys      | 45.685 ms                 | 113.923 ms                |
| back: set dram grad       | 4.358 ms                  | 13.105 ms                 |
| back: a2a grad            | 25.493 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 168.322 ms                |
| Backward                  | 269.256 ms                | 365.636 ms                |
| Optimize                  | 26.903 ms                 | 59.021 ms                 |
| BarrierTimeBeforeRank0    | 40.130 us                 | 88.327 us                 |
| BlockToStepN              | 47.402 us                 | 13.453 ms                 |
| OneStep                   | 370.572 ms                | 685.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.710 ms                  | 98.104 ms                 |
| bucket keys               | 3.068 ms                  | 6.278 ms                  |
| forward: a2a keys         | 7.145 ms                  | 180.985 ms                |
| forward: search cache     | 469.108 us                | 1.048 ms                  |
| forward: a2a values       | 16.078 ms                 | 49.360 ms                 |
| forward: join             | 1.912 ms                  | 3.693 ms                  |
| Forward                   | 56.486 ms                 | 236.765 ms                |
| back: aggr dram keys      | 43.855 ms                 | 113.923 ms                |
| back: set dram grad       | 4.292 ms                  | 13.105 ms                 |
| back: a2a grad            | 25.493 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 168.322 ms                |
| Backward                  | 268.675 ms                | 351.673 ms                |
| Optimize                  | 27.160 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 40.135 us                 | 88.327 us                 |
| BlockToStepN              | 47.098 us                 | 11.279 ms                 |
| OneStep                   | 370.572 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.707 ms                  | 98.104 ms                 |
| bucket keys               | 3.078 ms                  | 11.383 ms                 |
| forward: a2a keys         | 7.145 ms                  | 180.985 ms                |
| forward: search cache     | 469.244 us                | 1.048 ms                  |
| forward: a2a values       | 16.078 ms                 | 49.360 ms                 |
| forward: join             | 1.930 ms                  | 3.715 ms                  |
| Forward                   | 56.522 ms                 | 236.765 ms                |
| back: aggr dram keys      | 43.855 ms                 | 113.923 ms                |
| back: set dram grad       | 4.292 ms                  | 13.105 ms                 |
| back: a2a grad            | 25.525 ms                 | 55.825 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 168.322 ms                |
| Backward                  | 269.256 ms                | 351.673 ms                |
| Optimize                  | 27.371 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 40.125 us                 | 88.327 us                 |
| BlockToStepN              | 47.402 us                 | 11.279 ms                 |
| OneStep                   | 371.688 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.517 ms                  | 98.104 ms                 |
| bucket keys               | 3.089 ms                  | 6.278 ms                  |
| forward: a2a keys         | 7.266 ms                  | 129.108 ms                |
| forward: search cache     | 469.815 us                | 1.033 ms                  |
| forward: a2a values       | 14.477 ms                 | 45.107 ms                 |
| forward: join             | 1.930 ms                  | 3.693 ms                  |
| Forward                   | 56.555 ms                 | 236.765 ms                |
| back: aggr dram keys      | 43.855 ms                 | 93.118 ms                 |
| back: set dram grad       | 4.292 ms                  | 12.819 ms                 |
| back: a2a grad            | 25.295 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 163.339 ms                |
| Backward                  | 264.995 ms                | 351.673 ms                |
| Optimize                  | 27.456 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 40.130 us                 | 88.327 us                 |
| BlockToStepN              | 47.098 us                 | 11.279 ms                 |
| OneStep                   | 367.837 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 35.068, sample: 1.317, forward: 6.133, backward: 24.581, update: 2.866
[proc 6] 200 steps, total: 35.068, sample: 1.278, forward: 6.577, backward: 13.548, update: 0.473
[proc 5] 200 steps, total: 35.068, sample: 1.533, forward: 6.306, backward: 13.614, update: 0.472
[proc 3] 200 steps, total: 35.068, sample: 1.216, forward: 6.628, backward: 13.859, update: 0.480
[proc 4] 200 steps, total: 35.068, sample: 1.360, forward: 6.485, backward: 13.620, update: 0.509
[proc 7] 200 steps, total: 35.067, sample: 1.274, forward: 6.599, backward: 13.827, update: 0.501
[proc 1] 200 steps, total: 35.068, sample: 1.763, forward: 6.096, backward: 14.352, update: 0.419
[proc 2] 200 steps, total: 35.068, sample: 1.187, forward: 6.657, backward: 13.909, update: 0.473
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.263 ms                  | 98.104 ms                 |
| bucket keys               | 3.108 ms                  | 11.383 ms                 |
| forward: a2a keys         | 7.192 ms                  | 129.108 ms                |
| forward: search cache     | 469.954 us                | 1.048 ms                  |
| forward: a2a values       | 14.443 ms                 | 45.107 ms                 |
| forward: join             | 1.934 ms                  | 3.715 ms                  |
| Forward                   | 56.555 ms                 | 236.765 ms                |
| back: aggr dram keys      | 45.685 ms                 | 93.118 ms                 |
| back: set dram grad       | 4.292 ms                  | 13.105 ms                 |
| back: a2a grad            | 24.197 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 163.339 ms                |
| Backward                  | 260.487 ms                | 351.673 ms                |
| Optimize                  | 28.003 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 39.882 us                 | 88.327 us                 |
| BlockToStepN              | 48.220 us                 | 11.279 ms                 |
| OneStep                   | 364.575 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.263 ms                  | 99.902 ms                 |
| bucket keys               | 3.123 ms                  | 11.383 ms                 |
| forward: a2a keys         | 7.101 ms                  | 129.108 ms                |
| forward: search cache     | 470.157 us                | 1.072 ms                  |
| forward: a2a values       | 14.142 ms                 | 45.107 ms                 |
| forward: join             | 1.934 ms                  | 3.715 ms                  |
| Forward                   | 56.467 ms                 | 236.765 ms                |
| back: aggr dram keys      | 48.983 ms                 | 93.118 ms                 |
| back: set dram grad       | 3.889 ms                  | 13.105 ms                 |
| back: a2a grad            | 23.285 ms                 | 54.655 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 163.339 ms                |
| Backward                  | 258.379 ms                | 351.673 ms                |
| Optimize                  | 28.697 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 39.882 us                 | 88.327 us                 |
| BlockToStepN              | 47.803 us                 | 11.279 ms                 |
| OneStep                   | 360.895 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.263 ms                  | 99.902 ms                 |
| bucket keys               | 3.123 ms                  | 10.608 ms                 |
| forward: a2a keys         | 7.035 ms                  | 108.910 ms                |
| forward: search cache     | 470.388 us                | 1.072 ms                  |
| forward: a2a values       | 14.148 ms                 | 45.107 ms                 |
| forward: join             | 2.579 ms                  | 4.118 ms                  |
| Forward                   | 56.410 ms                 | 236.765 ms                |
| back: aggr dram keys      | 52.031 ms                 | 91.610 ms                 |
| back: set dram grad       | 3.889 ms                  | 12.819 ms                 |
| back: a2a grad            | 22.280 ms                 | 54.210 ms                 |
| back: grad sum & grad cache  | 34.940 ms                 | 163.164 ms                |
| Backward                  | 253.910 ms                | 351.673 ms                |
| Optimize                  | 29.275 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 39.797 us                 | 88.327 us                 |
| BlockToStepN              | 46.907 us                 | 17.501 ms                 |
| OneStep                   | 355.113 ms                | 626.041 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.136 ms                  | 98.104 ms                 |
| bucket keys               | 3.262 ms                  | 10.608 ms                 |
| forward: a2a keys         | 7.014 ms                  | 108.910 ms                |
| forward: search cache     | 470.485 us                | 1.242 ms                  |
| forward: a2a values       | 11.509 ms                 | 45.107 ms                 |
| forward: join             | 2.599 ms                  | 4.994 ms                  |
| Forward                   | 56.403 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.577 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.292 ms                  | 13.105 ms                 |
| back: a2a grad            | 21.341 ms                 | 54.210 ms                 |
| back: grad sum & grad cache  | 29.692 ms                 | 163.164 ms                |
| Backward                  | 249.069 ms                | 350.661 ms                |
| Optimize                  | 29.179 ms                 | 50.534 ms                 |
| BarrierTimeBeforeRank0    | 39.557 us                 | 75.779 us                 |
| BlockToStepN              | 45.637 us                 | 13.453 ms                 |
| OneStep                   | 349.042 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.912 ms                  | 98.104 ms                 |
| bucket keys               | 3.262 ms                  | 10.608 ms                 |
| forward: a2a keys         | 7.011 ms                  | 108.910 ms                |
| forward: search cache     | 470.023 us                | 1.242 ms                  |
| forward: a2a values       | 10.264 ms                 | 45.107 ms                 |
| forward: join             | 2.602 ms                  | 4.994 ms                  |
| Forward                   | 55.749 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.577 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.451 ms                  | 13.105 ms                 |
| back: a2a grad            | 17.912 ms                 | 54.210 ms                 |
| back: grad sum & grad cache  | 23.422 ms                 | 163.164 ms                |
| Backward                  | 240.792 ms                | 350.661 ms                |
| Optimize                  | 29.207 ms                 | 52.673 ms                 |
| BarrierTimeBeforeRank0    | 39.345 us                 | 75.779 us                 |
| BlockToStepN              | 44.090 us                 | 17.501 ms                 |
| OneStep                   | 345.117 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.912 ms                  | 98.104 ms                 |
| bucket keys               | 3.262 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.937 ms                  | 88.031 ms                 |
| forward: search cache     | 469.485 us                | 1.242 ms                  |
| forward: a2a values       | 9.959 ms                  | 44.694 ms                 |
| forward: join             | 2.605 ms                  | 4.739 ms                  |
| Forward                   | 55.402 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.579 ms                 | 90.939 ms                 |
| back: set dram grad       | 4.506 ms                  | 12.819 ms                 |
| back: a2a grad            | 15.621 ms                 | 52.436 ms                 |
| back: grad sum & grad cache  | 23.179 ms                 | 161.154 ms                |
| Backward                  | 238.195 ms                | 350.661 ms                |
| Optimize                  | 29.616 ms                 | 52.673 ms                 |
| BarrierTimeBeforeRank0    | 39.263 us                 | 75.779 us                 |
| BlockToStepN              | 45.529 us                 | 17.501 ms                 |
| OneStep                   | 342.095 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 28.905, sample: 1.026, forward: 6.037, backward: 15.028, update: 0.495
[proc 7] 300 steps, total: 28.904, sample: 0.979, forward: 6.088, backward: 15.085, update: 0.499
[proc 2] 300 steps, total: 28.904, sample: 0.839, forward: 6.218, backward: 15.182, update: 0.499
[proc 0] 300 steps, total: 28.905, sample: 1.156, forward: 5.509, backward: 18.830, update: 3.209
[proc 5] 300 steps, total: 28.905, sample: 1.097, forward: 5.934, backward: 15.028, update: 0.512
[proc 1] 300 steps, total: 28.904, sample: 1.103, forward: 5.927, backward: 15.499, update: 0.426
[proc 3] 300 steps, total: 28.905, sample: 0.986, forward: 6.036, backward: 15.214, update: 0.506
[proc 4] 300 steps, total: 28.905, sample: 1.050, forward: 5.966, backward: 15.102, update: 0.495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.747 ms                  | 98.104 ms                 |
| bucket keys               | 3.262 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.861 ms                  | 88.031 ms                 |
| forward: search cache     | 469.214 us                | 1.242 ms                  |
| forward: a2a values       | 9.898 ms                  | 44.694 ms                 |
| forward: join             | 2.605 ms                  | 4.739 ms                  |
| Forward                   | 54.948 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.577 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.521 ms                  | 12.819 ms                 |
| back: a2a grad            | 14.326 ms                 | 52.436 ms                 |
| back: grad sum & grad cache  | 23.114 ms                 | 161.154 ms                |
| Backward                  | 232.644 ms                | 350.661 ms                |
| Optimize                  | 29.765 ms                 | 52.673 ms                 |
| BarrierTimeBeforeRank0    | 39.210 us                 | 75.779 us                 |
| BlockToStepN              | 43.764 us                 | 17.501 ms                 |
| OneStep                   | 337.170 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.649 ms                  | 98.104 ms                 |
| bucket keys               | 3.262 ms                  | 6.278 ms                  |
| forward: a2a keys         | 6.841 ms                  | 77.282 ms                 |
| forward: search cache     | 469.051 us                | 1.144 ms                  |
| forward: a2a values       | 9.898 ms                  | 44.694 ms                 |
| forward: join             | 2.605 ms                  | 4.527 ms                  |
| Forward                   | 54.685 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.577 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.506 ms                  | 12.721 ms                 |
| back: a2a grad            | 13.555 ms                 | 52.389 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 159.446 ms                |
| Backward                  | 229.247 ms                | 350.661 ms                |
| Optimize                  | 30.017 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 39.000 us                 | 75.779 us                 |
| BlockToStepN              | 43.168 us                 | 17.501 ms                 |
| OneStep                   | 331.113 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.599 ms                  | 98.104 ms                 |
| bucket keys               | 3.255 ms                  | 6.278 ms                  |
| forward: a2a keys         | 6.825 ms                  | 77.282 ms                 |
| forward: search cache     | 468.949 us                | 1.242 ms                  |
| forward: a2a values       | 9.879 ms                  | 44.694 ms                 |
| forward: join             | 2.615 ms                  | 4.739 ms                  |
| Forward                   | 54.547 ms                 | 228.001 ms                |
| back: aggr dram keys      | 55.577 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.506 ms                  | 12.819 ms                 |
| back: a2a grad            | 13.338 ms                 | 52.389 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 159.446 ms                |
| Backward                  | 226.078 ms                | 350.661 ms                |
| Optimize                  | 30.416 ms                 | 57.863 ms                 |
| BarrierTimeBeforeRank0    | 38.930 us                 | 75.779 us                 |
| BlockToStepN              | 42.843 us                 | 17.501 ms                 |
| OneStep                   | 328.946 ms                | 620.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.586 ms                  | 97.899 ms                 |
| bucket keys               | 3.172 ms                  | 6.278 ms                  |
| forward: a2a keys         | 6.674 ms                  | 77.282 ms                 |
| forward: search cache     | 468.846 us                | 1.242 ms                  |
| forward: a2a values       | 9.879 ms                  | 44.694 ms                 |
| forward: join             | 2.615 ms                  | 4.739 ms                  |
| Forward                   | 54.039 ms                 | 181.891 ms                |
| back: aggr dram keys      | 56.093 ms                 | 91.610 ms                 |
| back: set dram grad       | 4.522 ms                  | 12.819 ms                 |
| back: a2a grad            | 13.357 ms                 | 52.389 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 159.446 ms                |
| Backward                  | 220.820 ms                | 346.018 ms                |
| Optimize                  | 30.586 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 38.837 us                 | 75.233 us                 |
| BlockToStepN              | 42.385 us                 | 17.501 ms                 |
| OneStep                   | 323.838 ms                | 579.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.606 ms                  | 97.899 ms                 |
| bucket keys               | 3.172 ms                  | 6.021 ms                  |
| forward: a2a keys         | 6.631 ms                  | 71.198 ms                 |
| forward: search cache     | 468.812 us                | 1.242 ms                  |
| forward: a2a values       | 9.879 ms                  | 43.654 ms                 |
| forward: join             | 2.620 ms                  | 4.527 ms                  |
| Forward                   | 53.557 ms                 | 181.891 ms                |
| back: aggr dram keys      | 56.340 ms                 | 90.939 ms                 |
| back: set dram grad       | 4.533 ms                  | 12.721 ms                 |
| back: a2a grad            | 13.361 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 158.281 ms                |
| Backward                  | 215.241 ms                | 346.018 ms                |
| Optimize                  | 30.716 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 38.754 us                 | 75.233 us                 |
| BlockToStepN              | 41.516 us                 | 17.501 ms                 |
| OneStep                   | 317.099 ms                | 579.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.444 ms                  | 97.899 ms                 |
| bucket keys               | 3.172 ms                  | 6.278 ms                  |
| forward: a2a keys         | 6.550 ms                  | 71.198 ms                 |
| forward: search cache     | 468.858 us                | 1.242 ms                  |
| forward: a2a values       | 9.282 ms                  | 43.654 ms                 |
| forward: join             | 2.624 ms                  | 4.527 ms                  |
| Forward                   | 53.092 ms                 | 181.891 ms                |
| back: aggr dram keys      | 56.544 ms                 | 90.939 ms                 |
| back: set dram grad       | 4.545 ms                  | 13.105 ms                 |
| back: a2a grad            | 13.367 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 158.281 ms                |
| Backward                  | 212.960 ms                | 346.018 ms                |
| Optimize                  | 30.821 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 38.549 us                 | 75.233 us                 |
| BlockToStepN              | 40.835 us                 | 17.501 ms                 |
| OneStep                   | 314.614 ms                | 579.043 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 28.071, sample: 0.967, forward: 5.489, backward: 16.252, update: 0.412
[proc 0] 400 steps, total: 28.071, sample: 1.061, forward: 5.087, backward: 18.296, update: 3.423
[proc 7] 400 steps, total: 28.071, sample: 0.907, forward: 5.559, backward: 15.834, update: 0.512
[proc 6] 400 steps, total: 28.071, sample: 0.938, forward: 5.532, backward: 15.770, update: 0.506
[proc 2] 400 steps, total: 28.071, sample: 0.842, forward: 5.631, backward: 15.909, update: 0.507
[proc 3] 400 steps, total: 28.071, sample: 0.966, forward: 5.482, backward: 15.902, update: 0.504
[proc 5] 400 steps, total: 28.071, sample: 0.962, forward: 5.495, backward: 15.779, update: 0.510
[proc 4] 400 steps, total: 28.071, sample: 0.977, forward: 5.461, backward: 15.826, update: 0.520
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.315 ms                  | 97.899 ms                 |
| bucket keys               | 3.255 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.478 ms                  | 71.198 ms                 |
| forward: search cache     | 468.962 us                | 1.242 ms                  |
| forward: a2a values       | 9.146 ms                  | 43.654 ms                 |
| forward: join             | 2.630 ms                  | 4.814 ms                  |
| Forward                   | 52.864 ms                 | 181.891 ms                |
| back: aggr dram keys      | 56.592 ms                 | 90.939 ms                 |
| back: set dram grad       | 4.556 ms                  | 13.105 ms                 |
| back: a2a grad            | 13.403 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 158.281 ms                |
| Backward                  | 209.761 ms                | 346.018 ms                |
| Optimize                  | 30.887 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 38.549 us                 | 75.233 us                 |
| BlockToStepN              | 40.155 us                 | 17.501 ms                 |
| OneStep                   | 310.389 ms                | 579.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.306 ms                  | 97.899 ms                 |
| bucket keys               | 3.255 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.347 ms                  | 63.445 ms                 |
| forward: search cache     | 469.050 us                | 1.144 ms                  |
| forward: a2a values       | 8.922 ms                  | 43.000 ms                 |
| forward: join             | 2.634 ms                  | 4.739 ms                  |
| Forward                   | 52.787 ms                 | 181.891 ms                |
| back: aggr dram keys      | 56.611 ms                 | 89.660 ms                 |
| back: set dram grad       | 4.571 ms                  | 12.819 ms                 |
| back: a2a grad            | 13.411 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 154.607 ms                |
| Backward                  | 205.494 ms                | 346.018 ms                |
| Optimize                  | 30.928 ms                 | 55.584 ms                 |
| BarrierTimeBeforeRank0    | 38.506 us                 | 75.233 us                 |
| BlockToStepN              | 39.926 us                 | 20.779 ms                 |
| OneStep                   | 307.039 ms                | 579.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.315 ms                  | 97.567 ms                 |
| bucket keys               | 3.255 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.315 ms                  | 63.445 ms                 |
| forward: search cache     | 469.202 us                | 1.144 ms                  |
| forward: a2a values       | 8.834 ms                  | 43.000 ms                 |
| forward: join             | 2.639 ms                  | 4.739 ms                  |
| Forward                   | 52.373 ms                 | 158.747 ms                |
| back: aggr dram keys      | 56.764 ms                 | 89.660 ms                 |
| back: set dram grad       | 4.576 ms                  | 12.819 ms                 |
| back: a2a grad            | 13.437 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 154.607 ms                |
| Backward                  | 203.282 ms                | 332.339 ms                |
| Optimize                  | 30.936 ms                 | 52.673 ms                 |
| BarrierTimeBeforeRank0    | 38.414 us                 | 68.022 us                 |
| BlockToStepN              | 39.416 us                 | 17.501 ms                 |
| OneStep                   | 304.429 ms                | 544.316 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.279 ms                  | 97.567 ms                 |
| bucket keys               | 3.255 ms                  | 6.917 ms                  |
| forward: a2a keys         | 6.315 ms                  | 63.445 ms                 |
| forward: search cache     | 469.277 us                | 1.144 ms                  |
| forward: a2a values       | 8.836 ms                  | 43.000 ms                 |
| forward: join             | 2.642 ms                  | 4.739 ms                  |
| Forward                   | 52.180 ms                 | 158.747 ms                |
| back: aggr dram keys      | 56.781 ms                 | 89.660 ms                 |
| back: set dram grad       | 4.588 ms                  | 13.105 ms                 |
| back: a2a grad            | 13.438 ms                 | 52.389 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 154.607 ms                |
| Backward                  | 199.939 ms                | 332.339 ms                |
| Optimize                  | 30.946 ms                 | 54.360 ms                 |
| BarrierTimeBeforeRank0    | 38.362 us                 | 68.022 us                 |
| BlockToStepN              | 39.150 us                 | 17.501 ms                 |
| OneStep                   | 303.139 ms                | 544.316 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.213 ms                  | 97.567 ms                 |
| bucket keys               | 3.265 ms                  | 6.859 ms                  |
| forward: a2a keys         | 6.194 ms                  | 62.232 ms                 |
| forward: search cache     | 469.277 us                | 1.144 ms                  |
| forward: a2a values       | 8.836 ms                  | 42.841 ms                 |
| forward: join             | 2.649 ms                  | 4.814 ms                  |
| Forward                   | 52.064 ms                 | 158.747 ms                |
| back: aggr dram keys      | 56.764 ms                 | 88.935 ms                 |
| back: set dram grad       | 4.595 ms                  | 12.819 ms                 |
| back: a2a grad            | 13.411 ms                 | 50.633 ms                 |
| back: grad sum & grad cache  | 22.206 ms                 | 153.207 ms                |
| Backward                  | 197.404 ms                | 332.339 ms                |
| Optimize                  | 30.958 ms                 | 54.360 ms                 |
| BarrierTimeBeforeRank0    | 38.322 us                 | 68.022 us                 |
| BlockToStepN              | 37.756 us                 | 19.093 ms                 |
| OneStep                   | 302.077 ms                | 544.316 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 27.665, sample: 1.084, forward: 5.021, backward: 18.220, update: 3.182
[proc 1] 500 steps, total: 27.665, sample: 0.901, forward: 5.470, backward: 16.302, update: 0.424
[proc 3] 500 steps, total: 27.665, sample: 0.971, forward: 5.412, backward: 15.971, update: 0.496
[proc 2] 500 steps, total: 27.665, sample: 0.898, forward: 5.450, backward: 16.051, update: 0.431
[proc 7] 500 steps, total: 27.665, sample: 0.891, forward: 5.548, backward: 15.827, update: 0.535
[proc 5] 500 steps, total: 27.665, sample: 0.903, forward: 5.472, backward: 15.882, update: 0.512
Successfully xmh. training takes 162.81772899627686 seconds
[proc 6] 500 steps, total: 27.665, sample: 0.933, forward: 5.439, backward: 15.833, update: 0.486
[proc 4] 500 steps, total: 27.665, sample: 0.893, forward: 5.483, backward: 15.871, update: 0.517
before call kg_cache_controller.StopThreads()
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
INFO [13733 controller_process.py:421] call rank0 to StopThreads
