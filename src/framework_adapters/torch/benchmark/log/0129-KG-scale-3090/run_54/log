WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 17:19:27.430501 36987 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_6', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[17:38:52] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 86054151 nodes and 421063214 edges into 8 parts and get 29576304 edge cuts
WARNING [36987 sampler.py:454] Start PreSampling
WARNING [36987 sampler.py:532] Before construct renumbering_dict
WARNING [36987 sampler.py:555] PreSampling done
W20240129 17:50:04.624025 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 17:50:04.624231 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 17:50:04.624269 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 17:50:04.624297 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 17:50:04.624336 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 17:50:04.624379 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 17:50:04.624411 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 17:50:04.624447 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 17:50:04.624473 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 17:50:04.624511 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 17:50:04.624547 36987 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 17:50:04.624572 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 17:50:04.624595 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 17:50:04.624723 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 17:50:04.624766 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 17:50:04.624797 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 17:50:04.624823 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 17:50:04.624848 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 17:50:04.624881 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 17:50:04.624907 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 17:50:04.624940 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 17:50:04.624969 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 17:50:04.625005 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 17:50:04.625031 36987 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 17:50:04.625053 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 17:50:04.625083 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 17:50:04.625135 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 17:50:04.625170 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 17:50:04.625198 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 17:50:04.625231 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 17:50:04.625258 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 17:50:04.625301 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 17:50:04.625332 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 17:50:04.625358 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 17:50:04.625391 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 17:50:04.625416 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 17:50:04.625442 36987 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 17:50:04.625464 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 17:50:04.625491 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 17:50:04.625547 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 17:50:04.625587 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 17:50:04.625627 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 17:50:04.625653 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 17:50:04.625684 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 17:50:04.625715 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 17:50:04.625746 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 17:50:04.625771 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 17:50:04.625797 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 17:50:04.625829 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 17:50:04.625855 36987 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 17:50:04.625881 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 17:50:04.625903 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 17:50:04.625952 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 17:50:04.625988 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 17:50:04.626013 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 17:50:04.626041 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 17:50:04.626068 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 17:50:04.626104 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 17:50:04.626137 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 17:50:04.626169 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 17:50:04.626196 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 17:50:04.626236 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 17:50:04.626263 36987 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 17:50:04.626286 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 17:50:04.626312 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 17:50:04.626360 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 17:50:04.626391 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 17:50:04.626417 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 17:50:04.626447 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 17:50:04.626474 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 17:50:04.626503 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 17:50:04.626540 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 17:50:04.626574 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 17:50:04.626616 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 17:50:04.626643 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 17:50:04.626677 36987 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 17:50:04.626698 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 17:50:04.626725 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 17:50:04.626781 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 17:50:04.626811 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 17:50:04.626838 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 17:50:04.626870 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 17:50:04.626900 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 17:50:04.626932 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 17:50:04.626967 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 17:50:04.627002 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 17:50:04.627039 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 17:50:04.627074 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 17:50:04.627100 36987 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 17:50:04.627125 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 17:50:04.627151 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 17:50:04.627209 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 17:50:04.627251 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 17:50:04.627279 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 17:50:04.627307 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 17:50:04.627336 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 17:50:04.627364 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 17:50:04.627395 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 17:50:04.627424 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 17:50:04.627456 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 17:50:04.627485 36987 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 17:50:04.627512 36987 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 17:50:04.627534 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 17:50:04.627557 36987 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 17:50:05.433758 36987 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240129 17:50:05.433913 36987 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
Convert a graph into a bidirected graph: 54.507 seconds, peak memory: 265.173 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 265.173 GB
Metis partitioning: 466.086 seconds, peak memory: 277.073 GB
Split the graph: 96.966 seconds
Construct subgraphs: 16.955 seconds
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302718,  4302747,    88398,  ..., 68325470, 54419876,  4938992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2346.765 seconds
[Rank1] pid = 38185
[Rank2] pid = 38280
[Rank3] pid = 38347
[Rank4] pid = 38414
[Rank5] pid = 38483
[Rank6] pid = 38550
INFO [36987 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [38185 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38347 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [38280 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38414 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [38483 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [38617 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [38550 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [38414 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38483 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38550 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38617 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38347 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38280 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240129 17:58:46.391832 38415 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240129 17:58:46.391891 38484 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240129 17:58:46.391896 38551 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240129 17:58:46.391899 38618 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240129 17:58:46.392587 38348 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
INFO [38185 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [36987 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240129 17:58:46.396322 38683 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240129 17:58:46.397320 38281 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240129 17:58:46.397701 38186 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240129 17:58:46.442035 38348 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1020497a5000 7.629 MB
W20240129 17:58:46.442203 38618 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f48000 7.629 MB
W20240129 17:58:46.442270 38348 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204a6eb000 7.629 MB
W20240129 17:58:46.442346 38348 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10204ae8e000 1.49 GB
W20240129 17:58:46.442400 38348 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1020aa471000 1.49 GB
W20240129 17:58:46.442466 38618 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x102109a54000 7.629 MB
W20240129 17:58:46.442488 38348 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 17:58:46.442575 38618 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10210a1f7000 1.49 GB
W20240129 17:58:46.442624 38618 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1021697da000 1.49 GB
W20240129 17:58:46.442670 38618 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 17:58:46.445878 38348 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 17:58:46.445937 38618 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 17:58:46.496130 38683 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1021c8dd1000 7.629 MB
W20240129 17:58:46.496162 38415 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1021c9574000 7.629 MB
W20240129 17:58:46.496167 38551 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1021c9d17000 7.629 MB
W20240129 17:58:46.496172 38484 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1021ca4ba000 7.629 MB
W20240129 17:58:46.496322 38683 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1021cac5d000 7.629 MB
W20240129 17:58:46.496359 38484 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021cb400000 7.629 MB
W20240129 17:58:46.496450 38683 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1021cbba3000 1.49 GB
W20240129 17:58:46.496492 38415 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10222b929000 7.629 MB
W20240129 17:58:46.496490 38186 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10222b186000 7.629 MB
W20240129 17:58:46.496527 38683 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10222c0cc000 1.49 GB
W20240129 17:58:46.496559 38484 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10228b6af000 1.49 GB
W20240129 17:58:46.496577 38551 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1022eac92000 7.629 MB
W20240129 17:58:46.496583 38415 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1022eb435000 1.49 GB
W20240129 17:58:46.496584 38683 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 17:58:46.496627 38484 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10234aa18000 1.49 GB
W20240129 17:58:46.496644 38415 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1023a9ffb000 1.49 GB
W20240129 17:58:46.496666 38551 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1024095de000 1.49 GB
W20240129 17:58:46.496682 38484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 17:58:46.496688 38415 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 17:58:46.496702 38281 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102468bc1000 7.629 MB
W20240129 17:58:46.496716 38551 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102469364000 1.49 GB
W20240129 17:58:46.496722 38186 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1024c8947000 7.629 MB
W20240129 17:58:46.496767 38551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 17:58:46.496807 38186 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1024c90ea000 1.49 GB
W20240129 17:58:46.496860 38281 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1025286cd000 7.629 MB
W20240129 17:58:46.496877 38186 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102528e70000 1.49 GB
W20240129 17:58:46.496925 38281 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102588453000 1.49 GB
W20240129 17:58:46.496951 38186 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 17:58:46.496971 38281 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a36000 1.49 GB
W20240129 17:58:46.497010 38281 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 17:58:46.506922 38683 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 17:58:46.506999 38484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 17:58:46.507004 38281 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 17:58:46.507005 38415 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 17:58:46.507005 38551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 17:58:46.507069 38186 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [38347 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [38185 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [38617 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 38617
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [36987 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [38414 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [38483 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [38550 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [38280 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 17:59:35.708839 38281 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709064 38348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709137 38618 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709246 38683 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709350 38186 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709419 38484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709854 38415 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 17:59:35.709921 38551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240129 17:59:35.712004 38683 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 17:59:35.712380 38683 grad_base.h:184] Init GradProcessingBase done
I20240129 17:59:47.960036 38683 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240129 17:59:47.960323 38683 kg_controller.h:78] after init GradAsyncProcessingV2
I20240129 17:59:47.960335 38683 kg_controller.h:84] Construct KGCacheController done
E20240129 17:59:49.750057 38551 recstore.cc:66] init folly done
E20240129 17:59:49.750635 38415 recstore.cc:66] init folly done
E20240129 17:59:49.750952 38348 recstore.cc:66] init folly done
E20240129 17:59:49.750954 38618 recstore.cc:66] init folly done
E20240129 17:59:49.750994 38281 recstore.cc:66] init folly done
E20240129 17:59:49.751008 38484 recstore.cc:66] init folly done
E20240129 17:59:49.751003 38683 recstore.cc:66] init folly done
E20240129 17:59:49.751008 38186 recstore.cc:66] init folly done
I20240129 17:59:49.752102 38683 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 18:00:09.159864 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240129 18:00:09.160208 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:10.986022 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240129 18:00:10.986152 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:12.041746 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240129 18:00:12.041831 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:13.049362 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240129 18:00:13.062589 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240129 18:00:13.177122 38415 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
W20240129 18:00:15.636039 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240129 18:00:15.636161 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:16.656378 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240129 18:00:16.687407 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240129 18:00:16.704396 38618 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 18:00:16.809834 38683 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 18:00:16.944381 38281 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240129 18:00:17.664294 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
E20240129 18:00:17.687666 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240129 18:00:18.176159 38186 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240129 18:00:18.803515 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240129 18:00:18.826757 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240129 18:00:18.852452 38484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240129 18:00:24.274113 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240129 18:00:24.286844 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240129 18:00:24.327526 38551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240129 18:00:25.452338 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
E20240129 18:00:25.472510 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240129 18:00:25.702351 38348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240129 18:00:28.949086 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240129 18:00:29.029857 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240129 18:00:29.222594 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 449.777 ms                |
| ProcessBack:UpdateCache   | 12.540 ms                 | 939.981 ms                |
| ProcessBack:UpsertPq      | 33.099 ms                 | 83.126 ms                 |
| ProcessOneStep            | 58.180 ms                 | 1.762 s                   |
| BlockToStepN              | 262.753 us                | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:29.949043 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=43463
W20240129 18:00:30.057484 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=6, pq.top=6
W20240129 18:00:30.317351 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.987 ms                 | 128.388 ms                |
| Forward                   | 5.491 ms                  | 998.806 ms                |
| Backward                  | 8.389 ms                  | 264.875 ms                |
| Optimize                  | 2.243 ms                  | 4.787 ms                  |
| BarrierTimeBeforeRank0    | 23.508 ms                 | 273.782 ms                |
| AfterBackward             | 98.418 ms                 | 1.763 s                   |
| BlockToStepN              | 91.798 ms                 | 188.698 ms                |
| OneStep                   | 275.157 ms                | 3.516 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:30.949014 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=20747
W20240129 18:00:31.138681 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240129 18:00:31.488121 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end2
E20240129 18:00:31.949012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=5665
W20240129 18:00:32.295981 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240129 18:00:32.903882 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
E20240129 18:00:32.949007 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=41
W20240129 18:00:33.915114 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end8
E20240129 18:00:33.949005 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=97
W20240129 18:00:34.366823 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.780 ms                  | 449.777 ms                |
| ProcessBack:UpdateCache   | 9.669 ms                  | 939.981 ms                |
| ProcessBack:UpsertPq      | 43.667 ms                 | 196.581 ms                |
| ProcessOneStep            | 98.364 ms                 | 1.762 s                   |
| BlockToStepN              | 19.731 ms                 | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:34.949023 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
W20240129 18:00:34.952131 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
W20240129 18:00:35.388777 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=24, pq.top=24
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.966 ms                 | 217.629 ms                |
| Forward                   | 6.145 ms                  | 998.806 ms                |
| Backward                  | 7.972 ms                  | 264.875 ms                |
| Optimize                  | 2.745 ms                  | 5.215 ms                  |
| BarrierTimeBeforeRank0    | 3.470 ms                  | 273.782 ms                |
| AfterBackward             | 84.040 ms                 | 1.763 s                   |
| BlockToStepN              | 16.531 ms                 | 188.698 ms                |
| OneStep                   | 186.209 ms                | 3.516 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:35.952163 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:36.031245 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
W20240129 18:00:36.446507 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=32, pq.top=32
E20240129 18:00:36.952009 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=39097
W20240129 18:00:37.204423 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end6
E20240129 18:00:37.952011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1190
W20240129 18:00:38.145462 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240129 18:00:38.214439 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end7
E20240129 18:00:38.952414 38818 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
W20240129 18:00:39.145033 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240129 18:00:39.224627 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.800 ms                  | 394.281 ms                |
| ProcessBack:UpdateCache   | 10.028 ms                 | 939.957 ms                |
| ProcessBack:UpsertPq      | 32.080 ms                 | 150.044 ms                |
| ProcessOneStep            | 67.375 ms                 | 1.762 s                   |
| BlockToStepN              | 19.731 ms                 | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:39.952008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=2655
W20240129 18:00:40.145044 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240129 18:00:40.323480 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.992 ms                  | 153.219 ms                |
| Forward                   | 6.117 ms                  | 15.422 ms                 |
| Backward                  | 5.337 ms                  | 9.373 ms                  |
| Optimize                  | 2.632 ms                  | 5.365 ms                  |
| BarrierTimeBeforeRank0    | 2.149 ms                  | 273.782 ms                |
| AfterBackward             | 65.190 ms                 | 1.763 s                   |
| BlockToStepN              | 42.476 ms                 | 188.698 ms                |
| OneStep                   | 186.209 ms                | 3.516 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:40.952011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1551
W20240129 18:00:41.145031 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240129 18:00:41.569067 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240129 18:00:41.952011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=6814
W20240129 18:00:42.194972 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240129 18:00:42.747956 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240129 18:00:42.952008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=4023
W20240129 18:00:43.566823 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240129 18:00:43.766789 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end1
E20240129 18:00:43.952013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=46514
W20240129 18:00:44.566118 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.879 ms                  | 394.281 ms                |
| ProcessBack:UpdateCache   | 10.124 ms                 | 939.957 ms                |
| ProcessBack:UpsertPq      | 29.658 ms                 | 150.044 ms                |
| ProcessOneStep            | 68.298 ms                 | 1.498 s                   |
| BlockToStepN              | 58.806 ms                 | 131.194 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:00:44.824266 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
E20240129 18:00:44.967607 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=39044
W20240129 18:00:45.566051 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.366 ms                  | 156.552 ms                |
| Forward                   | 6.117 ms                  | 15.422 ms                 |
| Backward                  | 5.324 ms                  | 9.373 ms                  |
| Optimize                  | 2.703 ms                  | 12.702 ms                 |
| BarrierTimeBeforeRank0    | 3.470 ms                  | 133.372 ms                |
| AfterBackward             | 72.200 ms                 | 1.498 s                   |
| BlockToStepN              | 58.919 ms                 | 186.426 ms                |
| OneStep                   | 194.441 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:45.967010 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=16934
W20240129 18:00:46.017058 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
W20240129 18:00:46.648574 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=74, pq.top=74
E20240129 18:00:46.967008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=7121
W20240129 18:00:47.320936 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
E20240129 18:00:47.967013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=253
W20240129 18:00:48.358057 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end9
E20240129 18:00:48.967011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=3906
W20240129 18:00:49.230738 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240129 18:00:49.387097 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.879 ms                  | 46.520 ms                 |
| ProcessBack:UpdateCache   | 10.182 ms                 | 15.312 ms                 |
| ProcessBack:UpsertPq      | 29.658 ms                 | 196.581 ms                |
| ProcessOneStep            | 73.014 ms                 | 1.762 s                   |
| BlockToStepN              | 42.396 ms                 | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:49.967010 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=30367
W20240129 18:00:50.324680 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240129 18:00:50.391505 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.366 ms                  | 217.629 ms                |
| Forward                   | 6.092 ms                  | 15.422 ms                 |
| Backward                  | 5.353 ms                  | 14.316 ms                 |
| Optimize                  | 2.652 ms                  | 12.702 ms                 |
| BarrierTimeBeforeRank0    | 3.583 ms                  | 133.372 ms                |
| AfterBackward             | 73.062 ms                 | 1.763 s                   |
| BlockToStepN              | 42.417 ms                 | 188.327 ms                |
| OneStep                   | 195.901 ms                | 1.850 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:50.967006 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=5642
W20240129 18:00:51.423808 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240129 18:00:51.470925 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
E20240129 18:00:51.967011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=14351
W20240129 18:00:52.423251 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240129 18:00:52.621600 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
E20240129 18:00:52.967008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=15181
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 28.921, sample: 1.447, forward: 1.500, backward: 1.155, update: 0.223
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 34.396, sample: 1.592, forward: 1.463, backward: 1.044, update: 0.229
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 40.072, sample: 1.750, forward: 1.487, backward: 0.863, update: 0.263
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.547, sample: 1.530, forward: 1.771, backward: 0.896, update: 0.226
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 35.072, sample: 1.906, forward: 1.480, backward: 0.796, update: 0.249
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 36.304, sample: 1.765, forward: 1.376, backward: 0.960, update: 0.256
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 36.544, sample: 1.800, forward: 2.007, backward: 0.803, update: 0.322
train_sampler.Prefill()
-------Step 0-------
tensor([   45221,    45250,    45277,    45304,  5833371,    96508, 59233675,
        16332476, 19298981,    45326]) tensor([ 5167116, 14102264, 68106558, 80983831, 22054905, 34191547, 32946504,
        70573812, 63956564, 30523245])
-------Step 1-------
tensor([   45221,    45250,    45277,    45304,  5833371,    96508, 59233675,
        16332476, 19298981,    45326]) tensor([62325884, 29828396, 11683061, 73994262, 83209645, 46399056, 65841752,
        43856522, 41193054, 12147977])
-------Step 2-------
tensor([  112805,   112831,   112858,    28739,   112889,   112909,   112934,
        23118971,   112959,   112986]) tensor([71686431, 26302119, 80451621, 55430868, 45330058, 25621954, 62653002,
        43475205, 13090006, 45501911])
-------Step 3-------
tensor([  112805,   112831,   112858,    28739,   112889,   112909,   112934,
        23118971,   112959,   112986]) tensor([54356529, 80481837, 38955142, 41348498, 66849048, 57939991, 33654460,
        15083461, 27564853,   701529])
-------Step 4-------
tensor([  180213, 49458747,   180240,   121161,   180266,   121186,   180299,
        43245842,   180326,   180353]) tensor([78475368,  9255834, 76541474, 19718490, 78732745, 38587108, 70333861,
        40544478, 84040289, 46617318])
-------Step 5-------
tensor([  180213, 49458747,   180240,   121161,   180266,   121186,   180299,
        43245842,   180326,   180353]) tensor([39319821, 81325259,   315790, 84570130, 51468352, 49010633, 13669157,
         8998169, 79943584, 36402349])
-------Step 6-------
tensor([  248390,    60582,   248416,   248455,    60626, 79031494,   248490,
          248515,   133410, 39289825]) tensor([14416185, 42744284, 32993916, 73650523, 37313086, 32987295, 22397027,
         6494711, 67701823, 83174515])
-------Step 7-------
tensor([  248390,    60582,   248416,   248455,    60626, 79031494,   248490,
          248515,   133410, 39289825]) tensor([27231070, 46914106, 79033748, 64370324, 80247738, 56943380, 57361870,
        62399094, 39866541, 29321849])
-------Step 8-------
tensor([  314786, 26726401,   314812,   145261,   314836,    76004,   314866,
          314893,   314918,   314944]) tensor([39875832, 22548029, 37511004,  1921131, 44497579, 59622044, 13891688,
        79457102,  1508645, 57125148])
-------Step 9-------
tensor([  314786, 26726401,   314812,   145261,   314836,    76004,   314866,
          314893,   314918,   314944]) tensor([56308739, 32703074, 12997933, 56475998,  9294526, 37884680, 24493140,
        34514694, 84404088, 61291802])
before start barrier
start train
[proc 0] 100 steps, total: 36.439, sample: 2.742, forward: 1.621, backward: 0.876, update: 0.302
W20240129 18:00:53.423244 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240129 18:00:53.699334 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end2
E20240129 18:00:53.976598 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:54.749641 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.882 ms                  | 49.648 ms                 |
| ProcessBack:UpdateCache   | 10.177 ms                 | 15.312 ms                 |
| ProcessBack:UpsertPq      | 28.662 ms                 | 196.581 ms                |
| ProcessOneStep            | 74.311 ms                 | 1.762 s                   |
| BlockToStepN              | 42.297 ms                 | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:00:55.048862 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:00:55.144552 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.668 ms                  | 357.337 ms                |
| Forward                   | 6.106 ms                  | 15.422 ms                 |
| Backward                  | 5.482 ms                  | 14.316 ms                 |
| Optimize                  | 2.652 ms                  | 12.702 ms                 |
| BarrierTimeBeforeRank0    | 1.110 ms                  | 133.372 ms                |
| AfterBackward             | 74.365 ms                 | 1.763 s                   |
| BlockToStepN              | 42.417 ms                 | 188.327 ms                |
| OneStep                   | 196.938 ms                | 1.850 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:00:55.813619 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
E20240129 18:00:56.048009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=12804
W20240129 18:00:56.194232 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240129 18:00:56.996973 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end4
E20240129 18:00:57.048014 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=12912
W20240129 18:00:57.194053 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240129 18:00:58.048008 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=17305
W20240129 18:00:58.107084 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240129 18:00:59.048009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1700
W20240129 18:00:59.188587 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end0
W20240129 18:00:59.571511 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.942 ms                  | 49.648 ms                 |
| ProcessBack:UpdateCache   | 10.154 ms                 | 15.312 ms                 |
| ProcessBack:UpsertPq      | 27.857 ms                 | 196.581 ms                |
| ProcessOneStep            | 74.404 ms                 | 1.762 s                   |
| BlockToStepN              | 42.396 ms                 | 186.409 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:00.048009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=58160
W20240129 18:01:00.359251 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
W20240129 18:01:00.675925 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.883 ms                  | 357.337 ms                |
| Forward                   | 6.115 ms                  | 19.033 ms                 |
| Backward                  | 5.579 ms                  | 14.316 ms                 |
| Optimize                  | 2.652 ms                  | 12.702 ms                 |
| BarrierTimeBeforeRank0    | 884.187 us                | 133.372 ms                |
| AfterBackward             | 74.459 ms                 | 1.763 s                   |
| BlockToStepN              | 44.947 ms                 | 188.698 ms                |
| OneStep                   | 198.437 ms                | 1.850 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:01.048010 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=25239
W20240129 18:01:01.490918 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end2
W20240129 18:01:01.675257 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=133, pq.top=133
E20240129 18:01:02.048010 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=5871
W20240129 18:01:02.516099 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end5
E20240129 18:01:03.048015 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=2311
W20240129 18:01:03.468119 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240129 18:01:03.573603 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end7
E20240129 18:01:04.048008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=55925
W20240129 18:01:04.555498 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=142, pq.top=141
W20240129 18:01:04.597440 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.118 ms                  | 46.520 ms                 |
| ProcessBack:UpdateCache   | 10.182 ms                 | 17.411 ms                 |
| ProcessBack:UpsertPq      | 29.658 ms                 | 150.044 ms                |
| ProcessOneStep            | 77.266 ms                 | 1.762 s                   |
| BlockToStepN              | 44.844 ms                 | 191.981 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:05.048010 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=23967
W20240129 18:01:05.555023 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240129 18:01:05.614058 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.590 ms                 | 446.417 ms                |
| Forward                   | 6.075 ms                  | 19.033 ms                 |
| Backward                  | 5.719 ms                  | 53.819 ms                 |
| Optimize                  | 2.623 ms                  | 12.702 ms                 |
| BarrierTimeBeforeRank0    | 612.052 us                | 133.372 ms                |
| AfterBackward             | 77.323 ms                 | 1.763 s                   |
| BlockToStepN              | 44.947 ms                 | 192.124 ms                |
| OneStep                   | 198.960 ms                | 1.850 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:06.048017 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=54794
W20240129 18:01:06.761633 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end1
W20240129 18:01:06.769866 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240129 18:01:07.048018 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
W20240129 18:01:07.840497 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end7
W20240129 18:01:07.881366 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240129 18:01:08.048055 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=48068
W20240129 18:01:09.036696 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end8
E20240129 18:01:09.050650 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:01:09.575497 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=158, pq.top=158
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.134 ms                  | 46.520 ms                 |
| ProcessBack:UpdateCache   | 10.187 ms                 | 17.411 ms                 |
| ProcessBack:UpsertPq      | 30.470 ms                 | 150.044 ms                |
| ProcessOneStep            | 77.720 ms                 | 1.501 s                   |
| BlockToStepN              | 44.844 ms                 | 191.981 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:10.050040 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=19137
W20240129 18:01:10.059816 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end1
W20240129 18:01:10.575213 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.613 ms                 | 425.565 ms                |
| Forward                   | 6.085 ms                  | 15.422 ms                 |
| Backward                  | 5.778 ms                  | 14.316 ms                 |
| Optimize                  | 2.656 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 62.433 us                 | 67.226 ms                 |
| AfterBackward             | 77.899 ms                 | 1.502 s                   |
| BlockToStepN              | 47.060 ms                 | 204.741 ms                |
| OneStep                   | 201.329 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:11.050010 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=43118
W20240129 18:01:11.110594 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end6
W20240129 18:01:11.689538 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=167, pq.top=167
E20240129 18:01:12.050009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=3307
W20240129 18:01:12.155278 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end9
W20240129 18:01:12.716953 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240129 18:01:13.050009 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=71
W20240129 18:01:13.341586 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end6
W20240129 18:01:13.798480 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240129 18:01:14.050011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=51132
W20240129 18:01:14.386559 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.122 ms                  | 37.170 ms                 |
| ProcessBack:UpdateCache   | 10.212 ms                 | 17.081 ms                 |
| ProcessBack:UpsertPq      | 29.907 ms                 | 134.350 ms                |
| ProcessOneStep            | 77.485 ms                 | 1.501 s                   |
| BlockToStepN              | 46.937 ms                 | 223.869 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:15.050011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=6030
W20240129 18:01:15.242201 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240129 18:01:15.411170 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.966 ms                 | 446.417 ms                |
| Forward                   | 6.023 ms                  | 15.422 ms                 |
| Backward                  | 5.723 ms                  | 14.316 ms                 |
| Optimize                  | 2.648 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 52.751 us                 | 67.226 ms                 |
| AfterBackward             | 77.899 ms                 | 1.502 s                   |
| BlockToStepN              | 47.060 ms                 | 223.994 ms                |
| OneStep                   | 201.329 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:16.050011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=31678
W20240129 18:01:16.245708 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240129 18:01:16.527419 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end0
E20240129 18:01:17.059691 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=15440
W20240129 18:01:17.265664 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240129 18:01:17.720304 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end4
E20240129 18:01:18.059015 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=28
W20240129 18:01:18.595386 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240129 18:01:18.777369 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
E20240129 18:01:19.059008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=37092
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.107 ms                  | 37.170 ms                 |
| ProcessBack:UpdateCache   | 10.201 ms                 | 17.081 ms                 |
| ProcessBack:UpsertPq      | 29.907 ms                 | 134.350 ms                |
| ProcessOneStep            | 77.848 ms                 | 1.501 s                   |
| BlockToStepN              | 58.172 ms                 | 247.368 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:19.780236 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end9
W20240129 18:01:19.841377 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 3] 200 steps, total: 26.780, sample: 1.499, forward: 0.528, backward: 0.670, update: 0.245
[proc 1] 200 steps, total: 26.780, sample: 1.498, forward: 0.570, backward: 0.558, update: 0.244
[proc 4] 200 steps, total: 26.780, sample: 1.583, forward: 0.597, backward: 0.728, update: 0.261
[proc 2] 200 steps, total: 26.780, sample: 1.386, forward: 0.533, backward: 0.607, update: 0.227
[proc 6] 200 steps, total: 26.780, sample: 1.521, forward: 0.591, backward: 0.625, update: 0.272
[proc 5] 200 steps, total: 26.780, sample: 1.744, forward: 0.629, backward: 0.656, update: 0.251
[proc 7] 200 steps, total: 26.780, sample: 1.582, forward: 0.573, backward: 0.668, update: 0.246
[proc 0] 200 steps, total: 26.779, sample: 4.643, forward: 0.601, backward: 0.666, update: 0.283
E20240129 18:01:20.059012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.966 ms                 | 450.190 ms                |
| Forward                   | 6.003 ms                  | 15.422 ms                 |
| Backward                  | 5.718 ms                  | 14.316 ms                 |
| Optimize                  | 2.592 ms                  | 8.590 ms                  |
| BarrierTimeBeforeRank0    | 41.144 us                 | 67.226 ms                 |
| AfterBackward             | 77.899 ms                 | 1.502 s                   |
| BlockToStepN              | 58.451 ms                 | 247.503 ms                |
| OneStep                   | 203.136 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:20.783203 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
W20240129 18:01:20.841540 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240129 18:01:21.059011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1043
W20240129 18:01:21.858579 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240129 18:01:21.930431 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end0
E20240129 18:01:22.059011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=25182
W20240129 18:01:22.870743 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=214, pq.top=214
E20240129 18:01:23.059011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=6848
W20240129 18:01:23.330323 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
W20240129 18:01:23.910986 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=217, pq.top=217
E20240129 18:01:24.059015 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=50198
W20240129 18:01:24.545859 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.122 ms                  | 37.170 ms                 |
| ProcessBack:UpdateCache   | 10.182 ms                 | 17.752 ms                 |
| ProcessBack:UpsertPq      | 30.689 ms                 | 134.350 ms                |
| ProcessOneStep            | 78.372 ms                 | 1.501 s                   |
| BlockToStepN              | 63.607 ms                 | 247.368 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:24.964689 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240129 18:01:25.059013 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=75497
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.374 ms                 | 456.684 ms                |
| Forward                   | 5.948 ms                  | 15.422 ms                 |
| Backward                  | 5.719 ms                  | 14.316 ms                 |
| Optimize                  | 2.589 ms                  | 8.590 ms                  |
| BarrierTimeBeforeRank0    | 39.550 us                 | 67.226 ms                 |
| AfterBackward             | 78.656 ms                 | 1.502 s                   |
| BlockToStepN              | 63.720 ms                 | 265.683 ms                |
| OneStep                   | 204.539 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:25.797000 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end5
E20240129 18:01:26.059010 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=4259
W20240129 18:01:26.788748 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240129 18:01:26.817672 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end6
E20240129 18:01:27.059012 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=17425
W20240129 18:01:27.840751 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240129 18:01:27.893051 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
E20240129 18:01:28.065129 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=291
W20240129 18:01:28.914835 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240129 18:01:28.940567 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end4
E20240129 18:01:29.065009 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=91930
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.166 ms                  | 34.678 ms                 |
| ProcessBack:UpdateCache   | 10.187 ms                 | 17.411 ms                 |
| ProcessBack:UpsertPq      | 31.180 ms                 | 134.350 ms                |
| ProcessOneStep            | 78.873 ms                 | 1.501 s                   |
| BlockToStepN              | 63.607 ms                 | 265.545 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:29.950809 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240129 18:01:29.980352 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
E20240129 18:01:30.065006 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=31428
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.161 ms                 | 456.684 ms                |
| Forward                   | 5.932 ms                  | 15.422 ms                 |
| Backward                  | 5.761 ms                  | 14.316 ms                 |
| Optimize                  | 2.574 ms                  | 8.590 ms                  |
| BarrierTimeBeforeRank0    | 38.134 us                 | 67.226 ms                 |
| AfterBackward             | 78.902 ms                 | 1.502 s                   |
| BlockToStepN              | 58.919 ms                 | 265.683 ms                |
| OneStep                   | 205.835 ms                | 1.548 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:30.950320 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240129 18:01:31.016572 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
E20240129 18:01:31.065008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1348
W20240129 18:01:32.020098 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240129 18:01:32.065011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=31227
W20240129 18:01:32.170435 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end7
E20240129 18:01:33.065008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=4232
W20240129 18:01:33.104208 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240129 18:01:33.276985 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
E20240129 18:01:34.065009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=119243
W20240129 18:01:34.318150 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240129 18:01:34.496205 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.189 ms                  | 34.678 ms                 |
| ProcessBack:UpdateCache   | 10.144 ms                 | 17.411 ms                 |
| ProcessBack:UpsertPq      | 31.194 ms                 | 134.350 ms                |
| ProcessOneStep            | 79.154 ms                 | 1.498 s                   |
| BlockToStepN              | 65.420 ms                 | 247.368 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:35.065013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=5921
W20240129 18:01:35.568608 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end0
W20240129 18:01:35.629163 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.684 ms                 | 450.190 ms                |
| Forward                   | 5.927 ms                  | 13.233 ms                 |
| Backward                  | 5.761 ms                  | 10.523 ms                 |
| Optimize                  | 2.551 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 37.844 us                 | 66.913 ms                 |
| AfterBackward             | 79.215 ms                 | 1.498 s                   |
| BlockToStepN              | 63.720 ms                 | 247.503 ms                |
| OneStep                   | 205.835 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:36.065032 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=5522
W20240129 18:01:36.643070 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end4
W20240129 18:01:36.927505 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=265, pq.top=265
E20240129 18:01:37.065008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=55341
W20240129 18:01:37.647994 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
W20240129 18:01:37.927165 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240129 18:01:38.066011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:01:38.681943 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
W20240129 18:01:39.035030 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=275, pq.top=275
E20240129 18:01:39.066005 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=9400
W20240129 18:01:39.716718 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.212 ms                  | 23.202 ms                 |
| ProcessBack:UpdateCache   | 10.122 ms                 | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.293 ms                 | 129.580 ms                |
| ProcessOneStep            | 79.315 ms                 | 1.498 s                   |
| BlockToStepN              | 65.420 ms                 | 265.545 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:40.066009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=980
W20240129 18:01:40.155897 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.760 ms                 | 450.190 ms                |
| Forward                   | 5.913 ms                  | 13.233 ms                 |
| Backward                  | 5.774 ms                  | 10.523 ms                 |
| Optimize                  | 2.529 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 37.290 us                 | 66.913 ms                 |
| AfterBackward             | 79.659 ms                 | 1.498 s                   |
| BlockToStepN              | 65.547 ms                 | 265.683 ms                |
| OneStep                   | 205.835 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:40.885969 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end2
E20240129 18:01:41.066008 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=8225
W20240129 18:01:41.155573 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240129 18:01:41.941635 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
E20240129 18:01:42.066171 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240129 18:01:42.186797 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=289, pq.top=289
E20240129 18:01:43.066008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=64500
W20240129 18:01:43.114213 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end1
W20240129 18:01:43.261080 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240129 18:01:44.066013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=18899
W20240129 18:01:44.203073 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end4
W20240129 18:01:44.261114 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=294, pq.top=294
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.215 ms                  | 34.678 ms                 |
| ProcessBack:UpdateCache   | 10.048 ms                 | 17.411 ms                 |
| ProcessBack:UpsertPq      | 31.194 ms                 | 134.350 ms                |
| ProcessOneStep            | 79.618 ms                 | 1.498 s                   |
| BlockToStepN              | 66.481 ms                 | 316.504 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:45.066007 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=3058
W20240129 18:01:45.261698 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240129 18:01:45.331629 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.076 ms                 | 450.190 ms                |
| Forward                   | 5.907 ms                  | 13.233 ms                 |
| Backward                  | 5.761 ms                  | 10.523 ms                 |
| Optimize                  | 2.514 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 36.784 us                 | 66.913 ms                 |
| AfterBackward             | 79.659 ms                 | 1.498 s                   |
| BlockToStepN              | 66.595 ms                 | 331.075 ms                |
| OneStep                   | 206.565 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:46.066042 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=67722
[proc 1] 300 steps, total: 26.105, sample: 1.217, forward: 0.541, backward: 0.563, update: 0.238
[proc 6] 300 steps, total: 26.105, sample: 1.470, forward: 0.658, backward: 0.781, update: 0.302
[proc 5] 300 steps, total: 26.104, sample: 1.225, forward: 0.551, backward: 0.528, update: 0.240
[proc 7] 300 steps, total: 26.104, sample: 1.318, forward: 0.538, backward: 0.573, update: 0.233
[proc 4] 300 steps, total: 26.105, sample: 1.161, forward: 0.536, backward: 0.569, update: 0.237
[proc 3] 300 steps, total: 26.105, sample: 1.335, forward: 0.520, backward: 0.733, update: 0.229
[proc 0] 300 steps, total: 26.104, sample: 4.033, forward: 0.567, backward: 0.577, update: 0.241
[proc 2] 300 steps, total: 26.105, sample: 1.197, forward: 0.613, backward: 0.687, update: 0.232
W20240129 18:01:46.274474 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240129 18:01:46.415926 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
E20240129 18:01:47.066008 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=17703
W20240129 18:01:47.274012 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240129 18:01:47.497589 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end5
E20240129 18:01:48.066009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=9842
W20240129 18:01:48.274808 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240129 18:01:48.521998 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end9
E20240129 18:01:49.066027 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
W20240129 18:01:49.374519 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240129 18:01:49.634235 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.219 ms                  | 34.678 ms                 |
| ProcessBack:UpdateCache   | 9.980 ms                  | 17.411 ms                 |
| ProcessBack:UpsertPq      | 31.880 ms                 | 134.350 ms                |
| ProcessOneStep            | 79.771 ms                 | 1.498 s                   |
| BlockToStepN              | 67.701 ms                 | 372.144 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:50.066009 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=39957
W20240129 18:01:50.374800 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=317, pq.top=317
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.731 ms                 | 450.190 ms                |
| Forward                   | 5.907 ms                  | 13.233 ms                 |
| Backward                  | 5.741 ms                  | 10.523 ms                 |
| Optimize                  | 2.499 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 36.133 us                 | 66.913 ms                 |
| AfterBackward             | 79.819 ms                 | 1.498 s                   |
| BlockToStepN              | 67.402 ms                 | 372.288 ms                |
| OneStep                   | 207.530 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:50.858450 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240129 18:01:51.066012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=135064
W20240129 18:01:51.374202 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240129 18:01:51.952777 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
E20240129 18:01:52.071105 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240129 18:01:52.755059 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240129 18:01:52.999289 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end5
E20240129 18:01:53.071014 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=108924
W20240129 18:01:54.033576 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end8
W20240129 18:01:54.067101 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=328, pq.top=328
E20240129 18:01:54.075510 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=13419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.264 ms                  | 23.202 ms                 |
| ProcessBack:UpdateCache   | 9.971 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.331 ms                 | 129.580 ms                |
| ProcessOneStep            | 79.859 ms                 | 1.498 s                   |
| BlockToStepN              | 67.272 ms                 | 372.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:01:55.067297 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240129 18:01:55.072721 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
E20240129 18:01:55.075004 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=40000
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.182 ms                 | 450.190 ms                |
| Forward                   | 5.883 ms                  | 13.233 ms                 |
| Backward                  | 5.710 ms                  | 12.371 ms                 |
| Optimize                  | 2.488 ms                  | 6.674 ms                  |
| BarrierTimeBeforeRank0    | 35.850 us                 | 67.226 ms                 |
| AfterBackward             | 80.037 ms                 | 1.498 s                   |
| BlockToStepN              | 67.819 ms                 | 372.288 ms                |
| OneStep                   | 210.150 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:01:56.075011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=47357
W20240129 18:01:56.205125 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end9
W20240129 18:01:56.255218 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240129 18:01:57.075012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=343
W20240129 18:01:57.384815 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end3
W20240129 18:01:57.491892 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240129 18:01:58.075009 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=70234
W20240129 18:01:58.491798 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240129 18:01:58.551218 39233 grad_async_v2.h:121] Detect new sample comes, old_end2, new_end8
E20240129 18:01:59.075008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=117233
W20240129 18:01:59.624775 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end5
W20240129 18:01:59.661792 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.290 ms                  | 23.202 ms                 |
| ProcessBack:UpdateCache   | 9.905 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.107 ms                 | 129.580 ms                |
| ProcessOneStep            | 80.528 ms                 | 1.235 s                   |
| BlockToStepN              | 68.308 ms                 | 364.937 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:00.075009 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=59783
W20240129 18:02:00.661726 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.008 ms                 | 446.417 ms                |
| Forward                   | 5.844 ms                  | 11.080 ms                 |
| Backward                  | 5.627 ms                  | 10.523 ms                 |
| Optimize                  | 2.473 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 35.452 us                 | 66.913 ms                 |
| AfterBackward             | 80.037 ms                 | 1.235 s                   |
| BlockToStepN              | 68.435 ms                 | 372.288 ms                |
| OneStep                   | 210.150 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:01.027618 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240129 18:02:01.075012 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=29409
W20240129 18:02:01.673629 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
W20240129 18:02:02.027678 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=362, pq.top=361
E20240129 18:02:02.075419 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=76555
W20240129 18:02:02.790016 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
W20240129 18:02:03.042152 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=369, pq.top=369
E20240129 18:02:03.075008 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=13328
W20240129 18:02:03.881588 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end0
E20240129 18:02:04.075013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=407
W20240129 18:02:04.729570 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=370, pq.top=370
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.296 ms                  | 23.202 ms                 |
| ProcessBack:UpdateCache   | 9.872 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.015 ms                 | 134.350 ms                |
| ProcessOneStep            | 79.997 ms                 | 1.235 s                   |
| BlockToStepN              | 68.965 ms                 | 376.243 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:04.905463 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
E20240129 18:02:05.075013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=88129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.963 ms                 | 446.417 ms                |
| Forward                   | 5.831 ms                  | 11.080 ms                 |
| Backward                  | 5.593 ms                  | 10.523 ms                 |
| Optimize                  | 2.469 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 35.452 us                 | 66.913 ms                 |
| AfterBackward             | 80.567 ms                 | 1.235 s                   |
| BlockToStepN              | 69.130 ms                 | 376.376 ms                |
| OneStep                   | 210.150 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:05.729597 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240129 18:02:05.981925 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end6
E20240129 18:02:06.075009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=19389
W20240129 18:02:06.729873 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240129 18:02:07.002871 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end1
E20240129 18:02:07.075013 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=118901
W20240129 18:02:07.729053 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240129 18:02:08.017418 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end5
E20240129 18:02:08.075014 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=79281
W20240129 18:02:08.773932 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240129 18:02:09.068764 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end9
E20240129 18:02:09.075006 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=39062
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.318 ms                  | 21.256 ms                 |
| ProcessBack:UpdateCache   | 9.888 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.015 ms                 | 134.350 ms                |
| ProcessOneStep            | 80.715 ms                 | 1.235 s                   |
| BlockToStepN              | 70.729 ms                 | 416.064 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:09.773974 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=391, pq.top=391
E20240129 18:02:10.075017 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=94496
W20240129 18:02:10.100783 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.949 ms                 | 446.417 ms                |
| Forward                   | 5.831 ms                  | 11.080 ms                 |
| Backward                  | 5.538 ms                  | 10.523 ms                 |
| Optimize                  | 2.469 ms                  | 6.674 ms                  |
| BarrierTimeBeforeRank0    | 35.452 us                 | 66.913 ms                 |
| AfterBackward             | 80.761 ms                 | 1.235 s                   |
| BlockToStepN              | 71.174 ms                 | 416.216 ms                |
| OneStep                   | 212.516 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:10.863781 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=397, pq.top=397
E20240129 18:02:11.075084 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=29084
W20240129 18:02:11.128661 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
W20240129 18:02:11.863924 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 1] 400 steps, total: 25.919, sample: 1.296, forward: 0.600, backward: 0.580, update: 0.256
[proc 2] 400 steps, total: 25.918, sample: 1.241, forward: 0.606, backward: 0.728, update: 0.221
[proc 6] 400 steps, total: 25.919, sample: 1.193, forward: 0.562, backward: 0.594, update: 0.244
[proc 5] 400 steps, total: 25.919, sample: 1.213, forward: 0.564, backward: 0.643, update: 0.249
[proc 3] 400 steps, total: 25.919, sample: 1.214, forward: 0.546, backward: 0.584, update: 0.232
[proc 4] 400 steps, total: 25.919, sample: 1.145, forward: 0.532, backward: 0.659, update: 0.268
[proc 7] 400 steps, total: 25.919, sample: 1.257, forward: 0.618, backward: 0.604, update: 0.267
[proc 0] 400 steps, total: 25.919, sample: 3.158, forward: 0.593, backward: 0.504, update: 0.241
E20240129 18:02:12.075011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=189567
W20240129 18:02:12.139257 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end1
W20240129 18:02:12.949450 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240129 18:02:13.075011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=24717
W20240129 18:02:13.271976 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end4
W20240129 18:02:14.072988 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240129 18:02:14.075053 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=19271
W20240129 18:02:14.309628 39233 grad_async_v2.h:121] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.328 ms                  | 21.256 ms                 |
| ProcessBack:UpdateCache   | 9.888 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.135 ms                 | 141.016 ms                |
| ProcessOneStep            | 80.891 ms                 | 1.235 s                   |
| BlockToStepN              | 70.729 ms                 | 543.813 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:15.075012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=4800
W20240129 18:02:15.100507 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240129 18:02:15.323874 39233 grad_async_v2.h:121] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.608 ms                 | 446.417 ms                |
| Forward                   | 5.866 ms                  | 11.080 ms                 |
| Backward                  | 5.510 ms                  | 10.523 ms                 |
| Optimize                  | 2.477 ms                  | 6.674 ms                  |
| BarrierTimeBeforeRank0    | 35.336 us                 | 66.913 ms                 |
| AfterBackward             | 80.939 ms                 | 1.235 s                   |
| BlockToStepN              | 70.860 ms                 | 543.997 ms                |
| OneStep                   | 213.054 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:16.075011 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=20126
W20240129 18:02:16.100875 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240129 18:02:16.331261 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end5
E20240129 18:02:17.075012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=15324
W20240129 18:02:17.100337 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240129 18:02:17.367332 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end9
E20240129 18:02:18.076764 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=7359
W20240129 18:02:18.193126 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240129 18:02:18.424639 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end3
E20240129 18:02:19.076272 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=15518
W20240129 18:02:19.295653 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=427, pq.top=426
W20240129 18:02:19.481539 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.330 ms                  | 20.310 ms                 |
| ProcessBack:UpdateCache   | 9.867 ms                  | 16.829 ms                 |
| ProcessBack:UpsertPq      | 31.135 ms                 | 134.350 ms                |
| ProcessOneStep            | 80.931 ms                 | 1.235 s                   |
| BlockToStepN              | 71.026 ms                 | 543.813 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:20.076012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=14426
W20240129 18:02:20.454252 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240129 18:02:20.498570 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.406 ms                 | 446.417 ms                |
| Forward                   | 5.883 ms                  | 11.080 ms                 |
| Backward                  | 5.481 ms                  | 10.523 ms                 |
| Optimize                  | 2.469 ms                  | 6.674 ms                  |
| BarrierTimeBeforeRank0    | 34.728 us                 | 66.913 ms                 |
| AfterBackward             | 80.939 ms                 | 1.235 s                   |
| BlockToStepN              | 72.007 ms                 | 543.997 ms                |
| OneStep                   | 215.196 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:21.076010 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=41323
W20240129 18:02:21.454313 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240129 18:02:21.527710 39233 grad_async_v2.h:121] Detect new sample comes, old_end3, new_end5
E20240129 18:02:22.076009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
W20240129 18:02:22.517215 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240129 18:02:22.535876 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end9
E20240129 18:02:23.076014 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=120911
W20240129 18:02:23.559330 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end5
W20240129 18:02:23.638025 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240129 18:02:24.076035 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=263995
W20240129 18:02:24.705526 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.328 ms                  | 20.310 ms                 |
| ProcessBack:UpdateCache   | 9.863 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.461 ms                 | 134.350 ms                |
| ProcessOneStep            | 81.323 ms                 | 1.235 s                   |
| BlockToStepN              | 71.774 ms                 | 543.813 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:25.076009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=41293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.406 ms                 | 446.417 ms                |
| Forward                   | 5.877 ms                  | 11.080 ms                 |
| Backward                  | 5.439 ms                  | 10.630 ms                 |
| Optimize                  | 2.461 ms                  | 6.674 ms                  |
| BarrierTimeBeforeRank0    | 34.412 us                 | 66.913 ms                 |
| AfterBackward             | 81.363 ms                 | 1.235 s                   |
| BlockToStepN              | 71.948 ms                 | 543.997 ms                |
| OneStep                   | 215.196 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:25.756779 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end0
E20240129 18:02:26.144194 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=9749
W20240129 18:02:26.214486 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240129 18:02:26.767668 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end3
E20240129 18:02:27.144007 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=8178
W20240129 18:02:27.214711 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240129 18:02:27.774713 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end7
E20240129 18:02:28.144165 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=13045
W20240129 18:02:28.215185 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240129 18:02:28.963280 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end3
E20240129 18:02:29.144011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=53335
W20240129 18:02:29.454070 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.341 ms                  | 20.310 ms                 |
| ProcessBack:UpdateCache   | 9.864 ms                  | 17.081 ms                 |
| ProcessBack:UpsertPq      | 31.885 ms                 | 141.016 ms                |
| ProcessOneStep            | 81.648 ms                 | 1.235 s                   |
| BlockToStepN              | 71.026 ms                 | 480.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:30.009693 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end9
E20240129 18:02:30.144011 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=230307
W20240129 18:02:30.546181 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.553 ms                 | 425.565 ms                |
| Forward                   | 5.884 ms                  | 11.080 ms                 |
| Backward                  | 5.405 ms                  | 10.523 ms                 |
| Optimize                  | 2.458 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 34.339 us                 | 65.796 ms                 |
| AfterBackward             | 81.762 ms                 | 1.235 s                   |
| BlockToStepN              | 71.174 ms                 | 481.013 ms                |
| OneStep                   | 215.217 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:31.144013 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=99650
W20240129 18:02:31.217706 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end2
W20240129 18:02:31.546886 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=473, pq.top=473
E20240129 18:02:32.144011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=14510
W20240129 18:02:32.299786 39233 grad_async_v2.h:121] Detect new sample comes, old_end1, new_end7
W20240129 18:02:32.547063 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240129 18:02:33.144012 39232 parallel_pq_v2.h:76] insert failed, size(hashtable)=158089
W20240129 18:02:33.453043 39233 grad_async_v2.h:121] Detect new sample comes, old_end5, new_end1
W20240129 18:02:33.684175 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=483, pq.top=483
E20240129 18:02:34.144012 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=303384
W20240129 18:02:34.596773 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end7
W20240129 18:02:34.684799 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=487, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.351 ms                  | 19.703 ms                 |
| ProcessBack:UpdateCache   | 9.860 ms                  | 16.829 ms                 |
| ProcessBack:UpsertPq      | 31.885 ms                 | 134.350 ms                |
| ProcessOneStep            | 81.797 ms                 | 1.235 s                   |
| BlockToStepN              | 71.026 ms                 | 574.418 ms                |
+---------------------------+---------------------------+---------------------------+
E20240129 18:02:35.144009 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=94870
W20240129 18:02:35.609035 39233 grad_async_v2.h:121] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.302 ms                 | 425.565 ms                |
| Forward                   | 5.877 ms                  | 11.080 ms                 |
| Backward                  | 5.378 ms                  | 10.523 ms                 |
| Optimize                  | 2.451 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 34.339 us                 | 65.796 ms                 |
| AfterBackward             | 81.852 ms                 | 1.235 s                   |
| BlockToStepN              | 71.948 ms                 | 576.891 ms                |
| OneStep                   | 215.217 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 18:02:35.874042 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=488, pq.top=488
E20240129 18:02:36.144016 38818 parallel_pq_v2.h:76] insert failed, size(hashtable)=86214
W20240129 18:02:36.675037 39233 grad_async_v2.h:121] Detect new sample comes, old_end9, new_end3
W20240129 18:02:36.874919 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=493, pq.top=493
E20240129 18:02:37.144011 39233 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240129 18:02:37.688871 39233 grad_async_v2.h:121] Detect new sample comes, old_end4, new_end7
W20240129 18:02:37.874929 38683 grad_async_v2.h:250] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240129 18:02:38.144011 38683 parallel_pq_v2.h:76] insert failed, size(hashtable)=12743
[proc 4] 500 steps, total: 26.471, sample: 1.177, forward: 0.502, backward: 0.637, update: 0.235
[proc 6] 500 steps, total: 26.471, sample: 1.213, forward: 0.596, backward: 0.641, update: 0.279
[proc 2] 500 steps, total: 26.471, sample: 1.160, forward: 0.523, backward: 0.678, update: 0.219
[proc 3] 500 steps, total: 26.471, sample: 1.258, forward: 0.594, backward: 0.672, update: 0.251
[proc 7] 500 steps, total: 26.471, sample: 1.304, forward: 0.687, backward: 0.585, update: 0.300
[proc 1] 500 steps, total: 26.471, sample: 1.197, forward: 0.500, backward: 0.547, update: 0.217
[proc 0] 500 steps, total: 26.471, sample: 2.807, forward: 0.624, backward: 0.503, update: 0.240
[proc 5] 500 steps, total: 26.471, sample: 1.047, forward: 0.552, backward: 0.723, update: 0.226
Successfully xmh. training takes 141.7138044834137 seconds
before call kg_cache_controller.StopThreads()
W20240129 18:02:38.523631 38683 grad_async_v2.h:71] call StopThreads. PID = 36987
W20240129 18:02:38.523663 38683 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 18:02:38.524101 38683 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 18:02:38.524114 38683 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240129 18:02:38.773224 39233 grad_async_v2.h:121] Detect new sample comes, old_end8, new_end0
W20240129 18:02:38.904621 38683 grad_async_v2.h:92] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.362 ms                  | 19.703 ms                 |
| ProcessBack:UpdateCache   | 9.857 ms                  | 16.829 ms                 |
| ProcessBack:UpsertPq      | 31.967 ms                 | 141.016 ms                |
| ProcessOneStep            | 81.806 ms                 | 1.235 s                   |
| BlockToStepN              | 71.026 ms                 | 576.715 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.088 ms                 | 425.565 ms                |
| Forward                   | 5.882 ms                  | 11.080 ms                 |
| Backward                  | 5.361 ms                  | 10.523 ms                 |
| Optimize                  | 2.444 ms                  | 5.951 ms                  |
| BarrierTimeBeforeRank0    | 34.393 us                 | 65.796 ms                 |
| AfterBackward             | 81.867 ms                 | 1.235 s                   |
| BlockToStepN              | 71.174 ms                 | 576.891 ms                |
| OneStep                   | 215.217 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
