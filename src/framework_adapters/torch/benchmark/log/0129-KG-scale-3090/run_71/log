WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 02:29:04.703024 17467 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_23', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [17467 sampler.py:454] Start PreSampling
WARNING [17467 sampler.py:532] Before construct renumbering_dict
WARNING [17467 sampler.py:555] PreSampling done
W20240130 02:49:29.465324 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 02:49:29.465538 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 02:49:29.465581 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 02:49:29.465623 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 02:49:29.465652 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 02:49:29.465689 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 02:49:29.465731 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 02:49:29.465772 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 02:49:29.465812 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 02:49:29.465839 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 02:49:29.465873 17467 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 02:49:29.465900 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 02:49:29.465924 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 02:49:29.466087 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 02:49:29.466135 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 02:49:29.466161 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 02:49:29.466210 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 02:49:29.466238 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 02:49:29.466269 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 02:49:29.466295 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 02:49:29.466327 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 02:49:29.466352 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 02:49:29.466379 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 02:49:29.466414 17467 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 02:49:29.466437 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 02:49:29.466460 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 02:49:29.466519 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 02:49:29.466560 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 02:49:29.466589 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 02:49:29.466619 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 02:49:29.466650 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 02:49:29.466696 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 02:49:29.466727 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 02:49:29.466758 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 02:49:29.466794 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 02:49:29.466823 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 02:49:29.466851 17467 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 02:49:29.466874 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 02:49:29.466897 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 02:49:29.466958 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 02:49:29.466992 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 02:49:29.467025 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 02:49:29.467051 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 02:49:29.467080 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 02:49:29.467113 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 02:49:29.467145 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 02:49:29.467177 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 02:49:29.467209 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 02:49:29.467235 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 02:49:29.467263 17467 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 02:49:29.467285 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 02:49:29.467306 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 02:49:29.467365 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 02:49:29.467407 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 02:49:29.467440 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 02:49:29.467466 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 02:49:29.467499 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 02:49:29.467536 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 02:49:29.467571 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 02:49:29.467617 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 02:49:29.467649 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 02:49:29.467685 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 02:49:29.467712 17467 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 02:49:29.467736 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 02:49:29.467758 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 02:49:29.467813 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 02:49:29.467850 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 02:49:29.467877 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 02:49:29.467905 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 02:49:29.467934 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 02:49:29.467962 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 02:49:29.467998 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 02:49:29.468034 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 02:49:29.468075 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 02:49:29.468111 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 02:49:29.468137 17467 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 02:49:29.468159 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 02:49:29.468186 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 02:49:29.468236 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240130 02:49:29.468269 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240130 02:49:29.468303 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240130 02:49:29.468333 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240130 02:49:29.468374 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240130 02:49:29.468408 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240130 02:49:29.468441 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240130 02:49:29.468479 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240130 02:49:29.468508 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240130 02:49:29.468542 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240130 02:49:29.468582 17467 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240130 02:49:29.468605 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240130 02:49:29.468634 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240130 02:49:29.468690 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240130 02:49:29.468720 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240130 02:49:29.468750 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240130 02:49:29.468781 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240130 02:49:29.468809 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240130 02:49:29.468840 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240130 02:49:29.468871 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240130 02:49:29.468904 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240130 02:49:29.468941 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240130 02:49:29.468971 17467 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240130 02:49:29.469003 17467 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240130 02:49:29.469025 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240130 02:49:29.469048 17467 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240130 02:49:29.955830 17467 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240130 02:49:29.955992 17467 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605419,  8605450,    72891,  ..., 73338822, 48238675,  9532695]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1733.120 seconds
[Rank1] pid = 18369
[Rank2] pid = 18464
[Rank3] pid = 18533
[Rank4] pid = 18600
[Rank5] pid = 18667
[Rank6] pid = 18735
INFO [17467 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [18369 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [18464 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [18533 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [18600 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [18667 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [18804 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [18735 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [18735 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18600 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18804 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18667 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18464 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18533 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18369 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17467 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [18533 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18464 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [17467 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18804 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18667 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18369 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18735 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [18600 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 02:58:26.424192 18601 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.424504 18465 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.425658 18736 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.425854 18868 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.426046 18668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.426242 18534 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.426391 18805 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:58:26.426550 18370 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240130 02:58:28.189291 18370 recstore.cc:66] init folly done
E20240130 02:58:28.190001 18668 recstore.cc:66] init folly done
E20240130 02:58:28.190006 18601 recstore.cc:66] init folly done
E20240130 02:58:28.190011 18736 recstore.cc:66] init folly done
E20240130 02:58:28.190013 18465 recstore.cc:66] init folly done
E20240130 02:58:28.190017 18805 recstore.cc:66] init folly done
E20240130 02:58:28.190042 18868 recstore.cc:66] init folly done
E20240130 02:58:28.190052 18534 recstore.cc:66] init folly done
I20240130 02:58:34.368328 18868 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240130 02:58:34.484972 18668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:34.767251 18601 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:35.755673 18465 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:36.701471 18370 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:36.783380 18534 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:36.926198 18805 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:58:37.361452 18736 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.552 ms                  | 6.841 ms                  |
| bucket keys               | 3.604 ms                  | 121.742 ms                |
| forward: a2a keys         | 21.524 ms                 | 1.229 s                   |
| forward: search cache     | 438.322 us                | 23.213 ms                 |
| forward: a2a values       | 19.911 ms                 | 39.797 ms                 |
| forward: join             | 1.574 ms                  | 3.760 ms                  |
| Forward                   | 117.347 ms                | 1.926 s                   |
| back: aggr dram keys      | 37.797 ms                 | 915.514 ms                |
| back: set dram grad       | 2.586 ms                  | 4.667 ms                  |
| back: a2a grad            | 14.819 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 17.243 ms                 | 109.768 ms                |
| Backward                  | 242.508 ms                | 1.305 s                   |
| Optimize                  | 19.044 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 87.681 us                 | 133.329 us                |
| BlockToStepN              | 48.668 us                 | 91.541 us                 |
| OneStep                   | 393.353 ms                | 3.255 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.466 ms                  | 86.578 ms                 |
| bucket keys               | 3.472 ms                  | 121.742 ms                |
| forward: a2a keys         | 6.940 ms                  | 1.229 s                   |
| forward: search cache     | 422.634 us                | 23.213 ms                 |
| forward: a2a values       | 18.687 ms                 | 39.797 ms                 |
| forward: join             | 1.479 ms                  | 3.760 ms                  |
| Forward                   | 68.201 ms                 | 1.926 s                   |
| back: aggr dram keys      | 37.797 ms                 | 915.514 ms                |
| back: set dram grad       | 2.147 ms                  | 4.667 ms                  |
| back: a2a grad            | 26.207 ms                 | 66.165 ms                 |
| back: grad sum & grad cache  | 17.243 ms                 | 109.768 ms                |
| Backward                  | 213.321 ms                | 1.305 s                   |
| Optimize                  | 16.189 ms                 | 44.468 ms                 |
| BarrierTimeBeforeRank0    | 68.449 us                 | 133.329 us                |
| BlockToStepN              | 48.668 us                 | 9.137 ms                  |
| OneStep                   | 312.674 ms                | 3.255 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.466 ms                  | 86.578 ms                 |
| bucket keys               | 3.450 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.940 ms                  | 65.760 ms                 |
| forward: search cache     | 421.306 us                | 902.031 us                |
| forward: a2a values       | 18.684 ms                 | 32.755 ms                 |
| forward: join             | 1.479 ms                  | 3.632 ms                  |
| Forward                   | 62.440 ms                 | 1.926 s                   |
| back: aggr dram keys      | 36.978 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.227 ms                  | 8.229 ms                  |
| back: a2a grad            | 26.103 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 17.243 ms                 | 109.768 ms                |
| Backward                  | 213.321 ms                | 1.305 s                   |
| Optimize                  | 16.143 ms                 | 44.468 ms                 |
| BarrierTimeBeforeRank0    | 63.870 us                 | 133.329 us                |
| BlockToStepN              | 49.492 us                 | 9.137 ms                  |
| OneStep                   | 301.696 ms                | 3.255 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.843 ms                  | 86.578 ms                 |
| bucket keys               | 3.468 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.559 ms                  | 65.760 ms                 |
| forward: search cache     | 424.207 us                | 4.115 ms                  |
| forward: a2a values       | 18.684 ms                 | 32.755 ms                 |
| forward: join             | 1.482 ms                  | 3.632 ms                  |
| Forward                   | 60.067 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.739 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.296 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.898 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 17.243 ms                 | 114.037 ms                |
| Backward                  | 208.868 ms                | 287.312 ms                |
| Optimize                  | 16.143 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 64.698 us                 | 133.329 us                |
| BlockToStepN              | 50.778 us                 | 10.548 ms                 |
| OneStep                   | 295.471 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.912 ms                  | 91.635 ms                 |
| bucket keys               | 3.468 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.356 ms                  | 65.760 ms                 |
| forward: search cache     | 425.624 us                | 4.115 ms                  |
| forward: a2a values       | 18.684 ms                 | 32.755 ms                 |
| forward: join             | 1.482 ms                  | 3.632 ms                  |
| Forward                   | 56.810 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.717 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.321 ms                  | 9.171 ms                  |
| back: a2a grad            | 24.897 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 17.243 ms                 | 114.037 ms                |
| Backward                  | 206.522 ms                | 287.312 ms                |
| Optimize                  | 15.807 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 59.347 us                 | 133.329 us                |
| BlockToStepN              | 50.559 us                 | 10.548 ms                 |
| OneStep                   | 295.110 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.912 ms                  | 91.635 ms                 |
| bucket keys               | 3.472 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.356 ms                  | 56.239 ms                 |
| forward: search cache     | 425.731 us                | 902.031 us                |
| forward: a2a values       | 18.687 ms                 | 32.755 ms                 |
| forward: join             | 1.482 ms                  | 3.632 ms                  |
| Forward                   | 57.349 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.717 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.321 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.903 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 113.252 ms                |
| Backward                  | 210.453 ms                | 287.312 ms                |
| Optimize                  | 15.890 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 58.518 us                 | 133.329 us                |
| BlockToStepN              | 49.443 us                 | 10.548 ms                 |
| OneStep                   | 298.908 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 36.905, sample: 1.097, forward: 8.780, backward: 13.303, update: 0.440
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 35.634, sample: 1.083, forward: 8.782, backward: 13.576, update: 0.453
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 36.622, sample: 1.148, forward: 8.748, backward: 13.246, update: 0.411
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 34.028, sample: 1.231, forward: 8.685, backward: 13.240, update: 0.454
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 34.606, sample: 1.129, forward: 8.739, backward: 13.482, update: 0.446
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 37.021, sample: 1.232, forward: 8.673, backward: 13.456, update: 0.361
[Rank7] pid = 18804
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
train_sampler.Prefill()
-------Step 0-------
tensor([  151973,   151999,   152024,   152047, 10276940,   796794, 66941733,
        18579147, 21443165,   152077]) tensor([ 9552011, 16881668, 74231955, 79641697, 28686066, 40538711, 32871500,
        64657156, 58096094, 27742562])
-------Step 1-------
tensor([  151973,   151999,   152024,   152047, 10276940,   796794, 66941733,
        18579147, 21443165,   152077]) tensor([ 3795156, 36726490, 16810663, 66081113, 70996748, 50259487, 62825580,
        62140454, 48346812, 15168352])
-------Step 2-------
tensor([  212052,   212075,   212104,   247182,   212130,   212165, 84613787,
        24548341,   212180,   212203]) tensor([62335846, 23486253, 82891794, 62886774, 53016946, 26784359, 56859296,
        51471343, 16167858, 49641030])
-------Step 3-------
tensor([  212052,   212075,   212104,   247182,   212130,   212165, 84613787,
        24548341,   212180,   212203]) tensor([62866312, 84895827, 44419508, 48297691, 55712355, 53782486, 33203844,
        17576983, 25623784,  1529540])
-------Step 4-------
tensor([  272147, 39099109,   272167,   819287,   272193,   819318,   272218,
        50137283,   272240,   272271]) tensor([83740704, 12756738, 70773196, 25913162, 77235630, 39136829, 76731306,
        47492571, 85395235, 44396350])
-------Step 5-------
tensor([  272147, 39099109,   272167,   819287,   272193,   819318,   272218,
        50137283,   272240,   272271]) tensor([44397447,  1334221,   944137, 84281769, 58412233, 46480606, 16651264,
        15383727, 78947295, 35813102])
-------Step 6-------
tensor([  332561,   268242, 30272148,   332586, 25633711, 81407118,   332616,
          332632, 67704984, 46292655]) tensor([19800805, 48668936, 47931967, 66930934, 42134649, 32905521, 23952556,
        10289104, 59525963, 84994789])
-------Step 7-------
tensor([  332561,   268242, 30272148,   332586, 25633711, 81407118,   332616,
          332632, 67704984, 46292655]) tensor([24134597, 44814395, 58723044, 71839938, 66891788, 62366793, 71045313,
        70794410, 45443998,  1007591])
-------Step 8-------
tensor([  395365, 32740698,   395388,   840124,   395416,   278541,   395438,
          395462,   395488,   395515]) tensor([38130659, 24058197, 45292204,  3504064, 42750004,   189170, 16823043,
          560546,  3134783, 75589958])
-------Step 9-------
tensor([  395365, 32740698,   395388,   840124,   395416,   278541,   395438,
          395462,   395488,   395515]) tensor([67243591,  2042789, 15708128, 71983134, 14132373, 54705312,   862903,
        33803761, 86033104, 55868199])
before start barrier
start train
[proc 0] 100 steps, total: 34.463, sample: 1.356, forward: 8.421, backward: 22.431, update: 1.626
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 34.688, sample: 1.149, forward: 8.743, backward: 14.167, update: 0.416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.474 ms                  | 91.635 ms                 |
| bucket keys               | 3.484 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.394 ms                  | 56.239 ms                 |
| forward: search cache     | 426.319 us                | 2.955 ms                  |
| forward: a2a values       | 18.687 ms                 | 39.797 ms                 |
| forward: join             | 1.482 ms                  | 3.632 ms                  |
| Forward                   | 56.810 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.681 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.320 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.981 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 113.252 ms                |
| Backward                  | 208.868 ms                | 287.312 ms                |
| Optimize                  | 15.851 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 57.131 us                 | 133.329 us                |
| BlockToStepN              | 49.035 us                 | 10.548 ms                 |
| OneStep                   | 295.442 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.507 ms                  | 91.635 ms                 |
| bucket keys               | 3.484 ms                  | 16.685 ms                 |
| forward: a2a keys         | 6.434 ms                  | 62.920 ms                 |
| forward: search cache     | 426.319 us                | 2.955 ms                  |
| forward: a2a values       | 18.687 ms                 | 47.350 ms                 |
| forward: join             | 1.486 ms                  | 3.632 ms                  |
| Forward                   | 58.165 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.717 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.325 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.982 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 113.252 ms                |
| Backward                  | 210.113 ms                | 287.312 ms                |
| Optimize                  | 15.912 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 57.131 us                 | 133.329 us                |
| BlockToStepN              | 49.644 us                 | 15.602 ms                 |
| OneStep                   | 295.471 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.813 ms                  | 94.809 ms                 |
| bucket keys               | 3.484 ms                  | 6.538 ms                  |
| forward: a2a keys         | 6.449 ms                  | 62.920 ms                 |
| forward: search cache     | 428.068 us                | 902.031 us                |
| forward: a2a values       | 18.713 ms                 | 39.797 ms                 |
| forward: join             | 1.486 ms                  | 3.272 ms                  |
| Forward                   | 58.260 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.727 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.296 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.765 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 110.730 ms                |
| Backward                  | 207.629 ms                | 287.312 ms                |
| Optimize                  | 15.837 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 56.533 us                 | 133.329 us                |
| BlockToStepN              | 50.526 us                 | 15.602 ms                 |
| OneStep                   | 295.432 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.831 ms                  | 94.809 ms                 |
| bucket keys               | 3.526 ms                  | 6.538 ms                  |
| forward: a2a keys         | 6.404 ms                  | 62.920 ms                 |
| forward: search cache     | 429.504 us                | 902.031 us                |
| forward: a2a values       | 18.713 ms                 | 39.797 ms                 |
| forward: join             | 1.486 ms                  | 3.272 ms                  |
| Forward                   | 57.700 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.724 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.227 ms                  | 9.171 ms                  |
| back: a2a grad            | 24.687 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 113.252 ms                |
| Backward                  | 206.228 ms                | 287.312 ms                |
| Optimize                  | 15.767 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 56.064 us                 | 133.329 us                |
| BlockToStepN              | 49.204 us                 | 15.602 ms                 |
| OneStep                   | 293.966 ms                | 457.887 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.600 ms                  | 94.809 ms                 |
| bucket keys               | 3.484 ms                  | 6.538 ms                  |
| forward: a2a keys         | 6.392 ms                  | 62.920 ms                 |
| forward: search cache     | 429.596 us                | 902.031 us                |
| forward: a2a values       | 18.687 ms                 | 39.797 ms                 |
| forward: join             | 1.486 ms                  | 3.272 ms                  |
| Forward                   | 57.866 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.727 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.280 ms                  | 9.171 ms                  |
| back: a2a grad            | 24.736 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 113.252 ms                |
| Backward                  | 206.480 ms                | 285.625 ms                |
| Optimize                  | 15.807 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 53.553 us                 | 98.357 us                 |
| BlockToStepN              | 48.840 us                 | 10.548 ms                 |
| OneStep                   | 293.966 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.797 ms                  | 100.357 ms                |
| bucket keys               | 3.526 ms                  | 6.445 ms                  |
| forward: a2a keys         | 6.369 ms                  | 56.239 ms                 |
| forward: search cache     | 429.504 us                | 749.379 us                |
| forward: a2a values       | 18.683 ms                 | 39.797 ms                 |
| forward: join             | 1.492 ms                  | 2.336 ms                  |
| Forward                   | 57.693 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.727 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.284 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.736 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 110.730 ms                |
| Backward                  | 206.752 ms                | 285.625 ms                |
| Optimize                  | 15.767 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 53.947 us                 | 98.357 us                 |
| BlockToStepN              | 48.304 us                 | 10.548 ms                 |
| OneStep                   | 294.223 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.813 ms                  | 100.357 ms                |
| bucket keys               | 3.526 ms                  | 6.445 ms                  |
| forward: a2a keys         | 6.394 ms                  | 62.920 ms                 |
| forward: search cache     | 430.566 us                | 902.031 us                |
| forward: a2a values       | 17.462 ms                 | 39.797 ms                 |
| forward: join             | 1.492 ms                  | 3.272 ms                  |
| Forward                   | 58.101 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.739 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.299 ms                  | 9.106 ms                  |
| back: a2a grad            | 24.460 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 25.644 ms                 | 110.730 ms                |
| Backward                  | 207.629 ms                | 285.625 ms                |
| Optimize                  | 15.797 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 53.594 us                 | 100.557 us                |
| BlockToStepN              | 48.350 us                 | 15.602 ms                 |
| OneStep                   | 294.745 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 30.496, sample: 1.340, forward: 6.703, backward: 12.042, update: 0.389
[proc 6] 200 steps, total: 30.496, sample: 1.160, forward: 6.947, backward: 12.032, update: 0.375
[proc 3] 200 steps, total: 30.496, sample: 1.360, forward: 6.681, backward: 12.365, update: 0.447
[proc 1] 200 steps, total: 30.496, sample: 1.297, forward: 6.751, backward: 12.995, update: 0.410
[proc 2] 200 steps, total: 30.496, sample: 1.206, forward: 6.834, backward: 12.373, update: 0.380
[proc 0] 200 steps, total: 30.496, sample: 1.501, forward: 6.437, backward: 20.765, update: 1.623
[proc 5] 200 steps, total: 30.496, sample: 1.190, forward: 6.905, backward: 12.021, update: 0.449
[proc 7] 200 steps, total: 30.496, sample: 1.236, forward: 6.862, backward: 12.273, update: 0.330
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.831 ms                  | 100.357 ms                |
| bucket keys               | 3.555 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.417 ms                  | 62.920 ms                 |
| forward: search cache     | 433.181 us                | 1.235 ms                  |
| forward: a2a values       | 16.492 ms                 | 39.797 ms                 |
| forward: join             | 1.531 ms                  | 3.272 ms                  |
| Forward                   | 58.213 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.725 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.312 ms                  | 9.273 ms                  |
| back: a2a grad            | 23.203 ms                 | 53.792 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 112.854 ms                |
| Backward                  | 206.480 ms                | 285.625 ms                |
| Optimize                  | 15.797 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 52.951 us                 | 100.557 us                |
| BlockToStepN              | 48.435 us                 | 18.948 ms                 |
| OneStep                   | 294.745 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.843 ms                  | 100.357 ms                |
| bucket keys               | 3.555 ms                  | 6.538 ms                  |
| forward: a2a keys         | 6.347 ms                  | 56.239 ms                 |
| forward: search cache     | 438.322 us                | 956.071 us                |
| forward: a2a values       | 16.239 ms                 | 35.588 ms                 |
| forward: join             | 1.531 ms                  | 3.272 ms                  |
| Forward                   | 57.700 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.717 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.312 ms                  | 9.171 ms                  |
| back: a2a grad            | 22.996 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.730 ms                |
| Backward                  | 206.480 ms                | 285.625 ms                |
| Optimize                  | 15.767 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 52.696 us                 | 100.557 us                |
| BlockToStepN              | 48.668 us                 | 18.948 ms                 |
| OneStep                   | 294.223 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.843 ms                  | 108.912 ms                |
| bucket keys               | 3.555 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.284 ms                  | 56.239 ms                 |
| forward: search cache     | 457.055 us                | 956.071 us                |
| forward: a2a values       | 16.185 ms                 | 35.588 ms                 |
| forward: join             | 1.531 ms                  | 3.272 ms                  |
| Forward                   | 57.127 ms                 | 130.508 ms                |
| back: aggr dram keys      | 36.681 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.314 ms                  | 9.273 ms                  |
| back: a2a grad            | 22.840 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.730 ms                |
| Backward                  | 206.480 ms                | 285.625 ms                |
| Optimize                  | 15.791 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 52.430 us                 | 100.557 us                |
| BlockToStepN              | 48.435 us                 | 18.948 ms                 |
| OneStep                   | 293.802 ms                | 453.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.899 ms                  | 100.357 ms                |
| bucket keys               | 3.564 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.292 ms                  | 56.239 ms                 |
| forward: search cache     | 460.864 us                | 956.071 us                |
| forward: a2a values       | 16.160 ms                 | 35.588 ms                 |
| forward: join             | 1.533 ms                  | 3.272 ms                  |
| Forward                   | 56.962 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.681 ms                 | 82.261 ms                 |
| back: set dram grad       | 2.315 ms                  | 9.273 ms                  |
| back: a2a grad            | 22.427 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.730 ms                |
| Backward                  | 206.228 ms                | 273.711 ms                |
| Optimize                  | 15.791 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 52.772 us                 | 98.357 us                 |
| BlockToStepN              | 48.707 us                 | 18.948 ms                 |
| OneStep                   | 294.223 ms                | 443.141 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.987 ms                  | 108.912 ms                |
| bucket keys               | 3.545 ms                  | 6.538 ms                  |
| forward: a2a keys         | 6.244 ms                  | 56.008 ms                 |
| forward: search cache     | 461.943 us                | 902.031 us                |
| forward: a2a values       | 16.121 ms                 | 35.329 ms                 |
| forward: join             | 1.533 ms                  | 2.840 ms                  |
| Forward                   | 56.810 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.620 ms                 | 78.847 ms                 |
| back: set dram grad       | 2.315 ms                  | 9.171 ms                  |
| back: a2a grad            | 22.067 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.516 ms                |
| Backward                  | 205.883 ms                | 273.711 ms                |
| Optimize                  | 15.752 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 52.430 us                 | 98.357 us                 |
| BlockToStepN              | 48.912 us                 | 19.989 ms                 |
| OneStep                   | 293.802 ms                | 443.141 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.908 ms                  | 108.912 ms                |
| bucket keys               | 3.448 ms                  | 8.002 ms                  |
| forward: a2a keys         | 6.166 ms                  | 56.008 ms                 |
| forward: search cache     | 462.451 us                | 956.071 us                |
| forward: a2a values       | 16.121 ms                 | 35.588 ms                 |
| forward: join             | 1.539 ms                  | 2.840 ms                  |
| Forward                   | 56.810 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.591 ms                 | 78.847 ms                 |
| back: set dram grad       | 2.320 ms                  | 9.171 ms                  |
| back: a2a grad            | 22.067 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.516 ms                |
| Backward                  | 205.701 ms                | 273.711 ms                |
| Optimize                  | 15.731 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 52.226 us                 | 98.357 us                 |
| BlockToStepN              | 49.288 us                 | 19.989 ms                 |
| OneStep                   | 293.525 ms                | 443.141 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 29.714, sample: 0.918, forward: 6.492, backward: 12.035, update: 0.408
[proc 5] 300 steps, total: 29.714, sample: 0.893, forward: 6.477, backward: 12.080, update: 0.440
[proc 1] 300 steps, total: 29.714, sample: 0.964, forward: 6.411, backward: 12.841, update: 0.399
[proc 2] 300 steps, total: 29.714, sample: 1.019, forward: 6.334, backward: 12.346, update: 0.414
[proc 3] 300 steps, total: 29.714, sample: 1.072, forward: 6.286, backward: 12.288, update: 0.403
[proc 7] 300 steps, total: 29.714, sample: 1.001, forward: 6.417, backward: 12.227, update: 0.451
[proc 6] 300 steps, total: 29.714, sample: 1.064, forward: 6.339, backward: 12.012, update: 0.396
[proc 0] 300 steps, total: 29.714, sample: 1.349, forward: 5.959, backward: 20.657, update: 1.516
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.831 ms                  | 109.112 ms                |
| bucket keys               | 3.448 ms                  | 8.002 ms                  |
| forward: a2a keys         | 6.148 ms                  | 56.008 ms                 |
| forward: search cache     | 462.962 us                | 956.071 us                |
| forward: a2a values       | 16.120 ms                 | 35.588 ms                 |
| forward: join             | 1.539 ms                  | 2.840 ms                  |
| Forward                   | 56.810 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.578 ms                 | 78.847 ms                 |
| back: set dram grad       | 2.315 ms                  | 9.171 ms                  |
| back: a2a grad            | 22.067 ms                 | 49.374 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.516 ms                |
| Backward                  | 204.921 ms                | 273.711 ms                |
| Optimize                  | 15.715 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 52.087 us                 | 98.357 us                 |
| BlockToStepN              | 49.413 us                 | 19.989 ms                 |
| OneStep                   | 292.491 ms                | 443.141 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.739 ms                  | 109.112 ms                |
| bucket keys               | 3.450 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.108 ms                  | 53.613 ms                 |
| forward: search cache     | 462.546 us                | 902.031 us                |
| forward: a2a values       | 16.121 ms                 | 35.329 ms                 |
| forward: join             | 1.539 ms                  | 2.840 ms                  |
| Forward                   | 56.298 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.591 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.312 ms                  | 9.167 ms                  |
| back: a2a grad            | 22.079 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.047 ms                |
| Backward                  | 204.714 ms                | 273.711 ms                |
| Optimize                  | 15.665 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 51.445 us                 | 98.357 us                 |
| BlockToStepN              | 49.933 us                 | 19.989 ms                 |
| OneStep                   | 290.452 ms                | 443.141 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.708 ms                  | 108.912 ms                |
| bucket keys               | 3.107 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.108 ms                  | 53.613 ms                 |
| forward: search cache     | 462.016 us                | 902.031 us                |
| forward: a2a values       | 16.128 ms                 | 35.329 ms                 |
| forward: join             | 1.483 ms                  | 2.840 ms                  |
| Forward                   | 56.242 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.607 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.304 ms                  | 9.167 ms                  |
| back: a2a grad            | 22.113 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.047 ms                |
| Backward                  | 204.209 ms                | 271.191 ms                |
| Optimize                  | 15.616 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 51.443 us                 | 96.191 us                 |
| BlockToStepN              | 49.844 us                 | 18.948 ms                 |
| OneStep                   | 289.772 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.716 ms                  | 108.912 ms                |
| bucket keys               | 3.094 ms                  | 7.602 ms                  |
| forward: a2a keys         | 6.060 ms                  | 53.613 ms                 |
| forward: search cache     | 461.612 us                | 902.031 us                |
| forward: a2a values       | 16.128 ms                 | 37.488 ms                 |
| forward: join             | 1.463 ms                  | 2.912 ms                  |
| Forward                   | 56.174 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.523 ms                 | 73.082 ms                 |
| back: set dram grad       | 2.301 ms                  | 9.167 ms                  |
| back: a2a grad            | 22.123 ms                 | 46.831 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.047 ms                |
| Backward                  | 203.731 ms                | 271.191 ms                |
| Optimize                  | 15.597 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 51.490 us                 | 96.191 us                 |
| BlockToStepN              | 49.492 us                 | 18.948 ms                 |
| OneStep                   | 288.597 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.620 ms                  | 108.912 ms                |
| bucket keys               | 3.095 ms                  | 7.213 ms                  |
| forward: a2a keys         | 6.031 ms                  | 43.184 ms                 |
| forward: search cache     | 461.253 us                | 876.404 us                |
| forward: a2a values       | 16.136 ms                 | 35.588 ms                 |
| forward: join             | 1.463 ms                  | 2.912 ms                  |
| Forward                   | 56.242 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.523 ms                 | 70.969 ms                 |
| back: set dram grad       | 2.305 ms                  | 9.106 ms                  |
| back: a2a grad            | 22.123 ms                 | 46.373 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.047 ms                |
| Backward                  | 204.088 ms                | 271.191 ms                |
| Optimize                  | 15.620 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 51.588 us                 | 96.191 us                 |
| BlockToStepN              | 49.216 us                 | 18.948 ms                 |
| OneStep                   | 288.597 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 28.586, sample: 0.875, forward: 6.334, backward: 11.542, update: 0.438
[proc 3] 400 steps, total: 28.586, sample: 1.019, forward: 6.174, backward: 11.790, update: 0.444
[proc 6] 400 steps, total: 28.586, sample: 1.005, forward: 6.211, backward: 11.523, update: 0.406
[proc 5] 400 steps, total: 28.586, sample: 0.825, forward: 6.394, backward: 11.517, update: 0.443
[proc 7] 400 steps, total: 28.586, sample: 0.862, forward: 6.344, backward: 11.773, update: 0.421
[proc 0] 400 steps, total: 28.586, sample: 1.229, forward: 5.880, backward: 20.003, update: 1.362
[proc 2] 400 steps, total: 28.586, sample: 0.922, forward: 6.254, backward: 11.850, update: 0.447
[proc 1] 400 steps, total: 28.586, sample: 0.875, forward: 6.316, backward: 12.439, update: 0.340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.716 ms                  | 108.912 ms                |
| bucket keys               | 3.098 ms                  | 7.213 ms                  |
| forward: a2a keys         | 5.939 ms                  | 43.184 ms                 |
| forward: search cache     | 461.234 us                | 902.031 us                |
| forward: a2a values       | 16.120 ms                 | 35.588 ms                 |
| forward: join             | 1.463 ms                  | 2.941 ms                  |
| Forward                   | 56.201 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.523 ms                 | 70.969 ms                 |
| back: set dram grad       | 2.301 ms                  | 9.106 ms                  |
| back: a2a grad            | 22.067 ms                 | 46.373 ms                 |
| back: grad sum & grad cache  | 27.711 ms                 | 110.047 ms                |
| Backward                  | 203.253 ms                | 271.191 ms                |
| Optimize                  | 15.633 ms                 | 31.062 ms                 |
| BarrierTimeBeforeRank0    | 51.838 us                 | 98.357 us                 |
| BlockToStepN              | 49.065 us                 | 18.948 ms                 |
| OneStep                   | 287.601 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.708 ms                  | 108.912 ms                |
| bucket keys               | 3.061 ms                  | 7.602 ms                  |
| forward: a2a keys         | 5.939 ms                  | 43.184 ms                 |
| forward: search cache     | 461.169 us                | 902.031 us                |
| forward: a2a values       | 16.100 ms                 | 35.588 ms                 |
| forward: join             | 1.423 ms                  | 2.941 ms                  |
| Forward                   | 56.201 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.449 ms                 | 70.969 ms                 |
| back: set dram grad       | 2.300 ms                  | 9.106 ms                  |
| back: a2a grad            | 21.931 ms                 | 46.373 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 110.047 ms                |
| Backward                  | 203.155 ms                | 271.191 ms                |
| Optimize                  | 15.620 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 51.945 us                 | 98.357 us                 |
| BlockToStepN              | 48.912 us                 | 18.948 ms                 |
| OneStep                   | 287.206 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.739 ms                  | 108.912 ms                |
| bucket keys               | 3.068 ms                  | 7.213 ms                  |
| forward: a2a keys         | 5.894 ms                  | 40.759 ms                 |
| forward: search cache     | 461.903 us                | 876.404 us                |
| forward: a2a values       | 16.100 ms                 | 35.329 ms                 |
| forward: join             | 1.423 ms                  | 2.912 ms                  |
| Forward                   | 56.174 ms                 | 128.545 ms                |
| back: aggr dram keys      | 36.449 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.301 ms                  | 9.018 ms                  |
| back: a2a grad            | 21.704 ms                 | 46.117 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 110.047 ms                |
| Backward                  | 203.052 ms                | 271.191 ms                |
| Optimize                  | 15.637 ms                 | 33.052 ms                 |
| BarrierTimeBeforeRank0    | 51.848 us                 | 98.357 us                 |
| BlockToStepN              | 49.063 us                 | 18.948 ms                 |
| OneStep                   | 287.206 ms                | 430.584 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.708 ms                  | 100.777 ms                |
| bucket keys               | 3.053 ms                  | 7.213 ms                  |
| forward: a2a keys         | 5.821 ms                  | 40.759 ms                 |
| forward: search cache     | 462.034 us                | 956.071 us                |
| forward: a2a values       | 16.066 ms                 | 35.329 ms                 |
| forward: join             | 1.450 ms                  | 2.912 ms                  |
| Forward                   | 56.055 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.523 ms                 | 70.969 ms                 |
| back: set dram grad       | 2.304 ms                  | 9.018 ms                  |
| back: a2a grad            | 21.688 ms                 | 46.117 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 110.047 ms                |
| Backward                  | 203.052 ms                | 268.921 ms                |
| Optimize                  | 15.630 ms                 | 32.954 ms                 |
| BarrierTimeBeforeRank0    | 51.588 us                 | 98.357 us                 |
| BlockToStepN              | 49.063 us                 | 18.242 ms                 |
| OneStep                   | 287.429 ms                | 423.253 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.739 ms                  | 108.912 ms                |
| bucket keys               | 3.029 ms                  | 7.213 ms                  |
| forward: a2a keys         | 5.755 ms                  | 40.759 ms                 |
| forward: search cache     | 462.214 us                | 956.071 us                |
| forward: a2a values       | 16.066 ms                 | 35.329 ms                 |
| forward: join             | 1.450 ms                  | 2.912 ms                  |
| Forward                   | 55.858 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.578 ms                 | 70.969 ms                 |
| back: set dram grad       | 2.301 ms                  | 9.018 ms                  |
| back: a2a grad            | 21.688 ms                 | 46.117 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 110.047 ms                |
| Backward                  | 203.155 ms                | 268.921 ms                |
| Optimize                  | 15.620 ms                 | 32.954 ms                 |
| BarrierTimeBeforeRank0    | 51.848 us                 | 98.357 us                 |
| BlockToStepN              | 49.250 us                 | 18.242 ms                 |
| OneStep                   | 287.601 ms                | 423.253 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.778 ms                  | 108.912 ms                |
| bucket keys               | 3.029 ms                  | 6.820 ms                  |
| forward: a2a keys         | 5.737 ms                  | 40.274 ms                 |
| forward: search cache     | 462.516 us                | 902.031 us                |
| forward: a2a values       | 16.066 ms                 | 35.329 ms                 |
| forward: join             | 1.450 ms                  | 2.912 ms                  |
| Forward                   | 55.854 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.578 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.301 ms                  | 8.978 ms                  |
| back: a2a grad            | 21.688 ms                 | 46.117 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 109.768 ms                |
| Backward                  | 202.952 ms                | 268.921 ms                |
| Optimize                  | 15.616 ms                 | 32.954 ms                 |
| BarrierTimeBeforeRank0    | 51.563 us                 | 98.357 us                 |
| BlockToStepN              | 49.086 us                 | 18.242 ms                 |
| OneStep                   | 287.617 ms                | 423.253 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 28.982, sample: 0.953, forward: 6.049, backward: 12.092, update: 0.452
[proc 1] 500 steps, total: 28.982, sample: 0.904, forward: 6.100, backward: 12.620, update: 0.382
[proc 4] 500 steps, total: 28.982, sample: 0.891, forward: 6.121, backward: 11.900, update: 0.448
[proc 2] 500 steps, total: 28.982, sample: 0.922, forward: 6.059, backward: 12.162, update: 0.365
[proc 5] 500 steps, total: 28.982, sample: 0.851, forward: 6.138, backward: 11.909, update: 0.437
[proc 7] 500 steps, total: 28.982, sample: 0.934, forward: 6.102, backward: 12.040, update: 0.429
[proc 6] 500 steps, total: 28.982, sample: 0.938, forward: 6.084, backward: 11.867, update: 0.438
[proc 0] 500 steps, total: 28.982, sample: 1.274, forward: 5.659, backward: 20.392, update: 1.493
Successfully xmh. training takes 152.24193716049194 seconds
before call kg_cache_controller.StopThreads()
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
INFO [17467 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.739 ms                  | 108.912 ms                |
| bucket keys               | 3.042 ms                  | 6.915 ms                  |
| forward: a2a keys         | 5.745 ms                  | 40.274 ms                 |
| forward: search cache     | 462.791 us                | 902.031 us                |
| forward: a2a values       | 16.100 ms                 | 35.329 ms                 |
| forward: join             | 1.450 ms                  | 2.912 ms                  |
| Forward                   | 55.854 ms                 | 126.234 ms                |
| back: aggr dram keys      | 36.591 ms                 | 62.215 ms                 |
| back: set dram grad       | 2.301 ms                  | 8.978 ms                  |
| back: a2a grad            | 21.688 ms                 | 46.117 ms                 |
| back: grad sum & grad cache  | 30.586 ms                 | 109.768 ms                |
| Backward                  | 203.237 ms                | 268.921 ms                |
| Optimize                  | 15.616 ms                 | 32.954 ms                 |
| BarrierTimeBeforeRank0    | 51.556 us                 | 98.357 us                 |
| BlockToStepN              | 49.086 us                 | 18.242 ms                 |
| OneStep                   | 287.601 ms                | 423.253 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
