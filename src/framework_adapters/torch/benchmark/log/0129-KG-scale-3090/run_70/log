WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 01:57:25.589668 15337 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_22', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [15337 sampler.py:454] Start PreSampling
WARNING [15337 sampler.py:532] Before construct renumbering_dict
WARNING [15337 sampler.py:555] PreSampling done
W20240130 02:17:17.346966 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240130 02:17:17.347168 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240130 02:17:17.347219 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240130 02:17:17.347256 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240130 02:17:17.347285 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240130 02:17:17.347318 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240130 02:17:17.347347 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240130 02:17:17.347386 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240130 02:17:17.347421 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240130 02:17:17.347455 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240130 02:17:17.347493 15337 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240130 02:17:17.347519 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240130 02:17:17.347545 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240130 02:17:17.347704 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240130 02:17:17.347740 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240130 02:17:17.347769 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240130 02:17:17.347812 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240130 02:17:17.347846 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240130 02:17:17.347875 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240130 02:17:17.347904 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240130 02:17:17.347937 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240130 02:17:17.347977 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240130 02:17:17.348012 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240130 02:17:17.348037 15337 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240130 02:17:17.348071 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240130 02:17:17.348096 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240130 02:17:17.348150 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240130 02:17:17.348177 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240130 02:17:17.348205 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240130 02:17:17.348230 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240130 02:17:17.348258 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240130 02:17:17.348284 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240130 02:17:17.348321 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240130 02:17:17.348353 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240130 02:17:17.348395 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240130 02:17:17.348428 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240130 02:17:17.348462 15337 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240130 02:17:17.348484 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240130 02:17:17.348507 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240130 02:17:17.348563 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240130 02:17:17.348598 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240130 02:17:17.348628 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240130 02:17:17.348670 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240130 02:17:17.348699 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240130 02:17:17.348737 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240130 02:17:17.348767 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240130 02:17:17.348795 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240130 02:17:17.348824 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240130 02:17:17.348853 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240130 02:17:17.348886 15337 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240130 02:17:17.348907 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240130 02:17:17.348932 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240130 02:17:17.348994 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240130 02:17:17.349027 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240130 02:17:17.349056 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240130 02:17:17.349084 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240130 02:17:17.349110 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240130 02:17:17.349143 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240130 02:17:17.349175 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240130 02:17:17.349220 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240130 02:17:17.349256 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240130 02:17:17.349284 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240130 02:17:17.349315 15337 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240130 02:17:17.349337 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240130 02:17:17.349359 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240130 02:17:17.349412 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240130 02:17:17.349449 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240130 02:17:17.349479 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240130 02:17:17.349507 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240130 02:17:17.349534 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240130 02:17:17.349560 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240130 02:17:17.349586 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240130 02:17:17.349622 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240130 02:17:17.349658 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240130 02:17:17.349687 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240130 02:17:17.349715 15337 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240130 02:17:17.349737 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240130 02:17:17.349761 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240130 02:17:17.349813 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240130 02:17:17.349845 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240130 02:17:17.349877 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240130 02:17:17.349905 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240130 02:17:17.349932 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240130 02:17:17.349960 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240130 02:17:17.349988 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240130 02:17:17.350023 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240130 02:17:17.350049 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240130 02:17:17.350080 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240130 02:17:17.350111 15337 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240130 02:17:17.350134 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240130 02:17:17.350157 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240130 02:17:17.350205 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240130 02:17:17.350239 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240130 02:17:17.350266 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240130 02:17:17.350296 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240130 02:17:17.350322 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240130 02:17:17.350358 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240130 02:17:17.350387 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240130 02:17:17.350415 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240130 02:17:17.350442 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240130 02:17:17.350469 15337 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240130 02:17:17.350497 15337 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240130 02:17:17.350518 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240130 02:17:17.350546 15337 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240130 02:17:17.857355 15337 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240130 02:17:17.857517 15337 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605410,  8605418,    64709,  ..., 59905806, 49227659,  9473475]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1699.967 seconds
[Rank1] pid = 16290
[Rank2] pid = 16387
[Rank3] pid = 16455
[Rank4] pid = 16522
[Rank5] pid = 16591
[Rank6] pid = 16658
INFO [15337 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [16290 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [16387 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [16455 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [16522 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [16658 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [16522 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16455 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16658 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16387 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16290 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16591 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [16725 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [15337 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16591 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16725 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [16725 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16591 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16522 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16290 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16455 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16387 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [15337 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [16658 DistTensor.py:56] The tensor name already exists in the kvstore
I20240130 02:25:59.134694 16789 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.134930 16659 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135190 16523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135378 16456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135520 16592 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135625 16726 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135820 16388 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240130 02:25:59.135957 16291 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240130 02:26:00.917032 16388 recstore.cc:66] init folly done
E20240130 02:26:00.917060 16659 recstore.cc:66] init folly done
E20240130 02:26:00.917131 16291 recstore.cc:66] init folly done
E20240130 02:26:00.917126 16592 recstore.cc:66] init folly done
E20240130 02:26:00.917156 16789 recstore.cc:66] init folly done
E20240130 02:26:00.917613 16456 recstore.cc:66] init folly done
E20240130 02:26:00.917622 16523 recstore.cc:66] init folly done
E20240130 02:26:00.917634 16726 recstore.cc:66] init folly done
I20240130 02:26:06.801409 16789 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240130 02:26:06.923090 16523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:07.038213 16592 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:08.297219 16388 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:08.885181 16456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:09.002305 16291 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:09.388514 16726 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240130 02:26:10.458559 16659 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.149 ms                 | 159.902 ms                |
| Forward                   | 12.061 ms                 | 655.189 ms                |
| Backward                  | 244.643 ms                | 435.128 ms                |
| Optimize                  | 4.179 ms                  | 4.778 ms                  |
| BarrierTimeBeforeRank0    | 52.905 ms                 | 88.941 ms                 |
| BlockToStepN              | 30.294 us                 | 316.488 us                |
| OneStep                   | 332.381 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.253 ms                  | 159.902 ms                |
| Forward                   | 10.706 ms                 | 655.189 ms                |
| Backward                  | 240.467 ms                | 435.128 ms                |
| Optimize                  | 3.915 ms                  | 4.778 ms                  |
| BarrierTimeBeforeRank0    | 28.376 ms                 | 88.941 ms                 |
| BlockToStepN              | 31.831 us                 | 316.488 us                |
| OneStep                   | 293.128 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.090 ms                  | 159.902 ms                |
| Forward                   | 10.636 ms                 | 655.189 ms                |
| Backward                  | 239.524 ms                | 435.128 ms                |
| Optimize                  | 3.193 ms                  | 4.778 ms                  |
| BarrierTimeBeforeRank0    | 25.510 ms                 | 88.941 ms                 |
| BlockToStepN              | 31.831 us                 | 9.425 ms                  |
| OneStep                   | 287.817 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.936 ms                  | 150.999 ms                |
| Forward                   | 10.584 ms                 | 19.482 ms                 |
| Backward                  | 238.555 ms                | 435.128 ms                |
| Optimize                  | 3.295 ms                  | 7.312 ms                  |
| BarrierTimeBeforeRank0    | 25.773 ms                 | 88.941 ms                 |
| BlockToStepN              | 31.831 us                 | 9.425 ms                  |
| OneStep                   | 288.597 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.017 ms                  | 150.999 ms                |
| Forward                   | 10.608 ms                 | 19.482 ms                 |
| Backward                  | 237.549 ms                | 435.128 ms                |
| Optimize                  | 3.802 ms                  | 7.444 ms                  |
| BarrierTimeBeforeRank0    | 26.641 ms                 | 256.140 ms                |
| BlockToStepN              | 31.831 us                 | 14.416 ms                 |
| OneStep                   | 288.266 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.090 ms                  | 150.999 ms                |
| Forward                   | 10.603 ms                 | 19.482 ms                 |
| Backward                  | 238.555 ms                | 435.128 ms                |
| Optimize                  | 3.881 ms                  | 7.444 ms                  |
| BarrierTimeBeforeRank0    | 27.854 ms                 | 256.140 ms                |
| BlockToStepN              | 31.882 us                 | 14.416 ms                 |
| OneStep                   | 287.997 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 35.082, sample: 1.454, forward: 2.710, backward: 21.122, update: 0.288
[Rank7] pid = 16725
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
train_sampler.Prefill()
-------Step 0-------
tensor([  235721,   235767,   235801,   235839, 10311066,   835517, 66384205,
        24284505, 22027837,   235883]) tensor([ 9608653, 18569456, 74054101, 64178690, 27227685, 39956330, 34257204,
        81926148, 62357146, 37993266])
-------Step 1-------
tensor([  235721,   235767,   235801,   235839, 10311066,   835517, 66384205,
        24284505, 22027837,   235883]) tensor([ 3632930, 36558763, 16222678, 70824253, 83705299, 52906964, 79050482,
        52855706, 39832317, 18913607])
-------Step 2-------
tensor([  324447,   324486,   324528,   291864,   324567,   324608, 85217349,
        24789063,   324655,   324691]) tensor([62778499, 31691141, 85773350, 61154125, 37985615, 27627235, 79014756,
        51639690, 15758450, 51909837])
-------Step 3-------
tensor([  324447,   324486,   324528,   291864,   324567,   324608, 85217349,
        24789063,   324655,   324691]) tensor([48828325, 77400875, 44089402, 47681692, 73124279, 55567275, 33732241,
        22706637, 34664669,  1546914])
-------Step 4-------
tensor([  413153, 56198482,   413186,   857851,   413225,   857881,   413255,
        49607337,   413294,   413328]) tensor([73812681, 15106444, 73186334, 24629232, 70883574, 45976451, 57345338,
        46847475, 80866255, 53459662])
-------Step 5-------
tensor([  413153, 56198482,   413186,   857851,   413225,   857881,   413255,
        49607337,   413294,   413328]) tensor([35902446,  1486951,   921597, 85091403, 66916563, 44154895, 16175760,
        14893408, 82063546, 32815571])
-------Step 6-------
tensor([  502346,   323889, 42830314,   502385, 25915896, 64653292,   502417,
          502453, 45883837, 45585710]) tensor([18987670, 48025020, 38497575, 69699218, 34780766, 34294031, 24150412,
        10354379, 59695708, 80187531])
-------Step 7-------
tensor([  502346,   323889, 42830314,   502385, 25915896, 64653292,   502417,
          502453, 45883837, 45585710]) tensor([32720774, 46078685, 81843397, 51258041, 74346703, 47195014, 65874122,
        54361862, 45036084,   822848])
-------Step 8-------
tensor([  586642, 32160753,   586686,   878769,   586717,   339497,   586753,
          586781,   586826,   586860]) tensor([55318940, 24635172, 37326105,  3630735, 43909645,   136773, 17380180,
          586265,  3119510, 59884271])
-------Step 9-------
tensor([  586642, 32160753,   586686,   878769,   586717,   339497,   586753,
          586781,   586826,   586860]) tensor([47225481,  1851659, 15995933, 70086003, 13833714, 42637697,   812498,
        36559992, 84449525, 58564226])
before start barrier
start train
[proc 0] 100 steps, total: 32.495, sample: 1.520, forward: 1.720, backward: 24.239, update: 0.347
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 32.881, sample: 1.855, forward: 3.046, backward: 24.575, update: 0.343
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 32.998, sample: 1.495, forward: 2.943, backward: 24.855, update: 0.342
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 34.845, sample: 1.599, forward: 2.889, backward: 24.018, update: 0.428
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.586, sample: 1.812, forward: 2.889, backward: 23.720, update: 0.320
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 31.425, sample: 1.255, forward: 2.709, backward: 22.674, update: 0.391
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 34.961, sample: 1.413, forward: 2.759, backward: 23.974, update: 0.304
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.963 ms                  | 150.999 ms                |
| Forward                   | 10.548 ms                 | 33.286 ms                 |
| Backward                  | 237.715 ms                | 435.128 ms                |
| Optimize                  | 3.302 ms                  | 7.444 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 256.140 ms                |
| BlockToStepN              | 32.216 us                 | 14.416 ms                 |
| OneStep                   | 287.997 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.926 ms                  | 150.999 ms                |
| Forward                   | 10.548 ms                 | 33.286 ms                 |
| Backward                  | 237.709 ms                | 435.128 ms                |
| Optimize                  | 3.296 ms                  | 7.444 ms                  |
| BarrierTimeBeforeRank0    | 27.375 ms                 | 256.140 ms                |
| BlockToStepN              | 32.440 us                 | 19.171 ms                 |
| OneStep                   | 285.783 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 150.999 ms                |
| Forward                   | 10.530 ms                 | 33.286 ms                 |
| Backward                  | 237.715 ms                | 435.128 ms                |
| Optimize                  | 3.272 ms                  | 7.444 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 256.140 ms                |
| BlockToStepN              | 32.546 us                 | 19.171 ms                 |
| OneStep                   | 285.635 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.963 ms                  | 120.129 ms                |
| Forward                   | 10.517 ms                 | 19.482 ms                 |
| Backward                  | 238.470 ms                | 435.128 ms                |
| Optimize                  | 3.234 ms                  | 7.312 ms                  |
| BarrierTimeBeforeRank0    | 26.661 ms                 | 173.625 ms                |
| BlockToStepN              | 32.594 us                 | 18.735 ms                 |
| OneStep                   | 287.649 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 120.129 ms                |
| Forward                   | 10.500 ms                 | 19.482 ms                 |
| Backward                  | 238.728 ms                | 435.128 ms                |
| Optimize                  | 3.229 ms                  | 7.312 ms                  |
| BarrierTimeBeforeRank0    | 27.112 ms                 | 173.625 ms                |
| BlockToStepN              | 32.672 us                 | 18.735 ms                 |
| OneStep                   | 287.649 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.924 ms                  | 120.129 ms                |
| Forward                   | 10.505 ms                 | 19.482 ms                 |
| Backward                  | 238.470 ms                | 435.128 ms                |
| Optimize                  | 3.221 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 173.625 ms                |
| BlockToStepN              | 32.622 us                 | 18.735 ms                 |
| OneStep                   | 285.613 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 30.254, sample: 1.790, forward: 2.046, backward: 24.297, update: 0.423
[proc 5] 200 steps, total: 30.254, sample: 1.583, forward: 1.899, backward: 24.119, update: 0.362
[proc 3] 200 steps, total: 30.254, sample: 1.311, forward: 1.842, backward: 24.721, update: 0.318
[proc 0] 200 steps, total: 30.254, sample: 1.354, forward: 1.075, backward: 24.451, update: 0.305
[proc 7] 200 steps, total: 30.254, sample: 1.209, forward: 1.788, backward: 21.917, update: 0.285
[proc 6] 200 steps, total: 30.253, sample: 1.494, forward: 1.778, backward: 23.805, update: 0.314
[proc 4] 200 steps, total: 30.253, sample: 1.106, forward: 1.794, backward: 23.171, update: 0.337
[proc 2] 200 steps, total: 30.254, sample: 1.622, forward: 1.885, backward: 23.952, update: 0.297
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 120.129 ms                |
| Forward                   | 10.484 ms                 | 19.482 ms                 |
| Backward                  | 238.249 ms                | 435.128 ms                |
| Optimize                  | 3.204 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 184.991 ms                |
| BlockToStepN              | 32.622 us                 | 18.735 ms                 |
| OneStep                   | 284.676 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 120.129 ms                |
| Forward                   | 10.460 ms                 | 19.482 ms                 |
| Backward                  | 238.058 ms                | 435.128 ms                |
| Optimize                  | 3.175 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 184.991 ms                |
| BlockToStepN              | 32.672 us                 | 18.735 ms                 |
| OneStep                   | 284.676 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 120.129 ms                |
| Forward                   | 10.452 ms                 | 19.482 ms                 |
| Backward                  | 238.262 ms                | 435.128 ms                |
| Optimize                  | 3.131 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 184.991 ms                |
| BlockToStepN              | 32.672 us                 | 18.735 ms                 |
| OneStep                   | 284.434 ms                | 507.222 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.916 ms                  | 118.321 ms                |
| Forward                   | 10.461 ms                 | 14.987 ms                 |
| Backward                  | 238.555 ms                | 400.543 ms                |
| Optimize                  | 3.046 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 26.648 ms                 | 173.625 ms                |
| BlockToStepN              | 32.699 us                 | 19.171 ms                 |
| OneStep                   | 284.734 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.926 ms                  | 118.321 ms                |
| Forward                   | 10.467 ms                 | 14.987 ms                 |
| Backward                  | 238.170 ms                | 400.543 ms                |
| Optimize                  | 3.107 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.510 ms                 | 184.991 ms                |
| BlockToStepN              | 32.699 us                 | 19.171 ms                 |
| OneStep                   | 284.434 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.926 ms                  | 118.321 ms                |
| Forward                   | 10.475 ms                 | 14.987 ms                 |
| Backward                  | 237.549 ms                | 400.543 ms                |
| Optimize                  | 3.201 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.515 ms                 | 184.991 ms                |
| BlockToStepN              | 32.762 us                 | 19.171 ms                 |
| OneStep                   | 284.006 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 29.711, sample: 0.937, forward: 1.663, backward: 21.908, update: 0.334
[proc 5] 300 steps, total: 29.711, sample: 1.202, forward: 1.766, backward: 24.002, update: 0.361
[proc 7] 300 steps, total: 29.711, sample: 0.999, forward: 1.743, backward: 22.869, update: 0.286
[proc 6] 300 steps, total: 29.711, sample: 1.044, forward: 1.710, backward: 24.171, update: 0.309
[proc 2] 300 steps, total: 29.711, sample: 1.158, forward: 1.762, backward: 24.137, update: 0.299
[proc 3] 300 steps, total: 29.711, sample: 1.129, forward: 1.754, backward: 24.511, update: 0.326
[proc 1] 300 steps, total: 29.711, sample: 2.033, forward: 1.924, backward: 24.231, update: 0.405
[proc 0] 300 steps, total: 29.711, sample: 1.193, forward: 1.065, backward: 23.939, update: 0.335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.926 ms                  | 118.321 ms                |
| Forward                   | 10.487 ms                 | 19.482 ms                 |
| Backward                  | 237.486 ms                | 400.543 ms                |
| Optimize                  | 3.227 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.165 ms                 | 184.991 ms                |
| BlockToStepN              | 32.699 us                 | 19.693 ms                 |
| OneStep                   | 284.006 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.924 ms                  | 118.321 ms                |
| Forward                   | 10.501 ms                 | 19.482 ms                 |
| Backward                  | 237.421 ms                | 400.543 ms                |
| Optimize                  | 3.232 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 25.165 ms                 | 184.991 ms                |
| BlockToStepN              | 32.659 us                 | 19.693 ms                 |
| OneStep                   | 284.006 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.936 ms                  | 118.321 ms                |
| Forward                   | 10.513 ms                 | 19.482 ms                 |
| Backward                  | 237.341 ms                | 400.543 ms                |
| Optimize                  | 3.235 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 25.105 ms                 | 190.348 ms                |
| BlockToStepN              | 32.620 us                 | 19.693 ms                 |
| OneStep                   | 283.957 ms                | 506.846 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.962 ms                  | 114.766 ms                |
| Forward                   | 10.520 ms                 | 17.243 ms                 |
| Backward                  | 236.753 ms                | 365.542 ms                |
| Optimize                  | 3.238 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.133 ms                 | 184.991 ms                |
| BlockToStepN              | 32.620 us                 | 19.693 ms                 |
| OneStep                   | 283.830 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.976 ms                  | 114.766 ms                |
| Forward                   | 10.526 ms                 | 17.243 ms                 |
| Backward                  | 236.753 ms                | 365.542 ms                |
| Optimize                  | 3.258 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.025 ms                 | 184.991 ms                |
| BlockToStepN              | 32.672 us                 | 19.693 ms                 |
| OneStep                   | 283.322 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.970 ms                  | 114.766 ms                |
| Forward                   | 10.533 ms                 | 17.243 ms                 |
| Backward                  | 236.836 ms                | 365.542 ms                |
| Optimize                  | 3.272 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 25.007 ms                 | 184.991 ms                |
| BlockToStepN              | 32.620 us                 | 19.693 ms                 |
| OneStep                   | 283.304 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 29.622, sample: 1.069, forward: 1.656, backward: 23.819, update: 0.300
[proc 4] 400 steps, total: 29.622, sample: 0.952, forward: 1.618, backward: 22.293, update: 0.374
[proc 2] 400 steps, total: 29.622, sample: 1.148, forward: 1.691, backward: 23.979, update: 0.304
[proc 7] 400 steps, total: 29.622, sample: 0.947, forward: 1.641, backward: 22.377, update: 0.287
[proc 5] 400 steps, total: 29.622, sample: 1.065, forward: 1.698, backward: 23.632, update: 0.409
[proc 1] 400 steps, total: 29.621, sample: 1.721, forward: 1.856, backward: 24.387, update: 0.427
[proc 0] 400 steps, total: 29.621, sample: 1.174, forward: 1.110, backward: 24.070, update: 0.365
[proc 3] 400 steps, total: 29.622, sample: 1.100, forward: 1.676, backward: 24.404, update: 0.315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 114.766 ms                |
| Forward                   | 10.539 ms                 | 19.482 ms                 |
| Backward                  | 236.753 ms                | 365.542 ms                |
| Optimize                  | 3.296 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 24.826 ms                 | 184.991 ms                |
| BlockToStepN              | 32.569 us                 | 19.693 ms                 |
| OneStep                   | 283.188 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.064 ms                  | 114.766 ms                |
| Forward                   | 10.552 ms                 | 19.482 ms                 |
| Backward                  | 236.524 ms                | 365.542 ms                |
| Optimize                  | 3.295 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 24.826 ms                 | 184.991 ms                |
| BlockToStepN              | 32.569 us                 | 19.693 ms                 |
| OneStep                   | 283.170 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.064 ms                  | 114.766 ms                |
| Forward                   | 10.563 ms                 | 19.482 ms                 |
| Backward                  | 236.441 ms                | 365.542 ms                |
| Optimize                  | 3.302 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 24.679 ms                 | 184.991 ms                |
| BlockToStepN              | 32.632 us                 | 19.693 ms                 |
| OneStep                   | 283.111 ms                | 497.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.064 ms                  | 107.163 ms                |
| Forward                   | 10.585 ms                 | 17.243 ms                 |
| Backward                  | 236.441 ms                | 365.542 ms                |
| Optimize                  | 3.360 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 24.468 ms                 | 174.306 ms                |
| BlockToStepN              | 32.546 us                 | 20.579 ms                 |
| OneStep                   | 283.036 ms                | 492.572 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.090 ms                  | 109.119 ms                |
| Forward                   | 10.606 ms                 | 17.243 ms                 |
| Backward                  | 236.322 ms                | 365.542 ms                |
| Optimize                  | 3.296 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 24.175 ms                 | 174.306 ms                |
| BlockToStepN              | 32.535 us                 | 20.579 ms                 |
| OneStep                   | 282.708 ms                | 492.572 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.099 ms                  | 109.119 ms                |
| Forward                   | 10.603 ms                 | 17.243 ms                 |
| Backward                  | 235.667 ms                | 365.542 ms                |
| Optimize                  | 3.270 ms                  | 7.380 ms                  |
| BarrierTimeBeforeRank0    | 24.175 ms                 | 174.306 ms                |
| BlockToStepN              | 32.536 us                 | 20.579 ms                 |
| OneStep                   | 282.323 ms                | 492.572 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 28.686, sample: 0.967, forward: 1.535, backward: 21.837, update: 0.341
[proc 1] 500 steps, total: 28.686, sample: 1.491, forward: 1.748, backward: 23.748, update: 0.408
[proc 2] 500 steps, total: 28.686, sample: 1.085, forward: 1.650, backward: 23.516, update: 0.343
[proc 6] 500 steps, total: 28.686, sample: 1.028, forward: 1.579, backward: 23.020, update: 0.320
[proc 7] 500 steps, total: 28.686, sample: 0.976, forward: 1.598, backward: 22.127, update: 0.351
[proc 3] 500 steps, total: 28.686, sample: 1.225, forward: 1.644, backward: 24.009, update: 0.381
[proc 5] 500 steps, total: 28.686, sample: 1.123, forward: 1.674, backward: 23.115, update: 0.378
[proc 0] 500 steps, total: 28.686, sample: 1.276, forward: 1.106, backward: 23.402, update: 0.318
Successfully xmh. training takes 150.7680127620697 seconds
before call kg_cache_controller.StopThreads()
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
INFO [15337 controller_process.py:421] call rank0 to StopThreads
