WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 14:07:08.882848 64364 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_48', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [64364 sampler.py:454] Start PreSampling
WARNING [64364 sampler.py:532] Before construct renumbering_dict
WARNING [64364 sampler.py:555] PreSampling done
W20240129 14:07:13.717608 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 14:07:13.717859 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 14:07:13.717907 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 14:07:13.717950 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 14:07:13.717999 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 14:07:13.718051 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 14:07:13.718102 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 14:07:13.718153 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 14:07:13.718201 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 14:07:13.718251 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 14:07:13.718305 64364 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 14:07:13.718343 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 14:07:13.718386 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 14:07:13.718533 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 14:07:13.718596 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 14:07:13.718636 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 14:07:13.718685 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 14:07:13.718729 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 14:07:13.718781 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 14:07:13.718829 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 14:07:13.718873 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 14:07:13.718914 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 14:07:13.718952 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 14:07:13.718997 64364 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 14:07:13.719028 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 14:07:13.719067 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 14:07:13.719141 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 14:07:13.719180 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 14:07:13.719223 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 14:07:13.719277 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 14:07:13.719324 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 14:07:13.719380 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 14:07:13.719436 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 14:07:13.719477 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 14:07:13.719538 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 14:07:13.719583 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 14:07:13.719624 64364 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 14:07:13.719656 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 14:07:13.719695 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 14:07:13.719772 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 14:07:13.719813 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 14:07:13.719856 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 14:07:13.719892 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 14:07:13.719931 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 14:07:13.719985 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 14:07:13.720041 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 14:07:13.720104 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 14:07:13.720160 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 14:07:13.720204 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 14:07:13.720249 64364 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 14:07:13.720281 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 14:07:13.720322 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 14:07:13.720417 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 14:07:13.720465 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 14:07:13.720505 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 14:07:13.720549 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 14:07:13.720587 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 14:07:13.720639 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 14:07:13.720685 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 14:07:13.720732 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 14:07:13.720780 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 14:07:13.720817 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 14:07:13.720865 64364 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 14:07:13.720899 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 14:07:13.720933 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 14:07:13.721002 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 14:07:13.721045 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 14:07:13.721082 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 14:07:13.721122 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 14:07:13.721171 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 14:07:13.721218 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 14:07:13.721256 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 14:07:13.721302 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 14:07:13.721343 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 14:07:13.721381 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 14:07:13.721426 64364 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 14:07:13.721457 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 14:07:13.721490 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 14:07:13.721561 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240129 14:07:13.721606 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240129 14:07:13.721645 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240129 14:07:13.721693 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240129 14:07:13.721740 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240129 14:07:13.721783 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240129 14:07:13.721836 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240129 14:07:13.721884 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240129 14:07:13.721922 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240129 14:07:13.721962 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240129 14:07:13.722013 64364 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240129 14:07:13.722045 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240129 14:07:13.722085 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240129 14:07:13.722155 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240129 14:07:13.722210 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240129 14:07:13.722249 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240129 14:07:13.722296 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240129 14:07:13.722342 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240129 14:07:13.722380 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240129 14:07:13.722424 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240129 14:07:13.722465 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240129 14:07:13.722502 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240129 14:07:13.722540 64364 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240129 14:07:13.722589 64364 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240129 14:07:13.722620 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240129 14:07:13.722651 64364 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240129 14:07:13.990098 64364 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240129 14:07:13.990293 64364 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 764, 1187, 1770,  ..., 7710, 7634, 7424]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.210 seconds
[Rank1] pid = 65189
[Rank2] pid = 65242
[Rank3] pid = 65317
[Rank4] pid = 65347
[Rank5] pid = 65445
[Rank6] pid = 65448
INFO [64364 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [65189 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [65242 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [65317 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [65347 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [65445 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [65515 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [65448 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [65445 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65448 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65515 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65347 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65189 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65242 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64364 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65317 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240129 14:07:16.584853 65447 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240129 14:07:16.586026   505 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240129 14:07:16.586163 65382 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240129 14:07:16.587204   504 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240129 14:07:16.588443 65514 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240129 14:07:16.588536 65318 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240129 14:07:16.589131 65190 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240129 14:07:16.589138 65254 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240129 14:07:16.622175   505 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a0e000 7.629 MB
W20240129 14:07:16.622344   505 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000281b1000 7.629 MB
W20240129 14:07:16.622357 65447 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100028954000 7.629 MB
W20240129 14:07:16.622368 65514 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000290f7000 7.629 MB
W20240129 14:07:16.622375 65382 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10002989a000 7.629 MB
W20240129 14:07:16.622390 65318 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10002a03d000 7.629 MB
W20240129 14:07:16.622478   505 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002a7e0000 1.49 GB
W20240129 14:07:16.622522   505 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100089dc3000 1.49 GB
W20240129 14:07:16.622576   505 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 14:07:16.622952 65447 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000e93a6000 7.629 MB
W20240129 14:07:16.624210 65514 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000e9b49000 7.629 MB
W20240129 14:07:16.624333 65447 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1000ea2ec000 1.49 GB
W20240129 14:07:16.624373 65514 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1001498cf000 1.49 GB
W20240129 14:07:16.624413 65447 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001a8eb2000 1.49 GB
W20240129 14:07:16.624450 65514 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100208495000 1.49 GB
W20240129 14:07:16.624471 65318 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100267a78000 7.629 MB
W20240129 14:07:16.624497 65382 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10026821b000 7.629 MB
W20240129 14:07:16.624509 65447 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 14:07:16.624518 65514 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 14:07:16.624553 65318 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1002689be000 1.49 GB
W20240129 14:07:16.624584 65382 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1002c7fa1000 1.49 GB
W20240129 14:07:16.624609 65318 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100327584000 1.49 GB
W20240129 14:07:16.624644 65382 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100386b67000 1.49 GB
W20240129 14:07:16.624670 65318 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 14:07:16.624702 65382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 14:07:16.627705   505 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240129 14:07:16.627885 65190 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1003e6150000 7.629 MB
W20240129 14:07:16.627889 65254 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1003e68f3000 7.629 MB
W20240129 14:07:16.628018 65190 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003e7096000 7.629 MB
W20240129 14:07:16.628024 65254 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e7839000 7.629 MB
W20240129 14:07:16.628129 65254 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e7fdc000 1.49 GB
W20240129 14:07:16.628142 65190 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1004475bf000 1.49 GB
W20240129 14:07:16.628181 65254 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1004a6ba2000 1.49 GB
W20240129 14:07:16.628196 65190 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100506185000 1.49 GB
W20240129 14:07:16.628242 65190 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 14:07:16.628244 65254 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 14:07:16.636018 65447 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240129 14:07:16.636029 65514 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240129 14:07:16.636206 65190 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 14:07:16.636229 65318 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 14:07:16.636253 65382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240129 14:07:16.637670 65254 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 14:07:16.639256   504 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100565778000 7.629 MB
W20240129 14:07:16.639375   504 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100565f1b000 7.629 MB
W20240129 14:07:16.639457   504 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1005666be000 1.49 GB
W20240129 14:07:16.639509   504 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1005c5ca1000 1.49 GB
W20240129 14:07:16.639571   504 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 14:07:16.647975   504 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [65189 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [65347 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [65445 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [65242 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [65515 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [65448 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [65317 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 65515
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [64364 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 14:07:19.172287   504 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.172727 65318 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.172966 65254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.173120 65190 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.173961   505 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.174044 65382 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.174304 65514 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240129 14:07:19.174558 65447 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240129 14:07:19.177942   504 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 14:07:19.178073   504 grad_base.h:184] Init GradProcessingBase done
I20240129 14:07:19.180610   504 grad_async_v1.h:199] Use main thread to update emb.
W20240129 14:07:19.180667   504 kg_controller.h:75] after init GradAsyncProcessing
I20240129 14:07:19.180678   504 kg_controller.h:84] Construct KGCacheController done
E20240129 14:07:19.913939   504 recstore.cc:66] init folly done
E20240129 14:07:19.914031 65254 recstore.cc:66] init folly done
E20240129 14:07:19.914103 65514 recstore.cc:66] init folly done
E20240129 14:07:19.914129 65318 recstore.cc:66] init folly done
E20240129 14:07:19.914129 65382 recstore.cc:66] init folly done
E20240129 14:07:19.915019 65447 recstore.cc:66] init folly done
E20240129 14:07:19.915450 65190 recstore.cc:66] init folly done
E20240129 14:07:19.915606   505 recstore.cc:66] init folly done
I20240129 14:07:19.916733   504 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 14:07:20.695241  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
I20240129 14:07:20.736617   504 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240129 14:07:20.739146 65318 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.746731 65382 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.746856 65254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.748010   505 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.754235 65190 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.754578 65514 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240129 14:07:20.755367 65447 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240129 14:07:23.076177   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=0
W20240129 14:07:23.139185  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:07:24.147573  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.035 ms                  | 28.281 ms                 |
| Forward                   | 5.320 ms                  | 633.503 ms                |
| Backward                  | 9.602 ms                  | 245.582 ms                |
| Optimize                  | 2.900 ms                  | 5.020 ms                  |
| BarrierTimeBeforeRank0    | 332.249 us                | 12.915 ms                 |
| AfterBackward             | 28.939 ms                 | 1.434 s                   |
| BlockToStepN              | 43.970 us                 | 57.481 ms                 |
| OneStep                   | 50.757 ms                 | 2.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:24.880080   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=16, pq.top=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.695 ms                  | 409.232 ms                |
| ProcessBack:UpdateCache   | 9.093 ms                  | 736.465 ms                |
| ProcessBack:UpsertPq      | 11.351 ms                 | 49.850 ms                 |
| ProcessOneStep            | 29.429 ms                 | 1.433 s                   |
| BlockToStepN              | 578.000 ns                | 56.798 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:25.162830  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end8
W20240129 14:07:25.902988   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240129 14:07:26.228508  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end0
W20240129 14:07:27.066084   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240129 14:07:27.328794  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:07:28.094136   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240129 14:07:28.347188  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:07:29.094012   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.188 ms                  | 28.281 ms                 |
| Forward                   | 5.507 ms                  | 633.503 ms                |
| Backward                  | 9.707 ms                  | 245.582 ms                |
| Optimize                  | 2.859 ms                  | 5.020 ms                  |
| BarrierTimeBeforeRank0    | 332.249 us                | 19.849 ms                 |
| AfterBackward             | 32.157 ms                 | 1.434 s                   |
| BlockToStepN              | 22.084 ms                 | 261.344 ms                |
| OneStep                   | 88.749 ms                 | 2.379 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:29.349934  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.377 ms                  | 376.942 ms                |
| ProcessBack:UpdateCache   | 9.454 ms                  | 736.361 ms                |
| ProcessBack:UpsertPq      | 13.067 ms                 | 80.171 ms                 |
| ProcessOneStep            | 32.128 ms                 | 1.433 s                   |
| BlockToStepN              | 23.237 ms                 | 261.014 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:30.106987   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=48, pq.top=48
W20240129 14:07:30.359854  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end0
W20240129 14:07:31.156643   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240129 14:07:31.384678  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end6
W20240129 14:07:32.156008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240129 14:07:32.427753  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end3
W20240129 14:07:33.156008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240129 14:07:33.457755  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end9
W20240129 14:07:34.156020   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.247 ms                  | 27.194 ms                 |
| Forward                   | 5.552 ms                  | 20.197 ms                 |
| Backward                  | 9.784 ms                  | 14.593 ms                 |
| Optimize                  | 2.724 ms                  | 4.993 ms                  |
| BarrierTimeBeforeRank0    | 101.434 us                | 14.772 ms                 |
| AfterBackward             | 33.390 ms                 | 922.494 ms                |
| BlockToStepN              | 85.403 ms                 | 143.916 ms                |
| OneStep                   | 147.788 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:34.468613  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.356 ms                  | 16.323 ms                 |
| ProcessBack:UpdateCache   | 9.309 ms                  | 21.418 ms                 |
| ProcessBack:UpsertPq      | 14.941 ms                 | 49.850 ms                 |
| ProcessOneStep            | 33.504 ms                 | 922.090 ms                |
| BlockToStepN              | 86.344 ms                 | 152.746 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:35.156008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240129 14:07:35.478312  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:07:36.156009   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240129 14:07:36.478909  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:07:37.184661   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240129 14:07:37.529110  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:07:38.184006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=94, pq.top=94
W20240129 14:07:38.537645  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:07:39.184007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.310 ms                  | 29.617 ms                 |
| Forward                   | 5.552 ms                  | 21.557 ms                 |
| Backward                  | 9.784 ms                  | 19.161 ms                 |
| Optimize                  | 2.664 ms                  | 4.993 ms                  |
| BarrierTimeBeforeRank0    | 221.681 us                | 26.340 ms                 |
| AfterBackward             | 34.134 ms                 | 922.494 ms                |
| BlockToStepN              | 96.339 ms                 | 162.748 ms                |
| OneStep                   | 162.142 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.715, sample: 0.484, forward: 1.088, backward: 1.117, update: 0.260
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.706, sample: 0.403, forward: 1.114, backward: 1.146, update: 0.281
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.708, sample: 0.443, forward: 1.174, backward: 1.144, update: 0.276
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.700, sample: 0.456, forward: 1.112, backward: 1.101, update: 0.269
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.700, sample: 0.433, forward: 1.182, backward: 0.669, update: 0.274
train_sampler.Prefill()
-------Step 0-------
tensor([ 1760,    13,  3004,    72, 10525, 13350,  1174,  9895, 10900, 12510]) tensor([ 1770,  7795,  5078,  9251,  9727,   999,  7001,  5181,   521, 10401])
-------Step 1-------
tensor([ 1760,    13,  3004,    72, 10525, 13350,  1174,  9895, 10900, 12510]) tensor([ 4853, 11967,  9157,  4251,  2141, 10510,  8576,  3297, 12520,  8201])
-------Step 2-------
tensor([ 1799, 10822,  5303, 12808, 12220,  5699, 10672, 10679,  6076, 12799]) tensor([ 9907,  4676,  1718,  6860, 11164,  3223,   148,  3307,   183, 14423])
-------Step 3-------
tensor([ 1799, 10822,  5303, 12808, 12220,  5699, 10672, 10679,  6076, 12799]) tensor([10443,  9199,  6602,  9582,  5281,  9860,  7145,  9828,  8022, 13758])
-------Step 4-------
tensor([ 4008,    85, 13757, 13918,  5657, 10680, 11944,  4539,     9, 10034]) tensor([ 9592,  7448,   527, 12517, 10639, 13009, 12815,  4080, 10123,   448])
-------Step 5-------
tensor([ 4008,    85, 13757, 13918,  5657, 10680, 11944,  4539,     9, 10034]) tensor([ 3086,  2226, 13158,  1140,  4624, 14772,  8027, 14021,  4817, 10743])
-------Step 6-------
tensor([ 8323, 12939,  7492,  5955, 10118,   927,  5772,  7953, 14528,  7178]) tensor([ 9120,  9923, 14263,  2132,  2466,  4539,  9407,  2961,  4009,  4373])
-------Step 7-------
tensor([ 8323, 12939,  7492,  5955, 10118,   927,  5772,  7953, 14528,  7178]) tensor([12862, 12473,  7610,  5857, 14566,  1921,  8977,   268, 11086, 13235])
-------Step 8-------
tensor([12590,  3309, 10583, 13403,  3076,  8975, 13918,  2894,  4298,   821]) tensor([ 3537, 10407,  1673,  5145, 12300, 13826, 10634,  6764, 10125,  4210])
-------Step 9-------
tensor([12590,  3309, 10583, 13403,  3076,  8975, 13918,  2894,  4298,   821]) tensor([ 9605,  8168, 10591,   231, 10213,  5592,  3536,  3488,  2433, 13719])
before start barrier
start train
[proc 0] 100 steps, total: 18.718, sample: 0.496, forward: 1.244, backward: 1.189, update: 0.288
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.699, sample: 0.444, forward: 1.114, backward: 0.738, update: 0.266
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.708, sample: 0.466, forward: 1.169, backward: 1.209, update: 0.277
W20240129 14:07:39.549901  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.356 ms                  | 16.323 ms                 |
| ProcessBack:UpdateCache   | 9.384 ms                  | 21.418 ms                 |
| ProcessBack:UpsertPq      | 15.431 ms                 | 49.850 ms                 |
| ProcessOneStep            | 34.111 ms                 | 922.090 ms                |
| BlockToStepN              | 98.552 ms                 | 171.855 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:40.184007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240129 14:07:40.550912  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:07:41.184017   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240129 14:07:41.595870  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:07:42.184007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240129 14:07:42.603850  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:07:43.184007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240129 14:07:43.605975  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:07:44.184008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=124, pq.top=124
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.353 ms                  | 29.617 ms                 |
| Forward                   | 5.475 ms                  | 21.557 ms                 |
| Backward                  | 9.756 ms                  | 19.161 ms                 |
| Optimize                  | 2.646 ms                  | 4.993 ms                  |
| BarrierTimeBeforeRank0    | 300.984 us                | 26.634 ms                 |
| AfterBackward             | 34.220 ms                 | 922.494 ms                |
| BlockToStepN              | 105.666 ms                | 176.799 ms                |
| OneStep                   | 166.519 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:44.611852  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.345 ms                  | 12.605 ms                 |
| ProcessBack:UpdateCache   | 9.384 ms                  | 16.935 ms                 |
| ProcessBack:UpsertPq      | 15.587 ms                 | 49.387 ms                 |
| ProcessOneStep            | 34.210 ms                 | 922.090 ms                |
| BlockToStepN              | 106.284 ms                | 178.812 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:45.184017   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240129 14:07:45.620126  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:07:46.184011   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240129 14:07:46.634686  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:07:47.184006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240129 14:07:47.676106  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:07:48.221428   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240129 14:07:48.749433  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.379 ms                  | 29.617 ms                 |
| Forward                   | 5.466 ms                  | 21.557 ms                 |
| Backward                  | 9.741 ms                  | 19.161 ms                 |
| Optimize                  | 2.646 ms                  | 5.020 ms                  |
| BarrierTimeBeforeRank0    | 535.272 us                | 28.477 ms                 |
| AfterBackward             | 34.319 ms                 | 922.494 ms                |
| BlockToStepN              | 110.898 ms                | 186.543 ms                |
| OneStep                   | 173.130 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:49.275053   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240129 14:07:49.752053  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.328 ms                  | 12.605 ms                 |
| ProcessBack:UpdateCache   | 9.419 ms                  | 18.597 ms                 |
| ProcessBack:UpsertPq      | 15.587 ms                 | 49.387 ms                 |
| ProcessOneStep            | 34.289 ms                 | 922.090 ms                |
| BlockToStepN              | 111.072 ms                | 190.444 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:50.275017   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=152, pq.top=152
W20240129 14:07:50.767534  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:07:51.275007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240129 14:07:51.790968  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:07:52.275005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=162, pq.top=162
W20240129 14:07:52.895617  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:07:53.275005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240129 14:07:53.909842  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.380 ms                  | 29.617 ms                 |
| Forward                   | 5.478 ms                  | 20.197 ms                 |
| Backward                  | 9.741 ms                  | 18.623 ms                 |
| Optimize                  | 2.646 ms                  | 5.020 ms                  |
| BarrierTimeBeforeRank0    | 434.809 us                | 28.477 ms                 |
| AfterBackward             | 34.339 ms                 | 816.137 ms                |
| BlockToStepN              | 115.113 ms                | 190.542 ms                |
| OneStep                   | 184.762 ms                | 837.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:54.336346   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.267 ms                  | 12.605 ms                 |
| ProcessBack:UpdateCache   | 9.423 ms                  | 18.597 ms                 |
| ProcessBack:UpsertPq      | 15.587 ms                 | 49.387 ms                 |
| ProcessOneStep            | 34.306 ms                 | 815.978 ms                |
| BlockToStepN              | 115.189 ms                | 190.444 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:54.970599  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:07:55.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240129 14:07:55.976585  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:07:56.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240129 14:07:56.992856  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:07:57.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240129 14:07:57.993443  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:07:58.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240129 14:07:58.996377  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.382 ms                  | 29.617 ms                 |
| Forward                   | 5.478 ms                  | 20.197 ms                 |
| Backward                  | 9.740 ms                  | 18.623 ms                 |
| Optimize                  | 2.664 ms                  | 5.038 ms                  |
| BarrierTimeBeforeRank0    | 535.272 us                | 28.477 ms                 |
| AfterBackward             | 34.346 ms                 | 816.137 ms                |
| BlockToStepN              | 118.443 ms                | 202.116 ms                |
| OneStep                   | 189.076 ms                | 837.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:07:59.336011   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.236 ms                  | 12.576 ms                 |
| ProcessBack:UpdateCache   | 9.505 ms                  | 16.935 ms                 |
| ProcessBack:UpsertPq      | 15.646 ms                 | 28.533 ms                 |
| ProcessOneStep            | 34.340 ms                 | 815.978 ms                |
| BlockToStepN              | 119.223 ms                | 202.062 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:00.004654  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:00.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240129 14:08:01.010975  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:08:01.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 3] 200 steps, total: 22.020, sample: 0.434, forward: 0.450, backward: 0.895, update: 0.239
[proc 4] 200 steps, total: 22.020, sample: 0.457, forward: 0.526, backward: 0.873, update: 0.265
[proc 7] 200 steps, total: 22.020, sample: 0.422, forward: 0.515, backward: 0.963, update: 0.264
[proc 6] 200 steps, total: 22.020, sample: 0.447, forward: 0.505, backward: 0.909, update: 0.253
[proc 5] 200 steps, total: 22.020, sample: 0.470, forward: 0.526, backward: 0.560, update: 0.254
[proc 2] 200 steps, total: 22.020, sample: 0.401, forward: 0.531, backward: 0.991, update: 0.255
[proc 0] 200 steps, total: 22.020, sample: 0.518, forward: 0.559, backward: 0.958, update: 0.290
[proc 1] 200 steps, total: 22.020, sample: 0.440, forward: 0.512, backward: 0.524, update: 0.257
W20240129 14:08:02.011286  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:02.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=204, pq.top=204
W20240129 14:08:03.025635  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:03.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240129 14:08:04.028661  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.421 ms                  | 29.617 ms                 |
| Forward                   | 5.457 ms                  | 20.197 ms                 |
| Backward                  | 9.747 ms                  | 18.623 ms                 |
| Optimize                  | 2.651 ms                  | 5.065 ms                  |
| BarrierTimeBeforeRank0    | 914.068 us                | 28.477 ms                 |
| AfterBackward             | 34.346 ms                 | 816.137 ms                |
| BlockToStepN              | 123.637 ms                | 220.036 ms                |
| OneStep                   | 194.971 ms                | 837.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:04.336011   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=212, pq.top=212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.236 ms                  | 12.576 ms                 |
| ProcessBack:UpdateCache   | 9.451 ms                  | 16.935 ms                 |
| ProcessBack:UpsertPq      | 15.645 ms                 | 34.249 ms                 |
| ProcessOneStep            | 34.317 ms                 | 815.978 ms                |
| BlockToStepN              | 123.852 ms                | 219.941 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:05.087877  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:08:05.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240129 14:08:06.092671  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:08:06.336005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240129 14:08:07.108036  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:08:07.336004   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240129 14:08:08.125965  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:08:08.374060   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240129 14:08:09.135143  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.434 ms                  | 29.617 ms                 |
| Forward                   | 5.458 ms                  | 21.557 ms                 |
| Backward                  | 9.740 ms                  | 19.161 ms                 |
| Optimize                  | 2.641 ms                  | 5.065 ms                  |
| BarrierTimeBeforeRank0    | 1.140 ms                  | 28.477 ms                 |
| AfterBackward             | 34.381 ms                 | 816.137 ms                |
| BlockToStepN              | 130.307 ms                | 222.557 ms                |
| OneStep                   | 198.881 ms                | 837.422 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:09.384323   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.252 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.502 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.646 ms                 | 28.955 ms                 |
| ProcessOneStep            | 34.354 ms                 | 815.978 ms                |
| BlockToStepN              | 130.963 ms                | 222.497 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:10.142316  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:08:10.384006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240129 14:08:11.158061  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:08:11.390340   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240129 14:08:12.164885  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:08:12.433851   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240129 14:08:13.176864  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:08:13.433005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240129 14:08:14.184481  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.445 ms                  | 29.617 ms                 |
| Forward                   | 5.440 ms                  | 20.197 ms                 |
| Backward                  | 9.709 ms                  | 18.623 ms                 |
| Optimize                  | 2.627 ms                  | 5.038 ms                  |
| BarrierTimeBeforeRank0    | 1.727 ms                  | 27.852 ms                 |
| AfterBackward             | 34.410 ms                 | 120.941 ms                |
| BlockToStepN              | 135.972 ms                | 226.961 ms                |
| OneStep                   | 202.663 ms                | 316.697 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:14.433009   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.248 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.582 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.705 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.394 ms                 | 120.848 ms                |
| BlockToStepN              | 136.325 ms                | 228.617 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:15.271384  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:08:15.433007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240129 14:08:16.284509  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:08:16.433005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240129 14:08:17.284125  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:17.508932   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240129 14:08:18.300928  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:18.552973   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.459 ms                  | 29.617 ms                 |
| Forward                   | 5.454 ms                  | 20.197 ms                 |
| Backward                  | 9.712 ms                  | 18.623 ms                 |
| Optimize                  | 2.637 ms                  | 5.065 ms                  |
| BarrierTimeBeforeRank0    | 1.727 ms                  | 27.852 ms                 |
| AfterBackward             | 34.475 ms                 | 120.941 ms                |
| BlockToStepN              | 139.434 ms                | 246.473 ms                |
| OneStep                   | 205.418 ms                | 328.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:19.307267  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:08:19.552019   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.257 ms                  | 12.576 ms                 |
| ProcessBack:UpdateCache   | 9.606 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.736 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.519 ms                 | 120.848 ms                |
| BlockToStepN              | 139.454 ms                | 246.418 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:20.350915  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:20.552006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240129 14:08:21.355579  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:08:21.552008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240129 14:08:22.410953  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:22.552006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240129 14:08:23.424351  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:23.552006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.459 ms                  | 29.701 ms                 |
| Forward                   | 5.454 ms                  | 20.197 ms                 |
| Backward                  | 9.733 ms                  | 18.623 ms                 |
| Optimize                  | 2.616 ms                  | 5.065 ms                  |
| BarrierTimeBeforeRank0    | 1.827 ms                  | 27.852 ms                 |
| AfterBackward             | 34.596 ms                 | 120.941 ms                |
| BlockToStepN              | 142.622 ms                | 247.812 ms                |
| OneStep                   | 210.972 ms                | 334.371 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:24.552006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240129 14:08:24.557497  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.259 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.626 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.770 ms                 | 34.249 ms                 |
| ProcessOneStep            | 34.563 ms                 | 120.848 ms                |
| BlockToStepN              | 144.092 ms                | 252.348 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:25.552019   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240129 14:08:25.661221  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:26.561372   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=298, pq.top=298
W20240129 14:08:26.727821  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
[proc 4] 300 steps, total: 25.783, sample: 0.455, forward: 0.523, backward: 0.589, update: 0.251
[proc 3] 300 steps, total: 25.783, sample: 0.442, forward: 0.464, backward: 0.940, update: 0.244
[proc 2] 300 steps, total: 25.782, sample: 0.429, forward: 0.530, backward: 1.041, update: 0.265
[proc 7] 300 steps, total: 25.783, sample: 0.444, forward: 0.516, backward: 0.978, update: 0.260
[proc 0] 300 steps, total: 25.782, sample: 0.537, forward: 0.600, backward: 0.924, update: 0.270
[proc 6] 300 steps, total: 25.783, sample: 0.403, forward: 0.505, backward: 0.904, update: 0.263
[proc 1] 300 steps, total: 25.782, sample: 0.390, forward: 0.516, backward: 0.849, update: 0.271
[proc 5] 300 steps, total: 25.783, sample: 0.464, forward: 0.536, backward: 0.953, update: 0.266
W20240129 14:08:27.561005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240129 14:08:27.783360  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:28.561007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240129 14:08:28.904155  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.460 ms                  | 29.946 ms                 |
| Forward                   | 5.458 ms                  | 20.197 ms                 |
| Backward                  | 9.747 ms                  | 19.161 ms                 |
| Optimize                  | 2.604 ms                  | 5.120 ms                  |
| BarrierTimeBeforeRank0    | 1.806 ms                  | 27.852 ms                 |
| AfterBackward             | 34.605 ms                 | 120.941 ms                |
| BlockToStepN              | 146.854 ms                | 253.235 ms                |
| OneStep                   | 215.464 ms                | 339.735 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:29.561005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240129 14:08:29.910492  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.267 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.615 ms                  | 13.866 ms                 |
| ProcessBack:UpsertPq      | 15.828 ms                 | 34.249 ms                 |
| ProcessOneStep            | 34.571 ms                 | 120.848 ms                |
| BlockToStepN              | 147.025 ms                | 253.161 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:30.561009   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240129 14:08:31.011608  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:31.561015   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240129 14:08:32.102804  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:08:32.561005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240129 14:08:33.199702  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:33.561005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=324, pq.top=324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.460 ms                  | 29.946 ms                 |
| Forward                   | 5.457 ms                  | 20.197 ms                 |
| Backward                  | 9.771 ms                  | 19.161 ms                 |
| Optimize                  | 2.598 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 1.608 ms                  | 27.852 ms                 |
| AfterBackward             | 34.674 ms                 | 120.941 ms                |
| BlockToStepN              | 149.942 ms                | 260.722 ms                |
| OneStep                   | 220.724 ms                | 348.160 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:34.285964  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:34.577059   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=328, pq.top=328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.265 ms                  | 11.641 ms                 |
| ProcessBack:UpdateCache   | 9.620 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.879 ms                 | 31.419 ms                 |
| ProcessOneStep            | 34.646 ms                 | 120.848 ms                |
| BlockToStepN              | 149.892 ms                | 260.536 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:35.335392  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:08:35.577006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240129 14:08:36.524034  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:36.605541   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240129 14:08:37.594349  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:08:37.649147   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240129 14:08:38.597440  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 14:08:38.672781   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.460 ms                  | 30.116 ms                 |
| Forward                   | 5.457 ms                  | 21.557 ms                 |
| Backward                  | 9.787 ms                  | 19.161 ms                 |
| Optimize                  | 2.598 ms                  | 5.162 ms                  |
| BarrierTimeBeforeRank0    | 1.564 ms                  | 27.852 ms                 |
| AfterBackward             | 34.674 ms                 | 120.941 ms                |
| BlockToStepN              | 152.904 ms                | 261.344 ms                |
| OneStep                   | 223.625 ms                | 348.160 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:39.672006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=346, pq.top=346
W20240129 14:08:39.681733  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.260 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.626 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.888 ms                 | 31.419 ms                 |
| ProcessOneStep            | 34.665 ms                 | 120.848 ms                |
| BlockToStepN              | 152.864 ms                | 261.014 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:40.677567   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240129 14:08:40.684293  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 14:08:41.677006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240129 14:08:41.712036  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:08:42.677006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240129 14:08:42.730326  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:43.677008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=360, pq.top=360
W20240129 14:08:43.747388  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.459 ms                  | 30.027 ms                 |
| Forward                   | 5.475 ms                  | 20.197 ms                 |
| Backward                  | 9.767 ms                  | 18.623 ms                 |
| Optimize                  | 2.598 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 2.055 ms                  | 27.436 ms                 |
| AfterBackward             | 34.743 ms                 | 63.370 ms                 |
| BlockToStepN              | 157.092 ms                | 266.016 ms                |
| OneStep                   | 226.780 ms                | 348.160 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:44.740641   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=364, pq.top=364
W20240129 14:08:44.750288  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.235 ms                  | 12.152 ms                 |
| ProcessBack:UpdateCache   | 9.671 ms                  | 13.866 ms                 |
| ProcessBack:UpsertPq      | 15.903 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.690 ms                 | 63.337 ms                 |
| BlockToStepN              | 157.118 ms                | 265.807 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:45.766119  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:08:45.792529   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=368, pq.top=368
W20240129 14:08:46.792006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240129 14:08:46.822449  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:08:47.792006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240129 14:08:47.839951  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:08:48.792006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240129 14:08:48.891554  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.447 ms                  | 30.027 ms                 |
| Forward                   | 5.474 ms                  | 20.197 ms                 |
| Backward                  | 9.767 ms                  | 18.623 ms                 |
| Optimize                  | 2.598 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 2.247 ms                  | 27.436 ms                 |
| AfterBackward             | 34.743 ms                 | 63.370 ms                 |
| BlockToStepN              | 158.996 ms                | 274.824 ms                |
| OneStep                   | 230.425 ms                | 348.160 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:49.845135   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240129 14:08:49.907213  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.236 ms                  | 11.945 ms                 |
| ProcessBack:UpdateCache   | 9.653 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.911 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.711 ms                 | 63.337 ms                 |
| BlockToStepN              | 160.117 ms                | 276.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:50.845017   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=386, pq.top=386
W20240129 14:08:50.923240  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:08:51.845006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240129 14:08:51.924700  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:08:52.845006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240129 14:08:52.929150  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:08:53.845005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240129 14:08:53.935740  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.451 ms                  | 30.027 ms                 |
| Forward                   | 5.475 ms                  | 20.197 ms                 |
| Backward                  | 9.753 ms                  | 18.623 ms                 |
| Optimize                  | 2.590 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 2.487 ms                  | 27.436 ms                 |
| AfterBackward             | 34.744 ms                 | 63.370 ms                 |
| BlockToStepN              | 162.413 ms                | 281.779 ms                |
| OneStep                   | 232.670 ms                | 350.587 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:54.845005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 4] 400 steps, total: 27.653, sample: 0.397, forward: 0.522, backward: 0.562, update: 0.246
[proc 5] 400 steps, total: 27.652, sample: 0.419, forward: 0.498, backward: 0.826, update: 0.248
[proc 3] 400 steps, total: 27.653, sample: 0.420, forward: 0.457, backward: 0.901, update: 0.238
[proc 6] 400 steps, total: 27.653, sample: 0.416, forward: 0.484, backward: 0.856, update: 0.246
[proc 7] 400 steps, total: 27.653, sample: 0.420, forward: 0.503, backward: 0.922, update: 0.248
[proc 1] 400 steps, total: 27.652, sample: 0.415, forward: 0.514, backward: 0.434, update: 0.254
[proc 0] 400 steps, total: 27.653, sample: 0.508, forward: 0.572, backward: 0.909, update: 0.293
[proc 2] 400 steps, total: 27.653, sample: 0.435, forward: 0.514, backward: 1.044, update: 0.250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.235 ms                  | 11.945 ms                 |
| ProcessBack:UpdateCache   | 9.694 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.916 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.740 ms                 | 63.337 ms                 |
| BlockToStepN              | 162.703 ms                | 282.131 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:54.952215  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:08:55.845010   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240129 14:08:55.952212  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:08:56.845012   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240129 14:08:56.971182  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:08:57.845009   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240129 14:08:57.990139  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:08:58.845006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240129 14:08:58.998245  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.453 ms                  | 30.027 ms                 |
| Forward                   | 5.473 ms                  | 20.197 ms                 |
| Backward                  | 9.737 ms                  | 18.623 ms                 |
| Optimize                  | 2.585 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 3.473 ms                  | 27.768 ms                 |
| AfterBackward             | 34.803 ms                 | 63.370 ms                 |
| BlockToStepN              | 165.143 ms                | 282.184 ms                |
| OneStep                   | 234.373 ms                | 360.937 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:08:59.845005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.211 ms                  | 11.945 ms                 |
| ProcessBack:UpdateCache   | 9.722 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.911 ms                 | 37.600 ms                 |
| ProcessOneStep            | 34.761 ms                 | 63.337 ms                 |
| BlockToStepN              | 165.337 ms                | 283.380 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:00.005875  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:09:00.880427   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240129 14:09:01.107125  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:09:01.880008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240129 14:09:02.126618  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:09:02.880012   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=428, pq.top=428
W20240129 14:09:03.127377  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:09:03.880009   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=432, pq.top=432
W20240129 14:09:04.146344  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.454 ms                  | 30.116 ms                 |
| Forward                   | 5.473 ms                  | 20.197 ms                 |
| Backward                  | 9.719 ms                  | 18.623 ms                 |
| Optimize                  | 2.581 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 3.862 ms                  | 28.477 ms                 |
| AfterBackward             | 34.781 ms                 | 63.370 ms                 |
| BlockToStepN              | 167.150 ms                | 283.458 ms                |
| OneStep                   | 236.717 ms                | 383.795 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:04.880007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.188 ms                  | 11.641 ms                 |
| ProcessBack:UpdateCache   | 9.758 ms                  | 12.378 ms                 |
| ProcessBack:UpsertPq      | 15.893 ms                 | 37.685 ms                 |
| ProcessOneStep            | 34.751 ms                 | 63.337 ms                 |
| BlockToStepN              | 167.388 ms                | 286.070 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:05.304415  1689 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 14:09:05.880005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240129 14:09:06.395864  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:09:06.880007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=442, pq.top=442
W20240129 14:09:07.395323  1689 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 14:09:07.880008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240129 14:09:08.465266  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:09:08.880007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.454 ms                  | 30.116 ms                 |
| Forward                   | 5.478 ms                  | 20.197 ms                 |
| Backward                  | 9.701 ms                  | 18.623 ms                 |
| Optimize                  | 2.576 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 3.981 ms                  | 28.477 ms                 |
| AfterBackward             | 34.781 ms                 | 63.370 ms                 |
| BlockToStepN              | 169.188 ms                | 297.876 ms                |
| OneStep                   | 240.792 ms                | 384.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:09.479821  1689 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 14:09:09.880005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=452, pq.top=452
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.170 ms                  | 11.641 ms                 |
| ProcessBack:UpdateCache   | 9.794 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.901 ms                 | 37.685 ms                 |
| ProcessOneStep            | 34.751 ms                 | 58.065 ms                 |
| BlockToStepN              | 169.121 ms                | 286.070 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:10.638965  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:09:10.880005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240129 14:09:11.641889  1689 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 14:09:11.917387   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240129 14:09:12.785638  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:09:12.917007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240129 14:09:13.802003  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:09:13.917006   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.460 ms                  | 30.027 ms                 |
| Forward                   | 5.475 ms                  | 17.598 ms                 |
| Backward                  | 9.695 ms                  | 17.540 ms                 |
| Optimize                  | 2.574 ms                  | 5.120 ms                  |
| BarrierTimeBeforeRank0    | 4.004 ms                  | 28.477 ms                 |
| AfterBackward             | 34.772 ms                 | 58.101 ms                 |
| BlockToStepN              | 170.641 ms                | 297.876 ms                |
| OneStep                   | 242.730 ms                | 384.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:14.909780  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.168 ms                  | 11.641 ms                 |
| ProcessBack:UpdateCache   | 9.788 ms                  | 12.494 ms                 |
| ProcessBack:UpsertPq      | 15.901 ms                 | 37.923 ms                 |
| ProcessOneStep            | 34.751 ms                 | 58.065 ms                 |
| BlockToStepN              | 170.679 ms                | 297.809 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:14.987169   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240129 14:09:15.909776  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:09:15.987004   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=472, pq.top=472
W20240129 14:09:16.920857  1689 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 14:09:16.987008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=475, pq.top=475
W20240129 14:09:17.987007   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=478, pq.top=478
W20240129 14:09:18.013299  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:09:18.987008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=482, pq.top=482
W20240129 14:09:19.103667  1689 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.468 ms                  | 30.027 ms                 |
| Forward                   | 5.489 ms                  | 20.197 ms                 |
| Backward                  | 9.698 ms                  | 17.540 ms                 |
| Optimize                  | 2.569 ms                  | 5.120 ms                  |
| BarrierTimeBeforeRank0    | 3.976 ms                  | 28.477 ms                 |
| AfterBackward             | 34.819 ms                 | 58.101 ms                 |
| BlockToStepN              | 172.177 ms                | 297.876 ms                |
| OneStep                   | 244.373 ms                | 384.868 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.180 ms                  | 11.631 ms                 |
| ProcessBack:UpdateCache   | 9.798 ms                  | 12.798 ms                 |
| ProcessBack:UpsertPq      | 15.922 ms                 | 37.685 ms                 |
| ProcessOneStep            | 34.779 ms                 | 58.065 ms                 |
| BlockToStepN              | 172.248 ms                | 297.809 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:19.987005   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240129 14:09:20.103649  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:09:20.987017   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240129 14:09:21.111795  1689 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 14:09:22.033852   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240129 14:09:22.121395  1689 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 14:09:23.077641   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=495, pq.top=495
W20240129 14:09:23.397907  1689 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 14:09:24.077008   504 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=498, pq.top=498
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.469 ms                  | 30.027 ms                 |
| Forward                   | 5.487 ms                  | 20.197 ms                 |
| Backward                  | 9.665 ms                  | 17.540 ms                 |
| Optimize                  | 2.569 ms                  | 5.154 ms                  |
| BarrierTimeBeforeRank0    | 3.981 ms                  | 30.485 ms                 |
| AfterBackward             | 34.891 ms                 | 58.101 ms                 |
| BlockToStepN              | 175.320 ms                | 312.830 ms                |
| OneStep                   | 246.271 ms                | 399.615 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 14:09:24.581511  1689 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
[proc 6] 500 steps, total: 29.972, sample: 0.402, forward: 0.506, backward: 0.421, update: 0.248
[proc 7] 500 steps, total: 29.972, sample: 0.399, forward: 0.534, backward: 0.948, update: 0.267
[proc 4] 500 steps, total: 29.972, sample: 0.454, forward: 0.528, backward: 0.865, update: 0.261
[proc 5] 500 steps, total: 29.972, sample: 0.365, forward: 0.518, backward: 0.939, update: 0.268
[proc 2] 500 steps, total: 29.971, sample: 0.408, forward: 0.524, backward: 0.965, update: 0.260
[proc 3] 500 steps, total: 29.972, sample: 0.400, forward: 0.474, backward: 0.885, update: 0.248
[proc 1] 500 steps, total: 29.971, sample: 0.424, forward: 0.521, backward: 0.551, update: 0.272
[proc 0] 500 steps, total: 29.971, sample: 0.470, forward: 0.565, backward: 0.595, update: 0.255
Successfully xmh. training takes 124.14672780036926 seconds
before call kg_cache_controller.StopThreads()
W20240129 14:09:24.883252   504 grad_async_v1.h:230] call StopThreads. PID = 64364
W20240129 14:09:24.883278   504 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 14:09:24.897698   504 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 14:09:24.897734   504 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 14:09:24.924258   504 grad_async_v1.h:251] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.178 ms                  | 11.631 ms                 |
| ProcessBack:UpdateCache   | 9.805 ms                  | 12.798 ms                 |
| ProcessBack:UpsertPq      | 15.925 ms                 | 37.861 ms                 |
| ProcessOneStep            | 34.853 ms                 | 58.065 ms                 |
| BlockToStepN              | 175.248 ms                | 312.770 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f2ed5919410>
