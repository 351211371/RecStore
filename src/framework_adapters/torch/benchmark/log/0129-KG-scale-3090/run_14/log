WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 13:09:10.960551 38359 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_18', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38359 sampler.py:454] Start PreSampling
WARNING [38359 sampler.py:532] Before construct renumbering_dict
WARNING [38359 sampler.py:555] PreSampling done
W20240129 13:09:16.276659 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 13:09:16.276911 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 13:09:16.276983 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 13:09:16.277037 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 13:09:16.277101 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 13:09:16.277145 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 13:09:16.277189 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 13:09:16.277257 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 13:09:16.277316 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 13:09:16.277357 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 13:09:16.277411 38359 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 13:09:16.277449 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 13:09:16.277498 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 13:09:16.277647 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 13:09:16.277702 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 13:09:16.277751 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 13:09:16.277804 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 13:09:16.277853 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 13:09:16.277892 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 13:09:16.277931 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 13:09:16.277984 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 13:09:16.278043 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 13:09:16.278084 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 13:09:16.278131 38359 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 13:09:16.278168 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 13:09:16.278205 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 13:09:16.278291 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 13:09:16.278342 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 13:09:16.278383 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 13:09:16.278436 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 13:09:16.278478 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 13:09:16.278525 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 13:09:16.278589 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 13:09:16.278628 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 13:09:16.278687 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 13:09:16.278736 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 13:09:16.278775 38359 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 13:09:16.278808 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 13:09:16.278844 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 13:09:16.278940 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 13:09:16.278987 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 13:09:16.279032 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 13:09:16.279080 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 13:09:16.279124 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 13:09:16.279166 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 13:09:16.279206 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 13:09:16.279255 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 13:09:16.279297 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 13:09:16.279348 38359 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 13:09:16.279389 38359 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 13:09:16.279423 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 13:09:16.279459 38359 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 13:09:16.533977 38359 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240129 13:09:16.534149 38359 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([1656, 1757, 1792,  ..., 7520, 4495, 7705]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.675 seconds
[Rank1] pid = 38783
[Rank2] pid = 38848
INFO [38359 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [38783 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38849 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [38848 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38849 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [38848 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [38783 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [38359 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 13:09:18.423276 38976 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240129 13:09:18.423444 38868 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240129 13:09:18.424219 38784 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240129 13:09:18.424661 38850 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240129 13:09:18.456463 38850 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10001487a000 7.629 MB
W20240129 13:09:18.456597 38976 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001501d000 7.629 MB
W20240129 13:09:18.456602 38784 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000157c0000 7.629 MB
W20240129 13:09:18.456776 38850 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100015f65000 7.629 MB
W20240129 13:09:18.456785 38784 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100016708000 7.629 MB
W20240129 13:09:18.456799 38976 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100016eab000 7.629 MB
W20240129 13:09:18.456854 38850 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10001764e000 1.49 GB
W20240129 13:09:18.456862 38784 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x100076c31000 1.49 GB
W20240129 13:09:18.456873 38976 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000d69b7000 1.49 GB
W20240129 13:09:18.456869 38868 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000d6214000 7.629 MB
W20240129 13:09:18.456938 38850 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100135f9a000 1.49 GB
W20240129 13:09:18.456984 38784 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10019557d000 1.49 GB
W20240129 13:09:18.457000 38976 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1001f4b60000 1.49 GB
W20240129 13:09:18.457010 38868 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100254143000 7.629 MB
W20240129 13:09:18.457031 38850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 13:09:18.457087 38868 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1002548e6000 1.49 GB
W20240129 13:09:18.457154 38868 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002b3ec9000 1.49 GB
W20240129 13:09:18.458770 38868 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 13:09:18.458786 38976 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 13:09:18.458801 38784 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 13:09:18.458945 38850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 13:09:18.465539 38868 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 13:09:18.465545 38784 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 13:09:18.465549 38976 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [38849 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [38783 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [38848 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 38849
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [38359 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 13:09:20.009080 38868 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 13:09:20.009291 38850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 13:09:20.009433 38976 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 13:09:20.009578 38784 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240129 13:09:20.012799 38868 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 13:09:20.013145 38868 grad_base.h:184] Init GradProcessingBase done
I20240129 13:09:20.019403 38868 grad_async_v1.h:199] Use main thread to update emb.
W20240129 13:09:20.019479 38868 kg_controller.h:75] after init GradAsyncProcessing
I20240129 13:09:20.019501 38868 kg_controller.h:84] Construct KGCacheController done
E20240129 13:09:20.492630 38976 recstore.cc:66] init folly done
E20240129 13:09:20.494117 38850 recstore.cc:66] init folly done
E20240129 13:09:20.494254 38868 recstore.cc:66] init folly done
E20240129 13:09:20.494266 38784 recstore.cc:66] init folly done
I20240129 13:09:20.495352 38868 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 13:09:20.846851 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
I20240129 13:09:20.882707 38868 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240129 13:09:20.892578 38784 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 13:09:20.893700 38850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 13:09:20.900099 38976 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 13:09:22.320770 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240129 13:09:22.409747 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:09:23.320017 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240129 13:09:23.415236 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:24.335984 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240129 13:09:24.450184 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.374 ms                  | 17.479 ms                 |
| Forward                   | 4.484 ms                  | 572.656 ms                |
| Backward                  | 9.178 ms                  | 218.358 ms                |
| Optimize                  | 1.735 ms                  | 5.572 ms                  |
| BarrierTimeBeforeRank0    | 37.577 us                 | 1.436 ms                  |
| AfterBackward             | 10.650 ms                 | 623.679 ms                |
| BlockToStepN              | 34.042 ms                 | 113.176 ms                |
| OneStep                   | 71.342 ms                 | 1.508 s                   |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:25.335017 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.347 ms                  | 192.005 ms                |
| ProcessBack:UpdateCache   | 2.617 ms                  | 295.408 ms                |
| ProcessBack:UpsertPq      | 4.721 ms                  | 10.045 ms                 |
| ProcessOneStep            | 10.943 ms                 | 623.005 ms                |
| BlockToStepN              | 60.767 ms                 | 113.124 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:25.500454 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:09:26.335034 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=42, pq.top=42
W20240129 13:09:26.505359 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:09:27.335018 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240129 13:09:27.535434 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:28.335017 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240129 13:09:28.582319 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:09:29.335016 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240129 13:09:29.660380 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.522 ms                  | 18.674 ms                 |
| Forward                   | 4.576 ms                  | 7.430 ms                  |
| Backward                  | 9.035 ms                  | 13.353 ms                 |
| Optimize                  | 1.670 ms                  | 4.184 ms                  |
| BarrierTimeBeforeRank0    | 47.029 us                 | 4.286 ms                  |
| AfterBackward             | 11.205 ms                 | 31.494 ms                 |
| BlockToStepN              | 102.406 ms                | 156.567 ms                |
| OneStep                   | 134.545 ms                | 211.224 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:30.335018 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=66, pq.top=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.383 ms                  | 192.005 ms                |
| ProcessBack:UpdateCache   | 2.579 ms                  | 295.408 ms                |
| ProcessBack:UpsertPq      | 5.260 ms                  | 10.045 ms                 |
| ProcessOneStep            | 11.210 ms                 | 31.462 ms                 |
| BlockToStepN              | 103.890 ms                | 156.416 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:30.693078 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:09:31.335024 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240129 13:09:31.796711 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:09:32.335007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240129 13:09:32.896771 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:33.335019 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240129 13:09:33.907239 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:34.354313 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240129 13:09:34.912251 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.479 ms                  | 18.835 ms                 |
| Forward                   | 4.573 ms                  | 7.430 ms                  |
| Backward                  | 8.984 ms                  | 13.353 ms                 |
| Optimize                  | 1.640 ms                  | 4.184 ms                  |
| BarrierTimeBeforeRank0    | 57.348 us                 | 8.539 ms                  |
| AfterBackward             | 11.478 ms                 | 31.494 ms                 |
| BlockToStepN              | 120.745 ms                | 179.702 ms                |
| OneStep                   | 149.606 ms                | 219.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:35.354014 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.339 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.549 ms                  | 8.181 ms                  |
| ProcessBack:UpsertPq      | 5.470 ms                  | 10.045 ms                 |
| ProcessOneStep            | 11.465 ms                 | 31.462 ms                 |
| BlockToStepN              | 120.852 ms                | 179.655 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:35.912259 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:36.354005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=98, pq.top=98
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 16.043, sample: 0.303, forward: 0.968, backward: 1.036, update: 0.170
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 16.037, sample: 0.316, forward: 0.967, backward: 0.864, update: 0.168
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.044, sample: 0.284, forward: 0.961, backward: 1.061, update: 0.164
train_sampler.Prefill()
-------Step 0-------
tensor([ 6032,  7484, 13609,  5290,    32,  5664,  9258,   221,   272, 10763]) tensor([ 1792, 11039,  3347, 13411,  3425,   274,  4104,  6440,  4632, 14011])
-------Step 1-------
tensor([ 6032,  7484, 13609,  5290,    32,  5664,  9258,   221,   272, 10763]) tensor([ 3852,  7996,   145,  8549,   531, 10753, 10250,  3219,  6323,  9467])
-------Step 2-------
tensor([13876,  9821,  8153,  5021,   239,  3572,   178,  8079,  4740,   171]) tensor([11123,  2584,  6768,  7558,  9080,    70, 13410,   861,  9585, 11409])
-------Step 3-------
tensor([13876,  9821,  8153,  5021,   239,  3572,   178,  8079,  4740,   171]) tensor([ 8587,  2281, 13898,  4086,  7190,  4147, 12709,  4140,  7080, 11593])
-------Step 4-------
tensor([12256,  8277,  6915,  2739,  6729, 11895,  8266, 14761,    80,  9893]) tensor([ 1421,  5948, 11570,  9482,   374,   346,  3506,   370, 10554,  8226])
-------Step 5-------
tensor([12256,  8277,  6915,  2739,  6729, 11895,  8266, 14761,    80,  9893]) tensor([ 6949,  6618,  4145, 14541, 12489, 11708,  5968, 10948,    41, 13910])
-------Step 6-------
tensor([ 2547,   158,  3524, 14735,  4940,   240, 11852,  5118,   365,  3324]) tensor([ 6018, 14182, 12804,  4253, 11102, 12761,  2739,  7264, 14657,  8685])
-------Step 7-------
tensor([ 2547,   158,  3524, 14735,  4940,   240, 11852,  5118,   365,  3324]) tensor([10141,  5591,   838,  6996,  2522,  1609,  3313,  4203,  5066,  3426])
-------Step 8-------
tensor([   23,  8655,   273,  7648,  5418, 11349, 12122,  5967,  4696,  4219]) tensor([ 8898,  3618,  2163,  7932,  1196, 14233,  2345,  7499,  9354, 13754])
-------Step 9-------
tensor([   23,  8655,   273,  7648,  5418, 11349, 12122,  5967,  4696,  4219]) tensor([ 5703,  7333,  9057,  3921, 11772,  2786, 14755,  3219,  5075,    75])
before start barrier
start train
[proc 0] 100 steps, total: 16.054, sample: 0.344, forward: 1.019, backward: 1.021, update: 0.179
W20240129 13:09:36.937646 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:37.354017 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=102, pq.top=102
W20240129 13:09:37.995910 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:38.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240129 13:09:39.048218 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:39.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=112, pq.top=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.447 ms                  | 19.080 ms                 |
| Forward                   | 4.573 ms                  | 7.430 ms                  |
| Backward                  | 8.953 ms                  | 13.353 ms                 |
| Optimize                  | 1.640 ms                  | 4.184 ms                  |
| BarrierTimeBeforeRank0    | 42.314 us                 | 8.539 ms                  |
| AfterBackward             | 11.632 ms                 | 31.494 ms                 |
| BlockToStepN              | 136.743 ms                | 194.599 ms                |
| OneStep                   | 168.267 ms                | 234.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:40.105397 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:40.354015 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.369 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.565 ms                  | 8.181 ms                  |
| ProcessBack:UpsertPq      | 5.771 ms                  | 11.139 ms                 |
| ProcessOneStep            | 11.619 ms                 | 31.462 ms                 |
| BlockToStepN              | 138.487 ms                | 194.556 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:41.167577 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:41.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240129 13:09:42.269483 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:42.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240129 13:09:43.354023 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240129 13:09:43.365175 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:44.354008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240129 13:09:44.467643 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.437 ms                  | 19.080 ms                 |
| Forward                   | 4.639 ms                  | 7.430 ms                  |
| Backward                  | 8.935 ms                  | 13.353 ms                 |
| Optimize                  | 1.624 ms                  | 4.184 ms                  |
| BarrierTimeBeforeRank0    | 39.753 us                 | 8.539 ms                  |
| AfterBackward             | 11.851 ms                 | 31.494 ms                 |
| BlockToStepN              | 148.423 ms                | 205.354 ms                |
| OneStep                   | 181.368 ms                | 237.165 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:45.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.361 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.538 ms                  | 7.482 ms                  |
| ProcessBack:UpsertPq      | 6.054 ms                  | 11.033 ms                 |
| ProcessOneStep            | 11.876 ms                 | 31.462 ms                 |
| BlockToStepN              | 149.534 ms                | 205.316 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:45.586485 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:46.354020 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240129 13:09:46.648631 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:47.354008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240129 13:09:47.771225 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:48.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240129 13:09:48.852021 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:49.354015 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240129 13:09:50.015327 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.437 ms                  | 18.835 ms                 |
| Forward                   | 4.641 ms                  | 6.012 ms                  |
| Backward                  | 8.939 ms                  | 13.353 ms                 |
| Optimize                  | 1.624 ms                  | 3.861 ms                  |
| BarrierTimeBeforeRank0    | 34.240 us                 | 5.417 ms                  |
| AfterBackward             | 12.077 ms                 | 18.233 ms                 |
| BlockToStepN              | 157.038 ms                | 213.126 ms                |
| OneStep                   | 190.891 ms                | 245.683 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:50.354007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.388 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.538 ms                  | 7.482 ms                  |
| ProcessBack:UpsertPq      | 6.116 ms                  | 11.033 ms                 |
| ProcessOneStep            | 12.078 ms                 | 18.197 ms                 |
| BlockToStepN              | 157.411 ms                | 214.185 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:51.104774 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:51.380151 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240129 13:09:52.240752 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:52.380007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240129 13:09:53.380007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240129 13:09:53.389925 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:54.380019 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240129 13:09:54.547756 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.458 ms                  | 19.080 ms                 |
| Forward                   | 4.653 ms                  | 6.012 ms                  |
| Backward                  | 8.944 ms                  | 13.353 ms                 |
| Optimize                  | 1.622 ms                  | 3.861 ms                  |
| BarrierTimeBeforeRank0    | 32.824 us                 | 5.507 ms                  |
| AfterBackward             | 12.402 ms                 | 18.233 ms                 |
| BlockToStepN              | 166.146 ms                | 216.653 ms                |
| OneStep                   | 198.638 ms                | 252.269 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:55.380005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.394 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.538 ms                  | 5.339 ms                  |
| ProcessBack:UpsertPq      | 6.148 ms                  | 10.611 ms                 |
| ProcessOneStep            | 12.438 ms                 | 18.197 ms                 |
| BlockToStepN              | 166.248 ms                | 218.663 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:09:55.704397 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:09:56.380014 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240129 13:09:56.880993 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:09:57.393536 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240129 13:09:57.881623 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:09:58.393016 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240129 13:09:58.882467 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
[proc 1] 200 steps, total: 22.406, sample: 0.320, forward: 0.417, backward: 0.849, update: 0.154
[proc 0] 200 steps, total: 22.406, sample: 0.396, forward: 0.461, backward: 0.874, update: 0.161
[proc 2] 200 steps, total: 22.406, sample: 0.329, forward: 0.418, backward: 0.880, update: 0.162
[proc 3] 200 steps, total: 22.406, sample: 0.322, forward: 0.414, backward: 0.869, update: 0.162
W20240129 13:09:59.393008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240129 13:09:59.988667 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.467 ms                  | 19.080 ms                 |
| Forward                   | 4.658 ms                  | 6.012 ms                  |
| Backward                  | 8.944 ms                  | 13.353 ms                 |
| Optimize                  | 1.616 ms                  | 3.861 ms                  |
| BarrierTimeBeforeRank0    | 31.501 us                 | 5.507 ms                  |
| AfterBackward             | 12.576 ms                 | 18.233 ms                 |
| BlockToStepN              | 171.875 ms                | 231.416 ms                |
| OneStep                   | 205.878 ms                | 275.367 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:00.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.383 ms                  | 3.493 ms                  |
| ProcessBack:UpdateCache   | 2.525 ms                  | 5.339 ms                  |
| ProcessBack:UpsertPq      | 6.186 ms                  | 11.033 ms                 |
| ProcessOneStep            | 12.542 ms                 | 18.197 ms                 |
| BlockToStepN              | 172.258 ms                | 231.328 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:01.124107 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:01.393009 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240129 13:10:02.272888 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:02.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240129 13:10:03.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240129 13:10:03.529620 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:04.393021 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240129 13:10:04.670404 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.481 ms                  | 19.080 ms                 |
| Forward                   | 4.658 ms                  | 6.012 ms                  |
| Backward                  | 8.876 ms                  | 13.353 ms                 |
| Optimize                  | 1.610 ms                  | 3.861 ms                  |
| BarrierTimeBeforeRank0    | 35.331 us                 | 6.685 ms                  |
| AfterBackward             | 12.561 ms                 | 18.233 ms                 |
| BlockToStepN              | 175.736 ms                | 241.817 ms                |
| OneStep                   | 207.309 ms                | 279.740 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:05.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.347 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.440 ms                  | 4.592 ms                  |
| ProcessBack:UpsertPq      | 6.190 ms                  | 11.033 ms                 |
| ProcessOneStep            | 12.525 ms                 | 18.197 ms                 |
| BlockToStepN              | 175.689 ms                | 241.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:05.782253 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:06.393018 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240129 13:10:06.783533 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:10:07.393041 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240129 13:10:07.930830 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:10:08.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240129 13:10:08.930323 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:10:09.393016 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240129 13:10:09.941489 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.516 ms                  | 19.080 ms                 |
| Forward                   | 4.653 ms                  | 6.012 ms                  |
| Backward                  | 8.829 ms                  | 13.353 ms                 |
| Optimize                  | 1.605 ms                  | 3.861 ms                  |
| BarrierTimeBeforeRank0    | 41.091 us                 | 6.685 ms                  |
| AfterBackward             | 12.505 ms                 | 18.233 ms                 |
| BlockToStepN              | 178.141 ms                | 248.488 ms                |
| OneStep                   | 210.988 ms                | 289.500 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:10.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.326 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.423 ms                  | 4.592 ms                  |
| ProcessBack:UpsertPq      | 6.221 ms                  | 11.033 ms                 |
| ProcessOneStep            | 12.480 ms                 | 18.197 ms                 |
| BlockToStepN              | 178.532 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:10.953378 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:11.393007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240129 13:10:11.957233 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:12.393011 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240129 13:10:13.122499 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:13.430912 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240129 13:10:14.327540 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:14.430006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=264, pq.top=264
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.562 ms                  | 20.675 ms                 |
| Forward                   | 4.635 ms                  | 5.829 ms                  |
| Backward                  | 8.828 ms                  | 12.060 ms                 |
| Optimize                  | 1.604 ms                  | 3.113 ms                  |
| BarrierTimeBeforeRank0    | 52.355 us                 | 8.539 ms                  |
| AfterBackward             | 12.510 ms                 | 18.012 ms                 |
| BlockToStepN              | 180.666 ms                | 241.817 ms                |
| OneStep                   | 213.045 ms                | 279.740 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:15.430022 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240129 13:10:15.463248 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.318 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.415 ms                  | 4.592 ms                  |
| ProcessBack:UpsertPq      | 6.265 ms                  | 11.062 ms                 |
| ProcessOneStep            | 12.487 ms                 | 17.896 ms                 |
| BlockToStepN              | 180.619 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:16.448689 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240129 13:10:16.629273 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:17.448006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240129 13:10:17.804730 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:10:18.448016 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240129 13:10:18.969216 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:19.480206 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=288, pq.top=288
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.566 ms                  | 20.675 ms                 |
| Forward                   | 4.628 ms                  | 6.012 ms                  |
| Backward                  | 8.813 ms                  | 12.060 ms                 |
| Optimize                  | 1.600 ms                  | 3.113 ms                  |
| BarrierTimeBeforeRank0    | 55.657 us                 | 14.112 ms                 |
| AfterBackward             | 12.561 ms                 | 18.233 ms                 |
| BlockToStepN              | 181.248 ms                | 248.488 ms                |
| OneStep                   | 215.526 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:20.136626 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:10:20.480005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=292, pq.top=292
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.322 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.409 ms                  | 4.343 ms                  |
| ProcessBack:UpsertPq      | 6.298 ms                  | 11.139 ms                 |
| ProcessOneStep            | 12.542 ms                 | 18.197 ms                 |
| BlockToStepN              | 182.125 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:21.146484 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:10:21.480008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240129 13:10:22.314677 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:22.480007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 1] 300 steps, total: 23.244, sample: 0.287, forward: 0.421, backward: 0.850, update: 0.153
[proc 2] 300 steps, total: 23.244, sample: 0.288, forward: 0.416, backward: 0.882, update: 0.160
[proc 3] 300 steps, total: 23.244, sample: 0.291, forward: 0.417, backward: 0.901, update: 0.158
[proc 0] 300 steps, total: 23.244, sample: 0.400, forward: 0.440, backward: 0.580, update: 0.154
W20240129 13:10:23.323797 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:23.480008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240129 13:10:24.330507 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:10:24.480018 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=308, pq.top=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.619 ms                  | 20.675 ms                 |
| Forward                   | 4.623 ms                  | 6.012 ms                  |
| Backward                  | 8.816 ms                  | 12.060 ms                 |
| Optimize                  | 1.600 ms                  | 3.113 ms                  |
| BarrierTimeBeforeRank0    | 55.349 us                 | 17.721 ms                 |
| AfterBackward             | 12.603 ms                 | 18.233 ms                 |
| BlockToStepN              | 184.066 ms                | 252.889 ms                |
| OneStep                   | 219.057 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:25.332114 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:10:25.480005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=312, pq.top=312
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.325 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.415 ms                  | 4.343 ms                  |
| ProcessBack:UpsertPq      | 6.316 ms                  | 11.245 ms                 |
| ProcessOneStep            | 12.573 ms                 | 18.197 ms                 |
| BlockToStepN              | 184.666 ms                | 252.769 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:26.339046 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:26.480008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240129 13:10:27.343873 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:27.480011 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240129 13:10:28.480006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240129 13:10:28.497475 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:10:29.480017 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240129 13:10:29.533068 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.601 ms                  | 20.675 ms                 |
| Forward                   | 4.618 ms                  | 6.012 ms                  |
| Backward                  | 8.832 ms                  | 13.353 ms                 |
| Optimize                  | 1.604 ms                  | 3.259 ms                  |
| BarrierTimeBeforeRank0    | 52.355 us                 | 17.721 ms                 |
| AfterBackward             | 12.615 ms                 | 18.233 ms                 |
| BlockToStepN              | 186.561 ms                | 252.889 ms                |
| OneStep                   | 219.990 ms                | 286.476 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:30.480005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.328 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.420 ms                  | 3.575 ms                  |
| ProcessBack:UpsertPq      | 6.359 ms                  | 11.497 ms                 |
| ProcessOneStep            | 12.597 ms                 | 18.197 ms                 |
| BlockToStepN              | 186.819 ms                | 252.769 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:30.663231 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:31.480006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240129 13:10:31.674862 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:10:32.480044 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240129 13:10:32.850481 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:10:33.480006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240129 13:10:33.855548 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:10:34.480008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.624 ms                  | 19.955 ms                 |
| Forward                   | 4.596 ms                  | 5.926 ms                  |
| Backward                  | 8.843 ms                  | 12.060 ms                 |
| Optimize                  | 1.605 ms                  | 3.123 ms                  |
| BarrierTimeBeforeRank0    | 47.029 us                 | 17.617 ms                 |
| AfterBackward             | 12.623 ms                 | 19.098 ms                 |
| BlockToStepN              | 188.710 ms                | 252.889 ms                |
| OneStep                   | 221.748 ms                | 286.476 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:35.079032 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:10:35.480011 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=353, pq.top=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.335 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.415 ms                  | 3.575 ms                  |
| ProcessBack:UpsertPq      | 6.398 ms                  | 12.062 ms                 |
| ProcessOneStep            | 12.600 ms                 | 19.905 ms                 |
| BlockToStepN              | 188.568 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:36.080699 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:36.480008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240129 13:10:37.092172 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:37.480019 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240129 13:10:38.261082 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:10:38.498752 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240129 13:10:39.272374 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:39.498010 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.630 ms                  | 19.955 ms                 |
| Forward                   | 4.596 ms                  | 5.926 ms                  |
| Backward                  | 8.853 ms                  | 12.060 ms                 |
| Optimize                  | 1.601 ms                  | 3.123 ms                  |
| BarrierTimeBeforeRank0    | 41.258 us                 | 17.617 ms                 |
| AfterBackward             | 12.662 ms                 | 20.006 ms                 |
| BlockToStepN              | 190.249 ms                | 248.488 ms                |
| OneStep                   | 223.709 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:40.454845 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 13:10:40.498004 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=374, pq.top=374
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.340 ms                  | 3.358 ms                  |
| ProcessBack:UpdateCache   | 2.412 ms                  | 3.575 ms                  |
| ProcessBack:UpsertPq      | 6.434 ms                  | 12.665 ms                 |
| ProcessOneStep            | 12.640 ms                 | 19.966 ms                 |
| BlockToStepN              | 190.214 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:41.467147 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:10:41.498003 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240129 13:10:42.498018 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240129 13:10:42.595700 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:10:43.498005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=386, pq.top=386
W20240129 13:10:43.601370 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:10:44.498029 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240129 13:10:44.775404 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.650 ms                  | 19.955 ms                 |
| Forward                   | 4.592 ms                  | 5.926 ms                  |
| Backward                  | 8.856 ms                  | 12.060 ms                 |
| Optimize                  | 1.600 ms                  | 3.123 ms                  |
| BarrierTimeBeforeRank0    | 47.029 us                 | 20.665 ms                 |
| AfterBackward             | 12.747 ms                 | 20.006 ms                 |
| BlockToStepN              | 190.457 ms                | 248.488 ms                |
| OneStep                   | 224.960 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:45.498004 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=394, pq.top=394
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.347 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.410 ms                  | 3.484 ms                  |
| ProcessBack:UpsertPq      | 6.470 ms                  | 13.352 ms                 |
| ProcessOneStep            | 12.725 ms                 | 20.182 ms                 |
| BlockToStepN              | 190.672 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:45.938781 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:10:46.498005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 2] 400 steps, total: 24.253, sample: 0.302, forward: 0.406, backward: 0.872, update: 0.161
[proc 3] 400 steps, total: 24.253, sample: 0.317, forward: 0.412, backward: 0.903, update: 0.159
[proc 1] 400 steps, total: 24.253, sample: 0.327, forward: 0.410, backward: 0.863, update: 0.161
[proc 0] 400 steps, total: 24.253, sample: 0.397, forward: 0.430, backward: 0.892, update: 0.166
W20240129 13:10:47.060022 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:10:47.498015 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240129 13:10:48.076231 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:48.498008 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240129 13:10:49.079416 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:49.498013 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.650 ms                  | 19.955 ms                 |
| Forward                   | 4.587 ms                  | 5.926 ms                  |
| Backward                  | 8.854 ms                  | 12.060 ms                 |
| Optimize                  | 1.601 ms                  | 3.123 ms                  |
| BarrierTimeBeforeRank0    | 47.029 us                 | 21.223 ms                 |
| AfterBackward             | 12.747 ms                 | 20.222 ms                 |
| BlockToStepN              | 191.080 ms                | 248.488 ms                |
| OneStep                   | 226.176 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:50.184088 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:10:50.498005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=416, pq.top=416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.355 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.404 ms                  | 3.484 ms                  |
| ProcessBack:UpsertPq      | 6.442 ms                  | 13.352 ms                 |
| ProcessOneStep            | 12.725 ms                 | 20.182 ms                 |
| BlockToStepN              | 191.382 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:51.196475 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:10:51.500809 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240129 13:10:52.200176 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:10:52.500012 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240129 13:10:53.383783 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:10:53.500005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=428, pq.top=428
W20240129 13:10:54.397897 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:10:54.500010 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.689 ms                  | 20.675 ms                 |
| Forward                   | 4.580 ms                  | 6.012 ms                  |
| Backward                  | 8.858 ms                  | 12.060 ms                 |
| Optimize                  | 1.601 ms                  | 3.259 ms                  |
| BarrierTimeBeforeRank0    | 47.029 us                 | 21.223 ms                 |
| AfterBackward             | 12.799 ms                 | 20.222 ms                 |
| BlockToStepN              | 192.004 ms                | 252.889 ms                |
| OneStep                   | 226.582 ms                | 286.476 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:55.412936 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 13:10:55.500005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=436, pq.top=436
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.360 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.410 ms                  | 3.484 ms                  |
| ProcessBack:UpsertPq      | 6.503 ms                  | 13.301 ms                 |
| ProcessOneStep            | 12.777 ms                 | 20.182 ms                 |
| BlockToStepN              | 191.957 ms                | 252.769 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:10:56.500006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240129 13:10:56.610306 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:10:57.500021 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240129 13:10:57.619699 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:10:58.500006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=448, pq.top=448
W20240129 13:10:58.834354 39616 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 13:10:59.500012 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240129 13:10:59.839219 39616 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 20.675 ms                 |
| Forward                   | 4.576 ms                  | 5.926 ms                  |
| Backward                  | 8.854 ms                  | 11.731 ms                 |
| Optimize                  | 1.608 ms                  | 3.130 ms                  |
| BarrierTimeBeforeRank0    | 42.314 us                 | 20.665 ms                 |
| AfterBackward             | 12.762 ms                 | 20.222 ms                 |
| BlockToStepN              | 193.673 ms                | 248.488 ms                |
| OneStep                   | 228.353 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:00.500005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=456, pq.top=456
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.364 ms                  | 3.358 ms                  |
| ProcessBack:UpdateCache   | 2.412 ms                  | 3.484 ms                  |
| ProcessBack:UpsertPq      | 6.470 ms                  | 13.352 ms                 |
| ProcessOneStep            | 12.735 ms                 | 20.182 ms                 |
| BlockToStepN              | 193.573 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:00.851441 39616 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 13:11:01.500005 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240129 13:11:01.995781 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:11:02.500015 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=464, pq.top=464
W20240129 13:11:03.039192 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:11:03.500007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240129 13:11:04.043591 39616 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 13:11:04.500007 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=472, pq.top=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.698 ms                  | 20.675 ms                 |
| Forward                   | 4.563 ms                  | 6.012 ms                  |
| Backward                  | 8.855 ms                  | 11.731 ms                 |
| Optimize                  | 1.609 ms                  | 3.130 ms                  |
| BarrierTimeBeforeRank0    | 42.314 us                 | 20.665 ms                 |
| AfterBackward             | 12.771 ms                 | 20.222 ms                 |
| BlockToStepN              | 193.939 ms                | 248.488 ms                |
| OneStep                   | 228.949 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:05.055902 39616 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 13:11:05.500011 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=476, pq.top=476
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.366 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.409 ms                  | 3.422 ms                  |
| ProcessBack:UpsertPq      | 6.486 ms                  | 13.301 ms                 |
| ProcessOneStep            | 12.742 ms                 | 20.182 ms                 |
| BlockToStepN              | 193.902 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:06.056129 39616 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 13:11:06.500006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240129 13:11:07.061187 39616 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 13:11:07.500033 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240129 13:11:08.073405 39616 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 13:11:08.500006 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=488, pq.top=488
W20240129 13:11:09.209178 39616 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 13:11:09.524310 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=493, pq.top=493
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.709 ms                  | 20.675 ms                 |
| Forward                   | 4.563 ms                  | 6.012 ms                  |
| Backward                  | 8.856 ms                  | 11.731 ms                 |
| Optimize                  | 1.608 ms                  | 3.130 ms                  |
| BarrierTimeBeforeRank0    | 41.258 us                 | 20.665 ms                 |
| AfterBackward             | 12.780 ms                 | 20.222 ms                 |
| BlockToStepN              | 194.325 ms                | 248.488 ms                |
| OneStep                   | 230.179 ms                | 285.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:10.217278 39616 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.370 ms                  | 3.258 ms                  |
| ProcessBack:UpdateCache   | 2.405 ms                  | 3.484 ms                  |
| ProcessBack:UpsertPq      | 6.499 ms                  | 13.301 ms                 |
| ProcessOneStep            | 12.748 ms                 | 20.182 ms                 |
| BlockToStepN              | 194.098 ms                | 248.335 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 13:11:10.524004 38868 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=497, pq.top=497
[proc 1] 500 steps, total: 24.613, sample: 0.289, forward: 0.408, backward: 0.836, update: 0.153
[proc 0] 500 steps, total: 24.613, sample: 0.437, forward: 0.434, backward: 0.877, update: 0.171
[proc 3] 500 steps, total: 24.613, sample: 0.290, forward: 0.407, backward: 0.889, update: 0.160
[proc 2] 500 steps, total: 24.613, sample: 0.308, forward: 0.413, backward: 0.693, update: 0.155
Successfully xmh. training takes 110.57130479812622 seconds
before call kg_cache_controller.StopThreads()
W20240129 13:11:11.453979 38868 grad_async_v1.h:230] call StopThreads. PID = 38359
W20240129 13:11:11.454002 38868 grad_base.h:212] before processOneStepNegThread_.join();
W20240129 13:11:11.459329 38868 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 13:11:11.459343 38868 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 13:11:11.509683 38868 grad_async_v1.h:251] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fb13cbf4750>
