WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 14:00:08.563710 22048 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_45', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [22048 sampler.py:454] Start PreSampling
WARNING [22048 sampler.py:532] Before construct renumbering_dict
WARNING [22048 sampler.py:555] PreSampling done
W20240129 14:00:13.283912 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 14:00:13.284135 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 14:00:13.284184 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 14:00:13.284211 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 14:00:13.284251 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 14:00:13.284281 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 14:00:13.284315 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 14:00:13.284385 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 14:00:13.284422 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 14:00:13.284456 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 14:00:13.284490 22048 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 14:00:13.284519 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 14:00:13.284543 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 14:00:13.284726 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 14:00:13.284761 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 14:00:13.284795 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 14:00:13.284837 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 14:00:13.284860 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 14:00:13.284897 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 14:00:13.284927 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 14:00:13.284971 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 14:00:13.285001 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 14:00:13.285033 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 14:00:13.285058 22048 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 14:00:13.285080 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 14:00:13.285101 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 14:00:13.285151 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 14:00:13.285181 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 14:00:13.285209 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 14:00:13.285233 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 14:00:13.285264 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 14:00:13.285305 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 14:00:13.285329 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 14:00:13.285358 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 14:00:13.285382 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 14:00:13.285406 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 14:00:13.285434 22048 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 14:00:13.285455 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 14:00:13.285476 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 14:00:13.285528 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 14:00:13.285564 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 14:00:13.285605 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 14:00:13.285645 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 14:00:13.285672 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 14:00:13.285706 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 14:00:13.285732 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 14:00:13.285770 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 14:00:13.285810 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 14:00:13.285840 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 14:00:13.285867 22048 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 14:00:13.285888 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 14:00:13.285916 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 14:00:13.285972 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240129 14:00:13.286003 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240129 14:00:13.286039 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240129 14:00:13.286069 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240129 14:00:13.286115 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240129 14:00:13.286144 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240129 14:00:13.286195 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240129 14:00:13.286221 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240129 14:00:13.286253 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240129 14:00:13.286293 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240129 14:00:13.286324 22048 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240129 14:00:13.286346 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240129 14:00:13.286370 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240129 14:00:13.286422 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240129 14:00:13.286453 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240129 14:00:13.286478 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240129 14:00:13.286509 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240129 14:00:13.286538 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240129 14:00:13.286577 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240129 14:00:13.286613 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240129 14:00:13.286653 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240129 14:00:13.286679 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240129 14:00:13.286705 22048 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240129 14:00:13.286732 22048 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240129 14:00:13.286754 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240129 14:00:13.286775 22048 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240129 14:00:13.517748 22048 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240129 14:00:13.517913 22048 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([ 992, 1291, 1513,  ..., 2414, 2366, 9008]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.988 seconds
[Rank1] pid = 22471
[Rank2] pid = 22518
[Rank3] pid = 22599
[Rank4] pid = 22663
INFO [22048 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [22599 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [22471 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [22518 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [22663 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22665 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [22665 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22663 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22048 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22471 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22599 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22518 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
WARNING [22665 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22518 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22048 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22663 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22599 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [22471 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 14:00:15.779285 22472 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240129 14:00:15.779351 22536 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240129 14:00:15.779429 22730 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240129 14:00:15.779479 22600 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240129 14:00:15.779536 22664 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240129 14:00:15.779575 22729 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240129 14:00:17.383561 22730 recstore.cc:66] init folly done
E20240129 14:00:17.383563 22472 recstore.cc:66] init folly done
E20240129 14:00:17.383606 22664 recstore.cc:66] init folly done
E20240129 14:00:17.383574 22536 recstore.cc:66] init folly done
E20240129 14:00:17.383576 22729 recstore.cc:66] init folly done
E20240129 14:00:17.383608 22600 recstore.cc:66] init folly done
I20240129 14:00:17.468235 22536 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240129 14:00:17.474174 22730 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 14:00:17.474809 22472 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 14:00:17.475553 22600 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 14:00:17.476833 22729 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240129 14:00:17.477519 22664 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.288 ms                  | 2.245 ms                  |
| bucket keys               | 2.413 ms                  | 169.633 ms                |
| forward: a2a keys         | 1.980 ms                  | 1.013 s                   |
| forward: search cache     | 344.444 us                | 22.966 ms                 |
| forward: a2a values       | 3.022 ms                  | 6.172 ms                  |
| forward: join             | 2.861 ms                  | 3.346 ms                  |
| Forward                   | 31.608 ms                 | 1.712 s                   |
| back: aggr dram keys      | 42.121 ms                 | 669.278 ms                |
| back: set dram grad       | 3.307 ms                  | 7.351 ms                  |
| back: a2a grad            | 5.558 ms                  | 9.341 ms                  |
| back: grad sum & grad cache  | 4.275 ms                  | 4.600 ms                  |
| Backward                  | 120.610 ms                | 929.798 ms                |
| Optimize                  | 31.361 ms                 | 32.832 ms                 |
| BarrierTimeBeforeRank0    | 54.922 us                 | 103.669 us                |
| BlockToStepN              | 18.272 us                 | 34.175 us                 |
| OneStep                   | 187.622 ms                | 2.676 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.641 ms                  | 26.058 ms                 |
| bucket keys               | 2.433 ms                  | 3.156 ms                  |
| forward: a2a keys         | 2.084 ms                  | 14.247 ms                 |
| forward: search cache     | 361.162 us                | 385.763 us                |
| forward: a2a values       | 2.970 ms                  | 5.442 ms                  |
| forward: join             | 2.866 ms                  | 3.496 ms                  |
| Forward                   | 31.146 ms                 | 1.712 s                   |
| back: aggr dram keys      | 42.235 ms                 | 65.478 ms                 |
| back: set dram grad       | 3.445 ms                  | 8.388 ms                  |
| back: a2a grad            | 5.905 ms                  | 8.157 ms                  |
| back: grad sum & grad cache  | 4.425 ms                  | 6.084 ms                  |
| Backward                  | 119.678 ms                | 929.798 ms                |
| Optimize                  | 29.291 ms                 | 38.898 ms                 |
| BarrierTimeBeforeRank0    | 54.400 us                 | 103.669 us                |
| BlockToStepN              | 18.272 us                 | 165.175 us                |
| OneStep                   | 184.414 ms                | 2.676 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.689 ms                  | 26.504 ms                 |
| bucket keys               | 2.468 ms                  | 6.767 ms                  |
| forward: a2a keys         | 1.854 ms                  | 16.655 ms                 |
| forward: search cache     | 359.143 us                | 737.835 us                |
| forward: a2a values       | 2.923 ms                  | 6.172 ms                  |
| forward: join             | 2.882 ms                  | 3.551 ms                  |
| Forward                   | 30.669 ms                 | 42.962 ms                 |
| back: aggr dram keys      | 41.884 ms                 | 65.478 ms                 |
| back: set dram grad       | 3.444 ms                  | 8.388 ms                  |
| back: a2a grad            | 5.774 ms                  | 8.581 ms                  |
| back: grad sum & grad cache  | 4.380 ms                  | 8.058 ms                  |
| Backward                  | 116.529 ms                | 154.322 ms                |
| Optimize                  | 29.291 ms                 | 38.898 ms                 |
| BarrierTimeBeforeRank0    | 54.056 us                 | 96.201 us                 |
| BlockToStepN              | 17.911 us                 | 133.717 us                |
| OneStep                   | 182.623 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.689 ms                  | 26.504 ms                 |
| bucket keys               | 2.435 ms                  | 4.473 ms                  |
| forward: a2a keys         | 1.771 ms                  | 14.247 ms                 |
| forward: search cache     | 355.926 us                | 600.467 us                |
| forward: a2a values       | 2.856 ms                  | 5.442 ms                  |
| forward: join             | 2.880 ms                  | 3.551 ms                  |
| Forward                   | 30.104 ms                 | 42.962 ms                 |
| back: aggr dram keys      | 41.514 ms                 | 57.798 ms                 |
| back: set dram grad       | 3.437 ms                  | 8.147 ms                  |
| back: a2a grad            | 5.757 ms                  | 9.341 ms                  |
| back: grad sum & grad cache  | 4.408 ms                  | 7.201 ms                  |
| Backward                  | 114.350 ms                | 154.322 ms                |
| Optimize                  | 29.219 ms                 | 39.896 ms                 |
| BarrierTimeBeforeRank0    | 50.696 us                 | 96.201 us                 |
| BlockToStepN              | 17.536 us                 | 158.347 us                |
| OneStep                   | 179.336 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 20.555, sample: 0.414, forward: 4.804, backward: 12.143, update: 0.466
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.564, sample: 0.428, forward: 4.798, backward: 12.138, update: 0.426
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.557, sample: 0.408, forward: 4.810, backward: 12.144, update: 0.410
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 20.558, sample: 0.423, forward: 4.803, backward: 12.143, update: 0.500
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 20.558, sample: 0.425, forward: 4.798, backward: 12.128, update: 0.430
[Rank5] pid = 22665
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
train_sampler.Prefill()
-------Step 0-------
tensor([   80,  7859,  7820,   904, 10120,  7784,   101,  6553, 10177,  3063]) tensor([ 1513,    97,  4411,  5815,    37, 11001,  9739, 13104,  1528, 10135])
-------Step 1-------
tensor([   80,  7859,  7820,   904, 10120,  7784,   101,  6553, 10177,  3063]) tensor([ 6057,  3974,   381,  6760,  4235, 13787,  2105,  9054, 11938, 11378])
-------Step 2-------
tensor([ 1542,  3904, 10120,  6378, 10167, 13528,     3, 13107,  8185,  4676]) tensor([ 6931, 10018,  6398, 11096,  9171,  6530,  6641,  5877,  2183,  9980])
-------Step 3-------
tensor([ 1542,  3904, 10120,  6378, 10167, 13528,     3, 13107,  8185,  4676]) tensor([ 5932,  3007,  3874, 13158,  7182,   450,  6123,  3928,   201,  2480])
-------Step 4-------
tensor([  100,  3621,  9677,  6974, 11688,  2949, 10120, 10306,  9200,  8018]) tensor([ 3791,  4210,  2307,  1734, 13503, 12829,  7521, 12310, 13502,  2635])
-------Step 5-------
tensor([  100,  3621,  9677,  6974, 11688,  2949, 10120, 10306,  9200,  8018]) tensor([ 6613, 11557,   595, 13071,  6796,  8109, 14107,   496, 13108,  2015])
-------Step 6-------
tensor([ 7290, 14515, 13178,  2409,  4294,   149,    99, 13431,   100,    24]) tensor([12600,  4780,  2431,  8678,  1169,   438,  4397, 11675,  2152,  3522])
-------Step 7-------
tensor([ 7290, 14515, 13178,  2409,  4294,   149,    99, 13431,   100,    24]) tensor([14762,   274,  9036,  5206, 12483,  7758,  8202,  5781,  5897,  6660])
-------Step 8-------
tensor([ 3042,  4060,  1308,   719,  3574,  2184,  6840,    86, 10675,    99]) tensor([12741,  3531,  1735, 11498, 10431, 11061, 10970,  7052,  4383, 13779])
-------Step 9-------
tensor([ 3042,  4060,  1308,   719,  3574,  2184,  6840,    86, 10675,    99]) tensor([ 7981, 10440,  8674,  9461,  2053,  9615,   443,  5474,  3880,  2770])
before start barrier
start train
[proc 0] 100 steps, total: 20.556, sample: 0.446, forward: 4.824, backward: 12.301, update: 2.870
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.691 ms                  | 26.990 ms                 |
| bucket keys               | 2.462 ms                  | 4.477 ms                  |
| forward: a2a keys         | 1.789 ms                  | 28.526 ms                 |
| forward: search cache     | 356.183 us                | 600.467 us                |
| forward: a2a values       | 2.872 ms                  | 6.172 ms                  |
| forward: join             | 2.892 ms                  | 3.568 ms                  |
| Forward                   | 30.129 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.514 ms                 | 57.798 ms                 |
| back: set dram grad       | 3.412 ms                  | 8.147 ms                  |
| back: a2a grad            | 5.771 ms                  | 9.341 ms                  |
| back: grad sum & grad cache  | 4.442 ms                  | 8.058 ms                  |
| Backward                  | 111.705 ms                | 154.322 ms                |
| Optimize                  | 29.291 ms                 | 39.896 ms                 |
| BarrierTimeBeforeRank0    | 49.533 us                 | 96.201 us                 |
| BlockToStepN              | 17.163 us                 | 163.131 us                |
| OneStep                   | 178.553 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.649 ms                  | 29.487 ms                 |
| bucket keys               | 2.455 ms                  | 4.473 ms                  |
| forward: a2a keys         | 1.814 ms                  | 31.904 ms                 |
| forward: search cache     | 356.732 us                | 600.467 us                |
| forward: a2a values       | 2.888 ms                  | 5.485 ms                  |
| forward: join             | 2.901 ms                  | 3.679 ms                  |
| Forward                   | 30.404 ms                 | 67.736 ms                 |
| back: aggr dram keys      | 41.785 ms                 | 57.798 ms                 |
| back: set dram grad       | 3.405 ms                  | 8.017 ms                  |
| back: a2a grad            | 5.746 ms                  | 9.322 ms                  |
| back: grad sum & grad cache  | 4.479 ms                  | 7.229 ms                  |
| Backward                  | 111.500 ms                | 154.322 ms                |
| Optimize                  | 29.016 ms                 | 39.896 ms                 |
| BarrierTimeBeforeRank0    | 49.210 us                 | 96.201 us                 |
| BlockToStepN              | 17.605 us                 | 163.131 us                |
| OneStep                   | 181.916 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.649 ms                  | 26.990 ms                 |
| bucket keys               | 2.435 ms                  | 4.473 ms                  |
| forward: a2a keys         | 1.799 ms                  | 32.505 ms                 |
| forward: search cache     | 354.902 us                | 600.467 us                |
| forward: a2a values       | 2.885 ms                  | 5.485 ms                  |
| forward: join             | 2.882 ms                  | 3.679 ms                  |
| Forward                   | 30.621 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.878 ms                 | 57.798 ms                 |
| back: set dram grad       | 3.393 ms                  | 8.017 ms                  |
| back: a2a grad            | 5.757 ms                  | 9.322 ms                  |
| back: grad sum & grad cache  | 4.502 ms                  | 7.229 ms                  |
| Backward                  | 111.106 ms                | 142.677 ms                |
| Optimize                  | 27.934 ms                 | 39.793 ms                 |
| BarrierTimeBeforeRank0    | 48.516 us                 | 89.225 us                 |
| BlockToStepN              | 17.615 us                 | 158.347 us                |
| OneStep                   | 183.220 ms                | 220.585 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.641 ms                  | 26.990 ms                 |
| bucket keys               | 2.432 ms                  | 4.429 ms                  |
| forward: a2a keys         | 1.799 ms                  | 31.977 ms                 |
| forward: search cache     | 355.237 us                | 595.580 us                |
| forward: a2a values       | 2.888 ms                  | 5.442 ms                  |
| forward: join             | 2.871 ms                  | 3.620 ms                  |
| Forward                   | 30.955 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.785 ms                 | 56.981 ms                 |
| back: set dram grad       | 3.403 ms                  | 7.894 ms                  |
| back: a2a grad            | 5.732 ms                  | 9.045 ms                  |
| back: grad sum & grad cache  | 4.481 ms                  | 7.229 ms                  |
| Backward                  | 111.106 ms                | 142.677 ms                |
| Optimize                  | 28.689 ms                 | 39.793 ms                 |
| BarrierTimeBeforeRank0    | 49.100 us                 | 89.225 us                 |
| BlockToStepN              | 16.989 us                 | 158.347 us                |
| OneStep                   | 184.468 ms                | 220.585 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 18.768, sample: 0.435, forward: 4.235, backward: 10.976, update: 0.317
[proc 1] 200 steps, total: 18.768, sample: 0.451, forward: 4.223, backward: 10.977, update: 0.453
[proc 3] 200 steps, total: 18.768, sample: 0.432, forward: 4.234, backward: 10.971, update: 0.366
[proc 2] 200 steps, total: 18.768, sample: 0.411, forward: 4.268, backward: 10.970, update: 0.358
[proc 4] 200 steps, total: 18.768, sample: 0.467, forward: 4.203, backward: 10.977, update: 0.453
[proc 0] 200 steps, total: 18.768, sample: 0.495, forward: 4.242, backward: 11.148, update: 2.772
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.641 ms                  | 26.990 ms                 |
| bucket keys               | 2.431 ms                  | 4.429 ms                  |
| forward: a2a keys         | 1.777 ms                  | 31.977 ms                 |
| forward: search cache     | 352.608 us                | 595.580 us                |
| forward: a2a values       | 2.896 ms                  | 5.485 ms                  |
| forward: join             | 2.860 ms                  | 3.620 ms                  |
| Forward                   | 31.153 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.493 ms                 | 56.981 ms                 |
| back: set dram grad       | 3.398 ms                  | 7.894 ms                  |
| back: a2a grad            | 5.746 ms                  | 9.045 ms                  |
| back: grad sum & grad cache  | 4.477 ms                  | 8.058 ms                  |
| Backward                  | 111.139 ms                | 142.677 ms                |
| Optimize                  | 28.689 ms                 | 39.793 ms                 |
| BarrierTimeBeforeRank0    | 49.132 us                 | 89.225 us                 |
| BlockToStepN              | 17.192 us                 | 163.131 us                |
| OneStep                   | 184.898 ms                | 220.585 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.649 ms                  | 29.487 ms                 |
| bucket keys               | 2.431 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.804 ms                  | 31.904 ms                 |
| forward: search cache     | 352.740 us                | 520.169 us                |
| forward: a2a values       | 2.893 ms                  | 5.442 ms                  |
| forward: join             | 2.865 ms                  | 3.679 ms                  |
| Forward                   | 31.177 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.395 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.395 ms                  | 7.862 ms                  |
| back: a2a grad            | 5.746 ms                  | 8.981 ms                  |
| back: grad sum & grad cache  | 4.463 ms                  | 7.229 ms                  |
| Backward                  | 111.139 ms                | 142.677 ms                |
| Optimize                  | 28.339 ms                 | 39.793 ms                 |
| BarrierTimeBeforeRank0    | 49.100 us                 | 89.225 us                 |
| BlockToStepN              | 17.667 us                 | 253.284 us                |
| OneStep                   | 185.294 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.650 ms                  | 29.322 ms                 |
| bucket keys               | 2.432 ms                  | 3.575 ms                  |
| forward: a2a keys         | 1.778 ms                  | 31.598 ms                 |
| forward: search cache     | 352.176 us                | 513.085 us                |
| forward: a2a values       | 2.885 ms                  | 5.442 ms                  |
| forward: join             | 2.861 ms                  | 3.620 ms                  |
| Forward                   | 31.366 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.352 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.393 ms                  | 7.894 ms                  |
| back: a2a grad            | 5.724 ms                  | 8.981 ms                  |
| back: grad sum & grad cache  | 4.425 ms                  | 7.229 ms                  |
| Backward                  | 110.752 ms                | 132.443 ms                |
| Optimize                  | 28.178 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 49.210 us                 | 83.298 us                 |
| BlockToStepN              | 17.667 us                 | 165.175 us                |
| OneStep                   | 184.705 ms                | 220.585 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 18.569, sample: 0.459, forward: 3.930, backward: 11.051, update: 0.476
[proc 2] 300 steps, total: 18.569, sample: 0.433, forward: 3.954, backward: 11.054, update: 0.490
[proc 5] 300 steps, total: 18.569, sample: 0.445, forward: 3.940, backward: 11.051, update: 0.464
[proc 3] 300 steps, total: 18.569, sample: 0.486, forward: 3.907, backward: 11.041, update: 0.500
[proc 0] 300 steps, total: 18.569, sample: 0.459, forward: 3.979, backward: 11.187, update: 2.824
[proc 1] 300 steps, total: 18.569, sample: 0.444, forward: 3.955, backward: 11.039, update: 0.524
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 29.322 ms                 |
| bucket keys               | 2.433 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.789 ms                  | 31.598 ms                 |
| forward: search cache     | 352.123 us                | 513.085 us                |
| forward: a2a values       | 2.879 ms                  | 5.442 ms                  |
| forward: join             | 2.861 ms                  | 3.818 ms                  |
| Forward                   | 31.690 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.400 ms                 | 56.071 ms                 |
| back: set dram grad       | 3.393 ms                  | 7.894 ms                  |
| back: a2a grad            | 5.726 ms                  | 8.981 ms                  |
| back: grad sum & grad cache  | 4.420 ms                  | 7.201 ms                  |
| Backward                  | 110.797 ms                | 135.549 ms                |
| Optimize                  | 27.963 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 49.210 us                 | 83.298 us                 |
| BlockToStepN              | 17.757 us                 | 253.284 us                |
| OneStep                   | 184.705 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 29.322 ms                 |
| bucket keys               | 2.433 ms                  | 3.575 ms                  |
| forward: a2a keys         | 1.799 ms                  | 31.598 ms                 |
| forward: search cache     | 353.232 us                | 508.170 us                |
| forward: a2a values       | 2.888 ms                  | 5.485 ms                  |
| forward: join             | 2.858 ms                  | 3.818 ms                  |
| Forward                   | 31.608 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.479 ms                 | 56.071 ms                 |
| back: set dram grad       | 3.395 ms                  | 7.862 ms                  |
| back: a2a grad            | 5.745 ms                  | 8.797 ms                  |
| back: grad sum & grad cache  | 4.408 ms                  | 7.201 ms                  |
| Backward                  | 111.021 ms                | 138.784 ms                |
| Optimize                  | 28.420 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 49.388 us                 | 83.298 us                 |
| BlockToStepN              | 17.668 us                 | 253.284 us                |
| OneStep                   | 184.963 ms                | 226.018 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.665 ms                  | 29.307 ms                 |
| bucket keys               | 2.434 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.800 ms                  | 31.904 ms                 |
| forward: search cache     | 353.232 us                | 508.170 us                |
| forward: a2a values       | 2.889 ms                  | 5.485 ms                  |
| forward: join             | 2.861 ms                  | 3.818 ms                  |
| Forward                   | 31.685 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.400 ms                 | 56.071 ms                 |
| back: set dram grad       | 3.392 ms                  | 7.862 ms                  |
| back: a2a grad            | 5.752 ms                  | 8.815 ms                  |
| back: grad sum & grad cache  | 4.409 ms                  | 8.058 ms                  |
| Backward                  | 111.010 ms                | 137.326 ms                |
| Optimize                  | 28.452 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 49.141 us                 | 82.230 us                 |
| BlockToStepN              | 17.654 us                 | 170.818 us                |
| OneStep                   | 186.325 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.663 ms                  | 29.487 ms                 |
| bucket keys               | 2.435 ms                  | 3.575 ms                  |
| forward: a2a keys         | 1.793 ms                  | 31.598 ms                 |
| forward: search cache     | 353.421 us                | 499.917 us                |
| forward: a2a values       | 2.889 ms                  | 5.442 ms                  |
| forward: join             | 2.855 ms                  | 3.679 ms                  |
| Forward                   | 31.608 ms                 | 65.152 ms                 |
| back: aggr dram keys      | 41.352 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.383 ms                  | 7.661 ms                  |
| back: a2a grad            | 5.740 ms                  | 8.844 ms                  |
| back: grad sum & grad cache  | 4.417 ms                  | 7.229 ms                  |
| Backward                  | 110.752 ms                | 137.326 ms                |
| Optimize                  | 28.321 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 49.100 us                 | 82.230 us                 |
| BlockToStepN              | 17.646 us                 | 170.818 us                |
| OneStep                   | 185.759 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 18.691, sample: 0.501, forward: 3.976, backward: 11.207, update: 2.890
[proc 3] 400 steps, total: 18.691, sample: 0.426, forward: 4.012, backward: 11.030, update: 0.368
[proc 2] 400 steps, total: 18.691, sample: 0.454, forward: 3.994, backward: 11.027, update: 0.458
[proc 5] 400 steps, total: 18.691, sample: 0.399, forward: 4.040, backward: 11.041, update: 0.391
[proc 4] 400 steps, total: 18.691, sample: 0.482, forward: 3.966, backward: 11.025, update: 0.414
[proc 1] 400 steps, total: 18.691, sample: 0.427, forward: 4.016, backward: 11.033, update: 0.485
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.649 ms                  | 29.487 ms                 |
| bucket keys               | 2.435 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.782 ms                  | 31.904 ms                 |
| forward: search cache     | 352.740 us                | 499.917 us                |
| forward: a2a values       | 2.888 ms                  | 5.442 ms                  |
| forward: join             | 2.851 ms                  | 3.679 ms                  |
| Forward                   | 31.685 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.400 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.381 ms                  | 7.661 ms                  |
| back: a2a grad            | 5.722 ms                  | 9.045 ms                  |
| back: grad sum & grad cache  | 4.411 ms                  | 8.058 ms                  |
| Backward                  | 110.529 ms                | 137.326 ms                |
| Optimize                  | 28.178 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 48.579 us                 | 82.230 us                 |
| BlockToStepN              | 17.654 us                 | 170.818 us                |
| OneStep                   | 185.081 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.647 ms                  | 29.487 ms                 |
| bucket keys               | 2.435 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.788 ms                  | 31.904 ms                 |
| forward: search cache     | 353.653 us                | 499.917 us                |
| forward: a2a values       | 2.890 ms                  | 5.334 ms                  |
| forward: join             | 2.848 ms                  | 3.620 ms                  |
| Forward                   | 31.765 ms                 | 66.452 ms                 |
| back: aggr dram keys      | 41.395 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.380 ms                  | 7.634 ms                  |
| back: a2a grad            | 5.722 ms                  | 8.981 ms                  |
| back: grad sum & grad cache  | 4.417 ms                  | 7.459 ms                  |
| Backward                  | 110.435 ms                | 138.496 ms                |
| Optimize                  | 28.265 ms                 | 38.977 ms                 |
| BarrierTimeBeforeRank0    | 48.475 us                 | 82.230 us                 |
| BlockToStepN              | 17.646 us                 | 170.818 us                |
| OneStep                   | 185.361 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.647 ms                  | 29.322 ms                 |
| bucket keys               | 2.436 ms                  | 3.583 ms                  |
| forward: a2a keys         | 1.782 ms                  | 31.904 ms                 |
| forward: search cache     | 353.273 us                | 499.917 us                |
| forward: a2a values       | 2.882 ms                  | 5.442 ms                  |
| forward: join             | 2.848 ms                  | 3.620 ms                  |
| Forward                   | 31.977 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.395 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.379 ms                  | 7.634 ms                  |
| back: a2a grad            | 5.726 ms                  | 9.136 ms                  |
| back: grad sum & grad cache  | 4.423 ms                  | 7.459 ms                  |
| Backward                  | 110.529 ms                | 137.326 ms                |
| Optimize                  | 28.265 ms                 | 38.898 ms                 |
| BarrierTimeBeforeRank0    | 48.755 us                 | 79.967 us                 |
| BlockToStepN              | 17.632 us                 | 165.175 us                |
| OneStep                   | 186.482 ms                | 220.585 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.653 ms                  | 29.487 ms                 |
| bucket keys               | 2.437 ms                  | 3.575 ms                  |
| forward: a2a keys         | 1.771 ms                  | 31.598 ms                 |
| forward: search cache     | 353.648 us                | 498.138 us                |
| forward: a2a values       | 2.878 ms                  | 5.334 ms                  |
| forward: join             | 2.850 ms                  | 3.608 ms                  |
| Forward                   | 31.873 ms                 | 66.038 ms                 |
| back: aggr dram keys      | 41.395 ms                 | 55.588 ms                 |
| back: set dram grad       | 3.376 ms                  | 7.540 ms                  |
| back: a2a grad            | 5.727 ms                  | 9.045 ms                  |
| back: grad sum & grad cache  | 4.425 ms                  | 7.878 ms                  |
| Backward                  | 110.376 ms                | 138.496 ms                |
| Optimize                  | 28.222 ms                 | 38.898 ms                 |
| BarrierTimeBeforeRank0    | 48.783 us                 | 79.967 us                 |
| BlockToStepN              | 17.642 us                 | 165.175 us                |
| OneStep                   | 186.500 ms                | 224.221 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 500 steps, total: 18.633, sample: 0.395, forward: 4.072, backward: 10.983, update: 0.318
[proc 4] 500 steps, total: 18.633, sample: 0.412, forward: 4.045, backward: 10.976, update: 0.324
[proc 1] 500 steps, total: 18.633, sample: 0.423, forward: 4.041, backward: 10.983, update: 0.462
[proc 2] 500 steps, total: 18.633, sample: 0.383, forward: 4.096, backward: 10.972, update: 0.404
[proc 3] 500 steps, total: 18.633, sample: 0.403, forward: 4.066, backward: 10.977, update: 0.465
[proc 0] 500 steps, total: 18.633, sample: 0.459, forward: 4.051, backward: 11.164, update: 2.845
Successfully xmh. training takes 95.21659064292908 seconds
before call kg_cache_controller.StopThreads()
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
INFO [22048 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
