WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 23:10:59.896106 57776 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_40', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [57776 sampler.py:454] Start PreSampling
WARNING [57776 sampler.py:532] Before construct renumbering_dict
WARNING [57776 sampler.py:555] PreSampling done
W20240123 23:24:15.332609 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 23:24:15.332859 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 23:24:15.332904 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 23:24:15.332937 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 23:24:15.332964 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 23:24:15.332993 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 23:24:15.333022 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 23:24:15.333052 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 23:24:15.333079 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 23:24:15.333114 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 23:24:15.333154 57776 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 23:24:15.333182 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 23:24:15.333210 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 23:24:15.333370 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 23:24:15.333402 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 23:24:15.333438 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 23:24:15.333462 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 23:24:15.333508 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 23:24:15.333534 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 23:24:15.333564 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 23:24:15.333591 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 23:24:15.333621 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 23:24:15.333644 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 23:24:15.333673 57776 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 23:24:15.333691 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 23:24:15.333711 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 23:24:15.333767 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240123 23:24:15.333796 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240123 23:24:15.333822 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240123 23:24:15.333844 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240123 23:24:15.333873 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240123 23:24:15.333895 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240123 23:24:15.333932 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240123 23:24:15.333958 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240123 23:24:15.333992 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240123 23:24:15.334018 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240123 23:24:15.334045 57776 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240123 23:24:15.334064 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240123 23:24:15.334086 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240123 23:24:15.334133 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240123 23:24:15.334162 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240123 23:24:15.334189 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240123 23:24:15.334211 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240123 23:24:15.334234 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240123 23:24:15.334257 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240123 23:24:15.334283 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240123 23:24:15.334307 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240123 23:24:15.334333 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240123 23:24:15.334354 57776 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240123 23:24:15.334374 57776 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240123 23:24:15.334393 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240123 23:24:15.334411 57776 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240123 23:24:15.646201 57776 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100001ee2000 128.2 GB
W20240123 23:24:15.646404 57776 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102010b1a000 328.3 MB
{0: Graph(num_nodes=27256011, num_edges=100992629,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23779591, num_edges=94535774,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=26463902, num_edges=75890617,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=25398646, num_edges=93789131,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27256011 N 100992629 E
MertisPartition: part 1 has 23779591 N 94535774 E
MertisPartition: part 2 has 26463902 N 75890617 E
MertisPartition: part 3 has 25398646 N 93789131 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302771,   260737,  ...,  4057410, 11961426, 85805630]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 974.170 seconds
[Rank1] pid = 17806
[Rank2] pid = 17907
INFO [57776 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [17806 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [17907 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [17907 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [17983 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [17983 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [17907 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [17983 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [17907 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [17907 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [17983 cache_common.py:137] TorchNativeStdEmb construct done
INFO [57776 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [17983 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [17806 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [57776 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [17806 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [57776 cache_common.py:137] TorchNativeStdEmb construct done
INFO [17806 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [17806 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [57776 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 23:27:18.521677 17984 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 23:27:18.521833 17807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 23:27:18.521966 18042 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 23:27:18.522209 17908 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 23:27:30.790443 17908 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 23:27:32.365275 17807 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 23:27:32.393121 18042 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 23:27:33.806439 17984 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.540 ms                  | 287.873 ms                |
| Forward                   | 9.392 ms                  | 488.511 ms                |
| Backward                  | 86.756 ms                 | 209.960 ms                |
| Optimize                  | 2.152 ms                  | 4.061 ms                  |
| BarrierTimeBeforeRank0    | 7.066 ms                  | 21.637 ms                 |
| BlockToStepN              | 8.741 us                  | 76.966 us                 |
| OneStep                   | 114.710 ms                | 731.005 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.655 ms                  | 269.740 ms                |
| Forward                   | 9.439 ms                  | 22.171 ms                 |
| Backward                  | 131.043 ms                | 238.323 ms                |
| Optimize                  | 2.144 ms                  | 2.440 ms                  |
| BarrierTimeBeforeRank0    | 6.552 ms                  | 28.167 ms                 |
| BlockToStepN              | 8.741 us                  | 76.966 us                 |
| OneStep                   | 166.559 ms                | 429.478 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.655 ms                  | 269.740 ms                |
| Forward                   | 9.439 ms                  | 22.171 ms                 |
| Backward                  | 167.795 ms                | 351.880 ms                |
| Optimize                  | 2.123 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.553 ms                  | 55.798 ms                 |
| BlockToStepN              | 8.986 us                  | 76.966 us                 |
| OneStep                   | 197.748 ms                | 498.546 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.810 ms                  | 269.740 ms                |
| Forward                   | 9.403 ms                  | 22.171 ms                 |
| Backward                  | 190.098 ms                | 355.558 ms                |
| Optimize                  | 2.123 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.712 ms                  | 116.718 ms                |
| BlockToStepN              | 9.055 us                  | 76.966 us                 |
| OneStep                   | 240.582 ms                | 569.243 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.058 ms                  | 269.740 ms                |
| Forward                   | 9.376 ms                  | 22.171 ms                 |
| Backward                  | 217.633 ms                | 403.586 ms                |
| Optimize                  | 2.103 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.712 ms                  | 116.718 ms                |
| BlockToStepN              | 9.013 us                  | 2.585 ms                  |
| OneStep                   | 255.615 ms                | 618.749 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 31.850, sample: 1.799, forward: 2.086, backward: 23.096, update: 0.208
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.248, sample: 1.208, forward: 2.083, backward: 23.824, update: 0.208
[Rank3] pid = 17983
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([  802049,  4594777,   802092,   802122,   802169,   802224, 57044475,
          176986,  4309543,   802262]) tensor([ 5028193, 24048768, 26779304, 48205132, 63238909, 33876737, 83881303,
        61981539, 43480888, 35765002])
-------Step 1-------
tensor([  802049,  4594777,   802092,   802122,   802169,   802224, 57044475,
          176986,  4309543,   802262]) tensor([43710347, 59235450, 21693891, 21931765, 37675666, 12716045, 55112449,
        59255600,   371593, 83332792])
-------Step 2-------
tensor([ 867901,  867923,   88931, 7051637,  867947, 4588689,  867964,  166583,
         867990,  868013]) tensor([20483293, 63098875, 33245992, 28259884, 85406610, 59844780, 11677175,
        12657360, 14424195, 68574232])
-------Step 3-------
tensor([ 867901,  867923,   88931, 7051637,  867947, 4588689,  867964,  166583,
         867990,  868013]) tensor([47817525, 33938868, 71189679,   171630, 50858766, 41196621, 48845330,
        28858946, 75756713, 33601283])
-------Step 4-------
tensor([  919020,   919038,   919058,   919078,   919097, 83803470,   104268,
        52566428,   919114,   919134]) tensor([  982404,   872019, 51551882, 47342248, 66803104, 44317967, 20188129,
        12618610, 39017996, 50103059])
-------Step 5-------
tensor([  919020,   919038,   919058,   919078,   919097, 83803470,   104268,
        52566428,   919114,   919134]) tensor([ 6901045, 11332944, 35110092, 31945848, 53526973,  1376642, 53800406,
        19863148,  5581571, 66754342])
-------Step 6-------
tensor([966784, 966800, 966814, 655596, 966833, 966848, 966864, 966882, 966901,
        966919]) tensor([10831224, 73303435, 34662900, 10246085, 12057805, 32036855,   271460,
        20387860, 23294575, 79774449])
-------Step 7-------
tensor([966784, 966800, 966814, 655596, 966833, 966848, 966864, 966882, 966901,
        966919]) tensor([40204938, 83862447, 64887490, 62230655, 33748639, 34586429, 79638241,
        70903125, 50228846, 75782001])
-------Step 8-------
tensor([  116118,   135277, 75803576,   449545,  1013816,   135318,   993814,
         1013834,  1013845,   135361]) tensor([25277803, 38420613, 26034672,  2077638,  5427357, 34048750, 15308561,
        70406106, 45686212, 40094770])
-------Step 9-------
tensor([  116118,   135277, 75803576,   449545,  1013816,   135318,   993814,
         1013834,  1013845,   135361]) tensor([  854363, 37461596, 58195647,  6012525, 65267299, 29887474, 74456201,
        15215715, 75440103, 55228343])
before start barrier
start train
[proc 0] 100 steps, total: 28.835, sample: 2.012, forward: 1.416, backward: 23.807, update: 0.195
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.276, sample: 1.934, forward: 2.158, backward: 23.422, update: 0.191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.951 ms                  | 269.740 ms                |
| Forward                   | 9.392 ms                  | 22.171 ms                 |
| Backward                  | 238.323 ms                | 453.859 ms                |
| Optimize                  | 2.073 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.553 ms                  | 116.718 ms                |
| BlockToStepN              | 9.055 us                  | 2.585 ms                  |
| OneStep                   | 296.587 ms                | 618.749 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.163 ms                  | 269.740 ms                |
| Forward                   | 9.392 ms                  | 22.171 ms                 |
| Backward                  | 252.942 ms                | 567.173 ms                |
| Optimize                  | 2.028 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.552 ms                  | 116.718 ms                |
| BlockToStepN              | 9.055 us                  | 2.585 ms                  |
| OneStep                   | 316.005 ms                | 731.005 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.171 ms                  | 269.740 ms                |
| Forward                   | 9.392 ms                  | 22.171 ms                 |
| Backward                  | 279.693 ms                | 567.173 ms                |
| Optimize                  | 2.027 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.480 ms                  | 116.718 ms                |
| BlockToStepN              | 9.174 us                  | 2.585 ms                  |
| OneStep                   | 352.950 ms                | 731.005 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.171 ms                  | 269.740 ms                |
| Forward                   | 9.320 ms                  | 22.171 ms                 |
| Backward                  | 298.843 ms                | 567.173 ms                |
| Optimize                  | 2.012 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.553 ms                  | 120.366 ms                |
| BlockToStepN              | 9.254 us                  | 2.585 ms                  |
| OneStep                   | 371.724 ms                | 737.456 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.176 ms                  | 269.740 ms                |
| Forward                   | 9.318 ms                  | 22.171 ms                 |
| Backward                  | 313.750 ms                | 607.638 ms                |
| Optimize                  | 2.009 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.480 ms                  | 120.366 ms                |
| BlockToStepN              | 9.348 us                  | 2.585 ms                  |
| OneStep                   | 378.118 ms                | 737.456 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.521 ms                  | 269.740 ms                |
| Forward                   | 9.318 ms                  | 22.171 ms                 |
| Backward                  | 343.266 ms                | 781.141 ms                |
| Optimize                  | 2.009 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.271 ms                  | 120.366 ms                |
| BlockToStepN              | 9.354 us                  | 2.585 ms                  |
| OneStep                   | 389.402 ms                | 800.754 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.521 ms                  | 269.740 ms                |
| Forward                   | 9.318 ms                  | 22.171 ms                 |
| Backward                  | 351.808 ms                | 781.141 ms                |
| Optimize                  | 2.012 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 6.399 ms                  | 171.683 ms                |
| BlockToStepN              | 9.514 us                  | 2.585 ms                  |
| OneStep                   | 403.500 ms                | 806.215 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.540 ms                  | 244.360 ms                |
| Forward                   | 9.293 ms                  | 14.636 ms                 |
| Backward                  | 355.558 ms                | 695.410 ms                |
| Optimize                  | 2.012 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.399 ms                  | 171.683 ms                |
| BlockToStepN              | 9.517 us                  | 76.966 us                 |
| OneStep                   | 412.100 ms                | 926.570 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.540 ms                  | 244.360 ms                |
| Forward                   | 9.317 ms                  | 14.636 ms                 |
| Backward                  | 367.605 ms                | 725.088 ms                |
| Optimize                  | 2.016 ms                  | 2.990 ms                  |
| BarrierTimeBeforeRank0    | 6.271 ms                  | 172.389 ms                |
| BlockToStepN              | 9.579 us                  | 82.044 us                 |
| OneStep                   | 427.408 ms                | 926.570 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.654 ms                  | 244.360 ms                |
| Forward                   | 9.318 ms                  | 14.636 ms                 |
| Backward                  | 382.334 ms                | 781.522 ms                |
| Optimize                  | 2.018 ms                  | 2.998 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 172.389 ms                |
| BlockToStepN              | 9.698 us                  | 82.044 us                 |
| OneStep                   | 429.478 ms                | 968.112 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.065 ms                  | 244.360 ms                |
| Forward                   | 9.317 ms                  | 14.636 ms                 |
| Backward                  | 393.712 ms                | 781.522 ms                |
| Optimize                  | 2.016 ms                  | 2.998 ms                  |
| BarrierTimeBeforeRank0    | 4.975 ms                  | 172.389 ms                |
| BlockToStepN              | 9.825 us                  | 82.044 us                 |
| OneStep                   | 441.467 ms                | 968.112 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.712 ms                  | 244.360 ms                |
| Forward                   | 9.298 ms                  | 14.636 ms                 |
| Backward                  | 403.586 ms                | 784.913 ms                |
| Optimize                  | 2.018 ms                  | 2.998 ms                  |
| BarrierTimeBeforeRank0    | 5.570 ms                  | 229.881 ms                |
| BlockToStepN              | 9.825 us                  | 82.044 us                 |
| OneStep                   | 447.730 ms                | 984.563 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.077 ms                  | 244.360 ms                |
| Forward                   | 9.298 ms                  | 14.636 ms                 |
| Backward                  | 417.491 ms                | 810.354 ms                |
| Optimize                  | 2.018 ms                  | 2.998 ms                  |
| BarrierTimeBeforeRank0    | 5.570 ms                  | 259.830 ms                |
| BlockToStepN              | 9.998 us                  | 82.044 us                 |
| OneStep                   | 461.656 ms                | 1.079 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.077 ms                  | 244.360 ms                |
| Forward                   | 9.298 ms                  | 14.636 ms                 |
| Backward                  | 424.267 ms                | 864.489 ms                |
| Optimize                  | 2.023 ms                  | 3.013 ms                  |
| BarrierTimeBeforeRank0    | 5.570 ms                  | 259.830 ms                |
| BlockToStepN              | 10.151 us                 | 673.920 us                |
| OneStep                   | 471.757 ms                | 1.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.077 ms                  | 244.360 ms                |
| Forward                   | 9.317 ms                  | 14.636 ms                 |
| Backward                  | 448.376 ms                | 864.489 ms                |
| Optimize                  | 2.018 ms                  | 3.013 ms                  |
| BarrierTimeBeforeRank0    | 5.570 ms                  | 259.830 ms                |
| BlockToStepN              | 10.151 us                 | 673.920 us                |
| OneStep                   | 484.193 ms                | 1.111 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 75.346, sample: 2.038, forward: 1.472, backward: 67.629, update: 0.199
[proc 3] 200 steps, total: 75.346, sample: 1.195, forward: 1.419, backward: 67.632, update: 0.220
[proc 2] 200 steps, total: 75.346, sample: 1.791, forward: 1.391, backward: 65.577, update: 0.236
[proc 0] 200 steps, total: 75.346, sample: 2.156, forward: 0.937, backward: 68.501, update: 0.195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.432 ms                  | 244.360 ms                |
| Forward                   | 9.318 ms                  | 14.636 ms                 |
| Backward                  | 453.859 ms                | 893.982 ms                |
| Optimize                  | 2.012 ms                  | 3.013 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 259.830 ms                |
| BlockToStepN              | 10.151 us                 | 673.920 us                |
| OneStep                   | 498.546 ms                | 1.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.222 ms                  | 244.360 ms                |
| Forward                   | 9.327 ms                  | 14.636 ms                 |
| Backward                  | 465.203 ms                | 918.697 ms                |
| Optimize                  | 2.012 ms                  | 3.013 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 259.830 ms                |
| BlockToStepN              | 10.243 us                 | 673.920 us                |
| OneStep                   | 514.289 ms                | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.432 ms                  | 244.360 ms                |
| Forward                   | 9.328 ms                  | 14.636 ms                 |
| Backward                  | 473.961 ms                | 1.101 s                   |
| Optimize                  | 2.012 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 259.830 ms                |
| BlockToStepN              | 10.312 us                 | 673.920 us                |
| OneStep                   | 527.026 ms                | 1.123 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.432 ms                  | 244.360 ms                |
| Forward                   | 9.336 ms                  | 14.636 ms                 |
| Backward                  | 485.794 ms                | 1.101 s                   |
| Optimize                  | 2.016 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.975 ms                  | 259.830 ms                |
| BlockToStepN              | 10.781 us                 | 1.508 ms                  |
| OneStep                   | 547.836 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.432 ms                  | 244.360 ms                |
| Forward                   | 9.327 ms                  | 14.636 ms                 |
| Backward                  | 508.692 ms                | 1.101 s                   |
| Optimize                  | 2.012 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 261.585 ms                |
| BlockToStepN              | 10.820 us                 | 1.508 ms                  |
| OneStep                   | 569.243 ms                | 1.219 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.743 ms                  | 244.360 ms                |
| Forward                   | 9.327 ms                  | 14.636 ms                 |
| Backward                  | 513.823 ms                | 1.118 s                   |
| Optimize                  | 2.009 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.971 ms                  | 261.585 ms                |
| BlockToStepN              | 10.869 us                 | 3.772 ms                  |
| OneStep                   | 580.455 ms                | 1.268 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.743 ms                  | 244.360 ms                |
| Forward                   | 9.336 ms                  | 14.636 ms                 |
| Backward                  | 522.177 ms                | 1.118 s                   |
| Optimize                  | 2.016 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.971 ms                  | 310.860 ms                |
| BlockToStepN              | 11.180 us                 | 3.772 ms                  |
| OneStep                   | 585.422 ms                | 1.340 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.743 ms                  | 244.360 ms                |
| Forward                   | 9.339 ms                  | 14.636 ms                 |
| Backward                  | 525.576 ms                | 1.118 s                   |
| Optimize                  | 2.022 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.943 ms                  | 310.860 ms                |
| BlockToStepN              | 11.332 us                 | 3.772 ms                  |
| OneStep                   | 591.353 ms                | 1.340 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.743 ms                  | 244.360 ms                |
| Forward                   | 9.351 ms                  | 14.636 ms                 |
| Backward                  | 533.783 ms                | 1.118 s                   |
| Optimize                  | 2.023 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.773 ms                  | 310.860 ms                |
| BlockToStepN              | 11.357 us                 | 3.772 ms                  |
| OneStep                   | 597.528 ms                | 1.340 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.049 ms                  | 244.360 ms                |
| Forward                   | 9.351 ms                  | 14.636 ms                 |
| Backward                  | 542.684 ms                | 1.258 s                   |
| Optimize                  | 2.023 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.533 ms                  | 310.860 ms                |
| BlockToStepN              | 11.357 us                 | 3.772 ms                  |
| OneStep                   | 617.171 ms                | 1.351 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.254 ms                  | 244.360 ms                |
| Forward                   | 9.356 ms                  | 14.636 ms                 |
| Backward                  | 553.158 ms                | 1.338 s                   |
| Optimize                  | 2.022 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.533 ms                  | 343.619 ms                |
| BlockToStepN              | 11.446 us                 | 3.772 ms                  |
| OneStep                   | 618.749 ms                | 1.435 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.674 ms                  | 244.360 ms                |
| Forward                   | 9.351 ms                  | 14.636 ms                 |
| Backward                  | 565.867 ms                | 1.338 s                   |
| Optimize                  | 2.023 ms                  | 3.487 ms                  |
| BarrierTimeBeforeRank0    | 4.773 ms                  | 356.767 ms                |
| BlockToStepN              | 11.488 us                 | 3.772 ms                  |
| OneStep                   | 630.130 ms                | 1.462 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.674 ms                  | 244.053 ms                |
| Forward                   | 9.351 ms                  | 13.522 ms                 |
| Backward                  | 575.324 ms                | 1.258 s                   |
| Optimize                  | 2.022 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.547 ms                  | 343.619 ms                |
| BlockToStepN              | 11.609 us                 | 2.585 ms                  |
| OneStep                   | 635.215 ms                | 1.435 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.674 ms                  | 244.053 ms                |
| Forward                   | 9.351 ms                  | 13.522 ms                 |
| Backward                  | 591.220 ms                | 1.338 s                   |
| Optimize                  | 2.024 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.424 ms                  | 343.619 ms                |
| BlockToStepN              | 11.638 us                 | 2.585 ms                  |
| OneStep                   | 649.060 ms                | 1.462 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.674 ms                  | 244.053 ms                |
| Forward                   | 9.360 ms                  | 13.522 ms                 |
| Backward                  | 596.542 ms                | 1.410 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.389 ms                  | 343.619 ms                |
| BlockToStepN              | 11.638 us                 | 2.585 ms                  |
| OneStep                   | 650.491 ms                | 1.462 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.955 ms                  | 244.053 ms                |
| Forward                   | 9.360 ms                  | 13.522 ms                 |
| Backward                  | 603.826 ms                | 1.410 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.389 ms                  | 343.619 ms                |
| BlockToStepN              | 11.639 us                 | 2.585 ms                  |
| OneStep                   | 661.257 ms                | 1.462 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.083 ms                  | 244.053 ms                |
| Forward                   | 9.360 ms                  | 13.522 ms                 |
| Backward                  | 605.624 ms                | 1.410 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.413 ms                  | 361.384 ms                |
| BlockToStepN              | 11.658 us                 | 2.585 ms                  |
| OneStep                   | 662.478 ms                | 1.579 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.083 ms                  | 244.053 ms                |
| Forward                   | 9.360 ms                  | 13.522 ms                 |
| Backward                  | 616.229 ms                | 1.439 s                   |
| Optimize                  | 2.027 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 4.136 ms                  | 361.384 ms                |
| BlockToStepN              | 11.666 us                 | 2.585 ms                  |
| OneStep                   | 666.427 ms                | 1.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.083 ms                  | 244.053 ms                |
| Forward                   | 9.376 ms                  | 13.522 ms                 |
| Backward                  | 627.805 ms                | 1.439 s                   |
| Optimize                  | 2.027 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 3.873 ms                  | 361.384 ms                |
| BlockToStepN              | 11.730 us                 | 2.585 ms                  |
| OneStep                   | 685.107 ms                | 1.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.231 ms                  | 244.053 ms                |
| Forward                   | 9.379 ms                  | 13.522 ms                 |
| Backward                  | 644.804 ms                | 1.439 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 3.347 ms                  | 361.384 ms                |
| BlockToStepN              | 11.824 us                 | 2.585 ms                  |
| OneStep                   | 689.113 ms                | 1.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 244.053 ms                |
| Forward                   | 9.384 ms                  | 13.522 ms                 |
| Backward                  | 648.437 ms                | 1.439 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.574 ms                  | 361.384 ms                |
| BlockToStepN              | 11.840 us                 | 2.585 ms                  |
| OneStep                   | 693.435 ms                | 1.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 244.053 ms                |
| Forward                   | 9.384 ms                  | 13.522 ms                 |
| Backward                  | 652.539 ms                | 1.601 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.574 ms                  | 361.384 ms                |
| BlockToStepN              | 11.857 us                 | 2.585 ms                  |
| OneStep                   | 700.834 ms                | 1.632 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.364 ms                  | 244.053 ms                |
| Forward                   | 9.389 ms                  | 13.522 ms                 |
| Backward                  | 652.649 ms                | 1.601 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 3.256 ms                  | 401.468 ms                |
| BlockToStepN              | 12.039 us                 | 2.585 ms                  |
| OneStep                   | 731.005 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.364 ms                  | 244.053 ms                |
| Forward                   | 9.394 ms                  | 13.522 ms                 |
| Backward                  | 660.583 ms                | 1.601 s                   |
| Optimize                  | 2.025 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.382 ms                  | 401.468 ms                |
| BlockToStepN              | 12.039 us                 | 2.585 ms                  |
| OneStep                   | 734.734 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 244.053 ms                |
| Forward                   | 9.394 ms                  | 13.522 ms                 |
| Backward                  | 672.306 ms                | 1.601 s                   |
| Optimize                  | 2.027 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.180 ms                  | 401.468 ms                |
| BlockToStepN              | 12.117 us                 | 2.585 ms                  |
| OneStep                   | 737.456 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 125.235, sample: 2.058, forward: 0.974, backward: 115.869, update: 0.206
[proc 2] 300 steps, total: 125.235, sample: 1.485, forward: 1.325, backward: 108.709, update: 0.221
[proc 1] 300 steps, total: 125.235, sample: 1.712, forward: 1.426, backward: 112.985, update: 0.209
[proc 3] 300 steps, total: 125.235, sample: 1.146, forward: 1.376, backward: 112.045, update: 0.220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.725 ms                  | 244.053 ms                |
| Forward                   | 9.400 ms                  | 13.522 ms                 |
| Backward                  | 676.312 ms                | 1.617 s                   |
| Optimize                  | 2.027 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.962 ms                  | 401.468 ms                |
| BlockToStepN              | 12.117 us                 | 2.585 ms                  |
| OneStep                   | 739.822 ms                | 1.733 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 244.053 ms                |
| Forward                   | 9.400 ms                  | 13.522 ms                 |
| Backward                  | 686.064 ms                | 1.617 s                   |
| Optimize                  | 2.028 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.056 ms                  | 401.468 ms                |
| BlockToStepN              | 12.172 us                 | 2.585 ms                  |
| OneStep                   | 748.277 ms                | 1.733 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.725 ms                  | 244.053 ms                |
| Forward                   | 9.402 ms                  | 13.522 ms                 |
| Backward                  | 695.410 ms                | 1.617 s                   |
| Optimize                  | 2.028 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.180 ms                  | 465.433 ms                |
| BlockToStepN              | 12.213 us                 | 2.585 ms                  |
| OneStep                   | 748.633 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.696 ms                  | 244.053 ms                |
| Forward                   | 9.402 ms                  | 13.522 ms                 |
| Backward                  | 713.664 ms                | 1.617 s                   |
| Optimize                  | 2.033 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 2.180 ms                  | 465.433 ms                |
| BlockToStepN              | 12.241 us                 | 2.585 ms                  |
| OneStep                   | 766.437 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.866 ms                  | 244.053 ms                |
| Forward                   | 9.403 ms                  | 13.522 ms                 |
| Backward                  | 721.354 ms                | 1.652 s                   |
| Optimize                  | 2.035 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.962 ms                  | 465.433 ms                |
| BlockToStepN              | 12.288 us                 | 2.585 ms                  |
| OneStep                   | 766.676 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.725 ms                  | 244.053 ms                |
| Forward                   | 9.410 ms                  | 13.522 ms                 |
| Backward                  | 721.670 ms                | 1.652 s                   |
| Optimize                  | 2.035 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.876 ms                  | 465.433 ms                |
| BlockToStepN              | 12.288 us                 | 2.585 ms                  |
| OneStep                   | 779.031 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.725 ms                  | 244.053 ms                |
| Forward                   | 9.410 ms                  | 13.522 ms                 |
| Backward                  | 728.843 ms                | 1.652 s                   |
| Optimize                  | 2.035 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.876 ms                  | 465.433 ms                |
| BlockToStepN              | 12.363 us                 | 2.585 ms                  |
| OneStep                   | 784.912 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.866 ms                  | 244.053 ms                |
| Forward                   | 9.414 ms                  | 13.522 ms                 |
| Backward                  | 734.915 ms                | 1.714 s                   |
| Optimize                  | 2.035 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 465.433 ms                |
| BlockToStepN              | 12.387 us                 | 2.585 ms                  |
| OneStep                   | 785.409 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.725 ms                  | 244.053 ms                |
| Forward                   | 9.415 ms                  | 13.522 ms                 |
| Backward                  | 743.643 ms                | 1.714 s                   |
| Optimize                  | 2.036 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.876 ms                  | 465.433 ms                |
| BlockToStepN              | 12.437 us                 | 2.585 ms                  |
| OneStep                   | 795.390 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.877 ms                  | 244.053 ms                |
| Forward                   | 9.420 ms                  | 13.522 ms                 |
| Backward                  | 749.223 ms                | 1.714 s                   |
| Optimize                  | 2.036 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.876 ms                  | 465.433 ms                |
| BlockToStepN              | 12.414 us                 | 2.585 ms                  |
| OneStep                   | 797.116 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.877 ms                  | 244.053 ms                |
| Forward                   | 9.420 ms                  | 13.522 ms                 |
| Backward                  | 753.489 ms                | 1.714 s                   |
| Optimize                  | 2.036 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 465.433 ms                |
| BlockToStepN              | 12.437 us                 | 2.585 ms                  |
| OneStep                   | 800.743 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.877 ms                  | 244.053 ms                |
| Forward                   | 9.420 ms                  | 13.522 ms                 |
| Backward                  | 763.485 ms                | 1.827 s                   |
| Optimize                  | 2.041 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 465.433 ms                |
| BlockToStepN              | 12.437 us                 | 2.585 ms                  |
| OneStep                   | 800.754 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.877 ms                  | 244.053 ms                |
| Forward                   | 9.422 ms                  | 13.522 ms                 |
| Backward                  | 768.844 ms                | 1.827 s                   |
| Optimize                  | 2.044 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 465.433 ms                |
| BlockToStepN              | 12.480 us                 | 2.585 ms                  |
| OneStep                   | 806.215 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.161 ms                  | 244.053 ms                |
| Forward                   | 9.429 ms                  | 13.522 ms                 |
| Backward                  | 773.796 ms                | 1.827 s                   |
| Optimize                  | 2.047 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 496.908 ms                |
| BlockToStepN              | 12.489 us                 | 2.585 ms                  |
| OneStep                   | 813.909 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.161 ms                  | 244.053 ms                |
| Forward                   | 9.429 ms                  | 13.522 ms                 |
| Backward                  | 775.723 ms                | 1.827 s                   |
| Optimize                  | 2.047 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.937 ms                  | 496.908 ms                |
| BlockToStepN              | 12.622 us                 | 2.585 ms                  |
| OneStep                   | 823.315 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.197 ms                  | 244.053 ms                |
| Forward                   | 9.429 ms                  | 13.522 ms                 |
| Backward                  | 781.141 ms                | 1.925 s                   |
| Optimize                  | 2.047 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 496.908 ms                |
| BlockToStepN              | 12.622 us                 | 2.585 ms                  |
| OneStep                   | 852.459 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.197 ms                  | 244.053 ms                |
| Forward                   | 9.432 ms                  | 13.522 ms                 |
| Backward                  | 781.522 ms                | 1.925 s                   |
| Optimize                  | 2.049 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 496.908 ms                |
| BlockToStepN              | 12.622 us                 | 2.585 ms                  |
| OneStep                   | 867.499 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.250 ms                  | 237.968 ms                |
| Forward                   | 9.432 ms                  | 12.887 ms                 |
| Backward                  | 781.975 ms                | 1.827 s                   |
| Optimize                  | 2.049 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 465.433 ms                |
| BlockToStepN              | 12.622 us                 | 1.508 ms                  |
| OneStep                   | 877.582 ms                | 2.092 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.250 ms                  | 237.968 ms                |
| Forward                   | 9.433 ms                  | 12.887 ms                 |
| Backward                  | 784.913 ms                | 1.827 s                   |
| Optimize                  | 2.049 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.876 ms                  | 496.908 ms                |
| BlockToStepN              | 12.662 us                 | 1.508 ms                  |
| OneStep                   | 877.663 ms                | 2.092 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.197 ms                  | 237.968 ms                |
| Forward                   | 9.439 ms                  | 12.887 ms                 |
| Backward                  | 805.803 ms                | 1.925 s                   |
| Optimize                  | 2.050 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 496.908 ms                |
| BlockToStepN              | 12.735 us                 | 1.508 ms                  |
| OneStep                   | 880.338 ms                | 2.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.250 ms                  | 237.968 ms                |
| Forward                   | 9.439 ms                  | 12.887 ms                 |
| Backward                  | 808.932 ms                | 1.925 s                   |
| Optimize                  | 2.053 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.868 ms                  | 507.028 ms                |
| BlockToStepN              | 12.788 us                 | 1.508 ms                  |
| OneStep                   | 880.971 ms                | 2.150 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.439 ms                  | 12.887 ms                 |
| Backward                  | 809.935 ms                | 1.925 s                   |
| Optimize                  | 2.050 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 507.028 ms                |
| BlockToStepN              | 12.788 us                 | 1.508 ms                  |
| OneStep                   | 882.914 ms                | 2.150 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.250 ms                  | 237.968 ms                |
| Forward                   | 9.439 ms                  | 13.522 ms                 |
| Backward                  | 824.365 ms                | 1.925 s                   |
| Optimize                  | 2.050 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 507.028 ms                |
| BlockToStepN              | 12.872 us                 | 1.508 ms                  |
| OneStep                   | 908.927 ms                | 2.150 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.250 ms                  | 237.968 ms                |
| Forward                   | 9.448 ms                  | 13.522 ms                 |
| Backward                  | 834.279 ms                | 1.985 s                   |
| Optimize                  | 2.053 ms                  | 3.109 ms                  |
| BarrierTimeBeforeRank0    | 1.748 ms                  | 507.028 ms                |
| BlockToStepN              | 12.958 us                 | 1.508 ms                  |
| OneStep                   | 909.810 ms                | 2.175 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.451 ms                  | 13.522 ms                 |
| Backward                  | 839.094 ms                | 2.065 s                   |
| Optimize                  | 2.053 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.103 ms                  | 507.028 ms                |
| BlockToStepN              | 12.958 us                 | 1.508 ms                  |
| OneStep                   | 922.152 ms                | 2.201 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.454 ms                  | 13.522 ms                 |
| Backward                  | 844.635 ms                | 2.065 s                   |
| Optimize                  | 2.053 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.103 ms                  | 507.028 ms                |
| BlockToStepN              | 12.958 us                 | 1.508 ms                  |
| OneStep                   | 926.570 ms                | 2.201 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.454 ms                  | 13.522 ms                 |
| Backward                  | 846.862 ms                | 2.065 s                   |
| Optimize                  | 2.053 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.103 ms                  | 540.948 ms                |
| BlockToStepN              | 13.007 us                 | 1.508 ms                  |
| OneStep                   | 931.374 ms                | 2.202 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.459 ms                  | 13.522 ms                 |
| Backward                  | 854.607 ms                | 2.153 s                   |
| Optimize                  | 2.054 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 540.948 ms                |
| BlockToStepN              | 13.012 us                 | 1.508 ms                  |
| OneStep                   | 941.532 ms                | 2.208 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.460 ms                  | 13.522 ms                 |
| Backward                  | 855.521 ms                | 2.153 s                   |
| Optimize                  | 2.054 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 977.345 us                | 540.948 ms                |
| BlockToStepN              | 13.017 us                 | 1.508 ms                  |
| OneStep                   | 942.124 ms                | 2.208 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.460 ms                  | 13.522 ms                 |
| Backward                  | 862.530 ms                | 2.153 s                   |
| Optimize                  | 2.057 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.653 ms                  | 540.948 ms                |
| BlockToStepN              | 13.051 us                 | 1.508 ms                  |
| OneStep                   | 960.067 ms                | 2.227 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.465 ms                  | 13.522 ms                 |
| Backward                  | 863.254 ms                | 2.153 s                   |
| Optimize                  | 2.057 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 1.103 ms                  | 540.948 ms                |
| BlockToStepN              | 13.333 us                 | 1.508 ms                  |
| OneStep                   | 964.001 ms                | 2.227 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.337 ms                  | 237.968 ms                |
| Forward                   | 9.465 ms                  | 13.522 ms                 |
| Backward                  | 864.489 ms                | 2.181 s                   |
| Optimize                  | 2.059 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 1.103 ms                  | 540.948 ms                |
| BlockToStepN              | 13.486 us                 | 1.508 ms                  |
| OneStep                   | 968.112 ms                | 2.274 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 873.675 ms                | 2.252 s                   |
| Optimize                  | 2.059 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 540.948 ms                |
| BlockToStepN              | 13.486 us                 | 1.508 ms                  |
| OneStep                   | 970.423 ms                | 2.289 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.460 ms                  | 13.522 ms                 |
| Backward                  | 882.098 ms                | 2.252 s                   |
| Optimize                  | 2.059 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 540.948 ms                |
| BlockToStepN              | 13.515 us                 | 1.508 ms                  |
| OneStep                   | 974.501 ms                | 2.289 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.460 ms                  | 13.522 ms                 |
| Backward                  | 891.809 ms                | 2.252 s                   |
| Optimize                  | 2.060 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 977.345 us                | 825.722 ms                |
| BlockToStepN              | 13.515 us                 | 1.508 ms                  |
| OneStep                   | 975.153 ms                | 2.307 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.557 ms                  | 237.968 ms                |
| Forward                   | 9.460 ms                  | 13.522 ms                 |
| Backward                  | 893.982 ms                | 2.262 s                   |
| Optimize                  | 2.060 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 825.722 ms                |
| BlockToStepN              | 13.586 us                 | 1.508 ms                  |
| OneStep                   | 976.207 ms                | 2.325 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 180.192, sample: 1.373, forward: 1.295, backward: 153.646, update: 0.237
[proc 3] 400 steps, total: 180.192, sample: 1.203, forward: 1.348, backward: 159.285, update: 0.224
[proc 1] 400 steps, total: 180.192, sample: 1.599, forward: 1.385, backward: 158.550, update: 0.213
[proc 0] 400 steps, total: 180.192, sample: 1.911, forward: 1.014, backward: 162.785, update: 0.212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 907.320 ms                | 2.286 s                   |
| Optimize                  | 2.061 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 828.398 us                | 825.722 ms                |
| BlockToStepN              | 13.597 us                 | 1.508 ms                  |
| OneStep                   | 984.563 ms                | 2.371 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 911.215 ms                | 2.286 s                   |
| Optimize                  | 2.060 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 825.722 ms                |
| BlockToStepN              | 13.586 us                 | 1.508 ms                  |
| OneStep                   | 993.546 ms                | 2.371 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.579 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 918.697 ms                | 2.286 s                   |
| Optimize                  | 2.060 ms                  | 3.139 ms                  |
| BarrierTimeBeforeRank0    | 952.087 us                | 825.722 ms                |
| BlockToStepN              | 13.586 us                 | 1.508 ms                  |
| OneStep                   | 1.016 s                   | 2.371 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 924.264 ms                | 2.300 s                   |
| Optimize                  | 2.060 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 828.398 us                | 825.722 ms                |
| BlockToStepN              | 13.597 us                 | 1.508 ms                  |
| OneStep                   | 1.019 s                   | 2.410 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 924.797 ms                | 2.328 s                   |
| Optimize                  | 2.061 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 13.632 us                 | 1.508 ms                  |
| OneStep                   | 1.021 s                   | 2.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 934.405 ms                | 2.328 s                   |
| Optimize                  | 2.061 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 736.153 us                | 825.722 ms                |
| BlockToStepN              | 13.646 us                 | 1.508 ms                  |
| OneStep                   | 1.025 s                   | 2.469 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 936.188 ms                | 2.328 s                   |
| Optimize                  | 2.061 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 736.153 us                | 825.722 ms                |
| BlockToStepN              | 13.646 us                 | 1.508 ms                  |
| OneStep                   | 1.029 s                   | 2.469 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 943.423 ms                | 2.328 s                   |
| Optimize                  | 2.065 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 736.153 us                | 825.722 ms                |
| BlockToStepN              | 13.837 us                 | 1.508 ms                  |
| OneStep                   | 1.032 s                   | 2.469 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 949.857 ms                | 2.351 s                   |
| Optimize                  | 2.066 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 13.878 us                 | 1.508 ms                  |
| OneStep                   | 1.038 s                   | 2.485 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.754 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 959.583 ms                | 2.351 s                   |
| Optimize                  | 2.066 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 736.153 us                | 825.722 ms                |
| BlockToStepN              | 13.878 us                 | 1.508 ms                  |
| OneStep                   | 1.038 s                   | 2.485 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 968.185 ms                | 2.351 s                   |
| Optimize                  | 2.067 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 828.398 us                | 825.722 ms                |
| BlockToStepN              | 13.904 us                 | 1.508 ms                  |
| OneStep                   | 1.041 s                   | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.157 ms                  | 237.968 ms                |
| Forward                   | 9.469 ms                  | 13.522 ms                 |
| Backward                  | 982.740 ms                | 2.351 s                   |
| Optimize                  | 2.067 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 14.019 us                 | 1.508 ms                  |
| OneStep                   | 1.042 s                   | 2.493 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.157 ms                  | 237.968 ms                |
| Forward                   | 9.469 ms                  | 13.522 ms                 |
| Backward                  | 989.981 ms                | 2.397 s                   |
| Optimize                  | 2.068 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 14.063 us                 | 1.508 ms                  |
| OneStep                   | 1.048 s                   | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.157 ms                  | 237.968 ms                |
| Forward                   | 9.467 ms                  | 13.522 ms                 |
| Backward                  | 994.439 ms                | 2.397 s                   |
| Optimize                  | 2.068 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 14.063 us                 | 1.508 ms                  |
| OneStep                   | 1.048 s                   | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.469 ms                  | 13.522 ms                 |
| Backward                  | 995.543 ms                | 2.397 s                   |
| Optimize                  | 2.068 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 14.100 us                 | 1.508 ms                  |
| OneStep                   | 1.066 s                   | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.470 ms                  | 13.522 ms                 |
| Backward                  | 996.495 ms                | 2.397 s                   |
| Optimize                  | 2.071 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 715.115 us                | 825.722 ms                |
| BlockToStepN              | 14.101 us                 | 1.508 ms                  |
| OneStep                   | 1.070 s                   | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.822 ms                  | 237.968 ms                |
| Forward                   | 9.472 ms                  | 13.522 ms                 |
| Backward                  | 998.071 ms                | 2.464 s                   |
| Optimize                  | 2.073 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.265 us                 | 1.508 ms                  |
| OneStep                   | 1.073 s                   | 2.596 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.157 ms                  | 237.968 ms                |
| Forward                   | 9.472 ms                  | 13.522 ms                 |
| Backward                  | 1.005 s                   | 2.464 s                   |
| Optimize                  | 2.073 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.335 us                 | 1.508 ms                  |
| OneStep                   | 1.077 s                   | 2.606 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.157 ms                  | 237.968 ms                |
| Forward                   | 9.474 ms                  | 13.522 ms                 |
| Backward                  | 1.009 s                   | 2.464 s                   |
| Optimize                  | 2.071 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.340 us                 | 1.508 ms                  |
| OneStep                   | 1.077 s                   | 2.606 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 237.968 ms                |
| Forward                   | 9.474 ms                  | 13.522 ms                 |
| Backward                  | 1.009 s                   | 2.464 s                   |
| Optimize                  | 2.071 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.335 us                 | 1.508 ms                  |
| OneStep                   | 1.079 s                   | 2.606 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 237.968 ms                |
| Forward                   | 9.478 ms                  | 13.522 ms                 |
| Backward                  | 1.010 s                   | 2.569 s                   |
| Optimize                  | 2.071 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 523.548 us                | 825.722 ms                |
| BlockToStepN              | 14.340 us                 | 1.508 ms                  |
| OneStep                   | 1.086 s                   | 2.660 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 237.968 ms                |
| Forward                   | 9.479 ms                  | 13.522 ms                 |
| Backward                  | 1.011 s                   | 2.569 s                   |
| Optimize                  | 2.068 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.340 us                 | 1.508 ms                  |
| OneStep                   | 1.091 s                   | 2.660 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.480 ms                  | 13.043 ms                 |
| Backward                  | 1.014 s                   | 2.569 s                   |
| Optimize                  | 2.071 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 825.722 ms                |
| BlockToStepN              | 14.370 us                 | 1.508 ms                  |
| OneStep                   | 1.094 s                   | 2.665 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.481 ms                  | 13.043 ms                 |
| Backward                  | 1.014 s                   | 2.515 s                   |
| Optimize                  | 2.073 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 660.633 us                | 655.545 ms                |
| BlockToStepN              | 14.433 us                 | 673.920 us                |
| OneStep                   | 1.096 s                   | 2.660 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.481 ms                  | 13.043 ms                 |
| Backward                  | 1.020 s                   | 2.569 s                   |
| Optimize                  | 2.073 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 523.548 us                | 655.545 ms                |
| BlockToStepN              | 14.490 us                 | 1.508 ms                  |
| OneStep                   | 1.097 s                   | 2.665 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.480 ms                  | 13.043 ms                 |
| Backward                  | 1.021 s                   | 2.569 s                   |
| Optimize                  | 2.073 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 523.548 us                | 655.545 ms                |
| BlockToStepN              | 14.490 us                 | 1.508 ms                  |
| OneStep                   | 1.099 s                   | 2.682 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.480 ms                  | 13.043 ms                 |
| Backward                  | 1.024 s                   | 2.569 s                   |
| Optimize                  | 2.074 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 655.545 ms                |
| BlockToStepN              | 14.779 us                 | 1.508 ms                  |
| OneStep                   | 1.113 s                   | 2.682 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.480 ms                  | 13.043 ms                 |
| Backward                  | 1.053 s                   | 2.569 s                   |
| Optimize                  | 2.074 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 655.545 ms                |
| BlockToStepN              | 14.740 us                 | 1.508 ms                  |
| OneStep                   | 1.117 s                   | 2.682 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.481 ms                  | 13.043 ms                 |
| Backward                  | 1.059 s                   | 2.585 s                   |
| Optimize                  | 2.075 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 655.545 ms                |
| BlockToStepN              | 14.779 us                 | 1.508 ms                  |
| OneStep                   | 1.121 s                   | 2.685 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.485 ms                  | 13.043 ms                 |
| Backward                  | 1.063 s                   | 2.585 s                   |
| Optimize                  | 2.075 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 523.548 us                | 686.578 ms                |
| BlockToStepN              | 14.846 us                 | 1.508 ms                  |
| OneStep                   | 1.123 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.485 ms                  | 13.043 ms                 |
| Backward                  | 1.072 s                   | 2.585 s                   |
| Optimize                  | 2.075 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 523.548 us                | 686.578 ms                |
| BlockToStepN              | 14.847 us                 | 1.508 ms                  |
| OneStep                   | 1.132 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.256 ms                  | 227.246 ms                |
| Forward                   | 9.485 ms                  | 13.043 ms                 |
| Backward                  | 1.074 s                   | 2.585 s                   |
| Optimize                  | 2.078 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 686.578 ms                |
| BlockToStepN              | 14.847 us                 | 1.508 ms                  |
| OneStep                   | 1.137 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.485 ms                  | 13.043 ms                 |
| Backward                  | 1.075 s                   | 2.607 s                   |
| Optimize                  | 2.078 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 686.578 ms                |
| BlockToStepN              | 14.858 us                 | 1.508 ms                  |
| OneStep                   | 1.141 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.486 ms                  | 13.043 ms                 |
| Backward                  | 1.076 s                   | 2.607 s                   |
| Optimize                  | 2.078 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 686.578 ms                |
| BlockToStepN              | 14.858 us                 | 1.508 ms                  |
| OneStep                   | 1.148 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.486 ms                  | 13.043 ms                 |
| Backward                  | 1.077 s                   | 2.607 s                   |
| Optimize                  | 2.078 ms                  | 3.229 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 686.578 ms                |
| BlockToStepN              | 14.847 us                 | 1.508 ms                  |
| OneStep                   | 1.152 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.488 ms                  | 13.043 ms                 |
| Backward                  | 1.088 s                   | 2.607 s                   |
| Optimize                  | 2.078 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 686.578 ms                |
| BlockToStepN              | 14.858 us                 | 1.508 ms                  |
| OneStep                   | 1.160 s                   | 2.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.486 ms                  | 13.043 ms                 |
| Backward                  | 1.095 s                   | 2.641 s                   |
| Optimize                  | 2.079 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 686.578 ms                |
| BlockToStepN              | 14.875 us                 | 1.508 ms                  |
| OneStep                   | 1.162 s                   | 2.738 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.488 ms                  | 13.043 ms                 |
| Backward                  | 1.096 s                   | 2.641 s                   |
| Optimize                  | 2.079 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 686.578 ms                |
| BlockToStepN              | 14.908 us                 | 1.508 ms                  |
| OneStep                   | 1.170 s                   | 2.738 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.494 ms                  | 13.043 ms                 |
| Backward                  | 1.098 s                   | 2.641 s                   |
| Optimize                  | 2.079 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 713.975 ms                |
| BlockToStepN              | 14.909 us                 | 1.508 ms                  |
| OneStep                   | 1.177 s                   | 2.859 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.268 ms                  | 227.246 ms                |
| Forward                   | 9.494 ms                  | 13.043 ms                 |
| Backward                  | 1.101 s                   | 2.641 s                   |
| Optimize                  | 2.080 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 713.975 ms                |
| BlockToStepN              | 14.909 us                 | 1.508 ms                  |
| OneStep                   | 1.178 s                   | 2.859 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.494 ms                  | 13.043 ms                 |
| Backward                  | 1.104 s                   | 2.673 s                   |
| Optimize                  | 2.081 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 328.614 us                | 713.975 ms                |
| BlockToStepN              | 14.909 us                 | 1.508 ms                  |
| OneStep                   | 1.178 s                   | 2.862 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.660 ms                  | 227.246 ms                |
| Forward                   | 9.494 ms                  | 13.043 ms                 |
| Backward                  | 1.104 s                   | 2.673 s                   |
| Optimize                  | 2.080 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 109.563 us                | 713.975 ms                |
| BlockToStepN              | 14.909 us                 | 1.508 ms                  |
| OneStep                   | 1.181 s                   | 2.862 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.660 ms                  | 227.246 ms                |
| Forward                   | 9.500 ms                  | 13.043 ms                 |
| Backward                  | 1.118 s                   | 2.673 s                   |
| Optimize                  | 2.080 ms                  | 3.231 ms                  |
| BarrierTimeBeforeRank0    | 109.563 us                | 713.975 ms                |
| BlockToStepN              | 15.046 us                 | 1.508 ms                  |
| OneStep                   | 1.191 s                   | 2.862 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.500 ms                  | 13.043 ms                 |
| Backward                  | 1.124 s                   | 2.673 s                   |
| Optimize                  | 2.081 ms                  | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 713.975 ms                |
| BlockToStepN              | 15.133 us                 | 1.508 ms                  |
| OneStep                   | 1.205 s                   | 2.915 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.501 ms                  | 13.043 ms                 |
| Backward                  | 1.127 s                   | 2.744 s                   |
| Optimize                  | 2.081 ms                  | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 713.975 ms                |
| BlockToStepN              | 15.204 us                 | 1.508 ms                  |
| OneStep                   | 1.216 s                   | 2.917 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.503 ms                  | 13.043 ms                 |
| Backward                  | 1.138 s                   | 2.744 s                   |
| Optimize                  | 2.081 ms                  | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 126.762 us                | 713.975 ms                |
| BlockToStepN              | 15.252 us                 | 1.508 ms                  |
| OneStep                   | 1.219 s                   | 2.917 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.491 ms                  | 227.246 ms                |
| Forward                   | 9.509 ms                  | 13.043 ms                 |
| Backward                  | 1.144 s                   | 2.744 s                   |
| Optimize                  | 2.082 ms                  | 3.244 ms                  |
| BarrierTimeBeforeRank0    | 109.563 us                | 713.975 ms                |
| BlockToStepN              | 15.264 us                 | 1.508 ms                  |
| OneStep                   | 1.220 s                   | 2.917 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 230.501, sample: 1.661, forward: 0.992, backward: 211.941, update: 0.219
[proc 2] 500 steps, total: 230.501, sample: 1.300, forward: 1.247, backward: 199.083, update: 0.235
[proc 1] 500 steps, total: 230.501, sample: 1.506, forward: 1.382, backward: 205.145, update: 0.214
[proc 3] 500 steps, total: 230.501, sample: 1.231, forward: 1.366, backward: 205.938, update: 0.234
Successfully xmh. training takes 640.1086783409119 seconds
before call kg_cache_controller.StopThreads()
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
INFO [57776 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
