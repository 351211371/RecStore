WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 21:32:30.719669 23675 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_35', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23675 sampler.py:454] Start PreSampling
WARNING [23675 sampler.py:532] Before construct renumbering_dict
WARNING [23675 sampler.py:555] PreSampling done
W20240123 21:45:25.390173 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 21:45:25.390393 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 21:45:25.390425 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 21:45:25.390450 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 21:45:25.390475 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 21:45:25.390498 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 21:45:25.390518 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 21:45:25.390550 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 21:45:25.390568 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 21:45:25.390595 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 21:45:25.390635 23675 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 21:45:25.390655 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 21:45:25.390684 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 21:45:25.390820 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 21:45:25.390848 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 21:45:25.390877 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 21:45:25.390893 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 21:45:25.390921 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 21:45:25.390938 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 21:45:25.390961 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 21:45:25.390980 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 21:45:25.391010 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 21:45:25.391032 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 21:45:25.391052 23675 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 21:45:25.391065 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 21:45:25.391085 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 21:45:25.391130 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240123 21:45:25.391152 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240123 21:45:25.391175 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240123 21:45:25.391198 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240123 21:45:25.391216 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240123 21:45:25.391230 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240123 21:45:25.391258 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240123 21:45:25.391295 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240123 21:45:25.391319 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240123 21:45:25.391342 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240123 21:45:25.391364 23675 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240123 21:45:25.391377 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240123 21:45:25.391395 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240123 21:45:25.391436 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240123 21:45:25.391467 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240123 21:45:25.391498 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240123 21:45:25.391517 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240123 21:45:25.391551 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240123 21:45:25.391575 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240123 21:45:25.391593 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240123 21:45:25.391615 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240123 21:45:25.391635 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240123 21:45:25.391659 23675 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240123 21:45:25.391680 23675 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240123 21:45:25.391692 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240123 21:45:25.391710 23675 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240123 21:45:25.747009 23675 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100001ee2000 128.2 GB
W20240123 21:45:25.747198 23675 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102010b1a000 328.3 MB
{0: Graph(num_nodes=27256011, num_edges=100992629,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23779591, num_edges=94535774,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=26463902, num_edges=75890617,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=25398646, num_edges=93789131,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27256011 N 100992629 E
MertisPartition: part 1 has 23779591 N 94535774 E
MertisPartition: part 2 has 26463902 N 75890617 E
MertisPartition: part 3 has 25398646 N 93789131 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 4302721,  4302747,   251996,  ...,  3581496, 12396959, 84822095]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 950.794 seconds
[Rank1] pid = 47815
[Rank2] pid = 48042
INFO [23675 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [48042 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [47815 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48119 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [48042 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48119 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [47815 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48042 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [48119 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [47815 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [48042 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [48042 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [47815 cache_common.py:137] TorchNativeStdEmb construct done
INFO [48119 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [47815 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48119 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [23675 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [23675 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [23675 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [23675 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 21:48:25.530629 48183 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 21:48:25.530786 48120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 21:48:25.530952 48043 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 21:48:25.531072 47816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 21:48:36.627156 48043 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 21:48:39.341581 47816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 21:48:40.764441 48120 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 21:48:42.056857 48183 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.768 ms                  | 62.193 ms                 |
| Forward                   | 7.746 ms                  | 570.544 ms                |
| Backward                  | 64.896 ms                 | 168.593 ms                |
| Optimize                  | 1.859 ms                  | 3.400 ms                  |
| BarrierTimeBeforeRank0    | 18.112 ms                 | 77.908 ms                 |
| BlockToStepN              | 8.288 us                  | 86.579 us                 |
| OneStep                   | 96.084 ms                 | 836.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.019 ms                  | 53.909 ms                 |
| Forward                   | 7.816 ms                  | 8.763 ms                  |
| Backward                  | 110.939 ms                | 199.530 ms                |
| Optimize                  | 1.839 ms                  | 2.185 ms                  |
| BarrierTimeBeforeRank0    | 10.058 ms                 | 42.462 ms                 |
| BlockToStepN              | 7.679 us                  | 39.007 us                 |
| OneStep                   | 141.574 ms                | 241.616 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.843 ms                  | 53.909 ms                 |
| Forward                   | 7.816 ms                  | 8.763 ms                  |
| Backward                  | 145.211 ms                | 265.722 ms                |
| Optimize                  | 1.790 ms                  | 2.185 ms                  |
| BarrierTimeBeforeRank0    | 7.893 ms                  | 42.462 ms                 |
| BlockToStepN              | 7.874 us                  | 39.007 us                 |
| OneStep                   | 175.926 ms                | 330.289 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.019 ms                  | 61.467 ms                 |
| Forward                   | 7.810 ms                  | 8.891 ms                  |
| Backward                  | 168.593 ms                | 386.197 ms                |
| Optimize                  | 1.772 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 5.742 ms                  | 42.462 ms                 |
| BlockToStepN              | 8.165 us                  | 39.007 us                 |
| OneStep                   | 191.356 ms                | 408.486 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.095, sample: 0.825, forward: 1.974, backward: 18.832, update: 0.162
[Rank3] pid = 48119
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([  855481,  4497076,   855510,   855529,   855548,   855569, 54602338,
          157407,  4308422,   855595]) tensor([ 4768592, 23144698, 25470720, 47317545, 62710692, 31220909, 83197926,
        60657905, 46242011, 37643692])
-------Step 1-------
tensor([  855481,  4497076,   855510,   855529,   855548,   855569, 54602338,
          157407,  4308422,   855595]) tensor([24151789, 30195960, 19681466, 83755713, 63766822, 29226202, 59784940,
        29267952, 19703696, 52170787])
-------Step 2-------
tensor([  906967,   906994,   907019,   907043,   907066, 28987716,   318913,
          722209,   907090,   907118]) tensor([10263416, 29210604, 34773388, 47712920, 45145414,  5866117,  7084491,
        48459064, 72822249, 79765337])
-------Step 3-------
tensor([  906967,   906994,   907019,   907043,   907066, 28987716,   318913,
          722209,   907090,   907118]) tensor([56453321, 48300716, 75780101, 56365028, 11644614, 19873328, 37789306,
         1741892, 34540818, 14961887])
-------Step 4-------
tensor([958773, 958798, 958821, 958852, 958870, 958889, 958924, 971849, 958950,
        729128]) tensor([72122752, 58957124, 68311522, 33616179, 80820929, 15716184, 26965247,
         5361908, 38371296,  4741334])
-------Step 5-------
tensor([958773, 958798, 958821, 958852, 958870, 958889, 958924, 971849, 958950,
        729128]) tensor([30168856, 74472244, 21200412, 23120816, 37333225, 13287375, 38511425,
        74499452,  1004543, 85635968])
-------Step 6-------
tensor([ 1010132,  1010145,  1010167, 73028859,   322491,  1010186,  1010210,
         1010234,  1010254,  1010284]) tensor([ 9561065, 76480111, 82964804, 63089605, 82515904, 33589152, 65834900,
          686508, 51993083, 52919465])
-------Step 7-------
tensor([ 1010132,  1010145,  1010167, 73028859,   322491,  1010186,  1010210,
         1010234,  1010254,  1010284]) tensor([15455870, 75264481, 74067319, 81945218, 70938654, 37552008, 71071187,
        65007327, 74936579, 74814604])
-------Step 8-------
tensor([ 1040966,  1040973,  1040982,  1040989, 62365629,   739159,  1041000,
          739171,   612026,  1041007]) tensor([  510987, 31982953, 67955937, 52644936, 12204538,  1692065, 56112482,
        38378905, 23375204, 63640040])
-------Step 9-------
tensor([ 1040966,  1040973,  1040982,  1040989, 62365629,   739159,  1041000,
          739171,   612026,  1041007]) tensor([61033591, 63467090,  4497147, 15318069, 41410135, 38349265, 29794786,
        14371982, 11114424, 10297713])
before start barrier
start train
[proc 0] 100 steps, total: 24.387, sample: 0.805, forward: 1.332, backward: 19.296, update: 0.167
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.810, sample: 1.177, forward: 2.048, backward: 18.656, update: 0.178
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.524, sample: 0.815, forward: 1.939, backward: 18.551, update: 0.178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.032 ms                  | 61.467 ms                 |
| Forward                   | 7.760 ms                  | 8.891 ms                  |
| Backward                  | 189.884 ms                | 386.197 ms                |
| Optimize                  | 1.771 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 7.040 ms                  | 153.162 ms                |
| BlockToStepN              | 8.750 us                  | 40.751 us                 |
| OneStep                   | 220.021 ms                | 566.233 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.140 ms                  | 61.467 ms                 |
| Forward                   | 7.778 ms                  | 8.891 ms                  |
| Backward                  | 213.771 ms                | 405.386 ms                |
| Optimize                  | 1.741 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 6.816 ms                  | 153.162 ms                |
| BlockToStepN              | 8.805 us                  | 40.751 us                 |
| OneStep                   | 237.627 ms                | 566.233 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.140 ms                  | 62.193 ms                 |
| Forward                   | 7.787 ms                  | 8.891 ms                  |
| Backward                  | 230.398 ms                | 448.873 ms                |
| Optimize                  | 1.735 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 5.488 ms                  | 153.162 ms                |
| BlockToStepN              | 8.905 us                  | 40.751 us                 |
| OneStep                   | 255.117 ms                | 566.233 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.196 ms                  | 62.193 ms                 |
| Forward                   | 7.778 ms                  | 9.967 ms                  |
| Backward                  | 250.035 ms                | 472.970 ms                |
| Optimize                  | 1.739 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 4.740 ms                  | 153.162 ms                |
| BlockToStepN              | 9.133 us                  | 40.751 us                 |
| OneStep                   | 271.792 ms                | 604.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.206 ms                  | 62.220 ms                 |
| Forward                   | 7.746 ms                  | 9.967 ms                  |
| Backward                  | 265.722 ms                | 507.219 ms                |
| Optimize                  | 1.739 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 5.174 ms                  | 153.162 ms                |
| BlockToStepN              | 9.133 us                  | 40.751 us                 |
| OneStep                   | 292.314 ms                | 604.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.317 ms                  | 62.220 ms                 |
| Forward                   | 7.731 ms                  | 8.891 ms                  |
| Backward                  | 281.086 ms                | 539.255 ms                |
| Optimize                  | 1.729 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 5.343 ms                  | 116.301 ms                |
| BlockToStepN              | 9.221 us                  | 40.751 us                 |
| OneStep                   | 320.381 ms                | 635.693 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.333 ms                  | 62.220 ms                 |
| Forward                   | 7.758 ms                  | 8.891 ms                  |
| Backward                  | 300.806 ms                | 573.285 ms                |
| Optimize                  | 1.723 ms                  | 2.380 ms                  |
| BarrierTimeBeforeRank0    | 3.430 ms                  | 116.301 ms                |
| BlockToStepN              | 9.225 us                  | 45.392 us                 |
| OneStep                   | 329.324 ms                | 635.693 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.333 ms                  | 64.091 ms                 |
| Forward                   | 7.742 ms                  | 9.219 ms                  |
| Backward                  | 309.786 ms                | 593.934 ms                |
| Optimize                  | 1.728 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 2.975 ms                  | 116.301 ms                |
| BlockToStepN              | 9.386 us                  | 45.392 us                 |
| OneStep                   | 348.373 ms                | 718.974 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.333 ms                  | 64.091 ms                 |
| Forward                   | 7.746 ms                  | 9.219 ms                  |
| Backward                  | 329.955 ms                | 622.360 ms                |
| Optimize                  | 1.721 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 3.088 ms                  | 116.301 ms                |
| BlockToStepN              | 9.466 us                  | 45.392 us                 |
| OneStep                   | 360.453 ms                | 718.974 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.419 ms                  | 64.091 ms                 |
| Forward                   | 7.746 ms                  | 9.219 ms                  |
| Backward                  | 335.512 ms                | 685.831 ms                |
| Optimize                  | 1.721 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 2.975 ms                  | 153.162 ms                |
| BlockToStepN              | 9.466 us                  | 45.392 us                 |
| OneStep                   | 373.793 ms                | 836.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.431 ms                  | 64.091 ms                 |
| Forward                   | 7.736 ms                  | 9.219 ms                  |
| Backward                  | 345.905 ms                | 757.443 ms                |
| Optimize                  | 1.723 ms                  | 2.462 ms                  |
| BarrierTimeBeforeRank0    | 2.975 ms                  | 153.162 ms                |
| BlockToStepN              | 9.498 us                  | 86.381 us                 |
| OneStep                   | 384.916 ms                | 879.567 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.431 ms                  | 64.091 ms                 |
| Forward                   | 7.758 ms                  | 9.219 ms                  |
| Backward                  | 358.927 ms                | 757.443 ms                |
| Optimize                  | 1.723 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 3.088 ms                  | 192.009 ms                |
| BlockToStepN              | 9.552 us                  | 86.381 us                 |
| OneStep                   | 406.022 ms                | 893.012 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 58.516, sample: 0.834, forward: 1.163, backward: 52.557, update: 0.184
[proc 0] 200 steps, total: 58.516, sample: 0.988, forward: 0.771, backward: 54.720, update: 0.163
[proc 1] 200 steps, total: 58.516, sample: 1.605, forward: 1.314, backward: 52.746, update: 0.184
[proc 3] 200 steps, total: 58.516, sample: 0.913, forward: 1.227, backward: 53.269, update: 0.165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.593 ms                  | 64.091 ms                 |
| Forward                   | 7.765 ms                  | 9.219 ms                  |
| Backward                  | 370.879 ms                | 757.443 ms                |
| Optimize                  | 1.719 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.975 ms                  | 192.009 ms                |
| BlockToStepN              | 9.599 us                  | 86.381 us                 |
| OneStep                   | 407.820 ms                | 893.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.446 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.219 ms                  |
| Backward                  | 383.576 ms                | 757.443 ms                |
| Optimize                  | 1.723 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.678 ms                  | 192.009 ms                |
| BlockToStepN              | 9.927 us                  | 86.381 us                 |
| OneStep                   | 422.350 ms                | 893.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.768 ms                  | 64.091 ms                 |
| Forward                   | 7.787 ms                  | 9.219 ms                  |
| Backward                  | 386.197 ms                | 890.982 ms                |
| Optimize                  | 1.729 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.545 ms                  | 192.009 ms                |
| BlockToStepN              | 9.970 us                  | 86.381 us                 |
| OneStep                   | 426.134 ms                | 908.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.883 ms                  | 64.091 ms                 |
| Forward                   | 7.790 ms                  | 9.219 ms                  |
| Backward                  | 405.092 ms                | 890.982 ms                |
| Optimize                  | 1.731 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.545 ms                  | 192.009 ms                |
| BlockToStepN              | 9.973 us                  | 86.579 us                 |
| OneStep                   | 429.332 ms                | 908.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.883 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.219 ms                  |
| Backward                  | 411.756 ms                | 890.982 ms                |
| Optimize                  | 1.731 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.678 ms                  | 204.401 ms                |
| BlockToStepN              | 10.018 us                 | 86.579 us                 |
| OneStep                   | 441.321 ms                | 1.018 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.049 ms                  | 64.091 ms                 |
| Forward                   | 7.787 ms                  | 9.219 ms                  |
| Backward                  | 416.887 ms                | 890.982 ms                |
| Optimize                  | 1.729 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 204.401 ms                |
| BlockToStepN              | 10.141 us                 | 91.913 us                 |
| OneStep                   | 448.285 ms                | 1.018 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.883 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.219 ms                  |
| Backward                  | 427.252 ms                | 964.125 ms                |
| Optimize                  | 1.731 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.545 ms                  | 204.401 ms                |
| BlockToStepN              | 10.198 us                 | 91.913 us                 |
| OneStep                   | 475.457 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.883 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.219 ms                  |
| Backward                  | 437.453 ms                | 964.125 ms                |
| Optimize                  | 1.728 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 204.401 ms                |
| BlockToStepN              | 10.179 us                 | 91.913 us                 |
| OneStep                   | 478.490 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.068 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.219 ms                  |
| Backward                  | 457.995 ms                | 964.125 ms                |
| Optimize                  | 1.723 ms                  | 2.526 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 225.135 ms                |
| BlockToStepN              | 10.198 us                 | 91.913 us                 |
| OneStep                   | 483.647 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.049 ms                  | 62.471 ms                 |
| Forward                   | 7.767 ms                  | 9.134 ms                  |
| Backward                  | 463.486 ms                | 940.721 ms                |
| Optimize                  | 1.728 ms                  | 2.497 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 206.655 ms                |
| BlockToStepN              | 10.250 us                 | 86.579 us                 |
| OneStep                   | 493.042 ms                | 1.049 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.068 ms                  | 62.471 ms                 |
| Forward                   | 7.778 ms                  | 9.217 ms                  |
| Backward                  | 467.014 ms                | 964.125 ms                |
| Optimize                  | 1.729 ms                  | 2.497 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 226.422 ms                |
| BlockToStepN              | 10.210 us                 | 86.579 us                 |
| OneStep                   | 502.709 ms                | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.068 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.217 ms                  |
| Backward                  | 472.970 ms                | 964.125 ms                |
| Optimize                  | 1.723 ms                  | 2.497 ms                  |
| BarrierTimeBeforeRank0    | 2.671 ms                  | 226.422 ms                |
| BlockToStepN              | 10.250 us                 | 86.579 us                 |
| OneStep                   | 511.179 ms                | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.134 ms                  | 64.091 ms                 |
| Forward                   | 7.780 ms                  | 9.217 ms                  |
| Backward                  | 484.524 ms                | 964.125 ms                |
| Optimize                  | 1.723 ms                  | 2.497 ms                  |
| BarrierTimeBeforeRank0    | 2.384 ms                  | 226.422 ms                |
| BlockToStepN              | 10.251 us                 | 86.579 us                 |
| OneStep                   | 520.984 ms                | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.260 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.217 ms                  |
| Backward                  | 490.016 ms                | 1.108 s                   |
| Optimize                  | 1.729 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.232 ms                  | 240.617 ms                |
| BlockToStepN              | 10.272 us                 | 86.579 us                 |
| OneStep                   | 538.641 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.134 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.217 ms                  |
| Backward                  | 496.030 ms                | 1.108 s                   |
| Optimize                  | 1.729 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.232 ms                  | 240.617 ms                |
| BlockToStepN              | 10.496 us                 | 86.579 us                 |
| OneStep                   | 545.405 ms                | 1.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.260 ms                  | 64.091 ms                 |
| Forward                   | 7.780 ms                  | 9.217 ms                  |
| Backward                  | 499.668 ms                | 1.108 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.384 ms                  | 297.708 ms                |
| BlockToStepN              | 10.496 us                 | 86.579 us                 |
| OneStep                   | 551.792 ms                | 1.308 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.290 ms                  | 64.091 ms                 |
| Forward                   | 7.780 ms                  | 9.217 ms                  |
| Backward                  | 504.391 ms                | 1.108 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.232 ms                  | 297.708 ms                |
| BlockToStepN              | 10.530 us                 | 86.579 us                 |
| OneStep                   | 565.345 ms                | 1.314 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.337 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.217 ms                  |
| Backward                  | 512.371 ms                | 1.212 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.219 ms                  | 297.708 ms                |
| BlockToStepN              | 10.530 us                 | 86.579 us                 |
| OneStep                   | 567.758 ms                | 1.323 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.356 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.219 ms                  |
| Backward                  | 537.183 ms                | 1.212 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.219 ms                  | 297.708 ms                |
| BlockToStepN              | 10.530 us                 | 86.579 us                 |
| OneStep                   | 577.432 ms                | 1.323 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.356 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.219 ms                  |
| Backward                  | 539.826 ms                | 1.212 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.219 ms                  | 311.136 ms                |
| BlockToStepN              | 10.660 us                 | 86.579 us                 |
| OneStep                   | 581.039 ms                | 1.386 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 97.431, sample: 0.835, forward: 1.209, backward: 89.329, update: 0.167
[proc 0] 300 steps, total: 97.431, sample: 0.950, forward: 0.780, backward: 91.218, update: 0.166
[proc 1] 300 steps, total: 97.431, sample: 1.452, forward: 1.284, backward: 88.783, update: 0.188
[proc 2] 300 steps, total: 97.431, sample: 0.885, forward: 1.147, backward: 87.744, update: 0.212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.403 ms                  | 64.091 ms                 |
| Forward                   | 7.767 ms                  | 9.219 ms                  |
| Backward                  | 550.729 ms                | 1.255 s                   |
| Optimize                  | 1.731 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.183 ms                  | 311.136 ms                |
| BlockToStepN              | 10.668 us                 | 86.579 us                 |
| OneStep                   | 585.444 ms                | 1.392 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.443 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.406 ms                  |
| Backward                  | 558.163 ms                | 1.258 s                   |
| Optimize                  | 1.733 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.183 ms                  | 318.021 ms                |
| BlockToStepN              | 10.689 us                 | 86.579 us                 |
| OneStep                   | 587.510 ms                | 1.441 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.520 ms                  | 64.091 ms                 |
| Forward                   | 7.778 ms                  | 9.406 ms                  |
| Backward                  | 569.507 ms                | 1.258 s                   |
| Optimize                  | 1.733 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.219 ms                  | 318.021 ms                |
| BlockToStepN              | 10.668 us                 | 86.579 us                 |
| OneStep                   | 597.977 ms                | 1.441 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.598 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.406 ms                  |
| Backward                  | 573.285 ms                | 1.258 s                   |
| Optimize                  | 1.733 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.179 ms                  | 318.021 ms                |
| BlockToStepN              | 10.668 us                 | 86.579 us                 |
| OneStep                   | 603.107 ms                | 1.441 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.520 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.406 ms                  |
| Backward                  | 583.985 ms                | 1.376 s                   |
| Optimize                  | 1.735 ms                  | 2.512 ms                  |
| BarrierTimeBeforeRank0    | 2.180 ms                  | 318.021 ms                |
| BlockToStepN              | 10.689 us                 | 86.579 us                 |
| OneStep                   | 604.275 ms                | 1.549 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.598 ms                  | 64.091 ms                 |
| Forward                   | 7.787 ms                  | 9.406 ms                  |
| Backward                  | 585.826 ms                | 1.415 s                   |
| Optimize                  | 1.736 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.179 ms                  | 318.021 ms                |
| BlockToStepN              | 10.689 us                 | 86.579 us                 |
| OneStep                   | 621.242 ms                | 1.549 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.598 ms                  | 64.091 ms                 |
| Forward                   | 7.783 ms                  | 9.406 ms                  |
| Backward                  | 590.356 ms                | 1.415 s                   |
| Optimize                  | 1.741 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.180 ms                  | 320.075 ms                |
| BlockToStepN              | 10.698 us                 | 86.579 us                 |
| OneStep                   | 631.522 ms                | 1.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.598 ms                  | 64.091 ms                 |
| Forward                   | 7.781 ms                  | 9.406 ms                  |
| Backward                  | 593.934 ms                | 1.415 s                   |
| Optimize                  | 1.736 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 320.075 ms                |
| BlockToStepN              | 10.749 us                 | 86.579 us                 |
| OneStep                   | 633.993 ms                | 1.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.628 ms                  | 64.091 ms                 |
| Forward                   | 7.783 ms                  | 9.468 ms                  |
| Backward                  | 600.003 ms                | 1.426 s                   |
| Optimize                  | 1.741 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 320.075 ms                |
| BlockToStepN              | 10.784 us                 | 86.579 us                 |
| OneStep                   | 634.968 ms                | 1.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.628 ms                  | 64.091 ms                 |
| Forward                   | 7.783 ms                  | 9.468 ms                  |
| Backward                  | 606.682 ms                | 1.426 s                   |
| Optimize                  | 1.743 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.062 ms                  | 347.969 ms                |
| BlockToStepN              | 10.784 us                 | 86.579 us                 |
| OneStep                   | 639.392 ms                | 1.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.632 ms                  | 64.688 ms                 |
| Forward                   | 7.780 ms                  | 9.468 ms                  |
| Backward                  | 616.736 ms                | 1.426 s                   |
| Optimize                  | 1.741 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 347.969 ms                |
| BlockToStepN              | 10.771 us                 | 86.579 us                 |
| OneStep                   | 642.070 ms                | 1.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.716 ms                  | 64.688 ms                 |
| Forward                   | 7.781 ms                  | 9.468 ms                  |
| Backward                  | 622.360 ms                | 1.426 s                   |
| Optimize                  | 1.741 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 368.781 ms                |
| BlockToStepN              | 10.771 us                 | 91.913 us                 |
| OneStep                   | 651.630 ms                | 1.609 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.716 ms                  | 64.688 ms                 |
| Forward                   | 7.783 ms                  | 9.468 ms                  |
| Backward                  | 627.071 ms                | 1.560 s                   |
| Optimize                  | 1.741 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 368.781 ms                |
| BlockToStepN              | 10.784 us                 | 91.913 us                 |
| OneStep                   | 653.709 ms                | 1.706 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.716 ms                  | 64.091 ms                 |
| Forward                   | 7.790 ms                  | 9.409 ms                  |
| Backward                  | 636.093 ms                | 1.537 s                   |
| Optimize                  | 1.741 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 347.969 ms                |
| BlockToStepN              | 10.771 us                 | 86.579 us                 |
| OneStep                   | 672.916 ms                | 1.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.716 ms                  | 64.091 ms                 |
| Forward                   | 7.798 ms                  | 9.409 ms                  |
| Backward                  | 654.820 ms                | 1.537 s                   |
| Optimize                  | 1.741 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 347.969 ms                |
| BlockToStepN              | 10.784 us                 | 86.579 us                 |
| OneStep                   | 687.345 ms                | 1.648 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.091 ms                 |
| Forward                   | 7.798 ms                  | 9.409 ms                  |
| Backward                  | 657.605 ms                | 1.560 s                   |
| Optimize                  | 1.741 ms                  | 2.571 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 390.132 ms                |
| BlockToStepN              | 10.789 us                 | 86.579 us                 |
| OneStep                   | 701.843 ms                | 1.737 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.091 ms                 |
| Forward                   | 7.798 ms                  | 9.689 ms                  |
| Backward                  | 670.127 ms                | 1.566 s                   |
| Optimize                  | 1.741 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 1.867 ms                  | 390.132 ms                |
| BlockToStepN              | 10.801 us                 | 91.913 us                 |
| OneStep                   | 708.763 ms                | 1.737 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.781 ms                  | 64.091 ms                 |
| Forward                   | 7.798 ms                  | 9.689 ms                  |
| Backward                  | 677.993 ms                | 1.566 s                   |
| Optimize                  | 1.743 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 390.132 ms                |
| BlockToStepN              | 10.821 us                 | 91.913 us                 |
| OneStep                   | 715.608 ms                | 1.737 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.781 ms                  | 64.091 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 681.098 ms                | 1.566 s                   |
| Optimize                  | 1.743 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 390.132 ms                |
| BlockToStepN              | 10.836 us                 | 91.913 us                 |
| OneStep                   | 718.268 ms                | 1.737 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.688 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 685.831 ms                | 1.625 s                   |
| Optimize                  | 1.744 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 1.867 ms                  | 390.132 ms                |
| BlockToStepN              | 10.846 us                 | 91.913 us                 |
| OneStep                   | 718.974 ms                | 1.741 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.688 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 687.391 ms                | 1.631 s                   |
| Optimize                  | 1.747 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 409.657 ms                |
| BlockToStepN              | 10.925 us                 | 101.481 us                |
| OneStep                   | 726.651 ms                | 1.752 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.688 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 690.827 ms                | 1.631 s                   |
| Optimize                  | 1.747 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.062 ms                  | 409.657 ms                |
| BlockToStepN              | 10.984 us                 | 101.481 us                |
| OneStep                   | 733.802 ms                | 1.752 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.804 ms                  | 64.688 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 696.270 ms                | 1.631 s                   |
| Optimize                  | 1.747 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.165 ms                  | 409.657 ms                |
| BlockToStepN              | 10.984 us                 | 101.481 us                |
| OneStep                   | 738.630 ms                | 1.786 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.821 ms                  | 64.688 ms                 |
| Forward                   | 7.805 ms                  | 9.689 ms                  |
| Backward                  | 705.678 ms                | 1.663 s                   |
| Optimize                  | 1.748 ms                  | 2.622 ms                  |
| BarrierTimeBeforeRank0    | 2.062 ms                  | 409.657 ms                |
| BlockToStepN              | 10.991 us                 | 101.481 us                |
| OneStep                   | 751.005 ms                | 1.786 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.821 ms                  | 64.688 ms                 |
| Forward                   | 7.806 ms                  | 9.689 ms                  |
| Backward                  | 705.926 ms                | 1.663 s                   |
| Optimize                  | 1.748 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 409.657 ms                |
| BlockToStepN              | 10.986 us                 | 101.481 us                |
| OneStep                   | 751.776 ms                | 1.786 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.821 ms                  | 64.688 ms                 |
| Forward                   | 7.806 ms                  | 9.689 ms                  |
| Backward                  | 714.453 ms                | 1.663 s                   |
| Optimize                  | 1.749 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 2.062 ms                  | 450.592 ms                |
| BlockToStepN              | 10.991 us                 | 101.481 us                |
| OneStep                   | 759.607 ms                | 1.840 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.832 ms                  | 64.688 ms                 |
| Forward                   | 7.807 ms                  | 9.689 ms                  |
| Backward                  | 718.511 ms                | 1.663 s                   |
| Optimize                  | 1.749 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 450.592 ms                |
| BlockToStepN              | 11.012 us                 | 101.481 us                |
| OneStep                   | 760.786 ms                | 1.840 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.821 ms                  | 64.688 ms                 |
| Forward                   | 7.810 ms                  | 9.690 ms                  |
| Backward                  | 721.765 ms                | 1.663 s                   |
| Optimize                  | 1.752 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 450.592 ms                |
| BlockToStepN              | 11.103 us                 | 101.481 us                |
| OneStep                   | 772.101 ms                | 1.840 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 139.548, sample: 1.029, forward: 1.202, backward: 126.365, update: 0.173
[proc 2] 400 steps, total: 139.548, sample: 0.911, forward: 1.188, backward: 123.043, update: 0.189
[proc 1] 400 steps, total: 139.548, sample: 1.470, forward: 1.238, backward: 124.492, update: 0.193
[proc 0] 400 steps, total: 139.548, sample: 0.972, forward: 0.828, backward: 129.233, update: 0.175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.821 ms                  | 64.688 ms                 |
| Forward                   | 7.814 ms                  | 9.690 ms                  |
| Backward                  | 739.062 ms                | 1.663 s                   |
| Optimize                  | 1.754 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.042 ms                  | 504.270 ms                |
| BlockToStepN              | 11.111 us                 | 101.481 us                |
| OneStep                   | 788.637 ms                | 1.855 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.832 ms                  | 65.984 ms                 |
| Forward                   | 7.814 ms                  | 9.690 ms                  |
| Backward                  | 742.189 ms                | 1.663 s                   |
| Optimize                  | 1.752 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.867 ms                  | 504.270 ms                |
| BlockToStepN              | 11.111 us                 | 101.481 us                |
| OneStep                   | 791.281 ms                | 1.855 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.858 ms                  | 65.984 ms                 |
| Forward                   | 7.814 ms                  | 9.690 ms                  |
| Backward                  | 745.675 ms                | 1.704 s                   |
| Optimize                  | 1.754 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 504.270 ms                |
| BlockToStepN              | 11.118 us                 | 101.481 us                |
| OneStep                   | 795.686 ms                | 1.900 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.917 ms                  | 65.984 ms                 |
| Forward                   | 7.816 ms                  | 9.690 ms                  |
| Backward                  | 757.158 ms                | 1.763 s                   |
| Optimize                  | 1.754 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.798 ms                  | 504.270 ms                |
| BlockToStepN              | 11.118 us                 | 101.481 us                |
| OneStep                   | 799.631 ms                | 1.912 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.858 ms                  | 65.984 ms                 |
| Forward                   | 7.814 ms                  | 9.690 ms                  |
| Backward                  | 767.961 ms                | 1.763 s                   |
| Optimize                  | 1.756 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 504.270 ms                |
| BlockToStepN              | 11.118 us                 | 101.481 us                |
| OneStep                   | 805.226 ms                | 1.912 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.917 ms                  | 65.984 ms                 |
| Forward                   | 7.814 ms                  | 9.690 ms                  |
| Backward                  | 772.796 ms                | 1.763 s                   |
| Optimize                  | 1.756 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 504.270 ms                |
| BlockToStepN              | 11.121 us                 | 101.481 us                |
| OneStep                   | 807.316 ms                | 1.912 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.917 ms                  | 65.984 ms                 |
| Forward                   | 7.816 ms                  | 9.690 ms                  |
| Backward                  | 773.344 ms                | 1.774 s                   |
| Optimize                  | 1.758 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.867 ms                  | 504.270 ms                |
| BlockToStepN              | 11.167 us                 | 109.287 us                |
| OneStep                   | 808.030 ms                | 1.925 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.917 ms                  | 65.984 ms                 |
| Forward                   | 7.816 ms                  | 9.690 ms                  |
| Backward                  | 774.278 ms                | 1.822 s                   |
| Optimize                  | 1.758 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.867 ms                  | 504.270 ms                |
| BlockToStepN              | 11.182 us                 | 109.287 us                |
| OneStep                   | 828.304 ms                | 1.940 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.918 ms                  | 65.984 ms                 |
| Forward                   | 7.820 ms                  | 9.690 ms                  |
| Backward                  | 775.822 ms                | 1.822 s                   |
| Optimize                  | 1.759 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 512.419 ms                |
| BlockToStepN              | 11.202 us                 | 109.287 us                |
| OneStep                   | 828.387 ms                | 1.973 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.917 ms                  | 65.984 ms                 |
| Forward                   | 7.820 ms                  | 9.690 ms                  |
| Backward                  | 779.100 ms                | 1.822 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 2.041 ms                  | 512.419 ms                |
| BlockToStepN              | 11.242 us                 | 109.287 us                |
| OneStep                   | 836.181 ms                | 1.983 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.927 ms                  | 65.984 ms                 |
| Forward                   | 7.820 ms                  | 9.694 ms                  |
| Backward                  | 785.390 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.798 ms                  | 512.419 ms                |
| BlockToStepN              | 11.242 us                 | 147.918 us                |
| OneStep                   | 838.059 ms                | 2.000 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.918 ms                  | 65.984 ms                 |
| Forward                   | 7.824 ms                  | 9.694 ms                  |
| Backward                  | 788.970 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.563 ms                  | 512.419 ms                |
| BlockToStepN              | 11.258 us                 | 147.918 us                |
| OneStep                   | 848.516 ms                | 2.000 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.927 ms                  | 65.984 ms                 |
| Forward                   | 7.824 ms                  | 9.694 ms                  |
| Backward                  | 792.908 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.563 ms                  | 512.419 ms                |
| BlockToStepN              | 11.258 us                 | 147.918 us                |
| OneStep                   | 850.266 ms                | 2.000 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.927 ms                  | 65.984 ms                 |
| Forward                   | 7.824 ms                  | 9.850 ms                  |
| Backward                  | 798.861 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.798 ms                  | 512.419 ms                |
| BlockToStepN              | 11.301 us                 | 147.918 us                |
| OneStep                   | 853.078 ms                | 2.028 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 65.984 ms                 |
| Forward                   | 7.825 ms                  | 9.850 ms                  |
| Backward                  | 812.897 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.563 ms                  | 533.688 ms                |
| BlockToStepN              | 11.289 us                 | 147.918 us                |
| OneStep                   | 854.789 ms                | 2.064 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.927 ms                  | 65.984 ms                 |
| Forward                   | 7.825 ms                  | 9.850 ms                  |
| Backward                  | 816.660 ms                | 1.924 s                   |
| Optimize                  | 1.761 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.798 ms                  | 533.688 ms                |
| BlockToStepN              | 11.301 us                 | 147.918 us                |
| OneStep                   | 861.123 ms                | 2.064 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 64.688 ms                 |
| Forward                   | 7.825 ms                  | 9.694 ms                  |
| Backward                  | 821.397 ms                | 1.924 s                   |
| Optimize                  | 1.760 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 533.688 ms                |
| BlockToStepN              | 11.312 us                 | 147.918 us                |
| OneStep                   | 869.036 ms                | 2.064 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 64.688 ms                 |
| Forward                   | 7.828 ms                  | 9.694 ms                  |
| Backward                  | 830.329 ms                | 1.924 s                   |
| Optimize                  | 1.761 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 512.419 ms                |
| BlockToStepN              | 11.322 us                 | 109.287 us                |
| OneStep                   | 875.347 ms                | 2.064 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 65.984 ms                 |
| Forward                   | 7.828 ms                  | 9.850 ms                  |
| Backward                  | 835.541 ms                | 1.953 s                   |
| Optimize                  | 1.763 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 512.419 ms                |
| BlockToStepN              | 11.392 us                 | 109.287 us                |
| OneStep                   | 878.723 ms                | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.963 ms                  | 65.984 ms                 |
| Forward                   | 7.825 ms                  | 9.850 ms                  |
| Backward                  | 837.974 ms                | 1.953 s                   |
| Optimize                  | 1.761 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 512.419 ms                |
| BlockToStepN              | 11.322 us                 | 109.287 us                |
| OneStep                   | 879.567 ms                | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 65.984 ms                 |
| Forward                   | 7.825 ms                  | 9.850 ms                  |
| Backward                  | 838.497 ms                | 1.953 s                   |
| Optimize                  | 1.763 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 512.419 ms                |
| BlockToStepN              | 11.413 us                 | 109.287 us                |
| OneStep                   | 884.800 ms                | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.958 ms                  | 65.984 ms                 |
| Forward                   | 7.828 ms                  | 9.850 ms                  |
| Backward                  | 838.686 ms                | 2.013 s                   |
| Optimize                  | 1.763 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 512.419 ms                |
| BlockToStepN              | 11.442 us                 | 109.287 us                |
| OneStep                   | 888.337 ms                | 2.138 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 65.984 ms                 |
| Forward                   | 7.835 ms                  | 9.967 ms                  |
| Backward                  | 839.161 ms                | 2.013 s                   |
| Optimize                  | 1.763 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.132 ms                  | 519.360 ms                |
| BlockToStepN              | 11.453 us                 | 118.495 us                |
| OneStep                   | 888.406 ms                | 2.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 65.984 ms                 |
| Forward                   | 7.835 ms                  | 9.967 ms                  |
| Backward                  | 842.710 ms                | 2.013 s                   |
| Optimize                  | 1.766 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 519.360 ms                |
| BlockToStepN              | 11.453 us                 | 118.495 us                |
| OneStep                   | 890.494 ms                | 2.152 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 65.984 ms                 |
| Forward                   | 7.835 ms                  | 9.967 ms                  |
| Backward                  | 846.559 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 533.688 ms                |
| BlockToStepN              | 11.490 us                 | 118.495 us                |
| OneStep                   | 894.323 ms                | 2.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 65.984 ms                 |
| Forward                   | 7.836 ms                  | 9.967 ms                  |
| Backward                  | 848.947 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 533.688 ms                |
| BlockToStepN              | 11.511 us                 | 118.495 us                |
| OneStep                   | 908.817 ms                | 2.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.043 ms                  | 65.984 ms                 |
| Forward                   | 7.843 ms                  | 9.967 ms                  |
| Backward                  | 850.790 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.518 us                 | 118.495 us                |
| OneStep                   | 909.017 ms                | 2.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 65.984 ms                 |
| Forward                   | 7.845 ms                  | 9.967 ms                  |
| Backward                  | 861.483 ms                | 2.013 s                   |
| Optimize                  | 1.767 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.549 us                 | 118.495 us                |
| OneStep                   | 918.815 ms                | 2.180 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.043 ms                  | 65.984 ms                 |
| Forward                   | 7.847 ms                  | 9.967 ms                  |
| Backward                  | 871.506 ms                | 2.013 s                   |
| Optimize                  | 1.767 ms                  | 2.644 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.570 us                 | 147.918 us                |
| OneStep                   | 920.813 ms                | 2.180 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.043 ms                  | 65.984 ms                 |
| Forward                   | 7.847 ms                  | 10.091 ms                 |
| Backward                  | 875.255 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.570 us                 | 147.918 us                |
| OneStep                   | 925.263 ms                | 2.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.043 ms                  | 65.984 ms                 |
| Forward                   | 7.849 ms                  | 10.091 ms                 |
| Backward                  | 886.046 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.547 ms                  | 533.688 ms                |
| BlockToStepN              | 11.618 us                 | 147.918 us                |
| OneStep                   | 927.129 ms                | 2.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.043 ms                  | 65.984 ms                 |
| Forward                   | 7.850 ms                  | 10.091 ms                 |
| Backward                  | 890.982 ms                | 2.013 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.547 ms                  | 533.688 ms                |
| BlockToStepN              | 11.618 us                 | 147.918 us                |
| OneStep                   | 928.023 ms                | 2.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.099 ms                  | 65.984 ms                 |
| Forward                   | 7.853 ms                  | 10.091 ms                 |
| Backward                  | 896.698 ms                | 2.120 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.654 us                 | 147.918 us                |
| OneStep                   | 929.684 ms                | 2.211 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.099 ms                  | 65.984 ms                 |
| Forward                   | 7.858 ms                  | 10.121 ms                 |
| Backward                  | 899.399 ms                | 2.132 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.174 ms                  | 533.688 ms                |
| BlockToStepN              | 11.681 us                 | 151.075 us                |
| OneStep                   | 931.464 ms                | 2.250 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.099 ms                  | 65.984 ms                 |
| Forward                   | 7.861 ms                  | 10.121 ms                 |
| Backward                  | 899.720 ms                | 2.132 s                   |
| Optimize                  | 1.768 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.339 ms                  | 544.051 ms                |
| BlockToStepN              | 11.681 us                 | 151.075 us                |
| OneStep                   | 931.808 ms                | 2.281 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.090 ms                  | 65.984 ms                 |
| Forward                   | 7.861 ms                  | 10.121 ms                 |
| Backward                  | 906.115 ms                | 2.132 s                   |
| Optimize                  | 1.771 ms                  | 2.796 ms                  |
| BarrierTimeBeforeRank0    | 1.547 ms                  | 544.051 ms                |
| BlockToStepN              | 11.813 us                 | 151.075 us                |
| OneStep                   | 938.053 ms                | 2.281 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 181.698, sample: 1.092, forward: 1.157, backward: 161.627, update: 0.182
[proc 0] 500 steps, total: 181.698, sample: 1.000, forward: 0.826, backward: 166.593, update: 0.178
[proc 1] 500 steps, total: 181.698, sample: 1.403, forward: 1.240, backward: 161.465, update: 0.202
[proc 2] 500 steps, total: 181.698, sample: 0.926, forward: 1.165, backward: 158.400, update: 0.215
Successfully xmh. training takes 501.57983231544495 seconds
before call kg_cache_controller.StopThreads()
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
INFO [23675 controller_process.py:380] call rank0 to StopThreads
