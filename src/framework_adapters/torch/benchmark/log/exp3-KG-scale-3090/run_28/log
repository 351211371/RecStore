WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:02:59.038156 50791 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_43', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [50791 sampler.py:454] Start PreSampling
WARNING [50791 sampler.py:532] Before construct renumbering_dict
WARNING [50791 sampler.py:555] PreSampling done
W20240123 02:03:01.883347 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:03:01.883484 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:03:01.883522 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:03:01.883548 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:03:01.883574 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:03:01.883596 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:03:01.883615 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:03:01.883642 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:03:01.883667 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:03:01.883685 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:03:01.883716 50791 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:03:01.883735 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:03:01.883765 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:03:01.883865 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:03:01.883895 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:03:01.883914 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:03:01.883939 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:03:01.883961 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:03:01.883996 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:03:01.884012 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:03:01.884045 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:03:01.884068 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:03:01.884086 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:03:01.884111 50791 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:03:01.884127 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:03:01.884141 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:03:01.884183 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:03:01.884204 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:03:01.884225 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:03:01.884253 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:03:01.884269 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:03:01.884299 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:03:01.884322 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:03:01.884341 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:03:01.884361 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:03:01.884380 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:03:01.884403 50791 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:03:01.884418 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:03:01.884433 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:03:01.884469 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:03:01.884501 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:03:01.884529 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:03:01.884546 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:03:01.884563 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:03:01.884586 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:03:01.884603 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:03:01.884621 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:03:01.884644 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:03:01.884683 50791 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:03:01.884701 50791 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:03:01.884716 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:03:01.884735 50791 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:03:02.061662 50791 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240123 02:03:02.061805 50791 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 899,  989, 1023,  ..., 6570, 3950, 7339]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.057 seconds
[Rank1] pid = 51065
[Rank2] pid = 51129
INFO [50791 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51065 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [51193 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [51129 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [50791 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [51129 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [51065 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [51193 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [50791 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [51129 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [51065 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [51193 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [50791 cache_common.py:137] TorchNativeStdEmb construct done
INFO [51129 cache_common.py:137] TorchNativeStdEmb construct done
INFO [51065 cache_common.py:137] TorchNativeStdEmb construct done
INFO [51193 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [50791 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51065 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51129 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51193 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:03:04.609962 51194 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 02:03:04.610070 51195 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:03:04.610196 51130 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:03:04.610298 51066 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:03:05.082216 51194 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 02:03:05.083045 51066 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 02:03:05.084422 51130 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 02:03:05.085209 51195 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.455 us                | 10.525 ms                 |
| Forward                   | 5.946 ms                  | 542.037 ms                |
| Backward                  | 69.500 ms                 | 174.756 ms                |
| Optimize                  | 1.766 ms                  | 3.073 ms                  |
| BarrierTimeBeforeRank0    | 2.439 ms                  | 52.988 ms                 |
| BlockToStepN              | 8.707 us                  | 71.698 us                 |
| OneStep                   | 83.524 ms                 | 721.531 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.948 us                | 10.525 ms                 |
| Forward                   | 5.944 ms                  | 9.490 ms                  |
| Backward                  | 102.500 ms                | 181.268 ms                |
| Optimize                  | 1.768 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 3.184 ms                  | 52.988 ms                 |
| BlockToStepN              | 8.610 us                  | 58.941 us                 |
| OneStep                   | 116.187 ms                | 214.756 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.698 us                | 10.525 ms                 |
| Forward                   | 5.926 ms                  | 9.490 ms                  |
| Backward                  | 125.962 ms                | 271.711 ms                |
| Optimize                  | 1.769 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 3.594 ms                  | 54.695 ms                 |
| BlockToStepN              | 8.631 us                  | 58.941 us                 |
| OneStep                   | 145.196 ms                | 291.992 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 15.007, sample: 0.192, forward: 1.129, backward: 12.882, update: 0.144
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 15.006, sample: 0.191, forward: 1.118, backward: 12.901, update: 0.145
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.008, sample: 0.204, forward: 1.054, backward: 12.786, update: 0.166
[Rank3] pid = 51193
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 5135,  7256, 11438,  4702,    50,  5068, 10792,   140,     9,  9952]) tensor([ 1023,  9990,  2407, 12285,  2847,  8026,  3341,  5857,  4021, 13808])
-------Step 1-------
tensor([ 5135,  7256, 11438,  4702,    50,  5068, 10792,   140,     9,  9952]) tensor([ 4107,  9641,  9815,  6438,  6169, 11317, 12309,  2517,  5030,  8629])
-------Step 2-------
tensor([13084,  8982,  8719,  4444,    40,  2594,     5,  7329,  3652,  2767]) tensor([10804,  2244,  8017,  8161, 10898,    46, 12691,  8568, 11522, 10605])
-------Step 3-------
tensor([13084,  8982,  8719,  4444,    40,  2594,     5,  7329,  3652,  2767]) tensor([ 9010,  1487, 13392,  3228,  7513,  3390, 13153,  3209,  7314, 11358])
-------Step 4-------
tensor([11337,  7965,  6308,  2556,  5155, 12364,  8103, 14444,   158, 10535]) tensor([  573,  5940, 13541,  8546,  3695,    47,  2521,  3736, 11125,  7899])
-------Step 5-------
tensor([11337,  7965,  6308,  2556,  5155, 12364,  8103, 14444,   158, 10535]) tensor([ 6322,  5678,  3358, 12707, 10245,  9483,  6637, 10097,  3805, 13248])
-------Step 6-------
tensor([ 1680,  2495,  2708, 12845,    89,  9737, 12408,  4357,    70,  2697]) tensor([ 5086, 14863, 14338,  3422, 11412, 12661,  2556,  5972, 14343, 10368])
-------Step 7-------
tensor([ 1680,  2495,  2708, 12845,    89,  9737, 12408,  4357,    70,  2697]) tensor([10750,  6391,  9248,  6082,  1749,   867,  2445,  3135,  5452,  2683])
-------Step 8-------
tensor([   30,  9074,    87,  8032,  4747, 10656, 11509,  5582,   112,  3366]) tensor([ 7841,  2940,  1434,  9597,  8213, 14088,  1483,  6713,  7524, 12937])
-------Step 9-------
tensor([   30,  9074,    87,  8032,  4747, 10656, 11509,  5582,   112,  3366]) tensor([ 5046,  6709,  8522,  3203, 13897,  2557, 14535,  2517,  4313,  3926])
before start barrier
start train
[proc 0] 100 steps, total: 15.009, sample: 0.200, forward: 1.129, backward: 12.748, update: 0.166
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 826.762 us                | 10.811 ms                 |
| Forward                   | 5.907 ms                  | 9.490 ms                  |
| Backward                  | 143.048 ms                | 271.711 ms                |
| Optimize                  | 1.773 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 4.874 ms                  | 76.470 ms                 |
| BlockToStepN              | 8.631 us                  | 71.698 us                 |
| OneStep                   | 160.420 ms                | 338.996 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.948 us                | 10.811 ms                 |
| Forward                   | 5.914 ms                  | 9.490 ms                  |
| Backward                  | 162.498 ms                | 324.408 ms                |
| Optimize                  | 1.773 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 5.525 ms                  | 76.470 ms                 |
| BlockToStepN              | 8.634 us                  | 71.698 us                 |
| OneStep                   | 180.341 ms                | 376.651 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.751 us                | 10.811 ms                 |
| Forward                   | 5.930 ms                  | 9.490 ms                  |
| Backward                  | 174.756 ms                | 352.993 ms                |
| Optimize                  | 1.776 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 6.647 ms                  | 76.601 ms                 |
| BlockToStepN              | 8.682 us                  | 71.698 us                 |
| OneStep                   | 199.375 ms                | 399.756 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 827.773 us                | 10.525 ms                 |
| Forward                   | 5.926 ms                  | 9.338 ms                  |
| Backward                  | 187.074 ms                | 370.243 ms                |
| Optimize                  | 1.776 ms                  | 2.637 ms                  |
| BarrierTimeBeforeRank0    | 6.647 ms                  | 76.470 ms                 |
| BlockToStepN              | 8.699 us                  | 58.941 us                 |
| OneStep                   | 212.194 ms                | 405.066 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 826.762 us                | 10.811 ms                 |
| Forward                   | 5.930 ms                  | 9.338 ms                  |
| Backward                  | 205.479 ms                | 388.264 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 7.384 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.707 us                  | 58.941 us                 |
| OneStep                   | 228.797 ms                | 468.635 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 827.773 us                | 10.811 ms                 |
| Forward                   | 5.933 ms                  | 9.338 ms                  |
| Backward                  | 225.395 ms                | 426.614 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 7.561 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.707 us                  | 58.941 us                 |
| OneStep                   | 245.501 ms                | 468.635 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.948 us                | 10.811 ms                 |
| Forward                   | 5.930 ms                  | 9.338 ms                  |
| Backward                  | 232.953 ms                | 449.487 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 8.255 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.701 us                  | 58.941 us                 |
| OneStep                   | 257.281 ms                | 527.303 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 38.509, sample: 0.215, forward: 0.525, backward: 36.031, update: 0.166
[proc 2] 200 steps, total: 38.509, sample: 0.210, forward: 0.584, backward: 35.994, update: 0.145
[proc 3] 200 steps, total: 38.509, sample: 0.216, forward: 0.590, backward: 36.176, update: 0.142
[proc 0] 200 steps, total: 38.509, sample: 0.225, forward: 0.581, backward: 35.109, update: 0.176
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.948 us                | 11.120 ms                 |
| Forward                   | 5.935 ms                  | 9.338 ms                  |
| Backward                  | 244.111 ms                | 508.642 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 8.317 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.895 us                  | 58.941 us                 |
| OneStep                   | 274.675 ms                | 531.904 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.237 us                | 11.120 ms                 |
| Forward                   | 5.938 ms                  | 9.338 ms                  |
| Backward                  | 255.994 ms                | 509.563 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 8.583 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.707 us                  | 58.941 us                 |
| OneStep                   | 280.681 ms                | 531.904 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.237 us                | 11.120 ms                 |
| Forward                   | 5.933 ms                  | 9.338 ms                  |
| Backward                  | 262.905 ms                | 542.238 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 8.744 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.699 us                  | 58.941 us                 |
| OneStep                   | 291.992 ms                | 581.767 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.596 us                | 11.120 ms                 |
| Forward                   | 5.926 ms                  | 9.338 ms                  |
| Backward                  | 269.796 ms                | 548.037 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 8.986 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.682 us                  | 58.941 us                 |
| OneStep                   | 303.222 ms                | 584.425 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.872 us                | 11.120 ms                 |
| Forward                   | 5.933 ms                  | 9.338 ms                  |
| Backward                  | 279.292 ms                | 575.779 ms                |
| Optimize                  | 1.778 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 9.481 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.699 us                  | 58.941 us                 |
| OneStep                   | 309.594 ms                | 606.058 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.596 us                | 11.120 ms                 |
| Forward                   | 5.938 ms                  | 9.338 ms                  |
| Backward                  | 288.022 ms                | 617.985 ms                |
| Optimize                  | 1.783 ms                  | 2.973 ms                  |
| BarrierTimeBeforeRank0    | 9.959 ms                  | 85.154 ms                 |
| BlockToStepN              | 8.701 us                  | 58.941 us                 |
| OneStep                   | 323.455 ms                | 656.184 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.237 us                | 10.811 ms                 |
| Forward                   | 5.938 ms                  | 9.143 ms                  |
| Backward                  | 301.435 ms                | 622.394 ms                |
| Optimize                  | 1.784 ms                  | 2.680 ms                  |
| BarrierTimeBeforeRank0    | 10.028 ms                 | 84.121 ms                 |
| BlockToStepN              | 8.853 us                  | 58.297 us                 |
| OneStep                   | 332.801 ms                | 659.044 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.322 us                | 11.295 ms                 |
| Forward                   | 5.944 ms                  | 9.143 ms                  |
| Backward                  | 306.691 ms                | 631.692 ms                |
| Optimize                  | 1.786 ms                  | 2.680 ms                  |
| BarrierTimeBeforeRank0    | 10.028 ms                 | 84.121 ms                 |
| BlockToStepN              | 8.853 us                  | 58.297 us                 |
| OneStep                   | 338.996 ms                | 671.000 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.819 us                | 11.295 ms                 |
| Forward                   | 5.947 ms                  | 9.143 ms                  |
| Backward                  | 318.846 ms                | 659.291 ms                |
| Optimize                  | 1.787 ms                  | 2.687 ms                  |
| BarrierTimeBeforeRank0    | 10.069 ms                 | 84.121 ms                 |
| BlockToStepN              | 8.895 us                  | 58.297 us                 |
| OneStep                   | 352.884 ms                | 681.359 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.082 us                | 11.295 ms                 |
| Forward                   | 5.946 ms                  | 9.143 ms                  |
| Backward                  | 324.408 ms                | 663.933 ms                |
| Optimize                  | 1.787 ms                  | 2.687 ms                  |
| BarrierTimeBeforeRank0    | 10.147 ms                 | 85.154 ms                 |
| BlockToStepN              | 8.909 us                  | 58.297 us                 |
| OneStep                   | 358.568 ms                | 695.652 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.082 us                | 11.295 ms                 |
| Forward                   | 5.944 ms                  | 9.143 ms                  |
| Backward                  | 327.267 ms                | 689.713 ms                |
| Optimize                  | 1.787 ms                  | 2.687 ms                  |
| BarrierTimeBeforeRank0    | 10.147 ms                 | 85.154 ms                 |
| BlockToStepN              | 8.909 us                  | 58.297 us                 |
| OneStep                   | 362.682 ms                | 726.295 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.874 us                | 11.295 ms                 |
| Forward                   | 5.938 ms                  | 9.143 ms                  |
| Backward                  | 334.389 ms                | 730.233 ms                |
| Optimize                  | 1.787 ms                  | 2.687 ms                  |
| BarrierTimeBeforeRank0    | 10.147 ms                 | 85.189 ms                 |
| BlockToStepN              | 9.031 us                  | 58.297 us                 |
| OneStep                   | 374.305 ms                | 749.055 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.151 us                | 11.295 ms                 |
| Forward                   | 5.944 ms                  | 9.143 ms                  |
| Backward                  | 352.856 ms                | 740.645 ms                |
| Optimize                  | 1.787 ms                  | 2.687 ms                  |
| BarrierTimeBeforeRank0    | 10.069 ms                 | 85.189 ms                 |
| BlockToStepN              | 8.957 us                  | 58.297 us                 |
| OneStep                   | 377.784 ms                | 759.173 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 62.052, sample: 0.199, forward: 0.516, backward: 58.640, update: 0.166
[proc 2] 300 steps, total: 62.052, sample: 0.187, forward: 0.582, backward: 58.704, update: 0.149
[proc 3] 300 steps, total: 62.052, sample: 0.194, forward: 0.588, backward: 59.388, update: 0.145
[proc 0] 300 steps, total: 62.052, sample: 0.212, forward: 0.588, backward: 59.009, update: 0.172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.658 us                | 11.295 ms                 |
| Forward                   | 5.938 ms                  | 9.143 ms                  |
| Backward                  | 360.736 ms                | 777.507 ms                |
| Optimize                  | 1.787 ms                  | 2.712 ms                  |
| BarrierTimeBeforeRank0    | 10.147 ms                 | 85.189 ms                 |
| BlockToStepN              | 9.031 us                  | 58.297 us                 |
| OneStep                   | 387.603 ms                | 786.140 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.297 us                | 11.295 ms                 |
| Forward                   | 5.944 ms                  | 9.143 ms                  |
| Backward                  | 367.433 ms                | 778.049 ms                |
| Optimize                  | 1.787 ms                  | 2.751 ms                  |
| BarrierTimeBeforeRank0    | 10.533 ms                 | 85.189 ms                 |
| BlockToStepN              | 9.031 us                  | 58.297 us                 |
| OneStep                   | 392.277 ms                | 786.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.297 us                | 11.295 ms                 |
| Forward                   | 5.946 ms                  | 9.143 ms                  |
| Backward                  | 370.243 ms                | 788.186 ms                |
| Optimize                  | 1.787 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.546 ms                 | 96.359 ms                 |
| BlockToStepN              | 9.162 us                  | 58.297 us                 |
| OneStep                   | 402.675 ms                | 810.692 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.579 us                | 11.295 ms                 |
| Forward                   | 5.945 ms                  | 9.143 ms                  |
| Backward                  | 373.524 ms                | 803.643 ms                |
| Optimize                  | 1.787 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 96.359 ms                 |
| BlockToStepN              | 9.172 us                  | 58.297 us                 |
| OneStep                   | 413.318 ms                | 812.427 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.250 us                | 11.295 ms                 |
| Forward                   | 5.938 ms                  | 9.143 ms                  |
| Backward                  | 380.788 ms                | 829.637 ms                |
| Optimize                  | 1.788 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 96.359 ms                 |
| BlockToStepN              | 9.186 us                  | 58.297 us                 |
| OneStep                   | 419.582 ms                | 838.811 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.554 us                | 11.295 ms                 |
| Forward                   | 5.935 ms                  | 9.143 ms                  |
| Backward                  | 388.151 ms                | 867.036 ms                |
| Optimize                  | 1.788 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 96.359 ms                 |
| BlockToStepN              | 9.186 us                  | 58.297 us                 |
| OneStep                   | 424.476 ms                | 875.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.554 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 9.143 ms                  |
| Backward                  | 390.880 ms                | 867.036 ms                |
| Optimize                  | 1.788 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 96.359 ms                 |
| BlockToStepN              | 9.199 us                  | 58.941 us                 |
| OneStep                   | 434.511 ms                | 875.717 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.554 us                | 11.295 ms                 |
| Forward                   | 5.935 ms                  | 9.143 ms                  |
| Backward                  | 402.926 ms                | 867.036 ms                |
| Optimize                  | 1.790 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 101.705 ms                |
| BlockToStepN              | 9.206 us                  | 71.698 us                 |
| OneStep                   | 439.612 ms                | 876.800 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.021 us                | 11.146 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 410.239 ms                | 867.036 ms                |
| Optimize                  | 1.790 ms                  | 2.800 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 101.705 ms                |
| BlockToStepN              | 9.224 us                  | 58.941 us                 |
| OneStep                   | 451.851 ms                | 879.250 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.053 us                | 11.146 ms                 |
| Forward                   | 5.932 ms                  | 8.838 ms                  |
| Backward                  | 414.017 ms                | 867.036 ms                |
| Optimize                  | 1.791 ms                  | 2.800 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 101.705 ms                |
| BlockToStepN              | 9.269 us                  | 58.941 us                 |
| OneStep                   | 457.299 ms                | 891.400 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.053 us                | 11.146 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 424.077 ms                | 877.318 ms                |
| Optimize                  | 1.792 ms                  | 2.800 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 101.705 ms                |
| BlockToStepN              | 9.353 us                  | 58.941 us                 |
| OneStep                   | 464.018 ms                | 902.557 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.899 us                | 11.146 ms                 |
| Forward                   | 5.932 ms                  | 8.838 ms                  |
| Backward                  | 431.845 ms                | 891.309 ms                |
| Optimize                  | 1.792 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 101.705 ms                |
| BlockToStepN              | 9.560 us                  | 58.941 us                 |
| OneStep                   | 468.635 ms                | 911.153 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.427 us                | 11.146 ms                 |
| Forward                   | 5.932 ms                  | 8.838 ms                  |
| Backward                  | 433.662 ms                | 891.309 ms                |
| Optimize                  | 1.792 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 101.705 ms                |
| BlockToStepN              | 9.560 us                  | 58.941 us                 |
| OneStep                   | 477.565 ms                | 931.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.899 us                | 11.146 ms                 |
| Forward                   | 5.932 ms                  | 8.838 ms                  |
| Backward                  | 440.595 ms                | 915.479 ms                |
| Optimize                  | 1.792 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 101.705 ms                |
| BlockToStepN              | 9.606 us                  | 58.941 us                 |
| OneStep                   | 483.917 ms                | 939.155 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.899 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 452.136 ms                | 941.064 ms                |
| Optimize                  | 1.791 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 101.705 ms                |
| BlockToStepN              | 9.620 us                  | 58.941 us                 |
| OneStep                   | 495.505 ms                | 950.144 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.053 us                | 11.295 ms                 |
| Forward                   | 5.932 ms                  | 8.838 ms                  |
| Backward                  | 459.530 ms                | 966.378 ms                |
| Optimize                  | 1.791 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 101.705 ms                |
| BlockToStepN              | 9.652 us                  | 58.941 us                 |
| OneStep                   | 497.198 ms                | 975.432 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.021 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 463.303 ms                | 993.332 ms                |
| Optimize                  | 1.791 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 101.705 ms                |
| BlockToStepN              | 9.686 us                  | 71.698 us                 |
| OneStep                   | 502.047 ms                | 1.002 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 86.497, sample: 0.214, forward: 0.587, backward: 82.523, update: 0.179
[proc 2] 400 steps, total: 86.497, sample: 0.203, forward: 0.576, backward: 81.859, update: 0.148
[proc 3] 400 steps, total: 86.497, sample: 0.206, forward: 0.583, backward: 82.161, update: 0.148
[proc 1] 400 steps, total: 86.498, sample: 0.214, forward: 0.512, backward: 81.615, update: 0.167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.899 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 468.692 ms                | 995.593 ms                |
| Optimize                  | 1.791 ms                  | 2.815 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 102.353 ms                |
| BlockToStepN              | 9.686 us                  | 77.975 us                 |
| OneStep                   | 510.169 ms                | 1.008 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.427 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 481.161 ms                | 1.006 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 102.353 ms                |
| BlockToStepN              | 9.686 us                  | 77.975 us                 |
| OneStep                   | 515.312 ms                | 1.021 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.247 us                | 11.295 ms                 |
| Forward                   | 5.938 ms                  | 8.838 ms                  |
| Backward                  | 487.251 ms                | 1.006 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 9.710 us                  | 77.975 us                 |
| OneStep                   | 517.681 ms                | 1.021 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.427 us                | 11.295 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 494.406 ms                | 1.012 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 9.740 us                  | 77.975 us                 |
| OneStep                   | 523.091 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.247 us                | 11.308 ms                 |
| Forward                   | 5.935 ms                  | 8.838 ms                  |
| Backward                  | 499.141 ms                | 1.030 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 109.066 ms                |
| BlockToStepN              | 9.743 us                  | 77.975 us                 |
| OneStep                   | 527.303 ms                | 1.038 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.427 us                | 11.308 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 504.921 ms                | 1.073 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 109.066 ms                |
| BlockToStepN              | 9.797 us                  | 77.975 us                 |
| OneStep                   | 530.778 ms                | 1.082 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.886 us                | 11.308 ms                 |
| Forward                   | 5.935 ms                  | 8.838 ms                  |
| Backward                  | 508.642 ms                | 1.073 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 109.066 ms                |
| BlockToStepN              | 9.797 us                  | 77.975 us                 |
| OneStep                   | 536.258 ms                | 1.082 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.886 us                | 11.551 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 509.563 ms                | 1.073 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 9.797 us                  | 77.975 us                 |
| OneStep                   | 536.932 ms                | 1.089 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.247 us                | 11.551 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 514.497 ms                | 1.080 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.201 ms                 | 109.066 ms                |
| BlockToStepN              | 9.817 us                  | 77.975 us                 |
| OneStep                   | 540.631 ms                | 1.090 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.886 us                | 11.551 ms                 |
| Forward                   | 5.932 ms                  | 9.053 ms                  |
| Backward                  | 518.521 ms                | 1.082 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.201 ms                 | 109.066 ms                |
| BlockToStepN              | 9.817 us                  | 77.975 us                 |
| OneStep                   | 547.074 ms                | 1.093 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.886 us                | 11.542 ms                 |
| Forward                   | 5.935 ms                  | 8.838 ms                  |
| Backward                  | 524.758 ms                | 1.121 s                   |
| Optimize                  | 1.791 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 109.066 ms                |
| BlockToStepN              | 9.817 us                  | 77.975 us                 |
| OneStep                   | 554.555 ms                | 1.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.936 us                | 11.542 ms                 |
| Forward                   | 5.930 ms                  | 8.838 ms                  |
| Backward                  | 532.660 ms                | 1.121 s                   |
| Optimize                  | 1.791 ms                  | 2.850 ms                  |
| BarrierTimeBeforeRank0    | 11.201 ms                 | 109.066 ms                |
| BlockToStepN              | 9.885 us                  | 71.698 us                 |
| OneStep                   | 558.643 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.936 us                | 11.542 ms                 |
| Forward                   | 5.933 ms                  | 8.838 ms                  |
| Backward                  | 536.087 ms                | 1.126 s                   |
| Optimize                  | 1.792 ms                  | 2.857 ms                  |
| BarrierTimeBeforeRank0    | 11.528 ms                 | 109.066 ms                |
| BlockToStepN              | 9.885 us                  | 71.698 us                 |
| OneStep                   | 567.889 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.936 us                | 11.542 ms                 |
| Forward                   | 5.935 ms                  | 8.838 ms                  |
| Backward                  | 536.960 ms                | 1.128 s                   |
| Optimize                  | 1.792 ms                  | 2.857 ms                  |
| BarrierTimeBeforeRank0    | 11.195 ms                 | 109.066 ms                |
| BlockToStepN              | 9.893 us                  | 71.698 us                 |
| OneStep                   | 570.641 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.539 us                | 11.542 ms                 |
| Forward                   | 5.938 ms                  | 8.838 ms                  |
| Backward                  | 542.238 ms                | 1.128 s                   |
| Optimize                  | 1.793 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.201 ms                 | 109.066 ms                |
| BlockToStepN              | 9.893 us                  | 71.698 us                 |
| OneStep                   | 582.976 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.496 us                | 11.542 ms                 |
| Forward                   | 5.940 ms                  | 8.838 ms                  |
| Backward                  | 548.576 ms                | 1.160 s                   |
| Optimize                  | 1.792 ms                  | 2.859 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 9.995 us                  | 71.698 us                 |
| OneStep                   | 585.909 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.496 us                | 11.542 ms                 |
| Forward                   | 5.943 ms                  | 8.838 ms                  |
| Backward                  | 555.122 ms                | 1.177 s                   |
| Optimize                  | 1.792 ms                  | 2.897 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 10.065 us                 | 71.698 us                 |
| OneStep                   | 591.393 ms                | 1.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.539 us                | 11.542 ms                 |
| Forward                   | 5.944 ms                  | 8.838 ms                  |
| Backward                  | 560.912 ms                | 1.184 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 10.125 us                 | 71.698 us                 |
| OneStep                   | 599.976 ms                | 1.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.954 us                | 11.542 ms                 |
| Forward                   | 5.943 ms                  | 8.838 ms                  |
| Backward                  | 564.992 ms                | 1.195 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 10.166 us                 | 71.698 us                 |
| OneStep                   | 602.208 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.954 us                | 11.542 ms                 |
| Forward                   | 5.943 ms                  | 8.838 ms                  |
| Backward                  | 570.731 ms                | 1.222 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 10.197 us                 | 71.698 us                 |
| OneStep                   | 606.380 ms                | 1.232 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.954 us                | 11.542 ms                 |
| Forward                   | 5.944 ms                  | 8.838 ms                  |
| Backward                  | 571.979 ms                | 1.222 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 11.172 ms                 | 109.066 ms                |
| BlockToStepN              | 10.220 us                 | 71.698 us                 |
| OneStep                   | 608.655 ms                | 1.232 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.555 us                | 11.542 ms                 |
| Forward                   | 5.944 ms                  | 8.838 ms                  |
| Backward                  | 575.779 ms                | 1.228 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 10.788 ms                 | 111.486 ms                |
| BlockToStepN              | 10.242 us                 | 71.698 us                 |
| OneStep                   | 624.658 ms                | 1.239 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 110.236, sample: 0.196, forward: 0.594, backward: 105.289, update: 0.154
[proc 1] 500 steps, total: 110.236, sample: 0.197, forward: 0.513, backward: 104.682, update: 0.165
[proc 2] 500 steps, total: 110.236, sample: 0.212, forward: 0.587, backward: 105.489, update: 0.147
[proc 0] 500 steps, total: 110.236, sample: 0.239, forward: 0.595, backward: 106.319, update: 0.180
Successfully xmh. training takes 312.3038866519928 seconds
before call kg_cache_controller.StopThreads()
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
INFO [50791 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.954 us                | 11.542 ms                 |
| Forward                   | 5.943 ms                  | 8.838 ms                  |
| Backward                  | 579.621 ms                | 1.233 s                   |
| Optimize                  | 1.792 ms                  | 2.918 ms                  |
| BarrierTimeBeforeRank0    | 10.669 ms                 | 111.486 ms                |
| BlockToStepN              | 10.242 us                 | 71.698 us                 |
| OneStep                   | 624.707 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
