WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 03:24:05.216075 28359 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_52', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [28359 sampler.py:454] Start PreSampling
WARNING [28359 sampler.py:532] Before construct renumbering_dict
WARNING [28359 sampler.py:555] PreSampling done
W20240124 03:37:40.939314 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 03:37:40.939553 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 03:37:40.939586 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 03:37:40.939621 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 03:37:40.939651 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 03:37:40.939677 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 03:37:40.939702 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 03:37:40.939738 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 03:37:40.939766 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 03:37:40.939791 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 03:37:40.939819 28359 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 03:37:40.939844 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 03:37:40.939870 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 03:37:40.940029 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 03:37:40.940058 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 03:37:40.940083 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 03:37:40.940131 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 03:37:40.940155 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 03:37:40.940179 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 03:37:40.940208 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 03:37:40.940241 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 03:37:40.940270 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 03:37:40.940297 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 03:37:40.940320 28359 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 03:37:40.940340 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 03:37:40.940361 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 03:37:40.940411 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 03:37:40.940446 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 03:37:40.940467 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 03:37:40.940491 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 03:37:40.940511 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 03:37:40.940538 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 03:37:40.940567 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 03:37:40.940595 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 03:37:40.940621 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 03:37:40.940645 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 03:37:40.940670 28359 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 03:37:40.940686 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 03:37:40.940707 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 03:37:40.940763 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 03:37:40.940786 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 03:37:40.940836 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 03:37:40.940866 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 03:37:40.940891 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 03:37:40.940915 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 03:37:40.940936 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 03:37:40.940970 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 03:37:40.940994 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 03:37:40.941018 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 03:37:40.941043 28359 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 03:37:40.941062 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 03:37:40.941082 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 03:37:40.941131 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 03:37:40.941167 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 03:37:40.941193 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 03:37:40.941215 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 03:37:40.941244 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 03:37:40.941274 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 03:37:40.941300 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 03:37:40.941329 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 03:37:40.941352 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 03:37:40.941380 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 03:37:40.941408 28359 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 03:37:40.941428 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 03:37:40.941449 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 03:37:40.941499 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 03:37:40.941530 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 03:37:40.941553 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 03:37:40.941577 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 03:37:40.941601 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 03:37:40.941630 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 03:37:40.941656 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 03:37:40.941687 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 03:37:40.941713 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 03:37:40.941740 28359 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 03:37:40.941763 28359 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 03:37:40.941781 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 03:37:40.941800 28359 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 03:37:41.287583 28359 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100002e52000 128.2 GB
W20240124 03:37:41.287765 28359 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102011a8a000 328.3 MB
{0: Graph(num_nodes=16364881, num_edges=60475646,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22851247, num_edges=75085053,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16469571, num_edges=67497598,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17544490, num_edges=53244935,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=18090773, num_edges=55134734,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=20615225, num_edges=67664913,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16364881 N 60475646 E
MertisPartition: part 1 has 22851247 N 75085053 E
MertisPartition: part 2 has 16469571 N 67497598 E
MertisPartition: part 3 has 17544490 N 53244935 E
MertisPartition: part 4 has 18090773 N 55134734 E
MertisPartition: part 5 has 20615225 N 67664913 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,        6,  ..., 37713888,  7166588, 11887902]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
After renumbering graph:  {'_ID': tensor([ 4302835,  4302866,  4302886,  ...,  5923340, 55467575, 35549136]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 994.184 seconds
[Rank1] pid = 53584
[Rank2] pid = 53685
[Rank3] pid = 53767
[Rank4] pid = 53914
INFO [28359 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [53584 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [53767 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [53685 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [53914 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [53767 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [53685 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [54034 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [53914 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [54034 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [53584 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240124 03:40:45.918282 53768 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 03:40:45.918453 53686 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 03:40:45.918452 53922 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 03:40:45.918598 54098 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 03:40:45.918802 53585 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
INFO [28359 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240124 03:40:45.923362 54035 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 03:40:46.031317 54098 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020262dd000 781.2 kB
W20240124 03:40:46.031385 54035 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x1020263a2000 781.2 kB
W20240124 03:40:46.031406 53922 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102026467000 781.2 kB
W20240124 03:40:46.031453 53768 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x10202652c000 781.2 kB
W20240124 03:40:46.031473 53585 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020265f1000 781.2 kB
W20240124 03:40:46.031497 53686 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020266b6000 781.2 kB
W20240124 03:40:46.031602 54098 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10202677b000 781.2 kB
W20240124 03:40:46.031621 54035 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102026840000 781.2 kB
W20240124 03:40:46.031706 54098 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x1020269ca000 152.6 MB
W20240124 03:40:46.031702 53922 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x102026905000 781.2 kB
W20240124 03:40:46.031739 53585 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102030262000 781.2 kB
W20240124 03:40:46.031747 54035 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x102030327000 152.6 MB
W20240124 03:40:46.031785 54098 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x102039c84000 152.6 MB
W20240124 03:40:46.031780 53768 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x102039bbf000 781.2 kB
W20240124 03:40:46.031798 53686 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x10204351c000 781.2 kB
W20240124 03:40:46.031849 54035 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x1020435e1000 152.6 MB
W20240124 03:40:46.031877 53585 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10204ce79000 152.6 MB
W20240124 03:40:46.031889 54098 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 03:40:46.031903 53922 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x102056711000 152.6 MB
W20240124 03:40:46.031919 54035 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 03:40:46.031944 53768 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10205ffa9000 152.6 MB
W20240124 03:40:46.031950 53585 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x102069841000 152.6 MB
W20240124 03:40:46.031985 53686 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1020730d9000 152.6 MB
W20240124 03:40:46.032013 53922 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10207c971000 152.6 MB
W20240124 03:40:46.032073 53585 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 03:40:46.032073 53768 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x102086209000 152.6 MB
W20240124 03:40:46.032107 53686 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10208faa1000 152.6 MB
W20240124 03:40:46.032150 53922 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 03:40:46.032197 53768 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 03:40:46.032225 53686 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 03:40:46.036092 54098 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 03:40:46.036172 54035 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 03:40:46.036226 53922 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 03:40:46.036242 53585 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 03:40:46.036257 53686 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 03:40:46.036295 53768 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
cudaHostRegister 0x100002e52000
5: KnownLocalCachedEmbedding init done
WARNING [54034 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
4: KnownLocalCachedEmbedding init done
WARNING [53914 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
3: KnownLocalCachedEmbedding init done
WARNING [53767 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
2: KnownLocalCachedEmbedding init done
WARNING [53685 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
1: KnownLocalCachedEmbedding init done
WARNING [53584 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 54034
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x100002e52000
0: KnownLocalCachedEmbedding init done
WARNING [28359 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 03:41:24.282909 54035 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240124 03:41:24.283027 54098 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 03:41:24.283169 53922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 03:41:24.283203 53585 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 03:41:24.283229 53768 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 03:41:24.283257 53686 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240124 03:41:24.284441 54035 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 03:41:24.284531 54035 grad_base.h:172] Init GradProcessingBase done
I20240124 03:41:33.641400 54035 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 03:41:33.641628 54035 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 03:41:33.641636 54035 kg_controller.h:84] Construct KGCacheController done
I20240124 03:41:34.297894 54035 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 03:41:50.591054 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 03:41:50.591339 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 03:41:52.159591 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 03:41:52.159701 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 03:41:56.503890 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 03:41:56.504092 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 03:41:57.068830 53768 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240124 03:41:57.425076 53922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240124 03:41:57.504015 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 03:41:57.869858 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 03:41:58.697750 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 03:41:58.841939 54035 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240124 03:41:58.900065 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
W20240124 03:42:00.494010 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:42:00.502192 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 03:42:00.576429 53686 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240124 03:42:05.019546 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:42:05.031170 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 03:42:05.107288 54098 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240124 03:42:07.082378 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:42:07.093922 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 03:42:07.182968 53585 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240124 03:42:08.093019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
E20240124 03:42:09.093019 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=1127
W20240124 03:42:09.208601 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 03:42:09.224900 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.467 ms                  | 45.316 ms                 |
| Forward                   | 5.454 ms                  | 834.328 ms                |
| Backward                  | 8.625 ms                  | 228.411 ms                |
| Optimize                  | 2.468 ms                  | 2.830 ms                  |
| BarrierTimeBeforeRank0    | 56.986 us                 | 5.508 ms                  |
| AfterBackward             | 913.796 ms                | 913.796 ms                |
| BlockToStepN              | 11.179 ms                 | 11.179 ms                 |
| OneStep                   | 2.038 s                   | 2.038 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.320 ms                  | 253.127 ms                |
| ProcessBack:UpdateCache   | 6.659 ms                  | 493.876 ms                |
| ProcessBack:UpsertPq      | 159.321 ms                | 161.317 ms                |
| ProcessOneStep            | 913.583 ms                | 913.583 ms                |
| BlockToStepN              | 10.792 ms                 | 10.792 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:09.844619 54035 grad_async_v2.h:236] pq is empty
E20240124 03:42:10.093008 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=4573
W20240124 03:42:10.476071 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240124 03:42:10.491489 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 03:42:11.093008 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=2606
W20240124 03:42:11.476016 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240124 03:42:11.784536 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 03:42:12.093011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 03:42:12.588348 54035 grad_async_v2.h:236] pq is empty
W20240124 03:42:12.702971 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240124 03:42:12.809532 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
E20240124 03:42:13.093008 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=332
W20240124 03:42:13.828014 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240124 03:42:13.895587 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240124 03:42:14.093017 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=4813
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.703 ms                 | 120.691 ms                |
| Forward                   | 5.506 ms                  | 834.328 ms                |
| Backward                  | 7.092 ms                  | 228.411 ms                |
| Optimize                  | 2.605 ms                  | 4.666 ms                  |
| BarrierTimeBeforeRank0    | 45.320 us                 | 45.442 ms                 |
| AfterBackward             | 70.536 ms                 | 1.058 s                   |
| BlockToStepN              | 6.271 ms                  | 86.808 ms                 |
| OneStep                   | 162.476 ms                | 2.038 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.207 ms                  | 252.659 ms                |
| ProcessBack:UpdateCache   | 5.738 ms                  | 493.840 ms                |
| ProcessBack:UpsertPq      | 40.204 ms                 | 159.321 ms                |
| ProcessOneStep            | 70.489 ms                 | 1.058 s                   |
| BlockToStepN              | 6.160 ms                  | 86.699 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 03:42:15.093012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=31
W20240124 03:42:15.101147 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240124 03:42:16.093019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
W20240124 03:42:16.183092 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 03:42:16.450892 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=33, pq.top=33
E20240124 03:42:17.093009 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=4343
W20240124 03:42:17.299834 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 03:42:17.588335 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=41, pq.top=41
E20240124 03:42:18.093015 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 03:42:18.303382 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240124 03:42:19.093026 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=22
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.674 ms                 | 120.691 ms                |
| Forward                   | 5.477 ms                  | 834.328 ms                |
| Backward                  | 6.725 ms                  | 228.411 ms                |
| Optimize                  | 2.606 ms                  | 13.534 ms                 |
| BarrierTimeBeforeRank0    | 44.652 us                 | 45.442 ms                 |
| AfterBackward             | 70.536 ms                 | 1.561 s                   |
| BlockToStepN              | 7.205 ms                  | 120.201 ms                |
| OneStep                   | 150.797 ms                | 2.038 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.089 ms                  | 252.659 ms                |
| ProcessBack:UpdateCache   | 5.611 ms                  | 493.840 ms                |
| ProcessBack:UpsertPq      | 41.324 ms                 | 159.321 ms                |
| ProcessOneStep            | 70.489 ms                 | 1.561 s                   |
| BlockToStepN              | 7.109 ms                  | 120.006 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:19.406523 55710 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 03:42:19.515169 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=45, pq.top=45
E20240124 03:42:20.093035 54930 parallel_pq_v2.h:76] insert failed, size(hashtable)=3561
W20240124 03:42:20.571853 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240124 03:42:20.588409 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
E20240124 03:42:21.093011 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=22381
W20240124 03:42:21.820467 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end0
E20240124 03:42:22.093012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=574
W20240124 03:42:22.737478 54035 grad_async_v2.h:236] pq is empty
W20240124 03:42:22.840700 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 03:42:22.858676 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
E20240124 03:42:23.093012 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=27528
W20240124 03:42:23.897347 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=69
E20240124 03:42:24.093016 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=1981
W20240124 03:42:24.120868 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.414 ms                 | 110.722 ms                |
| Forward                   | 5.613 ms                  | 15.904 ms                 |
| Backward                  | 5.831 ms                  | 8.625 ms                  |
| Optimize                  | 2.565 ms                  | 5.697 ms                  |
| BarrierTimeBeforeRank0    | 37.521 us                 | 44.475 ms                 |
| AfterBackward             | 65.746 ms                 | 1.497 s                   |
| BlockToStepN              | 15.001 ms                 | 98.599 ms                 |
| OneStep                   | 146.964 ms                | 1.583 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.180 ms                  | 252.659 ms                |
| ProcessBack:UpdateCache   | 5.551 ms                  | 493.840 ms                |
| ProcessBack:UpsertPq      | 41.985 ms                 | 159.321 ms                |
| ProcessOneStep            | 65.692 ms                 | 1.497 s                   |
| BlockToStepN              | 14.859 ms                 | 98.488 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 03:42:25.093022 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240124 03:42:25.215571 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240124 03:42:25.733165 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=75, pq.top=75
E20240124 03:42:26.093019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=163
W20240124 03:42:26.280778 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
W20240124 03:42:26.910774 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=85, pq.top=85
E20240124 03:42:27.093019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
W20240124 03:42:27.488922 55710 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
E20240124 03:42:28.093019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1043
W20240124 03:42:28.554270 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 03:42:28.610529 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=92, pq.top=92
E20240124 03:42:29.093012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1053
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.741 ms                 | 110.722 ms                |
| Forward                   | 5.816 ms                  | 15.904 ms                 |
| Backward                  | 5.793 ms                  | 8.625 ms                  |
| Optimize                  | 2.530 ms                  | 5.697 ms                  |
| BarrierTimeBeforeRank0    | 43.116 us                 | 45.442 ms                 |
| AfterBackward             | 61.580 ms                 | 1.497 s                   |
| BlockToStepN              | 19.067 ms                 | 120.201 ms                |
| OneStep                   | 141.171 ms                | 1.583 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.180 ms                  | 27.733 ms                 |
| ProcessBack:UpdateCache   | 5.507 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 41.324 ms                 | 112.245 ms                |
| ProcessOneStep            | 61.540 ms                 | 1.497 s                   |
| BlockToStepN              | 18.916 ms                 | 120.006 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 32.097, sample: 1.407, forward: 1.241, backward: 0.763, update: 0.226
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 24.414, sample: 1.318, forward: 1.313, backward: 0.993, update: 0.218
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.338, sample: 1.278, forward: 1.216, backward: 0.746, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 32.453, sample: 1.417, forward: 1.277, backward: 0.684, update: 0.239
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.945, sample: 1.238, forward: 1.334, backward: 0.798, update: 0.234
train_sampler.Prefill()
-------Step 0-------
tensor([    2891,   150688,  4353830,   536225,   536248, 63548793,  7271391,
          536267,   536295,   536323]) tensor([ 4828854, 40587573, 45386679,  4574275, 67146870, 20405820, 45503076,
        18629996, 73131484,  7121944])
-------Step 1-------
tensor([    2891,   150688,  4353830,   536225,   536248, 63548793,  7271391,
          536267,   536295,   536323]) tensor([41187266, 18118106, 10394732, 78272607,  1721030, 56825867, 23821912,
        13978782, 68531004, 72105714])
-------Step 2-------
tensor([  163638,  4464290,   324238,    77092, 70110376,    77139,    77181,
           77240,    77290, 24064115]) tensor([38970284, 22885771, 22454318,   327587,   176174, 38831389, 10185992,
         6945553, 17552411, 50349483])
-------Step 3-------
tensor([  163638,  4464290,   324238,    77092, 70110376,    77139,    77181,
           77240,    77290, 24064115]) tensor([61749248, 79041965, 12969134, 83057818, 48745488, 55918776, 72566098,
          327676,  2022344, 50280434])
-------Step 4-------
tensor([4312636,  177943,   23116,  177982,  178024,  178079,  178114, 4513951,
         178152,  176487]) tensor([17049928, 29279869, 43259725, 63601178, 77890501, 27849819,   657543,
        80493618, 85161280,  7339622])
-------Step 5-------
tensor([4312636,  177943,   23116,  177982,  178024,  178079,  178114, 4513951,
         178152,  176487]) tensor([77135608, 68257366,   667336, 18509542, 30868577,   228768, 11883713,
        60209420, 69696940, 81005421])
-------Step 6-------
tensor([  278090,   278112,   278130,   278154,   278188,   278208, 64079879,
           33269,   278232,  4493782]) tensor([54541453, 38099152, 39323997, 50986873, 21836039,  6885924, 69093434,
        20606657, 20619106, 85984142])
-------Step 7-------
tensor([  278090,   278112,   278130,   278154,   278188,   278208, 64079879,
           33269,   278232,  4493782]) tensor([ 8795881, 61213133, 77934452, 62504121, 64622539,  1805519, 82558095,
        43503320, 21736838,   542976])
-------Step 8-------
tensor([  335906, 11309472,   335933,   335953,   335986, 17554957,    43117,
          336010,   336032, 37261630]) tensor([26417069, 32506111, 77665377, 22319974, 41866792, 48912983, 56380230,
        57175513, 47940664, 38849527])
-------Step 9-------
tensor([  335906, 11309472,   335933,   335953,   335986, 17554957,    43117,
          336010,   336032, 37261630]) tensor([69175931, 63928414, 81039336, 85086836, 35568924, 12204070, 12040609,
        30917165, 33549733, 54124250])
before start barrier
start train
[proc 0] 100 steps, total: 30.679, sample: 1.990, forward: 1.416, backward: 0.808, update: 0.281
W20240124 03:42:29.610116 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240124 03:42:29.635272 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
E20240124 03:42:30.093016 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=3115
W20240124 03:42:30.783738 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 03:42:31.093011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=46
W20240124 03:42:31.285161 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240124 03:42:31.849375 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240124 03:42:32.093016 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=60310
W20240124 03:42:32.285259 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240124 03:42:32.976219 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
E20240124 03:42:33.093012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=2706
W20240124 03:42:33.285218 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240124 03:42:33.993757 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240124 03:42:34.093011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=486
W20240124 03:42:34.285166 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.660 ms                 | 110.722 ms                |
| Forward                   | 5.683 ms                  | 15.904 ms                 |
| Backward                  | 5.687 ms                  | 8.625 ms                  |
| Optimize                  | 2.493 ms                  | 5.697 ms                  |
| BarrierTimeBeforeRank0    | 43.694 us                 | 50.649 ms                 |
| AfterBackward             | 59.498 ms                 | 1.497 s                   |
| BlockToStepN              | 20.589 ms                 | 152.407 ms                |
| OneStep                   | 138.740 ms                | 1.583 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.310 ms                  | 25.374 ms                 |
| ProcessBack:UpdateCache   | 5.619 ms                  | 8.402 ms                  |
| ProcessBack:UpsertPq      | 37.241 ms                 | 107.001 ms                |
| ProcessOneStep            | 59.461 ms                 | 1.497 s                   |
| BlockToStepN              | 20.485 ms                 | 152.275 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 03:42:35.093011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=48
W20240124 03:42:35.194912 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240124 03:42:35.481118 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=129, pq.top=129
E20240124 03:42:36.093010 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1468
W20240124 03:42:36.282480 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 03:42:36.522944 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=137
E20240124 03:42:37.093006 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=353
W20240124 03:42:37.332126 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
E20240124 03:42:38.093014 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=2588
W20240124 03:42:38.416448 55710 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 03:42:38.542057 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=145
E20240124 03:42:39.093006 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=37196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.572 ms                 | 110.722 ms                |
| Forward                   | 5.647 ms                  | 15.904 ms                 |
| Backward                  | 5.679 ms                  | 8.625 ms                  |
| Optimize                  | 2.497 ms                  | 5.697 ms                  |
| BarrierTimeBeforeRank0    | 43.694 us                 | 50.649 ms                 |
| AfterBackward             | 59.810 ms                 | 1.497 s                   |
| BlockToStepN              | 20.589 ms                 | 152.407 ms                |
| OneStep                   | 135.719 ms                | 1.583 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.372 ms                  | 25.374 ms                 |
| ProcessBack:UpdateCache   | 5.715 ms                  | 8.402 ms                  |
| ProcessBack:UpsertPq      | 39.361 ms                 | 107.001 ms                |
| ProcessOneStep            | 59.759 ms                 | 1.497 s                   |
| BlockToStepN              | 20.485 ms                 | 152.275 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:39.499439 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 03:42:39.624863 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
E20240124 03:42:40.093017 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=47364
W20240124 03:42:40.504025 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 03:42:40.624213 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240124 03:42:41.093016 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=8939
W20240124 03:42:41.551801 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
W20240124 03:42:41.657114 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240124 03:42:42.093006 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=597
W20240124 03:42:42.587790 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 03:42:42.698199 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=170, pq.top=170
E20240124 03:42:43.094513 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=6553
W20240124 03:42:43.685591 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 03:42:43.744812 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=177, pq.top=176
E20240124 03:42:44.094019 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=38607
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.660 ms                 | 110.722 ms                |
| Forward                   | 5.668 ms                  | 15.904 ms                 |
| Backward                  | 5.656 ms                  | 8.625 ms                  |
| Optimize                  | 2.483 ms                  | 5.418 ms                  |
| BarrierTimeBeforeRank0    | 35.890 us                 | 45.451 ms                 |
| AfterBackward             | 59.068 ms                 | 1.228 s                   |
| BlockToStepN              | 25.508 ms                 | 176.940 ms                |
| OneStep                   | 143.443 ms                | 1.574 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.372 ms                  | 13.196 ms                 |
| ProcessBack:UpdateCache   | 5.667 ms                  | 8.337 ms                  |
| ProcessBack:UpsertPq      | 34.716 ms                 | 102.168 ms                |
| ProcessOneStep            | 59.008 ms                 | 1.228 s                   |
| BlockToStepN              | 25.407 ms                 | 176.683 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:44.755379 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240124 03:42:44.938114 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=185, pq.top=185
E20240124 03:42:45.094017 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=4316
W20240124 03:42:45.848887 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
E20240124 03:42:46.094012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1239
W20240124 03:42:46.753183 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240124 03:42:46.865020 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:42:47.094012 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=7529
W20240124 03:42:47.754168 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 3] 200 steps, total: 18.456, sample: 1.608, forward: 0.548, backward: 0.592, update: 0.230
[proc 2] 200 steps, total: 18.456, sample: 1.346, forward: 0.514, backward: 0.547, update: 0.235
[proc 5] 200 steps, total: 18.456, sample: 1.502, forward: 0.531, backward: 0.594, update: 0.231
[proc 4] 200 steps, total: 18.456, sample: 1.155, forward: 0.487, backward: 0.568, update: 0.218
[proc 0] 200 steps, total: 18.454, sample: 1.857, forward: 0.554, backward: 0.550, update: 0.246
[proc 1] 200 steps, total: 18.456, sample: 1.329, forward: 0.524, backward: 0.537, update: 0.237
W20240124 03:42:47.985270 55710 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
E20240124 03:42:48.094013 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=33586
W20240124 03:42:48.754737 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240124 03:42:49.046380 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240124 03:42:49.094877 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=28817
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.572 ms                 | 110.722 ms                |
| Forward                   | 5.652 ms                  | 15.904 ms                 |
| Backward                  | 5.597 ms                  | 8.625 ms                  |
| Optimize                  | 2.477 ms                  | 5.418 ms                  |
| BarrierTimeBeforeRank0    | 37.521 us                 | 50.649 ms                 |
| AfterBackward             | 58.246 ms                 | 1.228 s                   |
| BlockToStepN              | 27.568 ms                 | 176.940 ms                |
| OneStep                   | 141.914 ms                | 1.574 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.370 ms                  | 13.196 ms                 |
| ProcessBack:UpdateCache   | 5.546 ms                  | 8.337 ms                  |
| ProcessBack:UpsertPq      | 30.339 ms                 | 102.168 ms                |
| ProcessOneStep            | 58.195 ms                 | 1.228 s                   |
| BlockToStepN              | 27.439 ms                 | 176.683 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:49.787508 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240124 03:42:50.049495 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:42:50.094012 54930 parallel_pq_v2.h:76] insert failed, size(hashtable)=3552
W20240124 03:42:50.787137 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240124 03:42:51.057415 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240124 03:42:51.094012 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=27956
W20240124 03:42:51.787477 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240124 03:42:52.058065 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240124 03:42:52.094005 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=26224
W20240124 03:42:52.787308 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240124 03:42:53.094017 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1450
W20240124 03:42:53.096959 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
W20240124 03:42:53.822293 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=232, pq.top=232
E20240124 03:42:54.094007 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=8593
W20240124 03:42:54.232940 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.327 ms                 | 110.722 ms                |
| Forward                   | 5.725 ms                  | 15.904 ms                 |
| Backward                  | 5.600 ms                  | 8.625 ms                  |
| Optimize                  | 2.447 ms                  | 5.418 ms                  |
| BarrierTimeBeforeRank0    | 37.521 us                 | 52.701 ms                 |
| AfterBackward             | 57.320 ms                 | 1.228 s                   |
| BlockToStepN              | 34.223 ms                 | 188.002 ms                |
| OneStep                   | 146.913 ms                | 1.574 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.320 ms                  | 13.196 ms                 |
| ProcessBack:UpdateCache   | 5.432 ms                  | 8.174 ms                  |
| ProcessBack:UpsertPq      | 29.034 ms                 | 102.168 ms                |
| ProcessOneStep            | 57.275 ms                 | 1.228 s                   |
| BlockToStepN              | 34.065 ms                 | 187.863 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:54.822083 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
E20240124 03:42:55.094010 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=140099
W20240124 03:42:55.281391 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240124 03:42:55.822079 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240124 03:42:56.097908 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=108686
W20240124 03:42:56.352710 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 03:42:56.883812 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=249, pq.top=249
E20240124 03:42:57.097009 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=3704
W20240124 03:42:57.356968 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 03:42:57.883383 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=255, pq.top=255
E20240124 03:42:58.100025 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=56993
W20240124 03:42:58.389606 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 03:42:58.913412 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=260
E20240124 03:42:59.100016 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=34233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.151 ms                 | 105.044 ms                |
| Forward                   | 5.731 ms                  | 12.097 ms                 |
| Backward                  | 5.589 ms                  | 8.143 ms                  |
| Optimize                  | 2.439 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 37.521 us                 | 50.649 ms                 |
| AfterBackward             | 57.329 ms                 | 1.136 s                   |
| BlockToStepN              | 35.456 ms                 | 303.160 ms                |
| OneStep                   | 147.001 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.451 ms                  | 13.196 ms                 |
| ProcessBack:UpdateCache   | 5.551 ms                  | 8.611 ms                  |
| ProcessBack:UpsertPq      | 28.522 ms                 | 107.001 ms                |
| ProcessOneStep            | 57.282 ms                 | 1.136 s                   |
| BlockToStepN              | 35.365 ms                 | 302.988 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:42:59.402150 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 03:42:59.996513 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
E20240124 03:43:00.100010 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=23973
W20240124 03:43:00.481312 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 03:43:00.996281 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=272
E20240124 03:43:01.100010 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=6162
W20240124 03:43:01.628892 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
W20240124 03:43:01.996347 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=278, pq.top=278
E20240124 03:43:02.103780 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 03:43:02.686566 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240124 03:43:03.002698 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240124 03:43:03.103011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=24764
W20240124 03:43:03.740932 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240124 03:43:04.002293 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=292
E20240124 03:43:04.103013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=28739
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.129 ms                 | 105.044 ms                |
| Forward                   | 5.727 ms                  | 12.097 ms                 |
| Backward                  | 5.529 ms                  | 8.143 ms                  |
| Optimize                  | 2.411 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 34.825 us                 | 50.649 ms                 |
| AfterBackward             | 56.851 ms                 | 1.136 s                   |
| BlockToStepN              | 40.317 ms                 | 303.160 ms                |
| OneStep                   | 147.913 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.519 ms                  | 13.739 ms                 |
| ProcessBack:UpdateCache   | 5.623 ms                  | 8.554 ms                  |
| ProcessBack:UpsertPq      | 27.198 ms                 | 102.168 ms                |
| ProcessOneStep            | 56.803 ms                 | 1.136 s                   |
| BlockToStepN              | 40.147 ms                 | 302.988 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:04.798552 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 03:43:05.099316 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=296, pq.top=296
E20240124 03:43:05.103009 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=75535
W20240124 03:43:05.803558 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
[proc 2] 300 steps, total: 17.859, sample: 1.103, forward: 0.510, backward: 0.554, update: 0.228
[proc 0] 300 steps, total: 17.859, sample: 1.605, forward: 0.567, backward: 0.540, update: 0.235
[proc 4] 300 steps, total: 17.859, sample: 0.990, forward: 0.536, backward: 0.617, update: 0.231
[proc 3] 300 steps, total: 17.859, sample: 1.276, forward: 0.495, backward: 0.607, update: 0.260
[proc 5] 300 steps, total: 17.859, sample: 1.449, forward: 0.490, backward: 0.496, update: 0.215
[proc 1] 300 steps, total: 17.859, sample: 1.145, forward: 0.569, backward: 0.552, update: 0.238
E20240124 03:43:06.103008 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=8784
W20240124 03:43:06.127537 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240124 03:43:06.819736 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240124 03:43:07.103024 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=44303
W20240124 03:43:07.127022 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240124 03:43:07.870637 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 03:43:08.103006 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=49208
W20240124 03:43:08.149070 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240124 03:43:08.889663 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 03:43:09.103024 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=42778
W20240124 03:43:09.149017 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.027 ms                 | 105.044 ms                |
| Forward                   | 5.668 ms                  | 15.904 ms                 |
| Backward                  | 5.504 ms                  | 8.143 ms                  |
| Optimize                  | 2.397 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 33.516 us                 | 50.649 ms                 |
| AfterBackward             | 56.238 ms                 | 1.136 s                   |
| BlockToStepN              | 40.572 ms                 | 387.641 ms                |
| OneStep                   | 149.263 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.389 ms                  | 13.930 ms                 |
| ProcessBack:UpdateCache   | 5.545 ms                  | 8.554 ms                  |
| ProcessBack:UpsertPq      | 26.841 ms                 | 102.168 ms                |
| ProcessOneStep            | 56.188 ms                 | 1.136 s                   |
| BlockToStepN              | 40.451 ms                 | 387.490 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:09.931368 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 03:43:10.110338 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=11933
W20240124 03:43:10.159734 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240124 03:43:10.987363 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 03:43:11.110008 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=2384
W20240124 03:43:11.159461 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240124 03:43:11.990954 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 03:43:12.110010 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=15161
W20240124 03:43:12.159509 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240124 03:43:13.044862 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 03:43:13.110008 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=44061
W20240124 03:43:13.159255 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240124 03:43:14.060519 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 03:43:14.110008 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=5630
W20240124 03:43:14.159544 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.654 ms                  | 105.044 ms                |
| Forward                   | 5.633 ms                  | 15.904 ms                 |
| Backward                  | 5.486 ms                  | 8.625 ms                  |
| Optimize                  | 2.392 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 33.973 us                 | 50.649 ms                 |
| AfterBackward             | 55.296 ms                 | 1.136 s                   |
| BlockToStepN              | 41.442 ms                 | 387.641 ms                |
| OneStep                   | 150.448 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.372 ms                  | 13.739 ms                 |
| ProcessBack:UpdateCache   | 5.527 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 26.204 ms                 | 102.168 ms                |
| ProcessOneStep            | 55.243 ms                 | 1.136 s                   |
| BlockToStepN              | 41.288 ms                 | 387.490 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:15.085222 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 03:43:15.110291 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=60873
W20240124 03:43:15.190899 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240124 03:43:16.110013 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=36363
W20240124 03:43:16.198899 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 03:43:16.292976 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=360, pq.top=360
E20240124 03:43:17.110009 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=28758
W20240124 03:43:17.251037 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
W20240124 03:43:17.375948 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
E20240124 03:43:18.110011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=78965
W20240124 03:43:18.254220 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
W20240124 03:43:18.488329 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240124 03:43:19.110008 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=581
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.682 ms                  | 105.044 ms                |
| Forward                   | 5.605 ms                  | 12.097 ms                 |
| Backward                  | 5.503 ms                  | 8.625 ms                  |
| Optimize                  | 2.383 ms                  | 4.888 ms                  |
| BarrierTimeBeforeRank0    | 33.405 us                 | 48.896 ms                 |
| AfterBackward             | 55.724 ms                 | 1.107 s                   |
| BlockToStepN              | 42.560 ms                 | 382.728 ms                |
| OneStep                   | 150.797 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.428 ms                  | 15.108 ms                 |
| ProcessBack:UpdateCache   | 5.562 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 26.204 ms                 | 101.868 ms                |
| ProcessOneStep            | 55.679 ms                 | 1.107 s                   |
| BlockToStepN              | 42.451 ms                 | 382.615 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:19.376607 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 03:43:19.488713 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240124 03:43:20.110013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=5653
W20240124 03:43:20.511112 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240124 03:43:20.571771 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240124 03:43:21.110008 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=155623
W20240124 03:43:21.598409 55710 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
E20240124 03:43:22.110013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=17362
W20240124 03:43:22.223137 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240124 03:43:22.647974 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240124 03:43:23.110009 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=6923
W20240124 03:43:23.287703 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=398, pq.top=398
[proc 3] 400 steps, total: 17.650, sample: 1.081, forward: 0.475, backward: 0.629, update: 0.221
[proc 0] 400 steps, total: 17.650, sample: 1.648, forward: 0.531, backward: 0.563, update: 0.239
[proc 1] 400 steps, total: 17.650, sample: 1.008, forward: 0.511, backward: 0.538, update: 0.236
[proc 2] 400 steps, total: 17.650, sample: 1.049, forward: 0.530, backward: 0.585, update: 0.231
[proc 4] 400 steps, total: 17.650, sample: 1.046, forward: 0.485, backward: 0.546, update: 0.225
[proc 5] 400 steps, total: 17.650, sample: 1.316, forward: 0.485, backward: 0.499, update: 0.217
W20240124 03:43:23.671391 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240124 03:43:24.110024 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=229421
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.528 ms                  | 105.044 ms                |
| Forward                   | 5.592 ms                  | 12.097 ms                 |
| Backward                  | 5.503 ms                  | 8.625 ms                  |
| Optimize                  | 2.373 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 33.044 us                 | 50.649 ms                 |
| AfterBackward             | 55.635 ms                 | 1.107 s                   |
| BlockToStepN              | 43.549 ms                 | 382.728 ms                |
| OneStep                   | 150.448 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.469 ms                  | 15.108 ms                 |
| ProcessBack:UpdateCache   | 5.553 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 25.473 ms                 | 102.168 ms                |
| ProcessOneStep            | 55.595 ms                 | 1.107 s                   |
| BlockToStepN              | 43.435 ms                 | 382.615 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:24.335862 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240124 03:43:24.798386 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
E20240124 03:43:25.110010 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=20667
W20240124 03:43:25.335906 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240124 03:43:25.878866 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240124 03:43:26.110016 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=6515
W20240124 03:43:26.335781 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
E20240124 03:43:27.110016 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=147940
W20240124 03:43:27.156451 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240124 03:43:27.385509 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240124 03:43:28.110010 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=114220
W20240124 03:43:28.230592 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
W20240124 03:43:28.386062 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
E20240124 03:43:29.110011 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=86963
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.449 ms                  | 105.044 ms                |
| Forward                   | 5.583 ms                  | 12.097 ms                 |
| Backward                  | 5.501 ms                  | 8.625 ms                  |
| Optimize                  | 2.366 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 33.044 us                 | 50.649 ms                 |
| AfterBackward             | 55.118 ms                 | 1.107 s                   |
| BlockToStepN              | 44.626 ms                 | 435.358 ms                |
| OneStep                   | 150.817 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.467 ms                  | 13.930 ms                 |
| ProcessBack:UpdateCache   | 5.555 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 24.474 ms                 | 102.168 ms                |
| ProcessOneStep            | 55.073 ms                 | 1.107 s                   |
| BlockToStepN              | 44.509 ms                 | 435.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:29.429004 55710 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240124 03:43:29.443809 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
E20240124 03:43:30.110010 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=71564
W20240124 03:43:30.453361 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240124 03:43:30.552749 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240124 03:43:31.110009 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=10889
W20240124 03:43:31.455353 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=442, pq.top=442
W20240124 03:43:31.580039 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 03:43:32.113256 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=59764
W20240124 03:43:32.475039 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240124 03:43:32.588035 55710 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end0
E20240124 03:43:33.113013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=219129
W20240124 03:43:33.475775 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240124 03:43:33.686483 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
E20240124 03:43:34.113010 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.382 ms                  | 103.877 ms                |
| Forward                   | 5.569 ms                  | 12.097 ms                 |
| Backward                  | 5.486 ms                  | 8.143 ms                  |
| Optimize                  | 2.345 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 32.600 us                 | 48.896 ms                 |
| AfterBackward             | 55.296 ms                 | 1.068 s                   |
| BlockToStepN              | 45.353 ms                 | 435.358 ms                |
| OneStep                   | 150.957 ms                | 1.159 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.483 ms                  | 13.930 ms                 |
| ProcessBack:UpdateCache   | 5.564 ms                  | 8.403 ms                  |
| ProcessBack:UpsertPq      | 23.624 ms                 | 102.168 ms                |
| ProcessOneStep            | 55.243 ms                 | 1.068 s                   |
| BlockToStepN              | 45.276 ms                 | 435.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:34.507382 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240124 03:43:34.731726 55710 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 03:43:35.113009 55709 parallel_pq_v2.h:76] insert failed, size(hashtable)=46739
W20240124 03:43:35.507083 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240124 03:43:35.819221 55710 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 03:43:36.113014 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=234752
W20240124 03:43:36.507273 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240124 03:43:37.062199 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
E20240124 03:43:37.113013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=35081
W20240124 03:43:37.559644 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240124 03:43:38.069474 55710 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 03:43:38.113010 54930 parallel_pq_v2.h:76] insert failed, size(hashtable)=177772
W20240124 03:43:38.626677 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240124 03:43:39.081353 55710 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
E20240124 03:43:39.113014 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=312927
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.172 ms                  | 103.877 ms                |
| Forward                   | 5.537 ms                  | 12.097 ms                 |
| Backward                  | 5.477 ms                  | 8.625 ms                  |
| Optimize                  | 2.337 ms                  | 5.220 ms                  |
| BarrierTimeBeforeRank0    | 32.965 us                 | 50.649 ms                 |
| AfterBackward             | 55.362 ms                 | 1.068 s                   |
| BlockToStepN              | 44.436 ms                 | 435.358 ms                |
| OneStep                   | 150.817 ms                | 1.159 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.523 ms                  | 13.739 ms                 |
| ProcessBack:UpdateCache   | 5.623 ms                  | 8.402 ms                  |
| ProcessBack:UpsertPq      | 23.101 ms                 | 101.868 ms                |
| ProcessOneStep            | 55.287 ms                 | 1.068 s                   |
| BlockToStepN              | 44.306 ms                 | 435.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 03:43:39.626467 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=487, pq.top=487
E20240124 03:43:40.113010 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=96339
W20240124 03:43:40.153800 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240124 03:43:40.639516 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=488
E20240124 03:43:41.113015 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=1557
W20240124 03:43:41.188079 55710 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 03:43:41.639163 54035 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=493, pq.top=493
E20240124 03:43:42.113011 54035 parallel_pq_v2.h:76] insert failed, size(hashtable)=4631
W20240124 03:43:42.251477 55710 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
[proc 0] 500 steps, total: 18.963, sample: 1.519, forward: 0.526, backward: 0.558, update: 0.213
[proc 4] 500 steps, total: 18.963, sample: 0.885, forward: 0.459, backward: 0.534, update: 0.221
[proc 2] 500 steps, total: 18.963, sample: 1.041, forward: 0.499, backward: 0.560, update: 0.227
[proc 1] 500 steps, total: 18.963, sample: 0.981, forward: 0.502, backward: 0.523, update: 0.236
[proc 3] 500 steps, total: 18.964, sample: 1.073, forward: 0.530, backward: 0.481, update: 0.260
[proc 5] 500 steps, total: 18.963, sample: 1.198, forward: 0.479, backward: 0.524, update: 0.209
Successfully xmh. training takes 103.60875678062439 seconds
before call kg_cache_controller.StopThreads()
W20240124 03:43:42.450699 54035 grad_async_v2.h:71] call StopThreads. PID = 28359
W20240124 03:43:42.450740 54035 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 03:43:42.451038 54035 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 03:43:42.451050 54035 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
E20240124 03:43:43.113013 55710 parallel_pq_v2.h:76] insert failed, size(hashtable)=3289
W20240124 03:43:43.236878 54035 grad_async_v2.h:91] StopThreads done.
