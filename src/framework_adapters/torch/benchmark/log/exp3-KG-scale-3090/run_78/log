WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 18:12:25.912247  4192 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_25', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [4192 sampler.py:454] Start PreSampling
WARNING [4192 sampler.py:532] Before construct renumbering_dict
WARNING [4192 sampler.py:555] PreSampling done
W20240123 18:25:25.646788  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 18:25:25.647022  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 18:25:25.647058  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 18:25:25.647089  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 18:25:25.647112  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 18:25:25.647135  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 18:25:25.647154  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 18:25:25.647182  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 18:25:25.647207  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 18:25:25.647238  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 18:25:25.647266  4192 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 18:25:25.647284  4192 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 18:25:25.647310  4192 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 18:25:25.647456  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 18:25:25.647485  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 18:25:25.647509  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 18:25:25.647526  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 18:25:25.647557  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 18:25:25.647578  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 18:25:25.647604  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 18:25:25.647627  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 18:25:25.647665  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 18:25:25.647691  4192 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 18:25:25.647712  4192 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 18:25:25.647725  4192 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 18:25:25.647743  4192 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 18:25:25.964180  4192 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100000f72000 128.2 GB
W20240123 18:25:25.964354  4192 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10200fbaa000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4302707,  4302721,   626427,  ..., 21904485, 26059441, 57766356]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 956.495 seconds
INFO [29088 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29088 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [4192 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [4192 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [29088 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [4192 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [29088 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [29088 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [4192 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [4192 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 18:28:24.101132 29089 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240123 18:28:24.101239 29152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
I20240123 18:28:49.069049 29152 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240123 18:28:50.174252 29089 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.025 ms                 | 83.975 ms                 |
| Forward                   | 8.885 ms                  | 571.082 ms                |
| Backward                  | 82.773 ms                 | 179.596 ms                |
| Optimize                  | 1.909 ms                  | 3.510 ms                  |
| BarrierTimeBeforeRank0    | 50.357 us                 | 26.515 ms                 |
| BlockToStepN              | 6.408 us                  | 36.505 us                 |
| OneStep                   | 110.338 ms                | 777.298 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.672 ms                  | 78.701 ms                 |
| Forward                   | 8.927 ms                  | 12.707 ms                 |
| Backward                  | 139.717 ms                | 232.902 ms                |
| Optimize                  | 1.906 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 43.776 us                 | 32.698 ms                 |
| BlockToStepN              | 7.910 us                  | 21.428 us                 |
| OneStep                   | 163.733 ms                | 266.812 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.076 ms                 | 83.975 ms                 |
| Forward                   | 8.896 ms                  | 12.707 ms                 |
| Backward                  | 168.693 ms                | 298.495 ms                |
| Optimize                  | 1.868 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 42.871 us                 | 32.698 ms                 |
| BlockToStepN              | 8.584 us                  | 36.505 us                 |
| OneStep                   | 200.273 ms                | 344.867 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.544 ms                  | 83.975 ms                 |
| Forward                   | 8.870 ms                  | 23.952 ms                 |
| Backward                  | 188.051 ms                | 359.915 ms                |
| Optimize                  | 1.852 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 41.054 us                 | 32.698 ms                 |
| BlockToStepN              | 8.837 us                  | 36.505 us                 |
| OneStep                   | 226.591 ms                | 399.979 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.175 ms                  | 83.975 ms                 |
| Forward                   | 8.873 ms                  | 23.952 ms                 |
| Backward                  | 218.916 ms                | 421.749 ms                |
| Optimize                  | 1.865 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 40.578 us                 | 32.698 ms                 |
| BlockToStepN              | 9.043 us                  | 65.865 us                 |
| OneStep                   | 244.413 ms                | 543.690 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.869, sample: 1.135, forward: 2.118, backward: 22.049, update: 0.187
[Rank1] pid = 29088
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
train_sampler.Prefill()
-------Step 0-------
tensor([1365062, 1365090, 1365112, 1412334, 1365130, 1365158, 1365195,   16067,
        1365224, 1365251]) tensor([  184826,  4635739, 19582607, 56791865, 40270272, 17869851, 60311139,
         8952375, 52782204, 73977754])
-------Step 1-------
tensor([1365062, 1365090, 1365112, 1412334, 1365130, 1365158, 1365195,   16067,
        1365224, 1365251]) tensor([59124327, 74649036, 55383870, 34465234, 50493060,   170986, 33813457,
        62723395, 79490053, 80171082])
-------Step 2-------
tensor([1447381, 1447410, 1447444, 1447472, 1447498, 1447537, 1447559, 1447583,
        1419589, 1447616]) tensor([19334059, 14269261, 35327240, 61305953, 29959429,  1802836, 42810709,
        57448135, 54960151, 14959713])
-------Step 3-------
tensor([1447381, 1447410, 1447444, 1447472, 1447498, 1447537, 1447559, 1447583,
        1419589, 1447616]) tensor([40761064, 81818282,  2349560, 31832873, 45111505, 46550482, 28007750,
        55897130, 64375435, 20601387])
-------Step 4-------
tensor([ 1532755,  1532773,   262516,  1532814,   262556, 59189057,  1041596,
         1532834,  1532864,  1532898]) tensor([  911911, 80558906, 23162431, 40848288, 85392213, 64563026, 44529255,
        26753900, 22998654, 44435952])
-------Step 5-------
tensor([ 1532755,  1532773,   262516,  1532814,   262556, 59189057,  1041596,
         1532834,  1532864,  1532898]) tensor([44045551, 43894345, 61900501, 19094992, 21868658, 59666987, 45073177,
        12182828, 70741680, 68277803])
-------Step 6-------
tensor([ 1619039,  1619069,  1619094,   450960,  1619118,  1619158,  1619191,
        13523401,  1619217,  4333630]) tensor([14019254, 27392670,  6299020,  1330612, 19249769, 18425988,  2953091,
         1714858, 71136890, 19383460])
-------Step 7-------
tensor([ 1619039,  1619069,  1619094,   450960,  1619118,  1619158,  1619191,
        13523401,  1619217,  4333630]) tensor([76554770, 77149489, 58190402,  1758211,  8987484, 33120450, 57568773,
        67469087, 54845929,  9020846])
-------Step 8-------
tensor([1704287, 1704304, 1704330,  453691, 1704359, 1704386, 1704424,  264968,
        1704462, 1704491]) tensor([69083822, 70928250,   426718,  4352364, 51293674, 34603658, 77086658,
        81126652, 42324523, 21922288])
-------Step 9-------
tensor([1704287, 1704304, 1704330,  453691, 1704359, 1704386, 1704424,  264968,
        1704462, 1704491]) tensor([  548777, 33063581, 21794325, 56704522, 29830693,  1964753, 22720204,
        43625979, 25163975, 59364435])
before start barrier
start train
[proc 0] 100 steps, total: 26.763, sample: 1.376, forward: 1.464, backward: 23.363, update: 0.180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.013 ms                  | 83.975 ms                 |
| Forward                   | 8.873 ms                  | 23.952 ms                 |
| Backward                  | 237.159 ms                | 488.090 ms                |
| Optimize                  | 1.859 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 39.585 us                 | 56.997 ms                 |
| BlockToStepN              | 9.155 us                  | 65.865 us                 |
| OneStep                   | 259.616 ms                | 562.325 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.276 ms                  | 83.975 ms                 |
| Forward                   | 8.870 ms                  | 23.952 ms                 |
| Backward                  | 251.087 ms                | 504.552 ms                |
| Optimize                  | 1.859 ms                  | 2.747 ms                  |
| BarrierTimeBeforeRank0    | 38.378 us                 | 56.997 ms                 |
| BlockToStepN              | 9.195 us                  | 65.865 us                 |
| OneStep                   | 284.278 ms                | 562.325 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.775 ms                  | 83.975 ms                 |
| Forward                   | 8.862 ms                  | 23.952 ms                 |
| Backward                  | 284.111 ms                | 535.753 ms                |
| Optimize                  | 1.868 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 38.044 us                 | 56.997 ms                 |
| BlockToStepN              | 9.440 us                  | 65.865 us                 |
| OneStep                   | 303.164 ms                | 614.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.544 ms                  | 83.975 ms                 |
| Forward                   | 8.862 ms                  | 23.952 ms                 |
| Backward                  | 292.510 ms                | 597.550 ms                |
| Optimize                  | 1.875 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 37.675 us                 | 56.997 ms                 |
| BlockToStepN              | 9.464 us                  | 65.865 us                 |
| OneStep                   | 315.455 ms                | 777.298 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.628 ms                  | 83.975 ms                 |
| Forward                   | 8.856 ms                  | 23.952 ms                 |
| Backward                  | 306.322 ms                | 606.576 ms                |
| Optimize                  | 1.884 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 38.044 us                 | 86.930 ms                 |
| BlockToStepN              | 9.458 us                  | 65.865 us                 |
| OneStep                   | 344.867 ms                | 777.298 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.386 ms                  | 83.975 ms                 |
| Forward                   | 8.872 ms                  | 23.952 ms                 |
| Backward                  | 328.333 ms                | 667.544 ms                |
| Optimize                  | 1.888 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 37.302 us                 | 103.799 ms                |
| BlockToStepN              | 9.566 us                  | 65.865 us                 |
| OneStep                   | 355.113 ms                | 780.423 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.386 ms                  | 78.701 ms                 |
| Forward                   | 8.874 ms                  | 12.707 ms                 |
| Backward                  | 339.154 ms                | 732.024 ms                |
| Optimize                  | 1.890 ms                  | 2.850 ms                  |
| BarrierTimeBeforeRank0    | 36.651 us                 | 86.930 ms                 |
| BlockToStepN              | 9.686 us                  | 42.594 us                 |
| OneStep                   | 371.438 ms                | 787.512 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 78.701 ms                 |
| Forward                   | 8.874 ms                  | 12.707 ms                 |
| Backward                  | 356.412 ms                | 732.024 ms                |
| Optimize                  | 1.896 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 36.333 us                 | 86.930 ms                 |
| BlockToStepN              | 9.752 us                  | 42.594 us                 |
| OneStep                   | 384.877 ms                | 787.512 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.432 ms                  | 78.701 ms                 |
| Forward                   | 8.873 ms                  | 12.707 ms                 |
| Backward                  | 374.000 ms                | 735.225 ms                |
| Optimize                  | 1.897 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 35.910 us                 | 86.930 ms                 |
| BlockToStepN              | 9.764 us                  | 42.594 us                 |
| OneStep                   | 399.979 ms                | 804.250 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 78.701 ms                 |
| Forward                   | 8.873 ms                  | 12.707 ms                 |
| Backward                  | 390.881 ms                | 756.212 ms                |
| Optimize                  | 1.897 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 86.930 ms                 |
| BlockToStepN              | 9.831 us                  | 42.594 us                 |
| OneStep                   | 417.800 ms                | 804.250 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.136 ms                  | 78.701 ms                 |
| Forward                   | 8.885 ms                  | 12.707 ms                 |
| Backward                  | 408.310 ms                | 804.134 ms                |
| Optimize                  | 1.900 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.000 us                 | 42.594 us                 |
| OneStep                   | 432.499 ms                | 879.607 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.896 ms                  | 12.707 ms                 |
| Backward                  | 416.200 ms                | 866.815 ms                |
| Optimize                  | 1.902 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.022 us                 | 65.865 us                 |
| OneStep                   | 444.610 ms                | 895.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.897 ms                  | 12.707 ms                 |
| Backward                  | 424.370 ms                | 866.815 ms                |
| Optimize                  | 1.904 ms                  | 2.965 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.063 us                 | 65.865 us                 |
| OneStep                   | 459.699 ms                | 895.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.976 ms                  | 79.749 ms                 |
| Forward                   | 8.903 ms                  | 12.707 ms                 |
| Backward                  | 439.235 ms                | 879.553 ms                |
| Optimize                  | 1.906 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.144 us                 | 65.865 us                 |
| OneStep                   | 474.706 ms                | 979.040 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 69.250, sample: 1.103, forward: 1.384, backward: 62.141, update: 0.190
[proc 0] 200 steps, total: 69.250, sample: 1.244, forward: 0.899, backward: 66.390, update: 0.187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.066 ms                  | 79.749 ms                 |
| Forward                   | 8.907 ms                  | 12.707 ms                 |
| Backward                  | 446.703 ms                | 879.553 ms                |
| Optimize                  | 1.909 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 103.799 ms                |
| BlockToStepN              | 10.209 us                 | 75.556 us                 |
| OneStep                   | 481.162 ms                | 979.040 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.136 ms                  | 79.749 ms                 |
| Forward                   | 8.911 ms                  | 12.707 ms                 |
| Backward                  | 460.904 ms                | 891.132 ms                |
| Optimize                  | 1.910 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 103.799 ms                |
| BlockToStepN              | 10.152 us                 | 75.556 us                 |
| OneStep                   | 485.599 ms                | 979.040 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.066 ms                  | 79.749 ms                 |
| Forward                   | 8.923 ms                  | 12.707 ms                 |
| Backward                  | 467.066 ms                | 948.960 ms                |
| Optimize                  | 1.911 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 35.910 us                 | 103.799 ms                |
| BlockToStepN              | 10.221 us                 | 75.556 us                 |
| OneStep                   | 495.054 ms                | 979.040 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.924 ms                  | 12.707 ms                 |
| Backward                  | 471.448 ms                | 1.123 s                   |
| Optimize                  | 1.913 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 103.799 ms                |
| BlockToStepN              | 10.266 us                 | 75.556 us                 |
| OneStep                   | 516.834 ms                | 1.142 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.146 ms                  | 79.749 ms                 |
| Forward                   | 8.927 ms                  | 12.707 ms                 |
| Backward                  | 488.090 ms                | 1.123 s                   |
| Optimize                  | 1.914 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.333 us                 | 75.556 us                 |
| OneStep                   | 525.802 ms                | 1.142 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.933 ms                  | 12.707 ms                 |
| Backward                  | 499.400 ms                | 1.123 s                   |
| Optimize                  | 1.915 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 103.799 ms                |
| BlockToStepN              | 10.343 us                 | 121.116 us                |
| OneStep                   | 531.559 ms                | 1.142 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 83.975 ms                 |
| Forward                   | 8.933 ms                  | 12.707 ms                 |
| Backward                  | 518.306 ms                | 1.141 s                   |
| Optimize                  | 1.916 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 103.799 ms                |
| BlockToStepN              | 10.361 us                 | 121.116 us                |
| OneStep                   | 543.690 ms                | 1.188 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.146 ms                  | 83.975 ms                 |
| Forward                   | 8.935 ms                  | 12.707 ms                 |
| Backward                  | 520.960 ms                | 1.232 s                   |
| Optimize                  | 1.919 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 103.799 ms                |
| BlockToStepN              | 10.420 us                 | 121.116 us                |
| OneStep                   | 561.907 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 83.975 ms                 |
| Forward                   | 8.943 ms                  | 12.707 ms                 |
| Backward                  | 527.582 ms                | 1.232 s                   |
| Optimize                  | 1.920 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 33.845 us                 | 103.799 ms                |
| BlockToStepN              | 10.454 us                 | 121.116 us                |
| OneStep                   | 572.066 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 83.975 ms                 |
| Forward                   | 8.935 ms                  | 12.707 ms                 |
| Backward                  | 555.288 ms                | 1.232 s                   |
| Optimize                  | 1.926 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 33.480 us                 | 103.799 ms                |
| BlockToStepN              | 10.521 us                 | 121.116 us                |
| OneStep                   | 576.229 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.935 ms                  | 12.449 ms                 |
| Backward                  | 559.644 ms                | 1.232 s                   |
| Optimize                  | 1.932 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.431 us                 | 86.930 ms                 |
| BlockToStepN              | 10.526 us                 | 75.556 us                 |
| OneStep                   | 586.444 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.942 ms                  | 12.449 ms                 |
| Backward                  | 564.841 ms                | 1.232 s                   |
| Optimize                  | 1.933 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.431 us                 | 86.930 ms                 |
| BlockToStepN              | 10.554 us                 | 75.556 us                 |
| OneStep                   | 596.477 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.173 ms                  | 79.749 ms                 |
| Forward                   | 8.944 ms                  | 12.449 ms                 |
| Backward                  | 573.917 ms                | 1.232 s                   |
| Optimize                  | 1.935 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.431 us                 | 166.825 ms                |
| BlockToStepN              | 10.585 us                 | 75.556 us                 |
| OneStep                   | 598.186 ms                | 1.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 582.108 ms                | 1.241 s                   |
| Optimize                  | 1.936 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.480 us                 | 166.825 ms                |
| BlockToStepN              | 10.652 us                 | 106.942 us                |
| OneStep                   | 614.911 ms                | 1.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.254 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 584.136 ms                | 1.276 s                   |
| Optimize                  | 1.936 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.650 us                 | 166.825 ms                |
| BlockToStepN              | 10.712 us                 | 106.942 us                |
| OneStep                   | 628.173 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 595.855 ms                | 1.276 s                   |
| Optimize                  | 1.939 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.480 us                 | 166.825 ms                |
| BlockToStepN              | 10.759 us                 | 106.942 us                |
| OneStep                   | 630.432 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 597.550 ms                | 1.276 s                   |
| Optimize                  | 1.939 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.431 us                 | 166.825 ms                |
| BlockToStepN              | 10.778 us                 | 106.942 us                |
| OneStep                   | 634.199 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 606.576 ms                | 1.367 s                   |
| Optimize                  | 1.941 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.480 us                 | 212.637 ms                |
| BlockToStepN              | 10.789 us                 | 106.942 us                |
| OneStep                   | 644.446 ms                | 1.444 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.956 ms                  | 12.449 ms                 |
| Backward                  | 617.966 ms                | 1.367 s                   |
| Optimize                  | 1.942 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.845 us                 | 212.637 ms                |
| BlockToStepN              | 10.804 us                 | 106.942 us                |
| OneStep                   | 656.165 ms                | 1.444 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 628.623 ms                | 1.367 s                   |
| Optimize                  | 1.944 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.650 us                 | 212.637 ms                |
| BlockToStepN              | 10.856 us                 | 106.942 us                |
| OneStep                   | 658.827 ms                | 1.444 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.316 ms                  | 79.749 ms                 |
| Forward                   | 8.950 ms                  | 12.449 ms                 |
| Backward                  | 638.870 ms                | 1.367 s                   |
| Optimize                  | 1.949 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.480 us                 | 212.637 ms                |
| BlockToStepN              | 10.951 us                 | 106.942 us                |
| OneStep                   | 676.648 ms                | 1.444 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.951 ms                  | 12.449 ms                 |
| Backward                  | 645.631 ms                | 1.629 s                   |
| Optimize                  | 1.951 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.650 us                 | 212.637 ms                |
| BlockToStepN              | 11.003 us                 | 106.942 us                |
| OneStep                   | 685.567 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.956 ms                  | 12.449 ms                 |
| Backward                  | 661.370 ms                | 1.629 s                   |
| Optimize                  | 1.954 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.845 us                 | 279.793 ms                |
| BlockToStepN              | 11.025 us                 | 106.942 us                |
| OneStep                   | 693.387 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 115.827, sample: 1.248, forward: 0.925, backward: 111.561, update: 0.197
[proc 1] 300 steps, total: 115.827, sample: 1.113, forward: 1.333, backward: 103.658, update: 0.195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.957 ms                  | 12.449 ms                 |
| Backward                  | 671.828 ms                | 1.629 s                   |
| Optimize                  | 1.956 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 33.845 us                 | 279.793 ms                |
| BlockToStepN              | 11.108 us                 | 106.942 us                |
| OneStep                   | 698.040 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.959 ms                  | 12.449 ms                 |
| Backward                  | 678.345 ms                | 1.629 s                   |
| Optimize                  | 1.956 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.033 us                 | 279.793 ms                |
| BlockToStepN              | 11.201 us                 | 106.942 us                |
| OneStep                   | 703.061 ms                | 1.644 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.964 ms                  | 12.449 ms                 |
| Backward                  | 679.525 ms                | 1.730 s                   |
| Optimize                  | 1.957 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.033 us                 | 279.793 ms                |
| BlockToStepN              | 11.203 us                 | 106.942 us                |
| OneStep                   | 703.761 ms                | 1.750 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 79.749 ms                 |
| Forward                   | 8.964 ms                  | 12.449 ms                 |
| Backward                  | 681.970 ms                | 1.730 s                   |
| Optimize                  | 1.959 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 279.793 ms                |
| BlockToStepN              | 11.286 us                 | 106.942 us                |
| OneStep                   | 708.733 ms                | 1.750 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.965 ms                  | 12.449 ms                 |
| Backward                  | 688.184 ms                | 1.730 s                   |
| Optimize                  | 1.960 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.342 us                 | 121.116 us                |
| OneStep                   | 715.577 ms                | 1.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 79.749 ms                 |
| Forward                   | 8.968 ms                  | 12.449 ms                 |
| Backward                  | 696.129 ms                | 1.730 s                   |
| Optimize                  | 1.961 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.349 us                 | 121.116 us                |
| OneStep                   | 720.180 ms                | 1.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.972 ms                  | 12.449 ms                 |
| Backward                  | 706.385 ms                | 1.768 s                   |
| Optimize                  | 1.961 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 303.710 ms                |
| BlockToStepN              | 11.363 us                 | 121.116 us                |
| OneStep                   | 731.187 ms                | 1.782 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.972 ms                  | 12.449 ms                 |
| Backward                  | 711.745 ms                | 1.768 s                   |
| Optimize                  | 1.962 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.453 us                 | 121.116 us                |
| OneStep                   | 749.991 ms                | 1.782 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 8.972 ms                  | 12.449 ms                 |
| Backward                  | 718.671 ms                | 1.768 s                   |
| Optimize                  | 1.962 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 303.710 ms                |
| BlockToStepN              | 11.453 us                 | 121.116 us                |
| OneStep                   | 758.830 ms                | 1.782 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 81.794 ms                 |
| Forward                   | 8.972 ms                  | 12.449 ms                 |
| Backward                  | 732.024 ms                | 1.770 s                   |
| Optimize                  | 1.963 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.457 us                 | 121.116 us                |
| OneStep                   | 767.428 ms                | 1.790 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 81.794 ms                 |
| Forward                   | 8.976 ms                  | 12.449 ms                 |
| Backward                  | 735.225 ms                | 1.892 s                   |
| Optimize                  | 1.963 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.578 us                 | 121.116 us                |
| OneStep                   | 775.592 ms                | 1.906 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.794 ms                 |
| Forward                   | 8.981 ms                  | 12.449 ms                 |
| Backward                  | 745.051 ms                | 1.892 s                   |
| Optimize                  | 1.963 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 303.710 ms                |
| BlockToStepN              | 11.599 us                 | 121.116 us                |
| OneStep                   | 775.846 ms                | 1.906 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 81.794 ms                 |
| Forward                   | 8.980 ms                  | 12.449 ms                 |
| Backward                  | 749.488 ms                | 1.892 s                   |
| Optimize                  | 1.964 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 303.710 ms                |
| BlockToStepN              | 11.650 us                 | 121.116 us                |
| OneStep                   | 779.794 ms                | 1.906 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 8.980 ms                  | 12.449 ms                 |
| Backward                  | 755.250 ms                | 1.898 s                   |
| Optimize                  | 1.965 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 303.710 ms                |
| BlockToStepN              | 11.656 us                 | 121.116 us                |
| OneStep                   | 780.423 ms                | 1.918 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.794 ms                 |
| Forward                   | 8.980 ms                  | 12.449 ms                 |
| Backward                  | 759.651 ms                | 1.898 s                   |
| Optimize                  | 1.967 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 337.628 ms                |
| BlockToStepN              | 11.671 us                 | 121.116 us                |
| OneStep                   | 787.512 ms                | 1.918 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.980 ms                  | 11.740 ms                 |
| Backward                  | 767.623 ms                | 1.892 s                   |
| Optimize                  | 1.967 ms                  | 2.996 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 308.128 ms                |
| BlockToStepN              | 11.692 us                 | 106.942 us                |
| OneStep                   | 803.853 ms                | 1.906 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.981 ms                  | 11.740 ms                 |
| Backward                  | 782.811 ms                | 1.898 s                   |
| Optimize                  | 1.968 ms                  | 2.996 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 308.128 ms                |
| BlockToStepN              | 11.701 us                 | 106.942 us                |
| OneStep                   | 804.250 ms                | 1.918 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.985 ms                  | 11.740 ms                 |
| Backward                  | 787.174 ms                | 1.992 s                   |
| Optimize                  | 1.968 ms                  | 2.996 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 308.128 ms                |
| BlockToStepN              | 11.704 us                 | 106.942 us                |
| OneStep                   | 813.203 ms                | 2.006 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.983 ms                  | 11.740 ms                 |
| Backward                  | 792.152 ms                | 1.992 s                   |
| Optimize                  | 1.969 ms                  | 2.996 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 308.128 ms                |
| BlockToStepN              | 11.704 us                 | 106.942 us                |
| OneStep                   | 815.813 ms                | 2.006 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.985 ms                  | 11.740 ms                 |
| Backward                  | 794.670 ms                | 1.992 s                   |
| Optimize                  | 1.969 ms                  | 2.996 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 347.346 ms                |
| BlockToStepN              | 11.728 us                 | 106.942 us                |
| OneStep                   | 832.760 ms                | 2.006 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.335 ms                  | 79.749 ms                 |
| Forward                   | 8.987 ms                  | 11.740 ms                 |
| Backward                  | 800.998 ms                | 1.994 s                   |
| Optimize                  | 1.971 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 347.346 ms                |
| BlockToStepN              | 11.784 us                 | 106.942 us                |
| OneStep                   | 842.248 ms                | 2.013 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.352 ms                  | 79.749 ms                 |
| Forward                   | 8.994 ms                  | 11.740 ms                 |
| Backward                  | 804.134 ms                | 1.994 s                   |
| Optimize                  | 1.971 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 347.346 ms                |
| BlockToStepN              | 11.827 us                 | 106.942 us                |
| OneStep                   | 845.219 ms                | 2.013 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.335 ms                  | 79.749 ms                 |
| Forward                   | 8.994 ms                  | 11.740 ms                 |
| Backward                  | 823.046 ms                | 1.994 s                   |
| Optimize                  | 1.971 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 347.346 ms                |
| BlockToStepN              | 11.832 us                 | 106.942 us                |
| OneStep                   | 847.095 ms                | 2.013 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.352 ms                  | 79.749 ms                 |
| Forward                   | 8.994 ms                  | 11.740 ms                 |
| Backward                  | 831.560 ms                | 1.998 s                   |
| Optimize                  | 1.972 ms                  | 3.015 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 347.346 ms                |
| BlockToStepN              | 11.890 us                 | 106.942 us                |
| OneStep                   | 849.278 ms                | 2.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.352 ms                  | 79.749 ms                 |
| Forward                   | 8.996 ms                  | 11.899 ms                 |
| Backward                  | 835.571 ms                | 1.998 s                   |
| Optimize                  | 1.973 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 350.699 ms                |
| BlockToStepN              | 11.901 us                 | 106.942 us                |
| OneStep                   | 869.326 ms                | 2.088 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.997 ms                  | 11.899 ms                 |
| Backward                  | 844.042 ms                | 1.998 s                   |
| Optimize                  | 1.975 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 350.699 ms                |
| BlockToStepN              | 11.932 us                 | 106.942 us                |
| OneStep                   | 871.891 ms                | 2.088 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.352 ms                  | 79.749 ms                 |
| Forward                   | 8.996 ms                  | 11.899 ms                 |
| Backward                  | 853.320 ms                | 1.998 s                   |
| Optimize                  | 1.976 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 350.699 ms                |
| BlockToStepN              | 11.965 us                 | 106.942 us                |
| OneStep                   | 879.607 ms                | 2.088 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.352 ms                  | 79.749 ms                 |
| Forward                   | 8.997 ms                  | 11.899 ms                 |
| Backward                  | 856.008 ms                | 2.009 s                   |
| Optimize                  | 1.977 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 350.699 ms                |
| BlockToStepN              | 11.996 us                 | 106.942 us                |
| OneStep                   | 886.608 ms                | 2.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.999 ms                  | 11.899 ms                 |
| Backward                  | 859.478 ms                | 2.092 s                   |
| Optimize                  | 1.979 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 378.603 ms                |
| BlockToStepN              | 11.996 us                 | 106.942 us                |
| OneStep                   | 886.691 ms                | 2.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.997 ms                  | 11.899 ms                 |
| Backward                  | 865.621 ms                | 2.092 s                   |
| Optimize                  | 1.980 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 378.603 ms                |
| BlockToStepN              | 12.018 us                 | 106.942 us                |
| OneStep                   | 892.718 ms                | 2.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 8.999 ms                  | 11.899 ms                 |
| Backward                  | 866.815 ms                | 2.092 s                   |
| Optimize                  | 1.980 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 378.603 ms                |
| BlockToStepN              | 12.038 us                 | 106.942 us                |
| OneStep                   | 895.012 ms                | 2.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 9.003 ms                  | 11.899 ms                 |
| Backward                  | 873.540 ms                | 2.114 s                   |
| Optimize                  | 1.981 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 378.603 ms                |
| BlockToStepN              | 12.044 us                 | 106.942 us                |
| OneStep                   | 896.497 ms                | 2.134 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 8.999 ms                  | 11.899 ms                 |
| Backward                  | 874.919 ms                | 2.114 s                   |
| Optimize                  | 1.981 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 378.603 ms                |
| BlockToStepN              | 12.044 us                 | 106.942 us                |
| OneStep                   | 901.320 ms                | 2.134 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 164.044, sample: 1.217, forward: 1.292, backward: 147.134, update: 0.208
[proc 0] 400 steps, total: 164.044, sample: 1.216, forward: 0.933, backward: 157.826, update: 0.213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.365 ms                  | 79.749 ms                 |
| Forward                   | 9.003 ms                  | 11.899 ms                 |
| Backward                  | 878.015 ms                | 2.114 s                   |
| Optimize                  | 1.983 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 386.721 ms                |
| BlockToStepN              | 12.063 us                 | 106.942 us                |
| OneStep                   | 905.562 ms                | 2.165 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 79.749 ms                 |
| Forward                   | 9.004 ms                  | 11.899 ms                 |
| Backward                  | 878.639 ms                | 2.114 s                   |
| Optimize                  | 1.983 ms                  | 3.134 ms                  |
| BarrierTimeBeforeRank0    | 34.049 us                 | 386.721 ms                |
| BlockToStepN              | 12.063 us                 | 106.942 us                |
| OneStep                   | 909.521 ms                | 2.165 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.663 ms                 |
| Forward                   | 9.004 ms                  | 11.899 ms                 |
| Backward                  | 879.553 ms                | 2.114 s                   |
| Optimize                  | 1.984 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 386.721 ms                |
| BlockToStepN              | 12.063 us                 | 106.942 us                |
| OneStep                   | 921.885 ms                | 2.165 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.663 ms                 |
| Forward                   | 9.003 ms                  | 11.899 ms                 |
| Backward                  | 887.321 ms                | 2.179 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 386.721 ms                |
| BlockToStepN              | 12.063 us                 | 106.942 us                |
| OneStep                   | 926.239 ms                | 2.195 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.663 ms                 |
| Forward                   | 9.003 ms                  | 11.899 ms                 |
| Backward                  | 890.301 ms                | 2.179 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 386.721 ms                |
| BlockToStepN              | 12.063 us                 | 106.942 us                |
| OneStep                   | 930.667 ms                | 2.195 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.663 ms                 |
| Forward                   | 9.003 ms                  | 11.899 ms                 |
| Backward                  | 891.132 ms                | 2.179 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.224 us                 | 409.098 ms                |
| BlockToStepN              | 12.076 us                 | 106.942 us                |
| OneStep                   | 939.579 ms                | 2.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.663 ms                 |
| Forward                   | 9.004 ms                  | 11.899 ms                 |
| Backward                  | 911.880 ms                | 2.228 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.410 us                 | 409.098 ms                |
| BlockToStepN              | 12.089 us                 | 106.942 us                |
| OneStep                   | 944.958 ms                | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 81.663 ms                 |
| Forward                   | 9.004 ms                  | 11.899 ms                 |
| Backward                  | 922.992 ms                | 2.228 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 409.098 ms                |
| BlockToStepN              | 12.123 us                 | 106.942 us                |
| OneStep                   | 945.451 ms                | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 9.004 ms                  | 11.899 ms                 |
| Backward                  | 924.871 ms                | 2.228 s                   |
| Optimize                  | 1.986 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.410 us                 | 409.098 ms                |
| BlockToStepN              | 12.144 us                 | 106.942 us                |
| OneStep                   | 957.442 ms                | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 9.008 ms                  | 11.899 ms                 |
| Backward                  | 936.654 ms                | 2.228 s                   |
| Optimize                  | 1.989 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 34.410 us                 | 409.098 ms                |
| BlockToStepN              | 12.215 us                 | 106.942 us                |
| OneStep                   | 962.260 ms                | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 9.009 ms                  | 11.899 ms                 |
| Backward                  | 941.967 ms                | 2.353 s                   |
| Optimize                  | 1.989 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 409.098 ms                |
| BlockToStepN              | 12.233 us                 | 121.116 us                |
| OneStep                   | 963.163 ms                | 2.381 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 81.794 ms                 |
| Forward                   | 9.009 ms                  | 11.899 ms                 |
| Backward                  | 946.310 ms                | 2.353 s                   |
| Optimize                  | 1.989 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 416.857 ms                |
| BlockToStepN              | 12.259 us                 | 121.116 us                |
| OneStep                   | 967.865 ms                | 2.390 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.386 ms                  | 81.794 ms                 |
| Forward                   | 9.008 ms                  | 11.899 ms                 |
| Backward                  | 947.896 ms                | 2.353 s                   |
| Optimize                  | 1.989 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 416.857 ms                |
| BlockToStepN              | 12.299 us                 | 121.116 us                |
| OneStep                   | 968.194 ms                | 2.390 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.432 ms                  | 81.794 ms                 |
| Forward                   | 9.009 ms                  | 11.960 ms                 |
| Backward                  | 948.250 ms                | 2.353 s                   |
| Optimize                  | 1.990 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 416.857 ms                |
| BlockToStepN              | 12.259 us                 | 121.116 us                |
| OneStep                   | 968.510 ms                | 2.390 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.432 ms                  | 81.794 ms                 |
| Forward                   | 9.014 ms                  | 11.960 ms                 |
| Backward                  | 948.960 ms                | 2.396 s                   |
| Optimize                  | 1.990 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.873 us                 | 416.857 ms                |
| BlockToStepN              | 12.299 us                 | 121.116 us                |
| OneStep                   | 970.012 ms                | 2.440 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.432 ms                  | 83.178 ms                 |
| Forward                   | 9.014 ms                  | 11.960 ms                 |
| Backward                  | 958.030 ms                | 2.396 s                   |
| Optimize                  | 1.991 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 34.938 us                 | 416.857 ms                |
| BlockToStepN              | 12.357 us                 | 121.116 us                |
| OneStep                   | 976.946 ms                | 2.440 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.432 ms                  | 83.178 ms                 |
| Forward                   | 9.014 ms                  | 11.960 ms                 |
| Backward                  | 958.569 ms                | 2.396 s                   |
| Optimize                  | 1.991 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 35.405 us                 | 416.857 ms                |
| BlockToStepN              | 12.386 us                 | 121.116 us                |
| OneStep                   | 977.844 ms                | 2.440 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 83.178 ms                 |
| Forward                   | 9.017 ms                  | 11.960 ms                 |
| Backward                  | 960.653 ms                | 2.396 s                   |
| Optimize                  | 1.991 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 35.456 us                 | 416.857 ms                |
| BlockToStepN              | 12.386 us                 | 121.116 us                |
| OneStep                   | 979.040 ms                | 2.440 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 83.178 ms                 |
| Forward                   | 9.014 ms                  | 11.960 ms                 |
| Backward                  | 967.164 ms                | 2.423 s                   |
| Optimize                  | 1.991 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 35.456 us                 | 416.857 ms                |
| BlockToStepN              | 12.386 us                 | 121.116 us                |
| OneStep                   | 997.121 ms                | 2.453 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 83.178 ms                 |
| Forward                   | 9.017 ms                  | 11.960 ms                 |
| Backward                  | 980.993 ms                | 2.423 s                   |
| Optimize                  | 1.991 ms                  | 3.388 ms                  |
| BarrierTimeBeforeRank0    | 35.456 us                 | 416.857 ms                |
| BlockToStepN              | 12.489 us                 | 128.011 us                |
| OneStep                   | 1.000 s                   | 2.453 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 81.794 ms                 |
| Forward                   | 9.017 ms                  | 11.899 ms                 |
| Backward                  | 986.602 ms                | 2.396 s                   |
| Optimize                  | 1.992 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.458 us                 | 416.857 ms                |
| BlockToStepN              | 12.512 us                 | 121.116 us                |
| OneStep                   | 1.007 s                   | 2.440 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 81.794 ms                 |
| Forward                   | 9.017 ms                  | 11.899 ms                 |
| Backward                  | 988.231 ms                | 2.423 s                   |
| Optimize                  | 1.992 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.463 us                 | 416.857 ms                |
| BlockToStepN              | 12.552 us                 | 121.116 us                |
| OneStep                   | 1.015 s                   | 2.453 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.019 ms                  | 11.899 ms                 |
| Backward                  | 1.001 s                   | 2.438 s                   |
| Optimize                  | 1.992 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 416.857 ms                |
| BlockToStepN              | 12.552 us                 | 121.116 us                |
| OneStep                   | 1.030 s                   | 2.474 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.017 ms                  | 11.899 ms                 |
| Backward                  | 1.009 s                   | 2.438 s                   |
| Optimize                  | 1.992 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.463 us                 | 416.857 ms                |
| BlockToStepN              | 12.556 us                 | 121.116 us                |
| OneStep                   | 1.036 s                   | 2.474 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.017 ms                  | 11.899 ms                 |
| Backward                  | 1.020 s                   | 2.438 s                   |
| Optimize                  | 1.994 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 416.857 ms                |
| BlockToStepN              | 12.584 us                 | 121.116 us                |
| OneStep                   | 1.041 s                   | 2.474 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.017 ms                  | 11.899 ms                 |
| Backward                  | 1.020 s                   | 2.448 s                   |
| Optimize                  | 1.994 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.762 us                 | 421.033 ms                |
| BlockToStepN              | 12.593 us                 | 121.116 us                |
| OneStep                   | 1.042 s                   | 2.524 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 81.794 ms                 |
| Forward                   | 9.019 ms                  | 11.899 ms                 |
| Backward                  | 1.026 s                   | 2.496 s                   |
| Optimize                  | 1.996 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 421.033 ms                |
| BlockToStepN              | 12.644 us                 | 121.116 us                |
| OneStep                   | 1.052 s                   | 2.544 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.463 ms                  | 81.794 ms                 |
| Forward                   | 9.019 ms                  | 11.899 ms                 |
| Backward                  | 1.028 s                   | 2.496 s                   |
| Optimize                  | 1.996 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 421.033 ms                |
| BlockToStepN              | 12.644 us                 | 121.116 us                |
| OneStep                   | 1.052 s                   | 2.544 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.021 ms                  | 11.899 ms                 |
| Backward                  | 1.032 s                   | 2.496 s                   |
| Optimize                  | 1.996 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 421.033 ms                |
| BlockToStepN              | 12.646 us                 | 121.116 us                |
| OneStep                   | 1.058 s                   | 2.544 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.489 ms                  | 81.794 ms                 |
| Forward                   | 9.019 ms                  | 11.899 ms                 |
| Backward                  | 1.038 s                   | 2.529 s                   |
| Optimize                  | 1.996 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 421.033 ms                |
| BlockToStepN              | 12.665 us                 | 128.011 us                |
| OneStep                   | 1.059 s                   | 2.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.021 ms                  | 11.899 ms                 |
| Backward                  | 1.040 s                   | 2.529 s                   |
| Optimize                  | 1.996 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 457.212 ms                |
| BlockToStepN              | 12.695 us                 | 128.011 us                |
| OneStep                   | 1.060 s                   | 2.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.021 ms                  | 11.960 ms                 |
| Backward                  | 1.043 s                   | 2.529 s                   |
| Optimize                  | 1.998 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.463 us                 | 457.212 ms                |
| BlockToStepN              | 12.702 us                 | 128.011 us                |
| OneStep                   | 1.065 s                   | 2.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.023 ms                  | 11.960 ms                 |
| Backward                  | 1.045 s                   | 2.529 s                   |
| Optimize                  | 1.999 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 457.212 ms                |
| BlockToStepN              | 12.756 us                 | 128.011 us                |
| OneStep                   | 1.065 s                   | 2.591 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.023 ms                  | 11.960 ms                 |
| Backward                  | 1.046 s                   | 2.569 s                   |
| Optimize                  | 1.999 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.762 us                 | 457.212 ms                |
| BlockToStepN              | 12.756 us                 | 128.011 us                |
| OneStep                   | 1.079 s                   | 2.598 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.024 ms                  | 11.960 ms                 |
| Backward                  | 1.065 s                   | 2.569 s                   |
| Optimize                  | 1.999 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.910 us                 | 462.436 ms                |
| BlockToStepN              | 12.756 us                 | 128.011 us                |
| OneStep                   | 1.084 s                   | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 81.794 ms                 |
| Forward                   | 9.024 ms                  | 11.960 ms                 |
| Backward                  | 1.070 s                   | 2.569 s                   |
| Optimize                  | 1.999 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.762 us                 | 462.436 ms                |
| BlockToStepN              | 12.757 us                 | 128.011 us                |
| OneStep                   | 1.105 s                   | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.029 ms                  | 11.960 ms                 |
| Backward                  | 1.079 s                   | 2.569 s                   |
| Optimize                  | 1.999 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.762 us                 | 462.436 ms                |
| BlockToStepN              | 12.760 us                 | 128.011 us                |
| OneStep                   | 1.106 s                   | 2.600 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.029 ms                  | 11.960 ms                 |
| Backward                  | 1.081 s                   | 2.573 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.762 us                 | 462.436 ms                |
| BlockToStepN              | 12.763 us                 | 128.011 us                |
| OneStep                   | 1.109 s                   | 2.639 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.024 ms                  | 11.960 ms                 |
| Backward                  | 1.083 s                   | 2.573 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 462.436 ms                |
| BlockToStepN              | 12.796 us                 | 128.011 us                |
| OneStep                   | 1.111 s                   | 2.639 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.029 ms                  | 11.960 ms                 |
| Backward                  | 1.088 s                   | 2.573 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 478.738 ms                |
| BlockToStepN              | 12.808 us                 | 128.011 us                |
| OneStep                   | 1.118 s                   | 2.660 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.032 ms                  | 11.960 ms                 |
| Backward                  | 1.088 s                   | 2.573 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.717 us                 | 478.738 ms                |
| BlockToStepN              | 12.808 us                 | 128.011 us                |
| OneStep                   | 1.119 s                   | 2.660 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.033 ms                  | 11.960 ms                 |
| Backward                  | 1.090 s                   | 2.574 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.463 us                 | 478.738 ms                |
| BlockToStepN              | 12.808 us                 | 128.011 us                |
| OneStep                   | 1.121 s                   | 2.861 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 212.562, sample: 1.279, forward: 1.267, backward: 189.271, update: 0.220
[proc 0] 500 steps, total: 212.562, sample: 1.305, forward: 0.952, backward: 204.239, update: 0.206
Successfully xmh. training takes 588.4475147724152 seconds
before call kg_cache_controller.StopThreads()
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
INFO [4192 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.536 ms                  | 82.805 ms                 |
| Forward                   | 9.035 ms                  | 11.960 ms                 |
| Backward                  | 1.091 s                   | 2.574 s                   |
| Optimize                  | 2.000 ms                  | 3.150 ms                  |
| BarrierTimeBeforeRank0    | 35.458 us                 | 478.738 ms                |
| BlockToStepN              | 12.837 us                 | 128.011 us                |
| OneStep                   | 1.123 s                   | 2.861 s                   |
+---------------------------+---------------------------+---------------------------+
