WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 23:38:39.316169 36650 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_41', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [36650 sampler.py:454] Start PreSampling
WARNING [36650 sampler.py:532] Before construct renumbering_dict
WARNING [36650 sampler.py:555] PreSampling done
W20240123 23:51:49.582140 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 23:51:49.582324 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 23:51:49.582346 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 23:51:49.582371 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 23:51:49.582388 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 23:51:49.582410 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 23:51:49.582428 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 23:51:49.582451 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 23:51:49.582482 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 23:51:49.582505 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 23:51:49.582531 36650 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 23:51:49.582551 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 23:51:49.582567 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 23:51:49.582669 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 23:51:49.582698 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 23:51:49.582722 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 23:51:49.582754 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 23:51:49.582783 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 23:51:49.582805 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 23:51:49.582830 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 23:51:49.582857 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 23:51:49.582886 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 23:51:49.582906 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 23:51:49.582928 36650 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 23:51:49.582942 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 23:51:49.582957 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 23:51:49.582994 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240123 23:51:49.583014 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240123 23:51:49.583029 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240123 23:51:49.583057 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240123 23:51:49.583072 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240123 23:51:49.583096 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240123 23:51:49.583114 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240123 23:51:49.583130 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240123 23:51:49.583151 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240123 23:51:49.583171 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240123 23:51:49.583191 36650 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240123 23:51:49.583205 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240123 23:51:49.583220 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240123 23:51:49.583253 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240123 23:51:49.583284 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240123 23:51:49.583302 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240123 23:51:49.583326 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240123 23:51:49.583351 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240123 23:51:49.583374 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240123 23:51:49.583390 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240123 23:51:49.583407 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240123 23:51:49.583428 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240123 23:51:49.583456 36650 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240123 23:51:49.583472 36650 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240123 23:51:49.583485 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240123 23:51:49.583498 36650 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240123 23:51:49.967233 36650 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100001ee2000 128.2 GB
W20240123 23:51:49.967413 36650 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102010b1a000 328.3 MB
{0: Graph(num_nodes=27256011, num_edges=100992629,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23779591, num_edges=94535774,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=26463902, num_edges=75890617,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=25398646, num_edges=93789131,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27256011 N 100992629 E
MertisPartition: part 1 has 23779591 N 94535774 E
MertisPartition: part 2 has 26463902 N 75890617 E
MertisPartition: part 3 has 25398646 N 93789131 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 4302732,  4302763,   424856,  ...,  4032882, 15224517, 82244345]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 967.304 seconds
[Rank1] pid = 61264
[Rank2] pid = 61357
INFO [36650 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [61264 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [61439 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [61357 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [61357 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [61439 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [61264 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [36650 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [61264 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [61439 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [36650 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [61357 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 23:54:59.090598 61358 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 23:54:59.090708 61503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 23:54:59.091161 61440 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 23:54:59.091306 61266 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240123 23:55:12.472448 61358 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 23:55:13.874353 61503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 23:55:14.406240 61266 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 23:55:15.749416 61440 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.064 ms                  | 22.013 ms                 |
| bucket keys               | 1.073 ms                  | 176.999 ms                |
| forward: a2a keys         | 1.292 ms                  | 686.595 ms                |
| forward: search cache     | 169.596 us                | 18.343 ms                 |
| forward: a2a values       | 1.862 ms                  | 18.359 ms                 |
| forward: join             | 1.251 ms                  | 2.476 ms                  |
| Forward                   | 26.144 ms                 | 1.539 s                   |
| back: aggr dram keys      | 23.088 ms                 | 474.515 ms                |
| back: set dram grad       | 3.926 ms                  | 6.053 ms                  |
| back: a2a grad            | 4.966 ms                  | 22.356 ms                 |
| back: grad sum & grad cache  | 2.324 ms                  | 40.456 ms                 |
| Backward                  | 143.825 ms                | 709.092 ms                |
| Optimize                  | 15.694 ms                 | 27.438 ms                 |
| BarrierTimeBeforeRank0    | 51.918 us                 | 117.486 us                |
| BlockToStepN              | 26.359 us                 | 54.875 us                 |
| OneStep                   | 200.694 ms                | 2.292 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.562 ms                  | 202.292 ms                |
| bucket keys               | 1.073 ms                  | 1.840 ms                  |
| forward: a2a keys         | 1.317 ms                  | 192.121 ms                |
| forward: search cache     | 170.447 us                | 206.164 us                |
| forward: a2a values       | 7.437 ms                  | 12.035 ms                 |
| forward: join             | 1.251 ms                  | 3.014 ms                  |
| Forward                   | 27.291 ms                 | 1.539 s                   |
| back: aggr dram keys      | 28.936 ms                 | 57.603 ms                 |
| back: set dram grad       | 3.080 ms                  | 6.315 ms                  |
| back: a2a grad            | 9.567 ms                  | 22.356 ms                 |
| back: grad sum & grad cache  | 2.324 ms                  | 40.456 ms                 |
| Backward                  | 125.198 ms                | 709.092 ms                |
| Optimize                  | 17.440 ms                 | 43.143 ms                 |
| BarrierTimeBeforeRank0    | 50.474 us                 | 117.486 us                |
| BlockToStepN              | 25.124 us                 | 9.019 ms                  |
| OneStep                   | 183.938 ms                | 2.292 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.895 ms                  | 94.315 ms                 |
| bucket keys               | 1.073 ms                  | 1.840 ms                  |
| forward: a2a keys         | 1.873 ms                  | 192.121 ms                |
| forward: search cache     | 171.899 us                | 229.640 us                |
| forward: a2a values       | 7.463 ms                  | 12.035 ms                 |
| forward: join             | 1.251 ms                  | 3.014 ms                  |
| Forward                   | 27.740 ms                 | 216.835 ms                |
| back: aggr dram keys      | 28.936 ms                 | 57.603 ms                 |
| back: set dram grad       | 3.093 ms                  | 6.697 ms                  |
| back: a2a grad            | 9.660 ms                  | 22.356 ms                 |
| back: grad sum & grad cache  | 2.324 ms                  | 40.456 ms                 |
| Backward                  | 123.210 ms                | 153.024 ms                |
| Optimize                  | 17.001 ms                 | 29.395 ms                 |
| BarrierTimeBeforeRank0    | 50.183 us                 | 100.320 us                |
| BlockToStepN              | 27.691 us                 | 7.996 ms                  |
| OneStep                   | 178.003 ms                | 424.257 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.523 ms                  | 94.315 ms                 |
| bucket keys               | 1.135 ms                  | 2.113 ms                  |
| forward: a2a keys         | 1.782 ms                  | 122.531 ms                |
| forward: search cache     | 172.003 us                | 274.782 us                |
| forward: a2a values       | 7.287 ms                  | 10.024 ms                 |
| forward: join             | 1.251 ms                  | 2.996 ms                  |
| Forward                   | 27.740 ms                 | 216.835 ms                |
| back: aggr dram keys      | 30.698 ms                 | 55.977 ms                 |
| back: set dram grad       | 3.072 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.753 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 40.610 ms                 |
| Backward                  | 123.170 ms                | 153.024 ms                |
| Optimize                  | 17.360 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 46.806 us                 | 100.320 us                |
| BlockToStepN              | 19.717 us                 | 7.996 ms                  |
| OneStep                   | 177.961 ms                | 424.257 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.731, sample: 1.454, forward: 5.605, backward: 9.105, update: 0.256
[Rank3] pid = 61439
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([  469811,  4570228,   469835,   469864,   469886,   469908, 51862394,
          283680,  4309401,   469926]) tensor([ 4972445, 26420103, 22013562, 47016758, 56574110, 28653376, 79718097,
        75492833, 56227158, 47073990])
-------Step 1-------
tensor([  469811,  4570228,   469835,   469864,   469886,   469908, 51862394,
          283680,  4309401,   469926]) tensor([34028857, 70117682, 18775464, 26420752, 36247947, 15641226, 48427178,
        70138697,   221575, 83780064])
-------Step 2-------
tensor([ 537990,  538012,   82945, 8216087,  538040, 4564362,  538067,  263041,
         538093,  538121]) tensor([17863599, 55414485, 28166266, 33214202, 85236514, 54366784, 10365146,
        14287241, 11638398, 53940694])
-------Step 3-------
tensor([ 537990,  538012,   82945, 8216087,  538040, 4564362,  538067,  263041,
         538093,  538121]) tensor([56146192, 37894070, 78112947,   165402, 47393795, 32273189, 54879803,
        35881366, 60110305, 26864321])
-------Step 4-------
tensor([  605167,   605198,   605228,   605251,   605278, 84308960,    97990,
        47685521,   605299,   605324]) tensor([ 1060638,   520641, 62170679, 53795054, 59840134, 37063683, 16645344,
        11023401, 41430299, 40479524])
-------Step 5-------
tensor([  605167,   605198,   605228,   605251,   605278, 84308960,    97990,
        47685521,   605299,   605324]) tensor([ 7706452, 13720974, 44742356, 40846994, 60340917,  1290134, 48814935,
        24586602,  6185361, 52226876])
-------Step 6-------
tensor([672398, 672419, 672444, 686464, 672482, 672513, 672534, 672553, 672570,
        672591]) tensor([ 9359757, 70237992, 28777573,  8735687, 15213970, 26942490,   502690,
        24422905, 19918512, 77725115])
-------Step 7-------
tensor([672398, 672419, 672444, 686464, 672482, 672513, 672534, 672553, 672570,
        672591]) tensor([42599683, 84107227, 50521586, 69774644, 40469178, 38497957, 75460382,
        55658097, 39455807, 75574603])
-------Step 8-------
tensor([  164463,   127523, 75609374,   617773,   737437,   127564,  1063215,
          737477,   737501,   127609]) tensor([30992441, 30270210, 21550849,  2067037,  5618974, 28731071, 13195178,
        64102476, 50000069, 42486343])
-------Step 9-------
tensor([  164463,   127523, 75609374,   617773,   737437,   127564,  1063215,
          737477,   737501,   127609]) tensor([  533762, 41250817, 63892984,  5886441, 76331476, 23789423, 84202842,
        17263676, 61139394, 50508556])
before start barrier
start train
[proc 0] 100 steps, total: 21.388, sample: 1.365, forward: 5.123, backward: 13.030, update: 1.757
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.263, sample: 2.111, forward: 4.932, backward: 8.823, update: 0.298
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.665, sample: 1.485, forward: 5.555, backward: 8.823, update: 0.323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.059 ms                  | 94.315 ms                 |
| bucket keys               | 1.135 ms                  | 2.173 ms                  |
| forward: a2a keys         | 1.666 ms                  | 122.531 ms                |
| forward: search cache     | 171.247 us                | 274.782 us                |
| forward: a2a values       | 7.287 ms                  | 16.192 ms                 |
| forward: join             | 1.251 ms                  | 2.996 ms                  |
| Forward                   | 28.069 ms                 | 216.835 ms                |
| back: aggr dram keys      | 30.698 ms                 | 57.603 ms                 |
| back: set dram grad       | 3.025 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.797 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.889 ms                 |
| Backward                  | 123.433 ms                | 153.024 ms                |
| Optimize                  | 17.392 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 45.051 us                 | 100.320 us                |
| BlockToStepN              | 18.482 us                 | 7.996 ms                  |
| OneStep                   | 177.674 ms                | 424.257 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.323 ms                  | 156.575 ms                |
| bucket keys               | 1.139 ms                  | 2.167 ms                  |
| forward: a2a keys         | 1.547 ms                  | 122.531 ms                |
| forward: search cache     | 170.287 us                | 279.121 us                |
| forward: a2a values       | 7.287 ms                  | 12.035 ms                 |
| forward: join             | 1.251 ms                  | 2.996 ms                  |
| Forward                   | 27.878 ms                 | 216.835 ms                |
| back: aggr dram keys      | 31.818 ms                 | 58.102 ms                 |
| back: set dram grad       | 3.045 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.797 ms                  | 23.564 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.370 ms                 |
| Backward                  | 123.455 ms                | 153.024 ms                |
| Optimize                  | 17.304 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.375 us                 | 102.729 us                |
| BlockToStepN              | 17.747 us                 | 7.996 ms                  |
| OneStep                   | 178.068 ms                | 424.257 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.375 ms                  | 146.546 ms                |
| bucket keys               | 1.139 ms                  | 2.190 ms                  |
| forward: a2a keys         | 1.466 ms                  | 122.531 ms                |
| forward: search cache     | 170.963 us                | 279.121 us                |
| forward: a2a values       | 7.287 ms                  | 12.035 ms                 |
| forward: join             | 1.251 ms                  | 2.996 ms                  |
| Forward                   | 27.734 ms                 | 154.235 ms                |
| back: aggr dram keys      | 37.005 ms                 | 58.102 ms                 |
| back: set dram grad       | 3.042 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.813 ms                  | 23.564 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.370 ms                 |
| Backward                  | 122.913 ms                | 149.897 ms                |
| Optimize                  | 17.395 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 44.402 us                 | 100.320 us                |
| BlockToStepN              | 17.720 us                 | 7.123 ms                  |
| OneStep                   | 177.674 ms                | 395.583 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.523 ms                  | 146.546 ms                |
| bucket keys               | 1.139 ms                  | 2.181 ms                  |
| forward: a2a keys         | 1.428 ms                  | 122.064 ms                |
| forward: search cache     | 170.141 us                | 274.782 us                |
| forward: a2a values       | 7.286 ms                  | 11.645 ms                 |
| forward: join             | 1.251 ms                  | 2.870 ms                  |
| Forward                   | 27.522 ms                 | 154.235 ms                |
| back: aggr dram keys      | 37.005 ms                 | 57.603 ms                 |
| back: set dram grad       | 3.068 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.858 ms                  | 23.564 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 41.587 ms                 |
| Backward                  | 122.874 ms                | 150.146 ms                |
| Optimize                  | 17.481 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.402 us                 | 100.320 us                |
| BlockToStepN              | 17.533 us                 | 7.123 ms                  |
| OneStep                   | 177.058 ms                | 395.583 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 19.079, sample: 1.603, forward: 3.633, backward: 8.398, update: 0.302
[proc 2] 200 steps, total: 19.079, sample: 1.792, forward: 3.416, backward: 8.422, update: 0.293
[proc 1] 200 steps, total: 19.079, sample: 1.357, forward: 3.904, backward: 8.692, update: 0.259
[proc 0] 200 steps, total: 19.079, sample: 1.757, forward: 3.012, backward: 12.440, update: 1.769
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.562 ms                  | 146.546 ms                |
| bucket keys               | 1.139 ms                  | 2.181 ms                  |
| forward: a2a keys         | 1.363 ms                  | 122.064 ms                |
| forward: search cache     | 169.978 us                | 279.121 us                |
| forward: a2a values       | 7.191 ms                  | 12.035 ms                 |
| forward: join             | 1.251 ms                  | 2.870 ms                  |
| Forward                   | 27.343 ms                 | 154.235 ms                |
| back: aggr dram keys      | 37.005 ms                 | 61.069 ms                 |
| back: set dram grad       | 3.068 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.858 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.889 ms                 |
| Backward                  | 122.874 ms                | 150.146 ms                |
| Optimize                  | 17.569 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.673 us                 | 100.320 us                |
| BlockToStepN              | 17.533 us                 | 7.123 ms                  |
| OneStep                   | 177.674 ms                | 395.583 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.816 ms                  | 156.575 ms                |
| bucket keys               | 1.138 ms                  | 2.180 ms                  |
| forward: a2a keys         | 1.344 ms                  | 112.681 ms                |
| forward: search cache     | 169.978 us                | 274.782 us                |
| forward: a2a values       | 7.191 ms                  | 13.288 ms                 |
| forward: join             | 1.251 ms                  | 2.790 ms                  |
| Forward                   | 27.350 ms                 | 154.235 ms                |
| back: aggr dram keys      | 37.005 ms                 | 62.498 ms                 |
| back: set dram grad       | 3.054 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.858 ms                  | 24.414 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.370 ms                 |
| Backward                  | 122.887 ms                | 150.146 ms                |
| Optimize                  | 17.597 ms                 | 34.440 ms                 |
| BarrierTimeBeforeRank0    | 44.673 us                 | 100.320 us                |
| BlockToStepN              | 17.497 us                 | 7.123 ms                  |
| OneStep                   | 177.932 ms                | 395.583 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.895 ms                  | 156.575 ms                |
| bucket keys               | 1.137 ms                  | 2.182 ms                  |
| forward: a2a keys         | 1.340 ms                  | 112.681 ms                |
| forward: search cache     | 169.878 us                | 275.566 us                |
| forward: a2a values       | 7.191 ms                  | 13.288 ms                 |
| forward: join             | 1.251 ms                  | 2.790 ms                  |
| Forward                   | 27.341 ms                 | 147.699 ms                |
| back: aggr dram keys      | 37.005 ms                 | 62.498 ms                 |
| back: set dram grad       | 3.061 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.839 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 42.370 ms                 |
| Backward                  | 122.727 ms                | 149.897 ms                |
| Optimize                  | 17.659 ms                 | 34.440 ms                 |
| BarrierTimeBeforeRank0    | 44.597 us                 | 89.659 us                 |
| BlockToStepN              | 17.497 us                 | 6.406 ms                  |
| OneStep                   | 177.058 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.974 ms                  | 156.575 ms                |
| bucket keys               | 1.137 ms                  | 2.182 ms                  |
| forward: a2a keys         | 1.318 ms                  | 99.271 ms                 |
| forward: search cache     | 169.843 us                | 279.121 us                |
| forward: a2a values       | 7.191 ms                  | 13.788 ms                 |
| forward: join             | 1.251 ms                  | 2.705 ms                  |
| Forward                   | 27.272 ms                 | 147.699 ms                |
| back: aggr dram keys      | 37.291 ms                 | 61.069 ms                 |
| back: set dram grad       | 3.064 ms                  | 6.577 ms                  |
| back: a2a grad            | 9.840 ms                  | 26.247 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 43.943 ms                 |
| Backward                  | 122.727 ms                | 150.146 ms                |
| Optimize                  | 17.690 ms                 | 34.440 ms                 |
| BarrierTimeBeforeRank0    | 44.760 us                 | 89.659 us                 |
| BlockToStepN              | 17.685 us                 | 7.123 ms                  |
| OneStep                   | 177.005 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 18.864, sample: 1.125, forward: 3.822, backward: 8.254, update: 0.287
[proc 1] 300 steps, total: 18.864, sample: 1.255, forward: 3.678, backward: 8.555, update: 0.283
[proc 2] 300 steps, total: 18.864, sample: 1.390, forward: 3.548, backward: 8.255, update: 0.294
[proc 0] 300 steps, total: 18.864, sample: 1.734, forward: 2.794, backward: 12.380, update: 1.837
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.016 ms                  | 156.575 ms                |
| bucket keys               | 1.138 ms                  | 2.182 ms                  |
| forward: a2a keys         | 1.303 ms                  | 99.271 ms                 |
| forward: search cache     | 169.596 us                | 279.121 us                |
| forward: a2a values       | 7.191 ms                  | 13.788 ms                 |
| forward: join             | 1.251 ms                  | 2.705 ms                  |
| Forward                   | 27.191 ms                 | 147.699 ms                |
| back: aggr dram keys      | 37.291 ms                 | 61.069 ms                 |
| back: set dram grad       | 3.054 ms                  | 6.577 ms                  |
| back: a2a grad            | 9.840 ms                  | 26.563 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 45.418 ms                 |
| Backward                  | 122.607 ms                | 150.146 ms                |
| Optimize                  | 17.706 ms                 | 34.440 ms                 |
| BarrierTimeBeforeRank0    | 44.760 us                 | 89.659 us                 |
| BlockToStepN              | 17.657 us                 | 7.996 ms                  |
| OneStep                   | 176.955 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.040 ms                  | 161.559 ms                |
| bucket keys               | 1.138 ms                  | 2.181 ms                  |
| forward: a2a keys         | 1.298 ms                  | 74.341 ms                 |
| forward: search cache     | 169.373 us                | 275.566 us                |
| forward: a2a values       | 7.191 ms                  | 13.288 ms                 |
| forward: join             | 2.191 ms                  | 2.790 ms                  |
| Forward                   | 27.266 ms                 | 147.699 ms                |
| back: aggr dram keys      | 37.005 ms                 | 60.905 ms                 |
| back: set dram grad       | 3.061 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.840 ms                  | 26.247 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 45.279 ms                 |
| Backward                  | 122.607 ms                | 153.024 ms                |
| Optimize                  | 17.715 ms                 | 34.440 ms                 |
| BarrierTimeBeforeRank0    | 44.835 us                 | 89.659 us                 |
| BlockToStepN              | 17.482 us                 | 7.996 ms                  |
| OneStep                   | 177.351 ms                | 395.583 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.262 ms                  | 160.660 ms                |
| bucket keys               | 1.138 ms                  | 2.184 ms                  |
| forward: a2a keys         | 1.313 ms                  | 74.341 ms                 |
| forward: search cache     | 169.145 us                | 283.362 us                |
| forward: a2a values       | 7.286 ms                  | 13.788 ms                 |
| forward: join             | 2.191 ms                  | 2.870 ms                  |
| Forward                   | 27.295 ms                 | 146.925 ms                |
| back: aggr dram keys      | 37.291 ms                 | 60.905 ms                 |
| back: set dram grad       | 3.054 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.840 ms                  | 26.247 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 45.279 ms                 |
| Backward                  | 122.520 ms                | 153.024 ms                |
| Optimize                  | 17.708 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.796 us                 | 78.333 us                 |
| BlockToStepN              | 17.385 us                 | 7.123 ms                  |
| OneStep                   | 177.058 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.301 ms                  | 161.559 ms                |
| bucket keys               | 1.138 ms                  | 2.184 ms                  |
| forward: a2a keys         | 1.317 ms                  | 38.722 ms                 |
| forward: search cache     | 169.323 us                | 279.121 us                |
| forward: a2a values       | 7.287 ms                  | 13.288 ms                 |
| forward: join             | 2.191 ms                  | 2.870 ms                  |
| Forward                   | 27.264 ms                 | 146.925 ms                |
| back: aggr dram keys      | 37.291 ms                 | 59.201 ms                 |
| back: set dram grad       | 3.052 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.844 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 45.418 ms                 |
| Backward                  | 122.539 ms                | 153.024 ms                |
| Optimize                  | 17.701 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.762 us                 | 78.333 us                 |
| BlockToStepN              | 17.418 us                 | 7.996 ms                  |
| OneStep                   | 177.064 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 19.166, sample: 0.979, forward: 3.967, backward: 8.584, update: 0.300
[proc 3] 400 steps, total: 19.166, sample: 0.910, forward: 4.076, backward: 8.552, update: 0.283
[proc 1] 400 steps, total: 19.166, sample: 1.189, forward: 3.772, backward: 8.885, update: 0.265
[proc 0] 400 steps, total: 19.166, sample: 1.764, forward: 2.833, backward: 12.686, update: 1.766
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.410 ms                  | 163.224 ms                |
| bucket keys               | 1.137 ms                  | 2.184 ms                  |
| forward: a2a keys         | 1.300 ms                  | 34.184 ms                 |
| forward: search cache     | 169.405 us                | 275.566 us                |
| forward: a2a values       | 7.287 ms                  | 12.035 ms                 |
| forward: join             | 2.191 ms                  | 2.790 ms                  |
| Forward                   | 27.148 ms                 | 146.925 ms                |
| back: aggr dram keys      | 37.923 ms                 | 61.069 ms                 |
| back: set dram grad       | 3.045 ms                  | 6.599 ms                  |
| back: a2a grad            | 9.849 ms                  | 24.538 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 50.231 ms                 |
| Backward                  | 122.448 ms                | 159.799 ms                |
| Optimize                  | 17.686 ms                 | 34.322 ms                 |
| BarrierTimeBeforeRank0    | 44.762 us                 | 78.333 us                 |
| BlockToStepN              | 17.507 us                 | 7.996 ms                  |
| OneStep                   | 177.039 ms                | 373.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.431 ms                  | 161.559 ms                |
| bucket keys               | 1.137 ms                  | 2.189 ms                  |
| forward: a2a keys         | 1.279 ms                  | 34.184 ms                 |
| forward: search cache     | 169.344 us                | 279.121 us                |
| forward: a2a values       | 7.287 ms                  | 12.035 ms                 |
| forward: join             | 2.191 ms                  | 2.870 ms                  |
| Forward                   | 27.049 ms                 | 144.511 ms                |
| back: aggr dram keys      | 37.291 ms                 | 60.905 ms                 |
| back: set dram grad       | 3.045 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.849 ms                  | 24.414 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 46.046 ms                 |
| Backward                  | 122.369 ms                | 154.282 ms                |
| Optimize                  | 17.694 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 44.762 us                 | 78.333 us                 |
| BlockToStepN              | 17.507 us                 | 7.996 ms                  |
| OneStep                   | 176.936 ms                | 373.573 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.368 ms                  | 161.559 ms                |
| bucket keys               | 1.135 ms                  | 2.186 ms                  |
| forward: a2a keys         | 1.264 ms                  | 33.136 ms                 |
| forward: search cache     | 169.679 us                | 275.566 us                |
| forward: a2a values       | 7.286 ms                  | 11.884 ms                 |
| forward: join             | 2.191 ms                  | 2.790 ms                  |
| Forward                   | 26.918 ms                 | 144.511 ms                |
| back: aggr dram keys      | 37.291 ms                 | 59.201 ms                 |
| back: set dram grad       | 3.051 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.848 ms                  | 23.564 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 46.046 ms                 |
| Backward                  | 122.115 ms                | 154.282 ms                |
| Optimize                  | 17.693 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 44.833 us                 | 78.333 us                 |
| BlockToStepN              | 17.497 us                 | 9.019 ms                  |
| OneStep                   | 176.285 ms                | 373.573 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 18.281, sample: 1.148, forward: 3.392, backward: 8.441, update: 0.271
[proc 2] 500 steps, total: 18.281, sample: 0.947, forward: 3.574, backward: 8.146, update: 0.307
[proc 0] 500 steps, total: 18.281, sample: 1.618, forward: 2.586, backward: 12.166, update: 1.760
[proc 3] 500 steps, total: 18.281, sample: 0.914, forward: 3.649, backward: 8.121, update: 0.217
Successfully xmh. training takes 96.77940058708191 seconds
before call kg_cache_controller.StopThreads()
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
INFO [36650 controller_process.py:380] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.201 ms                  | 161.559 ms                |
| bucket keys               | 1.137 ms                  | 2.189 ms                  |
| forward: a2a keys         | 1.251 ms                  | 33.136 ms                 |
| forward: search cache     | 169.843 us                | 275.566 us                |
| forward: a2a values       | 7.287 ms                  | 11.884 ms                 |
| forward: join             | 2.191 ms                  | 2.790 ms                  |
| Forward                   | 26.859 ms                 | 144.511 ms                |
| back: aggr dram keys      | 37.369 ms                 | 59.201 ms                 |
| back: set dram grad       | 3.049 ms                  | 6.591 ms                  |
| back: a2a grad            | 9.567 ms                  | 23.564 ms                 |
| back: grad sum & grad cache  | 2.757 ms                  | 50.657 ms                 |
| Backward                  | 122.064 ms                | 154.282 ms                |
| Optimize                  | 17.684 ms                 | 32.694 ms                 |
| BarrierTimeBeforeRank0    | 44.762 us                 | 78.333 us                 |
| BlockToStepN              | 17.490 us                 | 11.345 ms                 |
| OneStep                   | 176.186 ms                | 373.573 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
