WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:25:31.264989 41001 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_58', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41001 sampler.py:454] Start PreSampling
WARNING [41001 sampler.py:532] Before construct renumbering_dict
WARNING [41001 sampler.py:555] PreSampling done
W20240123 02:25:34.202792 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:25:34.202982 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:25:34.203022 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:25:34.203047 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:25:34.203068 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:25:34.203099 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:25:34.203125 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:25:34.203162 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:25:34.203187 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:25:34.203207 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:25:34.203243 41001 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:25:34.203263 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:25:34.203281 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:25:34.203392 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:25:34.203423 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:25:34.203444 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:25:34.203465 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:25:34.203485 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:25:34.203527 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:25:34.203552 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:25:34.203572 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:25:34.203598 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:25:34.203624 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:25:34.203645 41001 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:25:34.203663 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:25:34.203680 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:25:34.203732 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:25:34.203764 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:25:34.203785 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:25:34.203816 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:25:34.203841 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:25:34.203867 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:25:34.203895 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:25:34.203918 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:25:34.203953 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:25:34.203979 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:25:34.204000 41001 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:25:34.204017 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:25:34.204034 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:25:34.204074 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:25:34.204102 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:25:34.204129 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:25:34.204150 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:25:34.204170 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:25:34.204200 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:25:34.204219 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:25:34.204246 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:25:34.204278 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:25:34.204308 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:25:34.204334 41001 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:25:34.204351 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:25:34.204375 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:25:34.204416 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240123 02:25:34.204440 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240123 02:25:34.204461 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240123 02:25:34.204481 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240123 02:25:34.204510 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240123 02:25:34.204545 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240123 02:25:34.204578 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240123 02:25:34.204605 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240123 02:25:34.204627 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240123 02:25:34.204658 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240123 02:25:34.204679 41001 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240123 02:25:34.204695 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240123 02:25:34.204713 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240123 02:25:34.204754 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240123 02:25:34.204778 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240123 02:25:34.204807 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240123 02:25:34.204840 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240123 02:25:34.204861 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240123 02:25:34.204887 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240123 02:25:34.204908 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240123 02:25:34.204928 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240123 02:25:34.204949 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240123 02:25:34.204975 41001 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240123 02:25:34.204996 41001 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240123 02:25:34.205013 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240123 02:25:34.205036 41001 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240123 02:25:34.394910 41001 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100002e52000
W20240123 02:25:34.395056 41001 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100004524000
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  959,  1226,  1421,  ...,  3292,  2302, 13858]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.167 seconds
[Rank1] pid = 41408
[Rank2] pid = 41472
[Rank3] pid = 41536
[Rank4] pid = 41594
INFO [41001 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [41408 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41472 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [41536 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [41594 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [41665 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [41665 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41001 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41472 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41594 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41536 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41408 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41665 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41536 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41001 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41472 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41594 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41408 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [41001 cache_common.py:137] TorchNativeStdEmb construct done
INFO [41408 cache_common.py:137] TorchNativeStdEmb construct done
INFO [41472 cache_common.py:137] TorchNativeStdEmb construct done
INFO [41594 cache_common.py:137] TorchNativeStdEmb construct done
INFO [41536 cache_common.py:137] TorchNativeStdEmb construct done
INFO [41665 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [41001 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [41408 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [41536 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [41665 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [41594 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [41472 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:25:37.424643 41666 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240123 02:25:37.424748 41473 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:25:37.424881 41601 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:25:37.424988 41537 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:25:37.425096 41409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:25:37.425201 41667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:25:38.178156 41473 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240123 02:25:38.179951 41409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:25:38.181277 41601 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:25:38.181565 41667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:25:38.182145 41537 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:25:38.183753 41666 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 812.359 us                | 18.231 ms                 |
| Forward                   | 6.107 ms                  | 540.871 ms                |
| Backward                  | 62.970 ms                 | 157.139 ms                |
| Optimize                  | 1.721 ms                  | 2.469 ms                  |
| BarrierTimeBeforeRank0    | 7.429 ms                  | 22.515 ms                 |
| BlockToStepN              | 9.477 us                  | 224.950 us                |
| OneStep                   | 86.921 ms                 | 723.933 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.113 us                | 11.438 ms                 |
| Forward                   | 6.133 ms                  | 9.797 ms                  |
| Backward                  | 93.633 ms                 | 178.801 ms                |
| Optimize                  | 1.694 ms                  | 2.469 ms                  |
| BarrierTimeBeforeRank0    | 9.180 ms                  | 51.537 ms                 |
| BlockToStepN              | 9.607 us                  | 74.992 us                 |
| OneStep                   | 111.889 ms                | 235.933 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 821.218 us                | 11.438 ms                 |
| Forward                   | 6.126 ms                  | 12.762 ms                 |
| Backward                  | 120.931 ms                | 228.722 ms                |
| Optimize                  | 1.680 ms                  | 2.653 ms                  |
| BarrierTimeBeforeRank0    | 9.772 ms                  | 70.981 ms                 |
| BlockToStepN              | 9.953 us                  | 224.950 us                |
| OneStep                   | 140.568 ms                | 292.721 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 15.476, sample: 0.206, forward: 1.059, backward: 12.884, update: 0.157
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.478, sample: 0.214, forward: 1.054, backward: 12.970, update: 0.169
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 15.475, sample: 0.225, forward: 1.144, backward: 12.984, update: 0.149
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 15.479, sample: 0.198, forward: 1.027, backward: 11.895, update: 0.170
[Rank5] pid = 41665
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
train_sampler.Prefill()
-------Step 0-------
tensor([   69,  5836, 11230,   961, 12194,  7211,    74, 10215, 10180,  3064]) tensor([ 1421,   113,  6500,  7954,    95, 11013, 12041, 14854,  1374,  9797])
-------Step 1-------
tensor([   69,  5836, 11230,   961, 12194,  7211,    74, 10215, 10180,  3064]) tensor([12408,  1576,  9325,  4319,  2600,  7137, 12090,  7844, 10868, 14909])
-------Step 2-------
tensor([14060,    67,    87,    66,  8261,  3320, 12834,  7785,  5691,  2521]) tensor([ 5837,  2598,  1211,  7582,  3991,  8317, 11406,  8761,  7154,  7223])
-------Step 3-------
tensor([14060,    67,    87,    66,  8261,  3320, 12834,  7785,  5691,  2521]) tensor([12424, 11714,  6873,  5642,  9336, 10278, 13697,  7505,  8852, 14298])
-------Step 4-------
tensor([12277, 10357, 11760, 13332, 14257,  7565,    68,  8471, 12194, 10083]) tensor([10018,  2585, 10356,  1275,  1977,  2060, 14786, 13989,  5923,  3516])
-------Step 5-------
tensor([12277, 10357, 11760, 13332, 14257,  7565,    68,  8471, 12194, 10083]) tensor([ 4333, 12978,  8468, 11818, 12959,  5747,  3681, 11479, 13379,  7442])
-------Step 6-------
tensor([12587,  3238, 12658,   745, 10187, 10068,  8430, 14329,    85,  7560]) tensor([ 1228,  2099,  8700, 14574,  4576,  3807, 11171, 11933, 11976,  9299])
-------Step 7-------
tensor([12587,  3238, 12658,   745, 10187, 10068,  8430, 14329,    85,  7560]) tensor([ 8676,  1802,  6055, 13878,  4722, 13025,  5083,  7405,  2174,  9734])
-------Step 8-------
tensor([ 3806, 10601, 13166,  7102,  6992,  6996, 13545, 11779,  1933, 13922]) tensor([4715, 3455, 5114, 2764, 7131, 4423, 7219, 7401, 9723, 2157])
-------Step 9-------
tensor([ 3806, 10601, 13166,  7102,  6992,  6996, 13545, 11779,  1933, 13922]) tensor([ 1618,  6424,  7038,  6581,  5551, 12979,  1359,  1425, 10868,  5527])
before start barrier
start train
[proc 0] 100 steps, total: 15.474, sample: 0.219, forward: 1.165, backward: 12.245, update: 0.161
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 15.476, sample: 0.224, forward: 1.028, backward: 13.388, update: 0.153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 821.249 us                | 11.438 ms                 |
| Forward                   | 6.126 ms                  | 12.762 ms                 |
| Backward                  | 136.684 ms                | 284.385 ms                |
| Optimize                  | 1.652 ms                  | 2.653 ms                  |
| BarrierTimeBeforeRank0    | 12.620 ms                 | 70.981 ms                 |
| BlockToStepN              | 9.785 us                  | 224.950 us                |
| OneStep                   | 169.144 ms                | 342.244 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 837.465 us                | 12.055 ms                 |
| Forward                   | 6.126 ms                  | 12.762 ms                 |
| Backward                  | 156.990 ms                | 333.950 ms                |
| Optimize                  | 1.694 ms                  | 2.653 ms                  |
| BarrierTimeBeforeRank0    | 12.978 ms                 | 71.782 ms                 |
| BlockToStepN              | 9.953 us                  | 224.950 us                |
| OneStep                   | 181.375 ms                | 376.515 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.910 us                | 12.055 ms                 |
| Forward                   | 6.124 ms                  | 12.762 ms                 |
| Backward                  | 168.412 ms                | 363.929 ms                |
| Optimize                  | 1.672 ms                  | 2.653 ms                  |
| BarrierTimeBeforeRank0    | 13.961 ms                 | 71.782 ms                 |
| BlockToStepN              | 9.966 us                  | 224.950 us                |
| OneStep                   | 198.347 ms                | 385.544 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.027 us                | 11.438 ms                 |
| Forward                   | 6.133 ms                  | 9.906 ms                  |
| Backward                  | 181.713 ms                | 406.164 ms                |
| Optimize                  | 1.674 ms                  | 2.595 ms                  |
| BarrierTimeBeforeRank0    | 15.360 ms                 | 77.746 ms                 |
| BlockToStepN              | 10.243 us                 | 99.543 us                 |
| OneStep                   | 214.563 ms                | 442.884 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.517 us                | 11.438 ms                 |
| Forward                   | 6.161 ms                  | 9.906 ms                  |
| Backward                  | 198.850 ms                | 419.030 ms                |
| Optimize                  | 1.672 ms                  | 2.595 ms                  |
| BarrierTimeBeforeRank0    | 15.914 ms                 | 77.746 ms                 |
| BlockToStepN              | 10.243 us                 | 158.721 us                |
| OneStep                   | 235.933 ms                | 447.463 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 858.078 us                | 11.438 ms                 |
| Forward                   | 6.163 ms                  | 9.906 ms                  |
| Backward                  | 205.280 ms                | 451.571 ms                |
| Optimize                  | 1.674 ms                  | 2.595 ms                  |
| BarrierTimeBeforeRank0    | 15.996 ms                 | 100.052 ms                |
| BlockToStepN              | 10.345 us                 | 224.950 us                |
| OneStep                   | 247.031 ms                | 497.070 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.915 us                | 11.438 ms                 |
| Forward                   | 6.163 ms                  | 9.906 ms                  |
| Backward                  | 223.505 ms                | 470.503 ms                |
| Optimize                  | 1.684 ms                  | 2.595 ms                  |
| BarrierTimeBeforeRank0    | 16.443 ms                 | 100.052 ms                |
| BlockToStepN              | 10.524 us                 | 224.950 us                |
| OneStep                   | 259.713 ms                | 497.070 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 858.357 us                | 11.438 ms                 |
| Forward                   | 6.166 ms                  | 9.906 ms                  |
| Backward                  | 232.711 ms                | 486.899 ms                |
| Optimize                  | 1.684 ms                  | 2.653 ms                  |
| BarrierTimeBeforeRank0    | 15.914 ms                 | 100.052 ms                |
| BlockToStepN              | 10.719 us                 | 224.950 us                |
| OneStep                   | 263.641 ms                | 550.035 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 40.460, sample: 0.224, forward: 0.573, backward: 36.688, update: 0.145
[proc 4] 200 steps, total: 40.460, sample: 0.225, forward: 0.532, backward: 36.240, update: 0.151
[proc 1] 200 steps, total: 40.460, sample: 0.229, forward: 0.512, backward: 35.733, update: 0.169
[proc 2] 200 steps, total: 40.460, sample: 0.219, forward: 0.526, backward: 33.427, update: 0.173
[proc 5] 200 steps, total: 40.460, sample: 0.234, forward: 0.510, backward: 37.592, update: 0.150
[proc 0] 200 steps, total: 40.460, sample: 0.257, forward: 0.635, backward: 36.506, update: 0.168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 870.673 us                | 14.979 ms                 |
| Forward                   | 6.188 ms                  | 9.906 ms                  |
| Backward                  | 238.904 ms                | 605.098 ms                |
| Optimize                  | 1.694 ms                  | 2.693 ms                  |
| BarrierTimeBeforeRank0    | 15.996 ms                 | 100.052 ms                |
| BlockToStepN              | 10.723 us                 | 224.950 us                |
| OneStep                   | 277.349 ms                | 632.232 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 872.514 us                | 14.979 ms                 |
| Forward                   | 6.188 ms                  | 9.906 ms                  |
| Backward                  | 254.769 ms                | 607.812 ms                |
| Optimize                  | 1.694 ms                  | 2.693 ms                  |
| BarrierTimeBeforeRank0    | 16.926 ms                 | 100.052 ms                |
| BlockToStepN              | 10.742 us                 | 224.950 us                |
| OneStep                   | 292.721 ms                | 632.232 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 872.514 us                | 14.979 ms                 |
| Forward                   | 6.198 ms                  | 9.906 ms                  |
| Backward                  | 266.729 ms                | 609.814 ms                |
| Optimize                  | 1.694 ms                  | 2.693 ms                  |
| BarrierTimeBeforeRank0    | 16.926 ms                 | 100.768 ms                |
| BlockToStepN              | 10.778 us                 | 224.950 us                |
| OneStep                   | 305.534 ms                | 688.699 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 874.723 us                | 14.979 ms                 |
| Forward                   | 6.188 ms                  | 9.906 ms                  |
| Backward                  | 281.519 ms                | 609.814 ms                |
| Optimize                  | 1.694 ms                  | 2.724 ms                  |
| BarrierTimeBeforeRank0    | 17.171 ms                 | 100.768 ms                |
| BlockToStepN              | 10.933 us                 | 224.950 us                |
| OneStep                   | 316.857 ms                | 688.699 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 874.723 us                | 14.979 ms                 |
| Forward                   | 6.190 ms                  | 9.906 ms                  |
| Backward                  | 288.657 ms                | 629.050 ms                |
| Optimize                  | 1.706 ms                  | 2.816 ms                  |
| BarrierTimeBeforeRank0    | 17.659 ms                 | 137.655 ms                |
| BlockToStepN              | 11.037 us                 | 224.950 us                |
| OneStep                   | 338.672 ms                | 723.933 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 881.395 us                | 14.979 ms                 |
| Forward                   | 6.190 ms                  | 9.906 ms                  |
| Backward                  | 299.618 ms                | 629.050 ms                |
| Optimize                  | 1.703 ms                  | 2.816 ms                  |
| BarrierTimeBeforeRank0    | 17.591 ms                 | 137.655 ms                |
| BlockToStepN              | 11.037 us                 | 224.950 us                |
| OneStep                   | 344.923 ms                | 723.933 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 875.355 us                | 12.055 ms                 |
| Forward                   | 6.190 ms                  | 9.797 ms                  |
| Backward                  | 308.984 ms                | 638.186 ms                |
| Optimize                  | 1.694 ms                  | 2.724 ms                  |
| BarrierTimeBeforeRank0    | 17.679 ms                 | 147.134 ms                |
| BlockToStepN              | 11.039 us                 | 185.460 us                |
| OneStep                   | 352.804 ms                | 733.748 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 881.395 us                | 12.055 ms                 |
| Forward                   | 6.190 ms                  | 9.797 ms                  |
| Backward                  | 309.889 ms                | 685.637 ms                |
| Optimize                  | 1.694 ms                  | 2.724 ms                  |
| BarrierTimeBeforeRank0    | 17.659 ms                 | 147.134 ms                |
| BlockToStepN              | 11.050 us                 | 185.460 us                |
| OneStep                   | 353.447 ms                | 733.748 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 884.160 us                | 12.055 ms                 |
| Forward                   | 6.204 ms                  | 9.797 ms                  |
| Backward                  | 314.068 ms                | 689.908 ms                |
| Optimize                  | 1.694 ms                  | 2.861 ms                  |
| BarrierTimeBeforeRank0    | 17.929 ms                 | 167.692 ms                |
| BlockToStepN              | 11.123 us                 | 185.460 us                |
| OneStep                   | 358.881 ms                | 753.454 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 886.126 us                | 12.055 ms                 |
| Forward                   | 6.204 ms                  | 9.797 ms                  |
| Backward                  | 326.530 ms                | 708.184 ms                |
| Optimize                  | 1.702 ms                  | 2.861 ms                  |
| BarrierTimeBeforeRank0    | 17.929 ms                 | 167.692 ms                |
| BlockToStepN              | 11.185 us                 | 185.460 us                |
| OneStep                   | 373.934 ms                | 754.465 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 889.467 us                | 12.055 ms                 |
| Forward                   | 6.206 ms                  | 9.797 ms                  |
| Backward                  | 333.950 ms                | 710.055 ms                |
| Optimize                  | 1.702 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 18.029 ms                 | 170.877 ms                |
| BlockToStepN              | 11.291 us                 | 185.460 us                |
| OneStep                   | 385.545 ms                | 781.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 889.467 us                | 12.055 ms                 |
| Forward                   | 6.225 ms                  | 9.797 ms                  |
| Backward                  | 352.383 ms                | 734.232 ms                |
| Optimize                  | 1.694 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 17.929 ms                 | 170.877 ms                |
| BlockToStepN              | 11.354 us                 | 185.460 us                |
| OneStep                   | 394.018 ms                | 781.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 898.465 us                | 12.055 ms                 |
| Forward                   | 6.230 ms                  | 9.797 ms                  |
| Backward                  | 354.431 ms                | 747.220 ms                |
| Optimize                  | 1.702 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 17.929 ms                 | 171.629 ms                |
| BlockToStepN              | 11.370 us                 | 185.460 us                |
| OneStep                   | 401.418 ms                | 867.379 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 67.488, sample: 0.209, forward: 0.538, backward: 60.954, update: 0.161
[proc 3] 300 steps, total: 67.488, sample: 0.207, forward: 0.575, backward: 60.083, update: 0.148
[proc 5] 300 steps, total: 67.488, sample: 0.216, forward: 0.498, backward: 60.887, update: 0.153
[proc 2] 300 steps, total: 67.488, sample: 0.205, forward: 0.540, backward: 55.930, update: 0.175
[proc 0] 300 steps, total: 67.488, sample: 0.224, forward: 0.636, backward: 61.941, update: 0.174
[proc 1] 300 steps, total: 67.488, sample: 0.226, forward: 0.503, backward: 58.965, update: 0.165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 898.318 us                | 12.055 ms                 |
| Forward                   | 6.230 ms                  | 9.797 ms                  |
| Backward                  | 363.929 ms                | 806.481 ms                |
| Optimize                  | 1.706 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 17.938 ms                 | 171.629 ms                |
| BlockToStepN              | 11.478 us                 | 185.460 us                |
| OneStep                   | 408.279 ms                | 867.379 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 898.465 us                | 12.055 ms                 |
| Forward                   | 6.230 ms                  | 9.797 ms                  |
| Backward                  | 365.454 ms                | 811.226 ms                |
| Optimize                  | 1.706 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 18.029 ms                 | 268.252 ms                |
| BlockToStepN              | 11.580 us                 | 185.460 us                |
| OneStep                   | 416.189 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.955 us                | 12.221 ms                 |
| Forward                   | 6.257 ms                  | 9.797 ms                  |
| Backward                  | 372.098 ms                | 812.145 ms                |
| Optimize                  | 1.715 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 268.252 ms                |
| BlockToStepN              | 11.629 us                 | 185.460 us                |
| OneStep                   | 418.829 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.955 us                | 12.221 ms                 |
| Forward                   | 6.257 ms                  | 9.797 ms                  |
| Backward                  | 376.946 ms                | 835.701 ms                |
| Optimize                  | 1.717 ms                  | 2.915 ms                  |
| BarrierTimeBeforeRank0    | 18.472 ms                 | 284.888 ms                |
| BlockToStepN              | 11.648 us                 | 185.460 us                |
| OneStep                   | 424.225 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 898.465 us                | 12.221 ms                 |
| Forward                   | 6.257 ms                  | 9.797 ms                  |
| Backward                  | 384.358 ms                | 842.821 ms                |
| Optimize                  | 1.715 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 284.888 ms                |
| BlockToStepN              | 11.648 us                 | 185.460 us                |
| OneStep                   | 427.538 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.793 us                | 12.221 ms                 |
| Forward                   | 6.261 ms                  | 9.797 ms                  |
| Backward                  | 392.551 ms                | 863.608 ms                |
| Optimize                  | 1.715 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 284.888 ms                |
| BlockToStepN              | 11.660 us                 | 185.460 us                |
| OneStep                   | 432.902 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.793 us                | 12.221 ms                 |
| Forward                   | 6.261 ms                  | 9.906 ms                  |
| Backward                  | 406.164 ms                | 884.268 ms                |
| Optimize                  | 1.708 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.472 ms                 | 284.888 ms                |
| BlockToStepN              | 11.711 us                 | 224.950 us                |
| OneStep                   | 442.884 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.793 us                | 12.221 ms                 |
| Forward                   | 6.268 ms                  | 11.438 ms                 |
| Backward                  | 410.938 ms                | 912.419 ms                |
| Optimize                  | 1.708 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.472 ms                 | 284.888 ms                |
| BlockToStepN              | 11.791 us                 | 224.950 us                |
| OneStep                   | 459.913 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 916.064 us                | 12.221 ms                 |
| Forward                   | 6.273 ms                  | 11.438 ms                 |
| Backward                  | 419.030 ms                | 934.556 ms                |
| Optimize                  | 1.717 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.472 ms                 | 284.888 ms                |
| BlockToStepN              | 11.917 us                 | 224.950 us                |
| OneStep                   | 465.804 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.397 us                | 12.055 ms                 |
| Forward                   | 6.291 ms                  | 9.992 ms                  |
| Backward                  | 420.158 ms                | 1.047 s                   |
| Optimize                  | 1.717 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 284.888 ms                |
| BlockToStepN              | 12.097 us                 | 224.950 us                |
| OneStep                   | 468.357 ms                | 1.128 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.397 us                | 12.055 ms                 |
| Forward                   | 6.295 ms                  | 9.992 ms                  |
| Backward                  | 431.695 ms                | 1.045 s                   |
| Optimize                  | 1.719 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.472 ms                 | 284.888 ms                |
| BlockToStepN              | 12.267 us                 | 185.460 us                |
| OneStep                   | 472.374 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.397 us                | 12.221 ms                 |
| Forward                   | 6.301 ms                  | 9.992 ms                  |
| Backward                  | 437.493 ms                | 1.047 s                   |
| Optimize                  | 1.721 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 284.888 ms                |
| BlockToStepN              | 12.389 us                 | 185.460 us                |
| OneStep                   | 474.458 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 927.396 us                | 12.221 ms                 |
| Forward                   | 6.299 ms                  | 9.992 ms                  |
| Backward                  | 448.968 ms                | 1.047 s                   |
| Optimize                  | 1.722 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.209 ms                 | 284.888 ms                |
| BlockToStepN              | 12.497 us                 | 185.460 us                |
| OneStep                   | 485.515 ms                | 1.128 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 940.557 us                | 12.221 ms                 |
| Forward                   | 6.301 ms                  | 9.992 ms                  |
| Backward                  | 454.526 ms                | 1.047 s                   |
| Optimize                  | 1.722 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.723 ms                 | 290.214 ms                |
| BlockToStepN              | 12.620 us                 | 185.460 us                |
| OneStep                   | 488.363 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 944.704 us                | 12.221 ms                 |
| Forward                   | 6.302 ms                  | 9.992 ms                  |
| Backward                  | 461.689 ms                | 1.047 s                   |
| Optimize                  | 1.727 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.733 ms                 | 290.214 ms                |
| BlockToStepN              | 12.722 us                 | 185.460 us                |
| OneStep                   | 490.947 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 955.251 us                | 12.221 ms                 |
| Forward                   | 6.302 ms                  | 9.992 ms                  |
| Backward                  | 463.700 ms                | 1.067 s                   |
| Optimize                  | 1.737 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.831 ms                 | 298.442 ms                |
| BlockToStepN              | 12.744 us                 | 185.460 us                |
| OneStep                   | 493.177 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 963.586 us                | 12.221 ms                 |
| Forward                   | 6.302 ms                  | 9.992 ms                  |
| Backward                  | 465.420 ms                | 1.067 s                   |
| Optimize                  | 1.737 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.831 ms                 | 298.442 ms                |
| BlockToStepN              | 12.764 us                 | 185.460 us                |
| OneStep                   | 496.229 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 967.069 us                | 12.221 ms                 |
| Forward                   | 6.302 ms                  | 9.992 ms                  |
| Backward                  | 472.868 ms                | 1.067 s                   |
| Optimize                  | 1.737 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.076 ms                 | 298.442 ms                |
| BlockToStepN              | 12.847 us                 | 185.460 us                |
| OneStep                   | 505.038 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 969.193 us                | 12.221 ms                 |
| Forward                   | 6.313 ms                  | 9.992 ms                  |
| Backward                  | 473.504 ms                | 1.115 s                   |
| Optimize                  | 1.746 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 18.938 ms                 | 298.442 ms                |
| BlockToStepN              | 12.915 us                 | 185.460 us                |
| OneStep                   | 508.413 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 974.525 us                | 12.221 ms                 |
| Forward                   | 6.313 ms                  | 9.992 ms                  |
| Backward                  | 478.276 ms                | 1.115 s                   |
| Optimize                  | 1.762 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.680 ms                 | 298.442 ms                |
| BlockToStepN              | 12.923 us                 | 185.460 us                |
| OneStep                   | 528.703 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 96.393, sample: 0.220, forward: 0.539, backward: 84.926, update: 0.168
[proc 0] 400 steps, total: 96.392, sample: 0.243, forward: 0.664, backward: 87.512, update: 0.189
[proc 2] 400 steps, total: 96.392, sample: 0.245, forward: 0.556, backward: 78.499, update: 0.187
[proc 3] 400 steps, total: 96.393, sample: 0.220, forward: 0.599, backward: 85.640, update: 0.160
[proc 5] 400 steps, total: 96.393, sample: 0.215, forward: 0.514, backward: 84.574, update: 0.162
[proc 1] 400 steps, total: 96.392, sample: 0.232, forward: 0.503, backward: 81.612, update: 0.163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 974.525 us                | 12.221 ms                 |
| Forward                   | 6.316 ms                  | 9.992 ms                  |
| Backward                  | 482.465 ms                | 1.115 s                   |
| Optimize                  | 1.760 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.001 us                 | 185.460 us                |
| OneStep                   | 538.047 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 974.525 us                | 14.208 ms                 |
| Forward                   | 6.316 ms                  | 9.992 ms                  |
| Backward                  | 484.569 ms                | 1.115 s                   |
| Optimize                  | 1.762 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.032 us                 | 185.460 us                |
| OneStep                   | 545.320 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 978.831 us                | 14.208 ms                 |
| Forward                   | 6.318 ms                  | 9.992 ms                  |
| Backward                  | 488.533 ms                | 1.115 s                   |
| Optimize                  | 1.767 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.020 us                 | 185.460 us                |
| OneStep                   | 549.426 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 978.831 us                | 14.208 ms                 |
| Forward                   | 6.325 ms                  | 9.992 ms                  |
| Backward                  | 501.591 ms                | 1.115 s                   |
| Optimize                  | 1.767 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.076 ms                 | 298.442 ms                |
| BlockToStepN              | 13.001 us                 | 185.460 us                |
| OneStep                   | 550.035 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 978.831 us                | 14.208 ms                 |
| Forward                   | 6.318 ms                  | 9.992 ms                  |
| Backward                  | 510.193 ms                | 1.115 s                   |
| Optimize                  | 1.770 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.001 us                 | 185.460 us                |
| OneStep                   | 556.546 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 978.831 us                | 14.208 ms                 |
| Forward                   | 6.319 ms                  | 9.992 ms                  |
| Backward                  | 516.085 ms                | 1.118 s                   |
| Optimize                  | 1.774 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.020 us                 | 185.460 us                |
| OneStep                   | 565.135 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 983.927 us                | 14.208 ms                 |
| Forward                   | 6.325 ms                  | 9.992 ms                  |
| Backward                  | 523.427 ms                | 1.143 s                   |
| Optimize                  | 1.775 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.032 us                 | 185.460 us                |
| OneStep                   | 572.687 ms                | 1.232 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 995.802 us                | 14.208 ms                 |
| Forward                   | 6.332 ms                  | 9.992 ms                  |
| Backward                  | 526.064 ms                | 1.268 s                   |
| Optimize                  | 1.775 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.125 us                 | 185.460 us                |
| OneStep                   | 573.120 ms                | 1.458 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 14.208 ms                 |
| Forward                   | 6.332 ms                  | 9.992 ms                  |
| Backward                  | 529.984 ms                | 1.316 s                   |
| Optimize                  | 1.777 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.076 ms                 | 298.442 ms                |
| BlockToStepN              | 13.167 us                 | 224.950 us                |
| OneStep                   | 576.315 ms                | 1.458 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 14.208 ms                 |
| Forward                   | 6.333 ms                  | 9.992 ms                  |
| Backward                  | 531.747 ms                | 1.316 s                   |
| Optimize                  | 1.779 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 298.442 ms                |
| BlockToStepN              | 13.189 us                 | 224.950 us                |
| OneStep                   | 580.475 ms                | 1.458 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 14.208 ms                 |
| Forward                   | 6.333 ms                  | 9.992 ms                  |
| Backward                  | 539.329 ms                | 1.316 s                   |
| Optimize                  | 1.779 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.609 ms                 | 301.428 ms                |
| BlockToStepN              | 13.276 us                 | 224.950 us                |
| OneStep                   | 594.983 ms                | 1.458 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 12.509 ms                 |
| Forward                   | 6.335 ms                  | 9.906 ms                  |
| Backward                  | 544.422 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.680 ms                 | 319.255 ms                |
| BlockToStepN              | 13.312 us                 | 224.950 us                |
| OneStep                   | 598.288 ms                | 1.458 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.010 ms                  | 13.679 ms                 |
| Forward                   | 6.336 ms                  | 9.906 ms                  |
| Backward                  | 552.399 ms                | 1.268 s                   |
| Optimize                  | 1.792 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.703 ms                 | 301.428 ms                |
| BlockToStepN              | 13.312 us                 | 185.460 us                |
| OneStep                   | 609.551 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 13.679 ms                 |
| Forward                   | 6.336 ms                  | 9.906 ms                  |
| Backward                  | 553.190 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.703 ms                 | 301.428 ms                |
| BlockToStepN              | 13.317 us                 | 185.460 us                |
| OneStep                   | 610.370 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.005 ms                  | 13.679 ms                 |
| Forward                   | 6.336 ms                  | 9.906 ms                  |
| Backward                  | 565.388 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.768 ms                 | 319.255 ms                |
| BlockToStepN              | 13.380 us                 | 185.460 us                |
| OneStep                   | 616.644 ms                | 1.518 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.010 ms                  | 13.679 ms                 |
| Forward                   | 6.336 ms                  | 9.906 ms                  |
| Backward                  | 571.140 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.934 ms                  |
| BarrierTimeBeforeRank0    | 19.821 ms                 | 319.255 ms                |
| BlockToStepN              | 13.489 us                 | 185.460 us                |
| OneStep                   | 622.027 ms                | 1.518 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.010 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 578.420 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 19.923 ms                 | 319.255 ms                |
| BlockToStepN              | 13.489 us                 | 185.460 us                |
| OneStep                   | 622.276 ms                | 1.518 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.016 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 580.161 ms                | 1.268 s                   |
| Optimize                  | 1.789 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 19.923 ms                 | 319.255 ms                |
| BlockToStepN              | 13.492 us                 | 185.460 us                |
| OneStep                   | 626.445 ms                | 1.518 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.010 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 583.547 ms                | 1.303 s                   |
| Optimize                  | 1.789 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 19.923 ms                 | 330.565 ms                |
| BlockToStepN              | 13.604 us                 | 185.460 us                |
| OneStep                   | 630.758 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.011 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 590.943 ms                | 1.303 s                   |
| Optimize                  | 1.792 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 19.937 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 632.652 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.011 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 597.372 ms                | 1.303 s                   |
| Optimize                  | 1.795 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 19.937 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 637.878 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.024 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 598.331 ms                | 1.303 s                   |
| Optimize                  | 1.797 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 20.025 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 650.844 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.024 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 600.443 ms                | 1.303 s                   |
| Optimize                  | 1.798 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 20.339 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 657.464 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.024 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 603.968 ms                | 1.316 s                   |
| Optimize                  | 1.799 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 20.418 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 659.421 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 122.891, sample: 0.236, forward: 0.546, backward: 108.908, update: 0.166
[proc 5] 500 steps, total: 122.891, sample: 0.206, forward: 0.507, backward: 107.979, update: 0.157
[proc 1] 500 steps, total: 122.891, sample: 0.199, forward: 0.508, backward: 104.332, update: 0.165
[proc 2] 500 steps, total: 122.891, sample: 0.205, forward: 0.540, backward: 100.713, update: 0.183
[proc 3] 500 steps, total: 122.891, sample: 0.234, forward: 0.600, backward: 109.245, update: 0.163
[proc 0] 500 steps, total: 122.891, sample: 0.249, forward: 0.658, backward: 112.823, update: 0.193
Successfully xmh. training takes 342.7056074142456 seconds
before call kg_cache_controller.StopThreads()
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
INFO [41001 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.016 ms                  | 13.679 ms                 |
| Forward                   | 6.340 ms                  | 9.906 ms                  |
| Backward                  | 605.098 ms                | 1.320 s                   |
| Optimize                  | 1.797 ms                  | 2.956 ms                  |
| BarrierTimeBeforeRank0    | 20.363 ms                 | 330.565 ms                |
| BlockToStepN              | 13.631 us                 | 185.460 us                |
| OneStep                   | 660.661 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
