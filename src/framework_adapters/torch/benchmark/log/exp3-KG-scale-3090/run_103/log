WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 02:39:03.642083 14399 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_50', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [14399 sampler.py:454] Start PreSampling
WARNING [14399 sampler.py:532] Before construct renumbering_dict
WARNING [14399 sampler.py:555] PreSampling done
W20240124 02:52:25.763937 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 02:52:25.764151 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 02:52:25.764190 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 02:52:25.764219 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 02:52:25.764242 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 02:52:25.764264 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 02:52:25.764288 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 02:52:25.764315 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 02:52:25.764338 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 02:52:25.764364 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 02:52:25.764393 14399 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 02:52:25.764418 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 02:52:25.764443 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 02:52:25.764591 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 02:52:25.764621 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 02:52:25.764644 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 02:52:25.764686 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 02:52:25.764710 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 02:52:25.764744 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 02:52:25.764770 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 02:52:25.764811 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 02:52:25.764843 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 02:52:25.764868 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 02:52:25.764899 14399 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 02:52:25.764916 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 02:52:25.764935 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 02:52:25.764989 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 02:52:25.765015 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 02:52:25.765035 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 02:52:25.765061 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 02:52:25.765084 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 02:52:25.765116 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 02:52:25.765144 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 02:52:25.765175 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 02:52:25.765203 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 02:52:25.765224 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 02:52:25.765247 14399 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 02:52:25.765281 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 02:52:25.765300 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 02:52:25.765350 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 02:52:25.765380 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 02:52:25.765408 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 02:52:25.765429 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 02:52:25.765450 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 02:52:25.765471 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 02:52:25.765501 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 02:52:25.765528 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 02:52:25.765559 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 02:52:25.765589 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 02:52:25.765612 14399 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 02:52:25.765630 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 02:52:25.765652 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 02:52:25.765699 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 02:52:25.765738 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 02:52:25.765760 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 02:52:25.765784 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 02:52:25.765806 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 02:52:25.765832 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 02:52:25.765856 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 02:52:25.765877 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 02:52:25.765897 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 02:52:25.765918 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 02:52:25.765938 14399 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 02:52:25.765955 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 02:52:25.765975 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 02:52:25.766019 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 02:52:25.766052 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 02:52:25.766078 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 02:52:25.766100 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 02:52:25.766129 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 02:52:25.766151 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 02:52:25.766172 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 02:52:25.766196 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 02:52:25.766222 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 02:52:25.766248 14399 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 02:52:25.766269 14399 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 02:52:25.766286 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 02:52:25.766309 14399 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 02:52:26.074121 14399 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100002e52000 128.2 GB
W20240124 02:52:26.074286 14399 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102011a8a000 328.3 MB
{0: Graph(num_nodes=16364881, num_edges=60475646,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22851247, num_edges=75085053,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16469571, num_edges=67497598,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17544490, num_edges=53244935,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=18090773, num_edges=55134734,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=20615225, num_edges=67664913,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16364881 N 60475646 E
MertisPartition: part 1 has 22851247 N 75085053 E
MertisPartition: part 2 has 16469571 N 67497598 E
MertisPartition: part 3 has 17544490 N 53244935 E
MertisPartition: part 4 has 18090773 N 55134734 E
MertisPartition: part 5 has 20615225 N 67664913 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,        6,  ..., 37713888,  7166588, 11887902]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
After renumbering graph:  {'_ID': tensor([ 4302851,  4302885,  4302914,  ...,  5989553, 63202374, 39943080]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 979.746 seconds
[Rank1] pid = 39263
[Rank2] pid = 39366
[Rank3] pid = 39438
[Rank4] pid = 39519
INFO [14399 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [39263 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [39366 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [39438 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [39602 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [39519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [39438 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39366 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39602 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39519 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [14399 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39438 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [14399 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [39519 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [39263 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39366 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [39602 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [39263 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [39438 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [39438 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [39602 cache_common.py:137] TorchNativeStdEmb construct done
INFO [39519 cache_common.py:137] TorchNativeStdEmb construct done
INFO [39366 cache_common.py:137] TorchNativeStdEmb construct done
INFO [39263 cache_common.py:137] TorchNativeStdEmb construct done
INFO [14399 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [39263 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [39519 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14399 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [39366 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [39602 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 02:55:28.935916 39603 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240124 02:55:28.936671 39369 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:55:28.936890 39520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:55:28.937022 39265 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:55:28.937124 39667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:55:28.937244 39439 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 02:55:38.106240 39439 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240124 02:55:38.750109 39520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:55:39.164119 39667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:55:40.196486 39603 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:55:40.729915 39369 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:55:41.335430 39265 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.510 ms                  | 65.105 ms                 |
| Forward                   | 8.775 ms                  | 528.576 ms                |
| Backward                  | 59.280 ms                 | 163.571 ms                |
| Optimize                  | 1.906 ms                  | 13.549 ms                 |
| BarrierTimeBeforeRank0    | 8.208 ms                  | 21.576 ms                 |
| BlockToStepN              | 6.940 us                  | 50.127 us                 |
| OneStep                   | 85.557 ms                 | 721.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.745 ms                  | 62.476 ms                 |
| Forward                   | 8.679 ms                  | 9.806 ms                  |
| Backward                  | 106.231 ms                | 258.525 ms                |
| Optimize                  | 1.864 ms                  | 13.549 ms                 |
| BarrierTimeBeforeRank0    | 10.088 ms                 | 25.892 ms                 |
| BlockToStepN              | 6.940 us                  | 50.127 us                 |
| OneStep                   | 142.311 ms                | 721.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.858 ms                  | 62.476 ms                 |
| Forward                   | 8.554 ms                  | 10.134 ms                 |
| Backward                  | 141.497 ms                | 258.525 ms                |
| Optimize                  | 1.855 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 10.695 ms                 | 83.476 ms                 |
| BlockToStepN              | 7.007 us                  | 41.052 us                 |
| OneStep                   | 172.147 ms                | 358.517 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.858 ms                  | 62.476 ms                 |
| Forward                   | 8.524 ms                  | 10.134 ms                 |
| Backward                  | 166.455 ms                | 311.073 ms                |
| Optimize                  | 1.798 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 11.503 ms                 | 87.863 ms                 |
| BlockToStepN              | 7.170 us                  | 41.052 us                 |
| OneStep                   | 201.881 ms                | 419.772 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.745 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.134 ms                 |
| Backward                  | 195.145 ms                | 367.926 ms                |
| Optimize                  | 1.733 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 11.051 ms                 | 87.863 ms                 |
| BlockToStepN              | 7.306 us                  | 50.127 us                 |
| OneStep                   | 229.537 ms                | 419.772 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 26.541, sample: 0.707, forward: 1.888, backward: 19.673, update: 0.173
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.561, sample: 0.818, forward: 1.999, backward: 20.118, update: 0.170
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.955, sample: 0.759, forward: 1.918, backward: 19.759, update: 0.174
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.184, sample: 0.702, forward: 1.943, backward: 19.555, update: 0.163
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 25.094, sample: 0.839, forward: 1.961, backward: 19.212, update: 0.174
[Rank5] pid = 39602
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 268495,  322374, 4377948,  122899,  122931,  122961, 7948292,  122991,
         123021,  123050]) tensor([ 5092790, 45748099, 46066015,  4575580, 61208817, 22667209, 48690491,
        16717020, 78256782,  8050288])
-------Step 1-------
tensor([ 268495,  322374, 4377948,  122899,  122931,  122961, 7948292,  122991,
         123021,  123050]) tensor([84399491, 49354104, 62064609, 42893985, 38949810, 22983907, 66399051,
        10481574, 20196431, 77242877])
-------Step 2-------
tensor([  173250,   173281,   173308,   173336,   173358, 65975405,   425547,
          173385,   173409,   173436]) tensor([34988510, 63152799, 33570666, 26515935, 11511771, 11385786, 84765798,
        55310367, 55890743,   103236])
-------Step 3-------
tensor([  173250,   173281,   173308,   173336,   173358, 65975405,   425547,
          173385,   173409,   173436]) tensor([66181424, 52844665, 32082782, 57844921, 48459411, 35369040, 28985675,
        14130014, 10378479, 67891761])
-------Step 4-------
tensor([  243035,   290381,   290410,   243098,   243150,   290438, 19866486,
          243191,   243235,  4788594]) tensor([71346986, 60260477, 16821539, 64136470, 83278169, 55790087, 76082260,
        10653885, 54536522, 26757423])
-------Step 5-------
tensor([  243035,   290381,   290410,   243098,   243150,   290438, 19866486,
          243191,   243235,  4788594]) tensor([43407425, 15257084,  8900254, 69808783,  2027282, 58868247, 21090293,
        16128370, 76256147, 77870129])
-------Step 6-------
tensor([  294248, 11586576,   294268,   294293,   294313,   301040, 19866486,
          294341, 13992063,   294375]) tensor([64063629, 16395800, 16203801, 35733597,  6427219,  3494218, 43576389,
         8924787, 26091830, 31838169])
-------Step 7-------
tensor([  294248, 11586576,   294268,   294293,   294313,   301040, 19866486,
          294341, 13992063,   294375]) tensor([44119447, 32554363, 32954154, 45770960, 50809188, 38681123, 39538236,
        22372523, 37720867, 38705037])
-------Step 8-------
tensor([70536703,   344564,    31641,   344591,   344615,   344640,   344668,
          344695,   344722,   372405]) tensor([  710805,   214858,  3277591, 50267255, 65843124, 66598702, 30218450,
        30143288, 80089640, 51510892])
-------Step 9-------
tensor([70536703,   344564,    31641,   344591,   344615,   344640,   344668,
          344695,   344722,   372405]) tensor([37302559, 16042089, 66692347, 25423898, 41028293,  6013659, 40658930,
        37192576, 58862752, 48876924])
before start barrier
start train
[proc 0] 100 steps, total: 26.126, sample: 0.791, forward: 1.368, backward: 19.921, update: 0.179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.646 ms                  | 63.362 ms                 |
| Forward                   | 8.531 ms                  | 10.134 ms                 |
| Backward                  | 214.865 ms                | 443.527 ms                |
| Optimize                  | 1.731 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 11.154 ms                 | 87.863 ms                 |
| BlockToStepN              | 7.319 us                  | 50.127 us                 |
| OneStep                   | 259.321 ms                | 519.386 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.700 ms                  | 63.362 ms                 |
| Forward                   | 8.531 ms                  | 10.134 ms                 |
| Backward                  | 234.443 ms                | 443.527 ms                |
| Optimize                  | 1.726 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 12.165 ms                 | 89.838 ms                 |
| BlockToStepN              | 7.398 us                  | 50.127 us                 |
| OneStep                   | 286.251 ms                | 539.045 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.700 ms                  | 63.362 ms                 |
| Forward                   | 8.515 ms                  | 10.134 ms                 |
| Backward                  | 241.454 ms                | 473.037 ms                |
| Optimize                  | 1.726 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 13.028 ms                 | 150.070 ms                |
| BlockToStepN              | 7.581 us                  | 127.172 us                |
| OneStep                   | 305.790 ms                | 622.770 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.745 ms                  | 63.362 ms                 |
| Forward                   | 8.510 ms                  | 10.134 ms                 |
| Backward                  | 263.172 ms                | 521.534 ms                |
| Optimize                  | 1.724 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 13.028 ms                 | 150.070 ms                |
| BlockToStepN              | 7.879 us                  | 127.172 us                |
| OneStep                   | 315.942 ms                | 672.109 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.769 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.414 ms                 |
| Backward                  | 279.799 ms                | 570.118 ms                |
| Optimize                  | 1.726 ms                  | 3.233 ms                  |
| BarrierTimeBeforeRank0    | 12.818 ms                 | 150.070 ms                |
| BlockToStepN              | 8.070 us                  | 127.172 us                |
| OneStep                   | 331.221 ms                | 721.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.777 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.134 ms                 |
| Backward                  | 294.892 ms                | 561.315 ms                |
| Optimize                  | 1.727 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.028 ms                 | 136.823 ms                |
| BlockToStepN              | 8.077 us                  | 119.145 us                |
| OneStep                   | 338.771 ms                | 710.789 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.804 ms                  | 63.362 ms                 |
| Forward                   | 8.501 ms                  | 10.134 ms                 |
| Backward                  | 310.052 ms                | 605.242 ms                |
| Optimize                  | 1.728 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.541 ms                 | 136.823 ms                |
| BlockToStepN              | 8.245 us                  | 119.145 us                |
| OneStep                   | 347.695 ms                | 710.789 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.858 ms                  | 63.362 ms                 |
| Forward                   | 8.487 ms                  | 10.134 ms                 |
| Backward                  | 315.669 ms                | 646.776 ms                |
| Optimize                  | 1.727 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.541 ms                 | 150.070 ms                |
| BlockToStepN              | 8.356 us                  | 119.145 us                |
| OneStep                   | 360.843 ms                | 759.124 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.858 ms                  | 63.362 ms                 |
| Forward                   | 8.487 ms                  | 10.134 ms                 |
| Backward                  | 335.325 ms                | 759.084 ms                |
| Optimize                  | 1.731 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.541 ms                 | 150.070 ms                |
| BlockToStepN              | 8.476 us                  | 119.145 us                |
| OneStep                   | 364.914 ms                | 815.995 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.858 ms                  | 63.362 ms                 |
| Forward                   | 8.501 ms                  | 10.134 ms                 |
| Backward                  | 348.850 ms                | 759.084 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.190 ms                 | 153.210 ms                |
| BlockToStepN              | 8.623 us                  | 119.145 us                |
| OneStep                   | 381.665 ms                | 815.995 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.897 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.134 ms                 |
| Backward                  | 362.021 ms                | 759.084 ms                |
| Optimize                  | 1.728 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.357 ms                 | 155.600 ms                |
| BlockToStepN              | 8.770 us                  | 119.145 us                |
| OneStep                   | 390.751 ms                | 829.689 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.897 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.134 ms                 |
| Backward                  | 369.014 ms                | 768.592 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.792 ms                 | 155.600 ms                |
| BlockToStepN              | 8.862 us                  | 119.145 us                |
| OneStep                   | 403.577 ms                | 829.689 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 62.854, sample: 0.892, forward: 1.264, backward: 56.130, update: 0.163
[proc 3] 200 steps, total: 62.854, sample: 0.766, forward: 1.319, backward: 55.292, update: 0.169
[proc 5] 200 steps, total: 62.854, sample: 0.984, forward: 1.224, backward: 54.281, update: 0.183
[proc 2] 200 steps, total: 62.854, sample: 1.275, forward: 1.338, backward: 57.563, update: 0.162
[proc 0] 200 steps, total: 62.854, sample: 0.928, forward: 0.849, backward: 57.205, update: 0.165
[proc 4] 200 steps, total: 62.854, sample: 0.913, forward: 1.255, backward: 56.502, update: 0.193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.938 ms                  | 63.362 ms                 |
| Forward                   | 8.510 ms                  | 10.134 ms                 |
| Backward                  | 382.262 ms                | 814.039 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.592 ms                 | 155.600 ms                |
| BlockToStepN              | 9.052 us                  | 119.145 us                |
| OneStep                   | 422.759 ms                | 855.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 63.362 ms                 |
| Forward                   | 8.515 ms                  | 10.134 ms                 |
| Backward                  | 392.986 ms                | 814.039 ms                |
| Optimize                  | 1.731 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.792 ms                 | 209.649 ms                |
| BlockToStepN              | 9.052 us                  | 119.145 us                |
| OneStep                   | 426.508 ms                | 950.435 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.134 ms                 |
| Backward                  | 402.447 ms                | 815.650 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.792 ms                 | 231.278 ms                |
| BlockToStepN              | 9.068 us                  | 119.145 us                |
| OneStep                   | 447.711 ms                | 964.042 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 63.362 ms                 |
| Forward                   | 8.505 ms                  | 10.134 ms                 |
| Backward                  | 408.114 ms                | 830.938 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.827 ms                 | 231.278 ms                |
| BlockToStepN              | 9.069 us                  | 119.145 us                |
| OneStep                   | 461.383 ms                | 964.042 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 63.362 ms                 |
| Forward                   | 8.515 ms                  | 10.134 ms                 |
| Backward                  | 418.709 ms                | 837.127 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.357 ms                 | 237.604 ms                |
| BlockToStepN              | 9.122 us                  | 119.145 us                |
| OneStep                   | 473.024 ms                | 993.822 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 63.362 ms                 |
| Forward                   | 8.515 ms                  | 10.134 ms                 |
| Backward                  | 421.479 ms                | 847.508 ms                |
| Optimize                  | 1.728 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.357 ms                 | 295.931 ms                |
| BlockToStepN              | 9.138 us                  | 119.145 us                |
| OneStep                   | 484.249 ms                | 1.112 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.042 ms                  | 65.105 ms                 |
| Forward                   | 8.517 ms                  | 10.134 ms                 |
| Backward                  | 429.026 ms                | 888.763 ms                |
| Optimize                  | 1.726 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.190 ms                 | 295.931 ms                |
| BlockToStepN              | 9.181 us                  | 119.145 us                |
| OneStep                   | 499.404 ms                | 1.112 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.009 ms                  | 65.105 ms                 |
| Forward                   | 8.517 ms                  | 10.414 ms                 |
| Backward                  | 435.414 ms                | 889.544 ms                |
| Optimize                  | 1.727 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 13.900 ms                 | 295.931 ms                |
| BlockToStepN              | 9.385 us                  | 127.172 us                |
| OneStep                   | 511.220 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.042 ms                  | 65.105 ms                 |
| Forward                   | 8.517 ms                  | 10.414 ms                 |
| Backward                  | 451.554 ms                | 898.796 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.357 ms                 | 313.696 ms                |
| BlockToStepN              | 9.464 us                  | 127.172 us                |
| OneStep                   | 516.878 ms                | 1.145 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.130 ms                  | 65.105 ms                 |
| Forward                   | 8.518 ms                  | 10.414 ms                 |
| Backward                  | 460.405 ms                | 916.675 ms                |
| Optimize                  | 1.730 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 14.448 ms                 | 313.696 ms                |
| BlockToStepN              | 9.586 us                  | 1.575 ms                  |
| OneStep                   | 519.386 ms                | 1.145 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.130 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.134 ms                 |
| Backward                  | 473.037 ms                | 921.178 ms                |
| Optimize                  | 1.730 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.459 ms                 | 313.696 ms                |
| BlockToStepN              | 9.639 us                  | 127.172 us                |
| OneStep                   | 539.045 ms                | 1.213 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.099 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.414 ms                 |
| Backward                  | 490.430 ms                | 978.155 ms                |
| Optimize                  | 1.731 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.448 ms                 | 313.696 ms                |
| BlockToStepN              | 9.734 us                  | 127.172 us                |
| OneStep                   | 550.232 ms                | 1.225 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.099 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.414 ms                 |
| Backward                  | 498.507 ms                | 978.155 ms                |
| Optimize                  | 1.731 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.426 ms                 | 313.696 ms                |
| BlockToStepN              | 9.740 us                  | 127.172 us                |
| OneStep                   | 559.387 ms                | 1.225 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.142 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.414 ms                 |
| Backward                  | 504.542 ms                | 988.901 ms                |
| Optimize                  | 1.730 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.448 ms                 | 398.041 ms                |
| BlockToStepN              | 9.778 us                  | 127.172 us                |
| OneStep                   | 562.687 ms                | 1.263 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.142 ms                  | 63.362 ms                 |
| Forward                   | 8.518 ms                  | 10.414 ms                 |
| Backward                  | 520.415 ms                | 1.002 s                   |
| Optimize                  | 1.730 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.459 ms                 | 398.041 ms                |
| BlockToStepN              | 9.811 us                  | 127.172 us                |
| OneStep                   | 573.666 ms                | 1.336 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.167 ms                  | 63.362 ms                 |
| Forward                   | 8.524 ms                  | 10.414 ms                 |
| Backward                  | 524.305 ms                | 1.030 s                   |
| Optimize                  | 1.730 ms                  | 2.635 ms                  |
| BarrierTimeBeforeRank0    | 14.555 ms                 | 398.041 ms                |
| BlockToStepN              | 9.950 us                  | 127.172 us                |
| OneStep                   | 577.499 ms                | 1.336 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.167 ms                  | 64.169 ms                 |
| Forward                   | 8.518 ms                  | 10.414 ms                 |
| Backward                  | 539.026 ms                | 1.037 s                   |
| Optimize                  | 1.738 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 15.164 ms                 | 398.041 ms                |
| BlockToStepN              | 10.041 us                 | 127.172 us                |
| OneStep                   | 587.356 ms                | 1.336 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.167 ms                  | 64.169 ms                 |
| Forward                   | 8.517 ms                  | 10.414 ms                 |
| Backward                  | 548.597 ms                | 1.072 s                   |
| Optimize                  | 1.738 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 15.164 ms                 | 398.041 ms                |
| BlockToStepN              | 10.058 us                 | 127.172 us                |
| OneStep                   | 597.561 ms                | 1.336 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.167 ms                  | 64.169 ms                 |
| Forward                   | 8.518 ms                  | 10.414 ms                 |
| Backward                  | 552.951 ms                | 1.133 s                   |
| Optimize                  | 1.739 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 15.164 ms                 | 398.041 ms                |
| BlockToStepN              | 10.100 us                 | 127.172 us                |
| OneStep                   | 603.611 ms                | 1.340 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.184 ms                  | 64.169 ms                 |
| Forward                   | 8.524 ms                  | 10.465 ms                 |
| Backward                  | 554.566 ms                | 1.250 s                   |
| Optimize                  | 1.739 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 15.599 ms                 | 398.041 ms                |
| BlockToStepN              | 10.105 us                 | 127.172 us                |
| OneStep                   | 605.716 ms                | 1.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.206 ms                  | 64.169 ms                 |
| Forward                   | 8.524 ms                  | 10.465 ms                 |
| Backward                  | 556.160 ms                | 1.250 s                   |
| Optimize                  | 1.741 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.150 ms                 | 398.041 ms                |
| BlockToStepN              | 10.105 us                 | 127.172 us                |
| OneStep                   | 606.500 ms                | 1.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.206 ms                  | 64.169 ms                 |
| Forward                   | 8.518 ms                  | 10.465 ms                 |
| Backward                  | 559.290 ms                | 1.250 s                   |
| Optimize                  | 1.741 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.150 ms                 | 398.041 ms                |
| BlockToStepN              | 10.134 us                 | 127.172 us                |
| OneStep                   | 618.454 ms                | 1.449 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 106.038, sample: 0.905, forward: 1.184, backward: 94.615, update: 0.169
[proc 3] 300 steps, total: 106.038, sample: 0.835, forward: 1.277, backward: 95.796, update: 0.186
[proc 4] 300 steps, total: 106.038, sample: 0.839, forward: 1.180, backward: 94.116, update: 0.179
[proc 2] 300 steps, total: 106.038, sample: 1.170, forward: 1.224, backward: 95.560, update: 0.162
[proc 0] 300 steps, total: 106.038, sample: 0.906, forward: 0.855, backward: 94.779, update: 0.170
[proc 5] 300 steps, total: 106.038, sample: 1.015, forward: 1.176, backward: 90.512, update: 0.189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.206 ms                  | 64.169 ms                 |
| Forward                   | 8.518 ms                  | 10.465 ms                 |
| Backward                  | 564.807 ms                | 1.308 s                   |
| Optimize                  | 1.744 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.150 ms                 | 398.041 ms                |
| BlockToStepN              | 10.136 us                 | 127.172 us                |
| OneStep                   | 622.770 ms                | 1.476 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.273 ms                  | 64.169 ms                 |
| Forward                   | 8.524 ms                  | 10.465 ms                 |
| Backward                  | 570.118 ms                | 1.328 s                   |
| Optimize                  | 1.752 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.150 ms                 | 398.041 ms                |
| BlockToStepN              | 10.226 us                 | 127.172 us                |
| OneStep                   | 645.125 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.302 ms                  | 64.169 ms                 |
| Forward                   | 8.524 ms                  | 10.465 ms                 |
| Backward                  | 578.982 ms                | 1.328 s                   |
| Optimize                  | 1.758 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.717 ms                 | 407.061 ms                |
| BlockToStepN              | 10.238 us                 | 127.172 us                |
| OneStep                   | 652.413 ms                | 1.493 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.302 ms                  | 64.169 ms                 |
| Forward                   | 8.524 ms                  | 10.465 ms                 |
| Backward                  | 582.957 ms                | 1.328 s                   |
| Optimize                  | 1.758 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.823 ms                 | 407.061 ms                |
| BlockToStepN              | 10.297 us                 | 127.172 us                |
| OneStep                   | 660.474 ms                | 1.493 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.324 ms                  | 64.169 ms                 |
| Forward                   | 8.531 ms                  | 10.465 ms                 |
| Backward                  | 601.718 ms                | 1.418 s                   |
| Optimize                  | 1.764 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.717 ms                 | 407.061 ms                |
| BlockToStepN              | 10.355 us                 | 127.172 us                |
| OneStep                   | 666.915 ms                | 1.524 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.328 ms                  | 64.169 ms                 |
| Forward                   | 8.531 ms                  | 10.658 ms                 |
| Backward                  | 608.166 ms                | 1.422 s                   |
| Optimize                  | 1.766 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.717 ms                 | 407.061 ms                |
| BlockToStepN              | 10.407 us                 | 1.575 ms                  |
| OneStep                   | 670.803 ms                | 1.560 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.324 ms                  | 64.169 ms                 |
| Forward                   | 8.531 ms                  | 10.658 ms                 |
| Backward                  | 620.604 ms                | 1.422 s                   |
| Optimize                  | 1.766 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 16.980 ms                 | 407.061 ms                |
| BlockToStepN              | 10.570 us                 | 1.575 ms                  |
| OneStep                   | 685.437 ms                | 1.560 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.328 ms                  | 64.169 ms                 |
| Forward                   | 8.531 ms                  | 10.658 ms                 |
| Backward                  | 633.254 ms                | 1.422 s                   |
| Optimize                  | 1.767 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 17.001 ms                 | 407.061 ms                |
| BlockToStepN              | 10.615 us                 | 1.575 ms                  |
| OneStep                   | 689.981 ms                | 1.586 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.339 ms                  | 64.169 ms                 |
| Forward                   | 8.534 ms                  | 10.658 ms                 |
| Backward                  | 636.792 ms                | 1.461 s                   |
| Optimize                  | 1.767 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.001 ms                 | 407.061 ms                |
| BlockToStepN              | 10.628 us                 | 1.575 ms                  |
| OneStep                   | 693.082 ms                | 1.593 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.339 ms                  | 64.169 ms                 |
| Forward                   | 8.534 ms                  | 10.658 ms                 |
| Backward                  | 638.692 ms                | 1.461 s                   |
| Optimize                  | 1.767 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.397 ms                 | 407.061 ms                |
| BlockToStepN              | 10.742 us                 | 1.575 ms                  |
| OneStep                   | 702.613 ms                | 1.630 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.339 ms                  | 64.169 ms                 |
| Forward                   | 8.534 ms                  | 10.658 ms                 |
| Backward                  | 643.102 ms                | 1.461 s                   |
| Optimize                  | 1.766 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.501 ms                 | 407.061 ms                |
| BlockToStepN              | 10.742 us                 | 1.575 ms                  |
| OneStep                   | 707.117 ms                | 1.630 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.340 ms                  | 64.169 ms                 |
| Forward                   | 8.536 ms                  | 10.658 ms                 |
| Backward                  | 648.503 ms                | 1.461 s                   |
| Optimize                  | 1.765 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.397 ms                 | 407.061 ms                |
| BlockToStepN              | 10.786 us                 | 1.575 ms                  |
| OneStep                   | 709.283 ms                | 1.632 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.373 ms                  | 64.169 ms                 |
| Forward                   | 8.536 ms                  | 10.658 ms                 |
| Backward                  | 650.334 ms                | 1.536 s                   |
| Optimize                  | 1.766 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.050 ms                 | 407.061 ms                |
| BlockToStepN              | 10.848 us                 | 1.575 ms                  |
| OneStep                   | 710.789 ms                | 1.635 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.373 ms                  | 64.169 ms                 |
| Forward                   | 8.536 ms                  | 10.658 ms                 |
| Backward                  | 656.663 ms                | 1.536 s                   |
| Optimize                  | 1.768 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.501 ms                 | 407.061 ms                |
| BlockToStepN              | 10.888 us                 | 1.575 ms                  |
| OneStep                   | 722.517 ms                | 1.669 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.380 ms                  | 63.362 ms                 |
| Forward                   | 8.536 ms                  | 10.465 ms                 |
| Backward                  | 657.261 ms                | 1.461 s                   |
| Optimize                  | 1.768 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 17.621 ms                 | 413.680 ms                |
| BlockToStepN              | 10.888 us                 | 149.736 us                |
| OneStep                   | 727.168 ms                | 1.692 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.373 ms                  | 63.362 ms                 |
| Forward                   | 8.536 ms                  | 10.465 ms                 |
| Backward                  | 665.935 ms                | 1.461 s                   |
| Optimize                  | 1.768 ms                  | 2.708 ms                  |
| BarrierTimeBeforeRank0    | 17.669 ms                 | 413.680 ms                |
| BlockToStepN              | 10.946 us                 | 149.736 us                |
| OneStep                   | 733.763 ms                | 1.701 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.380 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.658 ms                 |
| Backward                  | 673.572 ms                | 1.536 s                   |
| Optimize                  | 1.769 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 17.669 ms                 | 413.680 ms                |
| BlockToStepN              | 11.047 us                 | 149.736 us                |
| OneStep                   | 735.252 ms                | 1.709 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.394 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.658 ms                 |
| Backward                  | 684.167 ms                | 1.536 s                   |
| Optimize                  | 1.769 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.542 ms                 | 414.532 ms                |
| BlockToStepN              | 11.130 us                 | 149.736 us                |
| OneStep                   | 743.532 ms                | 1.717 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.380 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.658 ms                 |
| Backward                  | 697.825 ms                | 1.536 s                   |
| Optimize                  | 1.769 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.767 ms                 | 418.030 ms                |
| BlockToStepN              | 11.213 us                 | 149.736 us                |
| OneStep                   | 759.124 ms                | 1.724 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.394 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.823 ms                 |
| Backward                  | 705.068 ms                | 1.546 s                   |
| Optimize                  | 1.768 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.767 ms                 | 418.030 ms                |
| BlockToStepN              | 11.239 us                 | 149.736 us                |
| OneStep                   | 759.556 ms                | 1.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.394 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.823 ms                 |
| Backward                  | 706.158 ms                | 1.546 s                   |
| Optimize                  | 1.769 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.542 ms                 | 418.030 ms                |
| BlockToStepN              | 11.297 us                 | 149.736 us                |
| OneStep                   | 769.134 ms                | 1.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.397 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.823 ms                 |
| Backward                  | 714.149 ms                | 1.546 s                   |
| Optimize                  | 1.771 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.767 ms                 | 418.030 ms                |
| BlockToStepN              | 11.366 us                 | 149.736 us                |
| OneStep                   | 771.937 ms                | 1.769 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.438 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.823 ms                 |
| Backward                  | 719.870 ms                | 1.546 s                   |
| Optimize                  | 1.771 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.767 ms                 | 424.549 ms                |
| BlockToStepN              | 11.438 us                 | 1.575 ms                  |
| OneStep                   | 780.765 ms                | 1.773 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.438 ms                  | 63.362 ms                 |
| Forward                   | 8.537 ms                  | 10.823 ms                 |
| Backward                  | 726.388 ms                | 1.546 s                   |
| Optimize                  | 1.771 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.817 ms                 | 424.549 ms                |
| BlockToStepN              | 11.465 us                 | 1.575 ms                  |
| OneStep                   | 785.664 ms                | 1.779 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.438 ms                  | 63.362 ms                 |
| Forward                   | 8.540 ms                  | 10.823 ms                 |
| Backward                  | 739.713 ms                | 1.613 s                   |
| Optimize                  | 1.773 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.817 ms                 | 428.516 ms                |
| BlockToStepN              | 11.567 us                 | 1.575 ms                  |
| OneStep                   | 789.327 ms                | 1.825 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.443 ms                  | 63.362 ms                 |
| Forward                   | 8.544 ms                  | 10.823 ms                 |
| Backward                  | 741.533 ms                | 1.613 s                   |
| Optimize                  | 1.773 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 18.877 ms                 | 428.516 ms                |
| BlockToStepN              | 11.536 us                 | 1.575 ms                  |
| OneStep                   | 794.656 ms                | 1.825 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.438 ms                  | 63.362 ms                 |
| Forward                   | 8.545 ms                  | 10.823 ms                 |
| Backward                  | 746.772 ms                | 1.613 s                   |
| Optimize                  | 1.773 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 19.401 ms                 | 428.516 ms                |
| BlockToStepN              | 11.567 us                 | 1.575 ms                  |
| OneStep                   | 798.290 ms                | 1.857 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.466 ms                  | 63.362 ms                 |
| Forward                   | 8.546 ms                  | 10.823 ms                 |
| Backward                  | 747.859 ms                | 1.711 s                   |
| Optimize                  | 1.774 ms                  | 2.717 ms                  |
| BarrierTimeBeforeRank0    | 19.343 ms                 | 428.516 ms                |
| BlockToStepN              | 11.605 us                 | 1.575 ms                  |
| OneStep                   | 801.355 ms                | 1.904 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.466 ms                  | 63.362 ms                 |
| Forward                   | 8.546 ms                  | 10.823 ms                 |
| Backward                  | 759.084 ms                | 1.711 s                   |
| Optimize                  | 1.774 ms                  | 2.870 ms                  |
| BarrierTimeBeforeRank0    | 19.401 ms                 | 442.304 ms                |
| BlockToStepN              | 11.648 us                 | 1.575 ms                  |
| OneStep                   | 812.776 ms                | 1.914 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.475 ms                  | 63.362 ms                 |
| Forward                   | 8.550 ms                  | 10.823 ms                 |
| Backward                  | 763.572 ms                | 1.711 s                   |
| Optimize                  | 1.774 ms                  | 2.870 ms                  |
| BarrierTimeBeforeRank0    | 19.409 ms                 | 495.060 ms                |
| BlockToStepN              | 11.648 us                 | 2.953 ms                  |
| OneStep                   | 815.995 ms                | 1.917 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 152.330, sample: 1.000, forward: 1.182, backward: 128.810, update: 0.216
[proc 1] 400 steps, total: 152.330, sample: 0.949, forward: 1.216, backward: 134.173, update: 0.176
[proc 0] 400 steps, total: 152.330, sample: 0.926, forward: 0.900, backward: 134.829, update: 0.181
[proc 4] 400 steps, total: 152.330, sample: 0.865, forward: 1.158, backward: 132.285, update: 0.185
[proc 2] 400 steps, total: 152.330, sample: 1.116, forward: 1.187, backward: 135.511, update: 0.177
[proc 3] 400 steps, total: 152.330, sample: 0.857, forward: 1.244, backward: 132.540, update: 0.179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.466 ms                  | 63.362 ms                 |
| Forward                   | 8.550 ms                  | 10.823 ms                 |
| Backward                  | 767.064 ms                | 1.711 s                   |
| Optimize                  | 1.774 ms                  | 2.870 ms                  |
| BarrierTimeBeforeRank0    | 19.409 ms                 | 495.060 ms                |
| BlockToStepN              | 11.648 us                 | 2.953 ms                  |
| OneStep                   | 816.795 ms                | 1.917 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.475 ms                  | 63.362 ms                 |
| Forward                   | 8.554 ms                  | 10.823 ms                 |
| Backward                  | 768.067 ms                | 1.757 s                   |
| Optimize                  | 1.777 ms                  | 2.870 ms                  |
| BarrierTimeBeforeRank0    | 19.409 ms                 | 495.060 ms                |
| BlockToStepN              | 11.648 us                 | 2.953 ms                  |
| OneStep                   | 824.780 ms                | 1.927 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.492 ms                  | 63.362 ms                 |
| Forward                   | 8.557 ms                  | 10.823 ms                 |
| Backward                  | 771.729 ms                | 1.757 s                   |
| Optimize                  | 1.777 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 19.433 ms                 | 495.060 ms                |
| BlockToStepN              | 11.695 us                 | 2.953 ms                  |
| OneStep                   | 835.193 ms                | 1.927 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.492 ms                  | 63.362 ms                 |
| Forward                   | 8.554 ms                  | 10.823 ms                 |
| Backward                  | 774.066 ms                | 1.757 s                   |
| Optimize                  | 1.777 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 19.574 ms                 | 496.615 ms                |
| BlockToStepN              | 11.695 us                 | 2.953 ms                  |
| OneStep                   | 837.535 ms                | 1.932 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.517 ms                  | 63.362 ms                 |
| Forward                   | 8.564 ms                  | 10.823 ms                 |
| Backward                  | 779.560 ms                | 1.757 s                   |
| Optimize                  | 1.780 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.156 ms                 | 528.836 ms                |
| BlockToStepN              | 11.695 us                 | 2.953 ms                  |
| OneStep                   | 839.702 ms                | 1.954 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.517 ms                  | 63.362 ms                 |
| Forward                   | 8.568 ms                  | 10.823 ms                 |
| Backward                  | 779.890 ms                | 1.846 s                   |
| Optimize                  | 1.780 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 19.574 ms                 | 528.836 ms                |
| BlockToStepN              | 11.698 us                 | 2.953 ms                  |
| OneStep                   | 843.404 ms                | 2.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.517 ms                  | 63.362 ms                 |
| Forward                   | 8.569 ms                  | 10.823 ms                 |
| Backward                  | 791.879 ms                | 1.846 s                   |
| Optimize                  | 1.781 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.156 ms                 | 528.836 ms                |
| BlockToStepN              | 11.776 us                 | 2.953 ms                  |
| OneStep                   | 849.057 ms                | 2.050 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.544 ms                  | 63.362 ms                 |
| Forward                   | 8.574 ms                  | 10.823 ms                 |
| Backward                  | 793.464 ms                | 1.846 s                   |
| Optimize                  | 1.784 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.551 ms                 | 528.836 ms                |
| BlockToStepN              | 11.784 us                 | 2.953 ms                  |
| OneStep                   | 855.229 ms                | 2.050 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.544 ms                  | 63.362 ms                 |
| Forward                   | 8.575 ms                  | 10.823 ms                 |
| Backward                  | 800.633 ms                | 1.846 s                   |
| Optimize                  | 1.784 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.956 ms                 | 623.072 ms                |
| BlockToStepN              | 11.784 us                 | 2.953 ms                  |
| OneStep                   | 855.331 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.552 ms                  | 63.362 ms                 |
| Forward                   | 8.575 ms                  | 10.823 ms                 |
| Backward                  | 802.770 ms                | 1.928 s                   |
| Optimize                  | 1.784 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.956 ms                 | 623.072 ms                |
| BlockToStepN              | 11.869 us                 | 2.953 ms                  |
| OneStep                   | 856.227 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.572 ms                  | 63.362 ms                 |
| Forward                   | 8.579 ms                  | 10.823 ms                 |
| Backward                  | 809.502 ms                | 1.928 s                   |
| Optimize                  | 1.786 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 20.956 ms                 | 623.072 ms                |
| BlockToStepN              | 11.963 us                 | 2.953 ms                  |
| OneStep                   | 869.558 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.572 ms                  | 63.362 ms                 |
| Forward                   | 8.581 ms                  | 10.823 ms                 |
| Backward                  | 810.652 ms                | 1.928 s                   |
| Optimize                  | 1.786 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.210 ms                 | 623.072 ms                |
| BlockToStepN              | 12.003 us                 | 2.953 ms                  |
| OneStep                   | 880.464 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.552 ms                  | 63.362 ms                 |
| Forward                   | 8.581 ms                  | 10.823 ms                 |
| Backward                  | 815.650 ms                | 1.928 s                   |
| Optimize                  | 1.786 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.323 ms                 | 623.072 ms                |
| BlockToStepN              | 12.062 us                 | 2.953 ms                  |
| OneStep                   | 894.598 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.572 ms                  | 63.362 ms                 |
| Forward                   | 8.582 ms                  | 10.823 ms                 |
| Backward                  | 821.671 ms                | 1.994 s                   |
| Optimize                  | 1.787 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.406 ms                 | 623.072 ms                |
| BlockToStepN              | 12.070 us                 | 2.953 ms                  |
| OneStep                   | 897.481 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.580 ms                  | 64.169 ms                 |
| Forward                   | 8.582 ms                  | 10.823 ms                 |
| Backward                  | 822.130 ms                | 1.994 s                   |
| Optimize                  | 1.787 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.507 ms                 | 623.072 ms                |
| BlockToStepN              | 12.092 us                 | 5.906 ms                  |
| OneStep                   | 900.056 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.580 ms                  | 64.169 ms                 |
| Forward                   | 8.582 ms                  | 10.823 ms                 |
| Backward                  | 825.808 ms                | 1.994 s                   |
| Optimize                  | 1.790 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.576 ms                 | 623.072 ms                |
| BlockToStepN              | 12.201 us                 | 5.906 ms                  |
| OneStep                   | 901.026 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.580 ms                  | 64.169 ms                 |
| Forward                   | 8.582 ms                  | 10.823 ms                 |
| Backward                  | 827.216 ms                | 2.001 s                   |
| Optimize                  | 1.792 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.576 ms                 | 623.072 ms                |
| BlockToStepN              | 12.258 us                 | 5.906 ms                  |
| OneStep                   | 902.763 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 64.169 ms                 |
| Forward                   | 8.583 ms                  | 10.823 ms                 |
| Backward                  | 830.938 ms                | 2.001 s                   |
| Optimize                  | 1.792 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.576 ms                 | 623.072 ms                |
| BlockToStepN              | 12.350 us                 | 5.906 ms                  |
| OneStep                   | 904.371 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 64.169 ms                 |
| Forward                   | 8.583 ms                  | 10.823 ms                 |
| Backward                  | 831.408 ms                | 2.001 s                   |
| Optimize                  | 1.795 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.822 ms                 | 623.072 ms                |
| BlockToStepN              | 12.372 us                 | 5.906 ms                  |
| OneStep                   | 907.088 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 63.362 ms                 |
| Forward                   | 8.583 ms                  | 10.782 ms                 |
| Backward                  | 837.127 ms                | 2.001 s                   |
| Optimize                  | 1.795 ms                  | 3.084 ms                  |
| BarrierTimeBeforeRank0    | 21.861 ms                 | 870.948 ms                |
| BlockToStepN              | 12.465 us                 | 5.906 ms                  |
| OneStep                   | 909.112 ms                | 2.364 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.622 ms                  | 63.362 ms                 |
| Forward                   | 8.586 ms                  | 10.782 ms                 |
| Backward                  | 847.711 ms                | 2.001 s                   |
| Optimize                  | 1.795 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 21.861 ms                 | 623.072 ms                |
| BlockToStepN              | 12.496 us                 | 2.953 ms                  |
| OneStep                   | 929.659 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.628 ms                  | 63.362 ms                 |
| Forward                   | 8.597 ms                  | 10.782 ms                 |
| Backward                  | 849.803 ms                | 2.006 s                   |
| Optimize                  | 1.797 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 21.861 ms                 | 623.072 ms                |
| BlockToStepN              | 12.521 us                 | 2.953 ms                  |
| OneStep                   | 932.901 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.629 ms                  | 63.362 ms                 |
| Forward                   | 8.599 ms                  | 10.782 ms                 |
| Backward                  | 863.388 ms                | 2.006 s                   |
| Optimize                  | 1.797 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.277 ms                 | 623.072 ms                |
| BlockToStepN              | 12.630 us                 | 2.953 ms                  |
| OneStep                   | 934.318 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.629 ms                  | 63.362 ms                 |
| Forward                   | 8.599 ms                  | 10.782 ms                 |
| Backward                  | 875.252 ms                | 2.006 s                   |
| Optimize                  | 1.797 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.431 ms                 | 623.072 ms                |
| BlockToStepN              | 12.692 us                 | 2.953 ms                  |
| OneStep                   | 941.281 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.629 ms                  | 63.362 ms                 |
| Forward                   | 8.599 ms                  | 10.782 ms                 |
| Backward                  | 879.251 ms                | 2.053 s                   |
| Optimize                  | 1.798 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.527 ms                 | 623.072 ms                |
| BlockToStepN              | 12.795 us                 | 2.953 ms                  |
| OneStep                   | 949.283 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.629 ms                  | 63.362 ms                 |
| Forward                   | 8.600 ms                  | 10.782 ms                 |
| Backward                  | 881.441 ms                | 2.146 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.527 ms                 | 623.072 ms                |
| BlockToStepN              | 12.795 us                 | 2.953 ms                  |
| OneStep                   | 950.435 ms                | 2.334 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.629 ms                  | 63.362 ms                 |
| Forward                   | 8.607 ms                  | 10.782 ms                 |
| Backward                  | 882.879 ms                | 2.146 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.527 ms                 | 870.948 ms                |
| BlockToStepN              | 12.795 us                 | 2.953 ms                  |
| OneStep                   | 958.642 ms                | 2.364 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.646 ms                  | 63.957 ms                 |
| Forward                   | 8.611 ms                  | 10.782 ms                 |
| Backward                  | 883.219 ms                | 2.146 s                   |
| Optimize                  | 1.798 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.527 ms                 | 870.948 ms                |
| BlockToStepN              | 12.991 us                 | 2.953 ms                  |
| OneStep                   | 961.187 ms                | 2.364 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.672 ms                  | 63.957 ms                 |
| Forward                   | 8.614 ms                  | 10.782 ms                 |
| Backward                  | 888.763 ms                | 2.155 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.890 ms                 | 870.948 ms                |
| BlockToStepN              | 13.084 us                 | 2.953 ms                  |
| OneStep                   | 964.042 ms                | 2.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.672 ms                  | 63.957 ms                 |
| Forward                   | 8.614 ms                  | 10.782 ms                 |
| Backward                  | 889.131 ms                | 2.155 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.351 ms                 | 870.948 ms                |
| BlockToStepN              | 13.188 us                 | 2.953 ms                  |
| OneStep                   | 971.822 ms                | 2.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.672 ms                  | 63.957 ms                 |
| Forward                   | 8.616 ms                  | 10.782 ms                 |
| Backward                  | 889.544 ms                | 2.155 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.351 ms                 | 870.948 ms                |
| BlockToStepN              | 13.084 us                 | 2.953 ms                  |
| OneStep                   | 977.194 ms                | 2.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.682 ms                  | 63.957 ms                 |
| Forward                   | 8.616 ms                  | 10.782 ms                 |
| Backward                  | 892.035 ms                | 2.155 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.245 ms                 | 1.044 s                   |
| BlockToStepN              | 13.084 us                 | 2.953 ms                  |
| OneStep                   | 977.564 ms                | 2.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.682 ms                  | 63.957 ms                 |
| Forward                   | 8.617 ms                  | 10.782 ms                 |
| Backward                  | 898.796 ms                | 2.175 s                   |
| Optimize                  | 1.799 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 22.890 ms                 | 1.044 s                   |
| BlockToStepN              | 13.084 us                 | 2.953 ms                  |
| OneStep                   | 978.241 ms                | 2.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.699 ms                  | 63.957 ms                 |
| Forward                   | 8.617 ms                  | 10.782 ms                 |
| Backward                  | 910.744 ms                | 2.196 s                   |
| Optimize                  | 1.800 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.245 ms                 | 1.044 s                   |
| BlockToStepN              | 13.084 us                 | 2.953 ms                  |
| OneStep                   | 981.711 ms                | 2.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.699 ms                  | 63.957 ms                 |
| Forward                   | 8.619 ms                  | 10.782 ms                 |
| Backward                  | 910.744 ms                | 2.196 s                   |
| Optimize                  | 1.800 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.351 ms                 | 1.045 s                   |
| BlockToStepN              | 13.188 us                 | 2.953 ms                  |
| OneStep                   | 992.389 ms                | 2.642 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.732 ms                  | 63.957 ms                 |
| Forward                   | 8.622 ms                  | 10.782 ms                 |
| Backward                  | 914.182 ms                | 2.196 s                   |
| Optimize                  | 1.800 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.351 ms                 | 1.045 s                   |
| BlockToStepN              | 13.263 us                 | 2.953 ms                  |
| OneStep                   | 993.057 ms                | 2.642 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.732 ms                  | 63.957 ms                 |
| Forward                   | 8.623 ms                  | 10.782 ms                 |
| Backward                  | 914.285 ms                | 2.196 s                   |
| Optimize                  | 1.800 ms                  | 2.997 ms                  |
| BarrierTimeBeforeRank0    | 23.364 ms                 | 1.076 s                   |
| BlockToStepN              | 13.279 us                 | 2.953 ms                  |
| OneStep                   | 993.261 ms                | 2.724 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.699 ms                  | 63.957 ms                 |
| Forward                   | 8.628 ms                  | 10.782 ms                 |
| Backward                  | 918.408 ms                | 2.200 s                   |
| Optimize                  | 1.801 ms                  | 3.018 ms                  |
| BarrierTimeBeforeRank0    | 23.364 ms                 | 1.076 s                   |
| BlockToStepN              | 13.441 us                 | 2.953 ms                  |
| OneStep                   | 997.036 ms                | 2.724 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.699 ms                  | 63.957 ms                 |
| Forward                   | 8.628 ms                  | 10.782 ms                 |
| Backward                  | 919.225 ms                | 2.200 s                   |
| Optimize                  | 1.801 ms                  | 3.018 ms                  |
| BarrierTimeBeforeRank0    | 23.694 ms                 | 1.076 s                   |
| BlockToStepN              | 13.538 us                 | 4.357 ms                  |
| OneStep                   | 1.005 s                   | 2.724 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.699 ms                  | 63.957 ms                 |
| Forward                   | 8.628 ms                  | 10.782 ms                 |
| Backward                  | 921.178 ms                | 2.200 s                   |
| Optimize                  | 1.801 ms                  | 3.018 ms                  |
| BarrierTimeBeforeRank0    | 23.839 ms                 | 1.076 s                   |
| BlockToStepN              | 13.583 us                 | 4.357 ms                  |
| OneStep                   | 1.006 s                   | 2.724 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.732 ms                  | 63.957 ms                 |
| Forward                   | 8.629 ms                  | 10.782 ms                 |
| Backward                  | 921.868 ms                | 2.200 s                   |
| Optimize                  | 1.802 ms                  | 3.018 ms                  |
| BarrierTimeBeforeRank0    | 23.924 ms                 | 1.076 s                   |
| BlockToStepN              | 13.586 us                 | 4.357 ms                  |
| OneStep                   | 1.012 s                   | 2.724 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 5] 500 steps, total: 203.917, sample: 1.025, forward: 1.124, backward: 166.705, update: 0.194
[proc 4] 500 steps, total: 203.917, sample: 0.915, forward: 1.173, backward: 173.371, update: 0.192
[proc 2] 500 steps, total: 203.917, sample: 1.039, forward: 1.215, backward: 176.145, update: 0.208
[proc 1] 500 steps, total: 203.917, sample: 1.070, forward: 1.175, backward: 175.685, update: 0.184
[proc 3] 500 steps, total: 203.917, sample: 0.911, forward: 1.232, backward: 172.945, update: 0.189
[proc 0] 500 steps, total: 203.917, sample: 0.940, forward: 0.903, backward: 174.531, update: 0.191
Successfully xmh. training takes 551.2647569179535 seconds
before call kg_cache_controller.StopThreads()
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
INFO [14399 controller_process.py:380] call rank0 to StopThreads
