WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:49:57.916539 43727 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_73', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [43727 sampler.py:454] Start PreSampling
WARNING [43727 sampler.py:532] Before construct renumbering_dict
WARNING [43727 sampler.py:555] PreSampling done
W20240123 02:50:01.237890 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:50:01.238088 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:50:01.238144 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:50:01.238180 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:50:01.238221 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:50:01.238260 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:50:01.238291 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:50:01.238338 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:50:01.238371 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:50:01.238420 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:50:01.238467 43727 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:50:01.238498 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:50:01.238530 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:50:01.238664 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:50:01.238701 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:50:01.238734 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:50:01.238767 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:50:01.238798 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:50:01.238853 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:50:01.238889 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:50:01.238921 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:50:01.238952 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:50:01.238992 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:50:01.239024 43727 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:50:01.239050 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:50:01.239081 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:50:01.239145 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:50:01.239183 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:50:01.239216 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:50:01.239259 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:50:01.239300 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:50:01.239338 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:50:01.239378 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:50:01.239414 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:50:01.239447 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:50:01.239482 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:50:01.239514 43727 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:50:01.239540 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:50:01.239567 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:50:01.239629 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:50:01.239665 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:50:01.239697 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:50:01.239737 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:50:01.239771 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:50:01.239810 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:50:01.239850 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:50:01.239888 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:50:01.239929 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:50:01.239961 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:50:01.239991 43727 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:50:01.240018 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:50:01.240044 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:50:01.240113 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240123 02:50:01.240162 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240123 02:50:01.240195 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240123 02:50:01.240226 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240123 02:50:01.240263 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240123 02:50:01.240309 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240123 02:50:01.240355 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240123 02:50:01.240386 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240123 02:50:01.240427 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240123 02:50:01.240464 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240123 02:50:01.240501 43727 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240123 02:50:01.240528 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240123 02:50:01.240556 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240123 02:50:01.240623 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240123 02:50:01.240657 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240123 02:50:01.240694 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240123 02:50:01.240736 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240123 02:50:01.240780 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240123 02:50:01.240823 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240123 02:50:01.240864 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240123 02:50:01.240897 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240123 02:50:01.240932 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240123 02:50:01.240978 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240123 02:50:01.241019 43727 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240123 02:50:01.241046 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240123 02:50:01.241080 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240123 02:50:01.241151 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000
W20240123 02:50:01.241201 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000
W20240123 02:50:01.241243 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000
W20240123 02:50:01.241277 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000
W20240123 02:50:01.241317 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000
W20240123 02:50:01.241359 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000
W20240123 02:50:01.241392 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000
W20240123 02:50:01.241425 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000
W20240123 02:50:01.241458 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000
W20240123 02:50:01.241501 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000
W20240123 02:50:01.241533 43727 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100003604000
W20240123 02:50:01.241559 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000
W20240123 02:50:01.241585 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000
W20240123 02:50:01.241654 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000
W20240123 02:50:01.241691 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000
W20240123 02:50:01.241724 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000
W20240123 02:50:01.241763 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000
W20240123 02:50:01.241796 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000
W20240123 02:50:01.241837 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000
W20240123 02:50:01.241876 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000
W20240123 02:50:01.241925 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000
W20240123 02:50:01.241967 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000
W20240123 02:50:01.242005 43727 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000
W20240123 02:50:01.242043 43727 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x100003dbc000
W20240123 02:50:01.242070 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000
W20240123 02:50:01.242097 43727 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000
W20240123 02:50:01.448347 43727 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100003dc2000
W20240123 02:50:01.448509 43727 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100005494000
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  758,  1257,  1975,  ..., 10145,  7974,  7063]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.567 seconds
[Rank1] pid = 44017
[Rank2] pid = 44062
[Rank3] pid = 44145
[Rank4] pid = 44210
[Rank5] pid = 44274
[Rank6] pid = 44312
INFO [43727 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [44017 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [44062 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [44145 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [44312 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [44210 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [44274 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [44403 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [44274 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44312 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44403 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44017 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44062 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44145 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44210 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44274 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44312 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44062 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44210 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44017 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44403 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44145 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [44210 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44062 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44274 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44312 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44017 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [44210 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44062 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [44403 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44145 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [44274 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44312 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44017 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44403 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44145 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [43727 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43727 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [43727 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [43727 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:50:05.173851 44405 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174034 44018 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174161 44082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174270 44275 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174417 44146 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174571 44410 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174677 44339 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.174810 44211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240123 02:50:05.976231 44405 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240123 02:50:05.977527 44018 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.978603 44146 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.978674 44275 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.978952 44082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.979010 44339 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.980114 44211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240123 02:50:05.981191 44410 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 882.577 us                | 10.897 ms                 |
| Forward                   | 6.046 ms                  | 631.302 ms                |
| Backward                  | 65.279 ms                 | 172.373 ms                |
| Optimize                  | 1.649 ms                  | 4.122 ms                  |
| BarrierTimeBeforeRank0    | 2.832 ms                  | 45.188 ms                 |
| BlockToStepN              | 13.388 us                 | 71.155 us                 |
| OneStep                   | 77.858 ms                 | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 932.317 us                | 11.016 ms                 |
| Forward                   | 6.074 ms                  | 9.427 ms                  |
| Backward                  | 93.816 ms                 | 183.984 ms                |
| Optimize                  | 1.645 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 3.282 ms                  | 50.634 ms                 |
| BlockToStepN              | 14.216 us                 | 79.497 us                 |
| OneStep                   | 119.002 ms                | 236.552 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 932.317 us                | 11.095 ms                 |
| Forward                   | 6.074 ms                  | 14.298 ms                 |
| Backward                  | 127.662 ms                | 228.171 ms                |
| Optimize                  | 1.663 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 4.891 ms                  | 74.828 ms                 |
| BlockToStepN              | 14.475 us                 | 107.919 us                |
| OneStep                   | 145.119 ms                | 334.328 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 16.887, sample: 0.196, forward: 1.074, backward: 12.494, update: 0.150
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 16.887, sample: 0.221, forward: 1.130, backward: 14.163, update: 0.153
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.889, sample: 0.215, forward: 1.220, backward: 12.874, update: 0.164
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 16.887, sample: 0.202, forward: 1.050, backward: 12.353, update: 0.177
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 16.886, sample: 0.221, forward: 1.211, backward: 14.316, update: 0.149
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 16.888, sample: 0.222, forward: 1.199, backward: 14.510, update: 0.155
[Rank7] pid = 44403
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 2161,    77,  2870,  2833, 10481, 13422,  1098,   458, 11626, 12539]) tensor([ 1975,  8348,  6508, 12335, 10191,  1097,   582,  4959,   516, 11155])
-------Step 1-------
tensor([ 2161,    77,  2870,  2833, 10481, 13422,  1098,   458, 11626, 12539]) tensor([ 4260, 11432, 14819,  1390,  1022,  8845, 14721, 11090,  5990, 12331])
-------Step 2-------
tensor([ 7034, 11634,  5383,  3442, 11448,  7498, 11059,    33, 10987,   881]) tensor([ 4655,  4341,  3580,  7752,  5005,  8553, 12171,  8445, 14371,  9886])
-------Step 3-------
tensor([ 7034, 11634,  5383,  3442, 11448,  7498, 11059,    33, 10987,   881]) tensor([ 9600,  5747,  7334, 11274,  7094,   683,  4660,  1943, 12835,  2188])
-------Step 4-------
tensor([   77, 14822,  9286,  4696,  7680,  3024,    68,  7479,  6406,  1023]) tensor([ 609, 1191, 3795, 2821, 2736, 2759,  458, 5839, 5698, 1889])
-------Step 5-------
tensor([   77, 14822,  9286,  4696,  7680,  3024,    68,  7479,  6406,  1023]) tensor([9857, 4986, 6078, 1923, 2914,  815,  834, 1305, 5208, 5754])
-------Step 6-------
tensor([ 1516,  9309,     2,    14, 11002,  3166,  8300, 12421, 13965, 11675]) tensor([11634,  2728,  8680,  3706,  9193,  9903,  4258,  7614,  8844, 13113])
-------Step 7-------
tensor([ 1516,  9309,     2,    14, 11002,  3166,  8300, 12421, 13965, 11675]) tensor([13307, 11560,  3986,  5678,  1385,  8691,  7266,  4693,   155, 11235])
-------Step 8-------
tensor([ 3278,  6353,  5150, 12905,    48,    56,  8483, 11023,    23,  1830]) tensor([ 6661,  6227,  4056,  8037,  2951, 12395, 10114,  1420, 12912,  2882])
-------Step 9-------
tensor([ 3278,  6353,  5150, 12905,    48,    56,  8483, 11023,    23,  1830]) tensor([10611,  3398, 13651,  9295, 14535, 12157, 14064, 11090,   660, 13430])
before start barrier
start train
[proc 0] 100 steps, total: 16.890, sample: 0.231, forward: 1.227, backward: 13.858, update: 0.166
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 16.885, sample: 0.222, forward: 1.209, backward: 13.855, update: 0.156
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.006 ms                  | 11.095 ms                 |
| Forward                   | 6.085 ms                  | 14.298 ms                 |
| Backward                  | 147.771 ms                | 292.990 ms                |
| Optimize                  | 1.690 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 5.866 ms                  | 90.102 ms                 |
| BlockToStepN              | 15.163 us                 | 107.919 us                |
| OneStep                   | 170.821 ms                | 364.471 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 932.317 us                | 11.340 ms                 |
| Forward                   | 6.084 ms                  | 14.298 ms                 |
| Backward                  | 165.723 ms                | 340.661 ms                |
| Optimize                  | 1.697 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 6.492 ms                  | 90.102 ms                 |
| BlockToStepN              | 15.481 us                 | 107.919 us                |
| OneStep                   | 193.393 ms                | 392.488 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 948.756 us                | 13.494 ms                 |
| Forward                   | 6.085 ms                  | 14.298 ms                 |
| Backward                  | 181.816 ms                | 365.313 ms                |
| Optimize                  | 1.707 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 7.769 ms                  | 133.534 ms                |
| BlockToStepN              | 15.362 us                 | 127.556 us                |
| OneStep                   | 210.737 ms                | 692.763 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 977.127 us                | 13.861 ms                 |
| Forward                   | 6.098 ms                  | 14.298 ms                 |
| Backward                  | 191.184 ms                | 410.521 ms                |
| Optimize                  | 1.710 ms                  | 3.246 ms                  |
| BarrierTimeBeforeRank0    | 8.741 ms                  | 133.534 ms                |
| BlockToStepN              | 15.960 us                 | 178.185 us                |
| OneStep                   | 216.724 ms                | 692.763 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 977.127 us                | 13.494 ms                 |
| Forward                   | 6.082 ms                  | 9.427 ms                  |
| Backward                  | 207.855 ms                | 421.239 ms                |
| Optimize                  | 1.710 ms                  | 2.959 ms                  |
| BarrierTimeBeforeRank0    | 9.428 ms                  | 133.534 ms                |
| BlockToStepN              | 17.097 us                 | 143.225 us                |
| OneStep                   | 236.552 ms                | 548.660 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.008 ms                  | 13.494 ms                 |
| Forward                   | 6.085 ms                  | 9.427 ms                  |
| Backward                  | 220.354 ms                | 457.511 ms                |
| Optimize                  | 1.711 ms                  | 2.959 ms                  |
| BarrierTimeBeforeRank0    | 9.601 ms                  | 134.588 ms                |
| BlockToStepN              | 16.305 us                 | 178.185 us                |
| OneStep                   | 256.127 ms                | 554.332 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.008 ms                  | 13.494 ms                 |
| Forward                   | 6.107 ms                  | 13.522 ms                 |
| Backward                  | 228.171 ms                | 540.025 ms                |
| Optimize                  | 1.711 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 9.700 ms                  | 156.840 ms                |
| BlockToStepN              | 16.452 us                 | 178.185 us                |
| OneStep                   | 280.455 ms                | 634.574 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.006 ms                  | 13.494 ms                 |
| Forward                   | 6.098 ms                  | 13.522 ms                 |
| Backward                  | 246.163 ms                | 540.025 ms                |
| Optimize                  | 1.709 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 9.700 ms                  | 156.840 ms                |
| BlockToStepN              | 16.452 us                 | 178.185 us                |
| OneStep                   | 291.313 ms                | 634.574 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.008 ms                  | 13.494 ms                 |
| Forward                   | 6.115 ms                  | 13.522 ms                 |
| Backward                  | 257.993 ms                | 545.409 ms                |
| Optimize                  | 1.711 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 10.250 ms                 | 156.840 ms                |
| BlockToStepN              | 17.097 us                 | 178.185 us                |
| OneStep                   | 298.797 ms                | 685.552 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 44.647, sample: 0.230, forward: 0.587, backward: 35.188, update: 0.151
[proc 0] 200 steps, total: 44.647, sample: 0.268, forward: 0.615, backward: 39.397, update: 0.171
[proc 7] 200 steps, total: 44.647, sample: 0.232, forward: 0.569, backward: 39.490, update: 0.156
[proc 5] 200 steps, total: 44.647, sample: 0.235, forward: 0.562, backward: 39.427, update: 0.150
[proc 2] 200 steps, total: 44.647, sample: 0.231, forward: 0.548, backward: 34.184, update: 0.180
[proc 3] 200 steps, total: 44.647, sample: 0.252, forward: 0.569, backward: 39.715, update: 0.155
[proc 4] 200 steps, total: 44.647, sample: 0.245, forward: 0.590, backward: 39.880, update: 0.151
[proc 1] 200 steps, total: 44.647, sample: 0.225, forward: 0.573, backward: 35.968, update: 0.163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.018 ms                  | 13.494 ms                 |
| Forward                   | 6.118 ms                  | 13.522 ms                 |
| Backward                  | 273.948 ms                | 556.225 ms                |
| Optimize                  | 1.715 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 10.929 ms                 | 201.410 ms                |
| BlockToStepN              | 17.159 us                 | 178.185 us                |
| OneStep                   | 301.390 ms                | 699.045 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.018 ms                  | 13.494 ms                 |
| Forward                   | 6.118 ms                  | 13.522 ms                 |
| Backward                  | 279.462 ms                | 561.537 ms                |
| Optimize                  | 1.717 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 11.209 ms                 | 201.410 ms                |
| BlockToStepN              | 17.225 us                 | 225.706 us                |
| OneStep                   | 314.346 ms                | 702.448 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.033 ms                  | 13.537 ms                 |
| Forward                   | 6.120 ms                  | 13.522 ms                 |
| Backward                  | 294.228 ms                | 585.692 ms                |
| Optimize                  | 1.734 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 11.899 ms                 | 216.410 ms                |
| BlockToStepN              | 17.532 us                 | 225.706 us                |
| OneStep                   | 319.361 ms                | 717.917 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.023 ms                  | 13.537 ms                 |
| Forward                   | 6.126 ms                  | 13.522 ms                 |
| Backward                  | 299.430 ms                | 612.822 ms                |
| Optimize                  | 1.735 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 12.921 ms                 | 216.410 ms                |
| BlockToStepN              | 17.558 us                 | 440.795 us                |
| OneStep                   | 334.328 ms                | 717.917 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.023 ms                  | 13.537 ms                 |
| Forward                   | 6.126 ms                  | 13.522 ms                 |
| Backward                  | 302.382 ms                | 656.123 ms                |
| Optimize                  | 1.737 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 13.327 ms                 | 367.443 ms                |
| BlockToStepN              | 17.854 us                 | 440.795 us                |
| OneStep                   | 344.509 ms                | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.033 ms                  | 13.537 ms                 |
| Forward                   | 6.120 ms                  | 13.522 ms                 |
| Backward                  | 315.973 ms                | 680.526 ms                |
| Optimize                  | 1.739 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 14.196 ms                 | 367.443 ms                |
| BlockToStepN              | 17.854 us                 | 440.795 us                |
| OneStep                   | 358.358 ms                | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.040 ms                  | 13.537 ms                 |
| Forward                   | 6.118 ms                  | 13.522 ms                 |
| Backward                  | 323.254 ms                | 697.566 ms                |
| Optimize                  | 1.738 ms                  | 3.242 ms                  |
| BarrierTimeBeforeRank0    | 14.582 ms                 | 367.443 ms                |
| BlockToStepN              | 18.095 us                 | 440.795 us                |
| OneStep                   | 364.471 ms                | 819.355 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.040 ms                  | 13.494 ms                 |
| Forward                   | 6.120 ms                  | 12.351 ms                 |
| Backward                  | 328.906 ms                | 697.566 ms                |
| Optimize                  | 1.739 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.076 ms                 | 238.936 ms                |
| BlockToStepN              | 18.237 us                 | 256.833 us                |
| OneStep                   | 371.084 ms                | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.023 ms                  | 13.494 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 337.587 ms                | 713.627 ms                |
| Optimize                  | 1.739 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.310 ms                 | 238.936 ms                |
| BlockToStepN              | 18.237 us                 | 256.833 us                |
| OneStep                   | 381.604 ms                | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.033 ms                  | 13.494 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 340.661 ms                | 726.942 ms                |
| Optimize                  | 1.740 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.076 ms                 | 238.936 ms                |
| BlockToStepN              | 18.237 us                 | 256.833 us                |
| OneStep                   | 402.584 ms                | 817.961 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.023 ms                  | 13.494 ms                 |
| Forward                   | 6.084 ms                  | 12.351 ms                 |
| Backward                  | 352.068 ms                | 740.689 ms                |
| Optimize                  | 1.741 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.162 ms                 | 269.308 ms                |
| BlockToStepN              | 18.237 us                 | 256.833 us                |
| OneStep                   | 409.882 ms                | 819.355 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.023 ms                  | 13.861 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 354.527 ms                | 757.287 ms                |
| Optimize                  | 1.743 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.310 ms                 | 367.443 ms                |
| BlockToStepN              | 18.286 us                 | 256.833 us                |
| OneStep                   | 430.467 ms                | 934.110 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.033 ms                  | 13.861 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 367.729 ms                | 757.287 ms                |
| Optimize                  | 1.743 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.604 ms                 | 367.443 ms                |
| BlockToStepN              | 18.335 us                 | 256.833 us                |
| OneStep                   | 433.214 ms                | 988.494 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.033 ms                  | 13.861 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 377.937 ms                | 787.395 ms                |
| Optimize                  | 1.743 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 15.780 ms                 | 488.983 ms                |
| BlockToStepN              | 18.361 us                 | 256.833 us                |
| OneStep                   | 438.785 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.060 ms                  | 13.861 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 386.754 ms                | 787.395 ms                |
| Optimize                  | 1.743 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 15.987 ms                 | 488.983 ms                |
| BlockToStepN              | 18.787 us                 | 256.833 us                |
| OneStep                   | 454.584 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 74.515, sample: 0.258, forward: 0.572, backward: 64.712, update: 0.165
[proc 2] 300 steps, total: 74.515, sample: 0.220, forward: 0.533, backward: 57.138, update: 0.183
[proc 3] 300 steps, total: 74.515, sample: 0.218, forward: 0.547, backward: 62.781, update: 0.151
[proc 6] 300 steps, total: 74.515, sample: 0.211, forward: 0.585, backward: 58.355, update: 0.158
[proc 5] 300 steps, total: 74.515, sample: 0.232, forward: 0.563, backward: 64.101, update: 0.158
[proc 4] 300 steps, total: 74.515, sample: 0.282, forward: 0.624, backward: 67.014, update: 0.167
[proc 1] 300 steps, total: 74.515, sample: 0.234, forward: 0.584, backward: 58.674, update: 0.175
[proc 0] 300 steps, total: 74.515, sample: 0.272, forward: 0.616, backward: 63.655, update: 0.182
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.052 ms                  | 13.861 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 401.379 ms                | 799.744 ms                |
| Optimize                  | 1.745 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 15.987 ms                 | 488.983 ms                |
| BlockToStepN              | 18.973 us                 | 256.833 us                |
| OneStep                   | 459.760 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.040 ms                  | 13.861 ms                 |
| Forward                   | 6.084 ms                  | 12.351 ms                 |
| Backward                  | 409.709 ms                | 825.761 ms                |
| Optimize                  | 1.747 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 16.352 ms                 | 488.983 ms                |
| BlockToStepN              | 18.973 us                 | 256.833 us                |
| OneStep                   | 468.761 ms                | 1.099 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.052 ms                  | 15.529 ms                 |
| Forward                   | 6.084 ms                  | 12.351 ms                 |
| Backward                  | 410.521 ms                | 861.792 ms                |
| Optimize                  | 1.747 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 16.352 ms                 | 491.923 ms                |
| BlockToStepN              | 19.089 us                 | 342.344 us                |
| OneStep                   | 470.746 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.060 ms                  | 15.529 ms                 |
| Forward                   | 6.084 ms                  | 12.351 ms                 |
| Backward                  | 416.819 ms                | 863.915 ms                |
| Optimize                  | 1.745 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 16.352 ms                 | 748.994 ms                |
| BlockToStepN              | 19.294 us                 | 342.344 us                |
| OneStep                   | 475.408 ms                | 1.510 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.060 ms                  | 15.529 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 418.154 ms                | 863.915 ms                |
| Optimize                  | 1.749 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 17.533 ms                 | 931.983 ms                |
| BlockToStepN              | 19.294 us                 | 342.344 us                |
| OneStep                   | 481.563 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.081 ms                  | 15.529 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 423.654 ms                | 876.837 ms                |
| Optimize                  | 1.750 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 17.504 ms                 | 931.983 ms                |
| BlockToStepN              | 19.134 us                 | 342.344 us                |
| OneStep                   | 486.401 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.083 ms                  | 15.529 ms                 |
| Forward                   | 6.082 ms                  | 12.351 ms                 |
| Backward                  | 433.855 ms                | 883.888 ms                |
| Optimize                  | 1.755 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 17.533 ms                 | 935.345 ms                |
| BlockToStepN              | 19.294 us                 | 342.344 us                |
| OneStep                   | 488.367 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.070 ms                  | 15.529 ms                 |
| Forward                   | 6.084 ms                  | 12.351 ms                 |
| Backward                  | 438.662 ms                | 888.180 ms                |
| Optimize                  | 1.753 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 16.352 ms                 | 935.345 ms                |
| BlockToStepN              | 19.294 us                 | 342.344 us                |
| OneStep                   | 491.712 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.081 ms                  | 15.941 ms                 |
| Forward                   | 6.090 ms                  | 13.522 ms                 |
| Backward                  | 451.037 ms                | 939.837 ms                |
| Optimize                  | 1.755 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 17.533 ms                 | 935.345 ms                |
| BlockToStepN              | 19.500 us                 | 410.478 us                |
| OneStep                   | 507.864 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.092 ms                  | 15.941 ms                 |
| Forward                   | 6.099 ms                  | 13.522 ms                 |
| Backward                  | 457.511 ms                | 946.352 ms                |
| Optimize                  | 1.755 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 17.533 ms                 | 935.345 ms                |
| BlockToStepN              | 19.500 us                 | 440.795 us                |
| OneStep                   | 513.162 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.108 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 461.868 ms                | 939.837 ms                |
| Optimize                  | 1.756 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 18.220 ms                 | 931.983 ms                |
| BlockToStepN              | 19.481 us                 | 410.478 us                |
| OneStep                   | 516.737 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.109 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 466.503 ms                | 939.837 ms                |
| Optimize                  | 1.759 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 18.393 ms                 | 931.983 ms                |
| BlockToStepN              | 19.500 us                 | 410.478 us                |
| OneStep                   | 526.018 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.109 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 471.241 ms                | 946.352 ms                |
| Optimize                  | 1.759 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 19.098 ms                 | 931.983 ms                |
| BlockToStepN              | 19.834 us                 | 410.478 us                |
| OneStep                   | 533.092 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 479.238 ms                | 962.007 ms                |
| Optimize                  | 1.760 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 19.437 ms                 | 931.983 ms                |
| BlockToStepN              | 20.291 us                 | 410.478 us                |
| OneStep                   | 536.251 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.109 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 484.939 ms                | 969.966 ms                |
| Optimize                  | 1.759 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 19.098 ms                 | 931.983 ms                |
| BlockToStepN              | 20.291 us                 | 410.478 us                |
| OneStep                   | 544.440 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 487.680 ms                | 987.332 ms                |
| Optimize                  | 1.760 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 19.864 ms                 | 931.983 ms                |
| BlockToStepN              | 20.495 us                 | 410.478 us                |
| OneStep                   | 548.660 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 490.055 ms                | 999.677 ms                |
| Optimize                  | 1.760 ms                  | 3.114 ms                  |
| BarrierTimeBeforeRank0    | 19.926 ms                 | 931.983 ms                |
| BlockToStepN              | 20.625 us                 | 410.478 us                |
| OneStep                   | 550.798 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.098 ms                  | 12.351 ms                 |
| Backward                  | 495.595 ms                | 1.007 s                   |
| Optimize                  | 1.761 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 19.926 ms                 | 931.983 ms                |
| BlockToStepN              | 20.625 us                 | 410.478 us                |
| OneStep                   | 553.950 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.090 ms                  | 12.351 ms                 |
| Backward                  | 502.023 ms                | 1.019 s                   |
| Optimize                  | 1.768 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 20.505 ms                 | 931.983 ms                |
| BlockToStepN              | 20.692 us                 | 410.478 us                |
| OneStep                   | 559.083 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.098 ms                  | 12.351 ms                 |
| Backward                  | 504.141 ms                | 1.050 s                   |
| Optimize                  | 1.769 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 20.631 ms                 | 931.983 ms                |
| BlockToStepN              | 20.692 us                 | 410.478 us                |
| OneStep                   | 565.816 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.098 ms                  | 12.351 ms                 |
| Backward                  | 513.145 ms                | 1.052 s                   |
| Optimize                  | 1.772 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 20.631 ms                 | 931.983 ms                |
| BlockToStepN              | 20.625 us                 | 410.478 us                |
| OneStep                   | 568.810 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 104.455, sample: 0.245, forward: 0.591, backward: 80.907, update: 0.155
[proc 7] 400 steps, total: 104.455, sample: 0.241, forward: 0.562, backward: 86.998, update: 0.170
[proc 4] 400 steps, total: 104.455, sample: 0.288, forward: 0.610, backward: 93.608, update: 0.177
[proc 3] 400 steps, total: 104.455, sample: 0.227, forward: 0.574, backward: 90.759, update: 0.172
[proc 2] 400 steps, total: 104.455, sample: 0.238, forward: 0.554, backward: 79.869, update: 0.191
[proc 5] 400 steps, total: 104.455, sample: 0.250, forward: 0.564, backward: 89.716, update: 0.160
[proc 1] 400 steps, total: 104.455, sample: 0.232, forward: 0.567, backward: 79.043, update: 0.174
[proc 0] 400 steps, total: 104.455, sample: 0.272, forward: 0.636, backward: 88.056, update: 0.197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 514.829 ms                | 1.055 s                   |
| Optimize                  | 1.773 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 20.638 ms                 | 931.983 ms                |
| BlockToStepN              | 20.692 us                 | 410.478 us                |
| OneStep                   | 582.382 ms                | 1.561 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.120 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 522.058 ms                | 1.059 s                   |
| Optimize                  | 1.775 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.103 ms                 | 931.983 ms                |
| BlockToStepN              | 20.869 us                 | 410.478 us                |
| OneStep                   | 583.487 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.099 ms                  | 12.351 ms                 |
| Backward                  | 522.358 ms                | 1.061 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.103 ms                 | 931.983 ms                |
| BlockToStepN              | 20.692 us                 | 410.478 us                |
| OneStep                   | 590.098 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 527.317 ms                | 1.075 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.404 ms                 | 931.983 ms                |
| BlockToStepN              | 20.869 us                 | 410.478 us                |
| OneStep                   | 592.251 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 534.746 ms                | 1.120 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.526 ms                 | 931.983 ms                |
| BlockToStepN              | 20.869 us                 | 410.478 us                |
| OneStep                   | 616.529 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 535.058 ms                | 1.121 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.682 ms                 | 931.983 ms                |
| BlockToStepN              | 20.969 us                 | 410.478 us                |
| OneStep                   | 620.091 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.119 ms                  | 15.529 ms                 |
| Forward                   | 6.107 ms                  | 12.351 ms                 |
| Backward                  | 540.025 ms                | 1.134 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.682 ms                 | 931.983 ms                |
| BlockToStepN              | 20.989 us                 | 410.478 us                |
| OneStep                   | 622.470 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 545.409 ms                | 1.139 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 22.457 ms                 | 931.983 ms                |
| BlockToStepN              | 21.162 us                 | 410.478 us                |
| OneStep                   | 630.045 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.108 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 556.225 ms                | 1.139 s                   |
| Optimize                  | 1.775 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 22.320 ms                 | 931.983 ms                |
| BlockToStepN              | 21.162 us                 | 410.478 us                |
| OneStep                   | 634.391 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.114 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 559.834 ms                | 1.179 s                   |
| Optimize                  | 1.775 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 22.457 ms                 | 931.983 ms                |
| BlockToStepN              | 21.202 us                 | 440.795 us                |
| OneStep                   | 642.980 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.120 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 560.027 ms                | 1.194 s                   |
| Optimize                  | 1.775 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 21.682 ms                 | 931.983 ms                |
| BlockToStepN              | 21.202 us                 | 440.795 us                |
| OneStep                   | 653.365 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.120 ms                  | 15.529 ms                 |
| Forward                   | 6.115 ms                  | 12.351 ms                 |
| Backward                  | 565.272 ms                | 1.202 s                   |
| Optimize                  | 1.777 ms                  | 3.158 ms                  |
| BarrierTimeBeforeRank0    | 22.320 ms                 | 931.983 ms                |
| BlockToStepN              | 21.202 us                 | 440.795 us                |
| OneStep                   | 663.440 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.121 ms                  | 14.885 ms                 |
| Forward                   | 6.107 ms                  | 10.902 ms                 |
| Backward                  | 569.551 ms                | 1.202 s                   |
| Optimize                  | 1.777 ms                  | 3.127 ms                  |
| BarrierTimeBeforeRank0    | 22.457 ms                 | 748.994 ms                |
| BlockToStepN              | 21.202 us                 | 410.478 us                |
| OneStep                   | 667.810 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.129 ms                  | 14.885 ms                 |
| Forward                   | 6.107 ms                  | 11.589 ms                 |
| Backward                  | 571.763 ms                | 1.202 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 22.457 ms                 | 748.994 ms                |
| BlockToStepN              | 21.172 us                 | 410.478 us                |
| OneStep                   | 674.519 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.129 ms                  | 14.885 ms                 |
| Forward                   | 6.107 ms                  | 11.589 ms                 |
| Backward                  | 580.701 ms                | 1.217 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 22.320 ms                 | 748.994 ms                |
| BlockToStepN              | 21.202 us                 | 413.100 us                |
| OneStep                   | 676.738 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.129 ms                  | 14.885 ms                 |
| Forward                   | 6.115 ms                  | 11.589 ms                 |
| Backward                  | 585.692 ms                | 1.219 s                   |
| Optimize                  | 1.779 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.682 ms                 | 748.994 ms                |
| BlockToStepN              | 21.422 us                 | 440.795 us                |
| OneStep                   | 685.552 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.129 ms                  | 14.885 ms                 |
| Forward                   | 6.115 ms                  | 11.589 ms                 |
| Backward                  | 586.391 ms                | 1.233 s                   |
| Optimize                  | 1.780 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.526 ms                 | 748.994 ms                |
| BlockToStepN              | 21.565 us                 | 440.795 us                |
| OneStep                   | 686.758 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.131 ms                  | 14.885 ms                 |
| Forward                   | 6.115 ms                  | 11.589 ms                 |
| Backward                  | 587.675 ms                | 1.234 s                   |
| Optimize                  | 1.779 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.458 ms                 | 748.994 ms                |
| BlockToStepN              | 21.683 us                 | 440.795 us                |
| OneStep                   | 689.025 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.131 ms                  | 14.885 ms                 |
| Forward                   | 6.115 ms                  | 11.589 ms                 |
| Backward                  | 594.778 ms                | 1.261 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.392 ms                 | 748.994 ms                |
| BlockToStepN              | 21.827 us                 | 440.795 us                |
| OneStep                   | 692.763 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.131 ms                  | 14.885 ms                 |
| Forward                   | 6.118 ms                  | 11.589 ms                 |
| Backward                  | 607.347 ms                | 1.262 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.404 ms                 | 748.994 ms                |
| BlockToStepN              | 22.116 us                 | 440.795 us                |
| OneStep                   | 696.219 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.129 ms                  | 14.885 ms                 |
| Forward                   | 6.118 ms                  | 11.589 ms                 |
| Backward                  | 607.721 ms                | 1.299 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.392 ms                 | 748.994 ms                |
| BlockToStepN              | 22.245 us                 | 446.282 us                |
| OneStep                   | 702.448 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.137 ms                  | 14.885 ms                 |
| Forward                   | 6.118 ms                  | 11.589 ms                 |
| Backward                  | 608.453 ms                | 1.299 s                   |
| Optimize                  | 1.777 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.103 ms                 | 748.994 ms                |
| BlockToStepN              | 22.245 us                 | 446.282 us                |
| OneStep                   | 703.078 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.137 ms                  | 14.885 ms                 |
| Forward                   | 6.118 ms                  | 11.589 ms                 |
| Backward                  | 612.822 ms                | 1.302 s                   |
| Optimize                  | 1.779 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 21.103 ms                 | 748.994 ms                |
| BlockToStepN              | 22.245 us                 | 446.282 us                |
| OneStep                   | 712.792 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.131 ms                  | 14.885 ms                 |
| Forward                   | 6.118 ms                  | 11.589 ms                 |
| Backward                  | 619.033 ms                | 1.313 s                   |
| Optimize                  | 1.779 ms                  | 3.151 ms                  |
| BarrierTimeBeforeRank0    | 20.638 ms                 | 748.994 ms                |
| BlockToStepN              | 22.245 us                 | 446.282 us                |
| OneStep                   | 716.908 ms                | 1.613 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 500 steps, total: 123.180, sample: 0.218, forward: 0.593, backward: 103.526, update: 0.162
[proc 4] 500 steps, total: 123.180, sample: 0.219, forward: 0.575, backward: 111.862, update: 0.155
[proc 5] 500 steps, total: 123.180, sample: 0.215, forward: 0.578, backward: 110.338, update: 0.164
[proc 7] 500 steps, total: 123.180, sample: 0.251, forward: 0.569, backward: 111.750, update: 0.169
[proc 3] 500 steps, total: 123.180, sample: 0.249, forward: 0.572, backward: 112.196, update: 0.160
[proc 2] 500 steps, total: 123.180, sample: 0.273, forward: 0.569, backward: 103.811, update: 0.200
[proc 1] 500 steps, total: 123.180, sample: 0.240, forward: 0.585, backward: 101.317, update: 0.183
[proc 0] 500 steps, total: 123.180, sample: 0.268, forward: 0.625, backward: 114.368, update: 0.197
Successfully xmh. training takes 363.6882712841034 seconds
before call kg_cache_controller.StopThreads()
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
INFO [43727 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
