WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:09:48.120529 62703 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_45', no_save_emb=True, max_step=500, batch_size=400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[02:09:48] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 14951 nodes and 771659 edges into 6 parts and get 136109 edge cuts
WARNING [62703 sampler.py:454] Start PreSampling
WARNING [62703 sampler.py:532] Before construct renumbering_dict
WARNING [62703 sampler.py:555] PreSampling done
W20240123 02:09:53.089390 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:09:53.089696 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:09:53.089732 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:09:53.089766 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:09:53.089818 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:09:53.089855 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:09:53.089882 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:09:53.089946 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:09:53.089982 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:09:53.090014 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:09:53.090067 62703 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:09:53.090098 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:09:53.090121 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:09:53.090281 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:09:53.090323 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:09:53.090363 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:09:53.090405 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:09:53.090451 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:09:53.090476 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:09:53.090524 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:09:53.090574 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:09:53.090615 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:09:53.090672 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:09:53.090698 62703 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:09:53.090719 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:09:53.090761 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:09:53.090886 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:09:53.090914 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:09:53.090960 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:09:53.091001 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:09:53.091035 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:09:53.091084 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:09:53.091125 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:09:53.091153 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:09:53.091184 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:09:53.091230 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:09:53.091270 62703 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:09:53.091291 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:09:53.091333 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:09:53.091444 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:09:53.091477 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:09:53.091517 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:09:53.091588 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:09:53.091614 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:09:53.091658 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:09:53.091687 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:09:53.091719 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:09:53.091754 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:09:53.091796 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:09:53.091825 62703 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:09:53.091845 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:09:53.091867 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:09:53.091923 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240123 02:09:53.091950 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240123 02:09:53.092000 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240123 02:09:53.092060 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240123 02:09:53.092087 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240123 02:09:53.092123 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240123 02:09:53.092164 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240123 02:09:53.092191 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240123 02:09:53.092216 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240123 02:09:53.092260 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240123 02:09:53.092285 62703 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240123 02:09:53.092305 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240123 02:09:53.092329 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240123 02:09:53.092384 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240123 02:09:53.092417 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240123 02:09:53.092443 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240123 02:09:53.092469 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240123 02:09:53.092501 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240123 02:09:53.092537 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240123 02:09:53.092566 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240123 02:09:53.092590 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240123 02:09:53.092651 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240123 02:09:53.092694 62703 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240123 02:09:53.092729 62703 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240123 02:09:53.092749 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240123 02:09:53.092785 62703 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240123 02:09:53.293809 62703 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100002e52000
W20240123 02:09:53.293970 62703 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100004524000
Convert a graph into a bidirected graph: 0.027 seconds, peak memory: 40.954 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.954 GB
Metis partitioning: 0.101 seconds, peak memory: 40.954 GB
Split the graph: 0.042 seconds
Construct subgraphs: 0.017 seconds
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([ 1015,  1378,  1658,  ...,  3542,  2248, 10849]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.208 seconds
[Rank1] pid = 63154
[Rank2] pid = 63194
[Rank3] pid = 63283
[Rank4] pid = 63347
INFO [62703 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [63154 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [63194 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [63283 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [62703 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [63347 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [63411 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [63283 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [63194 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [63411 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [63154 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [63347 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240123 02:09:56.066979 63413 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240123 02:09:56.068141 63284 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240123 02:09:56.068655 63412 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240123 02:09:56.068665 63219 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240123 02:09:56.068660 63155 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240123 02:09:56.068655 63348 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240123 02:09:56.096968 63413 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x100004536000
W20240123 02:09:56.097092 63413 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1000045fb000
W20240123 02:09:56.097141 63413 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x1000046c0000
W20240123 02:09:56.097172 63413 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10000df58000
W20240123 02:09:56.097219 63413 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240123 02:09:56.097440 63284 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1000177f2000
W20240123 02:09:56.097579 63284 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1000178b7000
W20240123 02:09:56.097631 63284 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x10001797c000
W20240123 02:09:56.097669 63284 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100021214000
W20240123 02:09:56.097698 63284 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240123 02:09:56.097760 63413 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240123 02:09:56.098701 63284 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240123 02:09:56.104709 63412 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x10002aab6000
W20240123 02:09:56.104830 63412 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x10002ab7b000
W20240123 02:09:56.104873 63412 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 400]0x10002ac40000
W20240123 02:09:56.104897 63412 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x1000344d8000
W20240123 02:09:56.104940 63412 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240123 02:09:56.105433 63412 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240123 02:09:56.105456 63348 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x10003dd78000
W20240123 02:09:56.105507 63219 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x10003de3d000
W20240123 02:09:56.105522 63155 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x10003df02000
W20240123 02:09:56.105571 63348 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x10003dfc7000
W20240123 02:09:56.105618 63348 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 400]0x10003e08c000
W20240123 02:09:56.105635 63219 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100047924000
W20240123 02:09:56.105649 63348 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1000479e9000
W20240123 02:09:56.105655 63155 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x100051281000
W20240123 02:09:56.105680 63348 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240123 02:09:56.105695 63219 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x100051346000
W20240123 02:09:56.105718 63155 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x10005abde000
W20240123 02:09:56.105736 63219 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x100064476000
W20240123 02:09:56.105767 63155 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10006dd0e000
W20240123 02:09:56.105767 63219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240123 02:09:56.105814 63155 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240123 02:09:56.107084 63219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240123 02:09:56.107088 63348 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240123 02:09:56.107112 63155 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100002e52000
4: KnownLocalCachedEmbedding init done
WARNING [63347 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
5: KnownLocalCachedEmbedding init done
WARNING [63411 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 63411
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x100002e52000
0: KnownLocalCachedEmbedding init done
WARNING [62703 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
2: KnownLocalCachedEmbedding init done
WARNING [63194 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
3: KnownLocalCachedEmbedding init done
WARNING [63283 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
1: KnownLocalCachedEmbedding init done
WARNING [63154 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:09:56.272428 63219 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240123 02:09:56.272462 63284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:09:56.272487 63155 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:09:56.272512 63413 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:09:56.272583 63348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:09:56.272619 63412 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240123 02:09:56.273577 63413 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240123 02:09:56.273686 63413 grad_base.h:172] Init GradProcessingBase done
I20240123 02:09:56.277274 63413 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240123 02:09:56.277374 63413 kg_controller.h:78] after init GradAsyncProcessingV2
I20240123 02:09:56.277379 63413 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240123 02:09:57.845844 63413 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240123 02:09:58.420629 63974 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240123 02:09:58.421057 63974 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240123 02:09:58.437145 63412 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240123 02:09:58.467989 63155 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:09:58.468788 63284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:09:58.469581 63413 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:09:58.470103 63219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:09:58.477942 63348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240123 02:10:00.368168 63413 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240123 02:10:00.379451 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240123 02:10:00.388976 63974 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.102 ms                  | 12.571 ms                 |
| Forward                   | 3.743 ms                  | 731.079 ms                |
| Backward                  | 3.502 ms                  | 213.561 ms                |
| Optimize                  | 1.267 ms                  | 1.669 ms                  |
| BarrierTimeBeforeRank0    | 179.093 us                | 75.198 ms                 |
| AfterBackward             | 15.816 ms                 | 877.114 ms                |
| BlockToStepN              | 420.920 us                | 32.388 ms                 |
| OneStep                   | 29.162 ms                 | 1.908 s                   |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:01.368084 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=12560
W20240123 02:10:01.380489 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240123 02:10:01.402377 63974 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
E20240123 02:10:02.368013 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=10261
W20240123 02:10:02.390861 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240123 02:10:02.402835 63974 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.623 ms                  | 283.458 ms                |
| ProcessBack:UpdateCache   | 4.575 ms                  | 571.864 ms                |
| ProcessBack:UpsertPq      | 6.599 ms                  | 10.381 ms                 |
| ProcessOneStep            | 16.351 ms                 | 21.734 ms                 |
| BlockToStepN              | 1.928 ms                  | 29.017 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:03.368611 63649 parallel_pq_v2.h:76] insert failed, size(hashtable)=598
W20240123 02:10:03.414064 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240123 02:10:03.421754 63974 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 5.461, sample: 0.253, forward: 1.088, backward: 0.610, update: 0.090
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 5.471, sample: 0.238, forward: 1.086, backward: 0.583, update: 0.091
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 5.470, sample: 0.214, forward: 1.067, backward: 0.567, update: 0.085
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 5.501, sample: 0.237, forward: 1.028, backward: 0.722, update: 0.090
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 5.469, sample: 0.218, forward: 1.086, backward: 0.617, update: 0.090
train_sampler.Prefill()
-------Step 0-------
tensor([    2,  8100, 10727,   942, 12956,  7312,   100,  8477, 11662,  4099]) tensor([ 1658,    21,  6886,  8224,    50, 12434, 12392, 14950,  1594,  4400])
-------Step 1-------
tensor([    2,  8100, 10727,   942, 12956,  7312,   100,  8477, 11662,  4099]) tensor([10642, 11131,  2211, 10633, 12556,  8819, 11216, 11361, 13292, 12358])
-------Step 2-------
tensor([ 4645,    73, 13984, 10407, 13999,     0,  5622,  5098, 11243, 10416]) tensor([10690,    35,  3172,  5519,  2101,   304,  8365,  1752, 14135, 14145])
-------Step 3-------
tensor([ 4645,    73, 13984, 10407, 13999,     0,  5622,  5098, 11243, 10416]) tensor([ 1372,  2786,  3139, 12084,  6354,  2193,  9956,  5299,  4096,  4155])
-------Step 4-------
tensor([12300,  9893, 13319,  5688, 13801,  4576, 13042, 10405, 12288, 12906]) tensor([ 1825,  4169,  5269,  5829,  3653,  5756, 12295, 14271, 12055,  5712])
-------Step 5-------
tensor([12300,  9893, 13319,  5688, 13801,  4576, 13042, 10405, 12288, 12906]) tensor([ 3976,  4766,  1422,  1907, 11853,  5589,  3429, 10496, 12995,  3816])
-------Step 6-------
tensor([14818,     0,    44,    19,  9726,  4671,  4381,  3361,  2750,  3320]) tensor([ 7228,  2575,  1379,  2817,  2267, 10183, 13194,  8799,  8633,  8793])
-------Step 7-------
tensor([14818,     0,    44,    19,  9726,  4671,  4381,  3361,  2750,  3320]) tensor([9826, 4515, 3394, 7960, 2185, 6934, 7737, 4512, 5680, 4619])
-------Step 8-------
tensor([ 3135, 12956,  6481, 12992, 11318,  9726,     0,    95, 14832, 13788]) tensor([ 6017,  3269,   431,  4245, 13081,  6569, 14049,  9524, 11178,  4755])
-------Step 9-------
tensor([ 3135, 12956,  6481, 12992, 11318,  9726,     0,    95, 14832, 13788]) tensor([ 4915,  3468,  6970,  3677,  3680,  6282,  8947,  7777, 11547,  1232])
before start barrier
start train
[proc 0] 100 steps, total: 5.469, sample: 0.278, forward: 1.149, backward: 0.620, update: 0.110
E20240123 02:10:04.368007 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=5982
W20240123 02:10:04.429124 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240123 02:10:04.437287 63974 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240123 02:10:05.368144 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=3278
W20240123 02:10:05.432689 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240123 02:10:05.441501 63974 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.447 ms                  | 13.261 ms                 |
| Forward                   | 4.342 ms                  | 15.151 ms                 |
| Backward                  | 3.463 ms                  | 10.830 ms                 |
| Optimize                  | 1.317 ms                  | 1.577 ms                  |
| BarrierTimeBeforeRank0    | 32.627 us                 | 10.769 ms                 |
| AfterBackward             | 19.094 ms                 | 22.405 ms                 |
| BlockToStepN              | 4.063 ms                  | 12.782 ms                 |
| OneStep                   | 36.126 ms                 | 66.782 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:06.368006 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=664
W20240123 02:10:06.442253 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240123 02:10:06.451725 63974 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240123 02:10:07.368011 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1151
W20240123 02:10:07.442538 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240123 02:10:07.452103 63974 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.139 ms                  | 4.936 ms                  |
| ProcessBack:UpdateCache   | 5.323 ms                  | 9.428 ms                  |
| ProcessBack:UpsertPq      | 7.821 ms                  | 11.493 ms                 |
| ProcessOneStep            | 19.182 ms                 | 22.901 ms                 |
| BlockToStepN              | 4.380 ms                  | 12.649 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 3.909, sample: 0.243, forward: 0.353, backward: 0.386, update: 0.096
[proc 2] 200 steps, total: 3.909, sample: 0.236, forward: 0.336, backward: 0.331, update: 0.086
[proc 4] 200 steps, total: 3.909, sample: 0.233, forward: 0.336, backward: 0.348, update: 0.088
[proc 3] 200 steps, total: 3.909, sample: 0.230, forward: 0.328, backward: 0.347, update: 0.082
[proc 1] 200 steps, total: 3.909, sample: 0.237, forward: 0.326, backward: 0.346, update: 0.085
[proc 0] 200 steps, total: 3.908, sample: 0.310, forward: 0.442, backward: 0.334, update: 0.123
E20240123 02:10:08.368021 63413 parallel_pq_v2.h:76] insert failed, size(hashtable)=2213
W20240123 02:10:08.473925 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240123 02:10:08.494699 63974 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240123 02:10:09.368014 63649 parallel_pq_v2.h:76] insert failed, size(hashtable)=103
W20240123 02:10:09.473469 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240123 02:10:09.494834 63974 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240123 02:10:10.368009 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=3804
W20240123 02:10:10.477843 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240123 02:10:10.494315 63974 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.615 ms                  | 13.095 ms                 |
| Forward                   | 4.460 ms                  | 7.694 ms                  |
| Backward                  | 3.448 ms                  | 8.681 ms                  |
| Optimize                  | 1.335 ms                  | 1.590 ms                  |
| BarrierTimeBeforeRank0    | 32.005 us                 | 10.397 ms                 |
| AfterBackward             | 19.740 ms                 | 24.200 ms                 |
| BlockToStepN              | 5.965 ms                  | 18.278 ms                 |
| OneStep                   | 38.910 ms                 | 59.358 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:11.368006 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=3773
W20240123 02:10:11.493825 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240123 02:10:11.500320 63974 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
[proc 4] 300 steps, total: 4.320, sample: 0.206, forward: 0.323, backward: 0.385, update: 0.087
[proc 3] 300 steps, total: 4.320, sample: 0.207, forward: 0.321, backward: 0.355, update: 0.081
[proc 0] 300 steps, total: 4.320, sample: 0.293, forward: 0.437, backward: 0.341, update: 0.117
[proc 2] 300 steps, total: 4.320, sample: 0.206, forward: 0.327, backward: 0.339, update: 0.084
[proc 1] 300 steps, total: 4.320, sample: 0.209, forward: 0.312, backward: 0.342, update: 0.082
[proc 5] 300 steps, total: 4.321, sample: 0.231, forward: 0.358, backward: 0.361, update: 0.100
E20240123 02:10:12.368014 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=8839
W20240123 02:10:12.502846 63974 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240123 02:10:12.516527 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.175 ms                  | 4.891 ms                  |
| ProcessBack:UpdateCache   | 5.588 ms                  | 9.428 ms                  |
| ProcessBack:UpsertPq      | 8.087 ms                  | 12.337 ms                 |
| ProcessOneStep            | 19.702 ms                 | 24.579 ms                 |
| BlockToStepN              | 6.369 ms                  | 21.605 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:13.368009 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=6917
W20240123 02:10:13.507251 63974 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240123 02:10:13.536810 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=334, pq.top=334
E20240123 02:10:14.368026 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=12087
W20240123 02:10:14.521149 63974 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240123 02:10:14.549602 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
E20240123 02:10:15.368009 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=4732
W20240123 02:10:15.535070 63974 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240123 02:10:15.563652 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=384, pq.top=384
[proc 5] 400 steps, total: 4.059, sample: 0.201, forward: 0.319, backward: 0.330, update: 0.086
[proc 3] 400 steps, total: 4.059, sample: 0.210, forward: 0.329, backward: 0.344, update: 0.086
[proc 0] 400 steps, total: 4.059, sample: 0.239, forward: 0.353, backward: 0.346, update: 0.096
[proc 2] 400 steps, total: 4.059, sample: 0.198, forward: 0.325, backward: 0.368, update: 0.084
[proc 4] 400 steps, total: 4.059, sample: 0.197, forward: 0.313, backward: 0.373, update: 0.084
[proc 1] 400 steps, total: 4.059, sample: 0.182, forward: 0.290, backward: 0.351, update: 0.087
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.561 ms                  | 12.931 ms                 |
| Forward                   | 4.344 ms                  | 7.407 ms                  |
| Backward                  | 3.468 ms                  | 8.083 ms                  |
| Optimize                  | 1.286 ms                  | 1.588 ms                  |
| BarrierTimeBeforeRank0    | 31.821 us                 | 10.318 ms                 |
| AfterBackward             | 19.439 ms                 | 24.517 ms                 |
| BlockToStepN              | 6.921 ms                  | 24.488 ms                 |
| OneStep                   | 39.308 ms                 | 66.782 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:16.368018 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=12572
W20240123 02:10:16.541652 63974 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240123 02:10:16.574204 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=408
E20240123 02:10:17.368009 63413 parallel_pq_v2.h:76] insert failed, size(hashtable)=762
W20240123 02:10:17.554911 63974 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240123 02:10:17.585484 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.143 ms                  | 4.899 ms                  |
| ProcessBack:UpdateCache   | 5.769 ms                  | 7.022 ms                  |
| ProcessBack:UpsertPq      | 8.087 ms                  | 12.221 ms                 |
| ProcessOneStep            | 19.426 ms                 | 24.490 ms                 |
| BlockToStepN              | 7.018 ms                  | 29.017 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240123 02:10:18.368664 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=11588
W20240123 02:10:18.579087 63974 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240123 02:10:18.613179 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=456, pq.top=456
E20240123 02:10:19.368007 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=9269
W20240123 02:10:19.581895 63974 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240123 02:10:19.613765 63413 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=480, pq.top=480
E20240123 02:10:20.368858 63973 parallel_pq_v2.h:76] insert failed, size(hashtable)=11333
[proc 3] 500 steps, total: 4.258, sample: 0.217, forward: 0.350, backward: 0.370, update: 0.090
[proc 0] 500 steps, total: 4.258, sample: 0.278, forward: 0.426, backward: 0.351, update: 0.104
[proc 4] 500 steps, total: 4.258, sample: 0.184, forward: 0.299, backward: 0.366, update: 0.080
[proc 2] 500 steps, total: 4.258, sample: 0.196, forward: 0.320, backward: 0.324, update: 0.083
[proc 1] 500 steps, total: 4.258, sample: 0.208, forward: 0.326, backward: 0.335, update: 0.089
[proc 5] 500 steps, total: 4.258, sample: 0.186, forward: 0.318, backward: 0.356, update: 0.087
Successfully xmh. training takes 22.015677452087402 seconds
before call kg_cache_controller.StopThreads()
W20240123 02:10:20.485435 63413 grad_async_v2.h:71] call StopThreads. PID = 62703
W20240123 02:10:20.485471 63413 grad_base.h:210] before processOneStepNegThread_.join();
W20240123 02:10:20.485735 63413 grad_base.h:212] after processOneStepNegThread_.join();
W20240123 02:10:20.485754 63413 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240123 02:10:20.490211 63413 grad_async_v2.h:91] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f9f7255c850>
W20240123 02:10:22.032131 62703 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
