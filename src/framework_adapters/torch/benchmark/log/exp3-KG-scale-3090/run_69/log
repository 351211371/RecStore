WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 15:20:19.276216 20319 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_16', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [20319 sampler.py:454] Start PreSampling
WARNING [20319 sampler.py:532] Before construct renumbering_dict
WARNING [20319 sampler.py:555] PreSampling done
W20240123 15:32:53.637431 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 15:32:53.637688 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 15:32:53.637727 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 15:32:53.637754 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 15:32:53.637781 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 15:32:53.637805 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 15:32:53.637822 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 15:32:53.637848 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 15:32:53.637867 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 15:32:53.637885 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 15:32:53.637915 20319 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 15:32:53.637936 20319 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 15:32:53.637956 20319 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 15:32:53.638087 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 15:32:53.638123 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 15:32:53.638154 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 15:32:53.638171 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 15:32:53.638201 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 15:32:53.638227 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 15:32:53.638253 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 15:32:53.638280 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 15:32:53.638298 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 15:32:53.638322 20319 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 15:32:53.638351 20319 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 15:32:53.638365 20319 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 15:32:53.638387 20319 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 15:32:53.953747 20319 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100000f72000 128.2 GB
W20240123 15:32:53.953912 20319 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10200fbaa000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2147078
Rank1: cached key size 2004385
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4151531,  4151554,   211803,  ..., 28543721, 27177973, 75899913]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 931.045 seconds
INFO [44478 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [44478 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [20319 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20319 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [44478 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [20319 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [20319 cache_common.py:137] TorchNativeStdEmb construct done
INFO [44478 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [20319 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [44478 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 15:35:52.733147 44479 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240123 15:35:52.733278 44544 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
I20240123 15:36:17.996011 44544 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240123 15:36:19.651772 44479 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.352 ms                 | 64.987 ms                 |
| Forward                   | 6.358 ms                  | 511.823 ms                |
| Backward                  | 53.274 ms                 | 165.224 ms                |
| Optimize                  | 1.435 ms                  | 3.162 ms                  |
| BarrierTimeBeforeRank0    | 1.398 ms                  | 22.041 ms                 |
| BlockToStepN              | 6.409 us                  | 60.364 us                 |
| OneStep                   | 75.153 ms                 | 717.951 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.869 ms                  | 57.410 ms                 |
| Forward                   | 6.379 ms                  | 7.105 ms                  |
| Backward                  | 92.727 ms                 | 172.930 ms                |
| Optimize                  | 1.434 ms                  | 1.719 ms                  |
| BarrierTimeBeforeRank0    | 83.405 us                 | 18.776 ms                 |
| BlockToStepN              | 6.332 us                  | 14.804 us                 |
| OneStep                   | 112.495 ms                | 200.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.934 ms                  | 57.410 ms                 |
| Forward                   | 6.365 ms                  | 7.105 ms                  |
| Backward                  | 122.045 ms                | 238.589 ms                |
| Optimize                  | 1.411 ms                  | 1.719 ms                  |
| BarrierTimeBeforeRank0    | 49.052 us                 | 18.776 ms                 |
| BlockToStepN              | 7.003 us                  | 14.804 us                 |
| OneStep                   | 144.185 ms                | 249.260 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank1] pid = 44478
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
train_sampler.Prefill()
-------Step 0-------
tensor([358889, 358931, 358969, 359024, 359062, 359100, 359139,  30492, 359175,
        359209]) tensor([   70140,  4306021, 15674615, 58858818, 30631873, 15615181, 59518698,
         6933088, 52125048, 52126802])
-------Step 1-------
tensor([358889, 358931, 358969, 359024, 359062, 359100, 359139,  30492, 359175,
        359209]) tensor([ 7055520, 68206649, 20473758,  7122752, 14533875,  1321153,  1962373,
        41939856, 26729766, 31651223])
-------Step 2-------
tensor([428462, 428494, 428529, 428558, 428599, 428640, 428672, 428708, 428752,
        428787]) tensor([21874225, 79235204, 79718929, 19808951, 21113884, 23241183, 17310930,
        42295494, 18363789, 34168372])
-------Step 3-------
tensor([428462, 428494, 428529, 428558, 428599, 428640, 428672, 428708, 428752,
        428787]) tensor([58839402, 55566097, 55096243, 19223358, 69938078, 64874149, 72097321,
        58807673, 35349056, 34604892])
-------Step 4-------
tensor([ 497716,  497751,  717897,  497792,  497832, 7201486,  254403,  497872,
         717909,  497917]) tensor([42512687, 75221780, 61738758, 57100204, 66110901, 37225025, 30790681,
         8029096, 67350970, 73115138])
-------Step 5-------
tensor([ 497716,  497751,  717897,  497792,  497832, 7201486,  254403,  497872,
         717909,  497917]) tensor([45959756, 78485689, 21372122, 17867365, 39050502, 35706236, 41052690,
        53138872, 32606132, 31420116])
-------Step 6-------
tensor([569185, 569224, 569267, 719341, 569300, 569331, 569370, 569408, 569437,
        569460]) tensor([59465777, 81226028, 61504161, 21168913,  4449425,  5636050, 67683900,
         9375312, 15841217, 77227674])
-------Step 7-------
tensor([569185, 569224, 569267, 719341, 569300, 569331, 569370, 569408, 569437,
        569460]) tensor([82580453, 29239950, 57025762, 20402777, 32849556, 13756842, 72976950,
         5955798, 47580260, 52229744])
-------Step 8-------
tensor([645014, 645049, 257855, 645081, 645114, 645147, 645204, 645236, 645273,
        645308]) tensor([10811142, 20702364, 35776654,  4845498, 83897885, 17678030, 65396358,
        50432548, 77893281, 59228362])
-------Step 9-------
tensor([645014, 645049, 257855, 645081, 645114, 645147, 645204, 645236, 645273,
        645308]) tensor([44277643, 82041347, 43082984, 33831578, 36375923, 41478361, 29215155,
        28720929, 49828253, 73491950])
before start barrier
start train
[proc 0] 100 steps, total: 16.793, sample: 1.029, forward: 1.134, backward: 14.292, update: 0.134
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.448, sample: 0.850, forward: 1.592, backward: 13.561, update: 0.165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.618 ms                  | 57.410 ms                 |
| Forward                   | 6.355 ms                  | 7.679 ms                  |
| Backward                  | 142.353 ms                | 327.509 ms                |
| Optimize                  | 1.394 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 37.969 us                 | 18.776 ms                 |
| BlockToStepN              | 7.709 us                  | 14.804 us                 |
| OneStep                   | 158.292 ms                | 344.120 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.618 ms                  | 57.410 ms                 |
| Forward                   | 6.352 ms                  | 7.679 ms                  |
| Backward                  | 164.430 ms                | 327.509 ms                |
| Optimize                  | 1.402 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 41.563 us                 | 18.776 ms                 |
| BlockToStepN              | 8.094 us                  | 14.804 us                 |
| OneStep                   | 183.921 ms                | 371.417 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.618 ms                  | 57.410 ms                 |
| Forward                   | 6.352 ms                  | 19.693 ms                 |
| Backward                  | 178.686 ms                | 352.159 ms                |
| Optimize                  | 1.402 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 37.969 us                 | 58.805 ms                 |
| BlockToStepN              | 8.218 us                  | 14.804 us                 |
| OneStep                   | 199.019 ms                | 413.168 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 57.410 ms                 |
| Forward                   | 6.355 ms                  | 19.693 ms                 |
| Backward                  | 200.240 ms                | 410.674 ms                |
| Optimize                  | 1.406 ms                  | 2.127 ms                  |
| BarrierTimeBeforeRank0    | 36.919 us                 | 58.805 ms                 |
| BlockToStepN              | 8.403 us                  | 19.129 us                 |
| OneStep                   | 221.303 ms                | 568.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.570 ms                  | 51.590 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 215.677 ms                | 409.394 ms                |
| Optimize                  | 1.411 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 36.112 us                 | 22.041 ms                 |
| BlockToStepN              | 8.461 us                  | 19.129 us                 |
| OneStep                   | 232.082 ms                | 458.639 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.618 ms                  | 51.590 ms                 |
| Forward                   | 6.356 ms                  | 7.902 ms                  |
| Backward                  | 228.972 ms                | 433.572 ms                |
| Optimize                  | 1.411 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 35.031 us                 | 22.041 ms                 |
| BlockToStepN              | 8.569 us                  | 21.322 us                 |
| OneStep                   | 248.205 ms                | 504.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 51.590 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 244.589 ms                | 529.883 ms                |
| Optimize                  | 1.415 ms                  | 2.055 ms                  |
| BarrierTimeBeforeRank0    | 33.822 us                 | 22.041 ms                 |
| BlockToStepN              | 8.749 us                  | 21.322 us                 |
| OneStep                   | 262.675 ms                | 568.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.570 ms                  | 57.410 ms                 |
| Forward                   | 6.352 ms                  | 7.902 ms                  |
| Backward                  | 259.585 ms                | 529.883 ms                |
| Optimize                  | 1.415 ms                  | 2.066 ms                  |
| BarrierTimeBeforeRank0    | 33.640 us                 | 22.041 ms                 |
| BlockToStepN              | 8.761 us                  | 22.395 us                 |
| OneStep                   | 279.051 ms                | 568.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.570 ms                  | 57.410 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 270.863 ms                | 529.883 ms                |
| Optimize                  | 1.415 ms                  | 2.066 ms                  |
| BarrierTimeBeforeRank0    | 32.931 us                 | 58.805 ms                 |
| BlockToStepN              | 8.761 us                  | 22.395 us                 |
| OneStep                   | 293.641 ms                | 597.696 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 42.280, sample: 0.993, forward: 0.646, backward: 40.145, update: 0.134
[proc 1] 200 steps, total: 42.280, sample: 0.704, forward: 0.926, backward: 38.617, update: 0.169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 284.073 ms                | 553.414 ms                |
| Optimize                  | 1.419 ms                  | 2.066 ms                  |
| BarrierTimeBeforeRank0    | 31.953 us                 | 58.805 ms                 |
| BlockToStepN              | 8.789 us                  | 22.395 us                 |
| OneStep                   | 308.171 ms                | 627.417 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 291.976 ms                | 592.359 ms                |
| Optimize                  | 1.422 ms                  | 2.127 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 58.805 ms                 |
| BlockToStepN              | 8.822 us                  | 22.395 us                 |
| OneStep                   | 316.006 ms                | 646.707 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 301.498 ms                | 592.359 ms                |
| Optimize                  | 1.424 ms                  | 2.127 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 58.805 ms                 |
| BlockToStepN              | 8.962 us                  | 22.395 us                 |
| OneStep                   | 319.865 ms                | 646.707 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 58.276 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 314.332 ms                | 617.214 ms                |
| Optimize                  | 1.426 ms                  | 2.127 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 58.805 ms                 |
| BlockToStepN              | 8.962 us                  | 24.831 us                 |
| OneStep                   | 333.189 ms                | 683.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 58.276 ms                 |
| Forward                   | 6.356 ms                  | 8.494 ms                  |
| Backward                  | 318.713 ms                | 684.182 ms                |
| Optimize                  | 1.428 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.938 us                 | 75.246 ms                 |
| BlockToStepN              | 8.992 us                  | 41.184 us                 |
| OneStep                   | 342.193 ms                | 745.309 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 58.276 ms                 |
| Forward                   | 6.356 ms                  | 8.494 ms                  |
| Backward                  | 325.914 ms                | 684.182 ms                |
| Optimize                  | 1.433 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.938 us                 | 75.246 ms                 |
| BlockToStepN              | 8.993 us                  | 41.184 us                 |
| OneStep                   | 355.155 ms                | 745.309 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.356 ms                  | 7.902 ms                  |
| Backward                  | 332.991 ms                | 681.640 ms                |
| Optimize                  | 1.434 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 58.805 ms                 |
| BlockToStepN              | 9.008 us                  | 24.831 us                 |
| OneStep                   | 365.983 ms                | 717.951 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.356 ms                  | 7.902 ms                  |
| Backward                  | 345.570 ms                | 813.764 ms                |
| Optimize                  | 1.435 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 58.805 ms                 |
| BlockToStepN              | 9.035 us                  | 24.831 us                 |
| OneStep                   | 371.417 ms                | 828.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 366.532 ms                | 813.764 ms                |
| Optimize                  | 1.437 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 58.805 ms                 |
| BlockToStepN              | 9.058 us                  | 24.831 us                 |
| OneStep                   | 386.227 ms                | 828.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 371.666 ms                | 813.764 ms                |
| Optimize                  | 1.437 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 58.805 ms                 |
| BlockToStepN              | 9.058 us                  | 24.831 us                 |
| OneStep                   | 398.875 ms                | 828.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 57.410 ms                 |
| Forward                   | 6.356 ms                  | 7.902 ms                  |
| Backward                  | 381.281 ms                | 824.528 ms                |
| Optimize                  | 1.437 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 75.246 ms                 |
| BlockToStepN              | 9.060 us                  | 41.184 us                 |
| OneStep                   | 401.998 ms                | 867.781 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 387.476 ms                | 835.376 ms                |
| Optimize                  | 1.437 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.938 us                 | 75.246 ms                 |
| BlockToStepN              | 9.088 us                  | 41.184 us                 |
| OneStep                   | 405.785 ms                | 901.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 7.902 ms                  |
| Backward                  | 391.347 ms                | 835.376 ms                |
| Optimize                  | 1.439 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 75.246 ms                 |
| BlockToStepN              | 9.104 us                  | 41.184 us                 |
| OneStep                   | 413.168 ms                | 901.012 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.355 ms                  | 7.902 ms                  |
| Backward                  | 401.105 ms                | 835.376 ms                |
| Optimize                  | 1.443 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.773 us                 | 75.246 ms                 |
| BlockToStepN              | 9.122 us                  | 41.184 us                 |
| OneStep                   | 419.992 ms                | 901.012 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 69.237, sample: 0.679, forward: 0.892, backward: 63.880, update: 0.154
[proc 0] 300 steps, total: 69.237, sample: 0.896, forward: 0.637, backward: 67.269, update: 0.139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 57.410 ms                 |
| Forward                   | 6.356 ms                  | 8.494 ms                  |
| Backward                  | 404.172 ms                | 893.860 ms                |
| Optimize                  | 1.443 ms                  | 2.133 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 75.246 ms                 |
| BlockToStepN              | 9.140 us                  | 41.184 us                 |
| OneStep                   | 421.776 ms                | 903.672 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.356 ms                  | 8.494 ms                  |
| Backward                  | 409.928 ms                | 893.860 ms                |
| Optimize                  | 1.444 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 127.579 ms                |
| BlockToStepN              | 9.151 us                  | 46.624 us                 |
| OneStep                   | 430.562 ms                | 925.314 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 8.494 ms                  |
| Backward                  | 417.634 ms                | 893.860 ms                |
| Optimize                  | 1.447 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 127.579 ms                |
| BlockToStepN              | 9.157 us                  | 46.624 us                 |
| OneStep                   | 434.225 ms                | 925.314 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.362 ms                  | 8.494 ms                  |
| Backward                  | 420.752 ms                | 905.476 ms                |
| Optimize                  | 1.447 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 127.579 ms                |
| BlockToStepN              | 9.171 us                  | 46.624 us                 |
| OneStep                   | 440.222 ms                | 981.663 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 57.410 ms                 |
| Forward                   | 6.362 ms                  | 8.494 ms                  |
| Backward                  | 430.397 ms                | 905.476 ms                |
| Optimize                  | 1.451 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 127.579 ms                |
| BlockToStepN              | 9.171 us                  | 46.624 us                 |
| OneStep                   | 455.105 ms                | 981.663 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 8.494 ms                  |
| Backward                  | 445.313 ms                | 905.476 ms                |
| Optimize                  | 1.452 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 127.579 ms                |
| BlockToStepN              | 9.173 us                  | 46.624 us                 |
| OneStep                   | 468.320 ms                | 981.663 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.518 ms                  | 57.410 ms                 |
| Forward                   | 6.358 ms                  | 8.494 ms                  |
| Backward                  | 455.400 ms                | 910.322 ms                |
| Optimize                  | 1.455 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 127.579 ms                |
| BlockToStepN              | 9.205 us                  | 49.568 us                 |
| OneStep                   | 474.742 ms                | 1.062 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 57.410 ms                 |
| Forward                   | 6.359 ms                  | 8.494 ms                  |
| Backward                  | 460.598 ms                | 910.322 ms                |
| Optimize                  | 1.455 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.938 us                 | 178.930 ms                |
| BlockToStepN              | 9.264 us                  | 49.568 us                 |
| OneStep                   | 482.542 ms                | 1.124 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 57.410 ms                 |
| Forward                   | 6.363 ms                  | 8.494 ms                  |
| Backward                  | 471.029 ms                | 917.147 ms                |
| Optimize                  | 1.455 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.938 us                 | 178.930 ms                |
| BlockToStepN              | 9.283 us                  | 60.364 us                 |
| OneStep                   | 490.860 ms                | 1.124 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 52.116 ms                 |
| Forward                   | 6.364 ms                  | 8.343 ms                  |
| Backward                  | 475.312 ms                | 948.723 ms                |
| Optimize                  | 1.456 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 144.100 ms                |
| BlockToStepN              | 9.332 us                  | 49.568 us                 |
| OneStep                   | 504.320 ms                | 1.124 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 484.356 ms                | 1.033 s                   |
| Optimize                  | 1.459 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 144.100 ms                |
| BlockToStepN              | 9.360 us                  | 49.568 us                 |
| OneStep                   | 505.913 ms                | 1.133 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 489.218 ms                | 1.033 s                   |
| Optimize                  | 1.458 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 144.100 ms                |
| BlockToStepN              | 9.335 us                  | 60.364 us                 |
| OneStep                   | 506.618 ms                | 1.133 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 52.116 ms                 |
| Forward                   | 6.363 ms                  | 8.343 ms                  |
| Backward                  | 491.561 ms                | 1.033 s                   |
| Optimize                  | 1.459 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 212.407 ms                |
| BlockToStepN              | 9.386 us                  | 60.364 us                 |
| OneStep                   | 513.822 ms                | 1.182 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.364 ms                  | 8.343 ms                  |
| Backward                  | 494.522 ms                | 1.109 s                   |
| Optimize                  | 1.460 ms                  | 2.140 ms                  |
| BarrierTimeBeforeRank0    | 31.773 us                 | 212.407 ms                |
| BlockToStepN              | 9.396 us                  | 60.364 us                 |
| OneStep                   | 517.666 ms                | 1.215 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 498.837 ms                | 1.109 s                   |
| Optimize                  | 1.460 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 212.407 ms                |
| BlockToStepN              | 9.396 us                  | 60.364 us                 |
| OneStep                   | 518.633 ms                | 1.215 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 52.116 ms                 |
| Forward                   | 6.364 ms                  | 8.343 ms                  |
| Backward                  | 506.801 ms                | 1.109 s                   |
| Optimize                  | 1.461 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 212.407 ms                |
| BlockToStepN              | 9.398 us                  | 60.364 us                 |
| OneStep                   | 528.072 ms                | 1.215 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.363 ms                  | 8.343 ms                  |
| Backward                  | 508.986 ms                | 1.168 s                   |
| Optimize                  | 1.461 ms                  | 2.156 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 212.407 ms                |
| BlockToStepN              | 9.396 us                  | 60.364 us                 |
| OneStep                   | 542.996 ms                | 1.222 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.364 ms                  | 8.343 ms                  |
| Backward                  | 534.711 ms                | 1.168 s                   |
| Optimize                  | 1.463 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.873 us                 | 222.620 ms                |
| BlockToStepN              | 9.396 us                  | 60.364 us                 |
| OneStep                   | 555.334 ms                | 1.228 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.566 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 537.834 ms                | 1.168 s                   |
| Optimize                  | 1.465 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 222.620 ms                |
| BlockToStepN              | 9.398 us                  | 60.364 us                 |
| OneStep                   | 563.121 ms                | 1.228 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 96.837, sample: 0.895, forward: 0.656, backward: 93.448, update: 0.148
[proc 1] 400 steps, total: 96.837, sample: 0.725, forward: 0.890, backward: 89.812, update: 0.157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.364 ms                  | 8.343 ms                  |
| Backward                  | 542.204 ms                | 1.218 s                   |
| Optimize                  | 1.465 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 222.620 ms                |
| BlockToStepN              | 9.414 us                  | 60.364 us                 |
| OneStep                   | 568.534 ms                | 1.246 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 548.895 ms                | 1.231 s                   |
| Optimize                  | 1.468 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 222.620 ms                |
| BlockToStepN              | 9.417 us                  | 60.364 us                 |
| OneStep                   | 574.930 ms                | 1.280 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.365 ms                  | 8.343 ms                  |
| Backward                  | 553.658 ms                | 1.231 s                   |
| Optimize                  | 1.469 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 222.620 ms                |
| BlockToStepN              | 9.431 us                  | 60.364 us                 |
| OneStep                   | 583.774 ms                | 1.280 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.366 ms                  | 8.343 ms                  |
| Backward                  | 561.075 ms                | 1.231 s                   |
| Optimize                  | 1.470 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.811 us                 | 237.642 ms                |
| BlockToStepN              | 9.482 us                  | 60.364 us                 |
| OneStep                   | 584.368 ms                | 1.317 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 52.116 ms                 |
| Forward                   | 6.369 ms                  | 8.343 ms                  |
| Backward                  | 563.693 ms                | 1.231 s                   |
| Optimize                  | 1.471 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 242.697 ms                |
| BlockToStepN              | 9.483 us                  | 60.364 us                 |
| OneStep                   | 588.615 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.372 ms                  | 8.343 ms                  |
| Backward                  | 573.882 ms                | 1.231 s                   |
| Optimize                  | 1.473 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 242.697 ms                |
| BlockToStepN              | 9.484 us                  | 60.364 us                 |
| OneStep                   | 589.611 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.373 ms                  | 8.343 ms                  |
| Backward                  | 575.612 ms                | 1.231 s                   |
| Optimize                  | 1.474 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 242.697 ms                |
| BlockToStepN              | 9.501 us                  | 60.364 us                 |
| OneStep                   | 591.695 ms                | 1.348 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.372 ms                  | 8.343 ms                  |
| Backward                  | 578.151 ms                | 1.303 s                   |
| Optimize                  | 1.477 ms                  | 2.184 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 242.697 ms                |
| BlockToStepN              | 9.510 us                  | 60.364 us                 |
| OneStep                   | 595.594 ms                | 1.365 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.373 ms                  | 8.343 ms                  |
| Backward                  | 580.101 ms                | 1.303 s                   |
| Optimize                  | 1.478 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.785 us                 | 242.697 ms                |
| BlockToStepN              | 9.510 us                  | 60.364 us                 |
| OneStep                   | 600.905 ms                | 1.365 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.373 ms                  | 8.343 ms                  |
| Backward                  | 585.486 ms                | 1.303 s                   |
| Optimize                  | 1.479 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.773 us                 | 246.694 ms                |
| BlockToStepN              | 9.533 us                  | 60.364 us                 |
| OneStep                   | 605.863 ms                | 1.388 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.375 ms                  | 8.343 ms                  |
| Backward                  | 590.819 ms                | 1.303 s                   |
| Optimize                  | 1.479 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 246.694 ms                |
| BlockToStepN              | 9.550 us                  | 60.364 us                 |
| OneStep                   | 613.434 ms                | 1.388 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 52.116 ms                 |
| Forward                   | 6.375 ms                  | 8.343 ms                  |
| Backward                  | 594.925 ms                | 1.333 s                   |
| Optimize                  | 1.481 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 246.694 ms                |
| BlockToStepN              | 9.550 us                  | 60.364 us                 |
| OneStep                   | 621.265 ms                | 1.406 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 51.899 ms                 |
| Forward                   | 6.377 ms                  | 7.908 ms                  |
| Backward                  | 604.477 ms                | 1.303 s                   |
| Optimize                  | 1.481 ms                  | 2.189 ms                  |
| BarrierTimeBeforeRank0    | 31.574 us                 | 242.697 ms                |
| BlockToStepN              | 9.550 us                  | 49.568 us                 |
| OneStep                   | 625.651 ms                | 1.388 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.377 ms                  | 7.908 ms                  |
| Backward                  | 611.001 ms                | 1.303 s                   |
| Optimize                  | 1.482 ms                  | 2.189 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 246.694 ms                |
| BlockToStepN              | 9.571 us                  | 60.364 us                 |
| OneStep                   | 645.025 ms                | 1.406 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 52.116 ms                 |
| Forward                   | 6.378 ms                  | 7.908 ms                  |
| Backward                  | 616.380 ms                | 1.378 s                   |
| Optimize                  | 1.482 ms                  | 2.189 ms                  |
| BarrierTimeBeforeRank0    | 31.574 us                 | 246.694 ms                |
| BlockToStepN              | 9.571 us                  | 62.593 us                 |
| OneStep                   | 646.611 ms                | 1.432 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.535 ms                  | 52.116 ms                 |
| Forward                   | 6.379 ms                  | 7.908 ms                  |
| Backward                  | 620.216 ms                | 1.378 s                   |
| Optimize                  | 1.483 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.773 us                 | 246.694 ms                |
| BlockToStepN              | 9.571 us                  | 62.593 us                 |
| OneStep                   | 646.786 ms                | 1.432 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.499 ms                  | 52.116 ms                 |
| Forward                   | 6.379 ms                  | 7.908 ms                  |
| Backward                  | 630.388 ms                | 1.378 s                   |
| Optimize                  | 1.483 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 246.694 ms                |
| BlockToStepN              | 9.573 us                  | 62.593 us                 |
| OneStep                   | 647.501 ms                | 1.432 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.499 ms                  | 52.116 ms                 |
| Forward                   | 6.378 ms                  | 7.908 ms                  |
| Backward                  | 633.521 ms                | 1.396 s                   |
| Optimize                  | 1.487 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.574 us                 | 246.694 ms                |
| BlockToStepN              | 9.576 us                  | 62.593 us                 |
| OneStep                   | 650.611 ms                | 1.515 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.470 ms                  | 52.116 ms                 |
| Forward                   | 6.378 ms                  | 8.332 ms                  |
| Backward                  | 634.027 ms                | 1.396 s                   |
| Optimize                  | 1.489 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 246.694 ms                |
| BlockToStepN              | 9.577 us                  | 62.593 us                 |
| OneStep                   | 652.864 ms                | 1.515 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.464 ms                  | 52.116 ms                 |
| Forward                   | 6.378 ms                  | 8.332 ms                  |
| Backward                  | 637.659 ms                | 1.396 s                   |
| Optimize                  | 1.489 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.690 us                 | 247.875 ms                |
| BlockToStepN              | 9.580 us                  | 62.593 us                 |
| OneStep                   | 653.708 ms                | 1.525 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.458 ms                  | 52.116 ms                 |
| Forward                   | 6.378 ms                  | 8.332 ms                  |
| Backward                  | 639.127 ms                | 1.511 s                   |
| Optimize                  | 1.489 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.690 us                 | 247.875 ms                |
| BlockToStepN              | 9.604 us                  | 62.593 us                 |
| OneStep                   | 656.412 ms                | 1.554 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.458 ms                  | 52.116 ms                 |
| Forward                   | 6.379 ms                  | 8.332 ms                  |
| Backward                  | 640.780 ms                | 1.511 s                   |
| Optimize                  | 1.490 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.690 us                 | 247.875 ms                |
| BlockToStepN              | 9.621 us                  | 62.593 us                 |
| OneStep                   | 677.933 ms                | 1.554 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.436 ms                  | 52.116 ms                 |
| Forward                   | 6.381 ms                  | 8.332 ms                  |
| Backward                  | 652.150 ms                | 1.511 s                   |
| Optimize                  | 1.490 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.574 us                 | 247.875 ms                |
| BlockToStepN              | 9.604 us                  | 62.593 us                 |
| OneStep                   | 685.447 ms                | 1.554 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.435 ms                  | 52.116 ms                 |
| Forward                   | 6.382 ms                  | 8.332 ms                  |
| Backward                  | 659.043 ms                | 1.511 s                   |
| Optimize                  | 1.491 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.583 us                 | 266.937 ms                |
| BlockToStepN              | 9.621 us                  | 62.593 us                 |
| OneStep                   | 688.021 ms                | 1.598 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.435 ms                  | 52.116 ms                 |
| Forward                   | 6.382 ms                  | 8.332 ms                  |
| Backward                  | 667.819 ms                | 1.540 s                   |
| Optimize                  | 1.491 ms                  | 2.202 ms                  |
| BarrierTimeBeforeRank0    | 31.574 us                 | 266.937 ms                |
| BlockToStepN              | 9.657 us                  | 62.593 us                 |
| OneStep                   | 691.398 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 125.434, sample: 0.724, forward: 0.872, backward: 115.801, update: 0.178
[proc 0] 500 steps, total: 125.434, sample: 0.855, forward: 0.661, backward: 121.523, update: 0.153
Successfully xmh. training takes 350.58140993118286 seconds
before call kg_cache_controller.StopThreads()
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
INFO [20319 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
