WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 07:56:51.705001 33389 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_65', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [33389 sampler.py:454] Start PreSampling
WARNING [33389 sampler.py:532] Before construct renumbering_dict
WARNING [33389 sampler.py:555] PreSampling done
W20240124 08:10:42.044504 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 08:10:42.044692 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 08:10:42.044718 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 08:10:42.044742 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 08:10:42.044764 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 08:10:42.044781 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 08:10:42.044816 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 08:10:42.044848 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 08:10:42.044865 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 08:10:42.044883 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 08:10:42.044906 33389 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 08:10:42.044925 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 08:10:42.044940 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 08:10:42.045044 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 08:10:42.045070 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 08:10:42.045091 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 08:10:42.045125 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 08:10:42.045140 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 08:10:42.045158 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 08:10:42.045183 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 08:10:42.045203 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 08:10:42.045223 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 08:10:42.045239 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 08:10:42.045260 33389 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 08:10:42.045274 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 08:10:42.045291 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 08:10:42.045331 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 08:10:42.045351 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 08:10:42.045369 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 08:10:42.045384 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 08:10:42.045401 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 08:10:42.045428 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 08:10:42.045445 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 08:10:42.045461 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 08:10:42.045477 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 08:10:42.045497 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 08:10:42.045513 33389 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 08:10:42.045526 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 08:10:42.045538 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 08:10:42.045568 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 08:10:42.045588 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 08:10:42.045607 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 08:10:42.045624 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 08:10:42.045641 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 08:10:42.045660 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 08:10:42.045681 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 08:10:42.045697 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 08:10:42.045714 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 08:10:42.045734 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 08:10:42.045756 33389 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 08:10:42.045769 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 08:10:42.045784 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 08:10:42.045817 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 08:10:42.045845 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 08:10:42.045864 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 08:10:42.045881 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 08:10:42.045903 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 08:10:42.045920 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 08:10:42.045936 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 08:10:42.045955 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 08:10:42.045971 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 08:10:42.045987 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 08:10:42.046002 33389 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 08:10:42.046015 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 08:10:42.046028 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 08:10:42.046057 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 08:10:42.046082 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 08:10:42.046101 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 08:10:42.046123 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 08:10:42.046139 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 08:10:42.046154 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 08:10:42.046175 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 08:10:42.046204 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 08:10:42.046221 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 08:10:42.046241 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 08:10:42.046257 33389 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 08:10:42.046270 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 08:10:42.046283 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 08:10:42.046312 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 08:10:42.046336 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 08:10:42.046352 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 08:10:42.046373 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 08:10:42.046399 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 08:10:42.046415 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 08:10:42.046435 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 08:10:42.046451 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 08:10:42.046473 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 08:10:42.046489 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 08:10:42.046504 33389 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 08:10:42.046521 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 08:10:42.046535 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 08:10:42.046572 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 08:10:42.046591 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 08:10:42.046612 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 08:10:42.046629 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 08:10:42.046651 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 08:10:42.046676 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 08:10:42.046696 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 08:10:42.046713 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 08:10:42.046736 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 08:10:42.046753 33389 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 08:10:42.046774 33389 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 08:10:42.046788 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 08:10:42.046800 33389 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 08:10:42.476166 33389 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 08:10:42.476331 33389 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302714,  4302748,  4302795,  ..., 64157126, 22784313, 36220719]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1008.720 seconds
[Rank1] pid = 59051
[Rank2] pid = 59153
[Rank3] pid = 59235
[Rank4] pid = 59305
[Rank5] pid = 59450
[Rank6] pid = 59628
INFO [33389 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [59051 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [59153 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [59235 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [59450 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [59305 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [59628 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [59628 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59805 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [59628 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59805 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59450 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59305 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59628 cache_common.py:137] TorchNativeStdEmb construct done
INFO [59805 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
WARNING [59628 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [59450 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59305 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59805 cache_common.py:137] TorchNativeStdEmb construct done
INFO [59305 cache_common.py:137] TorchNativeStdEmb construct done
INFO [59450 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [59805 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [59305 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [59450 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [59153 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59235 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [33389 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59051 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59153 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59235 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59051 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [33389 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([86054151, 400])
INFO [59153 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [59153 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [59235 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [59235 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [33389 cache_common.py:137] TorchNativeStdEmb construct done
INFO [59051 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [59051 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [33389 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 08:13:48.804721 59629 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.804946 59052 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.805167 59869 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.805295 59306 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.805425 59451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.805573 59154 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.805703 59236 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:48.806042 59806 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:13:55.157531 59869 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 08:13:55.217145 59451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:56.487102 59154 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:57.280968 59629 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:57.319243 59052 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:57.412832 59236 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:58.097687 59306 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:13:58.112524 59806 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.051 ms                 | 21.051 ms                 |
| Forward                   | 592.805 ms                | 592.805 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.681 ms                  | 149.498 ms                |
| Forward                   | 8.404 ms                  | 592.805 ms                |
| Backward                  | 84.189 ms                 | 201.038 ms                |
| Optimize                  | 1.859 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 10.081 ms                 | 157.210 ms                |
| BlockToStepN              | 15.316 us                 | 1.647 ms                  |
| OneStep                   | 129.029 ms                | 834.035 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.458 ms                  | 113.180 ms                |
| Forward                   | 8.433 ms                  | 12.681 ms                 |
| Backward                  | 124.283 ms                | 222.115 ms                |
| Optimize                  | 1.864 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.982 ms                  | 145.273 ms                |
| BlockToStepN              | 14.749 us                 | 1.492 ms                  |
| OneStep                   | 166.299 ms                | 434.345 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.070 ms                  | 113.180 ms                |
| Forward                   | 8.433 ms                  | 12.681 ms                 |
| Backward                  | 159.848 ms                | 289.587 ms                |
| Optimize                  | 1.818 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.351 ms                  | 145.273 ms                |
| BlockToStepN              | 12.654 us                 | 1.647 ms                  |
| OneStep                   | 201.197 ms                | 468.793 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 113.180 ms                |
| Forward                   | 8.454 ms                  | 12.681 ms                 |
| Backward                  | 182.031 ms                | 345.053 ms                |
| Optimize                  | 1.818 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.567 ms                  | 145.273 ms                |
| BlockToStepN              | 12.946 us                 | 7.819 ms                  |
| OneStep                   | 217.626 ms                | 503.100 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 113.180 ms                |
| Forward                   | 8.466 ms                  | 12.681 ms                 |
| Backward                  | 201.392 ms                | 410.072 ms                |
| Optimize                  | 1.818 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.680 ms                  | 157.210 ms                |
| BlockToStepN              | 14.183 us                 | 7.819 ms                  |
| OneStep                   | 230.207 ms                | 572.648 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 26.952, sample: 1.444, forward: 2.100, backward: 19.687, update: 0.181
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.016, sample: 1.231, forward: 2.123, backward: 20.022, update: 0.169
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.076, sample: 1.071, forward: 2.067, backward: 19.725, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 26.136, sample: 2.010, forward: 1.983, backward: 19.573, update: 0.196
[Rank7] pid = 59805
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([  523615,    46747,   408037, 16610510,    46776,    46803,   523625,
           46833,    46847,    46880]) tensor([ 5380106, 12846313, 60471813, 62231179, 22955589,   295033, 15317669,
        65615020, 59647910, 41210272])
-------Step 1-------
tensor([  523615,    46747,   408037, 16610510,    46776,    46803,   523625,
           46833,    46847,    46880]) tensor([84629325, 25759123, 40169135, 41800455, 42097144, 15385606, 38114164,
          601102, 27567536, 46555688])
-------Step 2-------
tensor([   16538,   329034,   367789, 18120544,    93670,    93684,    93711,
           93734,    93757,    93783]) tensor([58813288, 26826981,  1337487, 31657234, 18775241, 19791044,  8183289,
        70752628, 72619003, 32050940])
-------Step 3-------
tensor([   16538,   329034,   367789, 18120544,    93670,    93684,    93711,
           93734,    93757,    93783]) tensor([16406446, 64846249, 81808440, 39106768, 82706582, 79718352, 70137140,
        29014370, 65636865, 12176921])
-------Step 4-------
tensor([  141456,   141483,   141502, 72389671,   141531,   141545,   141585,
          141601,   141619, 27613054]) tensor([76313442, 45148074, 82401282, 29978271,   346171,  4333029, 28221589,
        42417799, 59024130, 11951567])
-------Step 5-------
tensor([  141456,   141483,   141502, 72389671,   141531,   141545,   141585,
          141601,   141619, 27613054]) tensor([51446001, 48743037, 36400651,    41713, 72079702, 48129028, 48081629,
         1523037, 65188752, 29608102])
-------Step 6-------
tensor([ 7441331,  5851028,   187970, 28558203,   187995,   188018, 78822012,
        45163008,   188043,   188063]) tensor([39992670,   177374, 40848044, 19214835, 24763973, 29712218, 20638429,
        72987138, 76415332, 64367628])
-------Step 7-------
tensor([ 7441331,  5851028,   187970, 28558203,   187995,   188018, 78822012,
        45163008,   188043,   188063]) tensor([21452627,  8263449, 28178722, 13089850, 48638492, 45198386,  4320365,
        17158162, 44155788, 67177535])
-------Step 8-------
tensor([  237862,   237885, 80630598,   237913,   367162,   367196, 11001512,
          237931,   237954,   374815]) tensor([19384203, 25874493, 53665609,  5274702, 78869922,  6101215,  5223149,
        16018637, 69507611,  6044370])
-------Step 9-------
tensor([  237862,   237885, 80630598,   237913,   367162,   367196, 11001512,
          237931,   237954,   374815]) tensor([65444937, 29410239, 45061478, 74992317, 38348184, 54676391, 62331873,
        16613485, 14126203,  6199033])
before start barrier
start train
[proc 0] 100 steps, total: 26.121, sample: 1.413, forward: 1.436, backward: 20.621, update: 0.176
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.821, sample: 0.990, forward: 2.069, backward: 20.825, update: 0.174
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.746, sample: 1.093, forward: 2.010, backward: 20.200, update: 0.179
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.914, sample: 1.714, forward: 2.099, backward: 20.200, update: 0.171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 113.180 ms                |
| Forward                   | 8.470 ms                  | 12.681 ms                 |
| Backward                  | 220.669 ms                | 421.062 ms                |
| Optimize                  | 1.818 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 157.210 ms                |
| BlockToStepN              | 15.316 us                 | 7.819 ms                  |
| OneStep                   | 260.721 ms                | 587.111 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.826 ms                  | 113.180 ms                |
| Forward                   | 8.468 ms                  | 12.681 ms                 |
| Backward                  | 234.885 ms                | 464.317 ms                |
| Optimize                  | 1.814 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 157.210 ms                |
| BlockToStepN              | 14.183 us                 | 7.819 ms                  |
| OneStep                   | 273.671 ms                | 593.351 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.422 ms                  | 113.180 ms                |
| Forward                   | 8.468 ms                  | 12.681 ms                 |
| Backward                  | 245.880 ms                | 508.552 ms                |
| Optimize                  | 1.818 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.680 ms                  | 157.210 ms                |
| BlockToStepN              | 14.183 us                 | 7.819 ms                  |
| OneStep                   | 290.764 ms                | 593.351 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.422 ms                  | 113.180 ms                |
| Forward                   | 8.470 ms                  | 12.681 ms                 |
| Backward                  | 269.063 ms                | 650.944 ms                |
| Optimize                  | 1.820 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.809 ms                  | 180.340 ms                |
| BlockToStepN              | 14.749 us                 | 12.941 ms                 |
| OneStep                   | 328.264 ms                | 807.418 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.397 ms                  | 113.180 ms                |
| Forward                   | 8.483 ms                  | 12.681 ms                 |
| Backward                  | 289.407 ms                | 650.944 ms                |
| Optimize                  | 1.830 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 193.123 ms                |
| BlockToStepN              | 15.676 us                 | 16.075 ms                 |
| OneStep                   | 333.539 ms                | 807.418 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.422 ms                  | 105.431 ms                |
| Forward                   | 8.470 ms                  | 12.064 ms                 |
| Backward                  | 305.804 ms                | 603.408 ms                |
| Optimize                  | 1.830 ms                  | 2.616 ms                  |
| BarrierTimeBeforeRank0    | 9.071 ms                  | 189.603 ms                |
| BlockToStepN              | 16.556 us                 | 12.941 ms                 |
| OneStep                   | 356.010 ms                | 756.980 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.422 ms                  | 105.431 ms                |
| Forward                   | 8.470 ms                  | 12.064 ms                 |
| Backward                  | 320.785 ms                | 621.744 ms                |
| Optimize                  | 1.830 ms                  | 2.616 ms                  |
| BarrierTimeBeforeRank0    | 8.809 ms                  | 189.603 ms                |
| BlockToStepN              | 15.676 us                 | 12.941 ms                 |
| OneStep                   | 363.809 ms                | 756.980 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.614 ms                  | 105.431 ms                |
| Forward                   | 8.486 ms                  | 12.064 ms                 |
| Backward                  | 336.540 ms                | 685.821 ms                |
| Optimize                  | 1.836 ms                  | 2.695 ms                  |
| BarrierTimeBeforeRank0    | 8.640 ms                  | 189.603 ms                |
| BlockToStepN              | 15.676 us                 | 12.941 ms                 |
| OneStep                   | 384.136 ms                | 790.110 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.614 ms                  | 105.431 ms                |
| Forward                   | 8.495 ms                  | 12.681 ms                 |
| Backward                  | 345.053 ms                | 685.821 ms                |
| Optimize                  | 1.835 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.680 ms                  | 193.123 ms                |
| BlockToStepN              | 15.562 us                 | 12.941 ms                 |
| OneStep                   | 418.548 ms                | 807.418 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.614 ms                  | 105.431 ms                |
| Forward                   | 8.492 ms                  | 12.681 ms                 |
| Backward                  | 352.483 ms                | 689.938 ms                |
| Optimize                  | 1.835 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.809 ms                  | 266.082 ms                |
| BlockToStepN              | 15.676 us                 | 12.941 ms                 |
| OneStep                   | 436.787 ms                | 939.869 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.614 ms                  | 105.431 ms                |
| Forward                   | 8.486 ms                  | 12.681 ms                 |
| Backward                  | 367.215 ms                | 729.975 ms                |
| Optimize                  | 1.830 ms                  | 2.781 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 266.082 ms                |
| BlockToStepN              | 16.286 us                 | 12.941 ms                 |
| OneStep                   | 443.645 ms                | 993.734 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.670 ms                  | 105.431 ms                |
| Forward                   | 8.501 ms                  | 12.983 ms                 |
| Backward                  | 382.246 ms                | 756.173 ms                |
| Optimize                  | 1.836 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 266.082 ms                |
| BlockToStepN              | 16.556 us                 | 12.941 ms                 |
| OneStep                   | 447.724 ms                | 993.734 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.826 ms                  | 105.431 ms                |
| Forward                   | 8.501 ms                  | 12.983 ms                 |
| Backward                  | 393.229 ms                | 765.401 ms                |
| Optimize                  | 1.837 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 8.968 ms                  | 266.082 ms                |
| BlockToStepN              | 16.409 us                 | 12.941 ms                 |
| OneStep                   | 451.462 ms                | 993.734 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 64.773, sample: 1.685, forward: 1.354, backward: 58.083, update: 0.169
[proc 5] 200 steps, total: 64.773, sample: 1.458, forward: 1.387, backward: 56.194, update: 0.177
[proc 4] 200 steps, total: 64.773, sample: 1.778, forward: 1.306, backward: 55.645, update: 0.190
[proc 6] 200 steps, total: 64.773, sample: 1.741, forward: 1.348, backward: 56.537, update: 0.181
[proc 7] 200 steps, total: 64.773, sample: 0.829, forward: 1.329, backward: 55.165, update: 0.191
[proc 2] 200 steps, total: 64.773, sample: 1.074, forward: 1.285, backward: 56.228, update: 0.178
[proc 0] 200 steps, total: 64.773, sample: 1.171, forward: 0.864, backward: 58.283, update: 0.184
[proc 1] 200 steps, total: 64.773, sample: 1.510, forward: 1.330, backward: 57.353, update: 0.180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.826 ms                  | 105.431 ms                |
| Forward                   | 8.501 ms                  | 12.983 ms                 |
| Backward                  | 405.332 ms                | 769.785 ms                |
| Optimize                  | 1.836 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.071 ms                  | 266.082 ms                |
| BlockToStepN              | 16.556 us                 | 12.941 ms                 |
| OneStep                   | 458.092 ms                | 1.023 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.826 ms                  | 105.431 ms                |
| Forward                   | 8.502 ms                  | 12.983 ms                 |
| Backward                  | 410.072 ms                | 807.901 ms                |
| Optimize                  | 1.836 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.071 ms                  | 266.082 ms                |
| BlockToStepN              | 17.003 us                 | 12.941 ms                 |
| OneStep                   | 468.431 ms                | 1.023 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.505 ms                  | 12.983 ms                 |
| Backward                  | 417.531 ms                | 969.267 ms                |
| Optimize                  | 1.837 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.071 ms                  | 291.384 ms                |
| BlockToStepN              | 17.010 us                 | 12.941 ms                 |
| OneStep                   | 471.079 ms                | 1.097 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.512 ms                  | 12.983 ms                 |
| Backward                  | 426.786 ms                | 969.267 ms                |
| Optimize                  | 1.842 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.220 ms                  | 291.384 ms                |
| BlockToStepN              | 17.114 us                 | 12.941 ms                 |
| OneStep                   | 490.011 ms                | 1.097 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.506 ms                  | 12.983 ms                 |
| Backward                  | 433.947 ms                | 969.267 ms                |
| Optimize                  | 1.846 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.367 ms                  | 291.384 ms                |
| BlockToStepN              | 17.010 us                 | 12.941 ms                 |
| OneStep                   | 499.123 ms                | 1.097 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.506 ms                  | 12.983 ms                 |
| Backward                  | 450.122 ms                | 969.267 ms                |
| Optimize                  | 1.846 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.483 ms                  | 354.061 ms                |
| BlockToStepN              | 17.003 us                 | 12.941 ms                 |
| OneStep                   | 502.652 ms                | 1.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.512 ms                  | 12.983 ms                 |
| Backward                  | 455.867 ms                | 1.094 s                   |
| Optimize                  | 1.846 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.367 ms                  | 354.061 ms                |
| BlockToStepN              | 17.003 us                 | 12.941 ms                 |
| OneStep                   | 504.348 ms                | 1.211 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.519 ms                  | 12.983 ms                 |
| Backward                  | 474.594 ms                | 1.094 s                   |
| Optimize                  | 1.853 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.419 ms                  | 354.061 ms                |
| BlockToStepN              | 17.010 us                 | 12.941 ms                 |
| OneStep                   | 506.221 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 105.431 ms                |
| Forward                   | 8.523 ms                  | 12.983 ms                 |
| Backward                  | 483.727 ms                | 1.094 s                   |
| Optimize                  | 1.847 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.483 ms                  | 387.823 ms                |
| BlockToStepN              | 17.114 us                 | 12.941 ms                 |
| OneStep                   | 523.103 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.062 ms                  | 85.488 ms                 |
| Forward                   | 8.523 ms                  | 12.681 ms                 |
| Backward                  | 489.481 ms                | 1.094 s                   |
| Optimize                  | 1.847 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 9.483 ms                  | 541.684 ms                |
| BlockToStepN              | 17.481 us                 | 12.941 ms                 |
| OneStep                   | 528.178 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 85.488 ms                 |
| Forward                   | 8.526 ms                  | 12.681 ms                 |
| Backward                  | 494.615 ms                | 1.115 s                   |
| Optimize                  | 1.853 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 9.707 ms                  | 387.823 ms                |
| BlockToStepN              | 17.599 us                 | 7.819 ms                  |
| OneStep                   | 531.305 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.008 ms                  | 85.488 ms                 |
| Forward                   | 8.530 ms                  | 12.681 ms                 |
| Backward                  | 508.552 ms                | 1.115 s                   |
| Optimize                  | 1.855 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.349 ms                 | 387.823 ms                |
| BlockToStepN              | 17.613 us                 | 7.819 ms                  |
| OneStep                   | 555.315 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 85.488 ms                 |
| Forward                   | 8.526 ms                  | 12.681 ms                 |
| Backward                  | 519.318 ms                | 1.115 s                   |
| Optimize                  | 1.855 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.460 ms                 | 387.823 ms                |
| BlockToStepN              | 17.771 us                 | 7.819 ms                  |
| OneStep                   | 560.443 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.062 ms                  | 85.488 ms                 |
| Forward                   | 8.530 ms                  | 12.681 ms                 |
| Backward                  | 524.735 ms                | 1.115 s                   |
| Optimize                  | 1.855 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.441 ms                 | 387.823 ms                |
| BlockToStepN              | 17.771 us                 | 7.819 ms                  |
| OneStep                   | 585.708 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 85.488 ms                 |
| Forward                   | 8.532 ms                  | 12.681 ms                 |
| Backward                  | 532.723 ms                | 1.276 s                   |
| Optimize                  | 1.857 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.441 ms                 | 387.823 ms                |
| BlockToStepN              | 17.771 us                 | 7.819 ms                  |
| OneStep                   | 593.351 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.062 ms                  | 85.488 ms                 |
| Forward                   | 8.533 ms                  | 12.681 ms                 |
| Backward                  | 536.777 ms                | 1.276 s                   |
| Optimize                  | 1.859 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.441 ms                 | 387.823 ms                |
| BlockToStepN              | 18.089 us                 | 7.819 ms                  |
| OneStep                   | 596.548 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.538 ms                  | 12.681 ms                 |
| Backward                  | 541.875 ms                | 1.276 s                   |
| Optimize                  | 1.861 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.682 ms                 | 387.823 ms                |
| BlockToStepN              | 18.089 us                 | 7.819 ms                  |
| OneStep                   | 609.498 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.544 ms                  | 12.681 ms                 |
| Backward                  | 542.594 ms                | 1.276 s                   |
| Optimize                  | 1.864 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.687 ms                 | 387.823 ms                |
| BlockToStepN              | 18.428 us                 | 7.819 ms                  |
| OneStep                   | 614.535 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.062 ms                  | 85.488 ms                 |
| Forward                   | 8.544 ms                  | 12.681 ms                 |
| Backward                  | 552.862 ms                | 1.313 s                   |
| Optimize                  | 1.868 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.682 ms                 | 387.823 ms                |
| BlockToStepN              | 18.583 us                 | 7.819 ms                  |
| OneStep                   | 624.262 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 85.488 ms                 |
| Forward                   | 8.545 ms                  | 12.681 ms                 |
| Backward                  | 564.991 ms                | 1.313 s                   |
| Optimize                  | 1.868 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.682 ms                 | 387.823 ms                |
| BlockToStepN              | 18.821 us                 | 7.819 ms                  |
| OneStep                   | 631.469 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.549 ms                  | 12.681 ms                 |
| Backward                  | 566.157 ms                | 1.313 s                   |
| Optimize                  | 1.868 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.682 ms                 | 387.823 ms                |
| BlockToStepN              | 18.671 us                 | 7.819 ms                  |
| OneStep                   | 636.353 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 108.731, sample: 1.359, forward: 1.248, backward: 93.352, update: 0.186
[proc 7] 300 steps, total: 108.731, sample: 0.784, forward: 1.286, backward: 91.048, update: 0.193
[proc 4] 300 steps, total: 108.731, sample: 1.253, forward: 1.216, backward: 92.274, update: 0.207
[proc 5] 300 steps, total: 108.731, sample: 1.146, forward: 1.291, backward: 94.161, update: 0.181
[proc 2] 300 steps, total: 108.731, sample: 0.944, forward: 1.247, backward: 93.905, update: 0.192
[proc 3] 300 steps, total: 108.731, sample: 1.407, forward: 1.297, backward: 97.039, update: 0.175
[proc 1] 300 steps, total: 108.731, sample: 1.186, forward: 1.253, backward: 94.417, update: 0.172
[proc 0] 300 steps, total: 108.731, sample: 1.055, forward: 0.878, backward: 97.667, update: 0.183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.549 ms                  | 12.681 ms                 |
| Backward                  | 572.955 ms                | 1.313 s                   |
| Optimize                  | 1.869 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.687 ms                 | 387.823 ms                |
| BlockToStepN              | 18.838 us                 | 7.819 ms                  |
| OneStep                   | 642.429 ms                | 1.491 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.557 ms                  | 12.681 ms                 |
| Backward                  | 592.118 ms                | 1.377 s                   |
| Optimize                  | 1.870 ms                  | 2.833 ms                  |
| BarrierTimeBeforeRank0    | 10.740 ms                 | 387.823 ms                |
| BlockToStepN              | 19.654 us                 | 7.819 ms                  |
| OneStep                   | 663.903 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.064 ms                  | 85.488 ms                 |
| Forward                   | 8.557 ms                  | 12.681 ms                 |
| Backward                  | 601.330 ms                | 1.378 s                   |
| Optimize                  | 1.871 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.741 ms                 | 495.046 ms                |
| BlockToStepN              | 19.815 us                 | 7.819 ms                  |
| OneStep                   | 671.941 ms                | 1.559 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.108 ms                  | 85.488 ms                 |
| Forward                   | 8.557 ms                  | 12.681 ms                 |
| Backward                  | 611.142 ms                | 1.378 s                   |
| Optimize                  | 1.872 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.910 ms                 | 495.046 ms                |
| BlockToStepN              | 19.654 us                 | 7.819 ms                  |
| OneStep                   | 679.649 ms                | 1.559 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.084 ms                  | 85.488 ms                 |
| Forward                   | 8.557 ms                  | 12.681 ms                 |
| Backward                  | 616.311 ms                | 1.378 s                   |
| Optimize                  | 1.872 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.974 ms                 | 495.046 ms                |
| BlockToStepN              | 19.815 us                 | 7.819 ms                  |
| OneStep                   | 685.861 ms                | 1.576 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.108 ms                  | 85.488 ms                 |
| Forward                   | 8.563 ms                  | 12.681 ms                 |
| Backward                  | 619.891 ms                | 1.474 s                   |
| Optimize                  | 1.872 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.967 ms                 | 495.046 ms                |
| BlockToStepN              | 19.854 us                 | 7.819 ms                  |
| OneStep                   | 687.563 ms                | 1.599 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.108 ms                  | 85.488 ms                 |
| Forward                   | 8.564 ms                  | 12.681 ms                 |
| Backward                  | 622.386 ms                | 1.537 s                   |
| Optimize                  | 1.873 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.967 ms                 | 495.046 ms                |
| BlockToStepN              | 19.815 us                 | 7.819 ms                  |
| OneStep                   | 692.555 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.084 ms                  | 85.488 ms                 |
| Forward                   | 8.566 ms                  | 12.681 ms                 |
| Backward                  | 638.955 ms                | 1.537 s                   |
| Optimize                  | 1.873 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.087 ms                 | 495.046 ms                |
| BlockToStepN              | 20.483 us                 | 8.617 ms                  |
| OneStep                   | 698.195 ms                | 1.624 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.108 ms                  | 85.488 ms                 |
| Forward                   | 8.564 ms                  | 12.681 ms                 |
| Backward                  | 643.078 ms                | 1.537 s                   |
| Optimize                  | 1.873 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.087 ms                 | 497.504 ms                |
| BlockToStepN              | 20.540 us                 | 8.617 ms                  |
| OneStep                   | 703.020 ms                | 1.642 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.309 ms                  | 85.488 ms                 |
| Forward                   | 8.566 ms                  | 12.681 ms                 |
| Backward                  | 644.282 ms                | 1.537 s                   |
| Optimize                  | 1.873 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.087 ms                 | 497.504 ms                |
| BlockToStepN              | 19.854 us                 | 8.617 ms                  |
| OneStep                   | 733.649 ms                | 1.642 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.310 ms                  | 85.488 ms                 |
| Forward                   | 8.572 ms                  | 12.681 ms                 |
| Backward                  | 650.944 ms                | 1.546 s                   |
| Optimize                  | 1.873 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 10.974 ms                 | 497.504 ms                |
| BlockToStepN              | 19.815 us                 | 8.617 ms                  |
| OneStep                   | 737.880 ms                | 1.658 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.355 ms                  | 85.488 ms                 |
| Forward                   | 8.572 ms                  | 12.681 ms                 |
| Backward                  | 651.215 ms                | 1.546 s                   |
| Optimize                  | 1.874 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.087 ms                 | 497.504 ms                |
| BlockToStepN              | 19.854 us                 | 8.617 ms                  |
| OneStep                   | 744.554 ms                | 1.704 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.414 ms                  | 85.488 ms                 |
| Forward                   | 8.576 ms                  | 12.681 ms                 |
| Backward                  | 655.222 ms                | 1.546 s                   |
| Optimize                  | 1.874 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.122 ms                 | 497.504 ms                |
| BlockToStepN              | 19.854 us                 | 8.617 ms                  |
| OneStep                   | 749.628 ms                | 1.704 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.414 ms                  | 85.488 ms                 |
| Forward                   | 8.579 ms                  | 12.681 ms                 |
| Backward                  | 658.176 ms                | 1.546 s                   |
| Optimize                  | 1.874 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 541.684 ms                |
| BlockToStepN              | 20.483 us                 | 8.617 ms                  |
| OneStep                   | 753.584 ms                | 1.704 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.414 ms                  | 85.488 ms                 |
| Forward                   | 8.583 ms                  | 12.681 ms                 |
| Backward                  | 663.121 ms                | 1.610 s                   |
| Optimize                  | 1.874 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 541.684 ms                |
| BlockToStepN              | 20.540 us                 | 8.617 ms                  |
| OneStep                   | 755.988 ms                | 1.758 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.426 ms                  | 84.196 ms                 |
| Forward                   | 8.587 ms                  | 12.215 ms                 |
| Backward                  | 672.910 ms                | 1.610 s                   |
| Optimize                  | 1.874 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 497.504 ms                |
| BlockToStepN              | 20.540 us                 | 7.819 ms                  |
| OneStep                   | 756.084 ms                | 1.758 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.414 ms                  | 84.196 ms                 |
| Forward                   | 8.598 ms                  | 12.215 ms                 |
| Backward                  | 689.636 ms                | 1.610 s                   |
| Optimize                  | 1.874 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 497.504 ms                |
| BlockToStepN              | 20.540 us                 | 7.819 ms                  |
| OneStep                   | 758.314 ms                | 1.759 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.426 ms                  | 84.196 ms                 |
| Forward                   | 8.599 ms                  | 12.215 ms                 |
| Backward                  | 689.938 ms                | 1.610 s                   |
| Optimize                  | 1.874 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 497.504 ms                |
| BlockToStepN              | 20.540 us                 | 7.819 ms                  |
| OneStep                   | 759.934 ms                | 1.781 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.537 ms                  | 84.196 ms                 |
| Forward                   | 8.603 ms                  | 12.215 ms                 |
| Backward                  | 700.950 ms                | 1.626 s                   |
| Optimize                  | 1.875 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 497.504 ms                |
| BlockToStepN              | 20.748 us                 | 7.819 ms                  |
| OneStep                   | 768.288 ms                | 1.796 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.541 ms                  | 84.196 ms                 |
| Forward                   | 8.604 ms                  | 12.215 ms                 |
| Backward                  | 704.277 ms                | 1.626 s                   |
| Optimize                  | 1.877 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.223 ms                 | 541.684 ms                |
| BlockToStepN              | 20.748 us                 | 7.819 ms                  |
| OneStep                   | 768.516 ms                | 1.825 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.537 ms                  | 84.196 ms                 |
| Forward                   | 8.605 ms                  | 12.215 ms                 |
| Backward                  | 707.195 ms                | 1.626 s                   |
| Optimize                  | 1.878 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.246 ms                 | 541.684 ms                |
| BlockToStepN              | 20.748 us                 | 7.819 ms                  |
| OneStep                   | 776.300 ms                | 1.825 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.541 ms                  | 84.196 ms                 |
| Forward                   | 8.614 ms                  | 12.215 ms                 |
| Backward                  | 724.042 ms                | 1.626 s                   |
| Optimize                  | 1.878 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.550 ms                 | 560.936 ms                |
| BlockToStepN              | 21.106 us                 | 7.819 ms                  |
| OneStep                   | 780.809 ms                | 1.868 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.541 ms                  | 84.196 ms                 |
| Forward                   | 8.614 ms                  | 12.681 ms                 |
| Backward                  | 727.754 ms                | 1.687 s                   |
| Optimize                  | 1.879 ms                  | 2.891 ms                  |
| BarrierTimeBeforeRank0    | 11.550 ms                 | 560.936 ms                |
| BlockToStepN              | 21.262 us                 | 7.819 ms                  |
| OneStep                   | 790.110 ms                | 1.869 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.604 ms                  | 84.196 ms                 |
| Forward                   | 8.618 ms                  | 12.681 ms                 |
| Backward                  | 729.975 ms                | 1.687 s                   |
| Optimize                  | 1.879 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.626 ms                 | 560.936 ms                |
| BlockToStepN              | 21.279 us                 | 7.819 ms                  |
| OneStep                   | 791.007 ms                | 1.869 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.604 ms                  | 84.196 ms                 |
| Forward                   | 8.618 ms                  | 12.681 ms                 |
| Backward                  | 738.771 ms                | 1.687 s                   |
| Optimize                  | 1.882 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.651 ms                 | 560.936 ms                |
| BlockToStepN              | 21.782 us                 | 7.819 ms                  |
| OneStep                   | 795.703 ms                | 1.892 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.644 ms                  | 84.196 ms                 |
| Forward                   | 8.618 ms                  | 12.681 ms                 |
| Backward                  | 741.827 ms                | 1.687 s                   |
| Optimize                  | 1.879 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.651 ms                 | 568.723 ms                |
| BlockToStepN              | 22.006 us                 | 7.819 ms                  |
| OneStep                   | 798.255 ms                | 1.904 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.644 ms                  | 84.196 ms                 |
| Forward                   | 8.623 ms                  | 12.681 ms                 |
| Backward                  | 742.519 ms                | 1.687 s                   |
| Optimize                  | 1.883 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.651 ms                 | 568.723 ms                |
| BlockToStepN              | 22.006 us                 | 7.819 ms                  |
| OneStep                   | 805.561 ms                | 1.936 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.644 ms                  | 84.196 ms                 |
| Forward                   | 8.629 ms                  | 12.681 ms                 |
| Backward                  | 744.091 ms                | 1.687 s                   |
| Optimize                  | 1.883 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.958 ms                 | 568.723 ms                |
| BlockToStepN              | 22.277 us                 | 7.819 ms                  |
| OneStep                   | 818.898 ms                | 1.940 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.662 ms                  | 84.196 ms                 |
| Forward                   | 8.644 ms                  | 12.681 ms                 |
| Backward                  | 744.479 ms                | 1.687 s                   |
| Optimize                  | 1.883 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.958 ms                 | 568.723 ms                |
| BlockToStepN              | 22.277 us                 | 7.819 ms                  |
| OneStep                   | 821.338 ms                | 1.955 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.662 ms                  | 84.196 ms                 |
| Forward                   | 8.635 ms                  | 12.681 ms                 |
| Backward                  | 748.080 ms                | 1.687 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 12.010 ms                 | 568.723 ms                |
| BlockToStepN              | 22.829 us                 | 7.819 ms                  |
| OneStep                   | 827.991 ms                | 1.956 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.822 ms                  | 84.196 ms                 |
| Forward                   | 8.644 ms                  | 12.681 ms                 |
| Backward                  | 754.731 ms                | 1.743 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 11.958 ms                 | 568.723 ms                |
| BlockToStepN              | 23.985 us                 | 7.819 ms                  |
| OneStep                   | 829.605 ms                | 2.018 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.753 ms                  | 84.196 ms                 |
| Forward                   | 8.644 ms                  | 12.681 ms                 |
| Backward                  | 759.431 ms                | 1.743 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 12.010 ms                 | 568.723 ms                |
| BlockToStepN              | 23.985 us                 | 7.819 ms                  |
| OneStep                   | 838.185 ms                | 2.018 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 157.431, sample: 1.127, forward: 1.221, backward: 131.272, update: 0.206
[proc 7] 400 steps, total: 157.431, sample: 0.912, forward: 1.300, backward: 129.537, update: 0.199
[proc 6] 400 steps, total: 157.431, sample: 1.150, forward: 1.249, backward: 133.149, update: 0.195
[proc 3] 400 steps, total: 157.430, sample: 1.284, forward: 1.443, backward: 137.122, update: 0.217
[proc 5] 400 steps, total: 157.430, sample: 1.081, forward: 1.306, backward: 132.158, update: 0.200
[proc 1] 400 steps, total: 157.430, sample: 1.027, forward: 1.459, backward: 133.161, update: 0.189
[proc 2] 400 steps, total: 157.430, sample: 1.044, forward: 1.313, backward: 132.657, update: 0.206
[proc 0] 400 steps, total: 157.430, sample: 1.122, forward: 0.929, backward: 136.701, update: 0.191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.753 ms                  | 84.196 ms                 |
| Forward                   | 8.644 ms                  | 12.681 ms                 |
| Backward                  | 765.401 ms                | 1.743 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 12.012 ms                 | 568.723 ms                |
| BlockToStepN              | 24.400 us                 | 7.819 ms                  |
| OneStep                   | 850.607 ms                | 2.026 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.822 ms                  | 84.196 ms                 |
| Forward                   | 8.646 ms                  | 12.681 ms                 |
| Backward                  | 767.291 ms                | 1.743 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 12.010 ms                 | 568.723 ms                |
| BlockToStepN              | 24.400 us                 | 7.819 ms                  |
| OneStep                   | 851.097 ms                | 2.028 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.822 ms                  | 84.196 ms                 |
| Forward                   | 8.647 ms                  | 12.983 ms                 |
| Backward                  | 772.127 ms                | 1.772 s                   |
| Optimize                  | 1.884 ms                  | 3.035 ms                  |
| BarrierTimeBeforeRank0    | 12.012 ms                 | 568.723 ms                |
| BlockToStepN              | 24.553 us                 | 7.819 ms                  |
| OneStep                   | 858.142 ms                | 2.041 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.827 ms                  | 84.196 ms                 |
| Forward                   | 8.649 ms                  | 12.983 ms                 |
| Backward                  | 781.383 ms                | 1.784 s                   |
| Optimize                  | 1.886 ms                  | 3.195 ms                  |
| BarrierTimeBeforeRank0    | 12.010 ms                 | 570.735 ms                |
| BlockToStepN              | 24.605 us                 | 7.819 ms                  |
| OneStep                   | 861.014 ms                | 2.050 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.827 ms                  | 84.196 ms                 |
| Forward                   | 8.649 ms                  | 12.983 ms                 |
| Backward                  | 793.166 ms                | 1.784 s                   |
| Optimize                  | 1.884 ms                  | 3.195 ms                  |
| BarrierTimeBeforeRank0    | 12.012 ms                 | 570.735 ms                |
| BlockToStepN              | 24.605 us                 | 7.819 ms                  |
| OneStep                   | 870.211 ms                | 2.101 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.822 ms                  | 84.196 ms                 |
| Forward                   | 8.649 ms                  | 12.983 ms                 |
| Backward                  | 803.665 ms                | 1.784 s                   |
| Optimize                  | 1.884 ms                  | 3.195 ms                  |
| BarrierTimeBeforeRank0    | 12.222 ms                 | 573.810 ms                |
| BlockToStepN              | 24.652 us                 | 12.941 ms                 |
| OneStep                   | 882.822 ms                | 2.106 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.822 ms                  | 84.196 ms                 |
| Forward                   | 8.650 ms                  | 12.983 ms                 |
| Backward                  | 806.455 ms                | 1.873 s                   |
| Optimize                  | 1.886 ms                  | 3.195 ms                  |
| BarrierTimeBeforeRank0    | 12.222 ms                 | 573.810 ms                |
| BlockToStepN              | 24.758 us                 | 12.941 ms                 |
| OneStep                   | 884.565 ms                | 2.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.864 ms                  | 84.196 ms                 |
| Forward                   | 8.666 ms                  | 12.983 ms                 |
| Backward                  | 807.901 ms                | 1.873 s                   |
| Optimize                  | 1.886 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 12.222 ms                 | 573.810 ms                |
| BlockToStepN              | 25.062 us                 | 12.941 ms                 |
| OneStep                   | 886.220 ms                | 2.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.864 ms                  | 84.196 ms                 |
| Forward                   | 8.666 ms                  | 12.983 ms                 |
| Backward                  | 816.876 ms                | 1.873 s                   |
| Optimize                  | 1.886 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 12.601 ms                 | 573.810 ms                |
| BlockToStepN              | 25.062 us                 | 12.941 ms                 |
| OneStep                   | 888.953 ms                | 2.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.864 ms                  | 84.196 ms                 |
| Forward                   | 8.667 ms                  | 12.983 ms                 |
| Backward                  | 819.354 ms                | 1.873 s                   |
| Optimize                  | 1.886 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 12.843 ms                 | 591.483 ms                |
| BlockToStepN              | 25.099 us                 | 12.941 ms                 |
| OneStep                   | 902.544 ms                | 2.115 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.894 ms                  | 84.196 ms                 |
| Forward                   | 8.680 ms                  | 14.312 ms                 |
| Backward                  | 824.142 ms                | 1.994 s                   |
| Optimize                  | 1.887 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 12.694 ms                 | 591.483 ms                |
| BlockToStepN              | 25.062 us                 | 12.941 ms                 |
| OneStep                   | 920.973 ms                | 2.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.680 ms                  | 14.312 ms                 |
| Backward                  | 826.380 ms                | 2.023 s                   |
| Optimize                  | 1.892 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 12.843 ms                 | 591.483 ms                |
| BlockToStepN              | 25.099 us                 | 12.941 ms                 |
| OneStep                   | 922.393 ms                | 2.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.894 ms                  | 84.196 ms                 |
| Forward                   | 8.692 ms                  | 14.312 ms                 |
| Backward                  | 832.069 ms                | 2.023 s                   |
| Optimize                  | 1.893 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.084 ms                 | 591.483 ms                |
| BlockToStepN              | 25.251 us                 | 12.941 ms                 |
| OneStep                   | 925.320 ms                | 2.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.696 ms                  | 14.312 ms                 |
| Backward                  | 837.710 ms                | 2.023 s                   |
| Optimize                  | 1.893 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.084 ms                 | 591.483 ms                |
| BlockToStepN              | 25.251 us                 | 12.941 ms                 |
| OneStep                   | 930.074 ms                | 2.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.699 ms                  | 14.312 ms                 |
| Backward                  | 838.822 ms                | 2.082 s                   |
| Optimize                  | 1.893 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.084 ms                 | 591.483 ms                |
| BlockToStepN              | 25.423 us                 | 12.941 ms                 |
| OneStep                   | 932.356 ms                | 2.202 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.699 ms                  | 14.312 ms                 |
| Backward                  | 844.311 ms                | 2.097 s                   |
| Optimize                  | 1.895 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.084 ms                 | 591.483 ms                |
| BlockToStepN              | 25.423 us                 | 12.941 ms                 |
| OneStep                   | 933.423 ms                | 2.202 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.699 ms                  | 14.312 ms                 |
| Backward                  | 846.174 ms                | 2.097 s                   |
| Optimize                  | 1.895 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.569 ms                 | 644.261 ms                |
| BlockToStepN              | 25.609 us                 | 12.941 ms                 |
| OneStep                   | 933.725 ms                | 2.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.196 ms                 |
| Forward                   | 8.700 ms                  | 14.312 ms                 |
| Backward                  | 847.030 ms                | 2.097 s                   |
| Optimize                  | 1.895 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.769 ms                 | 644.261 ms                |
| BlockToStepN              | 25.609 us                 | 12.941 ms                 |
| OneStep                   | 933.842 ms                | 2.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.196 ms                 |
| Forward                   | 8.701 ms                  | 14.312 ms                 |
| Backward                  | 857.704 ms                | 2.100 s                   |
| Optimize                  | 1.896 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 13.769 ms                 | 644.261 ms                |
| BlockToStepN              | 25.696 us                 | 12.941 ms                 |
| OneStep                   | 939.869 ms                | 2.244 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.174 ms                 |
| Forward                   | 8.702 ms                  | 14.312 ms                 |
| Backward                  | 859.702 ms                | 2.100 s                   |
| Optimize                  | 1.897 ms                  | 3.248 ms                  |
| BarrierTimeBeforeRank0    | 13.917 ms                 | 644.261 ms                |
| BlockToStepN              | 26.120 us                 | 14.526 ms                 |
| OneStep                   | 944.720 ms                | 2.277 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.894 ms                  | 84.174 ms                 |
| Forward                   | 8.701 ms                  | 14.312 ms                 |
| Backward                  | 879.449 ms                | 2.100 s                   |
| Optimize                  | 1.897 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 14.811 ms                 | 597.667 ms                |
| BlockToStepN              | 26.120 us                 | 12.941 ms                 |
| OneStep                   | 957.515 ms                | 2.244 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.174 ms                 |
| Forward                   | 8.701 ms                  | 14.312 ms                 |
| Backward                  | 884.512 ms                | 2.100 s                   |
| Optimize                  | 1.896 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 14.990 ms                 | 644.261 ms                |
| BlockToStepN              | 26.120 us                 | 12.941 ms                 |
| OneStep                   | 959.350 ms                | 2.277 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.909 ms                  | 84.174 ms                 |
| Forward                   | 8.702 ms                  | 14.312 ms                 |
| Backward                  | 889.247 ms                | 2.100 s                   |
| Optimize                  | 1.896 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.085 ms                 | 644.261 ms                |
| BlockToStepN              | 26.120 us                 | 12.941 ms                 |
| OneStep                   | 966.978 ms                | 2.277 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.174 ms                 |
| Forward                   | 8.703 ms                  | 14.312 ms                 |
| Backward                  | 892.983 ms                | 2.125 s                   |
| Optimize                  | 1.897 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.085 ms                 | 644.261 ms                |
| BlockToStepN              | 26.156 us                 | 12.941 ms                 |
| OneStep                   | 975.484 ms                | 2.300 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.174 ms                 |
| Forward                   | 8.704 ms                  | 14.312 ms                 |
| Backward                  | 897.661 ms                | 2.155 s                   |
| Optimize                  | 1.897 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.477 ms                 | 644.261 ms                |
| BlockToStepN              | 26.160 us                 | 12.941 ms                 |
| OneStep                   | 979.920 ms                | 2.303 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.174 ms                 |
| Forward                   | 8.703 ms                  | 14.312 ms                 |
| Backward                  | 907.125 ms                | 2.155 s                   |
| Optimize                  | 1.898 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.504 ms                 | 644.261 ms                |
| BlockToStepN              | 26.299 us                 | 12.941 ms                 |
| OneStep                   | 983.190 ms                | 2.303 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.174 ms                 |
| Forward                   | 8.703 ms                  | 14.312 ms                 |
| Backward                  | 907.453 ms                | 2.155 s                   |
| Optimize                  | 1.898 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.769 ms                 | 644.261 ms                |
| BlockToStepN              | 26.299 us                 | 12.941 ms                 |
| OneStep                   | 983.721 ms                | 2.303 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.926 ms                  | 84.174 ms                 |
| Forward                   | 8.704 ms                  | 14.329 ms                 |
| Backward                  | 907.600 ms                | 2.155 s                   |
| Optimize                  | 1.898 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.832 ms                 | 651.510 ms                |
| BlockToStepN              | 26.315 us                 | 12.941 ms                 |
| OneStep                   | 993.317 ms                | 2.313 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.931 ms                  | 84.174 ms                 |
| Forward                   | 8.704 ms                  | 14.329 ms                 |
| Backward                  | 909.610 ms                | 2.160 s                   |
| Optimize                  | 1.899 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.832 ms                 | 805.101 ms                |
| BlockToStepN              | 26.469 us                 | 12.941 ms                 |
| OneStep                   | 993.338 ms                | 2.403 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.931 ms                  | 84.174 ms                 |
| Forward                   | 8.704 ms                  | 14.329 ms                 |
| Backward                  | 909.968 ms                | 2.160 s                   |
| Optimize                  | 1.899 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.929 ms                 | 994.178 ms                |
| BlockToStepN              | 26.494 us                 | 12.941 ms                 |
| OneStep                   | 993.734 ms                | 2.447 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.931 ms                  | 84.174 ms                 |
| Forward                   | 8.708 ms                  | 14.329 ms                 |
| Backward                  | 910.952 ms                | 2.160 s                   |
| Optimize                  | 1.900 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.929 ms                 | 994.178 ms                |
| BlockToStepN              | 26.469 us                 | 12.941 ms                 |
| OneStep                   | 1.000 s                   | 2.447 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.940 ms                  | 84.174 ms                 |
| Forward                   | 8.710 ms                  | 14.329 ms                 |
| Backward                  | 915.293 ms                | 2.168 s                   |
| Optimize                  | 1.900 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.929 ms                 | 994.178 ms                |
| BlockToStepN              | 26.469 us                 | 12.941 ms                 |
| OneStep                   | 1.004 s                   | 2.447 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.713 ms                  | 14.329 ms                 |
| Backward                  | 915.511 ms                | 2.225 s                   |
| Optimize                  | 1.903 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.832 ms                 | 994.178 ms                |
| BlockToStepN              | 26.469 us                 | 12.941 ms                 |
| OneStep                   | 1.015 s                   | 2.447 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.715 ms                  | 14.329 ms                 |
| Backward                  | 921.870 ms                | 2.225 s                   |
| Optimize                  | 1.905 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.929 ms                 | 994.178 ms                |
| BlockToStepN              | 26.494 us                 | 12.941 ms                 |
| OneStep                   | 1.023 s                   | 2.447 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.940 ms                  | 84.174 ms                 |
| Forward                   | 8.715 ms                  | 14.329 ms                 |
| Backward                  | 942.191 ms                | 2.225 s                   |
| Optimize                  | 1.910 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.036 ms                 | 1.016 s                   |
| BlockToStepN              | 26.583 us                 | 12.941 ms                 |
| OneStep                   | 1.024 s                   | 2.899 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.940 ms                  | 84.174 ms                 |
| Forward                   | 8.715 ms                  | 14.329 ms                 |
| Backward                  | 949.935 ms                | 2.225 s                   |
| Optimize                  | 1.912 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 15.929 ms                 | 1.016 s                   |
| BlockToStepN              | 26.583 us                 | 12.941 ms                 |
| OneStep                   | 1.028 s                   | 2.899 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.717 ms                  | 14.329 ms                 |
| Backward                  | 949.935 ms                | 2.225 s                   |
| Optimize                  | 1.911 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.036 ms                 | 1.102 s                   |
| BlockToStepN              | 26.603 us                 | 12.941 ms                 |
| OneStep                   | 1.028 s                   | 2.903 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.940 ms                  | 84.174 ms                 |
| Forward                   | 8.719 ms                  | 14.329 ms                 |
| Backward                  | 956.996 ms                | 2.225 s                   |
| Optimize                  | 1.912 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.428 ms                 | 1.102 s                   |
| BlockToStepN              | 26.603 us                 | 12.941 ms                 |
| OneStep                   | 1.034 s                   | 2.903 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.720 ms                  | 14.329 ms                 |
| Backward                  | 957.806 ms                | 2.225 s                   |
| Optimize                  | 1.912 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.455 ms                 | 1.102 s                   |
| BlockToStepN              | 27.038 us                 | 12.941 ms                 |
| OneStep                   | 1.041 s                   | 2.903 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.720 ms                  | 14.329 ms                 |
| Backward                  | 958.975 ms                | 2.251 s                   |
| Optimize                  | 1.912 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.500 ms                 | 1.102 s                   |
| BlockToStepN              | 27.038 us                 | 12.941 ms                 |
| OneStep                   | 1.052 s                   | 2.976 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.720 ms                  | 14.329 ms                 |
| Backward                  | 963.273 ms                | 2.265 s                   |
| Optimize                  | 1.913 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.500 ms                 | 1.102 s                   |
| BlockToStepN              | 27.038 us                 | 12.941 ms                 |
| OneStep                   | 1.056 s                   | 2.976 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.958 ms                  | 84.174 ms                 |
| Forward                   | 8.721 ms                  | 14.329 ms                 |
| Backward                  | 965.398 ms                | 2.265 s                   |
| Optimize                  | 1.912 ms                  | 3.212 ms                  |
| BarrierTimeBeforeRank0    | 16.507 ms                 | 1.102 s                   |
| BlockToStepN              | 27.543 us                 | 12.941 ms                 |
| OneStep                   | 1.056 s                   | 2.976 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 209.823, sample: 1.062, forward: 1.286, backward: 169.969, update: 0.201
[proc 3] 500 steps, total: 209.823, sample: 1.233, forward: 1.471, backward: 176.404, update: 0.191
[proc 2] 500 steps, total: 209.822, sample: 0.997, forward: 1.458, backward: 173.089, update: 0.214
[proc 6] 500 steps, total: 209.823, sample: 1.067, forward: 1.363, backward: 172.957, update: 0.198
[proc 7] 500 steps, total: 209.823, sample: 0.966, forward: 1.441, backward: 165.314, update: 0.211
[proc 5] 500 steps, total: 209.823, sample: 1.036, forward: 1.446, backward: 172.886, update: 0.195
[proc 1] 500 steps, total: 209.823, sample: 1.037, forward: 1.444, backward: 178.839, update: 0.228
[proc 0] 500 steps, total: 209.822, sample: 1.202, forward: 0.950, backward: 178.003, update: 0.212
Successfully xmh. training takes 566.8790984153748 seconds
before call kg_cache_controller.StopThreads()
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
INFO [33389 controller_process.py:380] call rank0 to StopThreads
