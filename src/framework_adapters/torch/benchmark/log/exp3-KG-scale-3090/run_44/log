WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:31:33.512555 51289 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_59', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [51289 sampler.py:454] Start PreSampling
WARNING [51289 sampler.py:532] Before construct renumbering_dict
WARNING [51289 sampler.py:555] PreSampling done
W20240123 02:31:36.508162 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:31:36.508320 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:31:36.508364 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:31:36.508399 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:31:36.508435 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:31:36.508476 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:31:36.508512 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:31:36.508543 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:31:36.508574 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:31:36.508599 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:31:36.508643 51289 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:31:36.508668 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:31:36.508689 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:31:36.508806 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:31:36.508839 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:31:36.508863 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:31:36.508895 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:31:36.508919 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:31:36.508963 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:31:36.508987 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:31:36.509022 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:31:36.509052 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:31:36.509076 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:31:36.509101 51289 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:31:36.509121 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:31:36.509150 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:31:36.509207 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:31:36.509240 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:31:36.509268 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:31:36.509295 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:31:36.509325 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:31:36.509356 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:31:36.509389 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:31:36.509418 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:31:36.509447 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:31:36.509482 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:31:36.509514 51289 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:31:36.509534 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:31:36.509554 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:31:36.509601 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:31:36.509634 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:31:36.509665 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:31:36.509694 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:31:36.509724 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:31:36.509750 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:31:36.509780 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:31:36.509804 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:31:36.509840 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:31:36.509864 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:31:36.509888 51289 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:31:36.509908 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:31:36.509934 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:31:36.509984 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240123 02:31:36.510010 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240123 02:31:36.510036 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240123 02:31:36.510061 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240123 02:31:36.510090 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240123 02:31:36.510128 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240123 02:31:36.510159 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240123 02:31:36.510208 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240123 02:31:36.510241 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240123 02:31:36.510290 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240123 02:31:36.510315 51289 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240123 02:31:36.510336 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240123 02:31:36.510380 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240123 02:31:36.510438 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240123 02:31:36.510465 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240123 02:31:36.510497 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240123 02:31:36.510527 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240123 02:31:36.510565 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240123 02:31:36.510592 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240123 02:31:36.510622 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240123 02:31:36.510656 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240123 02:31:36.510681 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240123 02:31:36.510711 51289 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240123 02:31:36.510735 51289 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240123 02:31:36.510757 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240123 02:31:36.510789 51289 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240123 02:31:36.699281 51289 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100002e52000
W20240123 02:31:36.699450 51289 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100004524000
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  923,  1145,  1348,  ...,  2947,  2270, 10441]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.220 seconds
[Rank1] pid = 51683
[Rank2] pid = 51732
[Rank3] pid = 51752
[Rank4] pid = 51879
INFO [51289 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51683 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [51732 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [51752 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [51944 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [51879 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [51683 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [51289 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [51752 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [51732 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [51944 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [51879 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
WARNING [51289 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51752 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51879 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51944 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51732 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [51683 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:31:39.927991 51945 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240123 02:31:39.928076 51684 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:31:39.928165 51751 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:31:39.928220 51815 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:31:39.928277 51880 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:31:39.928329 52008 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:31:40.644241 51751 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240123 02:31:40.647874 51880 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:31:40.647917 51684 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:31:40.648108 51945 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:31:40.649327 51815 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:31:40.649607 52008 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.579 ms                  | 14.263 ms                 |
| bucket keys               | 1.313 ms                  | 109.015 ms                |
| forward: a2a keys         | 1.623 ms                  | 1.091 s                   |
| forward: search cache     | 264.928 us                | 21.246 ms                 |
| forward: a2a values       | 2.600 ms                  | 14.897 ms                 |
| forward: join             | 1.448 ms                  | 2.041 ms                  |
| Forward                   | 21.440 ms                 | 1.742 s                   |
| back: aggr dram keys      | 36.266 ms                 | 696.978 ms                |
| back: set dram grad       | 2.102 ms                  | 19.564 ms                 |
| back: a2a grad            | 4.870 ms                  | 8.999 ms                  |
| back: grad sum & grad cache  | 2.526 ms                  | 7.076 ms                  |
| Backward                  | 89.682 ms                 | 924.266 ms                |
| Optimize                  | 17.501 ms                 | 24.059 ms                 |
| BarrierTimeBeforeRank0    | 54.332 us                 | 139.073 us                |
| BlockToStepN              | 18.824 us                 | 891.967 us                |
| OneStep                   | 136.463 ms                | 2.693 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.424 ms                  | 16.333 ms                 |
| bucket keys               | 1.331 ms                  | 2.440 ms                  |
| forward: a2a keys         | 1.731 ms                  | 6.098 ms                  |
| forward: search cache     | 264.928 us                | 516.431 us                |
| forward: a2a values       | 2.599 ms                  | 10.514 ms                 |
| forward: join             | 1.579 ms                  | 2.385 ms                  |
| Forward                   | 21.042 ms                 | 31.535 ms                 |
| back: aggr dram keys      | 34.677 ms                 | 49.647 ms                 |
| back: set dram grad       | 1.940 ms                  | 5.226 ms                  |
| back: a2a grad            | 4.667 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.635 ms                  | 4.447 ms                  |
| Backward                  | 86.521 ms                 | 128.367 ms                |
| Optimize                  | 16.044 ms                 | 24.059 ms                 |
| BarrierTimeBeforeRank0    | 54.332 us                 | 138.528 us                |
| BlockToStepN              | 17.946 us                 | 164.234 us                |
| OneStep                   | 129.056 ms                | 179.036 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.336 ms                  | 16.495 ms                 |
| bucket keys               | 1.331 ms                  | 2.184 ms                  |
| forward: a2a keys         | 1.841 ms                  | 7.234 ms                  |
| forward: search cache     | 272.868 us                | 516.431 us                |
| forward: a2a values       | 2.599 ms                  | 6.518 ms                  |
| forward: join             | 1.580 ms                  | 2.236 ms                  |
| Forward                   | 21.222 ms                 | 31.535 ms                 |
| back: aggr dram keys      | 35.398 ms                 | 48.324 ms                 |
| back: set dram grad       | 1.879 ms                  | 5.147 ms                  |
| back: a2a grad            | 4.606 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.795 ms                  | 4.271 ms                  |
| Backward                  | 85.861 ms                 | 128.367 ms                |
| Optimize                  | 15.998 ms                 | 24.758 ms                 |
| BarrierTimeBeforeRank0    | 51.308 us                 | 138.528 us                |
| BlockToStepN              | 17.548 us                 | 164.234 us                |
| OneStep                   | 128.077 ms                | 179.036 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.573, sample: 0.286, forward: 3.966, backward: 9.362, update: 0.259
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 15.576, sample: 0.286, forward: 3.964, backward: 9.364, update: 0.255
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 15.573, sample: 0.276, forward: 3.952, backward: 9.360, update: 0.255
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 15.571, sample: 0.284, forward: 3.926, backward: 9.410, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 15.571, sample: 0.229, forward: 4.005, backward: 9.363, update: 0.185
[Rank5] pid = 51944
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
train_sampler.Prefill()
-------Step 0-------
tensor([    0,  7159,  9098,   920, 12640,  7215,   113,  7684,  8637,  2692]) tensor([ 1348,    40,  5636,  8451,     1,  9238, 12004, 14547,  1030,  9935])
-------Step 1-------
tensor([    0,  7159,  9098,   920, 12640,  7215,   113,  7684,  8637,  2692]) tensor([10150,  1660,  9199,  3835,  2982,  7843, 13090,  7962, 12440, 13667])
-------Step 2-------
tensor([11467,    77,    65,   120,  9125,  3779,  9247,  8417,  5749,  2849]) tensor([ 2901,  2571,  1238,  5728,  4623,  9558, 12191,  7202,  7574,  8105])
-------Step 3-------
tensor([11467,    77,    65,   120,  9125,  3779,  9247,  8417,  5749,  2849]) tensor([14423, 11632,  7346,  6314, 10181, 11075, 14719,  7757, 10175, 14059])
-------Step 4-------
tensor([13735, 11038,  8886, 13748, 10640,  8089,    63,  4013, 12640, 11970]) tensor([10510,  2348,  7502,  1321,  2175,  2296, 14366, 14860,  5303,  4011])
-------Step 5-------
tensor([13735, 11038,  8886, 13748, 10640,  8089,    63,  4013, 12640, 11970]) tensor([ 3745, 14302,  9324,  9551, 13314,  4473,  3028, 11619, 14672,  7673])
-------Step 6-------
tensor([12959,  3788, 13387,   754, 10702,  8435,  8871, 14121,    23,  8673]) tensor([  954,  2326,  6449, 11843,  5396,  4383, 10949, 11589,  8699,  9048])
-------Step 7-------
tensor([12959,  3788, 13387,   754, 10702,  8435,  8871, 14121,    23,  8673]) tensor([ 9123,  1797,  6096, 13508,  5441,  9809,  2589,  3530,  2487, 11727])
-------Step 8-------
tensor([ 3898,  8266, 10750,  7976,  7910,  7809, 12876, 13174,  2177, 10531]) tensor([ 4825,  2977,  6042,  2984,  8152,  4917,  8298,  6186, 10602,  1840])
-------Step 9-------
tensor([ 3898,  8266, 10750,  7976,  7910,  7809, 12876, 13174,  2177, 10531]) tensor([ 1789,  5641,  8241,  8055,  5914, 12735,  1439,  1416, 12440,  4574])
before start barrier
start train
[proc 0] 100 steps, total: 15.573, sample: 0.313, forward: 3.874, backward: 9.576, update: 1.709
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.336 ms                  | 17.830 ms                 |
| bucket keys               | 1.342 ms                  | 2.131 ms                  |
| forward: a2a keys         | 1.815 ms                  | 6.306 ms                  |
| forward: search cache     | 274.045 us                | 434.997 us                |
| forward: a2a values       | 2.585 ms                  | 4.215 ms                  |
| forward: join             | 1.580 ms                  | 2.327 ms                  |
| Forward                   | 21.218 ms                 | 31.535 ms                 |
| back: aggr dram keys      | 35.759 ms                 | 47.038 ms                 |
| back: set dram grad       | 1.895 ms                  | 4.661 ms                  |
| back: a2a grad            | 4.615 ms                  | 6.370 ms                  |
| back: grad sum & grad cache  | 2.795 ms                  | 4.243 ms                  |
| Backward                  | 86.128 ms                 | 128.367 ms                |
| Optimize                  | 15.996 ms                 | 24.758 ms                 |
| BarrierTimeBeforeRank0    | 50.970 us                 | 138.528 us                |
| BlockToStepN              | 17.421 us                 | 164.234 us                |
| OneStep                   | 127.393 ms                | 179.036 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.336 ms                  | 17.171 ms                 |
| bucket keys               | 1.342 ms                  | 2.184 ms                  |
| forward: a2a keys         | 1.842 ms                  | 8.684 ms                  |
| forward: search cache     | 271.061 us                | 434.997 us                |
| forward: a2a values       | 2.580 ms                  | 4.607 ms                  |
| forward: join             | 1.576 ms                  | 2.327 ms                  |
| Forward                   | 21.238 ms                 | 31.535 ms                 |
| back: aggr dram keys      | 35.759 ms                 | 47.038 ms                 |
| back: set dram grad       | 1.903 ms                  | 4.661 ms                  |
| back: a2a grad            | 4.594 ms                  | 6.370 ms                  |
| back: grad sum & grad cache  | 2.873 ms                  | 4.243 ms                  |
| Backward                  | 85.865 ms                 | 116.438 ms                |
| Optimize                  | 15.998 ms                 | 24.758 ms                 |
| BarrierTimeBeforeRank0    | 50.839 us                 | 138.528 us                |
| BlockToStepN              | 17.209 us                 | 102.801 us                |
| OneStep                   | 127.049 ms                | 166.546 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 12.942, sample: 0.217, forward: 2.316, backward: 8.498, update: 0.159
[proc 4] 200 steps, total: 12.942, sample: 0.300, forward: 2.230, backward: 8.469, update: 0.247
[proc 5] 200 steps, total: 12.942, sample: 0.305, forward: 2.224, backward: 8.492, update: 0.265
[proc 0] 200 steps, total: 12.942, sample: 0.353, forward: 2.172, backward: 8.653, update: 1.667
[proc 3] 200 steps, total: 12.942, sample: 0.303, forward: 2.256, backward: 8.456, update: 0.264
[proc 1] 200 steps, total: 12.942, sample: 0.289, forward: 2.249, backward: 8.492, update: 0.256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.309 ms                  | 18.995 ms                 |
| bucket keys               | 1.342 ms                  | 2.170 ms                  |
| forward: a2a keys         | 1.877 ms                  | 13.100 ms                 |
| forward: search cache     | 265.106 us                | 433.066 us                |
| forward: a2a values       | 2.558 ms                  | 4.215 ms                  |
| forward: join             | 1.565 ms                  | 2.236 ms                  |
| Forward                   | 21.262 ms                 | 35.007 ms                 |
| back: aggr dram keys      | 35.759 ms                 | 44.622 ms                 |
| back: set dram grad       | 1.905 ms                  | 4.397 ms                  |
| back: a2a grad            | 4.570 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.969 ms                  | 4.045 ms                  |
| Backward                  | 85.865 ms                 | 116.438 ms                |
| Optimize                  | 15.943 ms                 | 24.758 ms                 |
| BarrierTimeBeforeRank0    | 50.158 us                 | 138.528 us                |
| BlockToStepN              | 18.221 us                 | 102.801 us                |
| OneStep                   | 127.393 ms                | 166.546 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.303 ms                  | 18.995 ms                 |
| bucket keys               | 1.349 ms                  | 2.131 ms                  |
| forward: a2a keys         | 1.934 ms                  | 14.926 ms                 |
| forward: search cache     | 256.484 us                | 428.538 us                |
| forward: a2a values       | 2.555 ms                  | 4.040 ms                  |
| forward: join             | 1.543 ms                  | 2.224 ms                  |
| Forward                   | 21.374 ms                 | 37.263 ms                 |
| back: aggr dram keys      | 35.737 ms                 | 44.039 ms                 |
| back: set dram grad       | 1.940 ms                  | 4.397 ms                  |
| back: a2a grad            | 4.547 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.989 ms                  | 4.013 ms                  |
| Backward                  | 85.768 ms                 | 116.438 ms                |
| Optimize                  | 15.902 ms                 | 24.801 ms                 |
| BarrierTimeBeforeRank0    | 49.850 us                 | 139.073 us                |
| BlockToStepN              | 19.093 us                 | 158.409 us                |
| OneStep                   | 128.071 ms                | 166.546 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.299 ms                  | 17.830 ms                 |
| bucket keys               | 1.349 ms                  | 2.131 ms                  |
| forward: a2a keys         | 1.989 ms                  | 16.614 ms                 |
| forward: search cache     | 254.977 us                | 428.538 us                |
| forward: a2a values       | 2.555 ms                  | 4.024 ms                  |
| forward: join             | 1.530 ms                  | 2.224 ms                  |
| Forward                   | 21.461 ms                 | 37.361 ms                 |
| back: aggr dram keys      | 35.737 ms                 | 43.293 ms                 |
| back: set dram grad       | 1.971 ms                  | 4.355 ms                  |
| back: a2a grad            | 4.541 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.989 ms                  | 4.045 ms                  |
| Backward                  | 85.729 ms                 | 108.503 ms                |
| Optimize                  | 15.982 ms                 | 24.946 ms                 |
| BarrierTimeBeforeRank0    | 49.630 us                 | 139.073 us                |
| BlockToStepN              | 19.658 us                 | 158.409 us                |
| OneStep                   | 128.287 ms                | 163.544 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 13.193, sample: 0.293, forward: 2.538, backward: 8.580, update: 1.684
[proc 5] 300 steps, total: 13.193, sample: 0.210, forward: 2.631, backward: 8.402, update: 0.173
[proc 2] 300 steps, total: 13.193, sample: 0.194, forward: 2.651, backward: 8.421, update: 0.155
[proc 4] 300 steps, total: 13.193, sample: 0.268, forward: 2.573, backward: 8.398, update: 0.236
[proc 1] 300 steps, total: 13.193, sample: 0.290, forward: 2.557, backward: 8.415, update: 0.247
[proc 3] 300 steps, total: 13.193, sample: 0.312, forward: 2.573, backward: 8.361, update: 0.269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.305 ms                  | 17.830 ms                 |
| bucket keys               | 1.349 ms                  | 2.170 ms                  |
| forward: a2a keys         | 1.988 ms                  | 16.614 ms                 |
| forward: search cache     | 254.960 us                | 429.800 us                |
| forward: a2a values       | 2.558 ms                  | 4.024 ms                  |
| forward: join             | 1.539 ms                  | 2.224 ms                  |
| Forward                   | 21.532 ms                 | 37.361 ms                 |
| back: aggr dram keys      | 35.629 ms                 | 44.622 ms                 |
| back: set dram grad       | 1.973 ms                  | 4.355 ms                  |
| back: a2a grad            | 4.534 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.975 ms                  | 4.214 ms                  |
| Backward                  | 85.729 ms                 | 108.503 ms                |
| Optimize                  | 15.982 ms                 | 24.946 ms                 |
| BarrierTimeBeforeRank0    | 49.599 us                 | 141.958 us                |
| BlockToStepN              | 19.789 us                 | 158.409 us                |
| OneStep                   | 128.505 ms                | 163.544 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.299 ms                  | 17.357 ms                 |
| bucket keys               | 1.346 ms                  | 2.138 ms                  |
| forward: a2a keys         | 1.969 ms                  | 16.671 ms                 |
| forward: search cache     | 253.647 us                | 428.538 us                |
| forward: a2a values       | 2.551 ms                  | 4.024 ms                  |
| forward: join             | 1.534 ms                  | 2.216 ms                  |
| Forward                   | 21.536 ms                 | 37.263 ms                 |
| back: aggr dram keys      | 34.677 ms                 | 44.039 ms                 |
| back: set dram grad       | 1.981 ms                  | 4.270 ms                  |
| back: a2a grad            | 4.541 ms                  | 7.825 ms                  |
| back: grad sum & grad cache  | 2.975 ms                  | 4.045 ms                  |
| Backward                  | 85.677 ms                 | 102.860 ms                |
| Optimize                  | 15.958 ms                 | 25.062 ms                 |
| BarrierTimeBeforeRank0    | 49.048 us                 | 139.073 us                |
| BlockToStepN              | 19.620 us                 | 102.801 us                |
| OneStep                   | 129.029 ms                | 157.441 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.289 ms                  | 17.830 ms                 |
| bucket keys               | 1.342 ms                  | 2.138 ms                  |
| forward: a2a keys         | 1.953 ms                  | 16.671 ms                 |
| forward: search cache     | 249.518 us                | 428.538 us                |
| forward: a2a values       | 2.535 ms                  | 3.927 ms                  |
| forward: join             | 1.520 ms                  | 2.201 ms                  |
| Forward                   | 21.613 ms                 | 37.263 ms                 |
| back: aggr dram keys      | 34.677 ms                 | 44.622 ms                 |
| back: set dram grad       | 1.984 ms                  | 4.242 ms                  |
| back: a2a grad            | 4.535 ms                  | 7.796 ms                  |
| back: grad sum & grad cache  | 2.975 ms                  | 4.013 ms                  |
| Backward                  | 85.583 ms                 | 102.860 ms                |
| Optimize                  | 15.958 ms                 | 25.338 ms                 |
| BarrierTimeBeforeRank0    | 48.774 us                 | 139.073 us                |
| BlockToStepN              | 19.538 us                 | 102.801 us                |
| OneStep                   | 129.433 ms                | 157.441 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 13.128, sample: 0.253, forward: 2.588, backward: 8.403, update: 0.219
[proc 4] 400 steps, total: 13.128, sample: 0.270, forward: 2.556, backward: 8.410, update: 0.247
[proc 0] 400 steps, total: 13.128, sample: 0.310, forward: 2.504, backward: 8.578, update: 1.639
[proc 5] 400 steps, total: 13.128, sample: 0.233, forward: 2.595, backward: 8.424, update: 0.204
[proc 1] 400 steps, total: 13.128, sample: 0.292, forward: 2.543, backward: 8.426, update: 0.255
[proc 2] 400 steps, total: 13.128, sample: 0.303, forward: 2.524, backward: 8.430, update: 0.251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.293 ms                  | 18.836 ms                 |
| bucket keys               | 1.342 ms                  | 2.162 ms                  |
| forward: a2a keys         | 1.937 ms                  | 16.671 ms                 |
| forward: search cache     | 245.866 us                | 428.538 us                |
| forward: a2a values       | 2.538 ms                  | 3.886 ms                  |
| forward: join             | 1.524 ms                  | 2.201 ms                  |
| Forward                   | 21.687 ms                 | 37.361 ms                 |
| back: aggr dram keys      | 34.677 ms                 | 44.622 ms                 |
| back: set dram grad       | 1.986 ms                  | 4.242 ms                  |
| back: a2a grad            | 4.529 ms                  | 6.429 ms                  |
| back: grad sum & grad cache  | 2.977 ms                  | 4.013 ms                  |
| Backward                  | 85.547 ms                 | 102.860 ms                |
| Optimize                  | 15.979 ms                 | 25.338 ms                 |
| BarrierTimeBeforeRank0    | 48.727 us                 | 141.958 us                |
| BlockToStepN              | 19.159 us                 | 102.801 us                |
| OneStep                   | 129.658 ms                | 157.441 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.302 ms                  | 18.163 ms                 |
| bucket keys               | 1.341 ms                  | 2.162 ms                  |
| forward: a2a keys         | 1.916 ms                  | 16.671 ms                 |
| forward: search cache     | 245.080 us                | 429.800 us                |
| forward: a2a values       | 2.533 ms                  | 3.927 ms                  |
| forward: join             | 1.531 ms                  | 2.201 ms                  |
| Forward                   | 21.666 ms                 | 37.263 ms                 |
| back: aggr dram keys      | 34.465 ms                 | 44.622 ms                 |
| back: set dram grad       | 1.987 ms                  | 4.242 ms                  |
| back: a2a grad            | 4.534 ms                  | 6.429 ms                  |
| back: grad sum & grad cache  | 2.978 ms                  | 4.045 ms                  |
| Backward                  | 85.498 ms                 | 102.789 ms                |
| Optimize                  | 15.920 ms                 | 25.062 ms                 |
| BarrierTimeBeforeRank0    | 49.048 us                 | 141.561 us                |
| BlockToStepN              | 18.782 us                 | 92.422 us                 |
| OneStep                   | 129.939 ms                | 157.242 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 13.165, sample: 0.264, forward: 2.582, backward: 8.360, update: 0.221
[proc 3] 500 steps, total: 13.165, sample: 0.288, forward: 2.566, backward: 8.367, update: 0.269
[proc 1] 500 steps, total: 13.165, sample: 0.264, forward: 2.596, backward: 8.401, update: 0.253
[proc 0] 500 steps, total: 13.165, sample: 0.333, forward: 2.515, backward: 8.536, update: 1.683
[proc 5] 500 steps, total: 13.165, sample: 0.267, forward: 2.576, backward: 8.374, update: 0.268
[proc 2] 500 steps, total: 13.165, sample: 0.262, forward: 2.588, backward: 8.370, update: 0.269
Successfully xmh. training takes 68.00095868110657 seconds
before call kg_cache_controller.StopThreads()
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
INFO [51289 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.302 ms                  | 18.163 ms                 |
| bucket keys               | 1.341 ms                  | 2.162 ms                  |
| forward: a2a keys         | 1.906 ms                  | 16.614 ms                 |
| forward: search cache     | 245.129 us                | 428.538 us                |
| forward: a2a values       | 2.529 ms                  | 3.886 ms                  |
| forward: join             | 1.531 ms                  | 2.168 ms                  |
| Forward                   | 21.704 ms                 | 37.263 ms                 |
| back: aggr dram keys      | 34.465 ms                 | 44.039 ms                 |
| back: set dram grad       | 1.985 ms                  | 4.242 ms                  |
| back: a2a grad            | 4.535 ms                  | 6.429 ms                  |
| back: grad sum & grad cache  | 2.978 ms                  | 4.013 ms                  |
| Backward                  | 85.472 ms                 | 102.789 ms                |
| Optimize                  | 15.906 ms                 | 25.338 ms                 |
| BarrierTimeBeforeRank0    | 48.944 us                 | 141.958 us                |
| BlockToStepN              | 18.487 us                 | 92.422 us                 |
| OneStep                   | 129.939 ms                | 157.242 ms                |
+---------------------------+---------------------------+---------------------------+
