WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 19:42:41.934651 34983 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_29', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [34983 sampler.py:454] Start PreSampling
WARNING [34983 sampler.py:532] Before construct renumbering_dict
WARNING [34983 sampler.py:555] PreSampling done
W20240123 19:55:19.732115 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 19:55:19.732314 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 19:55:19.732347 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 19:55:19.732369 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 19:55:19.732388 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 19:55:19.732414 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 19:55:19.732440 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 19:55:19.732465 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 19:55:19.732494 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 19:55:19.732515 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 19:55:19.732546 34983 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 19:55:19.732564 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 19:55:19.732591 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 19:55:19.732726 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 19:55:19.732750 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 19:55:19.732767 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 19:55:19.732784 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 19:55:19.732843 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 19:55:19.732874 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 19:55:19.732896 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 19:55:19.732920 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 19:55:19.732941 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 19:55:19.732961 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 19:55:19.732980 34983 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 19:55:19.732995 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 19:55:19.733016 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 19:55:19.733067 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240123 19:55:19.733096 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240123 19:55:19.733114 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240123 19:55:19.733137 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240123 19:55:19.733155 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240123 19:55:19.733173 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240123 19:55:19.733193 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240123 19:55:19.733223 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240123 19:55:19.733242 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240123 19:55:19.733266 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240123 19:55:19.733289 34983 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240123 19:55:19.733302 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240123 19:55:19.733317 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240123 19:55:19.733361 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240123 19:55:19.733387 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240123 19:55:19.733403 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240123 19:55:19.733420 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240123 19:55:19.733440 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240123 19:55:19.733465 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240123 19:55:19.733489 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240123 19:55:19.733511 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240123 19:55:19.733529 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240123 19:55:19.733553 34983 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240123 19:55:19.733573 34983 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240123 19:55:19.733587 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240123 19:55:19.733605 34983 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240123 19:55:20.046779 34983 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100001ee2000 128.2 GB
W20240123 19:55:20.046949 34983 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102010b1a000 328.3 MB
{0: Graph(num_nodes=27256011, num_edges=100992629,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23779591, num_edges=94535774,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=26463902, num_edges=75890617,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=25398646, num_edges=93789131,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27256011 N 100992629 E
MertisPartition: part 1 has 23779591 N 94535774 E
MertisPartition: part 2 has 26463902 N 75890617 E
MertisPartition: part 3 has 25398646 N 93789131 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 4302734,  4302763,   338391,  ...,  4195944, 10969351, 84802674]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 3, 3])}
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27256011, num_edges=100992629,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 933.057 seconds
[Rank1] pid = 59933
[Rank2] pid = 60034
INFO [34983 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [59933 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [60104 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [59933 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [60104 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [60034 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [60034 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [60104 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [59933 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [60034 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [34983 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [34983 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 19:58:18.526266 60105 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 19:58:18.526386 59934 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 19:58:18.526551 60169 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 19:58:18.526773 60035 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240123 19:58:30.798409 60035 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 19:58:32.944623 60169 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 19:58:33.542472 59934 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 19:58:34.393997 60105 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.141 ms                  | 57.867 ms                 |
| Forward                   | 7.026 ms                  | 560.045 ms                |
| Backward                  | 62.983 ms                 | 224.482 ms                |
| Optimize                  | 2.052 ms                  | 2.597 ms                  |
| BarrierTimeBeforeRank0    | 13.100 ms                 | 28.573 ms                 |
| BlockToStepN              | 19.031 us                 | 54.109 us                 |
| OneStep                   | 93.401 ms                 | 799.591 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.264 ms                  | 57.867 ms                 |
| Forward                   | 7.350 ms                  | 24.166 ms                 |
| Backward                  | 63.661 ms                 | 81.942 ms                 |
| Optimize                  | 2.115 ms                  | 2.597 ms                  |
| BarrierTimeBeforeRank0    | 10.724 ms                 | 25.008 ms                 |
| BlockToStepN              | 19.673 us                 | 61.437 us                 |
| OneStep                   | 91.327 ms                 | 163.871 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 11.531, sample: 0.852, forward: 1.875, backward: 6.718, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 14.275, sample: 0.983, forward: 1.893, backward: 6.854, update: 0.184
[Rank3] pid = 60104
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([  954340,  4587626,   954369,   954398,   954426,   954457, 56229275,
          168753,  4310557,   954486]) tensor([ 5026453, 31209489, 25024612, 42253524, 46292644, 31327130, 83841172,
        65080792, 51412882, 36913753])
-------Step 1-------
tensor([  954340,  4587626,   954369,   954398,   954426,   954457, 56229275,
          168753,  4310557,   954486]) tensor([51650797, 45092338, 33372996, 56647452, 33059143, 85109564, 43057896,
        77078549, 82384539,  4378945])
-------Step 2-------
tensor([ 170561, 1008454, 1008487, 1008517, 1008544, 1008577, 1008615, 1008645,
         849731, 1008676]) tensor([66454977, 22267082, 63226024,   747368, 42415122, 22099906, 67449730,
        45136342, 17388917,  2089013])
-------Step 3-------
tensor([ 170561, 1008454, 1008487, 1008517, 1008544, 1008577, 1008615, 1008645,
         849731, 1008676]) tensor([62416600, 52612507, 11277542, 40177359,  4467308, 10751916, 66594745,
        18387130,  7215976, 36899614])
-------Step 4-------
tensor([ 1062582,  1062615,  1062649, 11015856,  1062677,  1062710,  1062731,
        33322281,  1062763,  4310557]) tensor([26751683, 30398705, 10660038, 65310625, 30274944, 17483813, 71870851,
        58899461, 12805349,  9645006])
-------Step 5-------
tensor([ 1062582,  1062615,  1062649, 11015856,  1062677,  1062710,  1062731,
        33322281,  1062763,  4310557]) tensor([41412139, 85431237, 59571029, 10717871, 36139067, 37050272, 51888156,
        54580257,   411528, 53736416])
-------Step 6-------
tensor([   44094,    44124,  5328020,    44160,    44196,    44223, 11737213,
           44253,    44281,    44304]) tensor([59086658,  4604870,  8713857, 17846805, 82008286, 34916019, 81469341,
        18439070, 52119094, 74508638])
-------Step 7-------
tensor([   44094,    44124,  5328020,    44160,    44196,    44223, 11737213,
           44253,    44281,    44304]) tensor([24852319, 64192438, 39510810, 23106818, 13448697, 79214229,  1153214,
        84993376, 65163503, 35410347])
-------Step 8-------
tensor([  100099,   100137,   100164, 74947494,   100201,   100227, 59248059,
          100257,   100281,   100312]) tensor([12582371, 68415935, 80766381, 65589582, 71878877, 33411697, 65375088,
         1071020, 53834650, 53408609])
-------Step 9-------
tensor([  100099,   100137,   100164, 74947494,   100201,   100227, 59248059,
          100257,   100281,   100312]) tensor([58809386, 66462258, 61555424, 59720298, 12995701, 19097401, 42586068,
        44010861, 38544092, 13723856])
before start barrier
start train
[proc 0] 100 steps, total: 10.679, sample: 1.004, forward: 1.332, backward: 6.872, update: 0.197
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 12.129, sample: 0.889, forward: 1.930, backward: 6.724, update: 0.195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.359 ms                  | 60.430 ms                 |
| Forward                   | 7.408 ms                  | 24.166 ms                 |
| Backward                  | 63.411 ms                 | 224.482 ms                |
| Optimize                  | 2.139 ms                  | 4.772 ms                  |
| BarrierTimeBeforeRank0    | 9.383 ms                  | 35.895 ms                 |
| BlockToStepN              | 19.616 us                 | 14.686 ms                 |
| OneStep                   | 90.889 ms                 | 273.720 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.420 ms                  | 57.867 ms                 |
| Forward                   | 7.628 ms                  | 11.026 ms                 |
| Backward                  | 63.411 ms                 | 87.211 ms                 |
| Optimize                  | 2.158 ms                  | 3.800 ms                  |
| BarrierTimeBeforeRank0    | 8.433 ms                  | 35.895 ms                 |
| BlockToStepN              | 19.055 us                 | 1.283 ms                  |
| OneStep                   | 89.653 ms                 | 269.391 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 9.551, sample: 0.919, forward: 1.208, backward: 6.781, update: 0.185
[proc 3] 200 steps, total: 9.551, sample: 0.862, forward: 1.183, backward: 6.399, update: 0.184
[proc 0] 200 steps, total: 9.551, sample: 1.029, forward: 0.771, backward: 6.466, update: 0.189
[proc 1] 200 steps, total: 9.551, sample: 0.892, forward: 1.233, backward: 6.462, update: 0.188
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.359 ms                  | 60.430 ms                 |
| Forward                   | 7.669 ms                  | 11.026 ms                 |
| Backward                  | 63.694 ms                 | 190.163 ms                |
| Optimize                  | 2.163 ms                  | 4.772 ms                  |
| BarrierTimeBeforeRank0    | 8.762 ms                  | 106.975 ms                |
| BlockToStepN              | 19.019 us                 | 7.470 ms                  |
| OneStep                   | 89.405 ms                 | 269.391 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.351 ms                  | 57.867 ms                 |
| Forward                   | 7.669 ms                  | 12.636 ms                 |
| Backward                  | 63.825 ms                 | 90.760 ms                 |
| Optimize                  | 2.165 ms                  | 3.807 ms                  |
| BarrierTimeBeforeRank0    | 8.646 ms                  | 38.527 ms                 |
| BlockToStepN              | 18.872 us                 | 2.618 ms                  |
| OneStep                   | 89.521 ms                 | 241.886 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 9.687, sample: 0.705, forward: 1.214, backward: 6.764, update: 0.188
[proc 3] 300 steps, total: 9.687, sample: 0.659, forward: 1.171, backward: 6.608, update: 0.183
[proc 1] 300 steps, total: 9.687, sample: 0.658, forward: 1.288, backward: 7.002, update: 0.196
[proc 0] 300 steps, total: 9.687, sample: 0.856, forward: 0.798, backward: 6.684, update: 0.210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.211 ms                  | 57.867 ms                 |
| Forward                   | 7.628 ms                  | 12.636 ms                 |
| Backward                  | 63.929 ms                 | 189.197 ms                |
| Optimize                  | 2.165 ms                  | 3.807 ms                  |
| BarrierTimeBeforeRank0    | 9.202 ms                  | 106.975 ms                |
| BlockToStepN              | 18.975 us                 | 2.618 ms                  |
| OneStep                   | 89.666 ms                 | 241.886 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.026 ms                  | 57.198 ms                 |
| Forward                   | 7.639 ms                  | 11.026 ms                 |
| Backward                  | 64.392 ms                 | 90.760 ms                 |
| Optimize                  | 2.165 ms                  | 4.022 ms                  |
| BarrierTimeBeforeRank0    | 9.201 ms                  | 83.086 ms                 |
| BlockToStepN              | 18.726 us                 | 1.283 ms                  |
| OneStep                   | 89.676 ms                 | 239.419 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 9.735, sample: 0.739, forward: 0.766, backward: 6.748, update: 0.205
[proc 2] 400 steps, total: 9.735, sample: 0.687, forward: 1.088, backward: 6.628, update: 0.184
[proc 3] 400 steps, total: 9.735, sample: 0.761, forward: 1.071, backward: 6.598, update: 0.191
[proc 1] 400 steps, total: 9.735, sample: 0.833, forward: 1.300, backward: 7.021, update: 0.199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.127 ms                  | 57.198 ms                 |
| Forward                   | 7.772 ms                  | 12.636 ms                 |
| Backward                  | 64.563 ms                 | 150.120 ms                |
| Optimize                  | 2.165 ms                  | 4.022 ms                  |
| BarrierTimeBeforeRank0    | 8.442 ms                  | 106.975 ms                |
| BlockToStepN              | 18.797 us                 | 1.283 ms                  |
| OneStep                   | 89.537 ms                 | 241.886 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.180 ms                  | 56.027 ms                 |
| Forward                   | 7.914 ms                  | 11.166 ms                 |
| Backward                  | 64.923 ms                 | 90.760 ms                 |
| Optimize                  | 2.170 ms                  | 3.930 ms                  |
| BarrierTimeBeforeRank0    | 7.646 ms                  | 92.749 ms                 |
| BlockToStepN              | 18.826 us                 | 140.562 us                |
| OneStep                   | 89.372 ms                 | 239.419 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 9.552, sample: 0.591, forward: 1.136, backward: 6.627, update: 0.189
[proc 1] 500 steps, total: 9.552, sample: 0.714, forward: 1.233, backward: 7.002, update: 0.195
[proc 0] 500 steps, total: 9.552, sample: 0.953, forward: 0.832, backward: 6.734, update: 0.198
[proc 2] 500 steps, total: 9.552, sample: 0.734, forward: 1.088, backward: 6.491, update: 0.194
Successfully xmh. training takes 49.20501446723938 seconds
before call kg_cache_controller.StopThreads()
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
INFO [34983 controller_process.py:380] call rank0 to StopThreads
