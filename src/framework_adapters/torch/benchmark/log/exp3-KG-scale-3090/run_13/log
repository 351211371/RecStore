WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 01:41:37.546082  4912 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_28', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [4912 sampler.py:454] Start PreSampling
WARNING [4912 sampler.py:532] Before construct renumbering_dict
WARNING [4912 sampler.py:555] PreSampling done
W20240123 01:41:40.184278  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 01:41:40.184437  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 01:41:40.184482  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 01:41:40.184509  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 01:41:40.184530  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 01:41:40.184561  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 01:41:40.184592  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 01:41:40.184623  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 01:41:40.184650  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 01:41:40.184674  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 01:41:40.184741  4912 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 01:41:40.184764  4912 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 01:41:40.184800  4912 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 01:41:40.184923  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 01:41:40.184952  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 01:41:40.184974  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 01:41:40.184995  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 01:41:40.185017  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 01:41:40.185065  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 01:41:40.185097  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 01:41:40.185119  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 01:41:40.185145  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 01:41:40.185179  4912 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 01:41:40.185206  4912 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 01:41:40.185223  4912 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 01:41:40.185240  4912 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 01:41:40.372802  4912 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100000f72000
W20240123 01:41:40.372951  4912 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100002644000
{0: Graph(num_nodes=13500, num_edges=273181,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12803, num_edges=385691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 13500 N 273181 E
MertisPartition: part 1 has 12803 N 385691 E
Rank0: cached key size 373
Rank1: cached key size 373
Before renumbering graph:  {'_ID': tensor([    0,     2,     6,  ..., 11079,  2237, 14365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([  754,   832,   951,  ..., 11894,  9072, 13970]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=13500, num_edges=273181,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=13500, num_edges=273181,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.862 seconds
INFO [4912 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [4912 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [5409 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [5409 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [4912 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [5409 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [4912 cache_common.py:137] TorchNativeStdEmb construct done
INFO [5409 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [4912 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [5409 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 01:41:42.477797  5410 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240123 01:41:42.477891  5433 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
I20240123 01:41:42.809175  5410 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240123 01:41:42.810076  5433 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 899.171 us                | 17.438 ms                 |
| Forward                   | 5.350 ms                  | 548.067 ms                |
| Backward                  | 70.194 ms                 | 162.702 ms                |
| Optimize                  | 1.647 ms                  | 3.785 ms                  |
| BarrierTimeBeforeRank0    | 125.282 us                | 7.728 ms                  |
| BlockToStepN              | 5.918 us                  | 43.379 us                 |
| OneStep                   | 85.455 ms                 | 717.003 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 875.497 us                | 14.167 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 110.105 ms                | 188.997 ms                |
| Optimize                  | 1.653 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 541.212 us                | 19.974 ms                 |
| BlockToStepN              | 5.898 us                  | 37.377 us                 |
| OneStep                   | 121.822 ms                | 234.415 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 867.716 us                | 14.167 ms                 |
| Forward                   | 5.314 ms                  | 8.788 ms                  |
| Backward                  | 136.551 ms                | 246.576 ms                |
| Optimize                  | 1.650 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 602.674 us                | 29.707 ms                 |
| BlockToStepN              | 6.058 us                  | 37.377 us                 |
| OneStep                   | 147.040 ms                | 272.067 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank1] pid = 5409
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494)]
train_sampler.Prefill()
-------Step 0-------
tensor([  898, 12886,  5873, 10434,    36, 10532, 14266,    13,  2970, 14814]) tensor([  978,  4864, 10228,  4385, 10086,  7593,  8382,  8066, 10117, 10648])
-------Step 1-------
tensor([  898, 12886,  5873, 10434,    36, 10532, 14266,    13,  2970, 14814]) tensor([10580, 12080,  7257,  9865,  6011,  4849,  5933,  1853, 12247,  5552])
-------Step 2-------
tensor([ 3182,    20,  4169, 11089,  2371, 11487,  3024, 13476,  4386,  3719]) tensor([ 9468,  9109,  4018,  5245, 13660,  4535,   373,  4694, 14843,  4061])
-------Step 3-------
tensor([ 3182,    20,  4169, 11089,  2371, 11487,  3024, 13476,  4386,  3719]) tensor([13269, 12034, 12796, 13665,  1287,  6009,  8328,  9240,  5325,  6732])
-------Step 4-------
tensor([ 108, 3247,  948, 8056, 5442,  326,  179, 4467,  230,  192]) tensor([13343,  8251,  7487,  2732,  2578, 13741, 13523,  8476,  4848,  4160])
-------Step 5-------
tensor([ 108, 3247,  948, 8056, 5442,  326,  179, 4467,  230,  192]) tensor([ 4222,  1734,  3165, 12528, 14226,   810,  9954,  3394, 14168,  1699])
-------Step 6-------
tensor([ 9500, 10728, 14272, 12669,  5512,   120,  3663,  6905,  3989,  1721]) tensor([ 6072,  9771,  1246,  9937, 14908, 14546, 10847,  8528, 11793,  3464])
-------Step 7-------
tensor([ 9500, 10728, 14272, 12669,  5512,   120,  3663,  6905,  3989,  1721]) tensor([ 7608,   330,  8925,  5303,  2444,  5855, 13220, 13834, 14747,  7109])
-------Step 8-------
tensor([ 2069,  2916, 13223, 11336,  7793, 11025, 14010,  5145,   272,  6263]) tensor([ 2620,  6245, 10221,  7032,  3196,  9537, 11351, 10584, 13921,  2158])
-------Step 9-------
tensor([ 2069,  2916, 13223, 11336,  7793, 11025, 14010,  5145,   272,  6263]) tensor([10985,  7440, 10537,  1396,  8968,  1201,  5933,  3100,  8961, 12591])
before start barrier
start train
[proc 0] 100 steps, total: 15.487, sample: 0.226, forward: 1.080, backward: 13.564, update: 0.161
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.486, sample: 0.223, forward: 1.063, backward: 13.663, update: 0.149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 872.892 us                | 14.167 ms                 |
| Forward                   | 5.305 ms                  | 8.788 ms                  |
| Backward                  | 156.006 ms                | 310.342 ms                |
| Optimize                  | 1.647 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 667.757 us                | 45.490 ms                 |
| BlockToStepN              | 5.994 us                  | 37.377 us                 |
| OneStep                   | 166.441 ms                | 360.685 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 875.132 us                | 14.167 ms                 |
| Forward                   | 5.311 ms                  | 8.788 ms                  |
| Backward                  | 173.403 ms                | 352.860 ms                |
| Optimize                  | 1.650 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 671.574 us                | 70.235 ms                 |
| BlockToStepN              | 5.996 us                  | 37.377 us                 |
| OneStep                   | 186.229 ms                | 401.515 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 872.448 us                | 14.167 ms                 |
| Forward                   | 5.307 ms                  | 8.788 ms                  |
| Backward                  | 188.118 ms                | 388.799 ms                |
| Optimize                  | 1.650 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 713.115 us                | 70.235 ms                 |
| BlockToStepN              | 5.948 us                  | 37.377 us                 |
| OneStep                   | 206.092 ms                | 420.586 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 875.132 us                | 12.318 ms                 |
| Forward                   | 5.314 ms                  | 8.783 ms                  |
| Backward                  | 199.291 ms                | 394.305 ms                |
| Optimize                  | 1.650 ms                  | 2.461 ms                  |
| BarrierTimeBeforeRank0    | 713.115 us                | 50.530 ms                 |
| BlockToStepN              | 5.898 us                  | 33.354 us                 |
| OneStep                   | 215.654 ms                | 419.864 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 876.693 us                | 12.318 ms                 |
| Forward                   | 5.331 ms                  | 8.788 ms                  |
| Backward                  | 215.729 ms                | 448.011 ms                |
| Optimize                  | 1.650 ms                  | 2.461 ms                  |
| BarrierTimeBeforeRank0    | 713.115 us                | 50.530 ms                 |
| BlockToStepN              | 5.898 us                  | 33.354 us                 |
| OneStep                   | 234.415 ms                | 459.217 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 882.862 us                | 12.318 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 224.327 ms                | 468.563 ms                |
| Optimize                  | 1.650 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 713.115 us                | 50.530 ms                 |
| BlockToStepN              | 5.918 us                  | 33.354 us                 |
| OneStep                   | 246.455 ms                | 496.451 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 876.693 us                | 12.318 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 238.495 ms                | 493.637 ms                |
| Optimize                  | 1.651 ms                  | 2.509 ms                  |
| BarrierTimeBeforeRank0    | 667.757 us                | 50.530 ms                 |
| BlockToStepN              | 5.889 us                  | 33.354 us                 |
| OneStep                   | 267.104 ms                | 510.167 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 884.028 us                | 12.318 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 257.670 ms                | 524.312 ms                |
| Optimize                  | 1.651 ms                  | 2.572 ms                  |
| BarrierTimeBeforeRank0    | 663.210 us                | 70.235 ms                 |
| BlockToStepN              | 5.918 us                  | 33.354 us                 |
| OneStep                   | 271.590 ms                | 547.372 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 39.753, sample: 0.223, forward: 0.493, backward: 37.624, update: 0.149
[proc 0] 200 steps, total: 39.753, sample: 0.237, forward: 0.540, backward: 38.293, update: 0.160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 882.862 us                | 12.318 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 262.568 ms                | 563.450 ms                |
| Optimize                  | 1.650 ms                  | 2.572 ms                  |
| BarrierTimeBeforeRank0    | 541.212 us                | 70.235 ms                 |
| BlockToStepN              | 5.989 us                  | 33.354 us                 |
| OneStep                   | 278.255 ms                | 581.238 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 884.966 us                | 12.318 ms                 |
| Forward                   | 5.335 ms                  | 8.788 ms                  |
| Backward                  | 272.566 ms                | 590.113 ms                |
| Optimize                  | 1.653 ms                  | 2.572 ms                  |
| BarrierTimeBeforeRank0    | 543.997 us                | 70.235 ms                 |
| BlockToStepN              | 5.994 us                  | 33.354 us                 |
| OneStep                   | 296.153 ms                | 606.520 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 888.900 us                | 12.318 ms                 |
| Forward                   | 5.337 ms                  | 8.788 ms                  |
| Backward                  | 289.741 ms                | 602.012 ms                |
| Optimize                  | 1.656 ms                  | 2.586 ms                  |
| BarrierTimeBeforeRank0    | 543.997 us                | 70.235 ms                 |
| BlockToStepN              | 5.989 us                  | 33.354 us                 |
| OneStep                   | 302.331 ms                | 611.554 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 892.253 us                | 12.318 ms                 |
| Forward                   | 5.329 ms                  | 8.788 ms                  |
| Backward                  | 299.699 ms                | 645.998 ms                |
| Optimize                  | 1.656 ms                  | 2.586 ms                  |
| BarrierTimeBeforeRank0    | 541.212 us                | 70.235 ms                 |
| BlockToStepN              | 5.989 us                  | 33.354 us                 |
| OneStep                   | 315.115 ms                | 664.466 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 890.611 us                | 12.318 ms                 |
| Forward                   | 5.314 ms                  | 8.788 ms                  |
| Backward                  | 310.342 ms                | 683.444 ms                |
| Optimize                  | 1.656 ms                  | 2.586 ms                  |
| BarrierTimeBeforeRank0    | 385.292 us                | 70.235 ms                 |
| BlockToStepN              | 5.996 us                  | 33.354 us                 |
| OneStep                   | 327.636 ms                | 695.291 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 895.529 us                | 12.318 ms                 |
| Forward                   | 5.320 ms                  | 8.788 ms                  |
| Backward                  | 315.417 ms                | 703.779 ms                |
| Optimize                  | 1.658 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 232.936 us                | 70.235 ms                 |
| BlockToStepN              | 6.050 us                  | 33.354 us                 |
| OneStep                   | 336.156 ms                | 717.003 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 897.243 us                | 11.893 ms                 |
| Forward                   | 5.320 ms                  | 8.783 ms                  |
| Backward                  | 323.772 ms                | 730.660 ms                |
| Optimize                  | 1.659 ms                  | 2.586 ms                  |
| BarrierTimeBeforeRank0    | 125.282 us                | 50.530 ms                 |
| BlockToStepN              | 6.050 us                  | 17.684 us                 |
| OneStep                   | 343.040 ms                | 739.822 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 897.243 us                | 11.986 ms                 |
| Forward                   | 5.320 ms                  | 8.783 ms                  |
| Backward                  | 328.417 ms                | 749.880 ms                |
| Optimize                  | 1.659 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 125.282 us                | 50.530 ms                 |
| BlockToStepN              | 6.073 us                  | 17.684 us                 |
| OneStep                   | 350.832 ms                | 758.712 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 895.663 us                | 11.986 ms                 |
| Forward                   | 5.327 ms                  | 8.783 ms                  |
| Backward                  | 339.455 ms                | 749.880 ms                |
| Optimize                  | 1.659 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 109.813 us                | 50.530 ms                 |
| BlockToStepN              | 6.075 us                  | 21.888 us                 |
| OneStep                   | 357.186 ms                | 758.712 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 895.663 us                | 11.986 ms                 |
| Forward                   | 5.325 ms                  | 8.783 ms                  |
| Backward                  | 352.860 ms                | 749.880 ms                |
| Optimize                  | 1.661 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 107.597 us                | 50.530 ms                 |
| BlockToStepN              | 6.075 us                  | 21.888 us                 |
| OneStep                   | 369.692 ms                | 758.712 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 897.808 us                | 11.986 ms                 |
| Forward                   | 5.327 ms                  | 8.783 ms                  |
| Backward                  | 359.035 ms                | 754.803 ms                |
| Optimize                  | 1.659 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 77.914 us                 | 50.530 ms                 |
| BlockToStepN              | 6.114 us                  | 21.888 us                 |
| OneStep                   | 378.381 ms                | 772.785 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 897.243 us                | 11.986 ms                 |
| Forward                   | 5.327 ms                  | 8.788 ms                  |
| Backward                  | 372.384 ms                | 780.964 ms                |
| Optimize                  | 1.661 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 77.914 us                 | 50.530 ms                 |
| BlockToStepN              | 6.180 us                  | 21.888 us                 |
| OneStep                   | 388.058 ms                | 789.284 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 899.171 us                | 11.986 ms                 |
| Forward                   | 5.327 ms                  | 8.788 ms                  |
| Backward                  | 375.114 ms                | 797.382 ms                |
| Optimize                  | 1.659 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 76.050 us                 | 50.530 ms                 |
| BlockToStepN              | 6.208 us                  | 21.888 us                 |
| OneStep                   | 391.079 ms                | 805.625 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 66.301, sample: 0.198, forward: 0.494, backward: 61.511, update: 0.152
[proc 0] 300 steps, total: 66.301, sample: 0.222, forward: 0.540, backward: 65.130, update: 0.173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 899.209 us                | 11.986 ms                 |
| Forward                   | 5.327 ms                  | 8.788 ms                  |
| Backward                  | 382.656 ms                | 827.991 ms                |
| Optimize                  | 1.662 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 75.450 us                 | 50.530 ms                 |
| BlockToStepN              | 6.208 us                  | 21.888 us                 |
| OneStep                   | 401.515 ms                | 844.983 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 901.279 us                | 12.318 ms                 |
| Forward                   | 5.329 ms                  | 8.788 ms                  |
| Backward                  | 393.325 ms                | 843.854 ms                |
| Optimize                  | 1.662 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 72.776 us                 | 50.530 ms                 |
| BlockToStepN              | 6.209 us                  | 21.888 us                 |
| OneStep                   | 403.464 ms                | 851.858 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 903.247 us                | 12.318 ms                 |
| Forward                   | 5.329 ms                  | 8.788 ms                  |
| Backward                  | 394.551 ms                | 862.798 ms                |
| Optimize                  | 1.662 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 72.776 us                 | 64.978 ms                 |
| BlockToStepN              | 6.209 us                  | 33.354 us                 |
| OneStep                   | 415.060 ms                | 870.405 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 901.676 us                | 12.318 ms                 |
| Forward                   | 5.329 ms                  | 8.788 ms                  |
| Backward                  | 401.738 ms                | 866.469 ms                |
| Optimize                  | 1.662 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 70.966 us                 | 70.235 ms                 |
| BlockToStepN              | 6.295 us                  | 33.354 us                 |
| OneStep                   | 419.864 ms                | 882.614 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 901.676 us                | 12.318 ms                 |
| Forward                   | 5.331 ms                  | 8.788 ms                  |
| Backward                  | 413.019 ms                | 900.202 ms                |
| Optimize                  | 1.662 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 70.966 us                 | 70.235 ms                 |
| BlockToStepN              | 6.336 us                  | 33.354 us                 |
| OneStep                   | 429.192 ms                | 907.979 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 901.279 us                | 12.318 ms                 |
| Forward                   | 5.335 ms                  | 8.788 ms                  |
| Backward                  | 422.061 ms                | 917.098 ms                |
| Optimize                  | 1.662 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 70.528 us                 | 70.235 ms                 |
| BlockToStepN              | 6.347 us                  | 37.377 us                 |
| OneStep                   | 444.505 ms                | 925.884 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 903.247 us                | 12.318 ms                 |
| Forward                   | 5.338 ms                  | 8.788 ms                  |
| Backward                  | 436.128 ms                | 925.712 ms                |
| Optimize                  | 1.662 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 70.336 us                 | 70.235 ms                 |
| BlockToStepN              | 6.485 us                  | 37.377 us                 |
| OneStep                   | 449.262 ms                | 933.926 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.550 us                | 12.318 ms                 |
| Forward                   | 5.338 ms                  | 8.788 ms                  |
| Backward                  | 438.462 ms                | 928.504 ms                |
| Optimize                  | 1.662 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 66.719 us                 | 70.235 ms                 |
| BlockToStepN              | 6.489 us                  | 37.377 us                 |
| OneStep                   | 451.715 ms                | 937.235 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.646 us                | 11.986 ms                 |
| Forward                   | 5.338 ms                  | 8.783 ms                  |
| Backward                  | 443.751 ms                | 945.591 ms                |
| Optimize                  | 1.663 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 66.719 us                 | 70.235 ms                 |
| BlockToStepN              | 6.528 us                  | 37.377 us                 |
| OneStep                   | 459.217 ms                | 954.139 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.550 us                | 11.986 ms                 |
| Forward                   | 5.338 ms                  | 8.783 ms                  |
| Backward                  | 450.202 ms                | 949.013 ms                |
| Optimize                  | 1.663 ms                  | 2.791 ms                  |
| BarrierTimeBeforeRank0    | 66.719 us                 | 69.677 ms                 |
| BlockToStepN              | 6.528 us                  | 33.354 us                 |
| OneStep                   | 461.057 ms                | 962.858 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.682 us                | 11.986 ms                 |
| Forward                   | 5.345 ms                  | 8.783 ms                  |
| Backward                  | 452.732 ms                | 955.373 ms                |
| Optimize                  | 1.663 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 65.956 us                 | 70.235 ms                 |
| BlockToStepN              | 6.614 us                  | 33.354 us                 |
| OneStep                   | 465.413 ms                | 966.955 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.682 us                | 11.986 ms                 |
| Forward                   | 5.339 ms                  | 8.783 ms                  |
| Backward                  | 466.939 ms                | 973.909 ms                |
| Optimize                  | 1.664 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 62.799 us                 | 70.235 ms                 |
| BlockToStepN              | 6.795 us                  | 33.354 us                 |
| OneStep                   | 477.944 ms                | 982.122 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 905.582 us                | 11.986 ms                 |
| Forward                   | 5.345 ms                  | 8.783 ms                  |
| Backward                  | 469.322 ms                | 998.969 ms                |
| Optimize                  | 1.665 ms                  | 2.826 ms                  |
| BarrierTimeBeforeRank0    | 62.799 us                 | 70.235 ms                 |
| BlockToStepN              | 6.850 us                  | 33.354 us                 |
| OneStep                   | 490.026 ms                | 1.010 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 908.227 us                | 12.318 ms                 |
| Forward                   | 5.346 ms                  | 8.783 ms                  |
| Backward                  | 478.068 ms                | 1.000 s                   |
| Optimize                  | 1.666 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 60.752 us                 | 70.235 ms                 |
| BlockToStepN              | 6.850 us                  | 33.354 us                 |
| OneStep                   | 494.272 ms                | 1.013 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.073 us                | 12.318 ms                 |
| Forward                   | 5.339 ms                  | 8.783 ms                  |
| Backward                  | 487.354 ms                | 1.017 s                   |
| Optimize                  | 1.667 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 59.648 us                 | 70.235 ms                 |
| BlockToStepN              | 6.852 us                  | 33.354 us                 |
| OneStep                   | 502.612 ms                | 1.035 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.073 us                | 12.318 ms                 |
| Forward                   | 5.345 ms                  | 8.783 ms                  |
| Backward                  | 490.019 ms                | 1.047 s                   |
| Optimize                  | 1.667 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 57.692 us                 | 70.235 ms                 |
| BlockToStepN              | 6.887 us                  | 33.354 us                 |
| OneStep                   | 508.130 ms                | 1.055 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 906.073 us                | 12.318 ms                 |
| Forward                   | 5.338 ms                  | 8.783 ms                  |
| Backward                  | 499.061 ms                | 1.054 s                   |
| Optimize                  | 1.668 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 57.036 us                 | 70.235 ms                 |
| BlockToStepN              | 6.959 us                  | 33.354 us                 |
| OneStep                   | 525.560 ms                | 1.063 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 908.227 us                | 12.318 ms                 |
| Forward                   | 5.345 ms                  | 8.783 ms                  |
| Backward                  | 511.553 ms                | 1.060 s                   |
| Optimize                  | 1.669 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 57.036 us                 | 70.235 ms                 |
| BlockToStepN              | 6.959 us                  | 33.354 us                 |
| OneStep                   | 527.237 ms                | 1.068 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 92.401, sample: 0.202, forward: 0.491, backward: 85.992, update: 0.155
[proc 0] 400 steps, total: 92.401, sample: 0.229, forward: 0.551, backward: 90.817, update: 0.181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 909.793 us                | 12.318 ms                 |
| Forward                   | 5.348 ms                  | 8.783 ms                  |
| Backward                  | 513.197 ms                | 1.069 s                   |
| Optimize                  | 1.669 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.673 us                 | 70.235 ms                 |
| BlockToStepN              | 6.967 us                  | 33.354 us                 |
| OneStep                   | 529.393 ms                | 1.079 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 908.227 us                | 12.318 ms                 |
| Forward                   | 5.347 ms                  | 8.783 ms                  |
| Backward                  | 517.324 ms                | 1.097 s                   |
| Optimize                  | 1.669 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.673 us                 | 70.235 ms                 |
| BlockToStepN              | 6.975 us                  | 33.354 us                 |
| OneStep                   | 536.478 ms                | 1.106 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 909.354 us                | 12.318 ms                 |
| Forward                   | 5.347 ms                  | 8.783 ms                  |
| Backward                  | 524.312 ms                | 1.098 s                   |
| Optimize                  | 1.669 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.390 us                 | 70.235 ms                 |
| BlockToStepN              | 6.975 us                  | 33.354 us                 |
| OneStep                   | 543.444 ms                | 1.111 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 909.793 us                | 12.318 ms                 |
| Forward                   | 5.348 ms                  | 8.783 ms                  |
| Backward                  | 529.743 ms                | 1.107 s                   |
| Optimize                  | 1.669 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.361 us                 | 70.235 ms                 |
| BlockToStepN              | 7.000 us                  | 33.354 us                 |
| OneStep                   | 545.614 ms                | 1.116 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 909.793 us                | 12.318 ms                 |
| Forward                   | 5.348 ms                  | 8.783 ms                  |
| Backward                  | 536.400 ms                | 1.127 s                   |
| Optimize                  | 1.671 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.361 us                 | 70.235 ms                 |
| BlockToStepN              | 7.012 us                  | 33.354 us                 |
| OneStep                   | 555.775 ms                | 1.136 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 911.570 us                | 12.318 ms                 |
| Forward                   | 5.348 ms                  | 8.783 ms                  |
| Backward                  | 539.742 ms                | 1.131 s                   |
| Optimize                  | 1.672 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 56.112 us                 | 70.235 ms                 |
| BlockToStepN              | 7.071 us                  | 33.354 us                 |
| OneStep                   | 562.129 ms                | 1.139 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 911.570 us                | 12.318 ms                 |
| Forward                   | 5.350 ms                  | 8.783 ms                  |
| Backward                  | 552.700 ms                | 1.143 s                   |
| Optimize                  | 1.674 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.829 us                 | 70.235 ms                 |
| BlockToStepN              | 7.083 us                  | 33.354 us                 |
| OneStep                   | 563.610 ms                | 1.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 911.570 us                | 12.318 ms                 |
| Forward                   | 5.350 ms                  | 8.783 ms                  |
| Backward                  | 554.175 ms                | 1.146 s                   |
| Optimize                  | 1.674 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.829 us                 | 70.235 ms                 |
| BlockToStepN              | 7.083 us                  | 33.354 us                 |
| OneStep                   | 567.882 ms                | 1.154 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 912.103 us                | 12.318 ms                 |
| Forward                   | 5.353 ms                  | 8.783 ms                  |
| Backward                  | 561.750 ms                | 1.184 s                   |
| Optimize                  | 1.676 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.829 us                 | 70.235 ms                 |
| BlockToStepN              | 7.096 us                  | 33.354 us                 |
| OneStep                   | 579.439 ms                | 1.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 912.406 us                | 12.318 ms                 |
| Forward                   | 5.350 ms                  | 8.783 ms                  |
| Backward                  | 563.476 ms                | 1.184 s                   |
| Optimize                  | 1.676 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.857 us                 | 70.807 ms                 |
| BlockToStepN              | 7.096 us                  | 33.354 us                 |
| OneStep                   | 581.238 ms                | 1.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 913.927 us                | 14.167 ms                 |
| Forward                   | 5.350 ms                  | 8.783 ms                  |
| Backward                  | 570.514 ms                | 1.199 s                   |
| Optimize                  | 1.676 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.829 us                 | 70.807 ms                 |
| BlockToStepN              | 7.161 us                  | 33.354 us                 |
| OneStep                   | 584.395 ms                | 1.207 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 914.762 us                | 14.167 ms                 |
| Forward                   | 5.354 ms                  | 8.783 ms                  |
| Backward                  | 573.997 ms                | 1.223 s                   |
| Optimize                  | 1.676 ms                  | 2.852 ms                  |
| BarrierTimeBeforeRank0    | 55.829 us                 | 70.807 ms                 |
| BlockToStepN              | 7.161 us                  | 33.354 us                 |
| OneStep                   | 586.794 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.427 us                | 12.321 ms                 |
| Forward                   | 5.356 ms                  | 7.507 ms                  |
| Backward                  | 578.313 ms                | 1.243 s                   |
| Optimize                  | 1.678 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 54.439 us                 | 70.235 ms                 |
| BlockToStepN              | 7.201 us                  | 33.354 us                 |
| OneStep                   | 592.915 ms                | 1.253 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.684 us                | 12.321 ms                 |
| Forward                   | 5.356 ms                  | 7.507 ms                  |
| Backward                  | 590.113 ms                | 1.246 s                   |
| Optimize                  | 1.681 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 54.403 us                 | 70.235 ms                 |
| BlockToStepN              | 7.230 us                  | 33.354 us                 |
| OneStep                   | 603.124 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.684 us                | 12.321 ms                 |
| Forward                   | 5.356 ms                  | 7.507 ms                  |
| Backward                  | 591.871 ms                | 1.273 s                   |
| Optimize                  | 1.683 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 54.163 us                 | 70.235 ms                 |
| BlockToStepN              | 7.230 us                  | 33.354 us                 |
| OneStep                   | 606.520 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 916.562 us                | 12.321 ms                 |
| Forward                   | 5.361 ms                  | 7.507 ms                  |
| Backward                  | 600.944 ms                | 1.273 s                   |
| Optimize                  | 1.684 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 54.153 us                 | 70.807 ms                 |
| BlockToStepN              | 7.230 us                  | 33.354 us                 |
| OneStep                   | 610.043 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 917.519 us                | 12.321 ms                 |
| Forward                   | 5.360 ms                  | 7.507 ms                  |
| Backward                  | 602.778 ms                | 1.273 s                   |
| Optimize                  | 1.684 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.811 us                 | 70.807 ms                 |
| BlockToStepN              | 7.240 us                  | 33.354 us                 |
| OneStep                   | 613.861 ms                | 1.282 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 917.519 us                | 12.321 ms                 |
| Forward                   | 5.362 ms                  | 7.507 ms                  |
| Backward                  | 612.891 ms                | 1.278 s                   |
| Optimize                  | 1.684 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.811 us                 | 70.807 ms                 |
| BlockToStepN              | 7.288 us                  | 33.354 us                 |
| OneStep                   | 626.389 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.098 us                | 12.321 ms                 |
| Forward                   | 5.362 ms                  | 7.507 ms                  |
| Backward                  | 617.849 ms                | 1.287 s                   |
| Optimize                  | 1.684 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.704 us                 | 70.807 ms                 |
| BlockToStepN              | 7.311 us                  | 37.377 us                 |
| OneStep                   | 631.914 ms                | 1.295 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.865 us                | 12.321 ms                 |
| Forward                   | 5.363 ms                  | 7.507 ms                  |
| Backward                  | 631.142 ms                | 1.290 s                   |
| Optimize                  | 1.685 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.704 us                 | 70.807 ms                 |
| BlockToStepN              | 7.311 us                  | 37.377 us                 |
| OneStep                   | 645.445 ms                | 1.299 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.865 us                | 12.321 ms                 |
| Forward                   | 5.365 ms                  | 7.507 ms                  |
| Backward                  | 636.165 ms                | 1.313 s                   |
| Optimize                  | 1.685 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.681 us                 | 70.807 ms                 |
| BlockToStepN              | 7.311 us                  | 43.379 us                 |
| OneStep                   | 647.714 ms                | 1.321 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.098 us                | 12.321 ms                 |
| Forward                   | 5.363 ms                  | 7.507 ms                  |
| Backward                  | 637.537 ms                | 1.337 s                   |
| Optimize                  | 1.685 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.676 us                 | 70.807 ms                 |
| BlockToStepN              | 7.335 us                  | 43.379 us                 |
| OneStep                   | 653.973 ms                | 1.346 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 919.789 us                | 12.321 ms                 |
| Forward                   | 5.365 ms                  | 7.507 ms                  |
| Backward                  | 643.835 ms                | 1.339 s                   |
| Optimize                  | 1.685 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.676 us                 | 70.807 ms                 |
| BlockToStepN              | 7.335 us                  | 54.831 us                 |
| OneStep                   | 656.047 ms                | 1.355 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.098 us                | 12.321 ms                 |
| Forward                   | 5.365 ms                  | 7.507 ms                  |
| Backward                  | 645.998 ms                | 1.375 s                   |
| Optimize                  | 1.685 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.522 us                 | 70.807 ms                 |
| BlockToStepN              | 7.338 us                  | 54.831 us                 |
| OneStep                   | 660.995 ms                | 1.383 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 119.093, sample: 0.204, forward: 0.497, backward: 109.910, update: 0.156
[proc 0] 500 steps, total: 119.093, sample: 0.256, forward: 0.555, backward: 117.595, update: 0.183
Successfully xmh. training takes 333.03607654571533 seconds
before call kg_cache_controller.StopThreads()
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
INFO [4912 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.098 us                | 12.321 ms                 |
| Forward                   | 5.365 ms                  | 7.507 ms                  |
| Backward                  | 647.195 ms                | 1.378 s                   |
| Optimize                  | 1.684 ms                  | 2.844 ms                  |
| BarrierTimeBeforeRank0    | 53.050 us                 | 70.807 ms                 |
| BlockToStepN              | 7.338 us                  | 54.831 us                 |
| OneStep                   | 664.466 ms                | 1.390 s                   |
+---------------------------+---------------------------+---------------------------+
