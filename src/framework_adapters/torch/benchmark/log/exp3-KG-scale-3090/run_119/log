WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 08:23:46.320395 12819 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_66', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [12819 sampler.py:454] Start PreSampling
WARNING [12819 sampler.py:532] Before construct renumbering_dict
WARNING [12819 sampler.py:555] PreSampling done
W20240124 08:37:40.493602 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 08:37:40.493842 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 08:37:40.493880 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 08:37:40.493909 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 08:37:40.493939 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 08:37:40.493968 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 08:37:40.493999 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 08:37:40.494031 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 08:37:40.494058 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 08:37:40.494086 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 08:37:40.494123 12819 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 08:37:40.494148 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 08:37:40.494174 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 08:37:40.494331 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 08:37:40.494357 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 08:37:40.494380 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 08:37:40.494424 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 08:37:40.494449 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 08:37:40.494478 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 08:37:40.494513 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 08:37:40.494545 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 08:37:40.494577 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 08:37:40.494606 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 08:37:40.494630 12819 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 08:37:40.494652 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 08:37:40.494676 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 08:37:40.494730 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 08:37:40.494755 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 08:37:40.494788 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 08:37:40.494808 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 08:37:40.494829 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 08:37:40.494859 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 08:37:40.494896 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 08:37:40.494922 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 08:37:40.494942 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 08:37:40.494969 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 08:37:40.494993 12819 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 08:37:40.495009 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 08:37:40.495028 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 08:37:40.495077 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 08:37:40.495103 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 08:37:40.495126 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 08:37:40.495146 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 08:37:40.495164 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 08:37:40.495190 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 08:37:40.495215 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 08:37:40.495237 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 08:37:40.495261 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 08:37:40.495283 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 08:37:40.495306 12819 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 08:37:40.495323 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 08:37:40.495339 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 08:37:40.495383 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 08:37:40.495414 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 08:37:40.495436 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 08:37:40.495462 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 08:37:40.495482 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 08:37:40.495505 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 08:37:40.495524 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 08:37:40.495550 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 08:37:40.495573 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 08:37:40.495599 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 08:37:40.495618 12819 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 08:37:40.495635 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 08:37:40.495653 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 08:37:40.495700 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 08:37:40.495728 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 08:37:40.495747 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 08:37:40.495766 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 08:37:40.495787 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 08:37:40.495811 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 08:37:40.495836 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 08:37:40.495857 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 08:37:40.495878 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 08:37:40.495900 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 08:37:40.495920 12819 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 08:37:40.495936 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 08:37:40.495952 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 08:37:40.495998 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 08:37:40.496019 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 08:37:40.496042 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 08:37:40.496062 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 08:37:40.496081 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 08:37:40.496102 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 08:37:40.496130 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 08:37:40.496156 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 08:37:40.496186 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 08:37:40.496212 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 08:37:40.496237 12819 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 08:37:40.496259 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 08:37:40.496275 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 08:37:40.496316 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 08:37:40.496343 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 08:37:40.496368 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 08:37:40.496392 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 08:37:40.496414 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 08:37:40.496441 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 08:37:40.496464 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 08:37:40.496485 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 08:37:40.496515 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 08:37:40.496541 12819 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 08:37:40.496560 12819 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 08:37:40.496577 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 08:37:40.496598 12819 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 08:37:40.840508 12819 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 08:37:40.840698 12819 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302728,  4302751,  4302777,  ..., 48849671, 17077436, 34095836]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1010.252 seconds
[Rank1] pid = 45375
[Rank2] pid = 45477
[Rank3] pid = 45559
[Rank4] pid = 45632
[Rank5] pid = 45712
[Rank6] pid = 45796
INFO [12819 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [45375 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [45477 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [45559 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [45796 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [45632 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [45796 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45872 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [45712 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12819 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45872 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45712 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45632 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45559 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45477 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45375 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [45796 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45872 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [12819 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45559 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45632 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45477 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45375 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [45712 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 08:40:52.762351 45713 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.762718 45478 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.762884 45936 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.763041 45633 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.763298 45873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.763427 45797 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.763582 45560 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 08:40:52.763722 45376 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 08:40:59.869689 45936 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 08:41:00.244150 45713 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:00.977324 45478 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:01.715270 45797 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:02.380949 45873 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:02.542093 45560 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:02.669353 45376 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 08:41:03.071170 45633 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.375 ms                  | 19.225 ms                 |
| bucket keys               | 1.800 ms                  | 149.503 ms                |
| forward: a2a keys         | 2.494 ms                  | 1.266 s                   |
| forward: search cache     | 421.538 us                | 26.391 ms                 |
| forward: a2a values       | 10.889 ms                 | 28.054 ms                 |
| forward: join             | 1.973 ms                  | 2.701 ms                  |
| Forward                   | 41.360 ms                 | 2.014 s                   |
| back: aggr dram keys      | 27.158 ms                 | 987.877 ms                |
| back: set dram grad       | 1.278 ms                  | 8.957 ms                  |
| back: a2a grad            | 11.077 ms                 | 36.808 ms                 |
| back: grad sum & grad cache  | 3.819 ms                  | 103.463 ms                |
| Backward                  | 196.653 ms                | 1.295 s                   |
| Optimize                  | 20.129 ms                 | 32.414 ms                 |
| BarrierTimeBeforeRank0    | 62.711 us                 | 78.024 us                 |
| BlockToStepN              | 52.473 us                 | 95.350 us                 |
| OneStep                   | 262.561 ms                | 3.359 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.139 ms                  | 77.410 ms                 |
| bucket keys               | 1.722 ms                  | 149.503 ms                |
| forward: a2a keys         | 3.026 ms                  | 1.266 s                   |
| forward: search cache     | 319.626 us                | 26.391 ms                 |
| forward: a2a values       | 10.889 ms                 | 28.054 ms                 |
| forward: join             | 1.931 ms                  | 3.651 ms                  |
| Forward                   | 41.617 ms                 | 2.014 s                   |
| back: aggr dram keys      | 30.762 ms                 | 987.877 ms                |
| back: set dram grad       | 1.390 ms                  | 8.957 ms                  |
| back: a2a grad            | 13.541 ms                 | 36.808 ms                 |
| back: grad sum & grad cache  | 3.841 ms                  | 103.463 ms                |
| Backward                  | 188.990 ms                | 1.295 s                   |
| Optimize                  | 20.142 ms                 | 32.414 ms                 |
| BarrierTimeBeforeRank0    | 62.935 us                 | 92.771 us                 |
| BlockToStepN              | 51.425 us                 | 103.025 us                |
| OneStep                   | 274.160 ms                | 3.359 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.119 ms                  | 77.410 ms                 |
| bucket keys               | 1.752 ms                  | 4.355 ms                  |
| forward: a2a keys         | 3.026 ms                  | 37.487 ms                 |
| forward: search cache     | 319.626 us                | 803.755 us                |
| forward: a2a values       | 10.889 ms                 | 31.830 ms                 |
| forward: join             | 1.931 ms                  | 3.651 ms                  |
| Forward                   | 42.236 ms                 | 2.014 s                   |
| back: aggr dram keys      | 34.832 ms                 | 77.738 ms                 |
| back: set dram grad       | 1.945 ms                  | 6.749 ms                  |
| back: a2a grad            | 14.821 ms                 | 38.657 ms                 |
| back: grad sum & grad cache  | 4.542 ms                  | 100.028 ms                |
| Backward                  | 193.838 ms                | 1.295 s                   |
| Optimize                  | 20.480 ms                 | 37.142 ms                 |
| BarrierTimeBeforeRank0    | 55.831 us                 | 92.771 us                 |
| BlockToStepN              | 49.464 us                 | 8.813 ms                  |
| OneStep                   | 276.204 ms                | 3.359 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.182 ms                  | 71.723 ms                 |
| bucket keys               | 1.752 ms                  | 4.355 ms                  |
| forward: a2a keys         | 3.710 ms                  | 37.487 ms                 |
| forward: search cache     | 318.758 us                | 803.755 us                |
| forward: a2a values       | 14.095 ms                 | 31.830 ms                 |
| forward: join             | 1.922 ms                  | 3.651 ms                  |
| Forward                   | 44.371 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 48.718 ms                 | 77.738 ms                 |
| back: set dram grad       | 2.189 ms                  | 6.749 ms                  |
| back: a2a grad            | 17.997 ms                 | 39.918 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 103.463 ms                |
| Backward                  | 193.864 ms                | 260.894 ms                |
| Optimize                  | 20.480 ms                 | 32.414 ms                 |
| BarrierTimeBeforeRank0    | 53.217 us                 | 88.382 us                 |
| BlockToStepN              | 51.972 us                 | 14.624 ms                 |
| OneStep                   | 282.417 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.508 ms                  | 71.723 ms                 |
| bucket keys               | 1.722 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.959 ms                  | 33.529 ms                 |
| forward: search cache     | 318.758 us                | 794.815 us                |
| forward: a2a values       | 14.033 ms                 | 28.054 ms                 |
| forward: join             | 1.831 ms                  | 3.435 ms                  |
| Forward                   | 44.388 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 48.718 ms                 | 71.599 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.468 ms                  |
| back: a2a grad            | 18.262 ms                 | 38.657 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 100.028 ms                |
| Backward                  | 194.713 ms                | 260.894 ms                |
| Optimize                  | 20.534 ms                 | 33.449 ms                 |
| BarrierTimeBeforeRank0    | 51.313 us                 | 88.382 us                 |
| BlockToStepN              | 51.972 us                 | 14.624 ms                 |
| OneStep                   | 275.701 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.130 ms                  | 71.723 ms                 |
| bucket keys               | 1.774 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.491 ms                  | 33.529 ms                 |
| forward: search cache     | 341.402 us                | 794.815 us                |
| forward: a2a values       | 14.033 ms                 | 28.054 ms                 |
| forward: join             | 1.831 ms                  | 3.435 ms                  |
| Forward                   | 43.981 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 71.599 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.468 ms                  |
| back: a2a grad            | 18.399 ms                 | 39.918 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 100.028 ms                |
| Backward                  | 193.990 ms                | 260.894 ms                |
| Optimize                  | 20.544 ms                 | 37.756 ms                 |
| BarrierTimeBeforeRank0    | 53.029 us                 | 92.771 us                 |
| BlockToStepN              | 51.033 us                 | 14.624 ms                 |
| OneStep                   | 274.409 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank7] pid = 45872
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([  223236,    79623,   135056, 12707224,    79683,    79730,   223252,
           79782,    79824,    79874]) tensor([ 4951749, 12162230, 61222800, 59289100, 19992243,   412426, 16399060,
        65381996, 53455841, 44347542])
-------Step 1-------
tensor([  223236,    79623,   135056, 12707224,    79683,    79730,   223252,
           79782,    79824,    79874]) tensor([82957666, 24314107, 41539351, 45100241, 57255516, 12046429, 38879099,
          562525, 26438163, 51220033])
-------Step 2-------
tensor([   20392,   321075,   451969, 13815240,   164082,   164128,   164165,
          164220,   164269,   164315]) tensor([58339613, 27011837,  1460471, 31020284, 25797519, 20249572,  8178275,
        63592970, 74032811, 34037615])
-------Step 3-------
tensor([   20392,   321075,   451969, 13815240,   164082,   164128,   164165,
          164220,   164269,   164315]) tensor([17735997, 82880154, 71494048, 40433609, 82296507, 79319759, 62135830,
        27973419, 79897845, 12405546])
-------Step 4-------
tensor([  244578,   244601,   244629, 85945423,   244653,   244682,   244711,
          244736,   244770, 24363400]) tensor([76955855, 46230379, 76053914, 30556604,   327768,  4351362, 27238507,
        57649403, 76271191, 11554654])
-------Step 5-------
tensor([  244578,   244601,   244629, 85945423,   244653,   244682,   244711,
          244736,   244770, 24363400]) tensor([51706357, 47339077, 37035974,    43400, 67242584, 52385676, 53460671,
         1462032, 72683971, 26969128])
-------Step 6-------
tensor([ 6279599,  5233808,   299831, 29069874,   299862,   299893, 78337960,
        36068596,   299920,   299946]) tensor([35110944,   288934, 55622509, 14433060, 24548716, 30859001, 19813948,
        72999695, 64341665, 57983516])
-------Step 7-------
tensor([ 6279599,  5233808,   299831, 29069874,   299862,   299893, 78337960,
        36068596,   299920,   299946]) tensor([20571375,  8944428, 39538184, 12226416, 41515333, 61087928,  4315183,
        16932056, 35319248, 59338340])
-------Step 8-------
tensor([  355778,   355816, 80235786,   355859,   348283,   348311, 11694737,
          355891,   355919,   461659]) tensor([20255313, 27462455, 72106070,  5337502, 78832589,  6047120,  5475850,
        14891614, 75126559,  5566693])
-------Step 9-------
tensor([  355778,   355816, 80235786,   355859,   348283,   348311, 11694737,
          355891,   355919,   461659]) tensor([57641822, 21557076, 43060831, 82476045, 51353405, 73208896, 79877843,
        16468676, 19099914,  6191558])
before start barrier
start train
[proc 0] 100 steps, total: 31.988, sample: 1.113, forward: 6.670, backward: 20.943, update: 2.391
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 31.699, sample: 0.757, forward: 7.345, backward: 13.264, update: 0.236
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 32.653, sample: 0.741, forward: 7.376, backward: 12.584, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 31.297, sample: 0.822, forward: 7.245, backward: 12.588, update: 0.274
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.391, sample: 0.742, forward: 7.367, backward: 12.850, update: 0.280
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 34.499, sample: 0.752, forward: 7.415, backward: 12.750, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 34.124, sample: 0.992, forward: 7.129, backward: 12.638, update: 0.266
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 31.826, sample: 0.730, forward: 7.354, backward: 12.803, update: 0.271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.938 ms                  | 77.410 ms                 |
| bucket keys               | 1.801 ms                  | 3.833 ms                  |
| forward: a2a keys         | 3.491 ms                  | 33.529 ms                 |
| forward: search cache     | 354.820 us                | 803.755 us                |
| forward: a2a values       | 13.370 ms                 | 28.054 ms                 |
| forward: join             | 1.831 ms                  | 3.435 ms                  |
| Forward                   | 43.981 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.468 ms                  |
| back: a2a grad            | 18.431 ms                 | 43.826 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 100.028 ms                |
| Backward                  | 195.811 ms                | 260.894 ms                |
| Optimize                  | 20.567 ms                 | 37.756 ms                 |
| BarrierTimeBeforeRank0    | 53.186 us                 | 92.771 us                 |
| BlockToStepN              | 50.688 us                 | 23.071 ms                 |
| OneStep                   | 276.204 ms                | 383.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.795 ms                  | 77.410 ms                 |
| bucket keys               | 1.770 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.805 ms                  | 33.529 ms                 |
| forward: search cache     | 330.919 us                | 803.542 us                |
| forward: a2a values       | 13.370 ms                 | 24.654 ms                 |
| forward: join             | 1.831 ms                  | 3.278 ms                  |
| Forward                   | 44.388 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 48.718 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.666 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.423 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 99.861 ms                 |
| Backward                  | 195.425 ms                | 260.894 ms                |
| Optimize                  | 20.567 ms                 | 37.756 ms                 |
| BarrierTimeBeforeRank0    | 51.140 us                 | 92.771 us                 |
| BlockToStepN              | 52.071 us                 | 23.071 ms                 |
| OneStep                   | 277.499 ms                | 383.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.384 ms                  | 77.410 ms                 |
| bucket keys               | 1.765 ms                  | 3.719 ms                  |
| forward: a2a keys         | 4.143 ms                  | 37.487 ms                 |
| forward: search cache     | 326.904 us                | 803.542 us                |
| forward: a2a values       | 13.370 ms                 | 24.654 ms                 |
| forward: join             | 1.844 ms                  | 3.651 ms                  |
| Forward                   | 45.357 ms                 | 94.547 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 75.127 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.431 ms                 | 41.581 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 99.861 ms                 |
| Backward                  | 194.975 ms                | 260.894 ms                |
| Optimize                  | 20.677 ms                 | 47.615 ms                 |
| BarrierTimeBeforeRank0    | 50.093 us                 | 92.771 us                 |
| BlockToStepN              | 52.702 us                 | 23.071 ms                 |
| OneStep                   | 279.776 ms                | 383.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.308 ms                  | 71.723 ms                 |
| bucket keys               | 1.765 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.955 ms                  | 37.487 ms                 |
| forward: search cache     | 325.034 us                | 803.755 us                |
| forward: a2a values       | 13.370 ms                 | 24.654 ms                 |
| forward: join             | 1.844 ms                  | 3.768 ms                  |
| Forward                   | 44.406 ms                 | 91.138 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 75.127 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.431 ms                 | 41.581 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 99.861 ms                 |
| Backward                  | 194.131 ms                | 250.191 ms                |
| Optimize                  | 20.726 ms                 | 44.795 ms                 |
| BarrierTimeBeforeRank0    | 49.416 us                 | 88.382 us                 |
| BlockToStepN              | 51.873 us                 | 14.624 ms                 |
| OneStep                   | 275.092 ms                | 383.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.366 ms                  | 77.410 ms                 |
| bucket keys               | 1.752 ms                  | 3.053 ms                  |
| forward: a2a keys         | 3.959 ms                  | 36.513 ms                 |
| forward: search cache     | 322.354 us                | 815.403 us                |
| forward: a2a values       | 13.370 ms                 | 24.625 ms                 |
| forward: join             | 1.844 ms                  | 3.651 ms                  |
| Forward                   | 44.258 ms                 | 91.138 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.005 ms                  |
| back: a2a grad            | 18.423 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 98.184 ms                 |
| Backward                  | 193.864 ms                | 250.191 ms                |
| Optimize                  | 20.726 ms                 | 44.795 ms                 |
| BarrierTimeBeforeRank0    | 49.287 us                 | 92.771 us                 |
| BlockToStepN              | 51.968 us                 | 14.624 ms                 |
| OneStep                   | 274.567 ms                | 383.002 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 28.088, sample: 1.025, forward: 5.162, backward: 11.437, update: 0.301
[proc 0] 200 steps, total: 28.088, sample: 1.008, forward: 4.909, backward: 19.605, update: 2.411
[proc 5] 200 steps, total: 28.088, sample: 0.812, forward: 5.385, backward: 11.444, update: 0.323
[proc 6] 200 steps, total: 28.088, sample: 0.960, forward: 5.273, backward: 11.427, update: 0.293
[proc 3] 200 steps, total: 28.088, sample: 1.004, forward: 5.232, backward: 11.618, update: 0.258
[proc 2] 200 steps, total: 28.088, sample: 0.864, forward: 5.333, backward: 11.651, update: 0.272
[proc 7] 200 steps, total: 28.088, sample: 0.985, forward: 5.267, backward: 11.560, update: 0.277
[proc 1] 200 steps, total: 28.088, sample: 0.881, forward: 5.361, backward: 12.067, update: 0.253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.277 ms                  | 77.410 ms                 |
| bucket keys               | 1.745 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.914 ms                  | 36.513 ms                 |
| forward: search cache     | 321.615 us                | 815.403 us                |
| forward: a2a values       | 13.393 ms                 | 24.654 ms                 |
| forward: join             | 1.844 ms                  | 3.651 ms                  |
| Forward                   | 44.131 ms                 | 91.138 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.005 ms                  |
| back: a2a grad            | 18.552 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 98.390 ms                 |
| Backward                  | 193.864 ms                | 250.191 ms                |
| Optimize                  | 20.743 ms                 | 44.795 ms                 |
| BarrierTimeBeforeRank0    | 49.044 us                 | 92.771 us                 |
| BlockToStepN              | 51.968 us                 | 14.624 ms                 |
| OneStep                   | 274.602 ms                | 383.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.308 ms                  | 77.410 ms                 |
| bucket keys               | 1.738 ms                  | 3.833 ms                  |
| forward: a2a keys         | 3.927 ms                  | 36.513 ms                 |
| forward: search cache     | 321.027 us                | 815.403 us                |
| forward: a2a values       | 13.446 ms                 | 24.654 ms                 |
| forward: join             | 1.844 ms                  | 3.651 ms                  |
| Forward                   | 44.131 ms                 | 91.138 ms                 |
| back: aggr dram keys      | 47.542 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.189 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.552 ms                 | 41.581 ms                 |
| back: grad sum & grad cache  | 6.494 ms                  | 98.390 ms                 |
| Backward                  | 193.990 ms                | 250.191 ms                |
| Optimize                  | 20.639 ms                 | 44.795 ms                 |
| BarrierTimeBeforeRank0    | 48.327 us                 | 92.771 us                 |
| BlockToStepN              | 52.266 us                 | 14.624 ms                 |
| OneStep                   | 274.602 ms                | 383.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.291 ms                  | 77.410 ms                 |
| bucket keys               | 1.738 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.920 ms                  | 33.529 ms                 |
| forward: search cache     | 320.932 us                | 803.755 us                |
| forward: a2a values       | 13.393 ms                 | 24.654 ms                 |
| forward: join             | 1.844 ms                  | 3.482 ms                  |
| Forward                   | 44.048 ms                 | 91.138 ms                 |
| back: aggr dram keys      | 47.542 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.752 ms                  | 5.005 ms                  |
| back: a2a grad            | 18.588 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 6.684 ms                  | 98.184 ms                 |
| Backward                  | 194.198 ms                | 250.191 ms                |
| Optimize                  | 20.567 ms                 | 44.795 ms                 |
| BarrierTimeBeforeRank0    | 48.103 us                 | 92.771 us                 |
| BlockToStepN              | 52.503 us                 | 14.624 ms                 |
| OneStep                   | 274.409 ms                | 383.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.317 ms                  | 71.723 ms                 |
| bucket keys               | 1.738 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.837 ms                  | 33.529 ms                 |
| forward: search cache     | 319.998 us                | 803.755 us                |
| forward: a2a values       | 13.393 ms                 | 24.654 ms                 |
| forward: join             | 1.870 ms                  | 3.482 ms                  |
| Forward                   | 44.048 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 47.542 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.752 ms                  | 5.005 ms                  |
| back: a2a grad            | 18.588 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 6.684 ms                  | 98.184 ms                 |
| Backward                  | 193.838 ms                | 249.006 ms                |
| Optimize                  | 20.563 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.896 us                 | 88.382 us                 |
| BlockToStepN              | 52.746 us                 | 9.662 ms                  |
| OneStep                   | 273.100 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.291 ms                  | 71.723 ms                 |
| bucket keys               | 1.737 ms                  | 3.714 ms                  |
| forward: a2a keys         | 3.767 ms                  | 31.694 ms                 |
| forward: search cache     | 320.744 us                | 803.542 us                |
| forward: a2a values       | 13.446 ms                 | 24.625 ms                 |
| forward: join             | 1.870 ms                  | 3.435 ms                  |
| Forward                   | 43.632 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 46.002 ms                 | 73.381 ms                 |
| back: set dram grad       | 2.666 ms                  | 4.809 ms                  |
| back: a2a grad            | 18.588 ms                 | 40.141 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.184 ms                 |
| Backward                  | 193.103 ms                | 249.006 ms                |
| Optimize                  | 20.534 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.977 us                 | 88.382 us                 |
| BlockToStepN              | 52.512 us                 | 9.662 ms                  |
| OneStep                   | 272.257 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.193 ms                  | 71.723 ms                 |
| bucket keys               | 1.734 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.683 ms                  | 31.694 ms                 |
| forward: search cache     | 320.406 us                | 803.542 us                |
| forward: a2a values       | 13.446 ms                 | 24.625 ms                 |
| forward: join             | 1.881 ms                  | 3.435 ms                  |
| Forward                   | 43.632 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 46.002 ms                 | 73.381 ms                 |
| back: set dram grad       | 2.666 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.657 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.390 ms                 |
| Backward                  | 193.738 ms                | 250.191 ms                |
| Optimize                  | 20.528 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.867 us                 | 88.382 us                 |
| BlockToStepN              | 52.512 us                 | 14.624 ms                 |
| OneStep                   | 272.179 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 27.161, sample: 0.628, forward: 4.907, backward: 11.414, update: 0.314
[proc 0] 300 steps, total: 27.161, sample: 0.815, forward: 4.427, backward: 19.552, update: 2.206
[proc 3] 300 steps, total: 27.161, sample: 0.692, forward: 4.761, backward: 11.546, update: 0.275
[proc 6] 300 steps, total: 27.161, sample: 0.589, forward: 4.880, backward: 11.348, update: 0.283
[proc 2] 300 steps, total: 27.161, sample: 0.684, forward: 4.790, backward: 11.508, update: 0.291
[proc 5] 300 steps, total: 27.161, sample: 0.638, forward: 4.830, backward: 11.310, update: 0.303
[proc 4] 300 steps, total: 27.161, sample: 0.717, forward: 4.750, backward: 11.331, update: 0.303
[proc 1] 300 steps, total: 27.161, sample: 0.739, forward: 4.742, backward: 12.026, update: 0.256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.176 ms                  | 71.723 ms                 |
| bucket keys               | 1.727 ms                  | 3.719 ms                  |
| forward: a2a keys         | 3.710 ms                  | 31.694 ms                 |
| forward: search cache     | 319.127 us                | 803.542 us                |
| forward: a2a values       | 13.400 ms                 | 24.625 ms                 |
| forward: join             | 1.881 ms                  | 3.435 ms                  |
| Forward                   | 43.311 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 46.002 ms                 | 73.381 ms                 |
| back: set dram grad       | 2.666 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.666 ms                 | 40.820 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.390 ms                 |
| Backward                  | 193.753 ms                | 250.191 ms                |
| Optimize                  | 20.520 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.842 us                 | 88.382 us                 |
| BlockToStepN              | 52.578 us                 | 14.624 ms                 |
| OneStep                   | 271.950 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.193 ms                  | 77.410 ms                 |
| bucket keys               | 1.731 ms                  | 3.714 ms                  |
| forward: a2a keys         | 3.793 ms                  | 31.409 ms                 |
| forward: search cache     | 319.137 us                | 794.815 us                |
| forward: a2a values       | 12.848 ms                 | 24.441 ms                 |
| forward: join             | 1.881 ms                  | 3.410 ms                  |
| Forward                   | 43.160 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 46.002 ms                 | 73.064 ms                 |
| back: set dram grad       | 2.666 ms                  | 5.034 ms                  |
| back: a2a grad            | 18.631 ms                 | 40.141 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.184 ms                 |
| Backward                  | 193.103 ms                | 250.191 ms                |
| Optimize                  | 20.523 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.867 us                 | 88.382 us                 |
| BlockToStepN              | 53.015 us                 | 19.874 ms                 |
| OneStep                   | 271.581 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.139 ms                  | 77.410 ms                 |
| bucket keys               | 1.750 ms                  | 3.714 ms                  |
| forward: a2a keys         | 3.805 ms                  | 31.409 ms                 |
| forward: search cache     | 321.460 us                | 794.815 us                |
| forward: a2a values       | 12.170 ms                 | 24.441 ms                 |
| forward: join             | 1.881 ms                  | 3.410 ms                  |
| Forward                   | 43.198 ms                 | 87.953 ms                 |
| back: aggr dram keys      | 46.822 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.745 ms                  | 5.375 ms                  |
| back: a2a grad            | 18.384 ms                 | 40.141 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.184 ms                 |
| Backward                  | 192.318 ms                | 250.328 ms                |
| Optimize                  | 20.603 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.936 us                 | 88.382 us                 |
| BlockToStepN              | 53.015 us                 | 19.874 ms                 |
| OneStep                   | 271.254 ms                | 379.676 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.975 ms                  | 71.723 ms                 |
| bucket keys               | 1.752 ms                  | 3.714 ms                  |
| forward: a2a keys         | 3.874 ms                  | 31.409 ms                 |
| forward: search cache     | 321.615 us                | 803.755 us                |
| forward: a2a values       | 11.931 ms                 | 24.441 ms                 |
| forward: join             | 1.922 ms                  | 3.651 ms                  |
| Forward                   | 43.311 ms                 | 84.578 ms                 |
| back: aggr dram keys      | 47.779 ms                 | 74.275 ms                 |
| back: set dram grad       | 2.729 ms                  | 5.375 ms                  |
| back: a2a grad            | 17.829 ms                 | 40.141 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.184 ms                 |
| Backward                  | 191.485 ms                | 250.191 ms                |
| Optimize                  | 20.726 ms                 | 37.756 ms                 |
| BarrierTimeBeforeRank0    | 47.878 us                 | 82.339 us                 |
| BlockToStepN              | 52.771 us                 | 14.624 ms                 |
| OneStep                   | 270.032 ms                | 370.920 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.975 ms                  | 71.723 ms                 |
| bucket keys               | 1.743 ms                  | 3.703 ms                  |
| forward: a2a keys         | 3.908 ms                  | 30.501 ms                 |
| forward: search cache     | 319.926 us                | 803.542 us                |
| forward: a2a values       | 9.669 ms                  | 24.239 ms                 |
| forward: join             | 1.939 ms                  | 3.482 ms                  |
| Forward                   | 43.132 ms                 | 84.578 ms                 |
| back: aggr dram keys      | 47.542 ms                 | 73.381 ms                 |
| back: set dram grad       | 2.789 ms                  | 5.150 ms                  |
| back: a2a grad            | 16.467 ms                 | 39.918 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.140 ms                 |
| Backward                  | 190.159 ms                | 250.191 ms                |
| Optimize                  | 20.890 ms                 | 37.956 ms                 |
| BarrierTimeBeforeRank0    | 47.842 us                 | 82.339 us                 |
| BlockToStepN              | 52.503 us                 | 14.624 ms                 |
| OneStep                   | 268.001 ms                | 370.920 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 25.393, sample: 0.708, forward: 4.754, backward: 12.080, update: 0.297
[proc 0] 400 steps, total: 25.393, sample: 0.866, forward: 4.374, backward: 17.367, update: 2.645
[proc 2] 400 steps, total: 25.393, sample: 0.662, forward: 4.783, backward: 12.252, update: 0.306
[proc 7] 400 steps, total: 25.393, sample: 0.607, forward: 4.844, backward: 12.214, update: 0.312
[proc 3] 400 steps, total: 25.393, sample: 0.643, forward: 4.800, backward: 12.293, update: 0.296
[proc 1] 400 steps, total: 25.393, sample: 0.759, forward: 4.706, backward: 12.644, update: 0.256
[proc 4] 400 steps, total: 25.393, sample: 0.691, forward: 4.730, backward: 12.145, update: 0.302
[proc 6] 400 steps, total: 25.393, sample: 0.644, forward: 4.807, backward: 12.129, update: 0.302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.921 ms                  | 71.723 ms                 |
| bucket keys               | 1.744 ms                  | 3.703 ms                  |
| forward: a2a keys         | 3.874 ms                  | 31.409 ms                 |
| forward: search cache     | 320.406 us                | 803.542 us                |
| forward: a2a values       | 8.925 ms                  | 24.239 ms                 |
| forward: join             | 1.948 ms                  | 3.651 ms                  |
| Forward                   | 42.978 ms                 | 84.578 ms                 |
| back: aggr dram keys      | 47.542 ms                 | 73.381 ms                 |
| back: set dram grad       | 2.920 ms                  | 5.150 ms                  |
| back: a2a grad            | 14.825 ms                 | 39.918 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 98.140 ms                 |
| Backward                  | 189.230 ms                | 250.191 ms                |
| Optimize                  | 21.332 ms                 | 46.112 ms                 |
| BarrierTimeBeforeRank0    | 47.763 us                 | 82.339 us                 |
| BlockToStepN              | 52.246 us                 | 14.624 ms                 |
| OneStep                   | 266.408 ms                | 370.920 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.821 ms                  | 71.723 ms                 |
| bucket keys               | 1.738 ms                  | 3.703 ms                  |
| forward: a2a keys         | 3.903 ms                  | 31.409 ms                 |
| forward: search cache     | 319.127 us                | 794.815 us                |
| forward: a2a values       | 7.532 ms                  | 23.907 ms                 |
| forward: join             | 1.957 ms                  | 3.649 ms                  |
| Forward                   | 42.884 ms                 | 84.578 ms                 |
| back: aggr dram keys      | 47.954 ms                 | 73.381 ms                 |
| back: set dram grad       | 3.154 ms                  | 5.150 ms                  |
| back: a2a grad            | 13.796 ms                 | 38.703 ms                 |
| back: grad sum & grad cache  | 19.102 ms                 | 97.954 ms                 |
| Backward                  | 188.537 ms                | 250.191 ms                |
| Optimize                  | 21.717 ms                 | 46.112 ms                 |
| BarrierTimeBeforeRank0    | 47.488 us                 | 82.339 us                 |
| BlockToStepN              | 51.798 us                 | 14.624 ms                 |
| OneStep                   | 264.687 ms                | 370.920 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.660 ms                  | 68.995 ms                 |
| bucket keys               | 1.734 ms                  | 3.703 ms                  |
| forward: a2a keys         | 3.909 ms                  | 31.694 ms                 |
| forward: search cache     | 318.633 us                | 803.542 us                |
| forward: a2a values       | 6.712 ms                  | 23.907 ms                 |
| forward: join             | 1.963 ms                  | 3.990 ms                  |
| Forward                   | 42.527 ms                 | 82.286 ms                 |
| back: aggr dram keys      | 47.954 ms                 | 74.275 ms                 |
| back: set dram grad       | 3.246 ms                  | 5.704 ms                  |
| back: a2a grad            | 13.027 ms                 | 39.197 ms                 |
| back: grad sum & grad cache  | 16.872 ms                 | 97.954 ms                 |
| Backward                  | 187.736 ms                | 249.006 ms                |
| Optimize                  | 22.589 ms                 | 46.112 ms                 |
| BarrierTimeBeforeRank0    | 47.281 us                 | 78.334 us                 |
| BlockToStepN              | 51.753 us                 | 14.624 ms                 |
| OneStep                   | 263.547 ms                | 369.089 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.713 ms                  | 68.995 ms                 |
| bucket keys               | 1.724 ms                  | 3.682 ms                  |
| forward: a2a keys         | 3.841 ms                  | 31.409 ms                 |
| forward: search cache     | 317.573 us                | 799.221 us                |
| forward: a2a values       | 6.481 ms                  | 21.988 ms                 |
| forward: join             | 1.967 ms                  | 3.912 ms                  |
| Forward                   | 42.236 ms                 | 82.286 ms                 |
| back: aggr dram keys      | 48.092 ms                 | 73.381 ms                 |
| back: set dram grad       | 3.279 ms                  | 5.468 ms                  |
| back: a2a grad            | 11.675 ms                 | 38.703 ms                 |
| back: grad sum & grad cache  | 16.872 ms                 | 97.738 ms                 |
| Backward                  | 187.285 ms                | 249.006 ms                |
| Optimize                  | 23.442 ms                 | 46.112 ms                 |
| BarrierTimeBeforeRank0    | 47.201 us                 | 78.334 us                 |
| BlockToStepN              | 51.425 us                 | 14.624 ms                 |
| OneStep                   | 262.561 ms                | 369.089 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.584 ms                  | 68.995 ms                 |
| bucket keys               | 1.722 ms                  | 3.703 ms                  |
| forward: a2a keys         | 3.805 ms                  | 31.409 ms                 |
| forward: search cache     | 317.428 us                | 799.221 us                |
| forward: a2a values       | 6.404 ms                  | 21.988 ms                 |
| forward: join             | 1.970 ms                  | 3.912 ms                  |
| Forward                   | 41.984 ms                 | 82.286 ms                 |
| back: aggr dram keys      | 48.371 ms                 | 73.381 ms                 |
| back: set dram grad       | 3.300 ms                  | 6.117 ms                  |
| back: a2a grad            | 11.313 ms                 | 38.703 ms                 |
| back: grad sum & grad cache  | 16.872 ms                 | 97.738 ms                 |
| Backward                  | 186.748 ms                | 249.006 ms                |
| Optimize                  | 24.452 ms                 | 46.112 ms                 |
| BarrierTimeBeforeRank0    | 47.057 us                 | 78.334 us                 |
| BlockToStepN              | 50.815 us                 | 14.624 ms                 |
| OneStep                   | 260.339 ms                | 369.089 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 22.859, sample: 0.697, forward: 3.773, backward: 15.086, update: 3.170
[proc 5] 500 steps, total: 22.859, sample: 0.649, forward: 4.017, backward: 13.081, update: 0.317
[proc 4] 500 steps, total: 22.859, sample: 0.653, forward: 4.021, backward: 13.114, update: 0.338
[proc 3] 500 steps, total: 22.859, sample: 0.607, forward: 4.052, backward: 13.197, update: 0.306
[proc 7] 500 steps, total: 22.859, sample: 0.607, forward: 4.080, backward: 13.125, update: 0.320
[proc 6] 500 steps, total: 22.859, sample: 0.618, forward: 4.049, backward: 13.121, update: 0.335
[proc 2] 500 steps, total: 22.859, sample: 0.639, forward: 4.021, backward: 13.168, update: 0.334
[proc 1] 500 steps, total: 22.859, sample: 0.696, forward: 3.972, backward: 13.465, update: 0.263
Successfully xmh. training takes 135.4889211654663 seconds
before call kg_cache_controller.StopThreads()
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
INFO [12819 controller_process.py:380] call rank0 to StopThreads
