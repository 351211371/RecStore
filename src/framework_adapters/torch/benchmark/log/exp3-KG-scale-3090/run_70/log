WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 15:42:32.211277 55664 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_17', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [55664 sampler.py:454] Start PreSampling
WARNING [55664 sampler.py:532] Before construct renumbering_dict
WARNING [55664 sampler.py:555] PreSampling done
W20240123 15:55:26.220821 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240123 15:55:26.221092 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240123 15:55:26.221127 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240123 15:55:26.221146 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240123 15:55:26.221165 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240123 15:55:26.221190 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240123 15:55:26.221212 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240123 15:55:26.221235 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240123 15:55:26.221253 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240123 15:55:26.221273 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240123 15:55:26.221304 55664 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240123 15:55:26.221324 55664 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240123 15:55:26.221346 55664 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240123 15:55:26.221491 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240123 15:55:26.221515 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240123 15:55:26.221544 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240123 15:55:26.221560 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240123 15:55:26.221597 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240123 15:55:26.221617 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240123 15:55:26.221643 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240123 15:55:26.221663 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240123 15:55:26.221679 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240123 15:55:26.221700 55664 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240123 15:55:26.221721 55664 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240123 15:55:26.221735 55664 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240123 15:55:26.221748 55664 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240123 15:55:26.530001 55664 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100000f72000 128.2 GB
W20240123 15:55:26.530151 55664 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10200fbaa000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2147078
Rank1: cached key size 2004385
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4151503,  4151528,   174666,  ..., 27031067, 33333287, 77975034]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 951.269 seconds
INFO [55664 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [55664 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [14867 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [14867 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING [55664 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14867 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 15:58:32.643222 14932 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240123 15:58:32.643402 14868 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
I20240123 15:58:56.317446 14932 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240123 15:59:00.441757 14868 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.204 ms                  | 79.303 ms                 |
| bucket keys               | 820.239 us                | 168.657 ms                |
| forward: a2a keys         | 762.699 us                | 518.489 ms                |
| forward: search cache     | 124.131 us                | 17.565 ms                 |
| forward: a2a values       | 681.417 us                | 4.984 ms                  |
| forward: join             | 788.243 us                | 1.640 ms                  |
| Forward                   | 15.254 ms                 | 1.137 s                   |
| back: aggr dram keys      | 27.146 ms                 | 154.910 ms                |
| back: set dram grad       | 1.472 ms                  | 2.039 ms                  |
| back: a2a grad            | 1.551 ms                  | 4.962 ms                  |
| back: grad sum & grad cache  | 636.020 us                | 7.938 ms                  |
| Backward                  | 60.967 ms                 | 333.588 ms                |
| Optimize                  | 7.236 ms                  | 9.039 ms                  |
| BarrierTimeBeforeRank0    | 69.746 us                 | 98.227 us                 |
| BlockToStepN              | 15.194 us                 | 12.006 ms                 |
| OneStep                   | 92.971 ms                 | 1.485 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.639 ms                  | 71.918 ms                 |
| bucket keys               | 893.571 us                | 2.187 ms                  |
| forward: a2a keys         | 762.699 us                | 22.565 ms                 |
| forward: search cache     | 133.851 us                | 256.257 us                |
| forward: a2a values       | 866.853 us                | 4.984 ms                  |
| forward: join             | 932.160 us                | 1.798 ms                  |
| Forward                   | 15.298 ms                 | 33.916 ms                 |
| back: aggr dram keys      | 19.949 ms                 | 54.738 ms                 |
| back: set dram grad       | 1.472 ms                  | 2.208 ms                  |
| back: a2a grad            | 2.734 ms                  | 4.285 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.938 ms                  |
| Backward                  | 60.620 ms                 | 87.441 ms                 |
| Optimize                  | 7.978 ms                  | 9.361 ms                  |
| BarrierTimeBeforeRank0    | 58.080 us                 | 98.227 us                 |
| BlockToStepN              | 14.836 us                 | 45.363 us                 |
| OneStep                   | 90.773 ms                 | 170.991 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.492, sample: 0.828, forward: 3.611, backward: 5.480, update: 0.164
[Rank1] pid = 14867
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
train_sampler.Prefill()
-------Step 0-------
tensor([401582, 401625, 401658, 401690, 401721, 401753, 401791,  38496, 401813,
        401850]) tensor([   75219,  4677571, 17029215, 43169554, 38929959, 16084325, 79878684,
         9196898, 40698436, 55830493])
-------Step 1-------
tensor([401582, 401625, 401658, 401690, 401721, 401753, 401791,  38496, 401813,
        401850]) tensor([ 5594221, 62497780, 28070746,  7336980, 18149145,  1400719,  1991801,
        35121245, 21879842, 41625110])
-------Step 2-------
tensor([477674, 477713, 477747, 477794, 477833, 477872, 477905, 477950, 477980,
        478034]) tensor([25909719, 63793288, 71498029, 23823059, 18084012, 20405163, 16002893,
        35491131, 16293967, 44595961])
-------Step 3-------
tensor([477674, 477713, 477747, 477794, 477833, 477872, 477905, 477950, 477980,
        478034]) tensor([58595290, 56970815, 76982657, 15788666, 85985341, 68034123, 78361710,
        59777251, 40867085, 38883551])
-------Step 4-------
tensor([ 560145,  560183,  833040,  560227,  560268, 9517383,  316579,  560313,
         833051,  560362]) tensor([56794485, 81310382, 45893334, 70690947, 84340502, 30862716, 38250533,
         6344293, 85092197, 60151246])
-------Step 5-------
tensor([ 560145,  560183,  833040,  560227,  560268, 9517383,  316579,  560313,
         833051,  560362]) tensor([64138957, 61878240, 18269063, 14071067, 53163180, 46809262, 54405036,
        66720256, 26542571, 28746313])
-------Step 6-------
tensor([644157, 644207, 644247, 834181, 644307, 644353, 644410, 644448, 644503,
        644550]) tensor([42286610, 63650263, 62379014, 17627253,  4471255,  4781643, 83654636,
        11209286, 12966400, 83107883])
-------Step 7-------
tensor([644157, 644207, 644247, 834181, 644307, 644353, 644410, 644448, 644503,
        644550]) tensor([66264705, 37307580, 78371500, 24452034, 42431941, 12555987, 71571777,
         4928412, 36105186, 52301329])
-------Step 8-------
tensor([728937, 728990, 328372, 729022, 729064, 729111, 729166, 729224, 729263,
        729319]) tensor([13842605, 17783180, 39473586,  6459308, 68904480, 16152417, 50808492,
        51527462, 61090104, 42127385])
-------Step 9-------
tensor([728937, 728990, 328372, 729022, 729064, 729111, 729166, 729224, 729263,
        729319]) tensor([33224192, 67967087, 50035659, 43063496, 47856456, 33535153, 37269868,
        36000370, 61391108, 85055687])
before start barrier
start train
[proc 0] 100 steps, total: 11.368, sample: 1.403, forward: 2.649, backward: 6.432, update: 0.755
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.723 ms                  | 90.763 ms                 |
| bucket keys               | 878.929 us                | 2.035 ms                  |
| forward: a2a keys         | 755.956 us                | 8.117 ms                  |
| forward: search cache     | 132.206 us                | 254.549 us                |
| forward: a2a values       | 1.053 ms                  | 4.984 ms                  |
| forward: join             | 932.160 us                | 2.830 ms                  |
| Forward                   | 15.184 ms                 | 33.916 ms                 |
| back: aggr dram keys      | 19.949 ms                 | 49.309 ms                 |
| back: set dram grad       | 1.475 ms                  | 2.208 ms                  |
| back: a2a grad            | 2.716 ms                  | 4.481 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.674 ms                  |
| Backward                  | 60.967 ms                 | 87.441 ms                 |
| Optimize                  | 7.575 ms                  | 9.413 ms                  |
| BarrierTimeBeforeRank0    | 55.526 us                 | 102.365 us                |
| BlockToStepN              | 14.901 us                 | 12.006 ms                 |
| OneStep                   | 92.759 ms                 | 176.497 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.608 ms                  | 79.303 ms                 |
| bucket keys               | 961.687 us                | 2.187 ms                  |
| forward: a2a keys         | 768.603 us                | 4.544 ms                  |
| forward: search cache     | 136.185 us                | 287.359 us                |
| forward: a2a values       | 1.328 ms                  | 4.460 ms                  |
| forward: join             | 932.160 us                | 2.830 ms                  |
| Forward                   | 15.816 ms                 | 24.438 ms                 |
| back: aggr dram keys      | 19.949 ms                 | 45.334 ms                 |
| back: set dram grad       | 1.475 ms                  | 2.364 ms                  |
| back: a2a grad            | 2.716 ms                  | 4.481 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.674 ms                  |
| Backward                  | 60.812 ms                 | 86.255 ms                 |
| Optimize                  | 7.495 ms                  | 9.361 ms                  |
| BarrierTimeBeforeRank0    | 51.950 us                 | 98.227 us                 |
| BlockToStepN              | 14.733 us                 | 91.570 us                 |
| OneStep                   | 91.760 ms                 | 170.991 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 9.508, sample: 0.934, forward: 1.705, backward: 6.083, update: 0.711
[proc 1] 200 steps, total: 9.508, sample: 0.697, forward: 2.257, backward: 5.205, update: 0.163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.800 ms                  | 79.303 ms                 |
| bucket keys               | 1.014 ms                  | 2.187 ms                  |
| forward: a2a keys         | 771.705 us                | 3.773 ms                  |
| forward: search cache     | 138.827 us                | 283.666 us                |
| forward: a2a values       | 1.480 ms                  | 4.460 ms                  |
| forward: join             | 932.160 us                | 2.715 ms                  |
| Forward                   | 16.339 ms                 | 30.525 ms                 |
| back: aggr dram keys      | 19.949 ms                 | 43.325 ms                 |
| back: set dram grad       | 1.475 ms                  | 2.364 ms                  |
| back: a2a grad            | 2.734 ms                  | 4.793 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.938 ms                  |
| Backward                  | 60.896 ms                 | 86.255 ms                 |
| Optimize                  | 7.598 ms                  | 9.413 ms                  |
| BarrierTimeBeforeRank0    | 51.521 us                 | 98.227 us                 |
| BlockToStepN              | 14.530 us                 | 9.351 ms                  |
| OneStep                   | 91.756 ms                 | 170.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.035 ms                  | 71.918 ms                 |
| bucket keys               | 984.313 us                | 2.198 ms                  |
| forward: a2a keys         | 767.475 us                | 3.773 ms                  |
| forward: search cache     | 137.271 us                | 283.483 us                |
| forward: a2a values       | 1.480 ms                  | 4.244 ms                  |
| forward: join             | 932.160 us                | 2.180 ms                  |
| Forward                   | 16.302 ms                 | 25.615 ms                 |
| back: aggr dram keys      | 20.935 ms                 | 41.961 ms                 |
| back: set dram grad       | 1.482 ms                  | 2.402 ms                  |
| back: a2a grad            | 2.738 ms                  | 4.793 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.779 ms                  |
| Backward                  | 61.307 ms                 | 86.255 ms                 |
| Optimize                  | 7.575 ms                  | 9.413 ms                  |
| BarrierTimeBeforeRank0    | 51.335 us                 | 96.579 us                 |
| BlockToStepN              | 14.653 us                 | 9.351 ms                  |
| OneStep                   | 92.182 ms                 | 169.354 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 9.698, sample: 0.748, forward: 2.178, backward: 5.379, update: 0.174
[proc 0] 300 steps, total: 9.698, sample: 0.993, forward: 1.647, backward: 6.253, update: 0.708
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.973 ms                  | 71.918 ms                 |
| bucket keys               | 1.000 ms                  | 2.187 ms                  |
| forward: a2a keys         | 762.699 us                | 3.773 ms                  |
| forward: search cache     | 138.827 us                | 279.939 us                |
| forward: a2a values       | 2.405 ms                  | 3.794 ms                  |
| forward: join             | 932.160 us                | 2.074 ms                  |
| Forward                   | 16.416 ms                 | 25.615 ms                 |
| back: aggr dram keys      | 20.935 ms                 | 40.223 ms                 |
| back: set dram grad       | 1.477 ms                  | 2.402 ms                  |
| back: a2a grad            | 2.738 ms                  | 4.615 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.674 ms                  |
| Backward                  | 61.685 ms                 | 86.255 ms                 |
| Optimize                  | 7.546 ms                  | 9.413 ms                  |
| BarrierTimeBeforeRank0    | 51.248 us                 | 97.827 us                 |
| BlockToStepN              | 14.559 us                 | 9.351 ms                  |
| OneStep                   | 91.834 ms                 | 169.354 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.667 ms                  | 67.402 ms                 |
| bucket keys               | 1.015 ms                  | 2.198 ms                  |
| forward: a2a keys         | 757.666 us                | 3.368 ms                  |
| forward: search cache     | 140.166 us                | 282.300 us                |
| forward: a2a values       | 2.405 ms                  | 3.794 ms                  |
| forward: join             | 932.160 us                | 2.074 ms                  |
| Forward                   | 16.553 ms                 | 30.525 ms                 |
| back: aggr dram keys      | 20.677 ms                 | 39.615 ms                 |
| back: set dram grad       | 1.477 ms                  | 2.460 ms                  |
| back: a2a grad            | 2.742 ms                  | 4.615 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.600 ms                  |
| Backward                  | 61.181 ms                 | 80.667 ms                 |
| Optimize                  | 7.502 ms                  | 9.361 ms                  |
| BarrierTimeBeforeRank0    | 51.074 us                 | 96.579 us                 |
| BlockToStepN              | 14.418 us                 | 91.570 us                 |
| OneStep                   | 91.556 ms                 | 169.226 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 9.535, sample: 0.563, forward: 2.312, backward: 5.321, update: 0.154
[proc 0] 400 steps, total: 9.535, sample: 0.923, forward: 1.705, backward: 6.135, update: 0.699
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.722 ms                  | 67.402 ms                 |
| bucket keys               | 983.752 us                | 2.198 ms                  |
| forward: a2a keys         | 747.163 us                | 3.338 ms                  |
| forward: search cache     | 138.124 us                | 282.300 us                |
| forward: a2a values       | 2.054 ms                  | 3.794 ms                  |
| forward: join             | 1.260 ms                  | 2.731 ms                  |
| Forward                   | 16.436 ms                 | 30.858 ms                 |
| back: aggr dram keys      | 19.240 ms                 | 40.223 ms                 |
| back: set dram grad       | 1.477 ms                  | 2.481 ms                  |
| back: a2a grad            | 2.742 ms                  | 4.615 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.674 ms                  |
| Backward                  | 61.241 ms                 | 83.466 ms                 |
| Optimize                  | 7.495 ms                  | 9.413 ms                  |
| BarrierTimeBeforeRank0    | 50.883 us                 | 96.579 us                 |
| BlockToStepN              | 14.482 us                 | 9.351 ms                  |
| OneStep                   | 91.918 ms                 | 169.226 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.800 ms                  | 65.181 ms                 |
| bucket keys               | 976.897 us                | 2.191 ms                  |
| forward: a2a keys         | 740.631 us                | 3.338 ms                  |
| forward: search cache     | 138.827 us                | 279.939 us                |
| forward: a2a values       | 2.054 ms                  | 3.775 ms                  |
| forward: join             | 1.260 ms                  | 2.715 ms                  |
| Forward                   | 16.349 ms                 | 30.858 ms                 |
| back: aggr dram keys      | 18.198 ms                 | 40.223 ms                 |
| back: set dram grad       | 1.475 ms                  | 2.460 ms                  |
| back: a2a grad            | 2.742 ms                  | 4.597 ms                  |
| back: grad sum & grad cache  | 3.268 ms                  | 7.600 ms                  |
| Backward                  | 61.147 ms                 | 81.019 ms                 |
| Optimize                  | 7.570 ms                  | 9.361 ms                  |
| BarrierTimeBeforeRank0    | 50.673 us                 | 86.970 us                 |
| BlockToStepN              | 14.416 us                 | 91.570 us                 |
| OneStep                   | 91.772 ms                 | 160.264 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 9.518, sample: 0.653, forward: 2.241, backward: 5.256, update: 0.160
[proc 0] 500 steps, total: 9.518, sample: 1.067, forward: 1.574, backward: 6.065, update: 0.732
Successfully xmh. training takes 49.626702308654785 seconds
before call kg_cache_controller.StopThreads()
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
INFO [55664 controller_process.py:380] call rank0 to StopThreads
