WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 06:59:41.333493  3874 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_62', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [3874 sampler.py:454] Start PreSampling
WARNING [3874 sampler.py:532] Before construct renumbering_dict
WARNING [3874 sampler.py:555] PreSampling done
W20240124 07:13:15.239240  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 07:13:15.239463  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 07:13:15.239491  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 07:13:15.239527  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 07:13:15.239553  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 07:13:15.239578  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 07:13:15.239600  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 07:13:15.239631  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 07:13:15.239663  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 07:13:15.239689  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 07:13:15.239722  3874 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 07:13:15.239748  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 07:13:15.239773  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 07:13:15.239912  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 07:13:15.239939  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 07:13:15.239961  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 07:13:15.240003  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 07:13:15.240027  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 07:13:15.240052  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 07:13:15.240075  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 07:13:15.240100  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 07:13:15.240123  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 07:13:15.240149  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 07:13:15.240173  3874 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 07:13:15.240191  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 07:13:15.240212  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 07:13:15.240257  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 07:13:15.240285  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 07:13:15.240305  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 07:13:15.240329  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 07:13:15.240350  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 07:13:15.240376  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 07:13:15.240401  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 07:13:15.240430  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 07:13:15.240455  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 07:13:15.240486  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 07:13:15.240510  3874 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 07:13:15.240527  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 07:13:15.240550  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 07:13:15.240590  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 07:13:15.240622  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 07:13:15.240643  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 07:13:15.240664  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 07:13:15.240684  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 07:13:15.240710  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 07:13:15.240729  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 07:13:15.240753  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 07:13:15.240783  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 07:13:15.240821  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 07:13:15.240850  3874 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 07:13:15.240868  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 07:13:15.240885  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 07:13:15.240931  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 07:13:15.240958  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 07:13:15.240978  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 07:13:15.240998  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 07:13:15.241024  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 07:13:15.241052  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 07:13:15.241072  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 07:13:15.241096  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 07:13:15.241119  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 07:13:15.241149  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 07:13:15.241173  3874 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 07:13:15.241190  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 07:13:15.241206  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 07:13:15.241248  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 07:13:15.241271  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 07:13:15.241292  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 07:13:15.241319  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 07:13:15.241344  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 07:13:15.241364  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 07:13:15.241389  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 07:13:15.241413  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 07:13:15.241436  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 07:13:15.241461  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 07:13:15.241483  3874 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 07:13:15.241500  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 07:13:15.241518  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 07:13:15.241559  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 07:13:15.241590  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 07:13:15.241614  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 07:13:15.241636  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 07:13:15.241660  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 07:13:15.241689  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 07:13:15.241712  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 07:13:15.241739  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 07:13:15.241762  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 07:13:15.241786  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 07:13:15.241806  3874 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 07:13:15.241827  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 07:13:15.241844  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 07:13:15.241890  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 07:13:15.241917  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 07:13:15.241938  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 07:13:15.241961  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 07:13:15.241986  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 07:13:15.242012  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 07:13:15.242033  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 07:13:15.242053  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 07:13:15.242079  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 07:13:15.242100  3874 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 07:13:15.242123  3874 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 07:13:15.242141  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 07:13:15.242156  3874 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 07:13:15.581431  3874 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 07:13:15.581605  3874 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302743,  4302770,  ..., 61856873, 21518249, 27347181]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 991.340 seconds
[Rank1] pid = 28990
[Rank2] pid = 29159
[Rank3] pid = 29230
[Rank4] pid = 29408
[Rank5] pid = 29584
[Rank6] pid = 29765
INFO [3874 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28990 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29159 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [29230 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29408 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [29584 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29930 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [29765 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [29930 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29765 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 07:16:20.871558 29994 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
INFO [3874 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29408 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28990 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29230 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29159 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29584 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 07:16:20.873286 29766 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240124 07:16:20.874022 29931 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 07:16:20.876029 29231 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 07:16:20.876272 29409 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 07:16:20.876272 28991 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 07:16:20.875982 29161 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 07:16:20.876088 29585 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 07:16:21.002017 29766 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x10202724b000 781.2 kB
W20240124 07:16:21.002351 29409 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102027316000 781.2 kB
W20240124 07:16:21.002353 28991 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020273db000 781.2 kB
W20240124 07:16:21.002554 29231 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1020274a0000 781.2 kB
W20240124 07:16:21.002591 29994 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027565000 781.2 kB
W20240124 07:16:21.002851 29409 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x1020276ef000 781.2 kB
W20240124 07:16:21.002848 29766 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10202762a000 781.2 kB
W20240124 07:16:21.002889 28991 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x1020277b4000 781.2 kB
W20240124 07:16:21.002951 29409 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x102027879000 152.6 MB
W20240124 07:16:21.002998 28991 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x1020311d6000 152.6 MB
W20240124 07:16:21.002969 29931 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x102031111000 781.2 kB
W20240124 07:16:21.003036 29231 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10203aa6e000 781.2 kB
W20240124 07:16:21.003065 29409 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10203acbd000 152.6 MB
W20240124 07:16:21.003055 29161 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x10203ab33000 781.2 kB
W20240124 07:16:21.003065 29585 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x10203abf8000 781.2 kB
W20240124 07:16:21.003082 29994 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x102044555000 781.2 kB
W20240124 07:16:21.003121 28991 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10204deb2000 152.6 MB
W20240124 07:16:21.003113 29766 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10204461a000 152.6 MB
W20240124 07:16:21.003172 29409 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 07:16:21.003203 29231 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10205774a000 152.6 MB
W20240124 07:16:21.003214 28991 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 07:16:21.003240 29931 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102060fe2000 781.2 kB
W20240124 07:16:21.003283 29994 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x1020610a7000 152.6 MB
W20240124 07:16:21.003316 29766 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x10206a93f000 152.6 MB
W20240124 07:16:21.003352 29231 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x1020741d7000 152.6 MB
W20240124 07:16:21.003356 29931 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10207da6f000 152.6 MB
W20240124 07:16:21.003440 29994 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x102087307000 152.6 MB
W20240124 07:16:21.003445 29931 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x102090b9f000 152.6 MB
W20240124 07:16:21.003530 29766 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 07:16:21.003562 29931 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 07:16:21.003705 29994 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 07:16:21.003846 29231 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 07:16:21.003973 29161 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x10209a437000 781.2 kB
W20240124 07:16:21.003983 29585 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10209a4fc000 781.2 kB
W20240124 07:16:21.004089 29585 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10209a5c1000 152.6 MB
W20240124 07:16:21.004102 29161 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x1020a3e59000 152.6 MB
W20240124 07:16:21.004217 29161 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 07:16:21.004328 29161 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 07:16:21.004510 29585 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 07:16:21.004601 29585 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 07:16:21.008462 29409 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 07:16:21.008930 28991 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 07:16:21.009358 29931 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 07:16:21.009876 29766 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 07:16:21.009996 29994 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 07:16:21.010229 29161 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 07:16:21.010288 29231 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 07:16:21.010891 29585 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [29584 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [28990 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [29930 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [29159 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 29930
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [3874 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [29230 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [29765 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [29408 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 07:17:09.222357 29409 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222478 29231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222571 29585 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222617 29766 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222640 29931 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222666 29994 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222697 28991 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 07:17:09.222728 29161 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 07:17:09.224561 29931 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 07:17:09.224659 29931 grad_base.h:172] Init GradProcessingBase done
I20240124 07:17:18.343688 29931 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 07:17:18.343847 29931 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 07:17:18.343853 29931 kg_controller.h:84] Construct KGCacheController done
I20240124 07:17:19.122974 29931 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 07:17:37.382933 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 07:17:37.383222 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:17:39.579999 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 07:17:39.580224 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240124 07:17:40.580010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 07:17:41.061089 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 07:17:42.220678 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 07:17:42.226984 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 07:17:42.363937 29585 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240124 07:17:42.417256 29994 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 07:17:44.082332 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 07:17:44.088584 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 07:17:44.200654 29766 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 07:17:46.779374 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 07:17:46.785818 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 07:17:46.942719 29161 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 07:17:46.947181 29231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 07:17:47.220268 29931 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 07:17:48.026218 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 07:17:48.032454 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 07:17:48.190649 29409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 07:17:50.082216 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 07:17:50.092638 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 07:17:50.299396 28991 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 07:17:52.835801 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 07:17:52.960697 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 07:17:52.966552 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 07:17:53.096386 29931 grad_async_v2.h:236] pq is empty
W20240124 07:17:53.391609 29931 grad_async_v2.h:236] pq is empty
E20240124 07:17:53.835011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240124 07:17:53.977100 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.379 ms                  | 382.825 ms                |
| ProcessBack:UpdateCache   | 10.207 ms                 | 726.967 ms                |
| ProcessBack:UpsertPq      | 65.910 ms                 | 125.367 ms                |
| ProcessOneStep            | 86.144 ms                 | 1.243 s                   |
| BlockToStepN              | 324.038 us                | 53.826 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.007 ms                  | 108.799 ms                |
| Forward                   | 6.763 ms                  | 818.387 ms                |
| Backward                  | 4.504 ms                  | 215.839 ms                |
| Optimize                  | 2.581 ms                  | 3.442 ms                  |
| BarrierTimeBeforeRank0    | 14.667 ms                 | 391.459 ms                |
| AfterBackward             | 86.225 ms                 | 1.244 s                   |
| BlockToStepN              | 416.093 us                | 53.943 ms                 |
| OneStep                   | 133.944 ms                | 2.663 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 07:17:54.331569 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240124 07:17:54.835011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1260
W20240124 07:17:55.021489 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 07:17:55.382835 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=14, pq.top=14
E20240124 07:17:55.835012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=40857
W20240124 07:17:56.108494 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
W20240124 07:17:56.382021 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=22, pq.top=22
E20240124 07:17:56.835011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=234
W20240124 07:17:57.233665 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240124 07:17:57.413847 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=26, pq.top=26
E20240124 07:17:57.843046 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:17:58.049429 31972 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240124 07:17:58.355738 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
E20240124 07:17:58.843008 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=44
W20240124 07:17:59.073060 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=34
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.383 ms                  | 382.363 ms                |
| ProcessBack:UpdateCache   | 9.637 ms                  | 726.924 ms                |
| ProcessBack:UpsertPq      | 21.852 ms                 | 124.349 ms                |
| ProcessOneStep            | 60.674 ms                 | 1.243 s                   |
| BlockToStepN              | 8.051 ms                  | 123.155 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.007 ms                  | 108.799 ms                |
| Forward                   | 4.889 ms                  | 818.387 ms                |
| Backward                  | 4.513 ms                  | 215.839 ms                |
| Optimize                  | 2.178 ms                  | 4.119 ms                  |
| BarrierTimeBeforeRank0    | 2.499 ms                  | 391.459 ms                |
| AfterBackward             | 60.716 ms                 | 1.244 s                   |
| BlockToStepN              | 8.141 ms                  | 123.286 ms                |
| OneStep                   | 170.623 ms                | 2.663 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 07:17:59.378894 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 07:17:59.843011 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=1968
W20240124 07:18:00.118924 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240124 07:18:00.396157 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
E20240124 07:18:00.843009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=2426
W20240124 07:18:01.139349 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=50, pq.top=50
W20240124 07:18:01.520304 31973 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
E20240124 07:18:01.843456 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:02.171650 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240124 07:18:02.721108 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
E20240124 07:18:02.843009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=22441
W20240124 07:18:03.171062 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240124 07:18:03.741963 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 07:18:03.843008 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1528
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.412 ms                  | 382.363 ms                |
| ProcessBack:UpdateCache   | 9.740 ms                  | 726.924 ms                |
| ProcessBack:UpsertPq      | 19.954 ms                 | 124.349 ms                |
| ProcessOneStep            | 59.553 ms                 | 788.068 ms                |
| BlockToStepN              | 8.051 ms                  | 123.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:04.171123 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.162 ms                  | 82.709 ms                 |
| Forward                   | 4.980 ms                  | 36.783 ms                 |
| Backward                  | 4.616 ms                  | 6.533 ms                  |
| Optimize                  | 2.217 ms                  | 5.829 ms                  |
| BarrierTimeBeforeRank0    | 2.499 ms                  | 372.779 ms                |
| AfterBackward             | 60.641 ms                 | 788.118 ms                |
| BlockToStepN              | 18.156 ms                 | 123.286 ms                |
| OneStep                   | 137.825 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:04.757277 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 07:18:04.843006 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1184
W20240124 07:18:05.174259 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240124 07:18:05.826130 31973 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240124 07:18:05.843008 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=24047
W20240124 07:18:06.174021 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240124 07:18:06.843010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1367
W20240124 07:18:06.884150 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240124 07:18:07.174024 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=86, pq.top=86
E20240124 07:18:07.843008 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=18610
W20240124 07:18:07.886273 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240124 07:18:08.174023 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=91
E20240124 07:18:08.843011 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=32292
W20240124 07:18:08.910704 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.478 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.743 ms                  | 12.395 ms                 |
| ProcessBack:UpsertPq      | 22.449 ms                 | 124.349 ms                |
| ProcessOneStep            | 60.603 ms                 | 788.068 ms                |
| BlockToStepN              | 47.574 ms                 | 123.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:09.174180 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.255 ms                  | 82.709 ms                 |
| Forward                   | 5.095 ms                  | 36.783 ms                 |
| Backward                  | 4.635 ms                  | 6.533 ms                  |
| Optimize                  | 2.260 ms                  | 5.829 ms                  |
| BarrierTimeBeforeRank0    | 1.737 ms                  | 372.779 ms                |
| AfterBackward             | 60.641 ms                 | 788.118 ms                |
| BlockToStepN              | 48.529 ms                 | 123.286 ms                |
| OneStep                   | 137.605 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.601, sample: 1.387, forward: 1.487, backward: 0.695, update: 0.233
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 25.347, sample: 1.097, forward: 1.370, backward: 0.731, update: 0.215
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.605, sample: 1.181, forward: 1.272, backward: 0.735, update: 0.207
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 27.184, sample: 1.029, forward: 1.337, backward: 0.713, update: 0.202
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 27.131, sample: 0.975, forward: 1.296, backward: 0.708, update: 0.196
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 21.358, sample: 1.212, forward: 1.280, backward: 0.734, update: 0.192
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.249, sample: 2.846, forward: 1.599, backward: 0.740, update: 0.202
train_sampler.Prefill()
-------Step 0-------
tensor([  519426,    90268,   384996, 15764217,    90304,    90355,   519439,
           90407,    90465,    90505]) tensor([ 5252100, 10254242, 57840760, 59537481, 18172889,   297577, 20475723,
        62586371, 50614669, 48456233])
-------Step 1-------
tensor([  519426,    90268,   384996, 15764217,    90304,    90355,   519439,
           90407,    90465,    90505]) tensor([83885837, 29353373, 53277251, 49030580, 57083577, 14219391, 50714047,
          597977, 20452087, 39492063])
-------Step 2-------
tensor([   16031,   345469,   467374, 17164139,   187549,   187589,   187635,
          187677,   187712,   187772]) tensor([56106952, 35838135,  1346869, 24650856, 20211072, 26519069,  8103594,
        60417692, 69819321, 26627217])
-------Step 3-------
tensor([   16031,   345469,   467374, 17164139,   187549,   187589,   187635,
          187677,   187712,   187772]) tensor([22024939, 67234551, 79236823, 51986361, 83115227, 81741804, 68327766,
        27340484, 78454905, 12104393])
-------Step 4-------
tensor([  241332,   241366,   241396, 75138700,   241414,   241448,   241465,
          241496,   241523, 27603827]) tensor([74296255, 59036367, 76206825, 39566246,   303101,  4334153, 26603452,
        57405457, 71488104, 10217851])
-------Step 5-------
tensor([  241332,   241366,   241396, 75138700,   241414,   241448,   241465,
          241496,   241523, 27603827]) tensor([49113367, 46609133, 48417303,    38958, 68629905, 55792600, 40911134,
         1361905, 67433535, 32013549])
-------Step 6-------
tensor([ 7181843,  5695037,   290111, 37794371,   290135,   290163, 80931338,
        38078814,   290185,   290216]) tensor([39571799,   287530, 55772907, 18229131, 18545980, 37457324, 15201179,
        56871199, 72537823, 54826003])
-------Step 7-------
tensor([ 7181843,  5695037,   290111, 37794371,   290135,   290163, 80931338,
        38078814,   290185,   290216]) tensor([25381617,  9975121, 29509434,  9979290, 46469726, 60406667,  4317717,
        16591002, 37001714, 64899422])
-------Step 8-------
tensor([  337286,   337314, 82560288,   337337,   384814,   384848, 14070941,
          337358,   337379,   474073]) tensor([20743234, 34919564, 65722201,  5236786, 64537364,  7010783,  5550336,
        13024648, 57749029,  6198245])
-------Step 9-------
tensor([  337286,   337314, 82560288,   337337,   384814,   384848, 14070941,
          337358,   337379,   474073]) tensor([63052568, 27925180, 56510124, 68570713, 39338607, 66768214, 78645039,
        16128453, 15206472,  7074707])
before start barrier
start train
[proc 0] 100 steps, total: 22.328, sample: 1.287, forward: 1.379, backward: 0.687, update: 0.246
E20240124 07:18:09.843010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1363
W20240124 07:18:10.085743 31973 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240124 07:18:10.317678 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=104
E20240124 07:18:10.843011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=633
W20240124 07:18:11.148347 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240124 07:18:11.554059 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=108, pq.top=108
E20240124 07:18:11.843159 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=75
W20240124 07:18:12.162205 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
W20240124 07:18:12.558614 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
E20240124 07:18:12.843014 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=7329
W20240124 07:18:13.164094 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
W20240124 07:18:13.588142 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240124 07:18:13.843010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.558 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.792 ms                  | 16.683 ms                 |
| ProcessBack:UpsertPq      | 22.449 ms                 | 124.349 ms                |
| ProcessOneStep            | 60.890 ms                 | 788.068 ms                |
| BlockToStepN              | 47.574 ms                 | 127.899 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.797 ms                  | 202.940 ms                |
| Forward                   | 5.181 ms                  | 36.783 ms                 |
| Backward                  | 4.682 ms                  | 10.099 ms                 |
| Optimize                  | 2.224 ms                  | 5.829 ms                  |
| BarrierTimeBeforeRank0    | 622.993 us                | 372.779 ms                |
| AfterBackward             | 61.135 ms                 | 788.118 ms                |
| BlockToStepN              | 47.669 ms                 | 128.053 ms                |
| OneStep                   | 137.825 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:14.421240 31973 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
W20240124 07:18:14.588081 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240124 07:18:14.843012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=14833
W20240124 07:18:15.598507 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240124 07:18:15.845059 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:16.179611 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240124 07:18:16.648856 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
E20240124 07:18:16.845012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=73
W20240124 07:18:17.238366 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240124 07:18:17.707700 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240124 07:18:17.845013 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240124 07:18:18.238246 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240124 07:18:18.721648 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
E20240124 07:18:18.845011 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=23678
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.585 ms                  | 31.940 ms                 |
| ProcessBack:UpdateCache   | 9.766 ms                  | 16.205 ms                 |
| ProcessBack:UpsertPq      | 22.209 ms                 | 97.559 ms                 |
| ProcessOneStep            | 61.096 ms                 | 961.793 ms                |
| BlockToStepN              | 48.424 ms                 | 163.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.895 ms                  | 269.531 ms                |
| Forward                   | 5.159 ms                  | 36.783 ms                 |
| Backward                  | 4.828 ms                  | 10.099 ms                 |
| Optimize                  | 2.214 ms                  | 5.829 ms                  |
| BarrierTimeBeforeRank0    | 96.988 us                 | 372.779 ms                |
| AfterBackward             | 61.216 ms                 | 961.845 ms                |
| BlockToStepN              | 48.529 ms                 | 163.485 ms                |
| OneStep                   | 145.474 ms                | 987.322 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:19.238206 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240124 07:18:19.731209 31973 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240124 07:18:19.845009 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=14874
W20240124 07:18:20.279695 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240124 07:18:20.791007 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 07:18:20.845010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=10990
W20240124 07:18:21.279260 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240124 07:18:21.804800 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
E20240124 07:18:21.845012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=16073
W20240124 07:18:22.287024 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=166
E20240124 07:18:22.845009 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=56352
W20240124 07:18:22.957494 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
W20240124 07:18:23.431037 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
E20240124 07:18:23.848424 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:24.019774 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.585 ms                  | 58.928 ms                 |
| ProcessBack:UpdateCache   | 9.671 ms                  | 16.205 ms                 |
| ProcessBack:UpsertPq      | 21.852 ms                 | 116.603 ms                |
| ProcessOneStep            | 62.018 ms                 | 788.068 ms                |
| BlockToStepN              | 50.236 ms                 | 163.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.007 ms                  | 269.531 ms                |
| Forward                   | 5.128 ms                  | 29.657 ms                 |
| Backward                  | 5.046 ms                  | 9.066 ms                  |
| Optimize                  | 2.207 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 60.620 us                 | 288.415 ms                |
| AfterBackward             | 62.062 ms                 | 788.118 ms                |
| BlockToStepN              | 50.335 ms                 | 163.485 ms                |
| OneStep                   | 157.385 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:24.475031 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240124 07:18:24.848009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=35339
W20240124 07:18:25.040098 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 07:18:25.475032 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240124 07:18:25.848013 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=32282
W20240124 07:18:26.068228 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
W20240124 07:18:26.475008 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240124 07:18:26.848009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=25084
W20240124 07:18:27.170804 31973 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240124 07:18:27.475138 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=189
E20240124 07:18:27.848011 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=36057
W20240124 07:18:28.225246 31973 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
W20240124 07:18:28.475164 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240124 07:18:28.848012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=9425
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.646 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.663 ms                  | 15.182 ms                 |
| ProcessBack:UpsertPq      | 22.462 ms                 | 100.506 ms                |
| ProcessOneStep            | 62.018 ms                 | 863.118 ms                |
| BlockToStepN              | 50.236 ms                 | 213.613 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.036 ms                  | 269.531 ms                |
| Forward                   | 5.103 ms                  | 29.657 ms                 |
| Backward                  | 5.973 ms                  | 9.066 ms                  |
| Optimize                  | 2.206 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 55.530 us                 | 288.415 ms                |
| AfterBackward             | 62.062 ms                 | 863.187 ms                |
| BlockToStepN              | 50.335 ms                 | 213.760 ms                |
| OneStep                   | 162.181 ms                | 882.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:29.300894 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
W20240124 07:18:29.794927 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
E20240124 07:18:29.848011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=40747
[proc 1] 200 steps, total: 20.437, sample: 2.004, forward: 0.449, backward: 0.532, update: 0.184
[proc 4] 200 steps, total: 20.437, sample: 1.020, forward: 0.545, backward: 0.535, update: 0.209
[proc 5] 200 steps, total: 20.437, sample: 1.083, forward: 0.540, backward: 0.513, update: 0.205
[proc 3] 200 steps, total: 20.437, sample: 1.225, forward: 0.483, backward: 0.560, update: 0.208
[proc 2] 200 steps, total: 20.437, sample: 1.260, forward: 0.480, backward: 0.526, update: 0.207
[proc 6] 200 steps, total: 20.437, sample: 1.107, forward: 0.504, backward: 0.519, update: 0.206
[proc 7] 200 steps, total: 20.437, sample: 0.971, forward: 0.501, backward: 0.521, update: 0.204
[proc 0] 200 steps, total: 20.435, sample: 3.641, forward: 0.539, backward: 0.609, update: 0.225
W20240124 07:18:30.316335 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
W20240124 07:18:30.816066 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240124 07:18:30.848008 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=41668
W20240124 07:18:31.318730 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240124 07:18:31.816159 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=211, pq.top=211
E20240124 07:18:31.848011 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=27432
W20240124 07:18:32.376668 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
E20240124 07:18:32.848006 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240124 07:18:32.927404 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240124 07:18:33.384521 31973 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
E20240124 07:18:33.848013 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=7381
W20240124 07:18:33.927294 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.652 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.676 ms                  | 15.641 ms                 |
| ProcessBack:UpsertPq      | 22.462 ms                 | 116.603 ms                |
| ProcessOneStep            | 62.436 ms                 | 863.118 ms                |
| BlockToStepN              | 48.633 ms                 | 213.613 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.703 ms                  | 360.346 ms                |
| Forward                   | 5.195 ms                  | 29.657 ms                 |
| Backward                  | 6.105 ms                  | 9.066 ms                  |
| Optimize                  | 2.252 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 50.140 us                 | 288.415 ms                |
| AfterBackward             | 62.853 ms                 | 863.187 ms                |
| BlockToStepN              | 49.305 ms                 | 213.760 ms                |
| OneStep                   | 163.310 ms                | 882.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:34.436821 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240124 07:18:34.850822 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=49
W20240124 07:18:35.026820 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240124 07:18:35.440853 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 07:18:35.853636 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=8055
W20240124 07:18:36.199551 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240124 07:18:36.460868 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 07:18:36.853010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=20985
W20240124 07:18:37.199615 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240124 07:18:37.502429 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 07:18:37.853015 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=10809
W20240124 07:18:38.305711 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240124 07:18:38.511752 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240124 07:18:38.853009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=52328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.659 ms                  | 37.189 ms                 |
| ProcessBack:UpdateCache   | 9.679 ms                  | 15.182 ms                 |
| ProcessBack:UpsertPq      | 22.676 ms                 | 100.506 ms                |
| ProcessOneStep            | 63.550 ms                 | 863.118 ms                |
| BlockToStepN              | 49.200 ms                 | 233.252 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.362 ms                  | 372.866 ms                |
| Forward                   | 5.270 ms                  | 29.657 ms                 |
| Backward                  | 6.109 ms                  | 9.066 ms                  |
| Optimize                  | 2.298 ms                  | 5.279 ms                  |
| BarrierTimeBeforeRank0    | 43.999 us                 | 288.415 ms                |
| AfterBackward             | 63.589 ms                 | 863.187 ms                |
| BlockToStepN              | 49.305 ms                 | 233.440 ms                |
| OneStep                   | 162.181 ms                | 882.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:39.405282 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240124 07:18:39.517577 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240124 07:18:39.853008 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=11041
W20240124 07:18:40.405061 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240124 07:18:40.609292 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
E20240124 07:18:40.853392 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:41.507723 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240124 07:18:41.688864 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
E20240124 07:18:41.853016 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=10242
W20240124 07:18:42.508332 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240124 07:18:42.747279 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 07:18:42.855475 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=66288
W20240124 07:18:43.543496 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=269
W20240124 07:18:43.782164 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
E20240124 07:18:43.855015 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=5934
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.700 ms                  | 57.797 ms                 |
| ProcessBack:UpdateCache   | 9.701 ms                  | 15.182 ms                 |
| ProcessBack:UpsertPq      | 22.476 ms                 | 116.603 ms                |
| ProcessOneStep            | 63.122 ms                 | 788.068 ms                |
| BlockToStepN              | 50.236 ms                 | 231.000 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.379 ms                  | 360.346 ms                |
| Forward                   | 5.242 ms                  | 17.632 ms                 |
| Backward                  | 6.109 ms                  | 7.826 ms                  |
| Optimize                  | 2.260 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 43.999 us                 | 204.514 ms                |
| AfterBackward             | 63.589 ms                 | 788.118 ms                |
| BlockToStepN              | 50.335 ms                 | 231.126 ms                |
| OneStep                   | 163.872 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:44.606463 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=275, pq.top=275
E20240124 07:18:44.855084 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=59929
W20240124 07:18:44.910424 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 07:18:45.804381 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
E20240124 07:18:45.855007 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=29579
W20240124 07:18:45.966867 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
W20240124 07:18:46.804317 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
E20240124 07:18:46.855017 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=21770
W20240124 07:18:47.050935 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 07:18:47.804490 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=290, pq.top=289
E20240124 07:18:47.855010 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=20118
W20240124 07:18:48.091578 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 07:18:48.804073 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
E20240124 07:18:48.893322 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:49.117529 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.736 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.636 ms                  | 14.975 ms                 |
| ProcessBack:UpsertPq      | 22.676 ms                 | 116.603 ms                |
| ProcessOneStep            | 63.981 ms                 | 788.068 ms                |
| BlockToStepN              | 50.236 ms                 | 233.252 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.734 ms                  | 360.346 ms                |
| Forward                   | 5.221 ms                  | 17.632 ms                 |
| Backward                  | 6.109 ms                  | 9.066 ms                  |
| Optimize                  | 2.224 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 39.761 us                 | 204.514 ms                |
| AfterBackward             | 63.796 ms                 | 788.118 ms                |
| BlockToStepN              | 49.880 ms                 | 233.440 ms                |
| OneStep                   | 160.717 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 19.440, sample: 0.845, forward: 0.514, backward: 0.485, update: 0.202
[proc 1] 300 steps, total: 19.441, sample: 1.472, forward: 0.469, backward: 0.392, update: 0.184
[proc 3] 300 steps, total: 19.441, sample: 0.981, forward: 0.478, backward: 0.539, update: 0.202
[proc 5] 300 steps, total: 19.441, sample: 0.873, forward: 0.511, backward: 0.580, update: 0.204
[proc 4] 300 steps, total: 19.441, sample: 0.884, forward: 0.513, backward: 0.539, update: 0.204
[proc 2] 300 steps, total: 19.441, sample: 1.133, forward: 0.495, backward: 0.517, update: 0.207
[proc 0] 300 steps, total: 19.440, sample: 3.369, forward: 0.563, backward: 0.582, update: 0.248
[proc 6] 300 steps, total: 19.441, sample: 0.900, forward: 0.518, backward: 0.543, update: 0.202
W20240124 07:18:49.852495 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240124 07:18:49.893023 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=186648
W20240124 07:18:50.247212 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 07:18:50.893010 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=123441
W20240124 07:18:50.904271 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240124 07:18:51.282110 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240124 07:18:51.898999 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:18:51.979408 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240124 07:18:52.282052 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 07:18:52.898012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=72000
W20240124 07:18:52.979518 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240124 07:18:53.353143 31973 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
E20240124 07:18:53.898010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=10568
W20240124 07:18:53.979458 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=322, pq.top=322
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.777 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.701 ms                  | 14.975 ms                 |
| ProcessBack:UpsertPq      | 22.493 ms                 | 124.349 ms                |
| ProcessOneStep            | 64.542 ms                 | 788.068 ms                |
| BlockToStepN              | 50.236 ms                 | 313.005 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.069 ms                 | 360.346 ms                |
| Forward                   | 5.195 ms                  | 17.632 ms                 |
| Backward                  | 6.076 ms                  | 9.066 ms                  |
| Optimize                  | 2.213 ms                  | 4.897 ms                  |
| BarrierTimeBeforeRank0    | 38.402 us                 | 204.514 ms                |
| AfterBackward             | 64.607 ms                 | 788.118 ms                |
| BlockToStepN              | 50.335 ms                 | 313.123 ms                |
| OneStep                   | 163.872 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:54.374841 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
E20240124 07:18:54.898011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=7752
W20240124 07:18:54.985654 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240124 07:18:55.400357 31973 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240124 07:18:55.898097 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=5010
W20240124 07:18:56.050249 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240124 07:18:56.417258 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240124 07:18:56.898012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=54376
W20240124 07:18:57.050457 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240124 07:18:57.443588 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240124 07:18:57.898010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=15715
W20240124 07:18:58.255434 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240124 07:18:58.477916 31973 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240124 07:18:58.898010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=40607
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.797 ms                  | 37.189 ms                 |
| ProcessBack:UpdateCache   | 9.736 ms                  | 14.860 ms                 |
| ProcessBack:UpsertPq      | 22.454 ms                 | 124.349 ms                |
| ProcessOneStep            | 64.142 ms                 | 788.068 ms                |
| BlockToStepN              | 52.679 ms                 | 313.005 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.203 ms                 | 319.692 ms                |
| Forward                   | 5.168 ms                  | 11.158 ms                 |
| Backward                  | 5.907 ms                  | 8.874 ms                  |
| Optimize                  | 2.189 ms                  | 4.728 ms                  |
| BarrierTimeBeforeRank0    | 37.718 us                 | 198.336 ms                |
| AfterBackward             | 64.192 ms                 | 774.103 ms                |
| BlockToStepN              | 53.636 ms                 | 313.123 ms                |
| OneStep                   | 165.595 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:18:59.255784 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240124 07:18:59.501345 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240124 07:18:59.898010 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=162560
W20240124 07:19:00.320264 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240124 07:19:00.614368 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 07:19:00.898011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=106179
W20240124 07:19:01.363703 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240124 07:19:01.637833 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 07:19:01.898010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=34331
W20240124 07:19:02.581954 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240124 07:19:02.696583 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 07:19:02.898011 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=11075
W20240124 07:19:03.633193 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240124 07:19:03.744341 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
E20240124 07:19:03.898013 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=185833
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.845 ms                  | 39.672 ms                 |
| ProcessBack:UpdateCache   | 9.739 ms                  | 14.860 ms                 |
| ProcessBack:UpsertPq      | 22.447 ms                 | 124.349 ms                |
| ProcessOneStep            | 64.569 ms                 | 774.031 ms                |
| BlockToStepN              | 52.679 ms                 | 329.360 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.180 ms                 | 319.692 ms                |
| Forward                   | 5.122 ms                  | 11.158 ms                 |
| Backward                  | 5.329 ms                  | 8.874 ms                  |
| Optimize                  | 2.159 ms                  | 4.728 ms                  |
| BarrierTimeBeforeRank0    | 37.310 us                 | 198.336 ms                |
| AfterBackward             | 64.696 ms                 | 774.103 ms                |
| BlockToStepN              | 53.636 ms                 | 329.500 ms                |
| OneStep                   | 165.912 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:04.745234 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=376
W20240124 07:19:04.759941 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 07:19:04.898012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=120645
W20240124 07:19:05.745087 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240124 07:19:05.806728 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 07:19:05.898010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=85860
W20240124 07:19:06.745997 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240124 07:19:06.848757 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240124 07:19:06.900216 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 07:19:07.772848 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240124 07:19:07.889063 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 07:19:07.900005 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=65706
[proc 0] 400 steps, total: 19.060, sample: 2.373, forward: 0.487, backward: 0.495, update: 0.193
[proc 1] 400 steps, total: 19.060, sample: 1.155, forward: 0.498, backward: 0.437, update: 0.182
[proc 6] 400 steps, total: 19.060, sample: 0.910, forward: 0.493, backward: 0.497, update: 0.201
[proc 5] 400 steps, total: 19.060, sample: 0.837, forward: 0.507, backward: 0.521, update: 0.208
[proc 7] 400 steps, total: 19.060, sample: 0.809, forward: 0.496, backward: 0.498, update: 0.204
[proc 4] 400 steps, total: 19.060, sample: 0.867, forward: 0.483, backward: 0.493, update: 0.195
[proc 2] 400 steps, total: 19.060, sample: 1.037, forward: 0.468, backward: 0.531, update: 0.209
[proc 3] 400 steps, total: 19.060, sample: 1.124, forward: 0.487, backward: 0.574, update: 0.198
W20240124 07:19:08.772279 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240124 07:19:08.900012 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=41483
W20240124 07:19:08.908970 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.896 ms                  | 37.189 ms                 |
| ProcessBack:UpdateCache   | 9.711 ms                  | 13.685 ms                 |
| ProcessBack:UpsertPq      | 22.453 ms                 | 120.656 ms                |
| ProcessOneStep            | 64.820 ms                 | 774.031 ms                |
| BlockToStepN              | 52.679 ms                 | 423.916 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.069 ms                 | 319.692 ms                |
| Forward                   | 5.092 ms                  | 11.158 ms                 |
| Backward                  | 5.212 ms                  | 8.874 ms                  |
| Optimize                  | 2.142 ms                  | 4.728 ms                  |
| BarrierTimeBeforeRank0    | 36.536 us                 | 198.336 ms                |
| AfterBackward             | 64.866 ms                 | 774.103 ms                |
| BlockToStepN              | 53.850 ms                 | 436.017 ms                |
| OneStep                   | 163.872 ms                | 805.234 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 07:19:09.900012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=185
W20240124 07:19:09.906641 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=402, pq.top=401
W20240124 07:19:09.972697 31973 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 07:19:10.900009 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=44464
W20240124 07:19:10.906853 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240124 07:19:10.994763 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240124 07:19:11.900012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=90447
W20240124 07:19:11.965128 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240124 07:19:12.130108 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 07:19:12.901531 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=252268
W20240124 07:19:13.173966 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240124 07:19:13.901034 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=73875
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.908 ms                  | 37.189 ms                 |
| ProcessBack:UpdateCache   | 9.676 ms                  | 13.685 ms                 |
| ProcessBack:UpsertPq      | 22.462 ms                 | 120.656 ms                |
| ProcessOneStep            | 64.820 ms                 | 774.031 ms                |
| BlockToStepN              | 52.679 ms                 | 435.839 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:14.192021 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.932 ms                  | 319.692 ms                |
| Forward                   | 5.083 ms                  | 11.158 ms                 |
| Backward                  | 5.218 ms                  | 9.066 ms                  |
| Optimize                  | 2.122 ms                  | 4.728 ms                  |
| BarrierTimeBeforeRank0    | 36.376 us                 | 198.336 ms                |
| AfterBackward             | 64.943 ms                 | 788.118 ms                |
| BlockToStepN              | 53.636 ms                 | 436.017 ms                |
| OneStep                   | 163.872 ms                | 805.868 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:14.274535 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 07:19:14.901012 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=36189
W20240124 07:19:15.315029 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240124 07:19:15.345389 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240124 07:19:15.903997 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=240367
W20240124 07:19:16.418745 31973 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 07:19:16.525552 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240124 07:19:16.903013 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=54751
W20240124 07:19:17.432334 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 07:19:17.525983 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=439
E20240124 07:19:17.903009 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=8586
W20240124 07:19:18.442922 31973 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 07:19:18.561128 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
E20240124 07:19:18.903010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=113064
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.940 ms                  | 31.940 ms                 |
| ProcessBack:UpdateCache   | 9.652 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 22.449 ms                 | 124.349 ms                |
| ProcessOneStep            | 64.902 ms                 | 788.068 ms                |
| BlockToStepN              | 52.679 ms                 | 481.734 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.058 ms                 | 319.692 ms                |
| Forward                   | 5.079 ms                  | 11.158 ms                 |
| Backward                  | 5.185 ms                  | 9.066 ms                  |
| Optimize                  | 2.101 ms                  | 4.728 ms                  |
| BarrierTimeBeforeRank0    | 35.545 us                 | 198.336 ms                |
| AfterBackward             | 64.943 ms                 | 788.118 ms                |
| BlockToStepN              | 53.636 ms                 | 481.877 ms                |
| OneStep                   | 163.720 ms                | 882.951 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:19.482667 31973 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
W20240124 07:19:19.626680 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240124 07:19:19.903016 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=963
W20240124 07:19:20.514559 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 07:19:20.765003 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
E20240124 07:19:20.903010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=60020
W20240124 07:19:21.558097 31973 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
W20240124 07:19:21.764472 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240124 07:19:21.903016 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=34112
W20240124 07:19:22.677448 31973 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 07:19:22.903610 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=4738
W20240124 07:19:22.998586 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240124 07:19:23.797495 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240124 07:19:23.903010 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=157445
W20240124 07:19:23.998828 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.949 ms                  | 31.940 ms                 |
| ProcessBack:UpdateCache   | 9.615 ms                  | 13.528 ms                 |
| ProcessBack:UpsertPq      | 22.447 ms                 | 124.349 ms                |
| ProcessOneStep            | 64.755 ms                 | 774.031 ms                |
| BlockToStepN              | 53.530 ms                 | 481.734 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.110 ms                 | 282.192 ms                |
| Forward                   | 5.070 ms                  | 10.595 ms                 |
| Backward                  | 5.180 ms                  | 8.874 ms                  |
| Optimize                  | 2.091 ms                  | 4.551 ms                  |
| BarrierTimeBeforeRank0    | 34.628 us                 | 176.891 ms                |
| AfterBackward             | 64.800 ms                 | 774.103 ms                |
| BlockToStepN              | 53.850 ms                 | 481.877 ms                |
| OneStep                   | 163.720 ms                | 817.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:24.799216 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240124 07:19:24.904177 31972 parallel_pq_v2.h:76] insert failed, size(hashtable)=164736
W20240124 07:19:25.073122 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240124 07:19:25.815320 31973 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240124 07:19:25.904012 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=90614
W20240124 07:19:26.107878 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240124 07:19:26.861344 31973 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
E20240124 07:19:26.904017 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=17998
W20240124 07:19:27.277787 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240124 07:19:27.904011 29931 parallel_pq_v2.h:76] insert failed, size(hashtable)=12789
W20240124 07:19:28.016978 31973 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
W20240124 07:19:28.434986 29931 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 5] 500 steps, total: 20.096, sample: 0.882, forward: 0.536, backward: 0.588, update: 0.209
[proc 0] 500 steps, total: 20.096, sample: 2.216, forward: 0.482, backward: 0.529, update: 0.188
[proc 6] 500 steps, total: 20.096, sample: 0.878, forward: 0.529, backward: 0.531, update: 0.196
[proc 3] 500 steps, total: 20.096, sample: 0.971, forward: 0.478, backward: 0.517, update: 0.222
[proc 7] 500 steps, total: 20.096, sample: 0.705, forward: 0.493, backward: 0.525, update: 0.202
[proc 4] 500 steps, total: 20.096, sample: 0.963, forward: 0.496, backward: 0.494, update: 0.206
[proc 2] 500 steps, total: 20.096, sample: 0.876, forward: 0.477, backward: 0.506, update: 0.208
Successfully xmh. training takes 101.36144042015076 seconds
before call kg_cache_controller.StopThreads()
[proc 1] 500 steps, total: 20.096, sample: 1.089, forward: 0.492, backward: 0.437, update: 0.205
W20240124 07:19:28.581818 29931 grad_async_v2.h:71] call StopThreads. PID = 3874
W20240124 07:19:28.581856 29931 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 07:19:28.582361 29931 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 07:19:28.582374 29931 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
E20240124 07:19:28.904009 31973 parallel_pq_v2.h:76] insert failed, size(hashtable)=19427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.978 ms                  | 28.162 ms                 |
| ProcessBack:UpdateCache   | 9.596 ms                  | 12.857 ms                 |
| ProcessBack:UpsertPq      | 22.462 ms                 | 120.656 ms                |
| ProcessOneStep            | 64.820 ms                 | 774.031 ms                |
| BlockToStepN              | 53.712 ms                 | 481.734 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.015 ms                 | 282.192 ms                |
| Forward                   | 5.070 ms                  | 10.595 ms                 |
| Backward                  | 5.180 ms                  | 8.874 ms                  |
| Optimize                  | 2.076 ms                  | 4.551 ms                  |
| BarrierTimeBeforeRank0    | 34.213 us                 | 176.891 ms                |
| AfterBackward             | 64.866 ms                 | 774.103 ms                |
| BlockToStepN              | 53.943 ms                 | 481.877 ms                |
| OneStep                   | 165.595 ms                | 817.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 07:19:29.288043 29931 grad_async_v2.h:91] StopThreads done.
