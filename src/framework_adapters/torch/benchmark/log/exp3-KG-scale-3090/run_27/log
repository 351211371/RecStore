WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:02:02.256965 48457 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_42', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [48457 sampler.py:454] Start PreSampling
WARNING [48457 sampler.py:532] Before construct renumbering_dict
WARNING [48457 sampler.py:555] PreSampling done
W20240123 02:02:05.342221 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:02:05.342478 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:02:05.342532 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:02:05.342569 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:02:05.342610 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:02:05.342649 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:02:05.342680 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:02:05.342730 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:02:05.342765 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:02:05.342797 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:02:05.342839 48457 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:02:05.342880 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:02:05.342919 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:02:05.343070 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:02:05.343116 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:02:05.343148 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:02:05.343189 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:02:05.343219 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:02:05.343276 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:02:05.343313 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:02:05.343356 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:02:05.343385 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:02:05.343425 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:02:05.343457 48457 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:02:05.343483 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:02:05.343508 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:02:05.343585 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:02:05.343619 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:02:05.343668 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:02:05.343698 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:02:05.343729 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:02:05.343776 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:02:05.343811 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:02:05.343856 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:02:05.343905 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:02:05.343940 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:02:05.343976 48457 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:02:05.344002 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:02:05.344033 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:02:05.344094 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:02:05.344139 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:02:05.344169 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:02:05.344208 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:02:05.344250 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:02:05.344291 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:02:05.344322 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:02:05.344357 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:02:05.344400 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:02:05.344442 48457 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:02:05.344472 48457 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:02:05.344497 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:02:05.344532 48457 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:02:05.555948 48457 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240123 02:02:05.556114 48457 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 995, 1150, 1182,  ..., 7084, 4270, 7283]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.336 seconds
[Rank1] pid = 48859
[Rank2] pid = 48899
INFO [48457 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [48859 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48899 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [48987 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [48859 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48457 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48987 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [48899 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [48457 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48987 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48899 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [48859 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:02:07.848548 48988 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240123 02:02:07.848654 48860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:02:07.848764 49051 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:02:07.848889 48924 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240123 02:02:08.310508 48924 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240123 02:02:08.312273 48988 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 02:02:08.313807 48860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240123 02:02:08.314347 49051 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.573 ms                  | 20.381 ms                 |
| Forward                   | 7.476 ms                  | 10.982 ms                 |
| Backward                  | 49.944 ms                 | 62.773 ms                 |
| Optimize                  | 2.163 ms                  | 5.081 ms                  |
| BarrierTimeBeforeRank0    | 7.710 ms                  | 24.377 ms                 |
| BlockToStepN              | 24.277 us                 | 63.332 us                 |
| OneStep                   | 69.569 ms                 | 104.655 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 7.873, sample: 0.384, forward: 1.321, backward: 5.615, update: 0.204
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 7.877, sample: 0.406, forward: 1.387, backward: 5.670, update: 0.213
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 7.873, sample: 0.366, forward: 1.401, backward: 5.293, update: 0.229
[Rank3] pid = 48987
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 5719,  7597, 12473,  4793,     6,  5175,  9010,   155,   115, 10507]) tensor([ 1182, 11440,  2543, 13292,  2642, 11372,  3459,  5834,  4061, 13670])
-------Step 1-------
tensor([ 5719,  7597, 12473,  4793,     6,  5175,  9010,   155,   115, 10507]) tensor([ 3304,  7844, 10003,  7442,  6164, 10701, 10004,  2510,  5398,  9210])
-------Step 2-------
tensor([13060,  9782,  7933,  6114,    34,  2598,    45,  7703,  3903,  2907]) tensor([10501,  1803,  6429,  7321,  8746,    12, 13770,  9191,  9505, 11412])
-------Step 3-------
tensor([13060,  9782,  7933,  6114,    34,  2598,    45,  7703,  3903,  2907]) tensor([ 9695,  1604, 14123,  3617,  8048,  3232, 12593,  3532,  6031, 11222])
-------Step 4-------
tensor([12340,  7304,  6444,  2181,  5435, 11060,  8470, 14466,   103,  9855]) tensor([  589,  5019, 11506,  8781,  3925,    56,  2545,  3697, 10483,  7233])
-------Step 5-------
tensor([12340,  7304,  6444,  2181,  5435, 11060,  8470, 14466,   103,  9855]) tensor([ 6371,  6187,  3446, 13718, 11335, 10530,  5350, 10924,  3947, 14410])
-------Step 6-------
tensor([ 1874,  2588,  2754, 14122,    85, 10371, 11891,  4502,   126,  2933]) tensor([ 5549, 14465, 12678,  3803, 10189, 14910,  2181,  6197, 14443,  8333])
-------Step 7-------
tensor([ 1874,  2588,  2754, 14122,    85, 10371, 11891,  4502,   126,  2933]) tensor([10120,  4998, 10103,  6581,  1866,   874,  2731,  3175,  4380,  3640])
-------Step 8-------
tensor([    1,  9773,    22,  8599,  4838, 11526, 12142,  5068,   128,  3770]) tensor([ 8834,  3009,  1407,  7702,  8402, 13734,  1590,  6940,  8206, 12951])
-------Step 9-------
tensor([    1,  9773,    22,  8599,  4838, 11526, 12142,  5068,   128,  3770]) tensor([ 5129,  6800,  8612,  3031, 11896,  2051, 14578,  2510,  4542,  4115])
before start barrier
start train
[proc 0] 100 steps, total: 7.875, sample: 0.350, forward: 1.330, backward: 5.170, update: 0.218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.784 ms                  | 23.728 ms                 |
| Forward                   | 8.105 ms                  | 11.284 ms                 |
| Backward                  | 49.978 ms                 | 62.773 ms                 |
| Optimize                  | 2.269 ms                  | 5.120 ms                  |
| BarrierTimeBeforeRank0    | 5.702 ms                  | 28.144 ms                 |
| BlockToStepN              | 24.112 us                 | 332.618 us                |
| OneStep                   | 68.407 ms                 | 104.655 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.801 ms                  | 23.345 ms                 |
| Forward                   | 8.342 ms                  | 12.169 ms                 |
| Backward                  | 50.157 ms                 | 71.446 ms                 |
| Optimize                  | 2.308 ms                  | 5.120 ms                  |
| BarrierTimeBeforeRank0    | 4.790 ms                  | 28.144 ms                 |
| BlockToStepN              | 22.796 us                 | 174.922 us                |
| OneStep                   | 67.924 ms                 | 104.655 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 7.536, sample: 0.432, forward: 0.841, backward: 5.733, update: 0.215
[proc 1] 200 steps, total: 7.536, sample: 0.405, forward: 0.829, backward: 5.513, update: 0.220
[proc 3] 200 steps, total: 7.536, sample: 0.409, forward: 0.764, backward: 5.577, update: 0.206
[proc 0] 200 steps, total: 7.536, sample: 0.436, forward: 0.846, backward: 5.456, update: 0.225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.801 ms                  | 23.345 ms                 |
| Forward                   | 8.393 ms                  | 12.169 ms                 |
| Backward                  | 50.340 ms                 | 65.490 ms                 |
| Optimize                  | 2.296 ms                  | 5.081 ms                  |
| BarrierTimeBeforeRank0    | 4.302 ms                  | 24.377 ms                 |
| BlockToStepN              | 20.786 us                 | 129.631 us                |
| OneStep                   | 68.031 ms                 | 102.190 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 7.197, sample: 0.365, forward: 0.724, backward: 5.334, update: 0.195
[proc 1] 300 steps, total: 7.197, sample: 0.344, forward: 0.732, backward: 5.053, update: 0.206
[proc 2] 300 steps, total: 7.197, sample: 0.392, forward: 0.805, backward: 5.398, update: 0.208
[proc 0] 300 steps, total: 7.197, sample: 0.388, forward: 0.785, backward: 5.239, update: 0.217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.800 ms                  | 23.345 ms                 |
| Forward                   | 8.342 ms                  | 12.169 ms                 |
| Backward                  | 50.629 ms                 | 67.044 ms                 |
| Optimize                  | 2.288 ms                  | 5.081 ms                  |
| BarrierTimeBeforeRank0    | 4.248 ms                  | 28.144 ms                 |
| BlockToStepN              | 19.954 us                 | 129.631 us                |
| OneStep                   | 68.669 ms                 | 102.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.795 ms                  | 23.528 ms                 |
| Forward                   | 8.350 ms                  | 11.675 ms                 |
| Backward                  | 50.920 ms                 | 67.708 ms                 |
| Optimize                  | 2.292 ms                  | 4.814 ms                  |
| BarrierTimeBeforeRank0    | 4.132 ms                  | 28.144 ms                 |
| BlockToStepN              | 20.213 us                 | 82.205 us                 |
| OneStep                   | 69.293 ms                 | 104.655 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 7.944, sample: 0.342, forward: 0.710, backward: 5.722, update: 0.201
[proc 1] 400 steps, total: 7.944, sample: 0.400, forward: 0.624, backward: 5.100, update: 0.218
[proc 2] 400 steps, total: 7.944, sample: 0.376, forward: 0.764, backward: 5.693, update: 0.208
[proc 0] 400 steps, total: 7.944, sample: 0.385, forward: 0.771, backward: 5.593, update: 0.223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.792 ms                  | 23.528 ms                 |
| Forward                   | 8.269 ms                  | 11.871 ms                 |
| Backward                  | 50.988 ms                 | 67.044 ms                 |
| Optimize                  | 2.290 ms                  | 4.748 ms                  |
| BarrierTimeBeforeRank0    | 4.188 ms                  | 28.760 ms                 |
| BlockToStepN              | 20.020 us                 | 63.332 us                 |
| OneStep                   | 69.383 ms                 | 102.493 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 8.113, sample: 0.320, forward: 0.677, backward: 5.106, update: 0.197
[proc 3] 500 steps, total: 8.113, sample: 0.329, forward: 0.697, backward: 5.721, update: 0.199
[proc 2] 500 steps, total: 8.113, sample: 0.343, forward: 0.745, backward: 5.887, update: 0.199
[proc 0] 500 steps, total: 8.113, sample: 0.404, forward: 0.721, backward: 5.435, update: 0.216
Successfully xmh. training takes 38.665581941604614 seconds
before call kg_cache_controller.StopThreads()
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
INFO [48457 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.787 ms                  | 23.528 ms                 |
| Forward                   | 8.213 ms                  | 11.871 ms                 |
| Backward                  | 51.307 ms                 | 67.708 ms                 |
| Optimize                  | 2.280 ms                  | 4.748 ms                  |
| BarrierTimeBeforeRank0    | 4.188 ms                  | 43.488 ms                 |
| BlockToStepN              | 19.820 us                 | 82.205 us                 |
| OneStep                   | 69.613 ms                 | 201.168 ms                |
+---------------------------+---------------------------+---------------------------+
