WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 01:42:29.724377 53466 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_47', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [53466 sampler.py:454] Start PreSampling
WARNING [53466 sampler.py:532] Before construct renumbering_dict
WARNING [53466 sampler.py:555] PreSampling done
W20240124 01:56:20.054510 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 01:56:20.054752 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 01:56:20.054795 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 01:56:20.054821 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 01:56:20.054838 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 01:56:20.054862 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 01:56:20.054885 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 01:56:20.054917 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 01:56:20.054934 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 01:56:20.054956 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 01:56:20.054983 53466 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 01:56:20.055004 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 01:56:20.055018 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 01:56:20.055151 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 01:56:20.055174 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 01:56:20.055202 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 01:56:20.055238 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 01:56:20.055261 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 01:56:20.055289 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 01:56:20.055310 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 01:56:20.055328 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 01:56:20.055352 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 01:56:20.055373 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 01:56:20.055392 53466 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 01:56:20.055405 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 01:56:20.055419 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 01:56:20.055459 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 01:56:20.055482 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 01:56:20.055502 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 01:56:20.055523 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 01:56:20.055539 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 01:56:20.055565 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 01:56:20.055586 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 01:56:20.055603 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 01:56:20.055621 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 01:56:20.055636 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 01:56:20.055653 53466 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 01:56:20.055666 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 01:56:20.055683 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 01:56:20.055721 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 01:56:20.055742 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 01:56:20.055757 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 01:56:20.055779 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 01:56:20.055797 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 01:56:20.055819 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 01:56:20.055840 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 01:56:20.055861 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 01:56:20.055881 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 01:56:20.055897 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 01:56:20.055919 53466 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 01:56:20.055934 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 01:56:20.055948 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 01:56:20.055984 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 01:56:20.056015 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 01:56:20.056033 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 01:56:20.056049 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 01:56:20.056071 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 01:56:20.056097 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 01:56:20.056115 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 01:56:20.056136 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 01:56:20.056154 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 01:56:20.056172 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 01:56:20.056188 53466 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 01:56:20.056202 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 01:56:20.056217 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 01:56:20.056262 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 01:56:20.056286 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 01:56:20.056304 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 01:56:20.056320 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 01:56:20.056337 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 01:56:20.056354 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 01:56:20.056373 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 01:56:20.056394 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 01:56:20.056411 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 01:56:20.056429 53466 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 01:56:20.056447 53466 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 01:56:20.056461 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 01:56:20.056475 53466 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 01:56:20.368639 53466 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100002e52000 128.2 GB
W20240124 01:56:20.368822 53466 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102011a8a000 328.3 MB
{0: Graph(num_nodes=16364881, num_edges=60475646,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22851247, num_edges=75085053,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16469571, num_edges=67497598,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17544490, num_edges=53244935,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=18090773, num_edges=55134734,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=20615225, num_edges=67664913,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16364881 N 60475646 E
MertisPartition: part 1 has 22851247 N 75085053 E
MertisPartition: part 2 has 16469571 N 67497598 E
MertisPartition: part 3 has 17544490 N 53244935 E
MertisPartition: part 4 has 18090773 N 55134734 E
MertisPartition: part 5 has 20615225 N 67664913 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,        6,  ..., 37713888,  7166588, 11887902]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
After renumbering graph:  {'_ID': tensor([ 4302821,  4302858,  4302886,  ...,  6166532, 51849202, 34518025]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 1])}
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16364881, num_edges=60475646,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1007.273 seconds
[Rank1] pid = 14071
[Rank2] pid = 14166
[Rank3] pid = 14239
[Rank4] pid = 14321
INFO [53466 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [14071 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [14166 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [14321 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [14239 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [14403 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [14321 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [14239 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [14403 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240124 01:59:23.050113 14240 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 01:59:23.050109 14322 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 01:59:23.050467 14468 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
INFO [14071 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [14166 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240124 01:59:23.054360 14072 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 01:59:23.054556 14173 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
INFO [53466 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240124 01:59:23.056888 14404 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 01:59:23.150755 14322 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x1020262d3000 781.2 kB
W20240124 01:59:23.151082 14240 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1020263a2000 781.2 kB
W20240124 01:59:23.151173 14322 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10202652c000 781.2 kB
W20240124 01:59:23.151166 14468 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x102026467000 781.2 kB
W20240124 01:59:23.151252 14072 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020265f1000 781.2 kB
W20240124 01:59:23.151419 14322 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x1020266b6000 152.6 MB
W20240124 01:59:23.151511 14240 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10202ff4e000 781.2 kB
W20240124 01:59:23.151517 14404 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x102030013000 781.2 kB
W20240124 01:59:23.151540 14468 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x1020300d8000 781.2 kB
W20240124 01:59:23.151576 14322 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10203019d000 152.6 MB
W20240124 01:59:23.151633 14072 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102039afa000 781.2 kB
W20240124 01:59:23.151618 14173 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x102039a35000 781.2 kB
W20240124 01:59:23.151696 14240 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x102039bbf000 152.6 MB
W20240124 01:59:23.151728 14404 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x102043457000 781.2 kB
W20240124 01:59:23.151721 14322 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 01:59:23.151742 14468 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10204351c000 152.6 MB
W20240124 01:59:23.151783 14072 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10204cdb4000 152.6 MB
W20240124 01:59:23.151793 14404 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10205664c000 152.6 MB
W20240124 01:59:23.151834 14240 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10205fee4000 152.6 MB
W20240124 01:59:23.151844 14404 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10206977c000 152.6 MB
W20240124 01:59:23.151887 14468 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x102073014000 152.6 MB
W20240124 01:59:23.151921 14072 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10207c8ac000 152.6 MB
W20240124 01:59:23.151938 14404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 01:59:23.151966 14173 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x102086144000 781.2 kB
W20240124 01:59:23.151978 14240 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 01:59:23.152101 14173 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102086209000 152.6 MB
W20240124 01:59:23.152210 14173 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10208faa1000 152.6 MB
W20240124 01:59:23.153563 14173 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 01:59:23.153594 14468 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 01:59:23.153599 14072 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 01:59:23.155941 14404 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 01:59:23.155956 14322 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 01:59:23.156358 14240 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 01:59:23.157465 14173 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 01:59:23.157518 14468 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 01:59:23.158514 14072 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100002e52000
3: KnownLocalCachedEmbedding init done
WARNING [14239 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
4: KnownLocalCachedEmbedding init done
WARNING [14321 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100002e52000
5: KnownLocalCachedEmbedding init done
WARNING [14071 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [14403 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100002e52000
2: KnownLocalCachedEmbedding init done
WARNING [14166 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank5] pid = 14403
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x100002e52000
0: KnownLocalCachedEmbedding init done
WARNING [53466 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 02:00:01.709802 14404 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240124 02:00:01.709961 14240 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:00:01.710000 14173 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:00:01.710058 14322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:00:01.710116 14468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240124 02:00:01.710170 14072 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240124 02:00:01.711483 14404 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 02:00:01.711576 14404 grad_base.h:172] Init GradProcessingBase done
I20240124 02:00:10.701273 14404 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 02:00:10.701541 14404 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 02:00:10.701547 14404 kg_controller.h:84] Construct KGCacheController done
I20240124 02:00:11.400848 14404 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 02:00:27.644744 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 02:00:27.645102 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:29.399374 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 02:00:29.399469 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:30.709326 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 02:00:30.709432 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:34.409243 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 02:00:34.423542 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 02:00:34.496771 14240 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
W20240124 02:00:35.501026 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 02:00:35.568722 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 02:00:35.574962 14322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:00:35.987215 14468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240124 02:00:36.073071 14404 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240124 02:00:36.568009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240124 02:00:36.626598 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
I20240124 02:00:37.372040 14173 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
E20240124 02:00:37.568011 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240124 02:00:40.137631 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 02:00:40.152449 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 02:00:40.222474 14072 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.917 ms                 | 18.917 ms                 |
| Forward                   | 838.333 ms                | 838.333 ms                |
| Backward                  | 206.293 ms                | 206.293 ms                |
| Optimize                  | 2.186 ms                  | 2.186 ms                  |
| BarrierTimeBeforeRank0    | 19.446 ms                 | 19.446 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 02:00:42.101254 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 02:00:42.386818 14404 grad_async_v2.h:236] pq is empty
W20240124 02:00:42.392848 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 02:00:42.565935 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=3, pq.top=3
E20240124 02:00:43.101011 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=9436
W20240124 02:00:43.542749 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end0
W20240124 02:00:43.655910 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=11, pq.top=11
E20240124 02:00:44.101023 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=19516
W20240124 02:00:44.690120 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
E20240124 02:00:45.101015 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=19890
W20240124 02:00:45.120699 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240124 02:00:45.748829 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end2
E20240124 02:00:46.103251 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:46.152361 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.358 ms                  | 267.127 ms                |
| ProcessBack:UpdateCache   | 4.937 ms                  | 519.699 ms                |
| ProcessBack:UpsertPq      | 39.246 ms                 | 95.923 ms                 |
| ProcessOneStep            | 52.640 ms                 | 1.076 s                   |
| BlockToStepN              | 146.283 us                | 69.930 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.303 ms                  | 105.805 ms                |
| Forward                   | 4.686 ms                  | 838.333 ms                |
| Backward                  | 4.687 ms                  | 206.293 ms                |
| Optimize                  | 1.817 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 53.296 us                 | 27.551 ms                 |
| AfterBackward             | 52.440 ms                 | 1.078 s                   |
| BlockToStepN              | 5.174 ms                  | 69.999 ms                 |
| OneStep                   | 133.392 ms                | 2.165 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 02:00:46.757706 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240124 02:00:47.103013 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=240
W20240124 02:00:47.758929 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 02:00:47.848083 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=35, pq.top=35
E20240124 02:00:48.103014 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=25058
W20240124 02:00:48.758248 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 02:00:48.859755 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=42, pq.top=42
E20240124 02:00:49.103010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=136
W20240124 02:00:49.859086 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240124 02:00:49.996691 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240124 02:00:50.103009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=20257
W20240124 02:00:51.027042 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
E20240124 02:00:51.109217 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:51.301275 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.371 ms                  | 267.127 ms                |
| ProcessBack:UpdateCache   | 4.937 ms                  | 519.699 ms                |
| ProcessBack:UpsertPq      | 37.487 ms                 | 95.923 ms                 |
| ProcessOneStep            | 55.431 ms                 | 859.761 ms                |
| BlockToStepN              | 12.697 ms                 | 73.690 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.726 ms                  | 95.007 ms                 |
| Forward                   | 4.640 ms                  | 26.733 ms                 |
| Backward                  | 4.806 ms                  | 57.276 ms                 |
| Optimize                  | 1.866 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 57.975 us                 | 19.446 ms                 |
| AfterBackward             | 55.899 ms                 | 859.813 ms                |
| BlockToStepN              | 10.516 ms                 | 73.769 ms                 |
| OneStep                   | 133.392 ms                | 876.259 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:00:52.096658 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
E20240124 02:00:52.109009 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=705
W20240124 02:00:52.489871 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240124 02:00:53.109014 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=35
W20240124 02:00:53.144829 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
W20240124 02:00:53.492669 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
E20240124 02:00:54.109009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=209
W20240124 02:00:54.305469 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
W20240124 02:00:54.751884 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240124 02:00:55.109019 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=56
W20240124 02:00:55.328004 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
W20240124 02:00:55.849699 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=87, pq.top=87
E20240124 02:00:56.109030 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=13810
W20240124 02:00:56.383786 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.358 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 4.895 ms                  | 12.407 ms                 |
| ProcessBack:UpsertPq      | 37.182 ms                 | 154.290 ms                |
| ProcessOneStep            | 55.859 ms                 | 859.761 ms                |
| BlockToStepN              | 16.799 ms                 | 74.835 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.726 ms                  | 99.552 ms                 |
| Forward                   | 4.691 ms                  | 26.733 ms                 |
| Backward                  | 4.848 ms                  | 57.276 ms                 |
| Optimize                  | 1.907 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 62.860 us                 | 24.107 ms                 |
| AfterBackward             | 55.742 ms                 | 859.813 ms                |
| BlockToStepN              | 16.921 ms                 | 74.911 ms                 |
| OneStep                   | 131.660 ms                | 876.259 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:00:56.849071 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240124 02:00:57.109009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=21083
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.962, sample: 1.347, forward: 1.174, backward: 0.715, update: 0.193
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 21.609, sample: 1.264, forward: 1.305, backward: 0.694, update: 0.185
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 21.197, sample: 1.290, forward: 1.091, backward: 0.930, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.812, sample: 1.267, forward: 1.208, backward: 0.835, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.688, sample: 1.268, forward: 1.197, backward: 0.704, update: 0.193
train_sampler.Prefill()
-------Step 0-------
tensor([ 126704,  392158, 4356294,  212537,  212596,  212647, 7679730,  212680,
         212724,  212767]) tensor([ 4818056, 38758511, 48147806,  4477274, 59978415, 22590453, 51397590,
        15297228, 64396012,  7921533])
-------Step 1-------
tensor([ 126704,  392158, 4356294,  212537,  212596,  212647, 7679730,  212680,
         212724,  212767]) tensor([84335411, 47468310, 65621693, 45124725, 37129247, 24144224, 77546514,
        11004617, 18164827, 74485414])
-------Step 2-------
tensor([  300579,   300631,   300673,   300721,   300770, 65088788,   338249,
          300820,   300858,   300900]) tensor([37343492, 61086215, 39447644, 23090907, 10641139, 11052127, 85642027,
        57992088, 46175961,   176066])
-------Step 3-------
tensor([  300579,   300631,   300673,   300721,   300770, 65088788,   338249,
          300820,   300858,   300900]) tensor([65291439, 43782409, 31297004, 47917788, 50593037, 30866489, 27492001,
        15439410, 10091437, 68324789])
-------Step 4-------
tensor([  391035,   137317,   137330,   391079,   391137,   137349, 19825976,
          391185,   391228,  4620866]) tensor([71809797, 70978825, 18796343, 52522073, 74837150, 56034390, 62013603,
        10114902, 45378861, 30374114])
-------Step 5-------
tensor([  391035,   137317,   137330,   391079,   391137,   137349, 19825976,
          391185,   391228,  4620866]) tensor([46122264, 14442009,  9278570, 73764622,  1999525, 58221779, 19637403,
        15965238, 74835061, 66483802])
-------Step 6-------
tensor([  461964, 11352985,   461991,   462014,   462040,   142317, 19825976,
          462072, 12807919,   462107]) tensor([62787603, 17094584, 15730071, 34057186,  6615708,  3516287, 44365326,
         9332207, 24727915, 29220411])
-------Step 7-------
tensor([  461964, 11352985,   461991,   462014,   462040,   142317, 19825976,
          462072, 12807919,   462107]) tensor([42241482, 31759763, 38944451, 44034127, 48996462, 37191973, 43426731,
        23545896, 32316707, 44993794])
-------Step 8-------
tensor([71829729,   513040,    43479,   513073,   513098,   513117,   513139,
          513169,   513188,   311204]) tensor([  668119,   318677,  3477147, 49598922, 53360366, 69197987, 31244245,
        31176911, 74995365, 60154140])
-------Step 9-------
tensor([71829729,   513040,    43479,   513073,   513098,   513117,   513139,
          513169,   513188,   311204]) tensor([35631836, 14465066, 65730531, 26453567, 48940325,  5644827, 38932960,
        39595556, 58217705, 47312474])
before start barrier
start train
[proc 0] 100 steps, total: 21.111, sample: 1.549, forward: 1.335, backward: 0.736, update: 0.239
W20240124 02:00:57.559303 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
W20240124 02:00:57.882589 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=105, pq.top=105
E20240124 02:00:58.109017 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=20945
W20240124 02:00:58.693702 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
E20240124 02:00:59.116729 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:00:59.368976 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240124 02:00:59.711513 16036 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 02:01:00.116027 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=3074
W20240124 02:01:00.408818 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240124 02:01:00.804519 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end7
E20240124 02:01:01.116011 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=38078
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.354 ms                  | 7.788 ms                  |
| ProcessBack:UpdateCache   | 4.654 ms                  | 11.521 ms                 |
| ProcessBack:UpsertPq      | 26.180 ms                 | 132.583 ms                |
| ProcessOneStep            | 50.462 ms                 | 859.761 ms                |
| BlockToStepN              | 18.258 ms                 | 110.517 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:01.418079 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.949 ms                  | 99.552 ms                 |
| Forward                   | 4.915 ms                  | 26.733 ms                 |
| Backward                  | 4.972 ms                  | 57.276 ms                 |
| Optimize                  | 1.987 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 54.594 us                 | 24.107 ms                 |
| AfterBackward             | 50.397 ms                 | 859.813 ms                |
| BlockToStepN              | 18.316 ms                 | 131.286 ms                |
| OneStep                   | 127.374 ms                | 876.259 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:01.951927 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
E20240124 02:01:02.116008 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=3960
W20240124 02:01:02.814258 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240124 02:01:02.960778 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240124 02:01:03.116009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=14352
W20240124 02:01:03.814252 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240124 02:01:04.036482 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240124 02:01:04.116302 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=16145
W20240124 02:01:04.814332 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=156
E20240124 02:01:05.116009 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=12296
W20240124 02:01:05.174893 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
W20240124 02:01:05.816823 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240124 02:01:06.117125 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:01:06.287250 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.372 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 4.642 ms                  | 11.521 ms                 |
| ProcessBack:UpsertPq      | 20.092 ms                 | 132.583 ms                |
| ProcessOneStep            | 49.088 ms                 | 762.194 ms                |
| BlockToStepN              | 26.624 ms                 | 131.124 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.824 ms                  | 95.007 ms                 |
| Forward                   | 5.110 ms                  | 13.558 ms                 |
| Backward                  | 5.020 ms                  | 6.469 ms                  |
| Optimize                  | 2.001 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 54.276 us                 | 23.931 ms                 |
| AfterBackward             | 49.125 ms                 | 762.248 ms                |
| BlockToStepN              | 26.718 ms                 | 131.286 ms                |
| OneStep                   | 127.263 ms                | 811.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:06.889876 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=169
E20240124 02:01:07.117142 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=13810
W20240124 02:01:07.305210 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
W20240124 02:01:07.889061 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=177, pq.top=177
E20240124 02:01:08.117012 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=19741
W20240124 02:01:08.371229 16036 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 02:01:08.889430 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240124 02:01:09.117012 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=15478
W20240124 02:01:09.410245 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240124 02:01:10.016479 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
E20240124 02:01:10.117018 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=109270
W20240124 02:01:10.601949 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
W20240124 02:01:10.648679 16035 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240124 02:01:11.027302 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=198, pq.top=198
E20240124 02:01:11.117013 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=4103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.421 ms                  | 13.575 ms                 |
| ProcessBack:UpdateCache   | 4.873 ms                  | 8.226 ms                  |
| ProcessBack:UpsertPq      | 20.329 ms                 | 131.572 ms                |
| ProcessOneStep            | 48.689 ms                 | 762.194 ms                |
| BlockToStepN              | 30.539 ms                 | 191.271 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 14.314, sample: 1.155, forward: 0.539, backward: 0.537, update: 0.230
[proc 3] 200 steps, total: 14.314, sample: 0.995, forward: 0.477, backward: 0.543, update: 0.196
[proc 2] 200 steps, total: 14.314, sample: 1.058, forward: 0.485, backward: 0.516, update: 0.202
[proc 4] 200 steps, total: 14.314, sample: 1.138, forward: 0.518, backward: 0.486, update: 0.211
[proc 0] 200 steps, total: 14.313, sample: 1.486, forward: 0.528, backward: 0.505, update: 0.263
[proc 1] 200 steps, total: 14.315, sample: 0.958, forward: 0.470, backward: 0.545, update: 0.202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.804 ms                  | 137.024 ms                |
| Forward                   | 5.168 ms                  | 13.558 ms                 |
| Backward                  | 5.016 ms                  | 6.469 ms                  |
| Optimize                  | 1.982 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 46.820 us                 | 23.931 ms                 |
| AfterBackward             | 48.496 ms                 | 762.248 ms                |
| BlockToStepN              | 30.064 ms                 | 191.407 ms                |
| OneStep                   | 127.374 ms                | 811.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:11.778298 16036 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240124 02:01:12.117012 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=323
W20240124 02:01:12.685477 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=204, pq.top=203
W20240124 02:01:12.790791 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240124 02:01:13.117010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=5549
W20240124 02:01:13.746140 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240124 02:01:13.925329 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
E20240124 02:01:14.117023 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1021
W20240124 02:01:14.786391 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240124 02:01:14.974599 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240124 02:01:15.117010 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=145
W20240124 02:01:15.788506 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=226
W20240124 02:01:16.062295 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 02:01:16.118359 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=11799
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.483 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 4.960 ms                  | 10.022 ms                 |
| ProcessBack:UpsertPq      | 19.441 ms                 | 125.223 ms                |
| ProcessOneStep            | 48.376 ms                 | 762.194 ms                |
| BlockToStepN              | 32.193 ms                 | 191.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.064 ms                  | 145.940 ms                |
| Forward                   | 5.196 ms                  | 13.558 ms                 |
| Backward                  | 5.020 ms                  | 8.752 ms                  |
| Optimize                  | 1.981 ms                  | 25.359 ms                 |
| BarrierTimeBeforeRank0    | 40.556 us                 | 23.931 ms                 |
| AfterBackward             | 48.430 ms                 | 762.248 ms                |
| BlockToStepN              | 32.291 ms                 | 191.407 ms                |
| OneStep                   | 129.426 ms                | 811.703 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:16.796847 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240124 02:01:17.086534 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
E20240124 02:01:17.118067 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=30899
W20240124 02:01:17.796471 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240124 02:01:18.118008 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=7745
W20240124 02:01:18.149153 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 02:01:18.796602 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
E20240124 02:01:19.118382 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=67830
W20240124 02:01:19.177489 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 02:01:19.856344 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240124 02:01:20.118017 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=10229
W20240124 02:01:20.178048 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 02:01:20.856488 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240124 02:01:21.118016 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=8434
W20240124 02:01:21.188591 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.555 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.080 ms                  | 10.022 ms                 |
| ProcessBack:UpsertPq      | 19.353 ms                 | 125.223 ms                |
| ProcessOneStep            | 48.148 ms                 | 748.958 ms                |
| BlockToStepN              | 32.621 ms                 | 225.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.432 ms                  | 145.940 ms                |
| Forward                   | 5.216 ms                  | 11.482 ms                 |
| Backward                  | 5.013 ms                  | 6.469 ms                  |
| Optimize                  | 1.982 ms                  | 19.395 ms                 |
| BarrierTimeBeforeRank0    | 37.993 us                 | 22.521 ms                 |
| AfterBackward             | 48.074 ms                 | 749.014 ms                |
| BlockToStepN              | 32.705 ms                 | 225.246 ms                |
| OneStep                   | 129.485 ms                | 779.561 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:21.856168 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240124 02:01:22.118008 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=9085
W20240124 02:01:22.217007 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 02:01:22.856408 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240124 02:01:23.118012 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=7071
W20240124 02:01:23.232919 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
W20240124 02:01:23.856698 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240124 02:01:24.118010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=86868
W20240124 02:01:24.241809 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 02:01:24.856105 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=275, pq.top=275
E20240124 02:01:25.118012 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=12333
W20240124 02:01:25.344394 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 02:01:25.856702 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=279, pq.top=279
E20240124 02:01:26.118011 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=9835
W20240124 02:01:26.366935 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.584 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.202 ms                  | 8.226 ms                  |
| ProcessBack:UpsertPq      | 19.343 ms                 | 111.716 ms                |
| ProcessOneStep            | 48.033 ms                 | 748.958 ms                |
| BlockToStepN              | 32.621 ms                 | 298.992 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.832 ms                  | 333.395 ms                |
| Forward                   | 5.199 ms                  | 11.482 ms                 |
| Backward                  | 4.985 ms                  | 6.469 ms                  |
| Optimize                  | 1.975 ms                  | 19.395 ms                 |
| BarrierTimeBeforeRank0    | 36.280 us                 | 22.521 ms                 |
| AfterBackward             | 48.074 ms                 | 749.014 ms                |
| BlockToStepN              | 32.705 ms                 | 299.111 ms                |
| OneStep                   | 129.485 ms                | 779.561 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:26.856071 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240124 02:01:27.118010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=10501
W20240124 02:01:27.372242 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240124 02:01:27.856446 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240124 02:01:28.118012 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=86
W20240124 02:01:28.373363 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 02:01:28.856194 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
E20240124 02:01:29.118009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=758
W20240124 02:01:29.507483 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
[proc 3] 300 steps, total: 18.216, sample: 0.899, forward: 0.451, backward: 0.483, update: 0.193
[proc 2] 300 steps, total: 18.216, sample: 1.063, forward: 0.445, backward: 0.484, update: 0.198
[proc 5] 300 steps, total: 18.216, sample: 0.905, forward: 0.437, backward: 0.540, update: 0.193
[proc 1] 300 steps, total: 18.216, sample: 1.096, forward: 0.472, backward: 0.472, update: 0.217
[proc 4] 300 steps, total: 18.216, sample: 1.067, forward: 0.554, backward: 0.457, update: 0.281
[proc 0] 300 steps, total: 18.216, sample: 3.838, forward: 0.523, backward: 0.490, update: 0.200
W20240124 02:01:29.856262 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240124 02:01:30.118014 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=124795
W20240124 02:01:30.614781 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
W20240124 02:01:30.856065 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=305
E20240124 02:01:31.118013 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=75839
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.631 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.283 ms                  | 8.226 ms                  |
| ProcessBack:UpsertPq      | 19.953 ms                 | 111.716 ms                |
| ProcessOneStep            | 48.306 ms                 | 748.958 ms                |
| BlockToStepN              | 32.621 ms                 | 311.847 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:31.643453 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.550 ms                  | 341.088 ms                |
| Forward                   | 5.197 ms                  | 11.482 ms                 |
| Backward                  | 5.002 ms                  | 8.752 ms                  |
| Optimize                  | 1.970 ms                  | 19.395 ms                 |
| BarrierTimeBeforeRank0    | 35.338 us                 | 23.931 ms                 |
| AfterBackward             | 48.291 ms                 | 749.014 ms                |
| BlockToStepN              | 32.826 ms                 | 311.997 ms                |
| OneStep                   | 131.589 ms                | 779.561 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:31.856621 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
E20240124 02:01:32.118016 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=10442
W20240124 02:01:32.654670 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 02:01:32.975162 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
E20240124 02:01:33.118011 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1282
W20240124 02:01:33.674578 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
W20240124 02:01:34.077921 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240124 02:01:34.118010 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=17247
W20240124 02:01:34.736068 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 02:01:35.109115 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=327, pq.top=327
E20240124 02:01:35.118005 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=21003
W20240124 02:01:35.777487 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 02:01:36.118008 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=4966
W20240124 02:01:36.143039 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.651 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.429 ms                  | 7.957 ms                  |
| ProcessBack:UpsertPq      | 19.441 ms                 | 105.325 ms                |
| ProcessOneStep            | 47.933 ms                 | 748.958 ms                |
| BlockToStepN              | 34.651 ms                 | 311.847 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.078 ms                  | 383.078 ms                |
| Forward                   | 5.199 ms                  | 13.558 ms                 |
| Backward                  | 5.030 ms                  | 8.752 ms                  |
| Optimize                  | 1.957 ms                  | 19.395 ms                 |
| BarrierTimeBeforeRank0    | 35.230 us                 | 24.452 ms                 |
| AfterBackward             | 47.836 ms                 | 749.014 ms                |
| BlockToStepN              | 34.766 ms                 | 311.997 ms                |
| OneStep                   | 132.417 ms                | 779.561 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:36.841238 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240124 02:01:37.118010 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=3861
W20240124 02:01:37.315802 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240124 02:01:37.852138 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
E20240124 02:01:38.118010 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=7000
W20240124 02:01:38.352846 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=352, pq.top=352
W20240124 02:01:38.891810 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
E20240124 02:01:39.118013 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240124 02:01:39.352453 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240124 02:01:39.912946 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 02:01:40.118010 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=36644
W20240124 02:01:40.352833 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=364, pq.top=364
W20240124 02:01:41.017372 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
E20240124 02:01:41.118011 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=58
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.660 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.498 ms                  | 7.957 ms                  |
| ProcessBack:UpsertPq      | 19.156 ms                 | 105.325 ms                |
| ProcessOneStep            | 47.617 ms                 | 686.580 ms                |
| BlockToStepN              | 33.432 ms                 | 304.685 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:41.476547 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.272 ms                  | 375.276 ms                |
| Forward                   | 5.196 ms                  | 11.482 ms                 |
| Backward                  | 5.073 ms                  | 8.752 ms                  |
| Optimize                  | 1.955 ms                  | 15.758 ms                 |
| BarrierTimeBeforeRank0    | 35.168 us                 | 24.107 ms                 |
| AfterBackward             | 47.660 ms                 | 686.631 ms                |
| BlockToStepN              | 33.535 ms                 | 304.811 ms                |
| OneStep                   | 131.262 ms                | 703.191 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:42.075922 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end6
E20240124 02:01:42.118449 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=6196
W20240124 02:01:42.503582 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=380, pq.top=380
E20240124 02:01:43.118009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=53855
W20240124 02:01:43.194648 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
W20240124 02:01:43.503434 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=387
E20240124 02:01:44.118021 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=260
W20240124 02:01:44.343030 16036 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
W20240124 02:01:44.569023 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
E20240124 02:01:45.118016 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=2706
W20240124 02:01:45.409648 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
[proc 2] 400 steps, total: 15.724, sample: 1.160, forward: 0.447, backward: 0.484, update: 0.201
[proc 5] 400 steps, total: 15.724, sample: 0.978, forward: 0.437, backward: 0.502, update: 0.187
[proc 1] 400 steps, total: 15.724, sample: 1.074, forward: 0.521, backward: 0.517, update: 0.279
[proc 4] 400 steps, total: 15.724, sample: 0.972, forward: 0.511, backward: 0.453, update: 0.220
[proc 3] 400 steps, total: 15.724, sample: 0.859, forward: 0.445, backward: 0.610, update: 0.189
[proc 0] 400 steps, total: 15.723, sample: 4.016, forward: 0.509, backward: 0.563, update: 0.199
W20240124 02:01:45.569487 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240124 02:01:46.118012 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=92636
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.667 ms                  | 13.575 ms                 |
| ProcessBack:UpdateCache   | 5.564 ms                  | 7.773 ms                  |
| ProcessBack:UpsertPq      | 18.819 ms                 | 102.164 ms                |
| ProcessOneStep            | 47.776 ms                 | 686.580 ms                |
| BlockToStepN              | 34.610 ms                 | 311.847 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:46.567924 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
W20240124 02:01:46.700731 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.399 ms                  | 375.276 ms                |
| Forward                   | 5.187 ms                  | 11.482 ms                 |
| Backward                  | 5.078 ms                  | 8.752 ms                  |
| Optimize                  | 1.964 ms                  | 15.758 ms                 |
| BarrierTimeBeforeRank0    | 34.522 us                 | 24.107 ms                 |
| AfterBackward             | 47.834 ms                 | 686.631 ms                |
| BlockToStepN              | 34.732 ms                 | 311.997 ms                |
| OneStep                   | 131.589 ms                | 703.191 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 02:01:47.118011 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=14185
W20240124 02:01:47.569864 16036 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
W20240124 02:01:47.703577 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=413
E20240124 02:01:48.118008 14404 parallel_pq_v2.h:76] insert failed, size(hashtable)=710
W20240124 02:01:48.747570 16036 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 02:01:49.118052 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=907
W20240124 02:01:49.229915 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=418, pq.top=417
W20240124 02:01:49.814630 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
E20240124 02:01:50.118016 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=895
W20240124 02:01:50.230108 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=424, pq.top=424
W20240124 02:01:50.861701 16036 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240124 02:01:51.118009 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=70022
W20240124 02:01:51.230520 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.694 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.641 ms                  | 7.773 ms                  |
| ProcessBack:UpsertPq      | 19.220 ms                 | 101.104 ms                |
| ProcessOneStep            | 47.834 ms                 | 686.580 ms                |
| BlockToStepN              | 34.610 ms                 | 329.085 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.643 ms                  | 375.276 ms                |
| Forward                   | 5.168 ms                  | 11.482 ms                 |
| Backward                  | 5.099 ms                  | 8.752 ms                  |
| Optimize                  | 1.970 ms                  | 15.758 ms                 |
| BarrierTimeBeforeRank0    | 34.521 us                 | 24.452 ms                 |
| AfterBackward             | 47.941 ms                 | 686.631 ms                |
| BlockToStepN              | 34.732 ms                 | 329.251 ms                |
| OneStep                   | 132.799 ms                | 727.686 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 02:01:51.911741 16036 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240124 02:01:52.118012 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=37626
W20240124 02:01:52.596467 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240124 02:01:52.988946 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
E20240124 02:01:53.118010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=10725
W20240124 02:01:53.626148 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240124 02:01:53.993017 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 02:01:54.118010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=23641
W20240124 02:01:54.626217 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=453, pq.top=453
E20240124 02:01:55.118014 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=16389
W20240124 02:01:55.120863 16036 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
W20240124 02:01:55.626880 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=459, pq.top=459
E20240124 02:01:56.118014 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=113371
W20240124 02:01:56.146167 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.703 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.680 ms                  | 7.773 ms                  |
| ProcessBack:UpsertPq      | 18.905 ms                 | 101.104 ms                |
| ProcessOneStep            | 47.834 ms                 | 667.245 ms                |
| BlockToStepN              | 35.607 ms                 | 311.847 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.744 ms                  | 341.088 ms                |
| Forward                   | 5.177 ms                  | 8.966 ms                  |
| Backward                  | 5.112 ms                  | 7.678 ms                  |
| Optimize                  | 1.964 ms                  | 13.443 ms                 |
| BarrierTimeBeforeRank0    | 34.758 us                 | 24.107 ms                 |
| AfterBackward             | 47.878 ms                 | 667.310 ms                |
| BlockToStepN              | 37.007 ms                 | 311.997 ms                |
| OneStep                   | 133.609 ms                | 703.191 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 02:01:57.118016 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 02:01:57.150993 16036 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 02:01:57.208431 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=468, pq.top=468
E20240124 02:01:58.118010 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=47410
W20240124 02:01:58.185114 16036 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end5
W20240124 02:01:58.209127 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
E20240124 02:01:59.118021 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=28513
W20240124 02:01:59.192706 16036 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 02:01:59.312342 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
E20240124 02:02:00.118011 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=23545
W20240124 02:02:00.200331 16036 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end8
W20240124 02:02:00.314318 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=489, pq.top=489
E20240124 02:02:01.141363 16036 parallel_pq_v2.h:76] insert failed, size(hashtable)=48852
W20240124 02:02:01.274147 16036 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 02:02:01.314278 14404 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=495, pq.top=495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.722 ms                  | 13.261 ms                 |
| ProcessBack:UpdateCache   | 5.727 ms                  | 7.672 ms                  |
| ProcessBack:UpsertPq      | 18.593 ms                 | 95.923 ms                 |
| ProcessOneStep            | 47.799 ms                 | 686.580 ms                |
| BlockToStepN              | 35.607 ms                 | 311.847 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.964 ms                  | 341.088 ms                |
| Forward                   | 5.156 ms                  | 10.940 ms                 |
| Backward                  | 5.117 ms                  | 7.678 ms                  |
| Optimize                  | 1.969 ms                  | 13.443 ms                 |
| BarrierTimeBeforeRank0    | 34.758 us                 | 24.452 ms                 |
| AfterBackward             | 47.836 ms                 | 686.631 ms                |
| BlockToStepN              | 35.724 ms                 | 311.997 ms                |
| OneStep                   | 133.609 ms                | 727.686 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 500 steps, total: 16.382, sample: 0.864, forward: 0.437, backward: 0.519, update: 0.186
[proc 4] 500 steps, total: 16.382, sample: 0.888, forward: 0.495, backward: 0.485, update: 0.187
[proc 2] 500 steps, total: 16.382, sample: 1.105, forward: 0.508, backward: 0.522, update: 0.236
[proc 3] 500 steps, total: 16.382, sample: 0.887, forward: 0.435, backward: 0.478, update: 0.199
[proc 1] 500 steps, total: 16.382, sample: 0.904, forward: 0.502, backward: 0.480, update: 0.229
[proc 0] 500 steps, total: 16.382, sample: 2.726, forward: 0.504, backward: 0.591, update: 0.190
Successfully xmh. training takes 85.76574516296387 seconds
before call kg_cache_controller.StopThreads()
W20240124 02:02:01.838944 14404 grad_async_v2.h:71] call StopThreads. PID = 53466
W20240124 02:02:01.838980 14404 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 02:02:01.839504 14404 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 02:02:01.839524 14404 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
E20240124 02:02:02.141052 16035 parallel_pq_v2.h:76] insert failed, size(hashtable)=22596
W20240124 02:02:02.279028 14404 grad_async_v2.h:91] StopThreads done.
