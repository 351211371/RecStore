WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240123 02:17:32.398458 20987 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_53', no_save_emb=True, max_step=500, batch_size=800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [20987 sampler.py:454] Start PreSampling
WARNING [20987 sampler.py:532] Before construct renumbering_dict
WARNING [20987 sampler.py:555] PreSampling done
W20240123 02:17:36.017755 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240123 02:17:36.017946 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240123 02:17:36.017977 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240123 02:17:36.018018 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240123 02:17:36.018059 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240123 02:17:36.018090 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240123 02:17:36.018127 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240123 02:17:36.018169 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240123 02:17:36.018200 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240123 02:17:36.018229 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240123 02:17:36.018262 20987 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240123 02:17:36.018293 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240123 02:17:36.018317 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240123 02:17:36.018438 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240123 02:17:36.018486 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240123 02:17:36.018512 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240123 02:17:36.018541 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240123 02:17:36.018568 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240123 02:17:36.018613 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240123 02:17:36.018649 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240123 02:17:36.018676 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240123 02:17:36.018707 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240123 02:17:36.018741 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240123 02:17:36.018770 20987 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240123 02:17:36.018793 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240123 02:17:36.018821 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240123 02:17:36.018878 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240123 02:17:36.018913 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240123 02:17:36.018939 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240123 02:17:36.018970 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240123 02:17:36.018998 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240123 02:17:36.019038 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240123 02:17:36.019069 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240123 02:17:36.019097 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240123 02:17:36.019133 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240123 02:17:36.019166 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240123 02:17:36.019191 20987 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240123 02:17:36.019212 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240123 02:17:36.019240 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240123 02:17:36.019297 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240123 02:17:36.019330 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240123 02:17:36.019361 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240123 02:17:36.019393 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240123 02:17:36.019435 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240123 02:17:36.019460 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240123 02:17:36.019493 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240123 02:17:36.019521 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240123 02:17:36.019553 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240123 02:17:36.019589 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240123 02:17:36.019618 20987 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240123 02:17:36.019639 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240123 02:17:36.019665 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240123 02:17:36.019721 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000
W20240123 02:17:36.019753 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000
W20240123 02:17:36.019783 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000
W20240123 02:17:36.019807 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000
W20240123 02:17:36.019836 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000
W20240123 02:17:36.019870 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000
W20240123 02:17:36.019908 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000
W20240123 02:17:36.019943 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000
W20240123 02:17:36.019973 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000
W20240123 02:17:36.020009 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000
W20240123 02:17:36.020035 20987 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x100002694000
W20240123 02:17:36.020056 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000
W20240123 02:17:36.020085 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000
W20240123 02:17:36.020145 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000
W20240123 02:17:36.020174 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000
W20240123 02:17:36.020205 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000
W20240123 02:17:36.020229 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000
W20240123 02:17:36.020260 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000
W20240123 02:17:36.020287 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000
W20240123 02:17:36.020311 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000
W20240123 02:17:36.020337 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000
W20240123 02:17:36.020375 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000
W20240123 02:17:36.020403 20987 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000
W20240123 02:17:36.020428 20987 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x100002e4c000
W20240123 02:17:36.020448 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000
W20240123 02:17:36.020473 20987 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000
W20240123 02:17:36.222025 20987 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100002e52000
W20240123 02:17:36.222185 20987 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100004524000
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  846,   975,  1079,  ...,  1859,  2230, 10605]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 3.858 seconds
[Rank1] pid = 21385
[Rank2] pid = 21449
[Rank3] pid = 21450
[Rank4] pid = 21579
INFO [20987 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [21385 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [21449 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [21450 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [21449 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [21385 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [21579 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [21580 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [21579 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [21580 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [21450 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [21385 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [21449 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [21579 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [21580 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [21450 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [21580 cache_common.py:137] TorchNativeStdEmb construct done
INFO [21385 cache_common.py:137] TorchNativeStdEmb construct done
INFO [21449 cache_common.py:137] TorchNativeStdEmb construct done
INFO [21579 cache_common.py:137] TorchNativeStdEmb construct done
INFO [21450 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [21580 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21385 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21449 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21579 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [21450 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [20987 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [20987 cache_common.py:123] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [20987 cache_common.py:137] TorchNativeStdEmb construct done
WARNING [20987 DistTensor.py:56] The tensor name already exists in the kvstore
I20240123 02:17:39.048449 21581 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.048553 21644 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.048657 21386 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.048761 21645 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.048880 21464 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.049005 21452 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240123 02:17:39.631871 21386 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240123 02:17:39.632162 21452 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:17:39.633128 21644 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:17:39.634753 21464 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:17:39.635816 21581 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240123 02:17:39.637460 21645 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.958 us                | 8.789 ms                  |
| Forward                   | 4.990 ms                  | 19.979 ms                 |
| Backward                  | 51.268 ms                 | 139.066 ms                |
| Optimize                  | 1.394 ms                  | 2.611 ms                  |
| BarrierTimeBeforeRank0    | 7.000 ms                  | 59.472 ms                 |
| BlockToStepN              | 9.088 us                  | 308.864 us                |
| OneStep                   | 62.938 ms                 | 153.025 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 817.004 us                | 8.789 ms                  |
| Forward                   | 5.016 ms                  | 19.979 ms                 |
| Backward                  | 75.518 ms                 | 177.829 ms                |
| Optimize                  | 1.479 ms                  | 2.753 ms                  |
| BarrierTimeBeforeRank0    | 11.933 ms                 | 80.755 ms                 |
| BlockToStepN              | 8.706 us                  | 308.864 us                |
| OneStep                   | 97.412 ms                 | 206.531 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 11.705, sample: 0.185, forward: 0.961, backward: 9.612, update: 0.118
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 11.702, sample: 0.190, forward: 0.993, backward: 9.273, update: 0.116
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 11.708, sample: 0.198, forward: 0.999, backward: 8.422, update: 0.138
[Rank5] pid = 21580
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
train_sampler.Prefill()
-------Step 0-------
tensor([   59,  7524,  6003,   917, 12525,  7564,   100,  7940,  5452,  1861]) tensor([ 1079,    34,  3241,  7480,    24,  5837, 12044,  9799,  1581, 10213])
-------Step 1-------
tensor([   59,  7524,  6003,   917, 12525,  7564,   100,  7940,  5452,  1861]) tensor([ 2078,   767,  3620, 13000, 12716,   511,  3961, 13748,  6227,  7662])
-------Step 2-------
tensor([11736, 10891, 12972,  4861, 13826,  4040, 12811, 10297, 13970,  6082]) tensor([ 3425,  3207,  4304, 12963,  3008, 12772, 11972, 14268, 11878,  4576])
-------Step 3-------
tensor([11736, 10891, 12972,  4861, 13826,  4040, 12811, 10297, 13970,  6082]) tensor([6070,  360, 8345, 7621, 2391, 2733, 4885, 9357, 4442,  473])
-------Step 4-------
tensor([ 2772, 12525, 14502, 12889, 10775,  9214,    51,   114, 13525, 13543]) tensor([ 4868,  2678,   403,  9686, 12582,  5506,  8162,  9300, 10853, 10993])
-------Step 5-------
tensor([ 2772, 12525, 14502, 12889, 10775,  9214,    51,   114, 13525, 13543]) tensor([11380,  3592,  2032,  6896, 12009, 10696,  6581,  3919,  4458, 12572])
-------Step 6-------
tensor([14600, 10998,   419, 14046, 11295,  8637,    35, 10342, 12525, 10626]) tensor([11034,  1554,  8182,  1375,  2147,  2264,  8352, 14143,  6862,  4025])
-------Step 7-------
tensor([14600, 10998,   419, 14046, 11295,  8637,    35, 10342, 12525, 10626]) tensor([  213,  1017,  3241,  5430, 11018, 10906, 11736, 10983,  7149, 10410])
-------Step 8-------
tensor([ 7178, 14350,    13, 12946, 14234,  8762,    21,  6899,  4286, 10580]) tensor([ 5679,  5135,  1962, 10390, 12015,  8340, 10698,  6147, 13062,  8295])
-------Step 9-------
tensor([ 7178, 14350,    13, 12946, 14234,  8762,    21,  6899,  4286, 10580]) tensor([ 6467,  1712,  9658,  2496,  2957,  7905, 13043,  8127, 13160, 14395])
before start barrier
start train
[proc 0] 100 steps, total: 11.704, sample: 0.199, forward: 1.007, backward: 8.710, update: 0.142
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 11.708, sample: 0.179, forward: 0.994, backward: 9.287, update: 0.125
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 11.707, sample: 0.174, forward: 0.994, backward: 9.439, update: 0.116
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 817.004 us                | 8.789 ms                  |
| Forward                   | 4.990 ms                  | 19.979 ms                 |
| Backward                  | 95.459 ms                 | 194.875 ms                |
| Optimize                  | 1.537 ms                  | 2.753 ms                  |
| BarrierTimeBeforeRank0    | 13.400 ms                 | 89.930 ms                 |
| BlockToStepN              | 8.706 us                  | 308.864 us                |
| OneStep                   | 122.567 ms                | 243.457 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 833.911 us                | 8.789 ms                  |
| Forward                   | 4.989 ms                  | 19.979 ms                 |
| Backward                  | 111.124 ms                | 240.323 ms                |
| Optimize                  | 1.538 ms                  | 2.753 ms                  |
| BarrierTimeBeforeRank0    | 15.087 ms                 | 89.930 ms                 |
| BlockToStepN              | 9.103 us                  | 308.864 us                |
| OneStep                   | 146.297 ms                | 277.486 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.156 us                | 8.789 ms                  |
| Forward                   | 4.989 ms                  | 7.607 ms                  |
| Backward                  | 123.910 ms                | 276.607 ms                |
| Optimize                  | 1.539 ms                  | 2.753 ms                  |
| BarrierTimeBeforeRank0    | 16.594 ms                 | 89.930 ms                 |
| BlockToStepN              | 9.156 us                  | 155.401 us                |
| OneStep                   | 154.833 ms                | 331.236 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.233 us                | 8.789 ms                  |
| Forward                   | 4.995 ms                  | 7.607 ms                  |
| Backward                  | 139.444 ms                | 291.409 ms                |
| Optimize                  | 1.547 ms                  | 2.753 ms                  |
| BarrierTimeBeforeRank0    | 18.520 ms                 | 102.191 ms                |
| BlockToStepN              | 9.288 us                  | 155.401 us                |
| OneStep                   | 170.529 ms                | 358.787 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.613 us                | 8.789 ms                  |
| Forward                   | 5.009 ms                  | 7.607 ms                  |
| Backward                  | 148.216 ms                | 325.674 ms                |
| Optimize                  | 1.549 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 19.610 ms                 | 102.191 ms                |
| BlockToStepN              | 9.568 us                  | 155.401 us                |
| OneStep                   | 183.579 ms                | 359.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.417 us                | 8.789 ms                  |
| Forward                   | 5.017 ms                  | 7.607 ms                  |
| Backward                  | 159.159 ms                | 340.946 ms                |
| Optimize                  | 1.555 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 20.581 ms                 | 102.191 ms                |
| BlockToStepN              | 9.614 us                  | 308.864 us                |
| OneStep                   | 198.991 ms                | 387.520 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 28.898, sample: 0.217, forward: 0.509, backward: 24.256, update: 0.156
[proc 3] 200 steps, total: 28.898, sample: 0.193, forward: 0.436, backward: 26.896, update: 0.113
[proc 5] 200 steps, total: 28.898, sample: 0.194, forward: 0.434, backward: 26.505, update: 0.121
[proc 2] 200 steps, total: 28.898, sample: 0.194, forward: 0.434, backward: 24.648, update: 0.136
[proc 4] 200 steps, total: 28.898, sample: 0.193, forward: 0.433, backward: 26.415, update: 0.120
[proc 1] 200 steps, total: 28.898, sample: 0.201, forward: 0.440, backward: 25.606, update: 0.129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.768 us                | 8.789 ms                  |
| Forward                   | 5.013 ms                  | 7.607 ms                  |
| Backward                  | 173.487 ms                | 372.750 ms                |
| Optimize                  | 1.558 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 22.315 ms                 | 104.203 ms                |
| BlockToStepN              | 9.803 us                  | 308.864 us                |
| OneStep                   | 205.962 ms                | 417.106 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.417 us                | 8.879 ms                  |
| Forward                   | 5.017 ms                  | 7.607 ms                  |
| Backward                  | 179.726 ms                | 377.710 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 22.713 ms                 | 104.203 ms                |
| BlockToStepN              | 9.864 us                  | 308.864 us                |
| OneStep                   | 215.808 ms                | 442.095 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.798 us                | 9.193 ms                  |
| Forward                   | 5.018 ms                  | 7.607 ms                  |
| Backward                  | 189.978 ms                | 409.096 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 22.989 ms                 | 104.203 ms                |
| BlockToStepN              | 9.899 us                  | 308.864 us                |
| OneStep                   | 229.111 ms                | 453.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.798 us                | 9.193 ms                  |
| Forward                   | 5.018 ms                  | 7.607 ms                  |
| Backward                  | 195.381 ms                | 416.081 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 24.162 ms                 | 119.051 ms                |
| BlockToStepN              | 10.031 us                 | 308.864 us                |
| OneStep                   | 241.583 ms                | 495.149 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.417 us                | 8.879 ms                  |
| Forward                   | 5.018 ms                  | 7.565 ms                  |
| Backward                  | 206.110 ms                | 457.948 ms                |
| Optimize                  | 1.561 ms                  | 5.074 ms                  |
| BarrierTimeBeforeRank0    | 24.990 ms                 | 117.534 ms                |
| BlockToStepN              | 10.055 us                 | 155.401 us                |
| OneStep                   | 245.809 ms                | 495.551 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 853.981 us                | 8.879 ms                  |
| Forward                   | 5.023 ms                  | 7.565 ms                  |
| Backward                  | 213.191 ms                | 459.195 ms                |
| Optimize                  | 1.561 ms                  | 5.074 ms                  |
| BarrierTimeBeforeRank0    | 25.142 ms                 | 117.534 ms                |
| BlockToStepN              | 10.055 us                 | 155.401 us                |
| OneStep                   | 255.508 ms                | 516.477 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 853.981 us                | 8.879 ms                  |
| Forward                   | 5.023 ms                  | 7.607 ms                  |
| Backward                  | 220.295 ms                | 477.347 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 25.231 ms                 | 117.534 ms                |
| BlockToStepN              | 10.092 us                 | 155.401 us                |
| OneStep                   | 266.048 ms                | 522.701 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.036 us                | 8.879 ms                  |
| Forward                   | 5.019 ms                  | 7.607 ms                  |
| Backward                  | 227.646 ms                | 493.117 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 25.715 ms                 | 117.534 ms                |
| BlockToStepN              | 10.104 us                 | 155.401 us                |
| OneStep                   | 277.486 ms                | 544.001 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.358 us                | 8.879 ms                  |
| Forward                   | 5.019 ms                  | 7.607 ms                  |
| Backward                  | 238.799 ms                | 504.696 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 25.860 ms                 | 117.534 ms                |
| BlockToStepN              | 10.150 us                 | 155.401 us                |
| OneStep                   | 286.856 ms                | 544.001 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 45.930, sample: 0.178, forward: 0.438, backward: 43.739, update: 0.118
[proc 5] 300 steps, total: 45.930, sample: 0.169, forward: 0.435, backward: 42.992, update: 0.120
[proc 4] 300 steps, total: 45.929, sample: 0.173, forward: 0.432, backward: 43.120, update: 0.122
[proc 1] 300 steps, total: 45.929, sample: 0.186, forward: 0.435, backward: 41.506, update: 0.132
[proc 2] 300 steps, total: 45.929, sample: 0.186, forward: 0.432, backward: 40.723, update: 0.138
[proc 0] 300 steps, total: 45.930, sample: 0.192, forward: 0.514, backward: 40.320, update: 0.156
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.409 us                | 11.071 ms                 |
| Forward                   | 5.019 ms                  | 7.888 ms                  |
| Backward                  | 247.120 ms                | 524.012 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 26.486 ms                 | 117.534 ms                |
| BlockToStepN              | 10.189 us                 | 308.864 us                |
| OneStep                   | 298.790 ms                | 572.784 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.409 us                | 11.071 ms                 |
| Forward                   | 5.019 ms                  | 7.888 ms                  |
| Backward                  | 253.834 ms                | 557.561 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 26.911 ms                 | 119.051 ms                |
| BlockToStepN              | 10.220 us                 | 308.864 us                |
| OneStep                   | 304.238 ms                | 594.443 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 865.804 us                | 11.071 ms                 |
| Forward                   | 5.022 ms                  | 7.888 ms                  |
| Backward                  | 260.004 ms                | 574.505 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.097 ms                 | 119.051 ms                |
| BlockToStepN              | 10.220 us                 | 308.864 us                |
| OneStep                   | 313.565 ms                | 598.198 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.387 us                | 11.071 ms                 |
| Forward                   | 5.022 ms                  | 9.441 ms                  |
| Backward                  | 267.048 ms                | 590.968 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.606 ms                 | 119.051 ms                |
| BlockToStepN              | 10.220 us                 | 308.864 us                |
| OneStep                   | 330.016 ms                | 607.950 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 865.804 us                | 11.071 ms                 |
| Forward                   | 5.023 ms                  | 9.441 ms                  |
| Backward                  | 273.332 ms                | 593.424 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.606 ms                 | 119.051 ms                |
| BlockToStepN              | 10.236 us                 | 308.864 us                |
| OneStep                   | 334.401 ms                | 626.807 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 865.804 us                | 11.071 ms                 |
| Forward                   | 5.023 ms                  | 9.441 ms                  |
| Backward                  | 278.121 ms                | 606.552 ms                |
| Optimize                  | 1.561 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 27.829 ms                 | 119.051 ms                |
| BlockToStepN              | 10.314 us                 | 308.864 us                |
| OneStep                   | 338.463 ms                | 639.119 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 873.408 us                | 9.328 ms                  |
| Forward                   | 5.028 ms                  | 7.967 ms                  |
| Backward                  | 285.422 ms                | 606.552 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.829 ms                 | 117.694 ms                |
| BlockToStepN              | 10.452 us                 | 155.401 us                |
| OneStep                   | 341.480 ms                | 641.775 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.387 us                | 9.328 ms                  |
| Forward                   | 5.028 ms                  | 7.967 ms                  |
| Backward                  | 290.464 ms                | 618.208 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.829 ms                 | 117.694 ms                |
| BlockToStepN              | 10.480 us                 | 165.445 us                |
| OneStep                   | 350.545 ms                | 642.151 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 873.408 us                | 10.001 ms                 |
| Forward                   | 5.031 ms                  | 7.967 ms                  |
| Backward                  | 293.526 ms                | 633.101 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 27.965 ms                 | 117.694 ms                |
| BlockToStepN              | 10.573 us                 | 165.445 us                |
| OneStep                   | 354.805 ms                | 646.526 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 873.623 us                | 10.001 ms                 |
| Forward                   | 5.035 ms                  | 8.764 ms                  |
| Backward                  | 298.216 ms                | 633.101 ms                |
| Optimize                  | 1.562 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 117.694 ms                |
| BlockToStepN              | 10.581 us                 | 181.307 us                |
| OneStep                   | 359.991 ms                | 681.377 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 879.176 us                | 10.001 ms                 |
| Forward                   | 5.040 ms                  | 8.764 ms                  |
| Backward                  | 306.355 ms                | 648.707 ms                |
| Optimize                  | 1.561 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 117.694 ms                |
| BlockToStepN              | 10.581 us                 | 181.307 us                |
| OneStep                   | 364.354 ms                | 689.661 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 879.176 us                | 10.001 ms                 |
| Forward                   | 5.040 ms                  | 8.764 ms                  |
| Backward                  | 313.598 ms                | 670.377 ms                |
| Optimize                  | 1.562 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 117.694 ms                |
| BlockToStepN              | 10.609 us                 | 181.307 us                |
| OneStep                   | 377.942 ms                | 700.717 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 61.958, sample: 0.193, forward: 0.443, backward: 59.006, update: 0.124
[proc 4] 400 steps, total: 61.958, sample: 0.182, forward: 0.437, backward: 59.040, update: 0.126
[proc 0] 400 steps, total: 61.958, sample: 0.241, forward: 0.541, backward: 56.726, update: 0.158
[proc 3] 400 steps, total: 61.958, sample: 0.194, forward: 0.436, backward: 59.275, update: 0.112
[proc 1] 400 steps, total: 61.958, sample: 0.183, forward: 0.430, backward: 57.100, update: 0.127
[proc 2] 400 steps, total: 61.958, sample: 0.188, forward: 0.437, backward: 55.104, update: 0.148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 873.623 us                | 10.001 ms                 |
| Forward                   | 5.040 ms                  | 8.764 ms                  |
| Backward                  | 320.739 ms                | 673.031 ms                |
| Optimize                  | 1.562 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 117.694 ms                |
| BlockToStepN              | 10.732 us                 | 181.307 us                |
| OneStep                   | 383.508 ms                | 703.201 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 879.176 us                | 10.001 ms                 |
| Forward                   | 5.035 ms                  | 8.764 ms                  |
| Backward                  | 328.163 ms                | 684.507 ms                |
| Optimize                  | 1.562 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 117.694 ms                |
| BlockToStepN              | 10.709 us                 | 181.307 us                |
| OneStep                   | 385.474 ms                | 719.834 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.831 us                | 10.001 ms                 |
| Forward                   | 5.035 ms                  | 8.764 ms                  |
| Backward                  | 332.442 ms                | 712.670 ms                |
| Optimize                  | 1.562 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 29.523 ms                 | 117.694 ms                |
| BlockToStepN              | 10.753 us                 | 181.307 us                |
| OneStep                   | 387.322 ms                | 730.065 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.002 us                | 10.001 ms                 |
| Forward                   | 5.040 ms                  | 8.764 ms                  |
| Backward                  | 337.204 ms                | 722.366 ms                |
| Optimize                  | 1.560 ms                  | 5.244 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 117.694 ms                |
| BlockToStepN              | 10.753 us                 | 181.307 us                |
| OneStep                   | 393.690 ms                | 750.522 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.002 us                | 10.001 ms                 |
| Forward                   | 5.043 ms                  | 8.764 ms                  |
| Backward                  | 342.731 ms                | 744.048 ms                |
| Optimize                  | 1.561 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 119.051 ms                |
| BlockToStepN              | 10.759 us                 | 181.307 us                |
| OneStep                   | 399.559 ms                | 774.993 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 879.176 us                | 10.001 ms                 |
| Forward                   | 5.040 ms                  | 8.764 ms                  |
| Backward                  | 347.563 ms                | 772.147 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 119.051 ms                |
| BlockToStepN              | 10.803 us                 | 181.307 us                |
| OneStep                   | 404.159 ms                | 780.557 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 879.176 us                | 10.001 ms                 |
| Forward                   | 5.043 ms                  | 8.764 ms                  |
| Backward                  | 350.899 ms                | 773.264 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 119.051 ms                |
| BlockToStepN              | 10.819 us                 | 181.307 us                |
| OneStep                   | 411.541 ms                | 782.186 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 10.001 ms                 |
| Forward                   | 5.044 ms                  | 8.764 ms                  |
| Backward                  | 356.979 ms                | 774.448 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 119.859 ms                |
| BlockToStepN              | 10.850 us                 | 181.307 us                |
| OneStep                   | 415.200 ms                | 797.680 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.831 us                | 9.328 ms                  |
| Forward                   | 5.044 ms                  | 8.464 ms                  |
| Backward                  | 364.421 ms                | 782.265 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.633 ms                 | 119.051 ms                |
| BlockToStepN              | 11.017 us                 | 165.445 us                |
| OneStep                   | 417.106 ms                | 803.372 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 9.328 ms                  |
| Forward                   | 5.045 ms                  | 8.464 ms                  |
| Backward                  | 366.144 ms                | 795.132 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.633 ms                 | 119.051 ms                |
| BlockToStepN              | 11.081 us                 | 165.445 us                |
| OneStep                   | 420.969 ms                | 816.436 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 885.323 us                | 9.328 ms                  |
| Forward                   | 5.045 ms                  | 8.464 ms                  |
| Backward                  | 372.750 ms                | 807.191 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.633 ms                 | 119.859 ms                |
| BlockToStepN              | 11.183 us                 | 165.595 us                |
| OneStep                   | 427.738 ms                | 827.328 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 9.328 ms                  |
| Forward                   | 5.048 ms                  | 8.764 ms                  |
| Backward                  | 377.710 ms                | 820.509 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 120.013 ms                |
| BlockToStepN              | 11.217 us                 | 165.595 us                |
| OneStep                   | 437.083 ms                | 834.348 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 9.328 ms                  |
| Forward                   | 5.049 ms                  | 8.764 ms                  |
| Backward                  | 379.421 ms                | 821.574 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 125.215 ms                |
| BlockToStepN              | 11.232 us                 | 165.595 us                |
| OneStep                   | 443.669 ms                | 841.851 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 9.328 ms                  |
| Forward                   | 5.052 ms                  | 8.764 ms                  |
| Backward                  | 382.988 ms                | 825.852 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 28.900 ms                 | 125.215 ms                |
| BlockToStepN              | 11.240 us                 | 165.595 us                |
| OneStep                   | 451.923 ms                | 856.649 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.831 us                | 9.328 ms                  |
| Forward                   | 5.052 ms                  | 8.764 ms                  |
| Backward                  | 385.804 ms                | 848.620 ms                |
| Optimize                  | 1.560 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 125.215 ms                |
| BlockToStepN              | 11.240 us                 | 165.595 us                |
| OneStep                   | 459.526 ms                | 863.267 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 880.831 us                | 9.328 ms                  |
| Forward                   | 5.052 ms                  | 8.764 ms                  |
| Backward                  | 394.344 ms                | 853.400 ms                |
| Optimize                  | 1.558 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 29.058 ms                 | 125.215 ms                |
| BlockToStepN              | 11.255 us                 | 165.595 us                |
| OneStep                   | 462.491 ms                | 868.760 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 78.934, sample: 0.196, forward: 0.435, backward: 75.515, update: 0.125
[proc 0] 500 steps, total: 78.934, sample: 0.222, forward: 0.524, backward: 73.803, update: 0.156
[proc 3] 500 steps, total: 78.934, sample: 0.180, forward: 0.439, backward: 75.673, update: 0.118
[proc 5] 500 steps, total: 78.934, sample: 0.185, forward: 0.446, backward: 75.120, update: 0.129
[proc 2] 500 steps, total: 78.934, sample: 0.195, forward: 0.436, backward: 70.078, update: 0.140
[proc 1] 500 steps, total: 78.934, sample: 0.197, forward: 0.440, backward: 72.303, update: 0.134
Successfully xmh. training takes 227.42482328414917 seconds
before call kg_cache_controller.StopThreads()
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
INFO [20987 controller_process.py:380] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 883.186 us                | 9.328 ms                  |
| Forward                   | 5.054 ms                  | 8.764 ms                  |
| Backward                  | 398.738 ms                | 853.400 ms                |
| Optimize                  | 1.559 ms                  | 5.402 ms                  |
| BarrierTimeBeforeRank0    | 29.523 ms                 | 125.215 ms                |
| BlockToStepN              | 11.255 us                 | 165.595 us                |
| OneStep                   | 466.535 ms                | 874.375 ms                |
+---------------------------+---------------------------+---------------------------+
