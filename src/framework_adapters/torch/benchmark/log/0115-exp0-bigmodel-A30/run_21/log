/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_206', no_save_emb=True, max_step=500, batch_size=1800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=200, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=1e-07, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.2, shuffle=False, backwardMode='CppSync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2378132 sampler.py:454] Start PreSampling
WARNING [2378132 sampler.py:532] Before construct renumbering_dict
WARNING [2378132 sampler.py:555] PreSampling done
WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240115 01:03:41.126319 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240115 01:03:41.126513 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240115 01:03:41.126554 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240115 01:03:41.126586 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240115 01:03:41.126616 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240115 01:03:41.126647 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240115 01:03:41.126674 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240115 01:03:41.126709 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240115 01:03:41.126739 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240115 01:03:41.126767 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240115 01:03:41.126799 2378132 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240115 01:03:41.126830 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240115 01:03:41.126860 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240115 01:03:41.126960 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240115 01:03:41.126997 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240115 01:03:41.127025 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240115 01:03:41.127051 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240115 01:03:41.127077 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240115 01:03:41.127120 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240115 01:03:41.127151 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240115 01:03:41.127183 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240115 01:03:41.127214 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240115 01:03:41.127243 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240115 01:03:41.127274 2378132 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240115 01:03:41.127300 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240115 01:03:41.127326 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240115 01:03:41.127374 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240115 01:03:41.127413 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240115 01:03:41.127439 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240115 01:03:41.127475 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240115 01:03:41.127503 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240115 01:03:41.127533 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240115 01:03:41.127563 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240115 01:03:41.127590 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240115 01:03:41.127619 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240115 01:03:41.127650 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240115 01:03:41.127676 2378132 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240115 01:03:41.127701 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240115 01:03:41.127723 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240115 01:03:41.127770 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240115 01:03:41.127810 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240115 01:03:41.127839 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240115 01:03:41.127869 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240115 01:03:41.127897 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240115 01:03:41.127928 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240115 01:03:41.127957 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240115 01:03:41.127987 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240115 01:03:41.128015 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240115 01:03:41.128047 2378132 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240115 01:03:41.128074 2378132 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240115 01:03:41.128099 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240115 01:03:41.128121 2378132 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240115 01:03:41.261909 2378132 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240115 01:03:41.262095 2378132 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9480, num_edges=154759,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11158, num_edges=169559,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=11355, num_edges=241153,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10394, num_edges=202691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9480 N 154759 E
MertisPartition: part 1 has 11158 N 169559 E
MertisPartition: part 2 has 11355 N 241153 E
MertisPartition: part 3 has 10394 N 202691 E
Rank0: cached key size 747
Rank1: cached key size 747
Rank2: cached key size 747
Rank3: cached key size 747
Before renumbering graph:  {'_ID': tensor([    6,    10,    11,  ...,  2559,  7188, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
After renumbering graph:  {'_ID': tensor([3132, 3227, 3251,  ..., 8420, 8192, 9135]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.136 seconds
[Rank1] pid = 2378348
[Rank2] pid = 2378412
INFO [2378132 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2378348 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2378132 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2378412 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2378477 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2378412 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2378477 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2378348 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240115 01:03:44.732652 2378478 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [2990, 400]; dev=0; size=4.562 MB
W20240115 01:03:44.733541 2378478 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1000035c6000
W20240115 01:03:44.733865 2378478 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x10000368b000
W20240115 01:03:44.734023 2378478 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x100003750000
W20240115 01:03:44.734151 2378478 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10000cfe8000
W20240115 01:03:44.734272 2378478 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240115 01:03:44.734730 2378414 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [2990, 400]; dev=2; size=4.562 MB
W20240115 01:03:44.734748 2378349 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [2990, 400]; dev=1; size=4.562 MB
W20240115 01:03:44.734762 2378479 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [2990, 400]; dev=3; size=4.562 MB
W20240115 01:03:44.735705 2378478 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240115 01:03:44.736037 2378414 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x100016888000
W20240115 01:03:44.736063 2378349 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x10001694d000
W20240115 01:03:44.736093 2378479 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100016a12000
W20240115 01:03:44.736367 2378414 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100016ad7000
W20240115 01:03:44.736377 2378479 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x100016b9c000
W20240115 01:03:44.736398 2378349 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x100016c61000
W20240115 01:03:44.736542 2378349 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x100016d28000
W20240115 01:03:44.736555 2378414 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x1000205c0000
W20240115 01:03:44.736567 2378479 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x100029e58000
W20240115 01:03:44.736692 2378349 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1000336f0000
W20240115 01:03:44.736726 2378414 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10003cf88000
W20240115 01:03:44.736740 2378479 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100046820000
W20240115 01:03:44.736846 2378349 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240115 01:03:44.736862 2378414 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240115 01:03:44.736876 2378479 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240115 01:03:44.740844 2378349 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240115 01:03:44.740869 2378414 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240115 01:03:44.741269 2378479 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
cudaHostRegister 0x100001ee2000
2: KnownLocalCachedEmbedding init done
WARNING [2378412 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
3: KnownLocalCachedEmbedding init done
WARNING [2378477 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
1: KnownLocalCachedEmbedding init done
WARNING [2378348 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 2378477
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 2990), (2990, 5980), (5980, 8970), (8970, 11960)]
cudaHostRegister 0x100001ee2000
0: KnownLocalCachedEmbedding init done
WARNING [2378132 DistTensor.py:56] The tensor name already exists in the kvstore
W20240115 01:03:44.914904 2378478 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 1,
        "backwardMode": "CppSync",
        "cache_ratio": 0.2
        }
W20240115 01:03:44.915139 2378478 grad_base.h:169] Init GradProcessingBase done
W20240115 01:03:44.915158 2378478 kg_controller.h:73] after init GradSyncProcessing
I20240115 01:03:44.915163 2378478 kg_controller.h:85] Construct KGCacheController done
I20240115 01:03:45.288317 2378478 grad_base.h:59] GraphEnv RegTensorsPerProcess
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 40.457 ms                 | 1.291 s                   |
| BlockToStepN              | 525.843 us                | 866.546 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.400 ms                  | 7.818 ms                  |
| ProcessBack:UpdateCache   | 4.292 ms                  | 5.508 ms                  |
| ProcessBack:UpdateFull    | 4.898 ms                  | 6.576 ms                  |
| ProcessOneStep            | 39.334 ms                 | 983.665 ms                |
| BlockToStepN              | 894.000 ns                | 942.000 ns                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 40.018 ms                 | 50.773 ms                 |
| BlockToStepN              | 497.613 us                | 710.607 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.648 ms                  | 5.484 ms                  |
| ProcessBack:UpdateCache   | 3.851 ms                  | 5.508 ms                  |
| ProcessBack:UpdateFull    | 4.469 ms                  | 6.483 ms                  |
| ProcessOneStep            | 36.738 ms                 | 49.570 ms                 |
| BlockToStepN              | 773.000 ns                | 942.000 ns                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 39.173 ms                 | 50.773 ms                 |
| BlockToStepN              | 482.848 us                | 707.235 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.637 ms                  | 5.151 ms                  |
| ProcessBack:UpdateCache   | 3.843 ms                  | 5.508 ms                  |
| ProcessBack:UpdateFull    | 4.165 ms                  | 6.576 ms                  |
| ProcessOneStep            | 36.112 ms                 | 45.784 ms                 |
| BlockToStepN              | 720.000 ns                | 942.000 ns                |
+---------------------------+---------------------------+---------------------------+
-------Step 0-------
tensor([   49, 14428, 14164, 11799,  7121,   727,   517,  3456,  5171, 11428]) tensor([ 3251,   665,  9801, 11772, 11416,   318, 10817,  5209, 12597,  9622])
-------Step 1-------
tensor([   49, 14428, 14164, 11799,  7121,   727,   517,  3456,  5171, 11428]) tensor([ 1491, 11645,  2181,   400,  3248,  3826, 13416, 14907,  9756,  6739])
-------Step 2-------
tensor([11430,   261,     5,   265,  4696,   697, 13702,  6470,  6745,   317]) tensor([ 7148,  5498,  1319,  4626,  4258,  5539,  7866, 11844,  3943,  4695])
-------Step 3-------
tensor([11430,   261,     5,   265,  4696,   697, 13702,  6470,  6745,   317]) tensor([14715, 13082, 14038, 14343, 14407,  3919,  5169,  7567,  7720,   502])
-------Step 4-------
tensor([  495, 12534,   684,   148, 10121, 13602,  8099, 14917,  7795,  9443]) tensor([12551,  5174,  8659,  1107,  5725, 14746, 11055,  7278,  8997,  9648])
-------Step 5-------
tensor([  495, 12534,   684,   148, 10121, 13602,  8099, 14917,  7795,  9443]) tensor([11493, 14426,  1892,   703, 14684, 14695,  8796,  6311,  6273,    80])
-------Step 6-------
tensor([ 8486,   118,  4558, 14803,  8519,  9913, 13146,  7108,  6626, 11471]) tensor([ 5569,     9, 14006,  1682, 10214,   745,  2337, 14938,  1439,  4592])
-------Step 7-------
tensor([ 8486,   118,  4558, 14803,  8519,  9913, 13146,  7108,  6626, 11471]) tensor([ 8308,   603,  7176,   329, 11060, 12112,  9350,   280,  9218,  7769])
-------Step 8-------
tensor([9566, 5764,  746,  131, 4753, 5717,  609,  726,  140,  628]) tensor([12085,  5035,  1959, 10645,  8724,  7139,  8197,   136, 14778,  3951])
-------Step 9-------
tensor([9566, 5764,  746,  131, 4753, 5717,  609,  726,  140,  628]) tensor([  615,  7785,  4700, 13194,  5394,    61,  3455,  2080,  5875,   285])
[proc 0][Train](200/500) average pos_loss: 0.563522625491023
[proc 0][Train](200/500) average neg_loss: 0.5990210311673582
[proc 0][Train](200/500) average loss: 0.5812718300521373
[proc 0][Train](200/500) average regularization: 1.2339966749550513e-05
[proc 0] 200 steps, total: 17.841, sample: 0.454, forward: 3.509, backward: 4.467, update: 0.283
[proc 2][Train](200/500) average pos_loss: 0.6500069565325975
[proc 2][Train](200/500) average neg_loss: 0.5829047847539186
[proc 2][Train](200/500) average loss: 0.6164558720588684
[proc 2][Train](200/500) average regularization: 1.264755500415049e-05
[proc 2] 200 steps, total: 17.789, sample: 0.715, forward: 1.985, backward: 2.322, update: 0.341
[proc 3][Train](200/500) average pos_loss: 0.6885725553333759
[proc 3][Train](200/500) average neg_loss: 0.5989862352982164
[proc 3][Train](200/500) average loss: 0.6437793952226639
[proc 3][Train](200/500) average regularization: 1.263013633661103e-05
[proc 3] 200 steps, total: 17.791, sample: 1.224, forward: 2.514, backward: 2.354, update: 0.538
[proc 1][Train](200/500) average pos_loss: 0.6406484780460596
[proc 1][Train](200/500) average neg_loss: 0.570490583460778
[proc 1][Train](200/500) average loss: 0.6055695316195489
[proc 1][Train](200/500) average regularization: 1.248095688652029e-05
[proc 1] 200 steps, total: 17.791, sample: 1.216, forward: 2.401, backward: 2.223, update: 0.580
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 36.952 ms                 | 56.151 ms                 |
| BlockToStepN              | 479.494 us                | 707.235 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.637 ms                  | 4.805 ms                  |
| ProcessBack:UpdateCache   | 3.841 ms                  | 5.177 ms                  |
| ProcessBack:UpdateFull    | 4.020 ms                  | 6.563 ms                  |
| ProcessOneStep            | 35.290 ms                 | 45.784 ms                 |
| BlockToStepN              | 762.000 ns                | 985.000 ns                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 36.378 ms                 | 56.568 ms                 |
| BlockToStepN              | 470.716 us                | 700.867 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.613 ms                  | 4.360 ms                  |
| ProcessBack:UpdateCache   | 3.824 ms                  | 5.093 ms                  |
| ProcessBack:UpdateFull    | 3.980 ms                  | 6.464 ms                  |
| ProcessOneStep            | 32.645 ms                 | 45.161 ms                 |
| BlockToStepN              | 688.000 ns                | 985.000 ns                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 36.107 ms                 | 56.568 ms                 |
| BlockToStepN              | 467.989 us                | 700.867 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.609 ms                  | 4.351 ms                  |
| ProcessBack:UpdateCache   | 3.813 ms                  | 5.074 ms                  |
| ProcessBack:UpdateFull    | 3.960 ms                  | 6.357 ms                  |
| ProcessOneStep            | 32.205 ms                 | 43.646 ms                 |
| BlockToStepN              | 681.000 ns                | 1.116 us                  |
+---------------------------+---------------------------+---------------------------+
[proc 0][Train](400/500) average pos_loss: 0.39203814953565597
[proc 0][Train](400/500) average neg_loss: 0.5184046366810798
[proc 0][Train](400/500) average loss: 0.4552213944494724
[proc 0][Train](400/500) average regularization: 1.842576451053901e-05
[proc 0] 400 steps, total: 15.239, sample: 0.379, forward: 2.780, backward: 4.243, update: 0.225
[proc 2][Train](400/500) average pos_loss: 0.5130885764956474
[proc 2][Train](400/500) average neg_loss: 0.48225471571087836
[proc 2][Train](400/500) average loss: 0.49767164647579193
[proc 2][Train](400/500) average regularization: 1.8734935065367608e-05
[proc 2] 400 steps, total: 15.239, sample: 0.552, forward: 1.062, backward: 1.984, update: 0.249
[proc 3][Train](400/500) average pos_loss: 0.5314944848418236
[proc 3][Train](400/500) average neg_loss: 0.5074175436794758
[proc 3][Train](400/500) average loss: 0.5194560118019581
[proc 3][Train](400/500) average regularization: 1.8639177769728123e-05
[proc 3] 400 steps, total: 15.239, sample: 1.195, forward: 1.697, backward: 2.048, update: 0.456
[proc 1][Train](400/500) average pos_loss: 0.484014445990324
[proc 1][Train](400/500) average neg_loss: 0.45744182214140894
[proc 1][Train](400/500) average loss: 0.47072813406586644
[proc 1][Train](400/500) average regularization: 1.8579385859993635e-05
[proc 1] 400 steps, total: 15.239, sample: 1.201, forward: 1.590, backward: 1.896, update: 0.434
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 33.648 ms                 | 56.308 ms                 |
| BlockToStepN              | 475.115 us                | 710.607 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.594 ms                  | 3.338 ms                  |
| ProcessBack:UpdateCache   | 3.791 ms                  | 4.560 ms                  |
| ProcessBack:UpdateFull    | 3.951 ms                  | 6.190 ms                  |
| ProcessOneStep            | 32.069 ms                 | 43.646 ms                 |
| BlockToStepN              | 675.000 ns                | 1.261 us                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 33.377 ms                 | 56.568 ms                 |
| BlockToStepN              | 480.992 us                | 719.337 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.585 ms                  | 3.091 ms                  |
| ProcessBack:UpdateCache   | 3.651 ms                  | 4.261 ms                  |
| ProcessBack:UpdateFull    | 3.941 ms                  | 6.162 ms                  |
| ProcessOneStep            | 32.009 ms                 | 42.743 ms                 |
| BlockToStepN              | 671.000 ns                | 1.229 us                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 40.68490195274353 seconds
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
