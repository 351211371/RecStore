/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_229', no_save_emb=True, max_step=500, batch_size=6600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=200, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=1e-07, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.2, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2415985 sampler.py:454] Start PreSampling
WARNING [2415985 sampler.py:532] Before construct renumbering_dict
WARNING [2415985 sampler.py:555] PreSampling done
WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240115 01:37:27.584512 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240115 01:37:27.584712 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240115 01:37:27.584756 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240115 01:37:27.584789 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240115 01:37:27.584821 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240115 01:37:27.584849 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240115 01:37:27.584877 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240115 01:37:27.584911 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240115 01:37:27.584945 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240115 01:37:27.584973 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240115 01:37:27.585005 2415985 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240115 01:37:27.585039 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240115 01:37:27.585068 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240115 01:37:27.585173 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240115 01:37:27.585211 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240115 01:37:27.585242 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240115 01:37:27.585274 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240115 01:37:27.585304 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240115 01:37:27.585346 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240115 01:37:27.585381 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240115 01:37:27.585410 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240115 01:37:27.585440 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240115 01:37:27.585469 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240115 01:37:27.585496 2415985 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240115 01:37:27.585522 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240115 01:37:27.585551 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240115 01:37:27.585601 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240115 01:37:27.585637 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240115 01:37:27.585669 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240115 01:37:27.585696 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240115 01:37:27.585729 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240115 01:37:27.585757 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240115 01:37:27.585790 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240115 01:37:27.585817 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240115 01:37:27.585847 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240115 01:37:27.585880 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240115 01:37:27.585907 2415985 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240115 01:37:27.585932 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240115 01:37:27.585954 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240115 01:37:27.586000 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240115 01:37:27.586032 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240115 01:37:27.586063 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240115 01:37:27.586091 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240115 01:37:27.586120 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240115 01:37:27.586149 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240115 01:37:27.586181 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240115 01:37:27.586211 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240115 01:37:27.586241 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240115 01:37:27.586268 2415985 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240115 01:37:27.586297 2415985 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240115 01:37:27.586320 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240115 01:37:27.586345 2415985 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240115 01:37:27.719766 2415985 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240115 01:37:27.719961 2415985 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9480, num_edges=154759,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11158, num_edges=169559,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=11355, num_edges=241153,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10394, num_edges=202691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9480 N 154759 E
MertisPartition: part 1 has 11158 N 169559 E
MertisPartition: part 2 has 11355 N 241153 E
MertisPartition: part 3 has 10394 N 202691 E
Rank0: cached key size 747
Rank1: cached key size 747
Rank2: cached key size 747
Rank3: cached key size 747
Before renumbering graph:  {'_ID': tensor([    6,    10,    11,  ...,  2559,  7188, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
After renumbering graph:  {'_ID': tensor([3132, 3189, 3213,  ..., 9628, 7877, 7546]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1.673 seconds
[Rank1] pid = 2416195
[Rank2] pid = 2416259
INFO [2415985 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2416195 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2416259 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2415985 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2416259 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2416195 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2416324 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2416324 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240115 01:37:31.006309 2416325 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [2990, 400]; dev=0; size=4.562 MB
W20240115 01:37:31.007154 2416325 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1000035c6000
W20240115 01:37:31.007423 2416325 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x10000368b000
W20240115 01:37:31.007578 2416325 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x100003750000
W20240115 01:37:31.007702 2416325 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10000cfe8000
W20240115 01:37:31.007720 2416261 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [2990, 400]; dev=2; size=4.562 MB
W20240115 01:37:31.007725 2416196 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [2990, 400]; dev=1; size=4.562 MB
W20240115 01:37:31.007875 2416325 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240115 01:37:31.007911 2416326 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [2990, 400]; dev=3; size=4.562 MB
W20240115 01:37:31.009383 2416325 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240115 01:37:31.009461 2416261 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x100016888000
W20240115 01:37:31.009498 2416196 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x10001694d000
W20240115 01:37:31.009564 2416326 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100016a12000
W20240115 01:37:31.009774 2416261 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100016ad7000
W20240115 01:37:31.009811 2416196 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x100016b9c000
W20240115 01:37:31.009860 2416326 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x100016c61000
W20240115 01:37:31.009971 2416261 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x100016d26000
W20240115 01:37:31.009995 2416196 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x1000205be000
W20240115 01:37:31.010054 2416326 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x100029e56000
W20240115 01:37:31.010134 2416196 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1000336ee000
W20240115 01:37:31.010162 2416261 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x10003cf86000
W20240115 01:37:31.010222 2416326 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100046820000
W20240115 01:37:31.010299 2416196 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240115 01:37:31.010334 2416261 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240115 01:37:31.010363 2416326 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240115 01:37:31.014292 2416196 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240115 01:37:31.014345 2416326 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240115 01:37:31.014357 2416261 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
cudaHostRegister 0x100001ee2000
2: KnownLocalCachedEmbedding init done
WARNING [2416259 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
3: KnownLocalCachedEmbedding init done
WARNING [2416324 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 2416324
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 2990), (2990, 5980), (5980, 8970), (8970, 11960)]
cudaHostRegister 0x100001ee2000
0: KnownLocalCachedEmbedding init done
WARNING [2415985 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
1: KnownLocalCachedEmbedding init done
WARNING [2416195 DistTensor.py:56] The tensor name already exists in the kvstore
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 990.433 us                | 1.130 ms                  |
| BlockToStepN              | 273.386 us                | 741.071 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 999.368 us                | 1.317 ms                  |
| BlockToStepN              | 262.187 us                | 741.071 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 1.011 ms                  | 1.279 ms                  |
| BlockToStepN              | 266.427 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 998.163 us                | 1.317 ms                  |
| BlockToStepN              | 268.828 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 986.172 us                | 1.317 ms                  |
| BlockToStepN              | 265.563 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 986.172 us                | 1.346 ms                  |
| BlockToStepN              | 258.047 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 979.080 us                | 1.346 ms                  |
| BlockToStepN              | 256.907 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 976.890 us                | 1.317 ms                  |
| BlockToStepN              | 258.001 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 975.543 us                | 1.346 ms                  |
| BlockToStepN              | 256.711 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 982.185 us                | 1.346 ms                  |
| BlockToStepN              | 258.586 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
-------Step 0-------
tensor([ 8968,   724, 13543, 11851,  5991,   302,   347,  3514,  5020, 13431]) tensor([ 3213,   125,  7556, 12275, 11219,   423, 12533,  5228,  1741,  9121])
-------Step 1-------
tensor([ 8968,   724, 13543, 11851,  5991,   302,   347,  3514,  5020, 13431]) tensor([ 1987,  7865, 14348,  6857,  6598,  3518,  3271, 13802,  6975,  8038])
-------Step 2-------
tensor([13378,  8875,  7641,   649,  4313,  5454,   532, 12402, 14608,  7731]) tensor([6342, 1721,  964, 9496, 6758, 3556, 7399, 6069, 6261, 1322])
-------Step 3-------
tensor([13378,  8875,  7641,   649,  4313,  5454,   532, 12402, 14608,  7731]) tensor([  173, 13954,  4461,  7804, 10417,  5888, 11187,  8183, 14313, 10158])
-------Step 4-------
tensor([ 7602,  7820,  8099, 12144, 13729,  8566, 12891,   271,  4893,   651]) tensor([ 6022,  7294, 10106, 14085,  5557,  2795, 14351, 10614,  7750,  4068])
-------Step 5-------
tensor([ 7602,  7820,  8099, 12144, 13729,  8566, 12891,   271,  4893,   651]) tensor([  187, 11425,  6599, 13318,   173,  4965,  5168,  4224, 10857, 12891])
-------Step 6-------
tensor([ 3067,   216,  4825,   704,  6291,  4211, 13683,  7760, 12995,   222]) tensor([ 1182,  5591,  1051,   630,  9347, 11825,  9479,   343,  9387,  7467])
-------Step 7-------
tensor([ 3067,   216,  4825,   704,  6291,  4211, 13683,  7760, 12995,   222]) tensor([ 5345,  3385,  7202, 14135,  6255, 14780,  1314,  4286,  7756, 10762])
-------Step 8-------
tensor([ 8513,  3851,  6539,   181,   596,   536, 11711,   486,  7155,  8221]) tensor([11785,  5249, 13008, 11749,  5515,  6478, 12160,  2949,   835, 14562])
-------Step 9-------
tensor([ 8513,  3851,  6539,   181,   596,   536, 11711,   486,  7155,  8221]) tensor([ 6986, 13234,  4087, 11865,  4315, 10890,  9778,   187,  4034,  4064])
[proc 0][Train](200/500) average pos_loss: 0.8112086965888738
[proc 0][Train](200/500) average neg_loss: 0.4807808646000922
[proc 0][Train](200/500) average loss: 0.645994783192873
[proc 0][Train](200/500) average regularization: 5.823843826874509e-05
[proc 0] 200 steps, total: 55.117, sample: 0.927, forward: 10.140, backward: 38.602, update: 5.082
[proc 2][Train](200/500) average pos_loss: 0.7247897697985173
[proc 2][Train](200/500) average neg_loss: 0.6090749818272889
[proc 2][Train](200/500) average loss: 0.6669323770701885
[proc 2][Train](200/500) average regularization: 5.782667510175088e-05
[proc 2] 200 steps, total: 55.114, sample: 2.506, forward: 4.533, backward: 36.986, update: 1.939
[proc 1][Train](200/500) average pos_loss: 0.6999497101455927
[proc 1][Train](200/500) average neg_loss: 0.5787410063762217
[proc 1][Train](200/500) average loss: 0.639345357120037
[proc 1][Train](200/500) average regularization: 5.7511155437168784e-05
[proc 1] 200 steps, total: 55.116, sample: 2.051, forward: 4.106, backward: 37.971, update: 1.543
[proc 3][Train](200/500) average pos_loss: 0.7578803084045649
[proc 3][Train](200/500) average neg_loss: 0.6317757759755477
[proc 3][Train](200/500) average loss: 0.6948280435800552
[proc 3][Train](200/500) average regularization: 5.743699775848654e-05
[proc 3] 200 steps, total: 55.115, sample: 2.413, forward: 4.654, backward: 37.023, update: 1.999
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 984.970 us                | 1.346 ms                  |
| BlockToStepN              | 261.708 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 990.433 us                | 1.346 ms                  |
| BlockToStepN              | 264.847 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 992.512 us                | 1.317 ms                  |
| BlockToStepN              | 265.563 us                | 418.737 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 992.512 us                | 1.317 ms                  |
| BlockToStepN              | 268.123 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 993.099 us                | 1.317 ms                  |
| BlockToStepN              | 269.266 us                | 470.653 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 998.163 us                | 1.317 ms                  |
| BlockToStepN              | 270.140 us                | 470.653 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 993.144 us                | 1.317 ms                  |
| BlockToStepN              | 271.519 us                | 470.653 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 991.363 us                | 1.311 ms                  |
| BlockToStepN              | 273.214 us                | 469.343 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 993.468 us                | 1.311 ms                  |
| BlockToStepN              | 274.455 us                | 469.343 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 994.323 us                | 1.311 ms                  |
| BlockToStepN              | 273.648 us                | 469.343 us                |
+---------------------------+---------------------------+---------------------------+
[proc 1][Train](400/500) average pos_loss: 0.44275481954216955
[proc 1][Train](400/500) average neg_loss: 0.5102292509377002
[proc 1][Train](400/500) average loss: 0.47649203464388845
[proc 1][Train](400/500) average regularization: 5.412420963693876e-05
[proc 1] 400 steps, total: 50.724, sample: 2.020, forward: 3.159, backward: 34.611, update: 1.476
[proc 3][Train](400/500) average pos_loss: 0.5281223511695862
[proc 3][Train](400/500) average neg_loss: 0.5612690934538841
[proc 3][Train](400/500) average loss: 0.5446957188844681
[proc 3][Train](400/500) average regularization: 5.3945573527016676e-05
[proc 3] 400 steps, total: 50.724, sample: 2.157, forward: 3.324, backward: 34.233, update: 1.623
[proc 2][Train](400/500) average pos_loss: 0.5029492621123791
[proc 2][Train](400/500) average neg_loss: 0.5348176823556423
[proc 2][Train](400/500) average loss: 0.5188834716379642
[proc 2][Train](400/500) average regularization: 5.4299607963912425e-05
[proc 2] 400 steps, total: 50.725, sample: 2.161, forward: 3.354, backward: 34.309, update: 1.652
[proc 0][Train](400/500) average pos_loss: 0.5914012223482132
[proc 0][Train](400/500) average neg_loss: 0.41001257821917536
[proc 0][Train](400/500) average loss: 0.5007068993151188
[proc 0][Train](400/500) average regularization: 5.4852751436555994e-05
[proc 0] 400 steps, total: 50.725, sample: 0.998, forward: 9.429, backward: 34.845, update: 5.073
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 993.468 us                | 1.311 ms                  |
| BlockToStepN              | 273.386 us                | 469.343 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 997.550 us                | 1.317 ms                  |
| BlockToStepN              | 274.505 us                | 469.343 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 1.000 ms                  | 1.311 ms                  |
| BlockToStepN              | 275.417 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 1.004 ms                  | 1.311 ms                  |
| BlockToStepN              | 275.705 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| AfterBackward             | 1.005 ms                  | 1.311 ms                  |
| BlockToStepN              | 275.493 us                | 436.871 us                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 131.27972722053528 seconds
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
