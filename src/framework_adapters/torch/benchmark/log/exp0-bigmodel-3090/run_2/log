Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 3 parts
part 0 has 101575884 edges
part 1 has 101575884 edges
part 2 has 101575882 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2], has_edge_importance=False, hidden_dim=100, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=3, num_proc=3, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_Freebase_12', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 543.631 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 0][Train](1000/10000) average pos_loss: 0.7122479777932167
[proc 0][Train](1000/10000) average neg_loss: 0.7875254173874855
[proc 0][Train](1000/10000) average loss: 0.749886697113514
[proc 0][Train](1000/10000) average regularization: 8.676215564628364e-05
[proc 0] 1000 steps, total: 34.886, sample: 22.100, forward: 6.999, backward: 2.731, update: 3.049
[proc 2][Train](1000/10000) average pos_loss: 0.7126491783857346
[proc 2][Train](1000/10000) average neg_loss: 0.7869206383824349
[proc 2][Train](1000/10000) average loss: 0.7497849079370499
[proc 2][Train](1000/10000) average regularization: 8.672042224498e-05
[proc 2] 1000 steps, total: 33.770, sample: 20.983, forward: 6.969, backward: 2.696, update: 2.969
[proc 1][Train](1000/10000) average pos_loss: 0.7116621807813645
[proc 1][Train](1000/10000) average neg_loss: 0.790969206392765
[proc 1][Train](1000/10000) average loss: 0.7513156934380532
[proc 1][Train](1000/10000) average regularization: 8.622052619830356e-05
[proc 1] 1000 steps, total: 34.350, sample: 20.931, forward: 7.117, backward: 2.798, update: 3.110
[proc 2][Train](2000/10000) average pos_loss: 0.6982691329717636
[proc 2][Train](2000/10000) average neg_loss: 0.7626503983736038
[proc 2][Train](2000/10000) average loss: 0.7304597653150559
[proc 2][Train](2000/10000) average regularization: 0.0001013559626735514
[proc 2] 2000 steps, total: 11.881, sample: 2.777, forward: 3.437, backward: 2.776, update: 2.885
[proc 1][Train](2000/10000) average pos_loss: 0.6980475851893425
[proc 1][Train](2000/10000) average neg_loss: 0.7627137186527252
[proc 1][Train](2000/10000) average loss: 0.7303806517720223
[proc 1][Train](2000/10000) average regularization: 0.00010132290835463209
[proc 1] 2000 steps, total: 11.881, sample: 2.420, forward: 3.592, backward: 2.764, update: 2.972
[proc 0][Train](2000/10000) average pos_loss: 0.6974552618265152
[proc 0][Train](2000/10000) average neg_loss: 0.7627106344103813
[proc 0][Train](2000/10000) average loss: 0.7300829488039017
[proc 0][Train](2000/10000) average regularization: 0.00010130600177217275
[proc 0] 2000 steps, total: 11.882, sample: 2.421, forward: 3.609, backward: 2.774, update: 2.959
[proc 2][Train](3000/10000) average pos_loss: 0.6900159258842469
[proc 2][Train](3000/10000) average neg_loss: 0.7510413702726364
[proc 2][Train](3000/10000) average loss: 0.7205286490321159
[proc 2][Train](3000/10000) average regularization: 0.00011196594480861676
[proc 2] 3000 steps, total: 11.530, sample: 2.659, forward: 3.324, backward: 2.834, update: 2.707
[proc 1][Train](3000/10000) average pos_loss: 0.68976077324152
[proc 1][Train](3000/10000) average neg_loss: 0.7518414252996445
[proc 1][Train](3000/10000) average loss: 0.7208010991215705
[proc 1][Train](3000/10000) average regularization: 0.00011197420900862198
[proc 1] 3000 steps, total: 11.530, sample: 2.242, forward: 3.460, backward: 2.840, update: 2.784
[proc 0][Train](3000/10000) average pos_loss: 0.6897107572555542
[proc 0][Train](3000/10000) average neg_loss: 0.7521803783774376
[proc 0][Train](3000/10000) average loss: 0.7209455682635307
[proc 0][Train](3000/10000) average regularization: 0.00011187759283347987
[proc 0] 3000 steps, total: 11.531, sample: 2.269, forward: 3.480, backward: 2.764, update: 2.829
[proc 1][Train](4000/10000) average pos_loss: 0.6850729077458382
[proc 1][Train](4000/10000) average neg_loss: 0.7438171676397324
[proc 1][Train](4000/10000) average loss: 0.7144450375437736
[proc 1][Train](4000/10000) average regularization: 0.00012003141004242935
[proc 1] 4000 steps, total: 11.352, sample: 2.239, forward: 3.529, backward: 2.738, update: 2.839
[proc 0][Train](4000/10000) average pos_loss: 0.6847207338809967
[proc 0][Train](4000/10000) average neg_loss: 0.7431516577005386
[proc 0][Train](4000/10000) average loss: 0.7139361957311631
[proc 0][Train](4000/10000) average regularization: 0.00011990274881100049
[proc 0] 4000 steps, total: 11.352, sample: 2.170, forward: 3.472, backward: 2.705, update: 2.646
[proc 2][Train](4000/10000) average pos_loss: 0.6851172069311142
[proc 2][Train](4000/10000) average neg_loss: 0.7440012053847312
[proc 2][Train](4000/10000) average loss: 0.7145592068433761
[proc 2][Train](4000/10000) average regularization: 0.00011990182635054225
[proc 2] 4000 steps, total: 11.353, sample: 2.395, forward: 3.344, backward: 2.780, update: 2.624
[proc 1][Train](5000/10000) average pos_loss: 0.6803728085160256
[proc 1][Train](5000/10000) average neg_loss: 0.7373495037555695
[proc 1][Train](5000/10000) average loss: 0.7088611552715302
[proc 1][Train](5000/10000) average regularization: 0.00012587521874229423
[proc 1] 5000 steps, total: 11.766, sample: 2.635, forward: 3.539, backward: 2.758, update: 2.829
[proc 2][Train](5000/10000) average pos_loss: 0.6805521266460419
[proc 2][Train](5000/10000) average neg_loss: 0.7377278944253921
[proc 2][Train](5000/10000) average loss: 0.7091400101780891
[proc 2][Train](5000/10000) average regularization: 0.00012561646226822633
[proc 2] 5000 steps, total: 11.766, sample: 2.411, forward: 3.251, backward: 2.747, update: 2.542
[proc 0][Train](5000/10000) average pos_loss: 0.6820137676596641
[proc 0][Train](5000/10000) average neg_loss: 0.7370530127882957
[proc 0][Train](5000/10000) average loss: 0.7095333893299103
[proc 0][Train](5000/10000) average regularization: 0.00012577598139614565
[proc 0] 5000 steps, total: 11.767, sample: 2.470, forward: 3.431, backward: 2.720, update: 2.733
[proc 0][Train](6000/10000) average pos_loss: 0.6767932518124581
[proc 0][Train](6000/10000) average neg_loss: 0.7317866712212563
[proc 0][Train](6000/10000) average loss: 0.7042899615168572
[proc 0][Train](6000/10000) average regularization: 0.0001303237098181853
[proc 0] 6000 steps, total: 11.159, sample: 2.249, forward: 3.506, backward: 2.735, update: 2.662
[proc 1][Train](6000/10000) average pos_loss: 0.6764920951128006
[proc 1][Train](6000/10000) average neg_loss: 0.7323936772346497
[proc 1][Train](6000/10000) average loss: 0.7044428870081901
[proc 1][Train](6000/10000) average regularization: 0.0001302685124683194
[proc 1] 6000 steps, total: 11.160, sample: 2.156, forward: 3.456, backward: 2.731, update: 2.719
[proc 2][Train](6000/10000) average pos_loss: 0.6769379715919495
[proc 2][Train](6000/10000) average neg_loss: 0.7313747685551644
[proc 2][Train](6000/10000) average loss: 0.7041563709974289
[proc 2][Train](6000/10000) average regularization: 0.00013027610047720373
[proc 2] 6000 steps, total: 11.159, sample: 2.359, forward: 3.356, backward: 2.704, update: 2.594
[proc 0][Train](7000/10000) average pos_loss: 0.6737342341542244
[proc 0][Train](7000/10000) average neg_loss: 0.7274561863541603
[proc 0][Train](7000/10000) average loss: 0.7005952098369599
[proc 0][Train](7000/10000) average regularization: 0.0001339001411688514
[proc 0] 7000 steps, total: 10.858, sample: 2.165, forward: 3.426, backward: 2.695, update: 2.566
[proc 1][Train](7000/10000) average pos_loss: 0.6726721044182777
[proc 1][Train](7000/10000) average neg_loss: 0.7274592584371566
[proc 1][Train](7000/10000) average loss: 0.7000656800866127
[proc 1][Train](7000/10000) average regularization: 0.00013379757007351146
[proc 1] 7000 steps, total: 10.858, sample: 2.197, forward: 3.336, backward: 2.739, update: 2.578
[proc 2][Train](7000/10000) average pos_loss: 0.6728286885619164
[proc 2][Train](7000/10000) average neg_loss: 0.7268355781435967
[proc 2][Train](7000/10000) average loss: 0.6998321342468262
[proc 2][Train](7000/10000) average regularization: 0.0001338328450510744
[proc 2] 7000 steps, total: 10.858, sample: 2.119, forward: 3.202, backward: 2.676, update: 2.453
[proc 1][Train](8000/10000) average pos_loss: 0.6695315272212029
[proc 1][Train](8000/10000) average neg_loss: 0.7229508662223816
[proc 1][Train](8000/10000) average loss: 0.6962411968111992
[proc 1][Train](8000/10000) average regularization: 0.00013680077707977034
[proc 1] 8000 steps, total: 11.079, sample: 2.204, forward: 3.324, backward: 2.907, update: 2.639
[proc 0][Train](8000/10000) average pos_loss: 0.6702850675582885
[proc 0][Train](8000/10000) average neg_loss: 0.7228060201406479
[proc 0][Train](8000/10000) average loss: 0.6965455448627472
[proc 0][Train](8000/10000) average regularization: 0.0001367184013070073
[proc 0] 8000 steps, total: 11.080, sample: 2.180, forward: 3.447, backward: 2.718, update: 2.707
[proc 2][Train](8000/10000) average pos_loss: 0.6704354170560837
[proc 2][Train](8000/10000) average neg_loss: 0.7231434429883957
[proc 2][Train](8000/10000) average loss: 0.6967894304990768
[proc 2][Train](8000/10000) average regularization: 0.00013675387704279273
[proc 2] 8000 steps, total: 11.079, sample: 2.259, forward: 3.323, backward: 2.727, update: 2.504
[proc 1][Train](9000/10000) average pos_loss: 0.6672459500432014
[proc 1][Train](9000/10000) average neg_loss: 0.7194859945774078
[proc 1][Train](9000/10000) average loss: 0.6933659736514092
[proc 1][Train](9000/10000) average regularization: 0.0001392744357144693
[proc 1] 9000 steps, total: 11.184, sample: 2.169, forward: 3.399, backward: 3.069, update: 2.540
[proc 2][Train](9000/10000) average pos_loss: 0.6680766429901123
[proc 2][Train](9000/10000) average neg_loss: 0.7188611860871315
[proc 2][Train](9000/10000) average loss: 0.6934689142107964
[proc 2][Train](9000/10000) average regularization: 0.0001392621031991439
[proc 2] 9000 steps, total: 11.184, sample: 2.149, forward: 3.114, backward: 2.654, update: 2.373
[proc 0][Train](9000/10000) average pos_loss: 0.6665649877786637
[proc 0][Train](9000/10000) average neg_loss: 0.7189499515295029
[proc 0][Train](9000/10000) average loss: 0.6927574691772461
[proc 0][Train](9000/10000) average regularization: 0.00013933435578655917
[proc 0] 9000 steps, total: 11.185, sample: 2.319, forward: 3.432, backward: 2.706, update: 2.591
[proc 1][Train](10000/10000) average pos_loss: 0.6642808709740639
[proc 1][Train](10000/10000) average neg_loss: 0.7152336375117302
[proc 1][Train](10000/10000) average loss: 0.6897572534680366
[proc 1][Train](10000/10000) average regularization: 0.0001413865337817697
[proc 1] 10000 steps, total: 11.080, sample: 2.216, forward: 3.450, backward: 2.716, update: 2.632
proc 1 takes 136.240 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.664590152323246
[proc 0][Train](10000/10000) average neg_loss: 0.7149197601079941
[proc 0][Train](10000/10000) average loss: 0.6897549557685853
[proc 0][Train](10000/10000) average regularization: 0.00014145085898053367
[proc 0] 10000 steps, total: 11.079, sample: 2.182, forward: 3.506, backward: 2.693, update: 2.691
proc 0 takes 136.777 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.66376929551363
[proc 2][Train](10000/10000) average neg_loss: 0.7148742712140084
[proc 2][Train](10000/10000) average loss: 0.6893217840790749
[proc 2][Train](10000/10000) average regularization: 0.00014140106839477084
[proc 2] 10000 steps, total: 11.079, sample: 2.148, forward: 3.431, backward: 2.715, update: 2.454
proc 2 takes 135.662 seconds
Successfully xmh. training takes 141.53515219688416 seconds
