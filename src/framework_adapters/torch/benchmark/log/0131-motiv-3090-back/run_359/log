WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240201 11:22:06.869726 25680 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240201 11:22:06.879158 25680 IPCTensor.h:369] NewIPCTensor: full_emb [100000000, 32]0x100000002000 11.92 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [25680 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f1fa813d9e0>==========
Worker 1 pid=25842
Worker 2 pid=25843
Worker 3 pid=25844
Worker 4 pid=25845
Worker 5 pid=25846
Worker 6 pid=25847
INFO [25680 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [25842 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [25843 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [25844 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [25845 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [25846 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [25847 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [25848 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [25846 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25845 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25848 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25844 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25847 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240201 11:22:56.115856 25846 IPCTensor.h:348] IPCTensor full_emb already exists
E20240201 11:22:56.115864 25847 IPCTensor.h:348] IPCTensor full_emb already exists
E20240201 11:22:56.115864 25844 IPCTensor.h:348] IPCTensor full_emb already exists
E20240201 11:22:56.116003 25848 IPCTensor.h:348] IPCTensor full_emb already exists
E20240201 11:22:56.116003 25845 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [25842 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25843 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240201 11:22:56.119663 25842 IPCTensor.h:348] IPCTensor full_emb already exists
E20240201 11:22:56.119700 25843 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [25680 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240201 11:22:56.121171 25680 IPCTensor.h:348] IPCTensor full_emb already exists
W20240201 11:23:51.105502 25847 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [10000000, 32]; dev=6; size=1.192 GB
W20240201 11:23:51.106711 25845 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [10000000, 32]; dev=4; size=1.192 GB
W20240201 11:23:51.106712 25846 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [10000000, 32]; dev=5; size=1.192 GB
W20240201 11:23:51.108544 25680 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [10000000, 32]; dev=0; size=1.192 GB
W20240201 11:23:51.108994 25843 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [10000000, 32]; dev=2; size=1.192 GB
W20240201 11:23:51.113029 25844 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [10000000, 32]; dev=3; size=1.192 GB
W20240201 11:23:51.113041 25848 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [10000000, 32]; dev=7; size=1.192 GB
W20240201 11:23:51.113041 25842 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [10000000, 32]; dev=1; size=1.192 GB
W20240201 11:23:51.897243 25847 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1002faf0e000 7.629 MB
W20240201 11:23:51.897435 25847 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1002fb6b1000 7.629 MB
W20240201 11:23:51.897485 25847 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x1002fbe54000 122.1 MB
W20240201 11:23:51.897531 25847 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100303868000 122.1 MB
W20240201 11:23:51.897579 25847 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240201 11:23:51.912169 25847 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240201 11:23:51.915022 25846 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10030b282000 7.629 MB
W20240201 11:23:51.915216 25846 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10030ba25000 7.629 MB
W20240201 11:23:51.915277 25846 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10030c1c8000 122.1 MB
W20240201 11:23:51.915333 25846 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100313bdc000 122.1 MB
W20240201 11:23:51.915377 25846 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240201 11:23:51.917802 25846 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240201 11:23:51.925401 25845 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10031b5f8000 7.629 MB
W20240201 11:23:51.925479 25842 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10031bd9b000 7.629 MB
W20240201 11:23:51.925582 25845 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10031c53e000 7.629 MB
W20240201 11:23:51.925665 25845 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10031cce1000 122.1 MB
W20240201 11:23:51.925704 25842 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003246f5000 7.629 MB
W20240201 11:23:51.925725 25845 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100324e98000 122.1 MB
W20240201 11:23:51.925792 25845 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240201 11:23:51.925797 25842 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10032c8ac000 122.1 MB
W20240201 11:23:51.925849 25842 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1003342c0000 122.1 MB
W20240201 11:23:51.925897 25842 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240201 11:23:51.928534 25845 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240201 11:23:51.932768 25842 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240201 11:23:51.939512 25844 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10033bcde000 7.629 MB
W20240201 11:23:51.940027 25844 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10033c481000 7.629 MB
W20240201 11:23:51.940153 25844 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10033cc24000 122.1 MB
W20240201 11:23:51.940207 25844 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100344638000 122.1 MB
W20240201 11:23:51.940378 25844 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240201 11:23:51.940924 25844 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240201 11:23:51.951372 25848 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10034c054000 7.629 MB
W20240201 11:23:51.951489 25848 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10034c7f7000 7.629 MB
W20240201 11:23:51.951535 25848 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10034cf9a000 122.1 MB
W20240201 11:23:51.951584 25848 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1003549ae000 122.1 MB
W20240201 11:23:51.951625 25848 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240201 11:23:51.951813 25680 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10035c3c2000 7.629 MB
W20240201 11:23:51.951997 25848 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240201 11:23:51.952008 25680 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10035cb67000 7.629 MB
W20240201 11:23:51.952082 25680 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10035d30a000 122.1 MB
W20240201 11:23:51.952132 25680 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100364d1e000 122.1 MB
W20240201 11:23:51.952167 25680 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240201 11:23:51.952586 25680 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240201 11:23:51.966751 25843 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10036c73a000 7.629 MB
W20240201 11:23:51.966979 25843 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10036cedd000 7.629 MB
W20240201 11:23:51.967099 25843 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10036d680000 122.1 MB
W20240201 11:23:51.967206 25843 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100375094000 122.1 MB
W20240201 11:23:51.967312 25843 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240201 11:23:51.968148 25843 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 7 pid=25848
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 10000000), (10000000, 20000000), (20000000, 30000000), (30000000, 40000000), (40000000, 50000000), (50000000, 60000000), (60000000, 70000000), (70000000, 80000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240201 11:23:56.044974 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10037caac000 7.629 MB
W20240201 11:23:56.045038 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10037d9f2000 7.629 MB
W20240201 11:23:56.045032 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10037d24f000 7.629 MB
W20240201 11:23:56.045065 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10037e195000 7.629 MB
W20240201 11:23:56.045152 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10037e938000 7.629 MB
W20240201 11:23:56.045233 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10037f0db000 7.629 MB
W20240201 11:23:56.045238 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10037f87e000 7.629 MB
W20240201 11:23:56.045251 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100380021000 7.629 MB
W20240201 11:23:56.045331 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1003807c4000 7.629 MB
W20240201 11:23:56.045336 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100380f67000 7.629 MB
W20240201 11:23:56.045378 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10038170a000 7.629 MB
W20240201 11:23:56.045614 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100383596000 7.629 MB
W20240201 11:23:56.045601 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100382650000 7.629 MB
W20240201 11:23:56.045621 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100383d39000 7.629 MB
W20240201 11:23:56.045607 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x100382df3000 7.629 MB
W20240201 11:23:56.045692 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1003844dc000 7.629 MB
W20240201 11:23:56.045734 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100384c7f000 7.629 MB
W20240201 11:23:56.045747 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100385422000 7.629 MB
W20240201 11:23:56.045800 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100386368000 7.629 MB
W20240201 11:23:56.045598 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100381ead000 7.629 MB
W20240201 11:23:56.045831 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100386b0b000 7.629 MB
W20240201 11:23:56.045836 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1003872ae000 7.629 MB
W20240201 11:23:56.045817 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100385bc5000 7.629 MB
W20240201 11:23:56.045851 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100387a51000 7.629 MB
W20240201 11:23:56.045871 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1003881f4000 7.629 MB
W20240201 11:23:56.045903 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100388997000 7.629 MB
W20240201 11:23:56.045908 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10038913a000 7.629 MB
W20240201 11:23:56.045914 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1003898dd000 7.629 MB
W20240201 11:23:56.045956 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10038a080000 7.629 MB
W20240201 11:23:56.045961 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10038a823000 7.629 MB
W20240201 11:23:56.045991 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10038afc6000 7.629 MB
W20240201 11:23:56.046008 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10038b769000 7.629 MB
W20240201 11:23:56.046010 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10038bf0c000 7.629 MB
W20240201 11:23:56.046027 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10038c6af000 7.629 MB
W20240201 11:23:56.046032 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10038ce52000 7.629 MB
W20240201 11:23:56.046048 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10038d5f5000 7.629 MB
W20240201 11:23:56.046068 25847 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10038dd98000 7.629 MB
W20240201 11:23:56.046070 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10038e53b000 7.629 MB
W20240201 11:23:56.046092 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10038ecde000 7.629 MB
W20240201 11:23:56.046119 25846 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10038fc24000 7.629 MB
W20240201 11:23:56.046121 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1003903c7000 7.629 MB
W20240201 11:23:56.046139 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x100390b6a000 7.629 MB
W20240201 11:23:56.046115 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10038f481000 7.629 MB
W20240201 11:23:56.046156 25847 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x10039130d000 80 B 
W20240201 11:23:56.046173 25846 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10039130f000 80 B 
W20240201 11:23:56.046176 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100391311000 7.629 MB
W20240201 11:23:56.046196 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100391ab4000 7.629 MB
W20240201 11:23:56.046203 25847 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x100392257000 8 B 
W20240201 11:23:56.046208 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100392259000 7.629 MB
W20240201 11:23:56.046222 25846 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10039319f000 8 B 
W20240201 11:23:56.046224 25680 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1003931a1000 7.629 MB
W20240201 11:23:56.046222 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1003929fc000 7.629 MB
W20240201 11:23:56.046252 25848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100393944000 7.629 MB
W20240201 11:23:56.046269 25847 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1003940e7000 8 B 
W20240201 11:23:56.046283 25680 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1003940e9000 80 B 
W20240201 11:23:56.046284 25846 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1003940eb000 8 B 
W20240201 11:23:56.046298 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1003940ed000 7.629 MB
W20240201 11:23:56.046314 25848 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x100394890000 80 B 
W20240201 11:23:56.046321 25680 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100394892000 8 B 
W20240201 11:23:56.046334 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100394894000 7.629 MB
W20240201 11:23:56.046358 25848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100395037000 8 B 
W20240201 11:23:56.046360 25680 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100395039000 8 B 
W20240201 11:23:56.046367 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10039503b000 7.629 MB
W20240201 11:23:56.046373 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1003957de000 7.629 MB
W20240201 11:23:56.046384 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100395f81000 7.629 MB
W20240201 11:23:56.046417 25848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100396724000 8 B 
W20240201 11:23:56.046442 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100396726000 7.629 MB
W20240201 11:23:56.046448 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x100396ec9000 7.629 MB
W20240201 11:23:56.046465 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10039766c000 7.629 MB
W20240201 11:23:56.046470 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100397e0f000 7.629 MB
W20240201 11:23:56.046510 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1003985b2000 7.629 MB
W20240201 11:23:56.046522 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100398d55000 7.629 MB
W20240201 11:23:56.046550 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1003994f8000 7.629 MB
W20240201 11:23:56.046554 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100399c9b000 7.629 MB
W20240201 11:23:56.046581 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10039a43e000 7.629 MB
W20240201 11:23:56.046620 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10039abe1000 7.629 MB
W20240201 11:23:56.046641 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10039b384000 7.629 MB
W20240201 11:23:56.046649 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10039bb27000 7.629 MB
W20240201 11:23:56.046687 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10039c2ca000 7.629 MB
W20240201 11:23:56.046713 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10039ca6d000 7.629 MB
W20240201 11:23:56.046736 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10039d210000 7.629 MB
W20240201 11:23:56.046741 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10039d9b3000 7.629 MB
W20240201 11:23:56.046789 25843 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10039e156000 7.629 MB
W20240201 11:23:56.046806 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10039e8f9000 7.629 MB
W20240201 11:23:56.046819 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10039f09c000 7.629 MB
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
W20240201 11:23:56.046875 25844 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10039ffe2000 7.629 MB
W20240201 11:23:56.046871 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10039f83f000 7.629 MB
W20240201 11:23:56.046881 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1003a0785000 7.629 MB
Construct PerfSampler done
W20240201 11:23:56.046923 25843 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1003a0f28000 80 B 
W20240201 11:23:56.046960 25845 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1003a0f2a000 7.629 MB
W20240201 11:23:56.046977 25844 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1003a16cd000 80 B 
W20240201 11:23:56.046994 25843 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1003a16cf000 8 B 
W20240201 11:23:56.047024 25845 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1003a16d1000 80 B 
W20240201 11:23:56.047029 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1003a16d3000 7.629 MB
W20240201 11:23:56.047036 25844 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1003a1e76000 8 B 
W20240201 11:23:56.047058 25843 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003a1e78000 8 B 
W20240201 11:23:56.047066 25845 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1003a1e7a000 8 B 
W20240201 11:23:56.047091 25844 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003a1e7c000 8 B 
I20240201 11:23:56.047099 25846 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240201 11:23:56.047106 25845 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1003a1e7e000 8 B 
I20240201 11:23:56.047116 25847 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240201 11:23:56.047112 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1003a1e80000 7.629 MB
I20240201 11:23:56.047132 25680 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240201 11:23:56.047153 25848 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240201 11:23:56.047201 25842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1003a2623000 7.629 MB
W20240201 11:23:56.047312 25842 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1003a2dc6000 80 B 
W20240201 11:23:56.047385 25842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1003a2dc8000 8 B 
W20240201 11:23:56.047446 25842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1003a2dca000 8 B 
Construct PerfSampler done
Construct PerfSampler done
I20240201 11:23:56.047744 25845 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240201 11:23:56.047763 25844 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
Construct PerfSampler done
I20240201 11:23:56.048017 25842 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240201 11:23:56.048041 25843 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240201 11:23:56.049127 25680 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240201 11:23:56.049280 25680 grad_base.h:184] Init GradProcessingBase done
I20240201 11:24:08.206605 25680 grad_async_v2.h:42] Use main thread to update emb.
W20240201 11:24:08.207022 25680 kg_controller.h:78] after init GradAsyncProcessingV2
I20240201 11:24:08.207036 25680 kg_controller.h:84] Construct KGCacheController done
E20240201 11:24:09.009615 25680 recstore.cc:66] init folly done
E20240201 11:24:09.009650 25845 recstore.cc:66] init folly done
E20240201 11:24:09.009660 25846 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240201 11:24:09.009783 25844 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240201 11:24:09.010192 25847 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240201 11:24:09.010470 25848 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240201 11:24:09.012115 25843 recstore.cc:66] init folly done
E20240201 11:24:09.012146 25842 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240201 11:24:09.013430 25680 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240201 11:24:11.162869 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240201 11:24:11.163162 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240201 11:24:12.163022 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240201 11:24:12.173236 26609 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
Before Training
I20240201 11:24:12.500811 25844 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.577322 25848 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.630187 25843 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.665660 25846 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.683864 25847 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.700722 25680 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.718353 25842 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240201 11:24:12.735723 25845 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.428 us                | 311.924 us                |
| ProcessBack:Shuffle       | 345.693 ms                | 345.693 ms                |
+---------------------------+---------------------------+---------------------------+
E20240201 11:24:14.361326 26707 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240201 11:24:14.397723 25680 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=0
========== Step 1 ========== 
W20240201 11:24:14.458202 26609 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240201 11:24:14.747804 25680 grad_async_v2.h:257] pq is empty
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
W20240201 11:24:14.998243 25680 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
W20240201 11:24:15.181964 25680 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240201 11:24:15.368147 26612 parallel_pq_v2.h:79] insert failed, size(hashtable)=11585
W20240201 11:24:15.459836 25680 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240201 11:24:15.460405 26609 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 5 ========== 
W20240201 11:24:15.724678 25680 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240201 11:24:16.010641 25680 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.165 us                | 408.651 us                |
| GenInput                  | 1.276 ms                  | 11.124 ms                 |
| Forward                   | 353.402 us                | 57.543 ms                 |
| Backward                  | 798.523 us                | 27.595 ms                 |
| Optimize                  | 170.217 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 762.158 us                | 18.819 ms                 |
| AfterBackward             | 271.814 ms                | 1.549 s                   |
| BlockToStepN              | 118.019 us                | 59.090 ms                 |
| OneStep                   | 277.864 ms                | 1.721 s                   |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:16.263751 25680 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240201 11:24:16.367249 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240201 11:24:16.519589 25680 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240201 11:24:16.520169 26609 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 9 ========== 
W20240201 11:24:16.770144 25680 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240201 11:24:17.066615 25680 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240201 11:24:17.266397 25680 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240201 11:24:17.367017 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=6277
W20240201 11:24:17.520041 25680 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240201 11:24:17.521346 26609 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240201 11:24:17.833528 25680 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240201 11:24:18.107692 25680 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
W20240201 11:24:18.400868 25680 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240201 11:24:18.401358 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240201 11:24:18.525312 26609 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240201 11:24:18.678680 25680 grad_async_v2.h:257] pq is empty
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240201 11:24:18.946029 25680 grad_async_v2.h:257] pq is empty
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 177.382 us                | 37.787 ms                 |
| ProcessBack:Shuffle       | 248.475 ms                | 345.693 ms                |
| ProcessBack:UpdateCache   | 8.252 ms                  | 1.155 s                   |
| ProcessBack:UpsertPq      | 57.808 us                 | 36.622 ms                 |
| ProcessOneStep            | 261.251 ms                | 1.549 s                   |
| BlockToStepN              | 74.044 us                 | 58.782 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:19.190474 25680 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240201 11:24:19.447129 25680 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240201 11:24:19.448005 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 20 ========== 
W20240201 11:24:19.530478 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240201 11:24:19.714926 25680 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240201 11:24:19.969332 25680 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240201 11:24:20.222501 25680 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240201 11:24:20.467660 25680 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240201 11:24:20.468155 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 24 ========== 
W20240201 11:24:20.537638 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:24:20.712517 25680 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
W20240201 11:24:20.985669 25680 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.165 us                | 1.375 ms                  |
| GenInput                  | 1.664 ms                  | 20.846 ms                 |
| Forward                   | 374.719 us                | 57.543 ms                 |
| Backward                  | 714.960 us                | 27.595 ms                 |
| Optimize                  | 128.538 us                | 842.048 us                |
| BarrierTimeBeforeRank0    | 1.792 ms                  | 18.819 ms                 |
| AfterBackward             | 249.748 ms                | 1.549 s                   |
| BlockToStepN              | 135.290 us                | 59.090 ms                 |
| OneStep                   | 256.666 ms                | 1.721 s                   |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:21.238688 25680 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240201 11:24:21.477671 25680 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240201 11:24:21.478314 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 28 ========== 
W20240201 11:24:21.547725 26609 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240201 11:24:21.730953 25680 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240201 11:24:21.987623 25680 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240201 11:24:22.236606 25680 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240201 11:24:22.491191 25680 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
E20240201 11:24:22.491969 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 32 ========== 
W20240201 11:24:22.557173 26609 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240201 11:24:22.707891 25680 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240201 11:24:22.987890 25680 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240201 11:24:23.235621 25680 grad_async_v2.h:257] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240201 11:24:23.492843 26619 parallel_pq_v2.h:79] insert failed, size(hashtable)=11190
W20240201 11:24:23.497340 25680 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240201 11:24:23.560006 26609 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240201 11:24:23.756898 25680 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 158.651 us                | 39.424 ms                 |
| ProcessBack:Shuffle       | 239.669 ms                | 345.693 ms                |
| ProcessBack:UpdateCache   | 8.899 ms                  | 1.155 s                   |
| ProcessBack:UpsertPq      | 60.919 us                 | 36.622 ms                 |
| ProcessOneStep            | 249.539 ms                | 1.549 s                   |
| BlockToStepN              | 85.005 us                 | 58.782 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:24.043494 25680 grad_async_v2.h:257] pq is empty
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
W20240201 11:24:24.280665 25680 grad_async_v2.h:257] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
E20240201 11:24:24.492169 26620 parallel_pq_v2.h:79] insert failed, size(hashtable)=6975
W20240201 11:24:24.567967 25680 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240201 11:24:24.568503 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240201 11:24:24.847251 25680 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
W20240201 11:24:25.299449 25680 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240201 11:24:25.492008 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=9973
W20240201 11:24:25.567356 25680 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240201 11:24:25.586052 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:24:25.843281 25680 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 126.781 us                | 1.391 ms                  |
| GenInput                  | 1.779 ms                  | 20.846 ms                 |
| Forward                   | 374.719 us                | 57.543 ms                 |
| Backward                  | 705.673 us                | 27.595 ms                 |
| Optimize                  | 114.418 us                | 842.048 us                |
| BarrierTimeBeforeRank0    | 1.792 ms                  | 18.819 ms                 |
| AfterBackward             | 251.940 ms                | 1.549 s                   |
| BlockToStepN              | 151.565 us                | 59.090 ms                 |
| OneStep                   | 256.668 ms                | 1.721 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240201 11:24:26.332489 25680 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240201 11:24:26.492012 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=9404
W20240201 11:24:26.578619 25680 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240201 11:24:26.597272 26609 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240201 11:24:26.804960 25680 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240201 11:24:27.065949 25680 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240201 11:24:27.338621 25680 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240201 11:24:27.492004 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=7792
W20240201 11:24:27.603919 25680 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240201 11:24:27.604614 26609 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 52 ========== 
W20240201 11:24:27.803547 25680 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240201 11:24:28.075330 25680 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240201 11:24:28.341970 25680 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240201 11:24:28.492023 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=6068
W20240201 11:24:28.619567 25680 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240201 11:24:28.620254 26609 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 56 ========== 
========== Step 56 ========== 
W20240201 11:24:28.868458 25680 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 197.945 us                | 43.650 ms                 |
| ProcessBack:Shuffle       | 241.113 ms                | 276.528 ms                |
| ProcessBack:UpdateCache   | 8.899 ms                  | 23.096 ms                 |
| ProcessBack:UpsertPq      | 58.106 us                 | 134.762 us                |
| ProcessOneStep            | 251.462 ms                | 288.624 ms                |
| BlockToStepN              | 97.560 us                 | 485.157 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:29.126065 25680 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240201 11:24:29.354708 25680 grad_async_v2.h:257] pq is empty
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240201 11:24:29.496130 26629 parallel_pq_v2.h:79] insert failed, size(hashtable)=10291
W20240201 11:24:29.569396 25680 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
W20240201 11:24:29.624416 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240201 11:24:29.954545 25680 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240201 11:24:30.201393 25680 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240201 11:24:30.430630 25680 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
E20240201 11:24:30.496019 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=4455
W20240201 11:24:30.666359 25680 grad_async_v2.h:257] pq is empty
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240201 11:24:30.667659 26609 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240201 11:24:30.958817 25680 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.809 us                | 1.391 ms                  |
| GenInput                  | 1.945 ms                  | 19.678 ms                 |
| Forward                   | 380.805 us                | 2.675 ms                  |
| Backward                  | 684.156 us                | 2.771 ms                  |
| Optimize                  | 114.418 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.653 ms                  | 8.986 ms                  |
| AfterBackward             | 249.062 ms                | 288.648 ms                |
| BlockToStepN              | 165.697 us                | 604.127 us                |
| OneStep                   | 255.850 ms                | 313.474 ms                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:31.190965 25680 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240201 11:24:31.425555 25680 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
E20240201 11:24:31.496009 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=2006
W20240201 11:24:31.686689 25680 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240201 11:24:31.687186 26609 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240201 11:24:31.892748 25680 grad_async_v2.h:257] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
E20240201 11:24:32.496016 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=261
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240201 11:24:32.707572 26609 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240201 11:24:32.803045 25680 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240201 11:24:33.042862 25680 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240201 11:24:33.262651 25680 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240201 11:24:33.508204 26630 parallel_pq_v2.h:79] insert failed, size(hashtable)=9548
W20240201 11:24:33.519163 25680 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
W20240201 11:24:33.735641 26609 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240201 11:24:33.782744 25680 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 175.866 us                | 35.905 ms                 |
| ProcessBack:Shuffle       | 238.303 ms                | 276.528 ms                |
| ProcessBack:UpdateCache   | 8.899 ms                  | 23.096 ms                 |
| ProcessBack:UpsertPq      | 60.919 us                 | 134.762 us                |
| ProcessOneStep            | 248.728 ms                | 288.624 ms                |
| BlockToStepN              | 112.141 us                | 485.157 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:34.015556 25680 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240201 11:24:34.443194 25680 grad_async_v2.h:257] pq is empty
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
E20240201 11:24:34.508013 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=4758
W20240201 11:24:34.594846 25680 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240201 11:24:34.736312 26609 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240201 11:24:34.827832 25680 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240201 11:24:35.059561 25680 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
W20240201 11:24:35.281204 25680 grad_async_v2.h:257] pq is empty
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240201 11:24:35.500039 25680 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240201 11:24:35.508185 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 86 ========== 
W20240201 11:24:35.731441 25680 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240201 11:24:35.754110 26609 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240201 11:24:36.018757 25680 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 125.151 us                | 1.572 ms                  |
| GenInput                  | 1.958 ms                  | 19.678 ms                 |
| Forward                   | 380.805 us                | 2.675 ms                  |
| Backward                  | 676.593 us                | 2.771 ms                  |
| Optimize                  | 110.564 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.518 ms                  | 14.819 ms                 |
| AfterBackward             | 246.917 ms                | 288.648 ms                |
| BlockToStepN              | 198.183 us                | 604.127 us                |
| OneStep                   | 253.272 ms                | 313.474 ms                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:36.290876 25680 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240201 11:24:36.475001 25680 grad_async_v2.h:257] pq is empty
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240201 11:24:36.508040 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=963
W20240201 11:24:36.738672 25680 grad_async_v2.h:257] pq is empty
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
W20240201 11:24:36.760663 26609 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240201 11:24:37.023423 25680 grad_async_v2.h:257] pq is empty
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240201 11:24:37.287591 25680 grad_async_v2.h:257] pq is empty
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240201 11:24:37.512408 25680 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
E20240201 11:24:37.513011 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 94 ========== 
W20240201 11:24:37.742502 25680 grad_async_v2.h:257] pq is empty
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240201 11:24:37.801275 26609 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240201 11:24:38.024307 25680 grad_async_v2.h:257] pq is empty
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240201 11:24:38.408762 25680 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
E20240201 11:24:38.513017 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=427
W20240201 11:24:38.649359 25680 grad_async_v2.h:257] pq is empty
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
W20240201 11:24:38.870558 25680 grad_async_v2.h:257] pq is empty
Step99:rank7, time: 42.826, per_step: 0.428260
Step99:rank1, time: 42.826, per_step: 0.428260
Step99:rank5, time: 42.826, per_step: 0.428262
========== Step 100 ========== 
Step99:rank0, time: 42.826, per_step: 0.428262
========== Step 100 ========== 
Step99:rank6, time: 42.826, per_step: 0.428264
Step99:rank2, time: 42.827, per_step: 0.428266
Step99:rank4, time: 42.827, per_step: 0.428266
Step99:rank3, time: 42.826, per_step: 0.428265
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240201 11:24:38.871608 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 213.484 us                | 36.515 ms                 |
| ProcessBack:Shuffle       | 236.516 ms                | 276.528 ms                |
| ProcessBack:UpdateCache   | 8.766 ms                  | 23.129 ms                 |
| ProcessBack:UpsertPq      | 61.534 us                 | 134.762 us                |
| ProcessOneStep            | 246.884 ms                | 288.624 ms                |
| BlockToStepN              | 127.251 us                | 684.538 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240201 11:24:39.346851 25680 grad_async_v2.h:257] pq is empty
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240201 11:24:39.516572 26623 parallel_pq_v2.h:79] insert failed, size(hashtable)=6868
W20240201 11:24:39.575645 25680 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240201 11:24:39.808758 25680 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240201 11:24:39.877033 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:24:40.038493 25680 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240201 11:24:40.307083 25680 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240201 11:24:40.555817 25680 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
E20240201 11:24:40.556377 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 107 ========== 
W20240201 11:24:40.773345 25680 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240201 11:24:40.878999 26609 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240201 11:24:41.003532 25680 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 120.195 us                | 1.572 ms                  |
| GenInput                  | 1.779 ms                  | 19.678 ms                 |
| Forward                   | 353.402 us                | 2.675 ms                  |
| Backward                  | 672.143 us                | 8.004 ms                  |
| Optimize                  | 108.885 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.264 ms                  | 14.819 ms                 |
| AfterBackward             | 245.943 ms                | 288.648 ms                |
| BlockToStepN              | 207.524 us                | 820.256 us                |
| OneStep                   | 253.072 ms                | 313.474 ms                |
| E2E-100                   | 26.171 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:41.231860 25680 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240201 11:24:41.515770 25680 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
E20240201 11:24:41.556509 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1001
W20240201 11:24:41.757810 25680 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240201 11:24:41.879371 26609 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240201 11:24:42.011580 25680 grad_async_v2.h:257] pq is empty
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240201 11:24:42.264663 25680 grad_async_v2.h:257] pq is empty
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240201 11:24:42.496714 25680 grad_async_v2.h:257] pq is empty
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240201 11:24:42.556015 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=904
W20240201 11:24:42.719946 25680 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240201 11:24:42.955112 25680 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
W20240201 11:24:42.955699 26609 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 117 ========== 
W20240201 11:24:43.180474 25680 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240201 11:24:43.408797 25680 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240201 11:24:43.622123 25680 grad_async_v2.h:257] pq is empty
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240201 11:24:43.623013 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 120 ========== 
========== Step 120 ========== 
W20240201 11:24:43.880754 25680 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240201 11:24:43.956610 26609 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 191.304 us                | 35.755 ms                 |
| ProcessBack:Shuffle       | 233.392 ms                | 276.528 ms                |
| ProcessBack:UpdateCache   | 7.618 ms                  | 23.129 ms                 |
| ProcessBack:UpsertPq      | 62.166 us                 | 134.762 us                |
| ProcessOneStep            | 244.371 ms                | 288.624 ms                |
| BlockToStepN              | 140.601 us                | 684.538 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:44.134459 25680 grad_async_v2.h:257] pq is empty
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
W20240201 11:24:44.671698 25680 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
E20240201 11:24:44.672544 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240201 11:24:44.978014 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240201 11:24:45.300524 25680 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240201 11:24:45.536128 25680 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
E20240201 11:24:45.684171 26635 parallel_pq_v2.h:79] insert failed, size(hashtable)=7693
W20240201 11:24:45.763546 25680 grad_async_v2.h:257] pq is empty
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240201 11:24:46.017827 25680 grad_async_v2.h:257] pq is empty
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240201 11:24:46.018509 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 130 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 124.204 us                | 1.572 ms                  |
| GenInput                  | 1.799 ms                  | 20.098 ms                 |
| Forward                   | 353.979 us                | 5.664 ms                  |
| Backward                  | 680.682 us                | 8.004 ms                  |
| Optimize                  | 110.598 us                | 842.048 us                |
| BarrierTimeBeforeRank0    | 1.220 ms                  | 14.819 ms                 |
| AfterBackward             | 242.472 ms                | 288.648 ms                |
| BlockToStepN              | 220.542 us                | 820.256 us                |
| OneStep                   | 250.446 ms                | 313.474 ms                |
| E2E-100                   | 26.171 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:46.220674 25680 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240201 11:24:46.430980 25680 grad_async_v2.h:257] pq is empty
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240201 11:24:46.713963 25680 grad_async_v2.h:257] pq is empty
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
E20240201 11:24:46.714795 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 133 ========== 
========== Step 133 ========== 
W20240201 11:24:46.922570 25680 grad_async_v2.h:257] pq is empty
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240201 11:24:47.028214 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:24:47.200357 25680 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240201 11:24:47.441466 25680 grad_async_v2.h:257] pq is empty
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240201 11:24:47.692255 25680 grad_async_v2.h:257] pq is empty
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240201 11:24:47.714037 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=722
W20240201 11:24:47.941644 25680 grad_async_v2.h:257] pq is empty
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240201 11:24:48.030581 26609 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240201 11:24:48.139122 25680 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240201 11:24:48.589948 25680 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
E20240201 11:24:48.716166 26627 parallel_pq_v2.h:79] insert failed, size(hashtable)=2561
W20240201 11:24:48.847726 25680 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 200.437 us                | 43.315 ms                 |
| ProcessBack:Shuffle       | 231.777 ms                | 276.528 ms                |
| ProcessBack:UpdateCache   | 7.413 ms                  | 23.129 ms                 |
| ProcessBack:UpsertPq      | 62.296 us                 | 134.762 us                |
| ProcessOneStep            | 241.336 ms                | 288.624 ms                |
| BlockToStepN              | 154.500 us                | 899.392 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:49.073659 25680 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240201 11:24:49.074442 26609 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 143 ========== 
W20240201 11:24:49.335142 25680 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
W20240201 11:24:49.570703 25680 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
E20240201 11:24:49.716087 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240201 11:24:49.843093 25680 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240201 11:24:50.117365 25680 grad_async_v2.h:257] pq is empty
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240201 11:24:50.117884 26609 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 147 ========== 
W20240201 11:24:50.391104 25680 grad_async_v2.h:257] pq is empty
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240201 11:24:50.658366 25680 grad_async_v2.h:257] pq is empty
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
E20240201 11:24:50.716008 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=3547
W20240201 11:24:50.868449 25680 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 124.204 us                | 1.956 ms                  |
| GenInput                  | 1.776 ms                  | 19.678 ms                 |
| Forward                   | 346.319 us                | 2.675 ms                  |
| Backward                  | 695.264 us                | 3.699 ms                  |
| Optimize                  | 110.564 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.105 ms                  | 8.986 ms                  |
| AfterBackward             | 242.472 ms                | 288.648 ms                |
| BlockToStepN              | 233.445 us                | 1.032 ms                  |
| OneStep                   | 250.350 ms                | 313.474 ms                |
| E2E-100                   | 26.171 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:51.098335 25680 grad_async_v2.h:257] pq is empty
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240201 11:24:51.129388 26609 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240201 11:24:51.327205 25680 grad_async_v2.h:257] pq is empty
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240201 11:24:51.595304 25680 grad_async_v2.h:257] pq is empty
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
E20240201 11:24:51.716017 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1560
W20240201 11:24:51.888078 25680 grad_async_v2.h:257] pq is empty
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
W20240201 11:24:52.177814 25680 grad_async_v2.h:257] pq is empty
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240201 11:24:52.178349 26609 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240201 11:24:52.395452 25680 grad_async_v2.h:257] pq is empty
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240201 11:24:52.593825 25680 grad_async_v2.h:257] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240201 11:24:52.716006 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=7150
W20240201 11:24:52.847599 25680 grad_async_v2.h:257] pq is empty
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240201 11:24:53.046401 25680 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
W20240201 11:24:53.215047 25680 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240201 11:24:53.215449 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 160 ========== 
W20240201 11:24:53.413058 25680 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240201 11:24:53.658604 25680 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240201 11:24:53.716018 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1555
W20240201 11:24:53.902877 25680 grad_async_v2.h:257] pq is empty
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 202.582 us                | 33.766 ms                 |
| ProcessBack:Shuffle       | 231.465 ms                | 269.377 ms                |
| ProcessBack:UpdateCache   | 7.247 ms                  | 23.129 ms                 |
| ProcessBack:UpsertPq      | 63.072 us                 | 112.417 us                |
| ProcessOneStep            | 241.167 ms                | 287.849 ms                |
| BlockToStepN              | 169.208 us                | 722.657 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:54.127553 25680 grad_async_v2.h:257] pq is empty
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240201 11:24:54.223917 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:24:54.419044 25680 grad_async_v2.h:257] pq is empty
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
E20240201 11:24:54.716053 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=742
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240201 11:24:55.309078 25680 grad_async_v2.h:257] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240201 11:24:55.309540 26609 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240201 11:24:55.541623 25680 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240201 11:24:55.736843 25680 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240201 11:24:55.737344 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240201 11:24:56.042171 25680 grad_async_v2.h:257] pq is empty
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.165 us                | 1.956 ms                  |
| GenInput                  | 1.748 ms                  | 19.678 ms                 |
| Forward                   | 341.504 us                | 2.675 ms                  |
| Backward                  | 695.557 us                | 6.429 ms                  |
| Optimize                  | 109.791 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.130 ms                  | 13.193 ms                 |
| AfterBackward             | 238.841 ms                | 288.648 ms                |
| BlockToStepN              | 246.599 us                | 1.032 ms                  |
| OneStep                   | 247.789 ms                | 305.384 ms                |
| E2E-100                   | 26.171 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240201 11:24:56.323791 26609 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240201 11:24:56.512395 25680 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240201 11:24:56.691478 25680 grad_async_v2.h:257] pq is empty
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
E20240201 11:24:56.737007 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=914
W20240201 11:24:56.919942 25680 grad_async_v2.h:257] pq is empty
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240201 11:24:57.175096 25680 grad_async_v2.h:257] pq is empty
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240201 11:24:57.329255 26609 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240201 11:24:57.425474 25680 grad_async_v2.h:257] pq is empty
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240201 11:24:57.695070 25680 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
E20240201 11:24:57.737008 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=938
W20240201 11:24:57.939904 25680 grad_async_v2.h:257] pq is empty
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240201 11:24:58.202841 25680 grad_async_v2.h:257] pq is empty
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
W20240201 11:24:58.356768 26609 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240201 11:24:58.488354 25680 grad_async_v2.h:257] pq is empty
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240201 11:24:58.732937 25680 grad_async_v2.h:257] pq is empty
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240201 11:24:58.737113 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
========== Step 183 ========== 
W20240201 11:24:58.963397 25680 grad_async_v2.h:257] pq is empty
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 207.057 us                | 35.656 ms                 |
| ProcessBack:Shuffle       | 229.867 ms                | 273.584 ms                |
| ProcessBack:UpdateCache   | 7.308 ms                  | 26.292 ms                 |
| ProcessBack:UpsertPq      | 63.459 us                 | 112.417 us                |
| ProcessOneStep            | 238.808 ms                | 288.624 ms                |
| BlockToStepN              | 178.327 us                | 899.392 us                |
+---------------------------+---------------------------+---------------------------+
W20240201 11:24:59.210969 25680 grad_async_v2.h:257] pq is empty
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240201 11:24:59.409762 25680 grad_async_v2.h:257] pq is empty
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240201 11:24:59.410388 26609 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 186 ========== 
W20240201 11:24:59.659489 25680 grad_async_v2.h:257] pq is empty
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240201 11:24:59.737012 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
W20240201 11:24:59.914264 25680 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240201 11:25:00.126473 25680 grad_async_v2.h:257] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240201 11:25:00.355906 25680 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
W20240201 11:25:00.419446 26609 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240201 11:25:00.593369 25680 grad_async_v2.h:257] pq is empty
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240201 11:25:00.792107 25680 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240201 11:25:00.792622 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 192 ========== 
W20240201 11:25:00.979058 25680 grad_async_v2.h:257] pq is empty
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.340 us                | 1.956 ms                  |
| GenInput                  | 1.686 ms                  | 20.098 ms                 |
| Forward                   | 337.052 us                | 2.675 ms                  |
| Backward                  | 694.073 us                | 6.429 ms                  |
| Optimize                  | 109.525 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.096 ms                  | 14.221 ms                 |
| AfterBackward             | 238.029 ms                | 288.648 ms                |
| BlockToStepN              | 256.660 us                | 1.032 ms                  |
| OneStep                   | 247.610 ms                | 305.384 ms                |
| E2E-100                   | 26.171 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
W20240201 11:25:01.230563 25680 grad_async_v2.h:257] pq is empty
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240201 11:25:01.446350 26609 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240201 11:25:01.518978 25680 grad_async_v2.h:257] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240201 11:25:01.724344 25680 grad_async_v2.h:257] pq is empty
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240201 11:25:01.792021 26609 parallel_pq_v2.h:79] insert failed, size(hashtable)=2820
W20240201 11:25:01.950953 25680 grad_async_v2.h:257] pq is empty
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240201 11:25:02.202087 25680 grad_async_v2.h:257] pq is empty
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240201 11:25:02.375201 25680 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
W20240201 11:25:02.468454 26609 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240201 11:25:02.597725 25680 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 23.727, per_step: 0.234917
Step199:rank1, time: 23.727, per_step: 0.234920
Step199:rank4, time: 23.727, per_step: 0.234917
Step199:rank7, time: 23.727, per_step: 0.234921
Step199:rank3, time: 23.727, per_step: 0.234916
Step199:rank5, time: 23.727, per_step: 0.234920
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100timer name is E2E-100

Step199:rank2, time: 23.727, per_step: 0.234920
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
Successfully xmh
Step199:rank6, time: 23.728, per_step: 0.234928
timer name is E2E-100
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 222.758 us                | 39.583 ms                 |
| ProcessBack:Shuffle       | 229.565 ms                | 273.584 ms                |
| ProcessBack:UpdateCache   | 6.982 ms                  | 26.292 ms                 |
| ProcessBack:UpsertPq      | 63.240 us                 | 112.417 us                |
| ProcessOneStep            | 237.129 ms                | 288.624 ms                |
| BlockToStepN              | 186.391 us                | 899.392 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.188 us                | 1.956 ms                  |
| GenInput                  | 1.686 ms                  | 20.098 ms                 |
| Forward                   | 335.706 us                | 2.675 ms                  |
| Backward                  | 686.312 us                | 6.429 ms                  |
| Optimize                  | 109.521 us                | 740.299 us                |
| BarrierTimeBeforeRank0    | 1.105 ms                  | 14.221 ms                 |
| AfterBackward             | 237.154 ms                | 288.648 ms                |
| BlockToStepN              | 263.007 us                | 1.032 ms                  |
| OneStep                   | 247.568 ms                | 305.384 ms                |
| E2E-100                   | 23.726 s                  | 26.171 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [25680 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
