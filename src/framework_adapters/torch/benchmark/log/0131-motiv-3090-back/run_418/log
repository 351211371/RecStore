WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 03:14:32.863864  8259 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240202 03:14:32.873339  8259 IPCTensor.h:369] NewIPCTensor: full_emb [100000000, 32]0x100000002000 11.92 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [8259 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f05f73d19e0>==========
Worker 1 pid=8422
Worker 2 pid=8423
Worker 3 pid=8424
Worker 4 pid=8425
Worker 5 pid=8426
Worker 6 pid=8427
INFO [8259 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [8422 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [8425 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [8423 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [8424 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [8427 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [8426 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [8428 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [8425 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8423 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8428 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8426 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8259 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8422 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8424 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [8427 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240202 03:15:22.392421  8259 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392439  8427 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392462  8424 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392468  8423 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392469  8426 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392464  8422 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392462  8425 IPCTensor.h:348] IPCTensor full_emb already exists
E20240202 03:15:22.392462  8428 IPCTensor.h:348] IPCTensor full_emb already exists
W20240202 03:16:17.635056  8427 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240202 03:16:17.637641  8428 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240202 03:16:17.637786  8422 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240202 03:16:17.641327  8425 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240202 03:16:17.641659  8424 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240202 03:16:17.641717  8426 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240202 03:16:17.641825  8259 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240202 03:16:17.641799  8423 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240202 03:16:18.417414  8422 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1002faf0e000 7.629 MB
W20240202 03:16:18.417614  8422 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1002fb6b1000 7.629 MB
W20240202 03:16:18.417704  8422 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1002fbe54000 122.1 MB
W20240202 03:16:18.417770  8422 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100303868000 122.1 MB
W20240202 03:16:18.417815  8422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240202 03:16:18.428906  8422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240202 03:16:18.442167  8428 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10030b282000 7.629 MB
W20240202 03:16:18.442363  8428 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10030ba25000 7.629 MB
W20240202 03:16:18.442449  8428 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10030c1c8000 122.1 MB
W20240202 03:16:18.442515  8428 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x100313bdc000 122.1 MB
W20240202 03:16:18.442553  8428 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240202 03:16:18.443377  8428 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240202 03:16:18.452826  8423 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10031b5f6000 7.629 MB
W20240202 03:16:18.452967  8423 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10031bd99000 7.629 MB
W20240202 03:16:18.453034  8423 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10031c53c000 122.1 MB
W20240202 03:16:18.453100  8423 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100323f50000 122.1 MB
W20240202 03:16:18.453140  8423 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240202 03:16:18.453765  8423 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240202 03:16:18.455030  8427 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10032b96a000 7.629 MB
W20240202 03:16:18.455178  8427 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10032c10d000 7.629 MB
W20240202 03:16:18.455245  8427 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10032c8b0000 122.1 MB
W20240202 03:16:18.455298  8427 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1003342c4000 122.1 MB
W20240202 03:16:18.455335  8427 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240202 03:16:18.460254  8427 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240202 03:16:18.470588  8424 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10033bcde000 7.629 MB
W20240202 03:16:18.470769  8424 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10033c481000 7.629 MB
W20240202 03:16:18.470846  8424 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10033cc24000 122.1 MB
W20240202 03:16:18.470933  8424 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100344638000 122.1 MB
W20240202 03:16:18.470973  8424 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240202 03:16:18.471879  8424 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240202 03:16:18.473800  8259 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10034c052000 7.629 MB
W20240202 03:16:18.474032  8259 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10034c7f5000 7.629 MB
W20240202 03:16:18.474099  8259 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10034cf98000 122.1 MB
W20240202 03:16:18.474200  8259 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1003549ac000 122.1 MB
W20240202 03:16:18.474260  8259 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240202 03:16:18.474627  8259 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240202 03:16:18.485445  8426 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10035c3c6000 7.629 MB
W20240202 03:16:18.485626  8426 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10035cb69000 7.629 MB
W20240202 03:16:18.485703  8426 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10035d30c000 122.1 MB
W20240202 03:16:18.485759  8426 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100364d20000 122.1 MB
W20240202 03:16:18.485801  8426 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240202 03:16:18.486806  8426 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240202 03:16:18.510011  8425 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10036c73a000 7.629 MB
W20240202 03:16:18.510411  8425 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10036cedd000 7.629 MB
W20240202 03:16:18.510571  8425 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10036d680000 122.1 MB
W20240202 03:16:18.510746  8425 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100375094000 122.1 MB
W20240202 03:16:18.510818  8425 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240202 03:16:18.511250  8425 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
Worker 7 pid=8428
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240202 03:16:22.202718  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10037caac000 7.629 MB
W20240202 03:16:22.202809  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10037d9f2000 7.629 MB
W20240202 03:16:22.202818  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10037d24f000 7.629 MB
W20240202 03:16:22.202879  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10037e938000 7.629 MB
W20240202 03:16:22.202876  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10037e195000 7.629 MB
W20240202 03:16:22.202994  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10037f0db000 7.629 MB
W20240202 03:16:22.203073  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10037f87e000 7.629 MB
W20240202 03:16:22.203127  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100380021000 7.629 MB
W20240202 03:16:22.203161  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1003807c4000 7.629 MB
W20240202 03:16:22.203198  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100380f67000 7.629 MB
W20240202 03:16:22.203261  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100381ead000 7.629 MB
W20240202 03:16:22.203258  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10038170a000 7.629 MB
W20240202 03:16:22.203316  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100382650000 7.629 MB
W20240202 03:16:22.203336  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100382df3000 7.629 MB
W20240202 03:16:22.203665  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100383596000 7.629 MB
W20240202 03:16:22.203675  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x100383d39000 7.629 MB
W20240202 03:16:22.203686  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1003844dc000 7.629 MB
W20240202 03:16:22.203697  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100384c7f000 7.629 MB
W20240202 03:16:22.203850  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100385422000 7.629 MB
W20240202 03:16:22.203964  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100385bc5000 7.629 MB
W20240202 03:16:22.203985  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x100386368000 7.629 MB
W20240202 03:16:22.203995  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100386b0b000 7.629 MB
W20240202 03:16:22.204087  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100387a51000 7.629 MB
W20240202 03:16:22.204130  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1003881f4000 7.629 MB
W20240202 03:16:22.204161  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100388997000 7.629 MB
W20240202 03:16:22.204093  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1003872ae000 7.629 MB
W20240202 03:16:22.204190  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10038913a000 7.629 MB
W20240202 03:16:22.204286  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1003898dd000 7.629 MB
W20240202 03:16:22.204319  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10038a080000 7.629 MB
W20240202 03:16:22.204491  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10038afc6000 7.629 MB
W20240202 03:16:22.204501  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10038b769000 7.629 MB
W20240202 03:16:22.204474  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x10038a823000 7.629 MB
W20240202 03:16:22.204522  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10038bf0c000 7.629 MB
W20240202 03:16:22.204567  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10038c6af000 7.629 MB
W20240202 03:16:22.204620  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10038d5f5000 7.629 MB
W20240202 03:16:22.204619  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10038ce52000 7.629 MB
W20240202 03:16:22.204669  8259 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10038e53b000 7.629 MB
W20240202 03:16:22.204701  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10038ecde000 7.629 MB
W20240202 03:16:22.204708  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10038f481000 7.629 MB
W20240202 03:16:22.204743  8259 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1003903c7000 80 B 
W20240202 03:16:22.204735  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x10038fc24000 7.629 MB
W20240202 03:16:22.204671  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10038dd98000 7.629 MB
W20240202 03:16:22.204772  8427 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1003903c9000 7.629 MB
W20240202 03:16:22.204792  8259 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100390b6c000 8 B 
W20240202 03:16:22.204846  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x100391311000 7.629 MB
W20240202 03:16:22.204834  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100390b6e000 7.629 MB
W20240202 03:16:22.205085  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x100391ab4000 7.629 MB
W20240202 03:16:22.205096  8428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100392257000 7.629 MB
W20240202 03:16:22.205107  8427 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1003929fa000 80 B 
W20240202 03:16:22.205119  8259 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10039319f000 8 B 
W20240202 03:16:22.205153  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1003931a1000 7.629 MB
W20240202 03:16:22.205265  8427 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x100393946000 8 B 
W20240202 03:16:22.205251  8428 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x100393944000 80 B 
W20240202 03:16:22.205281  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100393948000 7.629 MB
W20240202 03:16:22.205318  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10039488e000 7.629 MB
W20240202 03:16:22.205404  8427 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1003957d4000 8 B 
W20240202 03:16:22.205410  8428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1003957d6000 8 B 
W20240202 03:16:22.205446  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1003957d8000 7.629 MB
Construct PerfSampler done
W20240202 03:16:22.205539  8428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10039671e000 8 B 
W20240202 03:16:22.205529  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100395f7b000 7.629 MB
W20240202 03:16:22.205286  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1003940eb000 7.629 MB
W20240202 03:16:22.205396  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x100395031000 7.629 MB
W20240202 03:16:22.205598  8426 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x100396720000 7.629 MB
I20240202 03:16:22.205636  8259 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240202 03:16:22.205747  8426 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x100396ec3000 80 B 
W20240202 03:16:22.205870  8426 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100397668000 8 B 
W20240202 03:16:22.205811  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100396ec5000 7.629 MB
Construct PerfSampler done
Construct PerfSampler done
W20240202 03:16:22.206218  8426 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1003985b0000 8 B 
I20240202 03:16:22.206277  8427 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 03:16:22.206312  8428 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 03:16:22.205976  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10039766a000 7.629 MB
W20240202 03:16:22.206096  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x100397e0d000 7.629 MB
W20240202 03:16:22.206300  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1003985b2000 7.629 MB
W20240202 03:16:22.205271  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1003929fc000 7.629 MB
W20240202 03:16:22.206460  8422 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100398d55000 7.629 MB
W20240202 03:16:22.206501  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1003994f8000 7.629 MB
W20240202 03:16:22.206590  8422 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10039a43e000 80 B 
W20240202 03:16:22.206569  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x100399c9b000 7.629 MB
W20240202 03:16:22.206676  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10039a440000 7.629 MB
W20240202 03:16:22.206702  8422 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10039abe3000 8 B 
W20240202 03:16:22.206789  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10039abe5000 7.629 MB
W20240202 03:16:22.206828  8422 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10039b388000 8 B 
Construct PerfSampler done
W20240202 03:16:22.206974  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x10039b38a000 7.629 MB
W20240202 03:16:22.207156  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10039bb2d000 7.629 MB
I20240202 03:16:22.207182  8426 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 03:16:22.207212  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x10039c2d0000 7.629 MB
W20240202 03:16:22.207322  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10039ca73000 7.629 MB
W20240202 03:16:22.207382  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x10039d216000 7.629 MB
W20240202 03:16:22.207469  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10039d9b9000 7.629 MB
W20240202 03:16:22.207494  8423 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10039e15c000 7.629 MB
Construct PerfSampler done
W20240202 03:16:22.207592  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10039f0a2000 7.629 MB
W20240202 03:16:22.207584  8425 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10039e8ff000 7.629 MB
W20240202 03:16:22.207679  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10039f845000 7.629 MB
W20240202 03:16:22.207691  8423 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10039ffe8000 80 B 
I20240202 03:16:22.207703  8422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 03:16:22.207780  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10039ffec000 7.629 MB
W20240202 03:16:22.207778  8425 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x10039ffea000 80 B 
W20240202 03:16:22.207823  8423 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1003a078f000 8 B 
W20240202 03:16:22.207875  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1003a0791000 7.629 MB
W20240202 03:16:22.207929  8425 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1003a0f34000 8 B 
W20240202 03:16:22.207957  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1003a0f36000 7.629 MB
W20240202 03:16:22.207978  8423 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003a16d9000 8 B 
W20240202 03:16:22.208079  8425 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1003a16db000 8 B 
W20240202 03:16:22.208107  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1003a16dd000 7.629 MB
W20240202 03:16:22.208194  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1003a1e80000 7.629 MB
W20240202 03:16:22.208283  8424 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1003a2623000 7.629 MB
W20240202 03:16:22.208369  8424 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1003a2dc6000 80 B 
W20240202 03:16:22.208444  8424 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1003a2dc8000 8 B 
W20240202 03:16:22.208508  8424 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003a2dca000 8 B 
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
I20240202 03:16:22.209089  8423 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 03:16:22.209131  8425 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 03:16:22.209172  8424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 03:16:22.211131  8259 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.01,
        "backgrad_init": "both"
    }
W20240202 03:16:22.211251  8259 grad_base.h:184] Init GradProcessingBase done
I20240202 03:16:34.197985  8259 grad_async_v2.h:42] Use main thread to update emb.
W20240202 03:16:34.198343  8259 kg_controller.h:78] after init GradAsyncProcessingV2
I20240202 03:16:34.198359  8259 kg_controller.h:84] Construct KGCacheController done
E20240202 03:16:35.993707  8428 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240202 03:16:35.994009  8259 recstore.cc:66] init folly done
E20240202 03:16:35.994007  8424 recstore.cc:66] init folly done
E20240202 03:16:35.994014  8427 recstore.cc:66] init folly done
E20240202 03:16:35.994035  8426 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240202 03:16:35.995211  8423 recstore.cc:66] init folly done
E20240202 03:16:35.995478  8425 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240202 03:16:35.995636  8422 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
I20240202 03:16:35.996730  8259 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240202 03:16:38.156934  9170 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240202 03:16:38.157176  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240202 03:16:39.157024  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240202 03:16:39.182788  9170 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240202 03:16:40.157011  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240202 03:16:40.210801  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
Before Training
I20240202 03:16:40.509408  8259 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.594895  8424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.656591  8426 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.684680  8427 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.717429  8428 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.745885  8422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.774139  8423 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240202 03:16:40.806514  8425 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.092 us                | 300.331 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 469.158 us                | 469.158 us                |
| GenInput                  | 5.136 ms                  | 5.136 ms                  |
| Forward                   | 53.261 ms                 | 53.261 ms                 |
| Backward                  | 34.116 ms                 | 34.116 ms                 |
| Optimize                  | 909.777 us                | 909.777 us                |
| BarrierTimeBeforeRank0    | 16.489 ms                 | 16.489 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 03:16:42.623128  9268 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240202 03:16:42.669179  8259 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=0
========== Step 1 ========== 
========== Step 1 ========== 
W20240202 03:16:42.707293  9170 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240202 03:16:43.623013  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=12072
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240202 03:16:43.776937  9170 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240202 03:16:44.623013  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=2306
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240202 03:16:44.821425  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240202 03:16:45.623095  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=10423
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240202 03:16:45.960942  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 238.480 us                | 36.063 ms                 |
| ProcessBack:Shuffle       | 249.797 ms                | 447.472 ms                |
| ProcessBack:UpdateCache   | 12.762 ms                 | 1.240 s                   |
| ProcessBack:UpsertPq      | 56.918 us                 | 46.765 ms                 |
| ProcessOneStep            | 265.447 ms                | 1.748 s                   |
| BlockToStepN              | 34.855 us                 | 37.217 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
E20240202 03:16:46.623013  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=3829
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240202 03:16:47.182919  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.957 us                | 1.165 ms                  |
| GenInput                  | 1.995 ms                  | 7.181 ms                  |
| Forward                   | 395.646 us                | 53.261 ms                 |
| Backward                  | 1.140 ms                  | 34.116 ms                 |
| Optimize                  | 149.772 us                | 909.777 us                |
| BarrierTimeBeforeRank0    | 739.084 us                | 16.489 ms                 |
| AfterBackward             | 264.330 ms                | 1.748 s                   |
| BlockToStepN              | 123.505 us                | 37.361 ms                 |
| OneStep                   | 270.652 ms                | 1.900 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240202 03:16:47.623010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=25086
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240202 03:16:48.339790  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240202 03:16:48.623008  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=15508
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240202 03:16:49.448622  9170 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240202 03:16:49.623009  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=2208
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240202 03:16:50.521636  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
E20240202 03:16:50.623018  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=12243
E20240202 03:16:50.710791  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=33, sample_step_cpp_seen_[rank]=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 162.262 us                | 10.920 ms                 |
| ProcessBack:Shuffle       | 242.288 ms                | 447.472 ms                |
| ProcessBack:UpdateCache   | 19.468 ms                 | 1.240 s                   |
| ProcessBack:UpsertPq      | 57.348 us                 | 46.765 ms                 |
| ProcessOneStep            | 264.294 ms                | 1.748 s                   |
| BlockToStepN              | 65.877 us                 | 37.217 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240202 03:16:51.545226  9170 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240202 03:16:51.624094  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=3985
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.957 us                | 1.165 ms                  |
| GenInput                  | 2.148 ms                  | 7.181 ms                  |
| Forward                   | 394.712 us                | 53.261 ms                 |
| Backward                  | 1.020 ms                  | 34.116 ms                 |
| Optimize                  | 138.852 us                | 909.777 us                |
| BarrierTimeBeforeRank0    | 739.084 us                | 16.489 ms                 |
| AfterBackward             | 264.330 ms                | 1.748 s                   |
| BlockToStepN              | 160.098 us                | 37.361 ms                 |
| OneStep                   | 270.652 ms                | 1.900 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
W20240202 03:16:52.577347  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240202 03:16:52.636098  9183 parallel_pq_v2.h:79] insert failed, size(hashtable)=20851
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240202 03:16:53.636013  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=27392
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240202 03:16:53.683413  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
E20240202 03:16:54.650312  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 03:16:54.700608  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240202 03:16:55.650010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=4931
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240202 03:16:55.738924  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 207.278 us                | 39.831 ms                 |
| ProcessBack:Shuffle       | 242.288 ms                | 265.503 ms                |
| ProcessBack:UpdateCache   | 20.581 ms                 | 26.154 ms                 |
| ProcessBack:UpsertPq      | 57.112 us                 | 109.212 us                |
| ProcessOneStep            | 264.294 ms                | 963.843 ms                |
| BlockToStepN              | 110.687 us                | 235.584 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240202 03:16:56.650028  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=13031
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240202 03:16:57.016919  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 122.468 us                | 802.438 us                |
| GenInput                  | 1.645 ms                  | 6.056 ms                  |
| Forward                   | 378.962 us                | 1.767 ms                  |
| Backward                  | 929.834 us                | 14.152 ms                 |
| Optimize                  | 128.548 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 739.084 us                | 8.537 ms                  |
| AfterBackward             | 264.330 ms                | 963.891 ms                |
| BlockToStepN              | 178.878 us                | 417.249 us                |
| OneStep                   | 268.913 ms                | 968.727 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240202 03:16:57.650010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=12400
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
E20240202 03:16:58.235637  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=61, sample_step_cpp_seen_[rank]=60
W20240202 03:16:58.270663  9170 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240202 03:16:58.650012  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240202 03:16:59.308044  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
E20240202 03:16:59.650014  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1496
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240202 03:17:00.322052  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
E20240202 03:17:00.650014  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=7395
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 209.271 us                | 32.376 ms                 |
| ProcessBack:Shuffle       | 242.288 ms                | 283.365 ms                |
| ProcessBack:UpdateCache   | 20.447 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 56.918 us                 | 109.212 us                |
| ProcessOneStep            | 264.294 ms                | 1.061 s                   |
| BlockToStepN              | 118.973 us                | 623.510 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240202 03:17:01.329877  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240202 03:17:01.652066  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=17703
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.684 us                | 802.438 us                |
| GenInput                  | 1.577 ms                  | 6.056 ms                  |
| Forward                   | 370.785 us                | 1.767 ms                  |
| Backward                  | 929.834 us                | 14.152 ms                 |
| Optimize                  | 128.548 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 614.996 us                | 8.537 ms                  |
| AfterBackward             | 264.330 ms                | 1.061 s                   |
| BlockToStepN              | 202.745 us                | 841.040 us                |
| OneStep                   | 268.913 ms                | 1.066 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 03:17:02.364872  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240202 03:17:02.652011  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=4536
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240202 03:17:03.437762  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
E20240202 03:17:03.652010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=26823
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240202 03:17:04.455302  9170 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240202 03:17:04.652014  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=6706
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240202 03:17:05.551404  9170 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240202 03:17:05.652025  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=11525
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 258.317 us                | 43.743 ms                 |
| ProcessBack:Shuffle       | 242.494 ms                | 284.382 ms                |
| ProcessBack:UpdateCache   | 19.378 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 57.244 us                 | 109.212 us                |
| ProcessOneStep            | 260.891 ms                | 1.061 s                   |
| BlockToStepN              | 151.094 us                | 716.558 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
W20240202 03:17:06.616789  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
E20240202 03:17:06.652006  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=772
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.616 us                | 802.438 us                |
| GenInput                  | 1.402 ms                  | 6.056 ms                  |
| Forward                   | 362.222 us                | 1.767 ms                  |
| Backward                  | 961.476 us                | 14.152 ms                 |
| Optimize                  | 122.023 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 711.629 us                | 8.537 ms                  |
| AfterBackward             | 260.650 ms                | 1.061 s                   |
| BlockToStepN              | 227.156 us                | 841.040 us                |
| OneStep                   | 266.972 ms                | 1.066 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
E20240202 03:17:07.652012  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240202 03:17:07.742262  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 46.186, per_step: 0.461856
Step99:rank6, time: 46.186, per_step: 0.461856
Step99:rank3, time: 46.186, per_step: 0.461857
Step99:rank1, time: 46.186, per_step: 0.461859
Step99:rank2, time: 46.185, per_step: 0.461852
Step99:rank5, time: 46.186, per_step: 0.461859
Step99:rank7, time: 46.186, per_step: 0.461859
Step99:rank4, time: 46.185, per_step: 0.461852
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
E20240202 03:17:08.652741  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=18935
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240202 03:17:08.965245  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
E20240202 03:17:09.652019  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=2096
E20240202 03:17:09.819073  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=105, sample_step_cpp_seen_[rank]=104
W20240202 03:17:10.092944  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240202 03:17:10.652022  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=110
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 316.894 us                | 8.823 ms                  |
| ProcessBack:Shuffle       | 243.127 ms                | 284.382 ms                |
| ProcessBack:UpdateCache   | 19.362 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 56.918 us                 | 109.212 us                |
| ProcessOneStep            | 263.602 ms                | 1.135 s                   |
| BlockToStepN              | 161.824 us                | 716.558 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240202 03:17:11.137436  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240202 03:17:11.656076  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 120.414 us                | 802.438 us                |
| GenInput                  | 1.397 ms                  | 6.056 ms                  |
| Forward                   | 356.700 us                | 1.767 ms                  |
| Backward                  | 937.059 us                | 14.152 ms                 |
| Optimize                  | 120.212 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 711.629 us                | 8.537 ms                  |
| AfterBackward             | 263.643 ms                | 1.135 s                   |
| BlockToStepN              | 256.849 us                | 841.040 us                |
| OneStep                   | 268.251 ms                | 1.139 s                   |
| E2E-100                   | 27.879 s                  | 27.879 s                  |
+---------------------------+---------------------------+---------------------------+
W20240202 03:17:12.250275  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
E20240202 03:17:12.656030  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=9948
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240202 03:17:13.255039  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240202 03:17:13.656073  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=833
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240202 03:17:14.397068  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
E20240202 03:17:14.656069  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240202 03:17:15.454638  9170 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
E20240202 03:17:15.656028  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=346
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 273.350 us                | 41.102 ms                 |
| ProcessBack:Shuffle       | 242.288 ms                | 284.382 ms                |
| ProcessBack:UpdateCache   | 19.362 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 55.098 us                 | 109.212 us                |
| ProcessOneStep            | 260.891 ms                | 1.135 s                   |
| BlockToStepN              | 196.815 us                | 716.558 us                |
+---------------------------+---------------------------+---------------------------+
E20240202 03:17:16.194828  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=129, sample_step_cpp_seen_[rank]=128
W20240202 03:17:16.554962  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240202 03:17:16.656008  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.829 us                | 802.438 us                |
| GenInput                  | 1.232 ms                  | 6.056 ms                  |
| Forward                   | 347.334 us                | 1.767 ms                  |
| Backward                  | 929.583 us                | 14.152 ms                 |
| Optimize                  | 118.826 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 609.977 us                | 8.537 ms                  |
| AfterBackward             | 260.933 ms                | 1.135 s                   |
| BlockToStepN              | 281.971 us                | 841.040 us                |
| OneStep                   | 264.372 ms                | 1.139 s                   |
| E2E-100                   | 27.879 s                  | 27.879 s                  |
+---------------------------+---------------------------+---------------------------+
W20240202 03:17:17.607507  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
E20240202 03:17:17.656006  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240202 03:17:18.063547  8259 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240202 03:17:18.634057  9170 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240202 03:17:18.656004  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=7283
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240202 03:17:19.656025  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=976
W20240202 03:17:19.694995  9170 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
E20240202 03:17:20.656011  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=4063
W20240202 03:17:20.704490  9170 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 212.701 us                | 33.790 ms                 |
| ProcessBack:Shuffle       | 242.792 ms                | 284.382 ms                |
| ProcessBack:UpdateCache   | 18.203 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 56.033 us                 | 179.520 us                |
| ProcessOneStep            | 261.530 ms                | 1.748 s                   |
| BlockToStepN              | 207.461 us                | 1.127 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240202 03:17:21.664080  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=3947
W20240202 03:17:21.760828  9170 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.975 us                | 802.438 us                |
| GenInput                  | 1.173 ms                  | 6.056 ms                  |
| Forward                   | 356.241 us                | 3.550 ms                  |
| Backward                  | 949.215 us                | 14.152 ms                 |
| Optimize                  | 120.212 us                | 909.777 us                |
| BarrierTimeBeforeRank0    | 572.288 us                | 8.537 ms                  |
| AfterBackward             | 262.157 ms                | 1.748 s                   |
| BlockToStepN              | 289.619 us                | 1.424 ms                  |
| OneStep                   | 267.579 ms                | 1.835 s                   |
| E2E-100                   | 27.879 s                  | 27.879 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
E20240202 03:17:22.664017  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=370
W20240202 03:17:22.776657  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240202 03:17:23.664009  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=3092
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240202 03:17:23.888985  9170 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
E20240202 03:17:24.664011  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=5766
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
W20240202 03:17:24.941313  9170 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
E20240202 03:17:25.664016  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1600
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 241.984 us                | 42.221 ms                 |
| ProcessBack:Shuffle       | 243.127 ms                | 283.719 ms                |
| ProcessBack:UpdateCache   | 18.203 ms                 | 26.154 ms                 |
| ProcessBack:UpsertPq      | 57.112 us                 | 179.520 us                |
| ProcessOneStep            | 263.354 ms                | 1.135 s                   |
| BlockToStepN              | 225.766 us                | 1.127 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
W20240202 03:17:26.130509  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240202 03:17:26.664021  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1542
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.975 us                | 551.500 us                |
| GenInput                  | 1.134 ms                  | 5.838 ms                  |
| Forward                   | 356.610 us                | 3.489 ms                  |
| Backward                  | 938.878 us                | 3.430 ms                  |
| Optimize                  | 118.826 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 583.571 us                | 6.039 ms                  |
| AfterBackward             | 263.412 ms                | 1.135 s                   |
| BlockToStepN              | 305.191 us                | 1.424 ms                  |
| OneStep                   | 267.823 ms                | 1.139 s                   |
| E2E-100                   | 27.879 s                  | 27.879 s                  |
+---------------------------+---------------------------+---------------------------+
W20240202 03:17:27.436046  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
E20240202 03:17:27.668061  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=12312
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240202 03:17:28.246628  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=170, sample_step_cpp_seen_[rank]=169
W20240202 03:17:28.574749  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240202 03:17:28.668010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240202 03:17:29.587730  9170 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240202 03:17:29.668007  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=257
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240202 03:17:30.626081  9170 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240202 03:17:30.668008  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=11634
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 204.424 us                | 35.134 ms                 |
| ProcessBack:Shuffle       | 243.127 ms                | 284.277 ms                |
| ProcessBack:UpdateCache   | 18.346 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 57.244 us                 | 179.520 us                |
| ProcessOneStep            | 263.602 ms                | 1.135 s                   |
| BlockToStepN              | 239.749 us                | 1.426 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240202 03:17:31.626830  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240202 03:17:31.668007  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=6250
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.299 us                | 551.500 us                |
| GenInput                  | 1.134 ms                  | 5.838 ms                  |
| Forward                   | 358.432 us                | 3.489 ms                  |
| Backward                  | 937.597 us                | 3.430 ms                  |
| Optimize                  | 119.381 us                | 389.882 us                |
| BarrierTimeBeforeRank0    | 572.288 us                | 6.039 ms                  |
| AfterBackward             | 263.901 ms                | 1.135 s                   |
| BlockToStepN              | 327.846 us                | 1.581 ms                  |
| OneStep                   | 268.251 ms                | 1.139 s                   |
| E2E-100                   | 27.879 s                  | 27.879 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240202 03:17:32.654798  9170 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240202 03:17:32.668010  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240202 03:17:33.668026  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=6026
W20240202 03:17:33.693382  9170 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240202 03:17:34.668012  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=1985
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240202 03:17:34.933910  9170 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240202 03:17:35.668015  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=5328
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
E20240202 03:17:35.920219  8259 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=198, sample_step_cpp_seen_[rank]=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 240.268 us                | 43.249 ms                 |
| ProcessBack:Shuffle       | 243.127 ms                | 284.277 ms                |
| ProcessBack:UpdateCache   | 18.203 ms                 | 29.602 ms                 |
| ProcessBack:UpsertPq      | 57.244 us                 | 179.520 us                |
| ProcessOneStep            | 263.354 ms                | 1.135 s                   |
| BlockToStepN              | 265.932 us                | 1.507 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240202 03:17:36.155592  9170 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240202 03:17:36.668007  9170 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
W20240202 03:17:37.181593  9170 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
Step199:rank0, time: 28.855, per_step: 0.285688
Step199:rank2, time: 28.854, per_step: 0.285688
Step199:rank5, time: 28.854, per_step: 0.285688
Step199:rank3, time: 28.855, per_step: 0.285688
Step199:rank6, time: 28.855, per_step: 0.285688
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Step199:rank4, time: 28.855, per_step: 0.285691
Step199:rank1, time: 28.855, per_step: 0.285692
timer name is E2E-100Successfully xmh
timer name is 
Successfully xmh
timer name is E2E-100
E2E-100
timer name is E2E-100
timer name is E2E-100
Step199:rank7, time: 28.855, per_step: 0.285694
timer name is Successfully xmh
E2E-100
timer name is E2E-100
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.316 us                | 551.500 us                |
| GenInput                  | 1.108 ms                  | 5.838 ms                  |
| Forward                   | 360.869 us                | 3.489 ms                  |
| Backward                  | 937.597 us                | 3.430 ms                  |
| Optimize                  | 119.926 us                | 602.745 us                |
| BarrierTimeBeforeRank0    | 546.301 us                | 6.039 ms                  |
| AfterBackward             | 263.412 ms                | 1.161 s                   |
| BlockToStepN              | 349.904 us                | 1.598 ms                  |
| OneStep                   | 268.251 ms                | 1.165 s                   |
| E2E-100                   | 27.879 s                  | 28.855 s                  |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
