WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 22:05:44.866533 3014345 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 22:05:44.867723 3014345 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [3014345 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f48c4b311c0>==========
INFO [3014492 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3014345 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3014492 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [3014345 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
E20240131 22:05:47.976435 3014345 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 22:05:47.976452 3014492 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 22:05:50.097754 3014345 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 22:05:50.097754 3014492 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 22:05:50.098529 3014345 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10004817f000 7.629 MB
W20240131 22:05:50.098534 3014492 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100048922000 7.629 MB
W20240131 22:05:50.098631 3014345 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000490c5000 7.629 MB
W20240131 22:05:50.098660 3014492 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100049868000 7.629 MB
W20240131 22:05:50.098677 3014345 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10004a00b000 122.1 MB
W20240131 22:05:50.098702 3014345 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100051a1f000 122.1 MB
W20240131 22:05:50.098716 3014492 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100059433000 122.1 MB
W20240131 22:05:50.098733 3014345 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 22:05:50.098743 3014492 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100060e47000 122.1 MB
W20240131 22:05:50.098766 3014492 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 22:05:50.099206 3014345 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 22:05:50.099212 3014492 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 1 pid=3014492
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240131 22:05:53.513818 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100068863000 7.629 MB
W20240131 22:05:53.513962 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100069006000 7.629 MB
W20240131 22:05:53.513988 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000697a9000 7.629 MB
W20240131 22:05:53.514019 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100069f4c000 7.629 MB
W20240131 22:05:53.514045 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10006a6ef000 7.629 MB
W20240131 22:05:53.514073 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10006ae92000 7.629 MB
W20240131 22:05:53.514088 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10006b635000 7.629 MB
W20240131 22:05:53.514125 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10006bdd8000 7.629 MB
W20240131 22:05:53.514156 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10006c57b000 7.629 MB
W20240131 22:05:53.514176 3014345 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10006cd1e000 7.629 MB
W20240131 22:05:53.514204 3014345 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10006d4c1000 80 B 
W20240131 22:05:53.514225 3014345 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10006d4c3000 8 B 
W20240131 22:05:53.514240 3014345 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10006d4c5000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 22:05:53.514495 3014345 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
W20240131 22:05:53.677244 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10006d4c7000 7.629 MB
W20240131 22:05:53.677374 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10006dc6a000 7.629 MB
W20240131 22:05:53.677403 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10006e40d000 7.629 MB
W20240131 22:05:53.677438 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10006ebb0000 7.629 MB
W20240131 22:05:53.677462 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10006f353000 7.629 MB
W20240131 22:05:53.677490 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10006faf6000 7.629 MB
W20240131 22:05:53.677522 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100070299000 7.629 MB
W20240131 22:05:53.677556 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100070a3c000 7.629 MB
W20240131 22:05:53.677577 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000711df000 7.629 MB
W20240131 22:05:53.677605 3014492 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100071982000 7.629 MB
W20240131 22:05:53.677624 3014492 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100072125000 80 B 
W20240131 22:05:53.677646 3014492 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100072127000 8 B 
W20240131 22:05:53.677668 3014492 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100072129000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 22:05:53.677923 3014492 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
W20240131 22:05:53.678635 3014345 grad_base.h:55] KGCacheController, config={
        "num_gpus": 2,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 22:05:53.678794 3014345 grad_base.h:184] Init GradProcessingBase done
I20240131 22:05:54.295912 3014345 grad_async_v2.h:42] Use main thread to update emb.
W20240131 22:05:54.296128 3014345 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 22:05:54.296135 3014345 kg_controller.h:84] Construct KGCacheController done
E20240131 22:05:54.534714 3014345 recstore.cc:66] init folly done
E20240131 22:05:54.534761 3014492 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 22:05:54.535434 3014345 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 22:05:54.808027 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:05:54.808300 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 22:05:55.808225 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:05:55.824471 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:05:56.808058 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:05:56.919155 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
Before Training
Before Training
I20240131 22:05:58.240823 3014492 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240131 22:05:58.240857 3014345 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
========== Step 0 ========== 
W20240131 22:05:58.254411 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:05:58.254806 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.106 us                | 155.106 us                |
| GenInput                  | 18.449 ms                 | 18.449 ms                 |
| NN                        | 140.511 ms                | 140.511 ms                |
| Forward                   | 165.376 ms                | 165.376 ms                |
| Backward                  | 138.790 ms                | 138.790 ms                |
| Optimize                  | 7.873 ms                  | 7.873 ms                  |
| BarrierTimeBeforeRank0    | 16.802 ms                 | 16.802 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240131 22:05:59.336108 3014991 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:05:59.465970 3014345 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 158.598 us                | 364.394 us                |
| ProcessBack:Shuffle       | 219.238 ms                | 219.238 ms                |
| ProcessBack:UpdateCache   | 511.744 ms                | 511.744 ms                |
| ProcessBack:UpsertPq      | 129.609 ms                | 129.609 ms                |
| ProcessOneStep            | 875.521 ms                | 875.521 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
W20240131 22:05:59.607299 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [3014492 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3014345 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
W20240131 22:05:59.844519 3014345 grad_async_v2.h:257] pq is empty
========== Step 2 ========== 
========== Step 3 ========== 
W20240131 22:06:00.326875 3014345 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
E20240131 22:06:00.336172 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:06:00.565362 3014345 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
========== Step 6 ========== 
W20240131 22:06:00.685310 3014817 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 7 ========== 
W20240131 22:06:01.280385 3014345 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
E20240131 22:06:01.336159 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 22:06:01.528064 3014345 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
W20240131 22:06:01.763608 3014345 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
W20240131 22:06:01.764607 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:06:02.008684 3014345 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
W20240131 22:06:02.244717 3014345 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
E20240131 22:06:02.336061 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:02.486111 3014345 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
W20240131 22:06:02.729741 3014345 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
W20240131 22:06:02.845324 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
W20240131 22:06:03.204133 3014345 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
========== Step 17 ========== 
E20240131 22:06:03.336100 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.505 us                | 269.481 us                |
| GenInput                  | 18.449 ms                 | 32.090 ms                 |
| NN                        | 814.676 us                | 140.511 ms                |
| Forward                   | 1.232 ms                  | 165.376 ms                |
| Backward                  | 1.960 ms                  | 138.790 ms                |
| Optimize                  | 249.863 us                | 7.873 ms                  |
| BarrierTimeBeforeRank0    | 17.914 us                 | 16.802 ms                 |
| AfterBackward             | 216.498 ms                | 875.761 ms                |
| BlockToStepN              | 116.251 us                | 134.675 ms                |
| OneStep                   | 243.622 ms                | 1.360 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:03.917246 3014345 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
W20240131 22:06:03.923243 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 20 ========== 
========== Step 21 ========== 
E20240131 22:06:04.336136 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=40
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.210 us                | 1.102 ms                  |
| ProcessBack:Shuffle       | 216.057 ms                | 352.543 ms                |
| ProcessBack:UpdateCache   | 383.726 us                | 511.744 ms                |
| ProcessBack:UpsertPq      | 44.674 us                 | 129.609 ms                |
| ProcessOneStep            | 216.479 ms                | 875.521 ms                |
| BlockToStepN              | 66.432 us                 | 134.316 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
W20240131 22:06:04.983412 3014817 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:06:05.106706 3014345 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
========== Step 25 ========== 
E20240131 22:06:05.336097 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
W20240131 22:06:06.042623 3014345 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
W20240131 22:06:06.059096 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 22:06:06.336109 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 30 ========== 
W20240131 22:06:06.752118 3014345 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
W20240131 22:06:06.989320 3014345 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
W20240131 22:06:07.102514 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 22:06:07.224213 3014345 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
E20240131 22:06:07.336141 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:07.463323 3014345 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
W20240131 22:06:07.700464 3014345 grad_async_v2.h:257] pq is empty
========== Step 35 ========== 
W20240131 22:06:07.936698 3014345 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
W20240131 22:06:08.179414 3014345 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
W20240131 22:06:08.180033 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 38 ========== 
E20240131 22:06:08.336289 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 39 ========== 
========== Step 40 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.977 us                | 319.917 us                |
| GenInput                  | 18.624 ms                 | 32.090 ms                 |
| NN                        | 686.169 us                | 140.511 ms                |
| Forward                   | 1.034 ms                  | 165.376 ms                |
| Backward                  | 1.960 ms                  | 138.790 ms                |
| Optimize                  | 220.060 us                | 7.873 ms                  |
| BarrierTimeBeforeRank0    | 17.439 us                 | 16.802 ms                 |
| AfterBackward             | 214.502 ms                | 875.761 ms                |
| BlockToStepN              | 122.312 us                | 134.675 ms                |
| OneStep                   | 241.398 ms                | 1.360 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 41 ========== 
========== Step 42 ========== 
W20240131 22:06:09.204032 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 22:06:09.336129 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.215 us                | 205.300 us                |
| ProcessBack:Shuffle       | 213.926 ms                | 352.543 ms                |
| ProcessBack:UpdateCache   | 410.282 us                | 511.744 ms                |
| ProcessBack:UpsertPq      | 43.065 us                 | 129.609 ms                |
| ProcessOneStep            | 214.471 ms                | 875.521 ms                |
| BlockToStepN              | 75.838 us                 | 134.316 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:09.569904 3014345 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
W20240131 22:06:09.808481 3014345 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
W20240131 22:06:10.042110 3014345 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
W20240131 22:06:10.276602 3014345 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
W20240131 22:06:10.277046 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 22:06:10.336050 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:10.516463 3014345 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
W20240131 22:06:10.757107 3014345 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
W20240131 22:06:11.050484 3014345 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
W20240131 22:06:11.304814 3014345 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
W20240131 22:06:11.311034 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:06:11.336122 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:11.551507 3014345 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
W20240131 22:06:11.793279 3014345 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
W20240131 22:06:12.037138 3014345 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
W20240131 22:06:12.274264 3014345 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
E20240131 22:06:12.336067 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:12.375257 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:06:12.498226 3014345 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
W20240131 22:06:12.738312 3014345 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
W20240131 22:06:12.984367 3014345 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
W20240131 22:06:13.228390 3014345 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
E20240131 22:06:13.336115 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:13.471901 3014345 grad_async_v2.h:257] pq is empty
========== Step 59 ========== 
W20240131 22:06:13.473249 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.977 us                | 269.481 us                |
| GenInput                  | 18.252 ms                 | 30.191 ms                 |
| NN                        | 651.121 us                | 2.221 ms                  |
| Forward                   | 997.782 us                | 6.479 ms                  |
| Backward                  | 1.960 ms                  | 5.828 ms                  |
| Optimize                  | 216.246 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 17.270 us                 | 2.973 ms                  |
| AfterBackward             | 218.506 ms                | 359.279 ms                |
| BlockToStepN              | 137.404 us                | 411.327 us                |
| OneStep                   | 241.676 ms                | 390.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:13.710990 3014345 grad_async_v2.h:257] pq is empty
========== Step 60 ========== 
W20240131 22:06:14.012818 3014345 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
W20240131 22:06:14.254918 3014345 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
E20240131 22:06:14.336055 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:14.495978 3014345 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
W20240131 22:06:14.502317 3014817 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 64 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.902 us                | 252.190 us                |
| ProcessBack:Shuffle       | 218.307 ms                | 351.753 ms                |
| ProcessBack:UpdateCache   | 332.765 us                | 6.428 ms                  |
| ProcessBack:UpsertPq      | 44.473 us                 | 80.015 us                 |
| ProcessOneStep            | 218.688 ms                | 359.102 ms                |
| BlockToStepN              | 87.316 us                 | 358.815 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 65 ========== 
W20240131 22:06:14.937546 3014345 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
========== Step 67 ========== 
E20240131 22:06:15.336030 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 68 ========== 
W20240131 22:06:15.557096 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 69 ========== 
========== Step 70 ========== 
E20240131 22:06:16.336038 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 22:06:16.363629 3014345 grad_async_v2.h:257] pq is empty
========== Step 71 ========== 
W20240131 22:06:16.600667 3014345 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
W20240131 22:06:16.601169 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 73 ========== 
W20240131 22:06:17.073475 3014345 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
W20240131 22:06:17.314488 3014345 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
E20240131 22:06:17.336154 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
W20240131 22:06:17.552187 3014345 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
W20240131 22:06:17.665109 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:06:17.787899 3014345 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
W20240131 22:06:18.020792 3014345 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
W20240131 22:06:18.229667 3014345 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
E20240131 22:06:18.336091 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:18.477099 3014345 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
========== Step 81 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.441 us                | 269.481 us                |
| GenInput                  | 18.449 ms                 | 30.191 ms                 |
| NN                        | 637.531 us                | 2.221 ms                  |
| Forward                   | 971.317 us                | 6.479 ms                  |
| Backward                  | 1.900 ms                  | 6.138 ms                  |
| Optimize                  | 209.093 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 17.146 us                 | 3.566 ms                  |
| AfterBackward             | 218.708 ms                | 359.279 ms                |
| BlockToStepN              | 164.371 us                | 411.327 us                |
| OneStep                   | 241.052 ms                | 390.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:18.820381 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
E20240131 22:06:19.336023 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.091 us                | 685.190 us                |
| ProcessBack:Shuffle       | 218.307 ms                | 352.543 ms                |
| ProcessBack:UpdateCache   | 336.978 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 44.473 us                 | 80.015 us                 |
| ProcessOneStep            | 218.688 ms                | 359.102 ms                |
| BlockToStepN              | 99.845 us                 | 358.815 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:19.681718 3014345 grad_async_v2.h:257] pq is empty
========== Step 85 ========== 
W20240131 22:06:19.932101 3014345 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
W20240131 22:06:19.932613 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:06:20.169150 3014345 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
E20240131 22:06:20.336020 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:06:20.410177 3014345 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
W20240131 22:06:20.658255 3014345 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
W20240131 22:06:20.895419 3014345 grad_async_v2.h:257] pq is empty
========== Step 90 ========== 
W20240131 22:06:21.014361 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:06:21.141072 3014345 grad_async_v2.h:257] pq is empty
========== Step 91 ========== 
E20240131 22:06:21.336004 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
W20240131 22:06:22.103648 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240131 22:06:22.206815 3014345 grad_async_v2.h:257] pq is empty
========== Step 96 ========== 
E20240131 22:06:22.336084 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:22.588761 3014345 grad_async_v2.h:257] pq is empty
========== Step 97 ========== 
W20240131 22:06:22.839197 3014345 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
W20240131 22:06:23.077589 3014345 grad_async_v2.h:257] pq is empty
========== Step 99 ========== 
W20240131 22:06:23.193445 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 22:06:23.316685 3014345 grad_async_v2.h:257] pq is empty
Step99:rank0, time: 33.007, per_step: 0.330066
Step99:rank1, time: 33.007, per_step: 0.330066
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.441 us                | 269.481 us                |
| GenInput                  | 18.331 ms                 | 30.659 ms                 |
| NN                        | 627.279 us                | 2.221 ms                  |
| Forward                   | 971.317 us                | 6.479 ms                  |
| Backward                  | 1.890 ms                  | 17.068 ms                 |
| Optimize                  | 208.855 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 17.030 us                 | 3.566 ms                  |
| AfterBackward             | 219.683 ms                | 359.279 ms                |
| BlockToStepN              | 178.840 us                | 411.327 us                |
| OneStep                   | 241.398 ms                | 390.840 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 22:06:23.336536 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:23.553560 3014345 grad_async_v2.h:257] pq is empty
========== Step 101 ========== 
W20240131 22:06:23.669652 3014345 grad_async_v2.h:257] pq is empty
========== Step 102 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.441 us                | 319.917 us                |
| GenInput                  | 18.341 ms                 | 30.659 ms                 |
| NN                        | 629.663 us                | 2.221 ms                  |
| Forward                   | 967.026 us                | 6.479 ms                  |
| Backward                  | 1.886 ms                  | 17.068 ms                 |
| Optimize                  | 208.855 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 16.965 us                 | 3.566 ms                  |
| AfterBackward             | 219.490 ms                | 359.279 ms                |
| BlockToStepN              | 178.840 us                | 411.327 us                |
| OneStep                   | 241.005 ms                | 390.840 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:24.029366 3014345 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
W20240131 22:06:24.207531 3014345 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
W20240131 22:06:24.280123 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:06:24.336079 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:06:24.515834 3014345 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.565 us                | 1.329 ms                  |
| ProcessBack:Shuffle       | 219.238 ms                | 352.564 ms                |
| ProcessBack:UpdateCache   | 338.939 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 43.913 us                 | 80.015 us                 |
| ProcessOneStep            | 219.663 ms                | 359.102 ms                |
| BlockToStepN              | 113.774 us                | 358.815 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:24.806114 3014345 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
W20240131 22:06:25.049680 3014345 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
W20240131 22:06:25.293027 3014345 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
W20240131 22:06:25.299336 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 22:06:25.336004 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 22:06:25.529840 3014345 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
W20240131 22:06:25.773880 3014345 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
W20240131 22:06:26.014876 3014345 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
W20240131 22:06:26.264976 3014345 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
========== Step 113 ========== 
E20240131 22:06:26.336128 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:26.383708 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
E20240131 22:06:27.336024 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 22:06:27.514750 3014345 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
W20240131 22:06:27.521354 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:06:27.768147 3014345 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
W20240131 22:06:28.014063 3014345 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 120 ========== 
E20240131 22:06:28.336086 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:06:28.489344 3014345 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
W20240131 22:06:28.609535 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.999 us                | 319.917 us                |
| GenInput                  | 18.454 ms                 | 32.090 ms                 |
| NN                        | 630.617 us                | 2.221 ms                  |
| Forward                   | 971.317 us                | 6.479 ms                  |
| Backward                  | 1.889 ms                  | 17.068 ms                 |
| Optimize                  | 208.855 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 16.877 us                 | 3.566 ms                  |
| AfterBackward             | 221.665 ms                | 359.279 ms                |
| BlockToStepN              | 190.900 us                | 434.302 us                |
| OneStep                   | 242.088 ms                | 390.840 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:28.736681 3014345 grad_async_v2.h:257] pq is empty
========== Step 122 ========== 
W20240131 22:06:28.986234 3014345 grad_async_v2.h:257] pq is empty
========== Step 123 ========== 
W20240131 22:06:29.225401 3014345 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
E20240131 22:06:29.336035 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:29.464172 3014345 grad_async_v2.h:257] pq is empty
========== Step 125 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.493 us                | 232.524 us                |
| ProcessBack:Shuffle       | 219.293 ms                | 352.564 ms                |
| ProcessBack:UpdateCache   | 361.502 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 44.885 us                 | 80.015 us                 |
| ProcessOneStep            | 219.971 ms                | 359.102 ms                |
| BlockToStepN              | 125.448 us                | 358.815 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:29.702311 3014345 grad_async_v2.h:257] pq is empty
========== Step 126 ========== 
W20240131 22:06:29.703385 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:06:29.941284 3014345 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
W20240131 22:06:30.181458 3014345 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
E20240131 22:06:30.336056 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 22:06:30.420965 3014345 grad_async_v2.h:257] pq is empty
========== Step 129 ========== 
W20240131 22:06:30.660827 3014345 grad_async_v2.h:257] pq is empty
========== Step 130 ========== 
W20240131 22:06:30.779806 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:06:30.903446 3014345 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
W20240131 22:06:31.147564 3014345 grad_async_v2.h:257] pq is empty
========== Step 132 ========== 
E20240131 22:06:31.336047 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 133 ========== 
W20240131 22:06:31.616292 3014345 grad_async_v2.h:257] pq is empty
========== Step 134 ========== 
W20240131 22:06:31.860929 3014345 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
W20240131 22:06:31.867245 3014817 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 136 ========== 
W20240131 22:06:32.332729 3014345 grad_async_v2.h:257] pq is empty
========== Step 137 ========== 
E20240131 22:06:32.345257 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:32.584612 3014345 grad_async_v2.h:257] pq is empty
========== Step 138 ========== 
W20240131 22:06:32.821457 3014345 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
W20240131 22:06:32.936758 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 22:06:33.061489 3014345 grad_async_v2.h:257] pq is empty
========== Step 140 ========== 
W20240131 22:06:33.304368 3014345 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
E20240131 22:06:33.345062 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:33.539719 3014345 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.503 us                | 319.917 us                |
| GenInput                  | 18.341 ms                 | 33.838 ms                 |
| NN                        | 627.279 us                | 2.221 ms                  |
| Forward                   | 970.840 us                | 6.479 ms                  |
| Backward                  | 1.900 ms                  | 17.068 ms                 |
| Optimize                  | 209.093 us                | 3.200 ms                  |
| BarrierTimeBeforeRank0    | 16.991 us                 | 3.566 ms                  |
| AfterBackward             | 219.070 ms                | 359.279 ms                |
| BlockToStepN              | 200.170 us                | 531.633 us                |
| OneStep                   | 241.398 ms                | 390.840 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:33.777444 3014345 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
W20240131 22:06:34.038863 3014345 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
W20240131 22:06:34.039973 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:06:34.277208 3014345 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
E20240131 22:06:34.345191 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:34.516404 3014345 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.771 us                | 1.315 ms                  |
| ProcessBack:Shuffle       | 218.960 ms                | 352.564 ms                |
| ProcessBack:UpdateCache   | 352.281 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 45.485 us                 | 80.015 us                 |
| ProcessOneStep            | 219.438 ms                | 359.102 ms                |
| BlockToStepN              | 136.414 us                | 484.409 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:34.760900 3014345 grad_async_v2.h:257] pq is empty
========== Step 147 ========== 
W20240131 22:06:35.011507 3014345 grad_async_v2.h:257] pq is empty
========== Step 148 ========== 
W20240131 22:06:35.131134 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 22:06:35.254395 3014345 grad_async_v2.h:257] pq is empty
========== Step 149 ========== 
E20240131 22:06:35.345350 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:35.491992 3014345 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
W20240131 22:06:35.733788 3014345 grad_async_v2.h:257] pq is empty
========== Step 151 ========== 
========== Step 152 ========== 
W20240131 22:06:36.214702 3014345 grad_async_v2.h:257] pq is empty
========== Step 153 ========== 
W20240131 22:06:36.221066 3014817 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 22:06:36.345237 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:36.458060 3014345 grad_async_v2.h:257] pq is empty
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
W20240131 22:06:37.278242 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 22:06:37.345218 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:37.401495 3014345 grad_async_v2.h:257] pq is empty
========== Step 158 ========== 
W20240131 22:06:37.644767 3014345 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
W20240131 22:06:37.891181 3014345 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
W20240131 22:06:38.134390 3014345 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
E20240131 22:06:38.345014 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:38.369379 3014345 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
W20240131 22:06:38.370326 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 22:06:38.616349 3014345 grad_async_v2.h:257] pq is empty
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.747 us                | 269.481 us                |
| GenInput                  | 18.314 ms                 | 32.090 ms                 |
| NN                        | 621.319 us                | 1.891 ms                  |
| Forward                   | 961.065 us                | 3.289 ms                  |
| Backward                  | 1.889 ms                  | 13.673 ms                 |
| Optimize                  | 207.663 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.915 us                 | 2.973 ms                  |
| AfterBackward             | 219.683 ms                | 359.078 ms                |
| BlockToStepN              | 205.692 us                | 434.302 us                |
| OneStep                   | 242.088 ms                | 390.433 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:38.866737 3014345 grad_async_v2.h:257] pq is empty
========== Step 164 ========== 
W20240131 22:06:39.127672 3014345 grad_async_v2.h:257] pq is empty
========== Step 165 ========== 
========== Step 166 ========== 
E20240131 22:06:39.345062 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:06:39.393677 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.855 us                | 866.395 us                |
| ProcessBack:Shuffle       | 219.238 ms                | 352.543 ms                |
| ProcessBack:UpdateCache   | 343.810 us                | 6.428 ms                  |
| ProcessBack:UpsertPq      | 45.959 us                 | 74.083 us                 |
| ProcessOneStep            | 219.663 ms                | 359.047 ms                |
| BlockToStepN              | 143.476 us                | 484.409 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:39.647781 3014345 grad_async_v2.h:257] pq is empty
========== Step 167 ========== 
W20240131 22:06:39.904943 3014345 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
W20240131 22:06:40.157258 3014345 grad_async_v2.h:257] pq is empty
========== Step 169 ========== 
E20240131 22:06:40.345072 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:06:40.407732 3014345 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
W20240131 22:06:40.414194 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:06:40.661504 3014345 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
W20240131 22:06:40.919469 3014345 grad_async_v2.h:257] pq is empty
========== Step 172 ========== 
W20240131 22:06:41.171926 3014345 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
E20240131 22:06:41.345078 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:06:41.419415 3014345 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
W20240131 22:06:41.425833 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:06:41.665935 3014345 grad_async_v2.h:257] pq is empty
========== Step 175 ========== 
W20240131 22:06:41.913715 3014345 grad_async_v2.h:257] pq is empty
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
E20240131 22:06:42.345059 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:06:42.496591 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 22:06:42.623024 3014345 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
W20240131 22:06:42.876196 3014345 grad_async_v2.h:257] pq is empty
========== Step 180 ========== 
========== Step 181 ========== 
E20240131 22:06:43.345296 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:43.359386 3014345 grad_async_v2.h:257] pq is empty
========== Step 182 ========== 
W20240131 22:06:43.606109 3014345 grad_async_v2.h:257] pq is empty
========== Step 183 ========== 
W20240131 22:06:43.606595 3014817 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.999 us                | 269.481 us                |
| GenInput                  | 18.242 ms                 | 32.090 ms                 |
| NN                        | 626.564 us                | 2.221 ms                  |
| Forward                   | 971.317 us                | 6.335 ms                  |
| Backward                  | 1.902 ms                  | 13.673 ms                 |
| Optimize                  | 209.093 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.991 us                 | 3.278 ms                  |
| AfterBackward             | 222.211 ms                | 359.078 ms                |
| BlockToStepN              | 218.293 us                | 561.553 us                |
| OneStep                   | 243.340 ms                | 390.433 ms                |
| E2E-100                   | 25.076 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:43.855830 3014345 grad_async_v2.h:257] pq is empty
========== Step 184 ========== 
========== Step 185 ========== 
W20240131 22:06:44.331845 3014345 grad_async_v2.h:257] pq is empty
========== Step 186 ========== 
E20240131 22:06:44.345217 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.138 us                | 268.860 us                |
| ProcessBack:Shuffle       | 221.285 ms                | 352.543 ms                |
| ProcessBack:UpdateCache   | 345.450 us                | 6.428 ms                  |
| ProcessBack:UpsertPq      | 46.015 us                 | 74.083 us                 |
| ProcessOneStep            | 222.176 ms                | 359.047 ms                |
| BlockToStepN              | 151.421 us                | 513.948 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:44.578892 3014345 grad_async_v2.h:257] pq is empty
========== Step 187 ========== 
W20240131 22:06:44.699461 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:06:44.824378 3014345 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
W20240131 22:06:45.069897 3014345 grad_async_v2.h:257] pq is empty
========== Step 189 ========== 
========== Step 190 ========== 
E20240131 22:06:45.345168 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 191 ========== 
W20240131 22:06:45.796110 3014345 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
W20240131 22:06:45.796651 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 193 ========== 
W20240131 22:06:46.215296 3014345 grad_async_v2.h:257] pq is empty
========== Step 194 ========== 
E20240131 22:06:46.345355 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:46.524946 3014345 grad_async_v2.h:257] pq is empty
========== Step 195 ========== 
W20240131 22:06:46.782939 3014345 grad_async_v2.h:257] pq is empty
========== Step 196 ========== 
W20240131 22:06:46.902987 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:06:47.028331 3014345 grad_async_v2.h:257] pq is empty
========== Step 197 ========== 
W20240131 22:06:47.271256 3014345 grad_async_v2.h:257] pq is empty
========== Step 198 ========== 
E20240131 22:06:47.345391 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 22:06:47.522941 3014345 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
W20240131 22:06:47.762163 3014345 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 24.445, per_step: 0.242034
Step199:rank1, time: 24.445, per_step: 0.242034
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.999 us                | 269.481 us                |
| GenInput                  | 18.242 ms                 | 32.090 ms                 |
| NN                        | 626.564 us                | 6.021 ms                  |
| Forward                   | 971.317 us                | 6.424 ms                  |
| Backward                  | 1.902 ms                  | 13.673 ms                 |
| Optimize                  | 209.808 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.965 us                 | 3.278 ms                  |
| AfterBackward             | 222.253 ms                | 359.078 ms                |
| BlockToStepN              | 225.449 us                | 561.553 us                |
| OneStep                   | 243.713 ms                | 390.433 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 22:06:48.013087 3014345 grad_async_v2.h:257] pq is empty
========== Step 201 ========== 
W20240131 22:06:48.016088 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 203 ========== 
E20240131 22:06:48.345454 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 204 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.747 us                | 269.481 us                |
| GenInput                  | 18.289 ms                 | 32.090 ms                 |
| NN                        | 624.657 us                | 6.021 ms                  |
| Forward                   | 970.840 us                | 6.424 ms                  |
| Backward                  | 1.902 ms                  | 13.673 ms                 |
| Optimize                  | 209.570 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.991 us                 | 3.278 ms                  |
| AfterBackward             | 222.253 ms                | 359.078 ms                |
| BlockToStepN              | 226.132 us                | 561.553 us                |
| OneStep                   | 243.622 ms                | 390.433 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 205 ========== 
========== Step 206 ========== 
W20240131 22:06:49.083143 3014817 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 22:06:49.345090 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:06:49.386281 3014345 grad_async_v2.h:257] pq is empty
========== Step 207 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.385 us                | 5.761 ms                  |
| ProcessBack:Shuffle       | 221.817 ms                | 352.564 ms                |
| ProcessBack:UpdateCache   | 353.871 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 45.980 us                 | 80.015 us                 |
| ProcessOneStep            | 222.277 ms                | 359.047 ms                |
| BlockToStepN              | 162.486 us                | 513.948 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:49.675580 3014345 grad_async_v2.h:257] pq is empty
========== Step 208 ========== 
W20240131 22:06:49.895026 3014345 grad_async_v2.h:257] pq is empty
========== Step 209 ========== 
W20240131 22:06:50.146028 3014345 grad_async_v2.h:257] pq is empty
========== Step 210 ========== 
W20240131 22:06:50.152421 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 211 ========== 
========== Step 212 ========== 
E20240131 22:06:50.345386 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:50.592339 3014345 grad_async_v2.h:257] pq is empty
========== Step 213 ========== 
W20240131 22:06:50.979099 3014345 grad_async_v2.h:257] pq is empty
========== Step 214 ========== 
W20240131 22:06:51.218808 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:06:51.292923 3014345 grad_async_v2.h:257] pq is empty
========== Step 215 ========== 
E20240131 22:06:51.345213 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:51.567018 3014345 grad_async_v2.h:257] pq is empty
========== Step 216 ========== 
W20240131 22:06:51.822841 3014345 grad_async_v2.h:257] pq is empty
========== Step 217 ========== 
W20240131 22:06:52.070678 3014345 grad_async_v2.h:257] pq is empty
========== Step 218 ========== 
W20240131 22:06:52.341147 3014345 grad_async_v2.h:257] pq is empty
========== Step 219 ========== 
W20240131 22:06:52.344080 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 22:06:52.345321 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 22:06:52.411803 3014345 grad_async_v2.h:257] pq is empty
========== Step 220 ========== 
========== Step 221 ========== 
W20240131 22:06:53.045614 3014345 grad_async_v2.h:257] pq is empty
========== Step 222 ========== 
W20240131 22:06:53.296118 3014345 grad_async_v2.h:257] pq is empty
========== Step 223 ========== 
E20240131 22:06:53.345022 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:53.410070 3014817 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:06:53.535804 3014345 grad_async_v2.h:257] pq is empty
========== Step 224 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.679 us                | 269.481 us                |
| GenInput                  | 18.367 ms                 | 32.090 ms                 |
| NN                        | 622.988 us                | 6.021 ms                  |
| Forward                   | 967.026 us                | 6.424 ms                  |
| Backward                  | 1.900 ms                  | 13.673 ms                 |
| Optimize                  | 207.186 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.991 us                 | 3.278 ms                  |
| AfterBackward             | 222.463 ms                | 359.078 ms                |
| BlockToStepN              | 239.873 us                | 1.183 ms                  |
| OneStep                   | 244.020 ms                | 390.771 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:53.783987 3014345 grad_async_v2.h:257] pq is empty
========== Step 225 ========== 
W20240131 22:06:53.992899 3014345 grad_async_v2.h:257] pq is empty
========== Step 226 ========== 
W20240131 22:06:54.231611 3014345 grad_async_v2.h:257] pq is empty
========== Step 227 ========== 
E20240131 22:06:54.345016 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:54.465582 3014345 grad_async_v2.h:257] pq is empty
========== Step 228 ========== 
W20240131 22:06:54.468076 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.130 us                | 1.622 ms                  |
| ProcessBack:Shuffle       | 221.846 ms                | 352.564 ms                |
| ProcessBack:UpdateCache   | 358.710 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 45.480 us                 | 93.351 us                 |
| ProcessOneStep            | 222.426 ms                | 359.047 ms                |
| BlockToStepN              | 169.966 us                | 513.948 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:54.724399 3014345 grad_async_v2.h:257] pq is empty
========== Step 229 ========== 
W20240131 22:06:54.901533 3014345 grad_async_v2.h:257] pq is empty
========== Step 230 ========== 
W20240131 22:06:55.109298 3014345 grad_async_v2.h:257] pq is empty
========== Step 231 ========== 
W20240131 22:06:55.434024 3014345 grad_async_v2.h:257] pq is empty
========== Step 232 ========== 
E20240131 22:06:55.434984 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 233 ========== 
W20240131 22:06:55.563153 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 234 ========== 
W20240131 22:06:55.861984 3014345 grad_async_v2.h:257] pq is empty
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
E20240131 22:06:56.434046 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=94
W20240131 22:06:56.745203 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
E20240131 22:06:57.434530 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:06:57.585909 3014345 grad_async_v2.h:257] pq is empty
========== Step 241 ========== 
W20240131 22:06:57.827051 3014345 grad_async_v2.h:257] pq is empty
========== Step 242 ========== 
W20240131 22:06:57.827595 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 22:06:58.066030 3014345 grad_async_v2.h:257] pq is empty
========== Step 243 ========== 
========== Step 244 ========== 
E20240131 22:06:58.434139 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:06:58.550503 3014345 grad_async_v2.h:257] pq is empty
========== Step 245 ========== 
========== Step 246 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.441 us                | 269.481 us                |
| GenInput                  | 18.397 ms                 | 32.090 ms                 |
| NN                        | 621.080 us                | 6.021 ms                  |
| Forward                   | 957.489 us                | 6.424 ms                  |
| Backward                  | 1.888 ms                  | 13.673 ms                 |
| Optimize                  | 205.994 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.935 us                 | 3.278 ms                  |
| AfterBackward             | 222.453 ms                | 359.279 ms                |
| BlockToStepN              | 250.022 us                | 4.641 ms                  |
| OneStep                   | 243.861 ms                | 390.771 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:58.964762 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 247 ========== 
W20240131 22:06:59.339623 3014345 grad_async_v2.h:257] pq is empty
========== Step 248 ========== 
E20240131 22:06:59.434026 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.661 us                | 983.653 us                |
| ProcessBack:Shuffle       | 221.948 ms                | 352.674 ms                |
| ProcessBack:UpdateCache   | 370.800 us                | 6.523 ms                  |
| ProcessBack:UpsertPq      | 45.183 us                 | 93.351 us                 |
| ProcessOneStep            | 222.429 ms                | 359.102 ms                |
| BlockToStepN              | 178.283 us                | 4.563 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:06:59.586567 3014345 grad_async_v2.h:257] pq is empty
========== Step 249 ========== 
========== Step 250 ========== 
W20240131 22:06:59.827260 3014345 grad_async_v2.h:257] pq is empty
========== Step 251 ========== 
W20240131 22:07:00.175096 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 252 ========== 
E20240131 22:07:00.434067 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:00.522302 3014345 grad_async_v2.h:257] pq is empty
========== Step 253 ========== 
W20240131 22:07:00.586669 3014345 grad_async_v2.h:257] pq is empty
========== Step 254 ========== 
========== Step 255 ========== 
W20240131 22:07:01.235733 3014345 grad_async_v2.h:257] pq is empty
========== Step 256 ========== 
W20240131 22:07:01.236209 3014817 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 257 ========== 
E20240131 22:07:01.434041 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
========== Step 258 ========== 
W20240131 22:07:01.923099 3014345 grad_async_v2.h:257] pq is empty
========== Step 259 ========== 
W20240131 22:07:02.249881 3014345 grad_async_v2.h:257] pq is empty
========== Step 260 ========== 
W20240131 22:07:02.256279 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 261 ========== 
E20240131 22:07:02.434088 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 262 ========== 
========== Step 263 ========== 
W20240131 22:07:03.336009 3014345 grad_async_v2.h:257] pq is empty
========== Step 264 ========== 
W20240131 22:07:03.336650 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:07:03.434170 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:03.576853 3014345 grad_async_v2.h:257] pq is empty
========== Step 265 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.879 us                | 269.481 us                |
| GenInput                  | 18.397 ms                 | 30.659 ms                 |
| NN                        | 622.988 us                | 4.023 ms                  |
| Forward                   | 969.887 us                | 6.335 ms                  |
| Backward                  | 1.889 ms                  | 13.673 ms                 |
| Optimize                  | 205.994 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.962 us                 | 3.046 ms                  |
| AfterBackward             | 222.924 ms                | 359.078 ms                |
| BlockToStepN              | 259.484 us                | 1.183 ms                  |
| OneStep                   | 244.050 ms                | 390.441 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:07:03.814528 3014345 grad_async_v2.h:257] pq is empty
========== Step 266 ========== 
W20240131 22:07:04.062904 3014345 grad_async_v2.h:257] pq is empty
========== Step 267 ========== 
W20240131 22:07:04.313880 3014345 grad_async_v2.h:257] pq is empty
========== Step 268 ========== 
E20240131 22:07:04.434064 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:07:04.465477 3014817 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.243 us                | 249.381 us                |
| ProcessBack:Shuffle       | 222.002 ms                | 352.674 ms                |
| ProcessBack:UpdateCache   | 369.981 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 45.485 us                 | 84.491 us                 |
| ProcessOneStep            | 222.690 ms                | 359.047 ms                |
| BlockToStepN              | 183.313 us                | 513.948 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:07:04.616881 3014345 grad_async_v2.h:257] pq is empty
========== Step 269 ========== 
W20240131 22:07:04.879516 3014345 grad_async_v2.h:257] pq is empty
========== Step 270 ========== 
========== Step 271 ========== 
W20240131 22:07:05.380436 3014345 grad_async_v2.h:257] pq is empty
========== Step 272 ========== 
========== Step 273 ========== 
E20240131 22:07:05.434065 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:07:05.509407 3014817 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 274 ========== 
W20240131 22:07:06.051856 3014345 grad_async_v2.h:257] pq is empty
========== Step 275 ========== 
W20240131 22:07:06.364480 3014345 grad_async_v2.h:257] pq is empty
========== Step 276 ========== 
E20240131 22:07:06.434026 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:06.610360 3014345 grad_async_v2.h:257] pq is empty
========== Step 277 ========== 
W20240131 22:07:06.610986 3014817 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:07:06.857088 3014345 grad_async_v2.h:257] pq is empty
========== Step 278 ========== 
W20240131 22:07:07.100054 3014345 grad_async_v2.h:257] pq is empty
========== Step 279 ========== 
W20240131 22:07:07.340904 3014345 grad_async_v2.h:257] pq is empty
========== Step 280 ========== 
E20240131 22:07:07.434042 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:07.583245 3014345 grad_async_v2.h:257] pq is empty
========== Step 281 ========== 
W20240131 22:07:07.698822 3014817 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 22:07:07.824818 3014345 grad_async_v2.h:257] pq is empty
========== Step 282 ========== 
W20240131 22:07:08.105023 3014345 grad_async_v2.h:257] pq is empty
========== Step 283 ========== 
W20240131 22:07:08.345227 3014345 grad_async_v2.h:257] pq is empty
========== Step 284 ========== 
E20240131 22:07:08.434288 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:08.643324 3014345 grad_async_v2.h:257] pq is empty
========== Step 285 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.971 us                | 269.481 us                |
| GenInput                  | 18.367 ms                 | 30.659 ms                 |
| NN                        | 623.465 us                | 4.023 ms                  |
| Forward                   | 970.364 us                | 6.335 ms                  |
| Backward                  | 1.888 ms                  | 13.673 ms                 |
| Optimize                  | 205.994 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.934 us                 | 3.046 ms                  |
| AfterBackward             | 223.573 ms                | 359.078 ms                |
| BlockToStepN              | 261.066 us                | 1.183 ms                  |
| OneStep                   | 244.486 ms                | 390.441 ms                |
| E2E-100                   | 24.445 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 286 ========== 
W20240131 22:07:08.786556 3014817 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 287 ========== 
========== Step 288 ========== 
E20240131 22:07:09.434123 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.674 us                | 2.567 ms                  |
| ProcessBack:Shuffle       | 222.835 ms                | 352.727 ms                |
| ProcessBack:UpdateCache   | 368.083 us                | 6.515 ms                  |
| ProcessBack:UpsertPq      | 45.960 us                 | 93.351 us                 |
| ProcessOneStep            | 223.450 ms                | 359.047 ms                |
| BlockToStepN              | 193.155 us                | 513.948 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 289 ========== 
W20240131 22:07:09.841552 3014345 grad_async_v2.h:257] pq is empty
========== Step 290 ========== 
W20240131 22:07:09.848596 3014817 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:07:10.085502 3014345 grad_async_v2.h:257] pq is empty
========== Step 291 ========== 
W20240131 22:07:10.329721 3014345 grad_async_v2.h:257] pq is empty
========== Step 292 ========== 
E20240131 22:07:10.434660 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:10.578570 3014345 grad_async_v2.h:257] pq is empty
========== Step 293 ========== 
W20240131 22:07:10.821527 3014345 grad_async_v2.h:257] pq is empty
========== Step 294 ========== 
W20240131 22:07:10.947784 3014817 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:07:11.077195 3014345 grad_async_v2.h:257] pq is empty
========== Step 295 ========== 
W20240131 22:07:11.313323 3014345 grad_async_v2.h:257] pq is empty
========== Step 296 ========== 
E20240131 22:07:11.434163 3014817 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:07:11.552942 3014345 grad_async_v2.h:257] pq is empty
========== Step 297 ========== 
W20240131 22:07:11.795527 3014345 grad_async_v2.h:257] pq is empty
========== Step 298 ========== 
W20240131 22:07:12.034653 3014345 grad_async_v2.h:257] pq is empty
========== Step 299 ========== 
W20240131 22:07:12.036049 3014817 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 22:07:12.272887 3014345 grad_async_v2.h:257] pq is empty
Step299:rank0, time: 24.511, per_step: 0.242680
Step299:rank1, time: 24.511, per_step: 0.242680
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.977 us                | 269.481 us                |
| GenInput                  | 18.397 ms                 | 30.659 ms                 |
| NN                        | 625.849 us                | 4.023 ms                  |
| Forward                   | 971.317 us                | 6.337 ms                  |
| Backward                  | 1.887 ms                  | 13.673 ms                 |
| Optimize                  | 205.994 us                | 393.867 us                |
| BarrierTimeBeforeRank0    | 16.934 us                 | 3.046 ms                  |
| AfterBackward             | 223.573 ms                | 359.279 ms                |
| BlockToStepN              | 263.456 us                | 1.183 ms                  |
| OneStep                   | 244.124 ms                | 390.441 ms                |
| E2E-100                   | 24.511 s                  | 25.076 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 22:07:12.273264 3014345 grad_async_v2.h:84] call StopThreads. PID = 3014345
W20240131 22:07:12.273272 3014345 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 22:07:12.273296 3014345 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 22:07:12.273300 3014345 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240131 22:07:12.273885 3014345 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [3014345 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f48c4b37bd0>
W20240131 22:07:15.071183 3014345 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
