WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 21:24:45.196308 2910744 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 21:24:45.197391 2910744 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [2910744 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f2e727251c0>==========
Worker 1 pid=2910892
Worker 2 pid=2910894
INFO [2910744 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2910892 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2910894 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2910896 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2910894 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2910896 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:24:48.773769 2910894 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 21:24:48.773772 2910896 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [2910892 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:24:48.775360 2910892 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [2910744 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:24:48.777802 2910744 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 21:24:50.894451 2910744 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 21:24:50.894451 2910892 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 21:24:50.894534 2910894 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 21:24:50.895117 2910892 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100048181000 7.629 MB
W20240131 21:24:50.895151 2910744 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100048924000 7.629 MB
W20240131 21:24:50.895176 2910894 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000490c7000 7.629 MB
W20240131 21:24:50.895217 2910744 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10004986a000 7.629 MB
W20240131 21:24:50.895224 2910892 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10004a00d000 7.629 MB
W20240131 21:24:50.895260 2910894 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10004a7b0000 7.629 MB
W20240131 21:24:50.895263 2910892 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004af53000 122.1 MB
W20240131 21:24:50.895275 2910744 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100052967000 122.1 MB
W20240131 21:24:50.895296 2910892 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10005a37b000 122.1 MB
W20240131 21:24:50.895299 2910744 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100061d8f000 122.1 MB
W20240131 21:24:50.895311 2910894 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a3000 122.1 MB
W20240131 21:24:50.895315 2910744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 21:24:50.895337 2910894 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000711b7000 122.1 MB
W20240131 21:24:50.895326 2910892 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 21:24:50.895269 2910896 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 21:24:50.895357 2910894 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 21:24:50.895974 2910744 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 21:24:50.895990 2910892 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 21:24:50.895995 2910894 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 21:24:50.896741 2910896 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100078bd9000 7.629 MB
W20240131 21:24:50.896862 2910896 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10007937c000 7.629 MB
W20240131 21:24:50.896921 2910896 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100079b1f000 122.1 MB
W20240131 21:24:50.896963 2910896 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100081533000 122.1 MB
W20240131 21:24:50.896991 2910896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 21:24:50.897358 2910896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
Worker 3 pid=2910896
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240131 21:24:54.512549 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100088f4b000 7.629 MB
W20240131 21:24:54.512694 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000896ee000 7.629 MB
W20240131 21:24:54.512724 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100089e91000 7.629 MB
W20240131 21:24:54.512753 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10008a634000 7.629 MB
W20240131 21:24:54.512774 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10008add7000 7.629 MB
W20240131 21:24:54.512799 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10008b57a000 7.629 MB
W20240131 21:24:54.512831 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10008bd1d000 7.629 MB
W20240131 21:24:54.512879 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10008c4c0000 7.629 MB
W20240131 21:24:54.512903 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10008cc63000 7.629 MB
W20240131 21:24:54.512948 2910896 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10008d406000 7.629 MB
W20240131 21:24:54.512977 2910896 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10008dba9000 80 B 
W20240131 21:24:54.512997 2910896 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10008dbab000 8 B 
W20240131 21:24:54.513012 2910896 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:24:54.513298 2910896 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 21:24:55.327987 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10008dbaf000 7.629 MB
W20240131 21:24:55.328125 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10008e352000 7.629 MB
W20240131 21:24:55.328146 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10008eaf5000 7.629 MB
W20240131 21:24:55.328168 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10008f298000 7.629 MB
W20240131 21:24:55.328187 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10008fa3b000 7.629 MB
W20240131 21:24:55.328212 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000901de000 7.629 MB
W20240131 21:24:55.328245 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100090981000 7.629 MB
W20240131 21:24:55.328287 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100091124000 7.629 MB
W20240131 21:24:55.328310 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000918c7000 7.629 MB
W20240131 21:24:55.328331 2910744 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10009206a000 7.629 MB
W20240131 21:24:55.328347 2910744 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10009280d000 80 B 
W20240131 21:24:55.328366 2910744 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10009280f000 8 B 
W20240131 21:24:55.328384 2910744 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:24:55.328604 2910744 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:24:55.335461 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100092813000 7.629 MB
W20240131 21:24:55.335597 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100092fb6000 7.629 MB
W20240131 21:24:55.335624 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100093759000 7.629 MB
W20240131 21:24:55.335649 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100093efc000 7.629 MB
W20240131 21:24:55.335671 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10009469f000 7.629 MB
W20240131 21:24:55.335691 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100094e42000 7.629 MB
W20240131 21:24:55.335719 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000955e5000 7.629 MB
W20240131 21:24:55.335752 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100095d88000 7.629 MB
W20240131 21:24:55.335786 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10009652b000 7.629 MB
W20240131 21:24:55.335822 2910894 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100096cce000 7.629 MB
W20240131 21:24:55.335845 2910894 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x100097471000 80 B 
W20240131 21:24:55.335866 2910894 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100097473000 8 B 
W20240131 21:24:55.335882 2910894 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:24:55.336102 2910894 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:24:55.348220 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100097477000 7.629 MB
W20240131 21:24:55.348356 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100097c1a000 7.629 MB
W20240131 21:24:55.348384 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000983bd000 7.629 MB
W20240131 21:24:55.348407 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100098b60000 7.629 MB
W20240131 21:24:55.348429 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100099303000 7.629 MB
W20240131 21:24:55.348446 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100099aa6000 7.629 MB
W20240131 21:24:55.348474 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10009a249000 7.629 MB
W20240131 21:24:55.348503 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10009a9ec000 7.629 MB
W20240131 21:24:55.348524 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009b18f000 7.629 MB
W20240131 21:24:55.348549 2910892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10009b932000 7.629 MB
W20240131 21:24:55.348570 2910892 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10009c0d5000 80 B 
W20240131 21:24:55.348600 2910892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10009c0d7000 8 B 
W20240131 21:24:55.348628 2910892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:24:55.348865 2910892 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:24:55.350121 2910744 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 21:24:55.350201 2910744 grad_base.h:184] Init GradProcessingBase done
I20240131 21:24:55.960327 2910744 grad_async_v2.h:42] Use main thread to update emb.
W20240131 21:24:55.960554 2910744 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 21:24:55.960562 2910744 kg_controller.h:84] Construct KGCacheController done
E20240131 21:24:56.275683 2910744 recstore.cc:66] init folly done
E20240131 21:24:56.275719 2910896 recstore.cc:66] init folly done
E20240131 21:24:56.275722 2910894 recstore.cc:66] init folly done
E20240131 21:24:56.275727 2910892 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 21:24:56.276989 2910744 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 21:24:57.059744 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 21:24:57.066426 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 21:24:58.066184 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:24:58.102449 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 21:24:59.066062 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240131 21:24:59.180861 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 21:25:00.066056 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
W20240131 21:25:00.270318 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 21:25:01.066102 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.901 us                | 249.542 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
I20240131 21:25:02.636647 2910744 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
Before Training
I20240131 21:25:02.636837 2910892 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240131 21:25:02.636898 2910894 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 21:25:02.637979 2910896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
W20240131 21:25:02.639823 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 21:25:02.639993 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 21:25:04.243538 2911614 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:25:04.525615 2910744 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
W20240131 21:25:04.834298 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [2910744 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2910894 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2910892 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2910896 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
E20240131 21:25:05.243628 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 181.439 us                | 208.729 us                |
| GenInput                  | 36.001 ms                 | 49.858 ms                 |
| NN                        | 764.370 us                | 180.526 ms                |
| Forward                   | 1.170 ms                  | 205.848 ms                |
| Backward                  | 2.139 ms                  | 247.333 ms                |
| Optimize                  | 242.710 us                | 11.509 ms                 |
| BarrierTimeBeforeRank0    | 542.185 us                | 21.051 ms                 |
| AfterBackward             | 57.739 ms                 | 1.377 s                   |
| BlockToStepN              | 86.054 us                 | 295.610 ms                |
| OneStep                   | 97.943 ms                 | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:06.175513 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 21:25:06.243257 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.512 us                | 352.120 us                |
| ProcessBack:Shuffle       | 53.788 ms                 | 279.711 ms                |
| ProcessBack:UpdateCache   | 3.749 ms                  | 785.145 ms                |
| ProcessBack:UpsertPq      | 40.281 us                 | 282.715 ms                |
| ProcessOneStep            | 57.697 ms                 | 1.377 s                   |
| BlockToStepN              | 31.616 us                 | 295.308 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 5 ========== 
E20240131 21:25:07.243214 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:25:07.290975 2910744 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 21:25:07.303203 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 7 ========== 
========== Step 8 ========== 
E20240131 21:25:08.243090 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240131 21:25:08.503934 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 21:25:08.753561 2910744 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
E20240131 21:25:09.243218 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:09.614492 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 13 ========== 
W20240131 21:25:10.008055 2910744 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
E20240131 21:25:10.243317 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=28
========== Step 15 ========== 
========== Step 16 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.801 us                | 208.729 us                |
| GenInput                  | 36.052 ms                 | 49.858 ms                 |
| NN                        | 675.678 us                | 180.526 ms                |
| Forward                   | 1.005 ms                  | 205.848 ms                |
| Backward                  | 2.139 ms                  | 247.333 ms                |
| Optimize                  | 201.941 us                | 11.509 ms                 |
| BarrierTimeBeforeRank0    | 267.519 us                | 21.051 ms                 |
| AfterBackward             | 112.306 ms                | 1.377 s                   |
| BlockToStepN              | 86.568 us                 | 295.610 ms                |
| OneStep                   | 155.133 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:10.820169 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240131 21:25:11.243113 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.128 us                | 255.195 us                |
| ProcessBack:Shuffle       | 111.355 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 1.207 ms                  | 785.145 ms                |
| ProcessBack:UpsertPq      | 45.639 us                 | 282.715 ms                |
| ProcessOneStep            | 112.287 ms                | 1.377 s                   |
| BlockToStepN              | 44.780 us                 | 295.308 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 17 ========== 
========== Step 18 ========== 
W20240131 21:25:12.160851 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240131 21:25:12.243304 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
========== Step 19 ========== 
W20240131 21:25:13.156555 2910744 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
E20240131 21:25:13.243108 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:25:13.433799 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 21:25:14.243037 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
========== Step 21 ========== 
W20240131 21:25:14.755860 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240131 21:25:15.243059 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.801 us                | 222.811 us                |
| GenInput                  | 36.224 ms                 | 49.858 ms                 |
| NN                        | 689.507 us                | 180.526 ms                |
| Forward                   | 1.061 ms                  | 205.848 ms                |
| Backward                  | 2.302 ms                  | 247.333 ms                |
| Optimize                  | 215.769 us                | 11.509 ms                 |
| BarrierTimeBeforeRank0    | 542.185 us                | 21.051 ms                 |
| AfterBackward             | 178.510 ms                | 1.377 s                   |
| BlockToStepN              | 99.292 us                 | 295.610 ms                |
| OneStep                   | 229.541 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:15.533912 2910744 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
W20240131 21:25:15.862141 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240131 21:25:16.243069 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.865 us                | 273.601 us                |
| ProcessBack:Shuffle       | 194.222 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 1.609 ms                  | 785.145 ms                |
| ProcessBack:UpsertPq      | 56.360 us                 | 282.715 ms                |
| ProcessOneStep            | 195.104 ms                | 1.377 s                   |
| BlockToStepN              | 53.523 us                 | 295.308 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:16.358695 2910744 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
W20240131 21:25:16.938203 2910744 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
W20240131 21:25:16.952041 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 21:25:17.008895 2910744 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
E20240131 21:25:17.243165 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=211
========== Step 27 ========== 
========== Step 28 ========== 
W20240131 21:25:17.959760 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240131 21:25:18.243122 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 29 ========== 
========== Step 30 ========== 
W20240131 21:25:19.209662 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 21:25:19.243325 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
========== Step 31 ========== 
E20240131 21:25:20.243162 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:20.286307 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.276 us                | 222.811 us                |
| GenInput                  | 36.001 ms                 | 49.858 ms                 |
| NN                        | 689.507 us                | 180.526 ms                |
| Forward                   | 1.061 ms                  | 205.848 ms                |
| Backward                  | 2.359 ms                  | 247.333 ms                |
| Optimize                  | 211.477 us                | 11.509 ms                 |
| BarrierTimeBeforeRank0    | 568.964 us                | 21.051 ms                 |
| AfterBackward             | 236.824 ms                | 1.377 s                   |
| BlockToStepN              | 120.402 us                | 295.610 ms                |
| OneStep                   | 276.627 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:20.416234 2910744 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
E20240131 21:25:21.243219 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.260 us                | 2.419 ms                  |
| ProcessBack:Shuffle       | 235.791 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 1.207 ms                  | 785.145 ms                |
| ProcessBack:UpsertPq      | 50.634 us                 | 282.715 ms                |
| ProcessOneStep            | 236.802 ms                | 1.377 s                   |
| BlockToStepN              | 63.382 us                 | 295.308 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:21.478080 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 35 ========== 
========== Step 36 ========== 
E20240131 21:25:22.243468 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
W20240131 21:25:22.555552 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 21:25:23.243325 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 40 ========== 
W20240131 21:25:23.647532 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 21:25:24.243294 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 41 ========== 
W20240131 21:25:24.654560 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 21:25:25.040261 2910744 grad_async_v2.h:257] pq is empty
========== Step 42 ========== 
E20240131 21:25:25.243047 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.339 us                | 222.811 us                |
| GenInput                  | 35.869 ms                 | 49.858 ms                 |
| NN                        | 689.507 us                | 180.526 ms                |
| Forward                   | 1.061 ms                  | 205.848 ms                |
| Backward                  | 2.338 ms                  | 247.333 ms                |
| Optimize                  | 205.278 us                | 11.509 ms                 |
| BarrierTimeBeforeRank0    | 568.964 us                | 21.051 ms                 |
| AfterBackward             | 266.630 ms                | 1.377 s                   |
| BlockToStepN              | 127.479 us                | 295.610 ms                |
| OneStep                   | 301.748 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:25.683845 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 21:25:25.970866 2910744 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
E20240131 21:25:26.243065 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.541 us                | 249.571 us                |
| ProcessBack:Shuffle       | 279.711 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.207 ms                  | 785.145 ms                |
| ProcessBack:UpsertPq      | 51.564 us                 | 282.715 ms                |
| ProcessOneStep            | 311.066 ms                | 1.377 s                   |
| BlockToStepN              | 72.962 us                 | 295.308 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:26.474191 2910744 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
========== Step 45 ========== 
W20240131 21:25:26.847465 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240131 21:25:27.243654 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:27.454214 2910744 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
W20240131 21:25:27.936576 2910744 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
W20240131 21:25:27.943030 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 21:25:28.243217 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240131 21:25:28.464613 2910744 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
W20240131 21:25:28.961520 2910744 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
W20240131 21:25:28.974123 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 21:25:29.147691 2910744 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
E20240131 21:25:29.243186 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
W20240131 21:25:30.038178 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240131 21:25:30.243104 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 55 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.339 us                | 236.820 us                |
| GenInput                  | 35.537 ms                 | 46.261 ms                 |
| NN                        | 639.439 us                | 1.535 ms                  |
| Forward                   | 998.497 us                | 1.979 ms                  |
| Backward                  | 2.302 ms                  | 8.314 ms                  |
| Optimize                  | 201.464 us                | 318.766 us                |
| BarrierTimeBeforeRank0    | 568.964 us                | 6.089 ms                  |
| AfterBackward             | 284.275 ms                | 1.314 s                   |
| BlockToStepN              | 141.566 us                | 430.985 us                |
| OneStep                   | 322.473 ms                | 1.356 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 56 ========== 
========== Step 57 ========== 
E20240131 21:25:31.243088 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.688 us                | 6.070 ms                  |
| ProcessBack:Shuffle       | 279.664 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 927.996 us                | 10.153 ms                 |
| ProcessBack:UpsertPq      | 50.634 us                 | 99.417 us                 |
| ProcessOneStep            | 284.248 ms                | 1.314 s                   |
| BlockToStepN              | 83.910 us                 | 304.824 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:31.433842 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240131 21:25:32.243014 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
========== Step 58 ========== 
========== Step 59 ========== 
W20240131 21:25:32.968700 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
========== Step 60 ========== 
E20240131 21:25:33.243067 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
E20240131 21:25:34.243096 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:34.343832 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
========== Step 64 ========== 
E20240131 21:25:35.243100 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.339 us                | 236.820 us                |
| GenInput                  | 35.537 ms                 | 46.261 ms                 |
| NN                        | 663.757 us                | 2.035 ms                  |
| Forward                   | 999.928 us                | 2.779 ms                  |
| Backward                  | 2.305 ms                  | 8.314 ms                  |
| Optimize                  | 201.941 us                | 338.793 us                |
| BarrierTimeBeforeRank0    | 542.185 us                | 6.089 ms                  |
| AfterBackward             | 276.409 ms                | 1.314 s                   |
| BlockToStepN              | 144.983 us                | 430.985 us                |
| OneStep                   | 318.012 ms                | 1.356 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 65 ========== 
========== Step 66 ========== 
W20240131 21:25:35.992880 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 21:25:36.243043 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.196 us                | 236.605 us                |
| ProcessBack:Shuffle       | 275.340 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 1.101 ms                  | 10.153 ms                 |
| ProcessBack:UpsertPq      | 52.250 us                 | 99.417 us                 |
| ProcessOneStep            | 276.377 ms                | 1.314 s                   |
| BlockToStepN              | 90.103 us                 | 304.824 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
W20240131 21:25:37.181079 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240131 21:25:37.243005 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:37.473500 2910744 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
W20240131 21:25:38.238663 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240131 21:25:38.243398 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 21:25:38.836247 2910744 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=73, sample_step_cpp_seen_[rank]=72
E20240131 21:25:39.243050 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:39.362248 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
========== Step 74 ========== 
E20240131 21:25:40.243106 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.276 us                | 5.871 ms                  |
| GenInput                  | 35.537 ms                 | 49.118 ms                 |
| NN                        | 663.757 us                | 2.035 ms                  |
| Forward                   | 999.928 us                | 2.871 ms                  |
| Backward                  | 2.308 ms                  | 10.191 ms                 |
| Optimize                  | 201.941 us                | 347.137 us                |
| BarrierTimeBeforeRank0    | 438.048 us                | 6.089 ms                  |
| AfterBackward             | 266.630 ms                | 1.377 s                   |
| BlockToStepN              | 156.158 us                | 463.475 us                |
| OneStep                   | 301.748 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:40.396577 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 21:25:40.758441 2910744 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
W20240131 21:25:41.245334 2910744 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
E20240131 21:25:41.257725 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.472 us                | 657.103 us                |
| ProcessBack:Shuffle       | 275.340 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 52.447 us                 | 102.651 us                |
| ProcessOneStep            | 276.377 ms                | 1.377 s                   |
| BlockToStepN              | 97.878 us                 | 342.354 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:41.322582 2910744 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
========== Step 78 ========== 
W20240131 21:25:41.623211 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 79 ========== 
E20240131 21:25:42.257146 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:25:42.809386 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240131 21:25:43.180526 2910744 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
E20240131 21:25:43.257102 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:25:43.357348 2910744 grad_async_v2.h:257] pq is empty
========== Step 81 ========== 
W20240131 21:25:43.900157 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 21:25:44.025074 2910744 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
E20240131 21:25:44.257138 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:44.356681 2910744 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
========== Step 84 ========== 
W20240131 21:25:44.909240 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 85 ========== 
E20240131 21:25:45.257036 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.801 us                | 5.871 ms                  |
| GenInput                  | 35.546 ms                 | 49.118 ms                 |
| NN                        | 663.757 us                | 2.035 ms                  |
| Forward                   | 999.928 us                | 2.871 ms                  |
| Backward                  | 2.302 ms                  | 10.191 ms                 |
| Optimize                  | 201.941 us                | 471.830 us                |
| BarrierTimeBeforeRank0    | 397.353 us                | 6.089 ms                  |
| AfterBackward             | 284.275 ms                | 1.377 s                   |
| BlockToStepN              | 163.708 us                | 463.475 us                |
| OneStep                   | 322.473 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:45.701282 2910744 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
W20240131 21:25:46.196599 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 21:25:46.257755 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.870 us                | 2.017 ms                  |
| ProcessBack:Shuffle       | 279.664 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 52.447 us                 | 102.651 us                |
| ProcessOneStep            | 284.248 ms                | 1.377 s                   |
| BlockToStepN              | 103.453 us                | 431.174 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:46.773998 2910744 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
E20240131 21:25:47.257201 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:47.328333 2910744 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
W20240131 21:25:47.339900 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 21:25:47.821528 2910744 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
E20240131 21:25:48.257105 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
========== Step 90 ========== 
W20240131 21:25:48.339653 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 91 ========== 
========== Step 92 ========== 
E20240131 21:25:49.257344 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:49.516100 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240131 21:25:49.923386 2910744 grad_async_v2.h:257] pq is empty
========== Step 93 ========== 
E20240131 21:25:50.257035 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.767 us                | 5.871 ms                  |
| GenInput                  | 35.537 ms                 | 49.118 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.034 ms                  | 2.871 ms                  |
| Backward                  | 2.302 ms                  | 10.191 ms                 |
| Optimize                  | 202.894 us                | 471.830 us                |
| BarrierTimeBeforeRank0    | 284.322 us                | 6.089 ms                  |
| AfterBackward             | 311.107 ms                | 1.377 s                   |
| BlockToStepN              | 169.862 us                | 627.625 us                |
| OneStep                   | 348.175 ms                | 2.183 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:50.444288 2910744 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
W20240131 21:25:50.608672 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 97 ========== 
========== Step 98 ========== 
E20240131 21:25:51.257165 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.427 us                | 17.741 ms                 |
| ProcessBack:Shuffle       | 279.711 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 53.429 us                 | 102.651 us                |
| ProcessOneStep            | 284.619 ms                | 1.377 s                   |
| BlockToStepN              | 111.458 us                | 431.174 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 99 ========== 
W20240131 21:25:52.236575 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 21:25:52.257025 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
Step99:rank0, time: 61.425, per_step: 0.614245
Step99:rank3, time: 61.425, per_step: 0.614245
Step99:rank1, time: 61.425, per_step: 0.614246
Step99:rank2, time: 61.425, per_step: 0.614247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.767 us                | 5.871 ms                  |
| GenInput                  | 35.537 ms                 | 49.118 ms                 |
| NN                        | 665.665 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 2.871 ms                  |
| Backward                  | 2.302 ms                  | 11.084 ms                 |
| Optimize                  | 201.941 us                | 471.830 us                |
| BarrierTimeBeforeRank0    | 284.442 us                | 6.089 ms                  |
| AfterBackward             | 284.644 ms                | 1.377 s                   |
| BlockToStepN              | 187.234 us                | 8.740 ms                  |
| OneStep                   | 331.711 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 21:25:53.257020 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:25:53.425524 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
========== Step 101 ========== 
========== Step 102 ========== 
E20240131 21:25:54.257019 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 21:25:54.519253 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240131 21:25:55.004575 2910744 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
E20240131 21:25:55.257112 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.810 us                | 5.871 ms                  |
| GenInput                  | 35.503 ms                 | 49.118 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.034 ms                  | 2.871 ms                  |
| Backward                  | 2.305 ms                  | 11.084 ms                 |
| Optimize                  | 202.894 us                | 471.830 us                |
| BarrierTimeBeforeRank0    | 379.552 us                | 6.089 ms                  |
| AfterBackward             | 311.107 ms                | 1.377 s                   |
| BlockToStepN              | 190.533 us                | 8.740 ms                  |
| OneStep                   | 348.175 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:55.490579 2910744 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
========== Step 105 ========== 
W20240131 21:25:55.608269 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240131 21:25:56.257403 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.618 us                | 1.519 ms                  |
| ProcessBack:Shuffle       | 283.609 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.148 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 54.763 us                 | 102.651 us                |
| ProcessOneStep            | 311.066 ms                | 1.377 s                   |
| BlockToStepN              | 122.952 us                | 8.692 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:25:56.467653 2910744 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
========== Step 107 ========== 
W20240131 21:25:56.613813 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240131 21:25:56.896826 2910744 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
========== Step 109 ========== 
E20240131 21:25:57.257045 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 21:25:57.797734 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 110 ========== 
W20240131 21:25:58.246275 2910744 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
E20240131 21:25:58.257314 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
W20240131 21:25:58.874928 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240131 21:25:59.257297 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
W20240131 21:26:00.014662 2910744 grad_async_v2.h:257] pq is empty
========== Step 115 ========== 
========== Step 116 ========== 
W20240131 21:26:00.139806 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240131 21:26:00.257051 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.982 us                | 5.871 ms                  |
| GenInput                  | 35.399 ms                 | 49.118 ms                 |
| NN                        | 665.665 us                | 2.133 ms                  |
| Forward                   | 1.027 ms                  | 8.727 ms                  |
| Backward                  | 2.279 ms                  | 16.162 ms                 |
| Optimize                  | 202.894 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 284.442 us                | 6.089 ms                  |
| AfterBackward             | 284.644 ms                | 1.377 s                   |
| BlockToStepN              | 208.164 us                | 8.740 ms                  |
| OneStep                   | 331.711 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 117 ========== 
W20240131 21:26:01.251570 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
E20240131 21:26:01.257380 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.568 us                | 5.746 ms                  |
| ProcessBack:Shuffle       | 283.609 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 55.183 us                 | 102.651 us                |
| ProcessOneStep            | 298.962 ms                | 1.377 s                   |
| BlockToStepN              | 145.086 us                | 8.692 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:02.208489 2910744 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
E20240131 21:26:02.257169 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:02.316188 2910744 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
W20240131 21:26:02.493752 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 120 ========== 
========== Step 121 ========== 
E20240131 21:26:03.257364 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:03.591066 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240131 21:26:04.257195 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=34
========== Step 122 ========== 
W20240131 21:26:04.610208 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 21:26:04.889928 2910744 grad_async_v2.h:257] pq is empty
========== Step 123 ========== 
========== Step 124 ========== 
E20240131 21:26:05.260114 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.619 us                | 5.871 ms                  |
| GenInput                  | 35.399 ms                 | 49.118 ms                 |
| NN                        | 675.678 us                | 2.133 ms                  |
| Forward                   | 1.034 ms                  | 8.727 ms                  |
| Backward                  | 2.305 ms                  | 16.162 ms                 |
| Optimize                  | 204.086 us                | 550.985 us                |
| BarrierTimeBeforeRank0    | 309.954 us                | 6.089 ms                  |
| AfterBackward             | 311.107 ms                | 1.377 s                   |
| BlockToStepN              | 214.083 us                | 8.740 ms                  |
| OneStep                   | 348.175 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:05.613910 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 21:26:05.871557 2910744 grad_async_v2.h:257] pq is empty
========== Step 125 ========== 
E20240131 21:26:06.260025 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 138.635 us                | 1.122 ms                  |
| ProcessBack:Shuffle       | 310.280 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.101 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 55.183 us                 | 102.651 us                |
| ProcessOneStep            | 314.993 ms                | 1.377 s                   |
| BlockToStepN              | 151.198 us                | 8.692 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:06.377799 2910744 grad_async_v2.h:257] pq is empty
========== Step 126 ========== 
W20240131 21:26:06.626974 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 21:26:06.876634 2910744 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
E20240131 21:26:07.260928 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:07.432472 2910744 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
W20240131 21:26:07.673303 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 21:26:07.921582 2910744 grad_async_v2.h:257] pq is empty
========== Step 129 ========== 
E20240131 21:26:08.260159 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
========== Step 130 ========== 
W20240131 21:26:08.759851 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 21:26:08.895414 2910744 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
========== Step 132 ========== 
E20240131 21:26:09.260052 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:26:09.855782 2910744 grad_async_v2.h:257] pq is empty
========== Step 133 ========== 
W20240131 21:26:09.862895 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:26:10.260138 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:10.339404 2910744 grad_async_v2.h:257] pq is empty
========== Step 134 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.078 us                | 5.871 ms                  |
| GenInput                  | 33.823 ms                 | 49.118 ms                 |
| NN                        | 677.347 us                | 2.133 ms                  |
| Forward                   | 1.034 ms                  | 8.727 ms                  |
| Backward                  | 2.307 ms                  | 16.162 ms                 |
| Optimize                  | 204.802 us                | 550.985 us                |
| BarrierTimeBeforeRank0    | 320.901 us                | 6.089 ms                  |
| AfterBackward             | 335.910 ms                | 1.377 s                   |
| BlockToStepN              | 217.083 us                | 8.740 ms                  |
| OneStep                   | 378.260 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:10.828713 2910744 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
W20240131 21:26:10.961299 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 21:26:11.260217 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.045 us                | 1.388 ms                  |
| ProcessBack:Shuffle       | 334.517 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 965.735 us                | 13.642 ms                 |
| ProcessBack:UpsertPq      | 55.335 us                 | 102.651 us                |
| ProcessOneStep            | 359.680 ms                | 1.377 s                   |
| BlockToStepN              | 161.138 us                | 8.692 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:11.324327 2910744 grad_async_v2.h:257] pq is empty
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
W20240131 21:26:12.073379 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 21:26:12.260063 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 139 ========== 
W20240131 21:26:13.166999 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 21:26:13.260123 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:13.334447 2910744 grad_async_v2.h:257] pq is empty
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
W20240131 21:26:14.040102 2910744 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
W20240131 21:26:14.195266 2910744 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
W20240131 21:26:14.230722 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
========== Step 146 ========== 
E20240131 21:26:14.260008 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
E20240131 21:26:15.260290 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.249 us                | 5.871 ms                  |
| GenInput                  | 34.629 ms                 | 49.118 ms                 |
| NN                        | 675.678 us                | 2.133 ms                  |
| Forward                   | 1.027 ms                  | 8.727 ms                  |
| Backward                  | 2.302 ms                  | 16.162 ms                 |
| Optimize                  | 204.802 us                | 550.985 us                |
| BarrierTimeBeforeRank0    | 284.442 us                | 6.089 ms                  |
| AfterBackward             | 318.554 ms                | 1.377 s                   |
| BlockToStepN              | 230.512 us                | 8.740 ms                  |
| OneStep                   | 364.394 ms                | 2.183 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 147 ========== 
========== Step 148 ========== 
W20240131 21:26:15.785248 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240131 21:26:16.260130 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.610 us                | 1.211 ms                  |
| ProcessBack:Shuffle       | 310.473 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 918.354 us                | 13.642 ms                 |
| ProcessBack:UpsertPq      | 55.668 us                 | 102.651 us                |
| ProcessOneStep            | 318.532 ms                | 1.377 s                   |
| BlockToStepN              | 171.126 us                | 8.692 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 149 ========== 
========== Step 150 ========== 
E20240131 21:26:17.260229 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:17.468509 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240131 21:26:18.260104 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=28
========== Step 151 ========== 
W20240131 21:26:18.590739 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
========== Step 152 ========== 
E20240131 21:26:19.260586 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 153 ========== 
========== Step 154 ========== 
W20240131 21:26:19.593547 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 155 ========== 
E20240131 21:26:20.260053 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.767 us                | 5.871 ms                  |
| GenInput                  | 34.629 ms                 | 47.907 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.307 ms                  | 14.850 ms                 |
| Optimize                  | 205.278 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 320.901 us                | 6.017 ms                  |
| AfterBackward             | 326.706 ms                | 1.314 s                   |
| BlockToStepN              | 247.903 us                | 671.100 us                |
| OneStep                   | 371.329 ms                | 1.356 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:21.016448 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 156 ========== 
E20240131 21:26:21.260315 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.745 us                | 1.959 ms                  |
| ProcessBack:Shuffle       | 317.659 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 965.735 us                | 13.192 ms                 |
| ProcessBack:UpsertPq      | 56.921 us                 | 100.057 us                |
| ProcessOneStep            | 326.681 ms                | 1.314 s                   |
| BlockToStepN              | 176.742 us                | 595.787 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:22.101941 2910744 grad_async_v2.h:257] pq is empty
========== Step 157 ========== 
W20240131 21:26:22.113596 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 21:26:22.260303 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 158 ========== 
========== Step 159 ========== 
W20240131 21:26:23.222292 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 21:26:23.260105 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:26:23.608224 2910744 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
W20240131 21:26:24.128691 2910744 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
W20240131 21:26:24.258028 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 21:26:24.260100 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
E20240131 21:26:25.260383 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:25.350944 2910744 grad_async_v2.h:257] pq is empty
========== Step 165 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.810 us                | 5.871 ms                  |
| GenInput                  | 34.629 ms                 | 47.907 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.309 ms                  | 14.850 ms                 |
| Optimize                  | 206.470 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 368.678 us                | 6.017 ms                  |
| AfterBackward             | 335.910 ms                | 1.314 s                   |
| BlockToStepN              | 255.329 us                | 671.100 us                |
| OneStep                   | 378.260 ms                | 1.356 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:25.486593 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 166 ========== 
========== Step 167 ========== 
W20240131 21:26:26.074579 2910744 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
E20240131 21:26:26.260107 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.478 us                | 11.584 ms                 |
| ProcessBack:Shuffle       | 310.473 ms                | 1.298 s                   |
| ProcessBack:UpdateCache   | 965.735 us                | 13.642 ms                 |
| ProcessBack:UpsertPq      | 56.830 us                 | 100.796 us                |
| ProcessOneStep            | 318.532 ms                | 1.314 s                   |
| BlockToStepN              | 191.993 us                | 900.407 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:26.577770 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 171 ========== 
========== Step 172 ========== 
E20240131 21:26:27.260457 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:28.221925 2910744 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
E20240131 21:26:28.260270 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
W20240131 21:26:28.783831 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 21:26:29.260243 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 177 ========== 
E20240131 21:26:30.152299 2910744 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=177, sample_step_cpp_seen_[rank]=176
E20240131 21:26:30.260015 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:30.269877 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.209 us                | 5.871 ms                  |
| GenInput                  | 34.776 ms                 | 47.907 ms                 |
| NN                        | 663.996 us                | 2.035 ms                  |
| Forward                   | 1.014 ms                  | 6.751 ms                  |
| Backward                  | 2.305 ms                  | 14.850 ms                 |
| Optimize                  | 205.278 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 397.353 us                | 6.017 ms                  |
| AfterBackward             | 318.554 ms                | 1.329 s                   |
| BlockToStepN              | 266.271 us                | 938.630 us                |
| OneStep                   | 364.394 ms                | 1.376 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 178 ========== 
W20240131 21:26:30.550381 2910744 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
E20240131 21:26:31.260071 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.739 us                | 11.378 ms                 |
| ProcessBack:Shuffle       | 310.473 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 992.899 us                | 13.642 ms                 |
| ProcessBack:UpsertPq      | 56.921 us                 | 100.796 us                |
| ProcessOneStep            | 318.532 ms                | 1.329 s                   |
| BlockToStepN              | 197.297 us                | 900.407 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 180 ========== 
W20240131 21:26:31.385895 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
========== Step 181 ========== 
========== Step 182 ========== 
E20240131 21:26:32.260107 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:32.399737 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
E20240131 21:26:33.260102 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240131 21:26:33.414413 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 186 ========== 
E20240131 21:26:34.260052 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 187 ========== 
W20240131 21:26:34.879361 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240131 21:26:35.076020 2910744 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
E20240131 21:26:35.260057 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.813 us                | 5.871 ms                  |
| GenInput                  | 34.791 ms                 | 47.907 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.308 ms                  | 14.850 ms                 |
| Optimize                  | 207.663 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 397.353 us                | 6.017 ms                  |
| AfterBackward             | 315.023 ms                | 1.329 s                   |
| BlockToStepN              | 277.593 us                | 1.111 ms                  |
| OneStep                   | 352.497 ms                | 1.376 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 189 ========== 
W20240131 21:26:36.117449 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 21:26:36.260120 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.142 us                | 6.085 ms                  |
| ProcessBack:Shuffle       | 310.473 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.023 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 57.149 us                 | 100.796 us                |
| ProcessOneStep            | 318.532 ms                | 1.329 s                   |
| BlockToStepN              | 214.473 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:36.712697 2910744 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
========== Step 191 ========== 
E20240131 21:26:37.260352 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
========== Step 192 ========== 
W20240131 21:26:37.342974 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
W20240131 21:26:38.230980 2910744 grad_async_v2.h:257] pq is empty
========== Step 193 ========== 
E20240131 21:26:38.260202 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
W20240131 21:26:38.358426 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
E20240131 21:26:39.260010 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:26:39.563480 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 198 ========== 
W20240131 21:26:40.143460 2910744 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
E20240131 21:26:40.260100 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.810 us                | 5.871 ms                  |
| GenInput                  | 34.776 ms                 | 47.907 ms                 |
| NN                        | 667.810 us                | 2.035 ms                  |
| Forward                   | 1.026 ms                  | 6.751 ms                  |
| Backward                  | 2.302 ms                  | 14.850 ms                 |
| Optimize                  | 207.424 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 379.552 us                | 6.017 ms                  |
| AfterBackward             | 318.554 ms                | 1.329 s                   |
| BlockToStepN              | 283.246 us                | 1.111 ms                  |
| OneStep                   | 364.394 ms                | 1.376 s                   |
| E2E-100                   | 49.983 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
Step199:rank0, time: 47.999, per_step: 0.475238
Step199:rank1, time: 47.999, per_step: 0.475238
Step199:rank3, time: 47.999, per_step: 0.475238
Step199:rank2, time: 47.999, per_step: 0.475237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.810 us                | 5.871 ms                  |
| GenInput                  | 34.776 ms                 | 47.907 ms                 |
| NN                        | 667.810 us                | 2.035 ms                  |
| Forward                   | 1.026 ms                  | 6.751 ms                  |
| Backward                  | 2.302 ms                  | 14.850 ms                 |
| Optimize                  | 207.424 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 379.552 us                | 6.017 ms                  |
| AfterBackward             | 318.554 ms                | 1.329 s                   |
| BlockToStepN              | 283.246 us                | 1.111 ms                  |
| OneStep                   | 364.394 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 21:26:40.775624 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 21:26:41.260730 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.147 us                | 5.598 ms                  |
| ProcessBack:Shuffle       | 310.473 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.080 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 57.385 us                 | 100.796 us                |
| ProcessOneStep            | 318.532 ms                | 1.329 s                   |
| BlockToStepN              | 222.745 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 201 ========== 
W20240131 21:26:42.120579 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240131 21:26:42.260007 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:26:42.605286 2910744 grad_async_v2.h:257] pq is empty
========== Step 202 ========== 
W20240131 21:26:43.090426 2910744 grad_async_v2.h:257] pq is empty
========== Step 203 ========== 
W20240131 21:26:43.217458 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:26:43.260053 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 21:26:43.582453 2910744 grad_async_v2.h:257] pq is empty
========== Step 204 ========== 
W20240131 21:26:43.690346 2910744 grad_async_v2.h:257] pq is empty
========== Step 205 ========== 
========== Step 206 ========== 
E20240131 21:26:44.260177 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:44.324998 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240131 21:26:45.083146 2910744 grad_async_v2.h:257] pq is empty
========== Step 207 ========== 
E20240131 21:26:45.260212 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 208 ========== 
W20240131 21:26:45.331892 2911395 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.767 us                | 5.871 ms                  |
| GenInput                  | 34.776 ms                 | 47.907 ms                 |
| NN                        | 675.678 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.308 ms                  | 16.162 ms                 |
| Optimize                  | 207.663 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 397.353 us                | 6.017 ms                  |
| AfterBackward             | 326.706 ms                | 1.329 s                   |
| BlockToStepN              | 284.055 us                | 1.111 ms                  |
| OneStep                   | 371.329 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:46.052004 2910744 grad_async_v2.h:257] pq is empty
========== Step 209 ========== 
E20240131 21:26:46.260144 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.591 us                | 2.519 ms                  |
| ProcessBack:Shuffle       | 325.784 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.023 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 58.223 us                 | 100.796 us                |
| ProcessOneStep            | 335.886 ms                | 1.329 s                   |
| BlockToStepN              | 226.717 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 210 ========== 
W20240131 21:26:46.416712 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240131 21:26:46.926146 2910744 grad_async_v2.h:257] pq is empty
========== Step 211 ========== 
E20240131 21:26:47.260646 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:47.496487 2910744 grad_async_v2.h:257] pq is empty
========== Step 212 ========== 
W20240131 21:26:47.504503 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 21:26:47.935499 2910744 grad_async_v2.h:257] pq is empty
========== Step 213 ========== 
========== Step 214 ========== 
E20240131 21:26:48.260061 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:48.394258 2910744 grad_async_v2.h:257] pq is empty
========== Step 215 ========== 
W20240131 21:26:48.512857 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240131 21:26:49.260334 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:49.498688 2910744 grad_async_v2.h:257] pq is empty
========== Step 216 ========== 
W20240131 21:26:49.623293 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 21:26:49.995957 2910744 grad_async_v2.h:257] pq is empty
========== Step 217 ========== 
E20240131 21:26:50.260372 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.503 us                | 5.871 ms                  |
| GenInput                  | 34.239 ms                 | 47.907 ms                 |
| NN                        | 677.347 us                | 2.035 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.315 ms                  | 16.162 ms                 |
| Optimize                  | 208.378 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 400.422 us                | 6.017 ms                  |
| AfterBackward             | 344.310 ms                | 1.329 s                   |
| BlockToStepN              | 299.695 us                | 1.111 ms                  |
| OneStep                   | 382.913 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:50.482103 2910744 grad_async_v2.h:257] pq is empty
========== Step 218 ========== 
W20240131 21:26:50.743242 2910744 grad_async_v2.h:257] pq is empty
========== Step 219 ========== 
W20240131 21:26:50.759264 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 220 ========== 
W20240131 21:26:51.085858 2910744 grad_async_v2.h:257] pq is empty
========== Step 221 ========== 
========== Step 222 ========== 
E20240131 21:26:51.260046 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.369 us                | 11.674 ms                 |
| ProcessBack:Shuffle       | 325.784 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 995.196 us                | 13.642 ms                 |
| ProcessBack:UpsertPq      | 58.349 us                 | 100.796 us                |
| ProcessOneStep            | 335.886 ms                | 1.329 s                   |
| BlockToStepN              | 240.509 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 223 ========== 
========== Step 224 ========== 
W20240131 21:26:51.768961 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240131 21:26:52.260186 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:53.028412 2910744 grad_async_v2.h:257] pq is empty
========== Step 225 ========== 
E20240131 21:26:53.260090 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:53.266281 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240131 21:26:54.260088 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:54.271529 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
E20240131 21:26:55.260260 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.249 us                | 5.871 ms                  |
| GenInput                  | 33.823 ms                 | 47.907 ms                 |
| NN                        | 675.678 us                | 2.133 ms                  |
| Forward                   | 1.027 ms                  | 6.751 ms                  |
| Backward                  | 2.315 ms                  | 16.162 ms                 |
| Optimize                  | 207.663 us                | 541.449 us                |
| BarrierTimeBeforeRank0    | 359.955 us                | 6.017 ms                  |
| AfterBackward             | 340.671 ms                | 1.336 s                   |
| BlockToStepN              | 313.975 us                | 1.359 ms                  |
| OneStep                   | 382.573 ms                | 1.390 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:55.515952 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 230 ========== 
E20240131 21:26:56.260143 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.515 us                | 1.754 ms                  |
| ProcessBack:Shuffle       | 334.517 ms                | 1.308 s                   |
| ProcessBack:UpdateCache   | 1.077 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 58.379 us                 | 100.796 us                |
| ProcessOneStep            | 340.643 ms                | 1.336 s                   |
| BlockToStepN              | 245.197 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:26:56.601755 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 231 ========== 
E20240131 21:26:57.260704 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:26:57.522845 2910744 grad_async_v2.h:257] pq is empty
========== Step 232 ========== 
W20240131 21:26:57.653007 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 21:26:58.019389 2910744 grad_async_v2.h:257] pq is empty
========== Step 233 ========== 
========== Step 234 ========== 
E20240131 21:26:58.260154 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=54
========== Step 235 ========== 
W20240131 21:26:58.886175 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240131 21:26:59.260084 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 236 ========== 
========== Step 237 ========== 
W20240131 21:27:00.106619 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 21:27:00.260012 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.767 us                | 5.871 ms                  |
| GenInput                  | 33.634 ms                 | 47.907 ms                 |
| NN                        | 677.347 us                | 2.487 ms                  |
| Forward                   | 1.028 ms                  | 6.751 ms                  |
| Backward                  | 2.315 ms                  | 16.162 ms                 |
| Optimize                  | 208.139 us                | 541.449 us                |
| BarrierTimeBeforeRank0    | 359.955 us                | 6.017 ms                  |
| AfterBackward             | 344.310 ms                | 1.336 s                   |
| BlockToStepN              | 328.368 us                | 5.789 ms                  |
| OneStep                   | 382.913 ms                | 1.390 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:00.499120 2910744 grad_async_v2.h:257] pq is empty
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
E20240131 21:27:01.260088 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.872 us                | 2.611 ms                  |
| ProcessBack:Shuffle       | 334.517 ms                | 1.308 s                   |
| ProcessBack:UpdateCache   | 1.096 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 58.871 us                 | 100.796 us                |
| ProcessOneStep            | 340.643 ms                | 1.336 s                   |
| BlockToStepN              | 248.784 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:01.325371 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
E20240131 21:27:02.260175 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=87
W20240131 21:27:02.351178 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 244 ========== 
W20240131 21:27:02.606684 2910744 grad_async_v2.h:257] pq is empty
========== Step 245 ========== 
E20240131 21:27:03.260012 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 246 ========== 
W20240131 21:27:03.781562 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240131 21:27:04.260191 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 247 ========== 
W20240131 21:27:04.796006 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 248 ========== 
E20240131 21:27:05.260174 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.813 us                | 5.886 ms                  |
| GenInput                  | 33.823 ms                 | 47.907 ms                 |
| NN                        | 677.347 us                | 2.487 ms                  |
| Forward                   | 1.028 ms                  | 6.751 ms                  |
| Backward                  | 2.310 ms                  | 16.162 ms                 |
| Optimize                  | 208.139 us                | 541.449 us                |
| BarrierTimeBeforeRank0    | 359.955 us                | 6.017 ms                  |
| AfterBackward             | 340.671 ms                | 1.336 s                   |
| BlockToStepN              | 340.941 us                | 5.789 ms                  |
| OneStep                   | 382.573 ms                | 1.390 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 249 ========== 
W20240131 21:27:05.885004 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 21:27:06.260087 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.423 us                | 5.437 ms                  |
| ProcessBack:Shuffle       | 338.558 ms                | 1.308 s                   |
| ProcessBack:UpdateCache   | 1.096 ms                  | 13.642 ms                 |
| ProcessBack:UpsertPq      | 58.871 us                 | 100.796 us                |
| ProcessOneStep            | 344.260 ms                | 1.336 s                   |
| BlockToStepN              | 257.872 us                | 1.050 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:06.480829 2910744 grad_async_v2.h:257] pq is empty
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
W20240131 21:27:06.901350 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 253 ========== 
E20240131 21:27:07.260069 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 254 ========== 
E20240131 21:27:08.260079 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:27:08.283708 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
E20240131 21:27:09.260094 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:27:09.406613 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240131 21:27:09.534096 2910744 grad_async_v2.h:257] pq is empty
========== Step 260 ========== 
E20240131 21:27:10.260121 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.813 us                | 5.871 ms                  |
| GenInput                  | 34.047 ms                 | 47.334 ms                 |
| NN                        | 677.347 us                | 2.133 ms                  |
| Forward                   | 1.028 ms                  | 6.469 ms                  |
| Backward                  | 2.308 ms                  | 14.850 ms                 |
| Optimize                  | 207.901 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 284.442 us                | 3.874 ms                  |
| AfterBackward             | 326.706 ms                | 1.329 s                   |
| BlockToStepN              | 347.125 us                | 1.359 ms                  |
| OneStep                   | 371.329 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:10.828140 2910744 grad_async_v2.h:257] pq is empty
========== Step 261 ========== 
W20240131 21:27:10.852180 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240131 21:27:11.260272 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.741 us                | 5.677 ms                  |
| ProcessBack:Shuffle       | 319.805 ms                | 1.304 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.192 ms                 |
| ProcessBack:UpsertPq      | 58.728 us                 | 101.669 us                |
| ProcessOneStep            | 331.911 ms                | 1.329 s                   |
| BlockToStepN              | 265.550 us                | 947.334 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 262 ========== 
E20240131 21:27:12.260166 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 21:27:12.438963 2911395 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 263 ========== 
========== Step 264 ========== 
E20240131 21:27:13.260232 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
========== Step 265 ========== 
W20240131 21:27:13.355826 2910744 grad_async_v2.h:257] pq is empty
========== Step 266 ========== 
========== Step 267 ========== 
W20240131 21:27:13.624022 2911395 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
E20240131 21:27:14.260052 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:27:15.203817 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240131 21:27:15.260150 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.092 us                | 5.886 ms                  |
| GenInput                  | 34.047 ms                 | 47.334 ms                 |
| NN                        | 680.685 us                | 2.487 ms                  |
| Forward                   | 1.039 ms                  | 6.469 ms                  |
| Backward                  | 2.309 ms                  | 14.850 ms                 |
| Optimize                  | 208.139 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 284.239 us                | 3.874 ms                  |
| AfterBackward             | 326.185 ms                | 1.329 s                   |
| BlockToStepN              | 356.436 us                | 1.359 ms                  |
| OneStep                   | 365.831 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
E20240131 21:27:16.260164 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.957 us                | 3.484 ms                  |
| ProcessBack:Shuffle       | 318.749 ms                | 1.308 s                   |
| ProcessBack:UpdateCache   | 1.101 ms                  | 13.192 ms                 |
| ProcessBack:UpsertPq      | 58.728 us                 | 101.669 us                |
| ProcessOneStep            | 326.134 ms                | 1.329 s                   |
| BlockToStepN              | 282.386 us                | 947.334 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 274 ========== 
========== Step 275 ========== 
E20240131 21:27:17.260113 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
========== Step 276 ========== 
W20240131 21:27:17.371788 2911395 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
========== Step 277 ========== 
========== Step 278 ========== 
E20240131 21:27:18.263700 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=39
W20240131 21:27:18.539945 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
========== Step 279 ========== 
E20240131 21:27:19.263168 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=34
W20240131 21:27:19.307224 2910744 grad_async_v2.h:257] pq is empty
========== Step 280 ========== 
W20240131 21:27:19.562791 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
========== Step 281 ========== 
E20240131 21:27:20.100057 2910744 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=281, sample_step_cpp_seen_[rank]=280
E20240131 21:27:20.263144 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.078 us                | 5.886 ms                  |
| GenInput                  | 33.789 ms                 | 47.334 ms                 |
| NN                        | 680.685 us                | 2.487 ms                  |
| Forward                   | 1.039 ms                  | 6.469 ms                  |
| Backward                  | 2.310 ms                  | 14.850 ms                 |
| Optimize                  | 209.093 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 282.315 us                | 3.874 ms                  |
| AfterBackward             | 322.050 ms                | 1.329 s                   |
| BlockToStepN              | 366.180 us                | 1.359 ms                  |
| OneStep                   | 364.879 ms                | 1.376 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:20.940748 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240131 21:27:21.263147 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 99.514 us                 | 187.931 us                |
| ProcessBack:Shuffle       | 317.659 ms                | 1.308 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 13.192 ms                 |
| ProcessBack:UpsertPq      | 58.871 us                 | 101.669 us                |
| ProcessOneStep            | 322.017 ms                | 1.329 s                   |
| BlockToStepN              | 286.349 us                | 996.055 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:21.419950 2910744 grad_async_v2.h:257] pq is empty
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
W20240131 21:27:21.959774 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 21:27:22.263059 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 285 ========== 
========== Step 286 ========== 
W20240131 21:27:23.051458 2911395 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 287 ========== 
========== Step 288 ========== 
E20240131 21:27:23.264164 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:27:24.259402 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240131 21:27:24.264077 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
========== Step 289 ========== 
========== Step 290 ========== 
E20240131 21:27:25.264317 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:27:25.284372 2911395 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.614 us                | 5.886 ms                  |
| GenInput                  | 33.823 ms                 | 47.334 ms                 |
| NN                        | 682.831 us                | 2.487 ms                  |
| Forward                   | 1.044 ms                  | 6.469 ms                  |
| Backward                  | 2.323 ms                  | 15.686 ms                 |
| Optimize                  | 209.332 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 282.315 us                | 3.874 ms                  |
| AfterBackward             | 318.554 ms                | 1.377 s                   |
| BlockToStepN              | 369.765 us                | 1.359 ms                  |
| OneStep                   | 364.394 ms                | 1.434 s                   |
| E2E-100                   | 47.999 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:27:26.170455 2910744 grad_async_v2.h:257] pq is empty
========== Step 291 ========== 
E20240131 21:27:26.264011 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.010 us                 | 2.150 ms                  |
| ProcessBack:Shuffle       | 310.473 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.101 ms                  | 13.192 ms                 |
| ProcessBack:UpsertPq      | 59.182 us                 | 102.651 us                |
| ProcessOneStep            | 322.017 ms                | 1.377 s                   |
| BlockToStepN              | 288.880 us                | 996.055 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 292 ========== 
W20240131 21:27:26.290536 2911395 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 293 ========== 
========== Step 294 ========== 
E20240131 21:27:27.264276 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:27:27.480548 2911395 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
W20240131 21:27:28.149780 2910744 grad_async_v2.h:257] pq is empty
========== Step 295 ========== 
E20240131 21:27:28.264040 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 296 ========== 
========== Step 297 ========== 
W20240131 21:27:28.512424 2911395 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240131 21:27:28.543987 2910744 grad_async_v2.h:257] pq is empty
========== Step 298 ========== 
========== Step 299 ========== 
E20240131 21:27:29.265081 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:27:29.831022 2911395 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240131 21:27:30.225984 2910744 grad_async_v2.h:257] pq is empty
Step299:rank0, time: 49.607, per_step: 0.491161
Step299:rank3, time: 49.607, per_step: 0.491161
Step299:rank2, time: 49.607, per_step: 0.491161
Step299:rank1, time: 49.607, per_step: 0.491162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.213 us                | 5.886 ms                  |
| GenInput                  | 34.047 ms                 | 47.334 ms                 |
| NN                        | 689.507 us                | 2.487 ms                  |
| Forward                   | 1.054 ms                  | 6.469 ms                  |
| Backward                  | 2.323 ms                  | 15.686 ms                 |
| Optimize                  | 209.570 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 284.239 us                | 3.874 ms                  |
| AfterBackward             | 315.023 ms                | 1.393 s                   |
| BlockToStepN              | 371.474 us                | 1.359 ms                  |
| OneStep                   | 352.497 ms                | 1.434 s                   |
| E2E-100                   | 49.607 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 21:27:30.227067 2910744 grad_async_v2.h:84] call StopThreads. PID = 2910744
W20240131 21:27:30.227082 2910744 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 21:27:30.227115 2910744 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 21:27:30.227123 2910744 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
E20240131 21:27:30.265033 2911395 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240131 21:27:30.342839 2910744 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.213 us                | 5.886 ms                  |
| GenInput                  | 34.047 ms                 | 47.334 ms                 |
| NN                        | 689.507 us                | 2.487 ms                  |
| Forward                   | 1.054 ms                  | 6.469 ms                  |
| Backward                  | 2.323 ms                  | 15.686 ms                 |
| Optimize                  | 209.570 us                | 478.268 us                |
| BarrierTimeBeforeRank0    | 284.239 us                | 3.874 ms                  |
| AfterBackward             | 315.023 ms                | 1.393 s                   |
| BlockToStepN              | 371.474 us                | 1.359 ms                  |
| OneStep                   | 352.497 ms                | 1.500 s                   |
| E2E-100                   | 49.607 s                  | 49.983 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.995 us                | 869.328 us                |
| ProcessBack:Shuffle       | 310.280 ms                | 1.321 s                   |
| ProcessBack:UpdateCache   | 1.096 ms                  | 13.192 ms                 |
| ProcessBack:UpsertPq      | 58.918 us                 | 102.651 us                |
| ProcessOneStep            | 314.993 ms                | 1.393 s                   |
| BlockToStepN              | 295.524 us                | 996.055 us                |
+---------------------------+---------------------------+---------------------------+
ERROR [2910744 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f2e646d9350>
