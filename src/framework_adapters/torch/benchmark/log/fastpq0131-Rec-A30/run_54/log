WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 22:14:22.948159 3035005 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 22:14:22.949268 3035005 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [3035005 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fc3431351c0>==========
Worker 1 pid=3035263
INFO [3035005 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3035263 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3035263 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [3035265 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3035265 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
E20240131 22:14:27.293427 3035263 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 22:14:27.293617 3035265 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [3035005 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
E20240131 22:14:27.301951 3035005 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 22:14:29.548600 3035005 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 22:14:29.548631 3035263 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 22:14:29.548827 3035265 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 22:14:29.551609 3035263 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10004817f000 7.629 MB
W20240131 22:14:29.551614 3035005 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100048922000 7.629 MB
W20240131 22:14:29.551704 3035005 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000490c7000 7.629 MB
W20240131 22:14:29.551716 3035263 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10004986a000 7.629 MB
W20240131 22:14:29.551774 3035263 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004a00d000 122.1 MB
W20240131 22:14:29.551775 3035005 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100051a21000 122.1 MB
W20240131 22:14:29.551805 3035005 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100059435000 122.1 MB
W20240131 22:14:29.551811 3035263 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100060e49000 122.1 MB
W20240131 22:14:29.551834 3035005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 22:14:29.551841 3035263 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 22:14:29.551837 3035265 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10006885d000 7.629 MB
W20240131 22:14:29.551960 3035265 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100069000000 7.629 MB
W20240131 22:14:29.552018 3035265 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a3000 122.1 MB
W20240131 22:14:29.552058 3035265 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000711b7000 122.1 MB
W20240131 22:14:29.552098 3035265 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 22:14:29.553238 3035005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 22:14:29.553259 3035263 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 22:14:29.554725 3035265 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 2 pid=3035265
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240131 22:14:33.297749 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100078bd7000 7.629 MB
W20240131 22:14:33.297938 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10007937a000 7.629 MB
W20240131 22:14:33.297971 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100079b1d000 7.629 MB
W20240131 22:14:33.298002 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10007a2c0000 7.629 MB
W20240131 22:14:33.298025 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10007aa63000 7.629 MB
W20240131 22:14:33.298053 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10007b206000 7.629 MB
W20240131 22:14:33.298079 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10007b9a9000 7.629 MB
W20240131 22:14:33.298126 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10007c14c000 7.629 MB
W20240131 22:14:33.298151 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10007c8ef000 7.629 MB
W20240131 22:14:33.298183 3035265 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10007d092000 7.629 MB
W20240131 22:14:33.298208 3035265 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10007d835000 80 B 
W20240131 22:14:33.298230 3035265 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10007d837000 8 B 
W20240131 22:14:33.298246 3035265 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10007d839000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 22:14:33.298550 3035265 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 3
W20240131 22:14:33.367884 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10007d83b000 7.629 MB
W20240131 22:14:33.371644 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10007dfde000 7.629 MB
W20240131 22:14:33.371693 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10007e781000 7.629 MB
W20240131 22:14:33.371718 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10007ef24000 7.629 MB
W20240131 22:14:33.371737 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10007f6c7000 7.629 MB
W20240131 22:14:33.371766 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10007fe6a000 7.629 MB
W20240131 22:14:33.371793 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10008060d000 7.629 MB
W20240131 22:14:33.371824 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100080db0000 7.629 MB
W20240131 22:14:33.371838 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100081553000 7.629 MB
W20240131 22:14:33.371860 3035005 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100081cf6000 7.629 MB
W20240131 22:14:33.371879 3035005 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100082499000 80 B 
W20240131 22:14:33.371897 3035005 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10008249b000 8 B 
W20240131 22:14:33.371913 3035005 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10008249d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 22:14:33.372102 3035005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
W20240131 22:14:33.384920 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10008249f000 7.629 MB
W20240131 22:14:33.385021 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100082c42000 7.629 MB
W20240131 22:14:33.385059 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000833e5000 7.629 MB
W20240131 22:14:33.385087 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100083b88000 7.629 MB
W20240131 22:14:33.385109 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10008432b000 7.629 MB
W20240131 22:14:33.385131 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100084ace000 7.629 MB
W20240131 22:14:33.385157 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100085271000 7.629 MB
W20240131 22:14:33.385188 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100085a14000 7.629 MB
W20240131 22:14:33.385210 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000861b7000 7.629 MB
W20240131 22:14:33.385231 3035263 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10008695a000 7.629 MB
W20240131 22:14:33.385250 3035263 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000870fd000 80 B 
W20240131 22:14:33.385269 3035263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000870ff000 8 B 
W20240131 22:14:33.385284 3035263 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100087101000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 22:14:33.385470 3035263 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
W20240131 22:14:33.386813 3035005 grad_base.h:55] KGCacheController, config={
        "num_gpus": 3,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 22:14:33.386917 3035005 grad_base.h:184] Init GradProcessingBase done
I20240131 22:14:34.005833 3035005 grad_async_v2.h:42] Use main thread to update emb.
W20240131 22:14:34.006049 3035005 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 22:14:34.006057 3035005 kg_controller.h:84] Construct KGCacheController done
E20240131 22:14:34.295725 3035005 recstore.cc:66] init folly done
E20240131 22:14:34.295804 3035263 recstore.cc:66] init folly done
E20240131 22:14:34.295809 3035265 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 22:14:34.296578 3035005 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 22:14:34.839941 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:14:34.840217 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 22:14:35.840040 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:14:35.873636 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 22:14:36.840024 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:36.952836 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:14:37.840077 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240131 22:14:37.964391 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 22:14:38.840025 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 147.447 us                | 269.700 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
Before Training
I20240131 22:14:39.951695 3035263 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 3
Before Training
I20240131 22:14:39.951735 3035265 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
I20240131 22:14:39.951798 3035005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
========== Step 0 ========== 
W20240131 22:14:39.966434 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:14:39.966868 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 22:14:41.217564 3035871 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:14:41.430269 3035005 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
W20240131 22:14:41.612016 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [3035005 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3035265 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3035263 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
E20240131 22:14:42.217106 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:42.400362 3035005 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
W20240131 22:14:42.646258 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:14:42.784675 3035005 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
W20240131 22:14:43.197443 3035005 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
E20240131 22:14:43.217108 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.577 us                | 206.913 us                |
| GenInput                  | 23.850 ms                 | 29.233 ms                 |
| NN                        | 1.068 ms                  | 155.236 ms                |
| Forward                   | 1.547 ms                  | 179.888 ms                |
| Backward                  | 2.245 ms                  | 189.096 ms                |
| Optimize                  | 237.465 us                | 8.595 ms                  |
| BarrierTimeBeforeRank0    | 33.022 us                 | 10.479 ms                 |
| AfterBackward             | 384.159 ms                | 1.064 s                   |
| BlockToStepN              | 164.728 us                | 174.456 ms                |
| OneStep                   | 412.926 ms                | 1.653 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:43.583995 3035005 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
W20240131 22:14:43.746178 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:14:44.050311 3035005 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
E20240131 22:14:44.217022 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.860 us                | 409.162 us                |
| ProcessBack:Shuffle       | 355.381 ms                | 670.754 ms                |
| ProcessBack:UpdateCache   | 688.729 us                | 566.944 ms                |
| ProcessBack:UpsertPq      | 46.688 us                 | 213.660 ms                |
| ProcessOneStep            | 384.065 ms                | 1.064 s                   |
| BlockToStepN              | 73.616 us                 | 174.235 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:44.532855 3035005 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
W20240131 22:14:44.838531 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 22:14:45.003715 3035005 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
========== Step 10 ========== 
E20240131 22:14:45.217247 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:14:45.885980 3035005 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
W20240131 22:14:45.898557 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 12 ========== 
E20240131 22:14:46.217022 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:14:46.626371 3035005 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
========== Step 14 ========== 
W20240131 22:14:47.115679 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:14:47.217053 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:47.362025 3035005 grad_async_v2.h:257] pq is empty
========== Step 15 ========== 
W20240131 22:14:47.729940 3035005 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
========== Step 17 ========== 
E20240131 22:14:48.217046 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:14:48.252878 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.419 us                | 206.913 us                |
| GenInput                  | 24.705 ms                 | 36.300 ms                 |
| NN                        | 711.679 us                | 155.236 ms                |
| Forward                   | 1.050 ms                  | 179.888 ms                |
| Backward                  | 2.279 ms                  | 189.096 ms                |
| Optimize                  | 198.364 us                | 8.595 ms                  |
| BarrierTimeBeforeRank0    | 33.022 us                 | 10.479 ms                 |
| AfterBackward             | 384.159 ms                | 1.064 s                   |
| BlockToStepN              | 109.216 us                | 174.456 ms                |
| OneStep                   | 412.926 ms                | 1.653 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:48.549803 3035005 grad_async_v2.h:257] pq is empty
========== Step 18 ========== 
W20240131 22:14:48.923997 3035005 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
========== Step 20 ========== 
E20240131 22:14:49.217092 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.692 us                | 236.975 us                |
| ProcessBack:Shuffle       | 353.560 ms                | 773.085 ms                |
| ProcessBack:UpdateCache   | 667.985 us                | 566.944 ms                |
| ProcessBack:UpsertPq      | 41.623 us                 | 213.660 ms                |
| ProcessOneStep            | 356.041 ms                | 1.064 s                   |
| BlockToStepN              | 72.777 us                 | 174.235 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:49.301085 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240131 22:14:49.666214 3035005 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
========== Step 22 ========== 
E20240131 22:14:50.217026 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:14:50.405833 3035005 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
W20240131 22:14:50.412581 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:14:50.768088 3035005 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
========== Step 25 ========== 
E20240131 22:14:51.217051 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=88
W20240131 22:14:51.499270 3035005 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
W20240131 22:14:51.506011 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 27 ========== 
========== Step 28 ========== 
E20240131 22:14:52.217051 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 29 ========== 
========== Step 30 ========== 
W20240131 22:14:52.570729 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 31 ========== 
E20240131 22:14:53.217273 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.840 us                | 236.647 us                |
| GenInput                  | 24.705 ms                 | 37.224 ms                 |
| NN                        | 636.816 us                | 155.236 ms                |
| Forward                   | 949.860 us                | 179.888 ms                |
| Backward                  | 2.172 ms                  | 189.096 ms                |
| Optimize                  | 192.165 us                | 8.595 ms                  |
| BarrierTimeBeforeRank0    | 47.587 us                 | 10.479 ms                 |
| AfterBackward             | 354.220 ms                | 1.064 s                   |
| BlockToStepN              | 121.737 us                | 174.456 ms                |
| OneStep                   | 384.330 ms                | 1.653 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:53.658490 3035005 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
W20240131 22:14:53.665524 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 22:14:54.068397 3035005 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
E20240131 22:14:54.217273 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.081 us                | 287.971 us                |
| ProcessBack:Shuffle       | 353.560 ms                | 773.085 ms                |
| ProcessBack:UpdateCache   | 659.468 us                | 566.944 ms                |
| ProcessBack:UpsertPq      | 42.808 us                 | 213.660 ms                |
| ProcessOneStep            | 356.041 ms                | 1.064 s                   |
| BlockToStepN              | 79.451 us                 | 174.235 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:14:54.438580 3035005 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
========== Step 35 ========== 
W20240131 22:14:54.834564 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240131 22:14:55.217021 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:55.246392 3035005 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
W20240131 22:14:55.615002 3035005 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
W20240131 22:14:55.850425 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 38 ========== 
========== Step 39 ========== 
E20240131 22:14:56.217097 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:56.708525 3035005 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
W20240131 22:14:56.939945 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:14:57.066165 3035005 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
E20240131 22:14:57.217175 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:57.438103 3035005 grad_async_v2.h:257] pq is empty
========== Step 42 ========== 
W20240131 22:14:57.814206 3035005 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
W20240131 22:14:57.960461 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240131 22:14:58.217047 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.134 us                | 236.647 us                |
| GenInput                  | 25.080 ms                 | 37.224 ms                 |
| NN                        | 618.935 us                | 155.236 ms                |
| Forward                   | 928.164 us                | 179.888 ms                |
| Backward                  | 2.018 ms                  | 189.096 ms                |
| Optimize                  | 192.165 us                | 8.595 ms                  |
| BarrierTimeBeforeRank0    | 40.252 us                 | 10.479 ms                 |
| AfterBackward             | 344.120 ms                | 1.064 s                   |
| BlockToStepN              | 129.403 us                | 174.456 ms                |
| OneStep                   | 373.354 ms                | 1.653 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
W20240131 22:14:59.015079 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 22:14:59.217077 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:14:59.256712 3035005 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.250 us                | 558.566 us                |
| ProcessBack:Shuffle       | 343.305 ms                | 787.098 ms                |
| ProcessBack:UpdateCache   | 658.660 us                | 566.944 ms                |
| ProcessBack:UpsertPq      | 40.843 us                 | 213.660 ms                |
| ProcessOneStep            | 344.223 ms                | 1.064 s                   |
| BlockToStepN              | 83.746 us                 | 174.235 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 48 ========== 
W20240131 22:14:59.985491 3035005 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
W20240131 22:15:00.110105 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 22:15:00.217022 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:15:00.356374 3035005 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
W20240131 22:15:00.721292 3035005 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
W20240131 22:15:01.091723 3035005 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
W20240131 22:15:01.216928 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 22:15:01.217092 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:01.458943 3035005 grad_async_v2.h:257] pq is empty
========== Step 53 ========== 
========== Step 54 ========== 
W20240131 22:15:01.576422 3035005 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
========== Step 56 ========== 
E20240131 22:15:02.217036 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:02.387279 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 57 ========== 
W20240131 22:15:02.735917 3035005 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
========== Step 59 ========== 
E20240131 22:15:03.217079 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 60 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 236.647 us                |
| GenInput                  | 25.080 ms                 | 37.224 ms                 |
| NN                        | 597.239 us                | 5.272 ms                  |
| Forward                   | 919.342 us                | 5.646 ms                  |
| Backward                  | 2.015 ms                  | 7.066 ms                  |
| Optimize                  | 186.920 us                | 306.606 us                |
| BarrierTimeBeforeRank0    | 45.762 us                 | 2.921 ms                  |
| AfterBackward             | 339.457 ms                | 788.615 ms                |
| BlockToStepN              | 142.049 us                | 461.396 us                |
| OneStep                   | 370.432 ms                | 822.323 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:03.512768 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 61 ========== 
E20240131 22:15:04.217082 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.090 us                | 1.051 ms                  |
| ProcessBack:Shuffle       | 338.562 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 659.468 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 39.234 us                 | 96.030 us                 |
| ProcessOneStep            | 339.971 ms                | 790.416 ms                |
| BlockToStepN              | 90.293 us                 | 375.355 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:04.590691 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240131 22:15:04.716955 3035005 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
W20240131 22:15:05.078414 3035005 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
E20240131 22:15:05.217105 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:05.443365 3035005 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
W20240131 22:15:05.684285 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:15:05.811328 3035005 grad_async_v2.h:257] pq is empty
========== Step 65 ========== 
W20240131 22:15:06.171097 3035005 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
E20240131 22:15:06.217108 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:06.268146 3035005 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
W20240131 22:15:06.877554 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:15:07.028554 3035005 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
E20240131 22:15:07.217108 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:07.399492 3035005 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
========== Step 70 ========== 
W20240131 22:15:08.004803 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:15:08.131889 3035005 grad_async_v2.h:257] pq is empty
========== Step 71 ========== 
E20240131 22:15:08.217101 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 72 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 149.735 us                | 236.647 us                |
| GenInput                  | 24.914 ms                 | 37.445 ms                 |
| NN                        | 566.959 us                | 5.272 ms                  |
| Forward                   | 893.116 us                | 5.646 ms                  |
| Backward                  | 2.018 ms                  | 7.066 ms                  |
| Optimize                  | 184.774 us                | 306.606 us                |
| BarrierTimeBeforeRank0    | 45.762 us                 | 2.921 ms                  |
| AfterBackward             | 338.880 ms                | 790.442 ms                |
| BlockToStepN              | 161.176 us                | 461.396 us                |
| OneStep                   | 370.254 ms                | 830.578 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:08.843888 3035005 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
W20240131 22:15:09.078120 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:15:09.207590 3035005 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
E20240131 22:15:09.220561 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.241 us                | 568.328 us                |
| ProcessBack:Shuffle       | 337.104 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 656.488 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 38.851 us                 | 96.030 us                 |
| ProcessOneStep            | 338.861 ms                | 790.416 ms                |
| BlockToStepN              | 107.929 us                | 415.156 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:09.931910 3035005 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
W20240131 22:15:09.978685 3035005 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
E20240131 22:15:10.220247 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 81 ========== 
W20240131 22:15:10.478966 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 82 ========== 
E20240131 22:15:11.220052 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240131 22:15:11.800127 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 83 ========== 
E20240131 22:15:12.220117 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 84 ========== 
W20240131 22:15:12.896700 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:15:13.220577 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:13.251329 3035005 grad_async_v2.h:257] pq is empty
========== Step 85 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.305 us                | 236.647 us                |
| GenInput                  | 25.080 ms                 | 37.445 ms                 |
| NN                        | 580.072 us                | 5.272 ms                  |
| Forward                   | 898.361 us                | 5.646 ms                  |
| Backward                  | 2.018 ms                  | 7.066 ms                  |
| Optimize                  | 185.728 us                | 306.606 us                |
| BarrierTimeBeforeRank0    | 34.129 us                 | 2.921 ms                  |
| AfterBackward             | 338.880 ms                | 790.442 ms                |
| BlockToStepN              | 170.779 us                | 6.086 ms                  |
| OneStep                   | 370.254 ms                | 830.578 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:13.621738 3035005 grad_async_v2.h:257] pq is empty
========== Step 86 ========== 
W20240131 22:15:13.995795 3035005 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
W20240131 22:15:13.996438 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 88 ========== 
========== Step 89 ========== 
E20240131 22:15:14.220054 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.093 us                | 630.388 us                |
| ProcessBack:Shuffle       | 337.104 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 656.488 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 40.897 us                 | 96.030 us                 |
| ProcessOneStep            | 338.861 ms                | 790.416 ms                |
| BlockToStepN              | 116.344 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
W20240131 22:15:15.163403 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:15:15.220381 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:15.404946 3035005 grad_async_v2.h:257] pq is empty
========== Step 91 ========== 
W20240131 22:15:15.672891 3035005 grad_async_v2.h:257] pq is empty
========== Step 92 ========== 
W20240131 22:15:16.122176 3035005 grad_async_v2.h:257] pq is empty
========== Step 93 ========== 
E20240131 22:15:16.220252 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:16.243101 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:15:16.485541 3035005 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
E20240131 22:15:17.220113 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:15:17.512992 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:15:17.565284 3035005 grad_async_v2.h:257] pq is empty
========== Step 97 ========== 
W20240131 22:15:18.010257 3035005 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
E20240131 22:15:18.220273 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:18.376049 3035005 grad_async_v2.h:257] pq is empty
========== Step 99 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 241.386 us                |
| GenInput                  | 24.914 ms                 | 39.583 ms                 |
| NN                        | 604.868 us                | 5.272 ms                  |
| Forward                   | 919.342 us                | 5.646 ms                  |
| Backward                  | 2.018 ms                  | 7.066 ms                  |
| Optimize                  | 186.443 us                | 306.606 us                |
| BarrierTimeBeforeRank0    | 34.692 us                 | 2.921 ms                  |
| AfterBackward             | 338.880 ms                | 790.442 ms                |
| BlockToStepN              | 189.058 us                | 6.086 ms                  |
| OneStep                   | 370.254 ms                | 830.578 ms                |
+---------------------------+---------------------------+---------------------------+
Step99:rank1, time: 48.778, per_step: 0.487784
Step99:rank0, time: 48.778, per_step: 0.487784
Step99:rank2, time: 48.778, per_step: 0.487783
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 241.386 us                |
| GenInput                  | 24.914 ms                 | 39.583 ms                 |
| NN                        | 604.868 us                | 5.272 ms                  |
| Forward                   | 919.342 us                | 5.646 ms                  |
| Backward                  | 2.018 ms                  | 7.066 ms                  |
| Optimize                  | 186.443 us                | 306.606 us                |
| BarrierTimeBeforeRank0    | 34.692 us                 | 2.921 ms                  |
| AfterBackward             | 337.795 ms                | 790.442 ms                |
| BlockToStepN              | 189.058 us                | 6.086 ms                  |
| OneStep                   | 370.254 ms                | 830.578 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240131 22:15:18.621778 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240131 22:15:19.095482 3035005 grad_async_v2.h:257] pq is empty
========== Step 101 ========== 
========== Step 102 ========== 
E20240131 22:15:19.220104 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.734 us                | 2.090 ms                  |
| ProcessBack:Shuffle       | 336.312 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 659.567 us                | 10.697 ms                 |
| ProcessBack:UpsertPq      | 40.975 us                 | 96.030 us                 |
| ProcessOneStep            | 337.777 ms                | 790.416 ms                |
| BlockToStepN              | 130.895 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:19.699916 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 103 ========== 
W20240131 22:15:20.194211 3035005 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
E20240131 22:15:20.220052 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:20.558247 3035005 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
W20240131 22:15:20.795015 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 22:15:20.922245 3035005 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
E20240131 22:15:21.220031 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:21.290608 3035005 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
W20240131 22:15:21.718132 3035005 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
W20240131 22:15:21.848764 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 109 ========== 
E20240131 22:15:22.220691 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:22.558445 3035005 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
W20240131 22:15:22.965085 3035005 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
W20240131 22:15:22.972090 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 112 ========== 
E20240131 22:15:23.220961 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 113 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.385 us                | 241.386 us                |
| GenInput                  | 24.845 ms                 | 39.583 ms                 |
| NN                        | 604.868 us                | 5.938 ms                  |
| Forward                   | 918.627 us                | 6.232 ms                  |
| Backward                  | 2.015 ms                  | 7.066 ms                  |
| Optimize                  | 186.443 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 34.129 us                 | 3.299 ms                  |
| AfterBackward             | 337.795 ms                | 790.442 ms                |
| BlockToStepN              | 202.258 us                | 6.086 ms                  |
| OneStep                   | 368.504 ms                | 830.578 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 114 ========== 
W20240131 22:15:24.096849 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:15:24.220386 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.021 us                | 954.733 us                |
| ProcessBack:Shuffle       | 336.884 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 659.468 us                | 10.697 ms                 |
| ProcessBack:UpsertPq      | 41.445 us                 | 96.030 us                 |
| ProcessOneStep            | 337.777 ms                | 790.416 ms                |
| BlockToStepN              | 138.410 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:24.517897 3035005 grad_async_v2.h:257] pq is empty
========== Step 115 ========== 
========== Step 116 ========== 
E20240131 22:15:25.220126 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:15:25.226644 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:15:25.371644 3035005 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
========== Step 118 ========== 
W20240131 22:15:25.728727 3035005 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 120 ========== 
E20240131 22:15:26.220605 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240131 22:15:26.480803 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240131 22:15:26.609210 3035005 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
W20240131 22:15:27.195780 3035005 grad_async_v2.h:257] pq is empty
========== Step 122 ========== 
E20240131 22:15:27.220140 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 123 ========== 
========== Step 124 ========== 
W20240131 22:15:27.560997 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 125 ========== 
E20240131 22:15:28.220041 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 241.386 us                |
| GenInput                  | 24.844 ms                 | 39.583 ms                 |
| NN                        | 610.352 us                | 5.938 ms                  |
| Forward                   | 928.164 us                | 6.232 ms                  |
| Backward                  | 2.000 ms                  | 7.066 ms                  |
| Optimize                  | 189.543 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 33.022 us                 | 3.299 ms                  |
| AfterBackward             | 337.551 ms                | 790.442 ms                |
| BlockToStepN              | 213.482 us                | 6.086 ms                  |
| OneStep                   | 368.350 ms                | 830.578 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 126 ========== 
W20240131 22:15:28.702050 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
W20240131 22:15:29.171795 3035005 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
E20240131 22:15:29.220160 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.650 us                | 517.768 us                |
| ProcessBack:Shuffle       | 336.884 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 679.287 us                | 10.697 ms                 |
| ProcessBack:UpsertPq      | 42.912 us                 | 96.030 us                 |
| ProcessOneStep            | 337.777 ms                | 790.416 ms                |
| BlockToStepN              | 152.368 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 128 ========== 
========== Step 129 ========== 
W20240131 22:15:29.807624 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 130 ========== 
E20240131 22:15:30.220196 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:15:30.756084 3035005 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
W20240131 22:15:30.905357 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 132 ========== 
E20240131 22:15:31.220149 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:31.611455 3035005 grad_async_v2.h:257] pq is empty
========== Step 133 ========== 
W20240131 22:15:32.043659 3035005 grad_async_v2.h:257] pq is empty
========== Step 134 ========== 
W20240131 22:15:32.044296 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 22:15:32.220405 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:32.450994 3035005 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
W20240131 22:15:33.051352 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240131 22:15:33.220271 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 248.185 us                |
| GenInput                  | 24.844 ms                 | 39.583 ms                 |
| NN                        | 609.398 us                | 5.938 ms                  |
| Forward                   | 928.164 us                | 6.232 ms                  |
| Backward                  | 1.993 ms                  | 7.077 ms                  |
| Optimize                  | 189.304 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 33.022 us                 | 3.299 ms                  |
| AfterBackward             | 337.795 ms                | 790.442 ms                |
| BlockToStepN              | 216.710 us                | 6.086 ms                  |
| OneStep                   | 370.254 ms                | 830.578 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 138 ========== 
W20240131 22:15:34.096011 3035005 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
W20240131 22:15:34.096617 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 22:15:34.220010 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.267 us                | 11.542 ms                 |
| ProcessBack:Shuffle       | 337.104 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 684.771 us                | 10.697 ms                 |
| ProcessBack:UpsertPq      | 43.177 us                 | 97.473 us                 |
| ProcessOneStep            | 338.861 ms                | 790.416 ms                |
| BlockToStepN              | 158.674 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 140 ========== 
W20240131 22:15:34.823810 3035005 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
W20240131 22:15:35.219149 3035005 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
W20240131 22:15:35.219695 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 22:15:35.224828 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:15:35.603035 3035005 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
========== Step 144 ========== 
E20240131 22:15:36.224264 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:36.325279 3035005 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
W20240131 22:15:36.332018 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 22:15:36.765194 3035005 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
W20240131 22:15:37.418043 3035005 grad_async_v2.h:257] pq is empty
========== Step 147 ========== 
W20240131 22:15:37.425475 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 22:15:37.425863 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:37.490610 3035005 grad_async_v2.h:257] pq is empty
========== Step 148 ========== 
W20240131 22:15:38.139133 3035005 grad_async_v2.h:257] pq is empty
========== Step 149 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.571 us                | 248.185 us                |
| GenInput                  | 24.891 ms                 | 40.132 ms                 |
| NN                        | 604.868 us                | 5.938 ms                  |
| Forward                   | 919.342 us                | 6.232 ms                  |
| Backward                  | 2.000 ms                  | 7.077 ms                  |
| Optimize                  | 189.543 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 31.844 us                 | 3.299 ms                  |
| AfterBackward             | 339.457 ms                | 790.442 ms                |
| BlockToStepN              | 229.937 us                | 6.086 ms                  |
| OneStep                   | 370.886 ms                | 830.578 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:15:38.425019 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 22:15:38.510260 3035005 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
W20240131 22:15:38.516775 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:15:38.877564 3035005 grad_async_v2.h:257] pq is empty
========== Step 151 ========== 
W20240131 22:15:39.241652 3035005 grad_async_v2.h:257] pq is empty
========== Step 152 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.150 us                | 1.561 ms                  |
| ProcessBack:Shuffle       | 338.053 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 679.287 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 43.506 us                 | 96.030 us                 |
| ProcessOneStep            | 339.018 ms                | 788.571 ms                |
| BlockToStepN              | 171.117 us                | 460.629 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 22:15:39.425259 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:39.609175 3035005 grad_async_v2.h:257] pq is empty
========== Step 153 ========== 
W20240131 22:15:39.616137 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:15:40.030757 3035005 grad_async_v2.h:257] pq is empty
========== Step 154 ========== 
W20240131 22:15:40.414765 3035005 grad_async_v2.h:257] pq is empty
========== Step 155 ========== 
E20240131 22:15:40.425058 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=58
W20240131 22:15:40.651595 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 22:15:40.784706 3035005 grad_async_v2.h:257] pq is empty
========== Step 156 ========== 
W20240131 22:15:41.593827 3035005 grad_async_v2.h:257] pq is empty
========== Step 157 ========== 
E20240131 22:15:41.601061 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:41.713169 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:15:41.956995 3035005 grad_async_v2.h:257] pq is empty
========== Step 158 ========== 
W20240131 22:15:42.327109 3035005 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
E20240131 22:15:42.601051 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:15:42.685315 3035005 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
W20240131 22:15:42.814678 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:15:43.065029 3035005 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.049 us                | 246.400 us                |
| GenInput                  | 24.891 ms                 | 39.583 ms                 |
| NN                        | 610.352 us                | 5.272 ms                  |
| Forward                   | 928.164 us                | 5.646 ms                  |
| Backward                  | 2.007 ms                  | 7.066 ms                  |
| Optimize                  | 192.404 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 33.022 us                 | 3.056 ms                  |
| AfterBackward             | 339.988 ms                | 788.615 ms                |
| BlockToStepN              | 236.457 us                | 534.723 us                |
| OneStep                   | 370.432 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:43.432292 3035005 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
E20240131 22:15:43.601028 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:43.806761 3035005 grad_async_v2.h:257] pq is empty
========== Step 163 ========== 
W20240131 22:15:43.925065 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:15:44.170969 3035005 grad_async_v2.h:257] pq is empty
========== Step 164 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.556 us                | 1.648 ms                  |
| ProcessBack:Shuffle       | 338.250 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 667.985 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 44.261 us                 | 96.030 us                 |
| ProcessOneStep            | 339.431 ms                | 788.571 ms                |
| BlockToStepN              | 176.266 us                | 460.629 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 165 ========== 
========== Step 166 ========== 
E20240131 22:15:44.601126 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:15:44.947578 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 167 ========== 
E20240131 22:15:45.601023 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 22:15:45.676817 3035005 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
W20240131 22:15:45.963637 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 22:15:46.122924 3035005 grad_async_v2.h:257] pq is empty
========== Step 169 ========== 
W20240131 22:15:46.488998 3035005 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
E20240131 22:15:46.601363 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:46.858759 3035005 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
W20240131 22:15:46.989809 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 172 ========== 
========== Step 173 ========== 
E20240131 22:15:47.601191 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:47.971944 3035005 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
W20240131 22:15:48.105320 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 175 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.349 us                | 246.400 us                |
| GenInput                  | 25.080 ms                 | 39.583 ms                 |
| NN                        | 619.411 us                | 5.272 ms                  |
| Forward                   | 953.913 us                | 5.646 ms                  |
| Backward                  | 2.022 ms                  | 7.066 ms                  |
| Optimize                  | 195.503 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 28.524 us                 | 3.056 ms                  |
| AfterBackward             | 339.988 ms                | 788.615 ms                |
| BlockToStepN              | 241.628 us                | 6.086 ms                  |
| OneStep                   | 370.293 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:15:48.601174 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:15:48.704325 3035005 grad_async_v2.h:257] pq is empty
========== Step 176 ========== 
========== Step 177 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 129.146 us                | 1.497 ms                  |
| ProcessBack:Shuffle       | 338.250 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 661.840 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 45.712 us                 | 96.030 us                 |
| ProcessOneStep            | 339.431 ms                | 788.571 ms                |
| BlockToStepN              | 182.866 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:49.307615 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:15:49.432693 3035005 grad_async_v2.h:257] pq is empty
========== Step 178 ========== 
E20240131 22:15:49.601156 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:15:49.794857 3035005 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
W20240131 22:15:50.156657 3035005 grad_async_v2.h:257] pq is empty
========== Step 180 ========== 
W20240131 22:15:50.397573 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:15:50.524715 3035005 grad_async_v2.h:257] pq is empty
========== Step 181 ========== 
E20240131 22:15:50.601213 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:50.897370 3035005 grad_async_v2.h:257] pq is empty
========== Step 182 ========== 
W20240131 22:15:50.933166 3035005 grad_async_v2.h:257] pq is empty
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
E20240131 22:15:51.601058 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:51.646970 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
========== Step 187 ========== 
W20240131 22:15:52.591712 3035005 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
E20240131 22:15:52.601505 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
W20240131 22:15:52.865756 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 189 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.202 us                | 248.185 us                |
| GenInput                  | 25.192 ms                 | 39.583 ms                 |
| NN                        | 619.411 us                | 5.272 ms                  |
| Forward                   | 953.913 us                | 5.646 ms                  |
| Backward                  | 2.024 ms                  | 7.066 ms                  |
| Optimize                  | 195.742 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 26.228 us                 | 3.056 ms                  |
| AfterBackward             | 338.880 ms                | 788.615 ms                |
| BlockToStepN              | 257.760 us                | 6.086 ms                  |
| OneStep                   | 369.944 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.617 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:15:53.601421 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 190 ========== 
W20240131 22:15:53.902724 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:15:54.144523 3035005 grad_async_v2.h:257] pq is empty
========== Step 191 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.155 us                | 1.568 ms                  |
| ProcessBack:Shuffle       | 338.053 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 659.468 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 46.643 us                 | 96.030 us                 |
| ProcessOneStep            | 339.018 ms                | 788.571 ms                |
| BlockToStepN              | 189.132 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:54.511715 3035005 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
========== Step 193 ========== 
E20240131 22:15:54.601577 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:55.096973 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:15:55.221954 3035005 grad_async_v2.h:257] pq is empty
========== Step 194 ========== 
W20240131 22:15:55.525080 3035005 grad_async_v2.h:257] pq is empty
========== Step 195 ========== 
========== Step 196 ========== 
E20240131 22:15:55.601163 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=46
========== Step 197 ========== 
========== Step 198 ========== 
W20240131 22:15:56.303375 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 22:15:56.601151 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:57.021236 3035005 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
W20240131 22:15:57.383054 3035005 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 38.815, per_step: 0.384305
Step199:rank1, time: 38.815, per_step: 0.384306
Step199:rank2, time: 38.815, per_step: 0.384305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.098 us                | 248.872 us                |
| GenInput                  | 25.080 ms                 | 39.583 ms                 |
| NN                        | 623.703 us                | 5.272 ms                  |
| Forward                   | 958.920 us                | 5.646 ms                  |
| Backward                  | 2.022 ms                  | 7.066 ms                  |
| Optimize                  | 196.695 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 28.161 us                 | 3.056 ms                  |
| AfterBackward             | 337.795 ms                | 788.634 ms                |
| BlockToStepN              | 264.108 us                | 6.086 ms                  |
| OneStep                   | 369.944 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 22:15:57.390017 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 201 ========== 
E20240131 22:15:57.601047 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:58.099876 3035005 grad_async_v2.h:257] pq is empty
========== Step 202 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.228 us                | 248.872 us                |
| GenInput                  | 25.080 ms                 | 39.583 ms                 |
| NN                        | 635.624 us                | 5.272 ms                  |
| Forward                   | 973.225 us                | 5.646 ms                  |
| Backward                  | 2.022 ms                  | 7.066 ms                  |
| Optimize                  | 198.364 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 28.161 us                 | 3.056 ms                  |
| AfterBackward             | 337.795 ms                | 788.634 ms                |
| BlockToStepN              | 265.138 us                | 6.086 ms                  |
| OneStep                   | 369.776 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:15:58.455893 3035005 grad_async_v2.h:257] pq is empty
========== Step 203 ========== 
W20240131 22:15:58.456409 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 22:15:58.601029 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:15:58.814776 3035005 grad_async_v2.h:257] pq is empty
========== Step 204 ========== 
W20240131 22:15:59.174327 3035005 grad_async_v2.h:257] pq is empty
========== Step 205 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.850 us                | 2.815 ms                  |
| ProcessBack:Shuffle       | 336.312 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 659.468 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 47.555 us                 | 96.030 us                 |
| ProcessOneStep            | 337.532 ms                | 788.571 ms                |
| BlockToStepN              | 196.006 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 206 ========== 
W20240131 22:15:59.546515 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 22:15:59.601029 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:15:59.904156 3035005 grad_async_v2.h:257] pq is empty
========== Step 207 ========== 
========== Step 208 ========== 
E20240131 22:16:00.601064 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:16:00.631850 3035005 grad_async_v2.h:257] pq is empty
========== Step 209 ========== 
W20240131 22:16:00.638780 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 210 ========== 
W20240131 22:16:01.355298 3035005 grad_async_v2.h:257] pq is empty
========== Step 211 ========== 
========== Step 212 ========== 
E20240131 22:16:01.601112 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 213 ========== 
W20240131 22:16:01.746924 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 214 ========== 
E20240131 22:16:02.601099 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:02.820860 3035005 grad_async_v2.h:257] pq is empty
========== Step 215 ========== 
W20240131 22:16:02.833196 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 22:16:03.187628 3035005 grad_async_v2.h:257] pq is empty
========== Step 216 ========== 
========== Step 217 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.718 us                | 248.872 us                |
| GenInput                  | 24.933 ms                 | 39.583 ms                 |
| NN                        | 636.816 us                | 5.272 ms                  |
| Forward                   | 993.967 us                | 5.646 ms                  |
| Backward                  | 2.031 ms                  | 7.077 ms                  |
| Optimize                  | 199.080 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 24.962 us                 | 3.056 ms                  |
| AfterBackward             | 337.206 ms                | 788.634 ms                |
| BlockToStepN              | 274.701 us                | 6.086 ms                  |
| OneStep                   | 368.350 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:16:03.601063 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:03.856479 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:16:04.006314 3035005 grad_async_v2.h:257] pq is empty
========== Step 218 ========== 
========== Step 219 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.841 us                | 3.901 ms                  |
| ProcessBack:Shuffle       | 336.268 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 656.158 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 48.918 us                 | 96.030 us                 |
| ProcessOneStep            | 337.180 ms                | 788.571 ms                |
| BlockToStepN              | 199.727 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:16:04.601236 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=95
W20240131 22:16:04.719265 3035005 grad_async_v2.h:257] pq is empty
========== Step 220 ========== 
W20240131 22:16:04.870771 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:16:05.162449 3035005 grad_async_v2.h:257] pq is empty
========== Step 221 ========== 
W20240131 22:16:05.528209 3035005 grad_async_v2.h:257] pq is empty
========== Step 222 ========== 
E20240131 22:16:05.601114 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 22:16:05.925662 3035005 grad_async_v2.h:257] pq is empty
========== Step 223 ========== 
W20240131 22:16:05.938167 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 22:16:06.291844 3035005 grad_async_v2.h:257] pq is empty
========== Step 224 ========== 
W20240131 22:16:06.326551 3035005 grad_async_v2.h:257] pq is empty
========== Step 225 ========== 
E20240131 22:16:06.601183 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:07.030282 3035005 grad_async_v2.h:257] pq is empty
========== Step 226 ========== 
W20240131 22:16:07.043151 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 227 ========== 
E20240131 22:16:07.601143 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 22:16:07.753903 3035005 grad_async_v2.h:257] pq is empty
========== Step 228 ========== 
W20240131 22:16:08.051119 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240131 22:16:08.211171 3035005 grad_async_v2.h:257] pq is empty
========== Step 229 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.955 us                | 281.823 us                |
| GenInput                  | 24.933 ms                 | 39.583 ms                 |
| NN                        | 636.816 us                | 5.272 ms                  |
| Forward                   | 993.967 us                | 6.222 ms                  |
| Backward                  | 2.049 ms                  | 7.077 ms                  |
| Optimize                  | 199.318 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 23.060 us                 | 3.056 ms                  |
| AfterBackward             | 337.795 ms                | 788.634 ms                |
| BlockToStepN              | 280.815 us                | 6.086 ms                  |
| OneStep                   | 368.504 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:16:08.601028 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:16:08.650431 3035005 grad_async_v2.h:257] pq is empty
========== Step 230 ========== 
W20240131 22:16:09.022320 3035005 grad_async_v2.h:257] pq is empty
========== Step 231 ========== 
W20240131 22:16:09.147719 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.233 us                | 1.427 ms                  |
| ProcessBack:Shuffle       | 336.884 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 653.381 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 49.091 us                 | 96.030 us                 |
| ProcessOneStep            | 337.777 ms                | 788.571 ms                |
| BlockToStepN              | 208.101 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:16:09.389134 3035005 grad_async_v2.h:257] pq is empty
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
E20240131 22:16:09.601038 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:10.215982 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 235 ========== 
E20240131 22:16:10.601049 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 22:16:10.823714 3035005 grad_async_v2.h:257] pq is empty
========== Step 236 ========== 
W20240131 22:16:11.197052 3035005 grad_async_v2.h:257] pq is empty
========== Step 237 ========== 
W20240131 22:16:11.316836 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 22:16:11.561301 3035005 grad_async_v2.h:257] pq is empty
========== Step 238 ========== 
E20240131 22:16:11.601097 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:11.930353 3035005 grad_async_v2.h:257] pq is empty
========== Step 239 ========== 
W20240131 22:16:12.290139 3035005 grad_async_v2.h:257] pq is empty
========== Step 240 ========== 
W20240131 22:16:12.414340 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 22:16:12.601290 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:12.657908 3035005 grad_async_v2.h:257] pq is empty
========== Step 241 ========== 
W20240131 22:16:13.035049 3035005 grad_async_v2.h:257] pq is empty
========== Step 242 ========== 
W20240131 22:16:13.398196 3035005 grad_async_v2.h:257] pq is empty
========== Step 243 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.070 us                | 311.071 us                |
| GenInput                  | 24.927 ms                 | 39.583 ms                 |
| NN                        | 653.505 us                | 5.272 ms                  |
| Forward                   | 1.003 ms                  | 6.232 ms                  |
| Backward                  | 2.059 ms                  | 7.077 ms                  |
| Optimize                  | 200.272 us                | 506.401 us                |
| BarrierTimeBeforeRank0    | 23.060 us                 | 3.056 ms                  |
| AfterBackward             | 338.372 ms                | 788.634 ms                |
| BlockToStepN              | 286.113 us                | 6.086 ms                  |
| OneStep                   | 368.504 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:16:13.534792 3035679 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 22:16:13.601027 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:16:13.810180 3035005 grad_async_v2.h:257] pq is empty
========== Step 244 ========== 
W20240131 22:16:14.182778 3035005 grad_async_v2.h:257] pq is empty
========== Step 245 ========== 
========== Step 246 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.678 us                | 3.328 ms                  |
| ProcessBack:Shuffle       | 336.884 ms                | 781.751 ms                |
| ProcessBack:UpdateCache   | 646.864 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 49.382 us                 | 96.030 us                 |
| ProcessOneStep            | 337.777 ms                | 788.571 ms                |
| BlockToStepN              | 214.050 us                | 6.045 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:16:14.543974 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 22:16:14.601035 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 22:16:14.917943 3035005 grad_async_v2.h:257] pq is empty
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
W20240131 22:16:15.543926 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 22:16:15.601156 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 22:16:16.033452 3035005 grad_async_v2.h:257] pq is empty
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 253 ========== 
E20240131 22:16:16.601084 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 254 ========== 
W20240131 22:16:17.019376 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 255 ========== 
========== Step 256 ========== 
E20240131 22:16:17.601037 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
W20240131 22:16:18.259183 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 257 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.341 us                | 281.823 us                |
| GenInput                  | 25.122 ms                 | 38.757 ms                 |
| NN                        | 654.936 us                | 1.675 ms                  |
| Forward                   | 1.004 ms                  | 6.222 ms                  |
| Backward                  | 2.057 ms                  | 7.066 ms                  |
| Optimize                  | 200.748 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 22.044 us                 | 3.047 ms                  |
| AfterBackward             | 338.372 ms                | 788.615 ms                |
| BlockToStepN              | 292.178 us                | 4.643 ms                  |
| OneStep                   | 369.052 ms                | 822.323 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 258 ========== 
E20240131 22:16:18.601485 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 259 ========== 
========== Step 260 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.584 us                | 5.550 ms                  |
| ProcessBack:Shuffle       | 336.543 ms                | 781.620 ms                |
| ProcessBack:UpdateCache   | 646.864 us                | 7.045 ms                  |
| ProcessBack:UpsertPq      | 49.587 us                 | 88.322 us                 |
| ProcessOneStep            | 337.532 ms                | 788.554 ms                |
| BlockToStepN              | 219.923 us                | 5.459 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 261 ========== 
W20240131 22:16:19.387733 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
========== Step 262 ========== 
E20240131 22:16:19.601061 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 263 ========== 
E20240131 22:16:20.601406 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:20.789572 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 264 ========== 
W20240131 22:16:21.497997 3035005 grad_async_v2.h:257] pq is empty
========== Step 265 ========== 
E20240131 22:16:21.601094 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:21.871814 3035005 grad_async_v2.h:257] pq is empty
========== Step 266 ========== 
W20240131 22:16:21.878557 3035679 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 22:16:22.232421 3035005 grad_async_v2.h:257] pq is empty
========== Step 267 ========== 
W20240131 22:16:22.596747 3035005 grad_async_v2.h:257] pq is empty
========== Step 268 ========== 
E20240131 22:16:22.603065 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 269 ========== 
W20240131 22:16:22.966435 3035679 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 270 ========== 
========== Step 271 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.545 us                | 281.823 us                |
| GenInput                  | 25.196 ms                 | 38.757 ms                 |
| NN                        | 654.221 us                | 1.675 ms                  |
| Forward                   | 1.003 ms                  | 6.222 ms                  |
| Backward                  | 2.061 ms                  | 7.066 ms                  |
| Optimize                  | 200.272 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 22.968 us                 | 3.047 ms                  |
| AfterBackward             | 337.276 ms                | 790.442 ms                |
| BlockToStepN              | 301.648 us                | 5.521 ms                  |
| OneStep                   | 368.046 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:16:23.603500 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.069 us                | 5.551 ms                  |
| ProcessBack:Shuffle       | 336.268 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 646.864 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 49.987 us                 | 96.030 us                 |
| ProcessOneStep            | 337.180 ms                | 790.416 ms                |
| BlockToStepN              | 226.404 us                | 5.459 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:16:24.393115 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 22:16:24.603787 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
W20240131 22:16:25.479825 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 22:16:25.603070 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 278 ========== 
W20240131 22:16:26.549988 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 22:16:26.603410 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:26.677311 3035005 grad_async_v2.h:257] pq is empty
========== Step 279 ========== 
W20240131 22:16:27.062283 3035005 grad_async_v2.h:257] pq is empty
========== Step 280 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
W20240131 22:16:27.571859 3035679 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 22:16:27.603778 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 283 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.648 us                | 311.071 us                |
| GenInput                  | 25.248 ms                 | 39.583 ms                 |
| NN                        | 654.936 us                | 1.675 ms                  |
| Forward                   | 1.004 ms                  | 6.222 ms                  |
| Backward                  | 2.059 ms                  | 7.066 ms                  |
| Optimize                  | 200.748 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 22.716 us                 | 3.047 ms                  |
| AfterBackward             | 337.206 ms                | 790.442 ms                |
| BlockToStepN              | 308.959 us                | 5.521 ms                  |
| OneStep                   | 367.943 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 22:16:28.496014 3035005 grad_async_v2.h:257] pq is empty
========== Step 284 ========== 
E20240131 22:16:28.603116 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:28.634330 3035679 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 22:16:28.876760 3035005 grad_async_v2.h:257] pq is empty
========== Step 285 ========== 
W20240131 22:16:29.293396 3035005 grad_async_v2.h:257] pq is empty
========== Step 286 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.057 us                | 1.495 ms                  |
| ProcessBack:Shuffle       | 336.312 ms                | 783.034 ms                |
| ProcessBack:UpdateCache   | 647.876 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 50.489 us                 | 96.030 us                 |
| ProcessOneStep            | 337.203 ms                | 790.416 ms                |
| BlockToStepN              | 230.404 us                | 5.459 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 22:16:29.603119 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:29.671846 3035005 grad_async_v2.h:257] pq is empty
========== Step 287 ========== 
W20240131 22:16:29.684401 3035679 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 288 ========== 
========== Step 289 ========== 
E20240131 22:16:30.603113 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 22:16:30.729884 3035005 grad_async_v2.h:257] pq is empty
========== Step 290 ========== 
W20240131 22:16:30.780011 3035679 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 22:16:31.267155 3035005 grad_async_v2.h:257] pq is empty
========== Step 291 ========== 
E20240131 22:16:31.603258 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 22:16:31.731874 3035005 grad_async_v2.h:257] pq is empty
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
W20240131 22:16:31.895931 3035679 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240131 22:16:32.603121 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 295 ========== 
W20240131 22:16:32.976473 3035679 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 296 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.187 us                | 311.071 us                |
| GenInput                  | 25.307 ms                 | 39.583 ms                 |
| NN                        | 655.651 us                | 1.675 ms                  |
| Forward                   | 1.006 ms                  | 6.222 ms                  |
| Backward                  | 2.064 ms                  | 7.066 ms                  |
| Optimize                  | 200.987 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 22.716 us                 | 3.047 ms                  |
| AfterBackward             | 337.276 ms                | 791.573 ms                |
| BlockToStepN              | 315.273 us                | 5.521 ms                  |
| OneStep                   | 368.046 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 297 ========== 
E20240131 22:16:33.603060 3035679 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 298 ========== 
W20240131 22:16:34.111992 3035679 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 299 ========== 
Step299:rank0, time: 36.915, per_step: 0.365496
Step299:rank1, time: 36.915, per_step: 0.365496
Step299:rank2, time: 36.915, per_step: 0.365496
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.611 us                | 311.071 us                |
| GenInput                  | 25.307 ms                 | 39.583 ms                 |
| NN                        | 658.035 us                | 1.675 ms                  |
| Forward                   | 1.007 ms                  | 6.222 ms                  |
| Backward                  | 2.063 ms                  | 7.066 ms                  |
| Optimize                  | 200.987 us                | 442.028 us                |
| BarrierTimeBeforeRank0    | 22.044 us                 | 3.047 ms                  |
| AfterBackward             | 337.276 ms                | 791.573 ms                |
| BlockToStepN              | 315.623 us                | 5.521 ms                  |
| OneStep                   | 368.350 ms                | 829.011 ms                |
| E2E-100                   | 38.617 s                  | 38.815 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 22:16:34.298723 3035005 grad_async_v2.h:84] call StopThreads. PID = 3035005
W20240131 22:16:34.298750 3035005 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 22:16:34.298794 3035005 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 22:16:34.298804 3035005 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.945 us                | 5.619 ms                  |
| ProcessBack:Shuffle       | 336.312 ms                | 784.581 ms                |
| ProcessBack:UpdateCache   | 652.375 us                | 7.164 ms                  |
| ProcessBack:UpsertPq      | 51.207 us                 | 96.030 us                 |
| ProcessOneStep            | 337.203 ms                | 791.540 ms                |
| BlockToStepN              | 235.039 us                | 5.459 ms                  |
+---------------------------+---------------------------+---------------------------+
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240131 22:16:34.367826 3035005 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
