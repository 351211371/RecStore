WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 23:25:17.067245 3198253 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 23:25:17.069128 3198253 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [3198253 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f7bcb8211c0>==========
Worker 1 pid=3198519
Worker 2 pid=3198521
INFO [3198253 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3198519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3198523 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3198523 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 23:25:24.761618 3198523 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [3198521 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3198521 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3198519 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3198253 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 23:25:24.763000 3198521 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 23:25:24.763135 3198253 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 23:25:24.763195 3198519 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 23:25:31.710880 3198253 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240131 23:25:31.710882 3198519 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240131 23:25:31.710907 3198523 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240131 23:25:31.711782 3198521 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240131 23:25:31.715374 3198253 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100101970000 7.629 MB
W20240131 23:25:31.715379 3198519 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100102113000 7.629 MB
W20240131 23:25:31.715464 3198253 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1001028b6000 7.629 MB
W20240131 23:25:31.715467 3198519 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100103059000 7.629 MB
W20240131 23:25:31.715487 3198253 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1001037fc000 122.1 MB
W20240131 23:25:31.715508 3198519 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10010b210000 122.1 MB
W20240131 23:25:31.715515 3198253 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100112c24000 122.1 MB
W20240131 23:25:31.715533 3198253 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 23:25:31.715540 3198519 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10011a638000 122.1 MB
W20240131 23:25:31.715564 3198519 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 23:25:31.716048 3198523 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10012204e000 7.629 MB
W20240131 23:25:31.716126 3198523 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001227f1000 7.629 MB
W20240131 23:25:31.716156 3198523 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100122f94000 122.1 MB
W20240131 23:25:31.716181 3198523 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10012a9a8000 122.1 MB
W20240131 23:25:31.716204 3198523 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 23:25:31.716279 3198253 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 23:25:31.716353 3198521 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1001323c0000 7.629 MB
W20240131 23:25:31.716526 3198519 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 23:25:31.716594 3198523 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 23:25:31.716603 3198521 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100132b69000 7.629 MB
W20240131 23:25:31.716773 3198521 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10013330c000 122.1 MB
W20240131 23:25:31.716823 3198521 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10013ad20000 122.1 MB
W20240131 23:25:31.716881 3198521 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 23:25:31.717149 3198521 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=3198523
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240131 23:25:36.904831 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10014273c000 7.629 MB
W20240131 23:25:36.904986 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100142edf000 7.629 MB
W20240131 23:25:36.905050 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100143682000 7.629 MB
W20240131 23:25:36.905115 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100143e25000 7.629 MB
W20240131 23:25:36.905135 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001445c8000 7.629 MB
W20240131 23:25:36.905169 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100144d6b000 7.629 MB
W20240131 23:25:36.905189 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014550e000 7.629 MB
W20240131 23:25:36.905241 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100145cb1000 7.629 MB
W20240131 23:25:36.905308 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x100146454000 7.629 MB
W20240131 23:25:36.905368 3198521 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100146bf7000 7.629 MB
W20240131 23:25:36.905414 3198521 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10014739a000 80 B 
W20240131 23:25:36.905438 3198521 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10014739c000 8 B 
W20240131 23:25:36.905473 3198521 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 23:25:36.905743 3198521 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 23:25:38.325392 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1001473a0000 7.629 MB
W20240131 23:25:38.325546 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100147b43000 7.629 MB
W20240131 23:25:38.325577 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1001482e6000 7.629 MB
W20240131 23:25:38.325608 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100148a89000 7.629 MB
W20240131 23:25:38.325627 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10014922c000 7.629 MB
W20240131 23:25:38.325644 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1001499cf000 7.629 MB
W20240131 23:25:38.325671 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10014a172000 7.629 MB
W20240131 23:25:38.325708 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10014a915000 7.629 MB
W20240131 23:25:38.325745 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10014b0b8000 7.629 MB
W20240131 23:25:38.325773 3198523 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10014b85b000 7.629 MB
W20240131 23:25:38.325799 3198523 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10014bffe000 80 B 
W20240131 23:25:38.325822 3198523 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10014c000000 8 B 
W20240131 23:25:38.325845 3198523 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 23:25:38.326129 3198523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 23:25:38.329496 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10014c004000 7.629 MB
W20240131 23:25:38.329591 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10014c7a7000 7.629 MB
W20240131 23:25:38.329615 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10014cf4a000 7.629 MB
W20240131 23:25:38.329630 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10014d6ed000 7.629 MB
W20240131 23:25:38.329650 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10014de90000 7.629 MB
W20240131 23:25:38.329669 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10014e633000 7.629 MB
W20240131 23:25:38.329684 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10014edd6000 7.629 MB
W20240131 23:25:38.329711 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10014f579000 7.629 MB
W20240131 23:25:38.329727 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10014fd1c000 7.629 MB
W20240131 23:25:38.329756 3198253 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001504bf000 7.629 MB
W20240131 23:25:38.329772 3198253 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100150c62000 80 B 
W20240131 23:25:38.329789 3198253 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100150c64000 8 B 
W20240131 23:25:38.329808 3198253 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 23:25:38.329972 3198253 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 23:25:38.402340 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100150c68000 7.629 MB
W20240131 23:25:38.402599 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10015140b000 7.629 MB
W20240131 23:25:38.402700 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100151bae000 7.629 MB
W20240131 23:25:38.402794 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100152351000 7.629 MB
W20240131 23:25:38.402856 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100152af4000 7.629 MB
W20240131 23:25:38.402915 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100153297000 7.629 MB
W20240131 23:25:38.402980 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100153a3a000 7.629 MB
W20240131 23:25:38.403067 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1001541dd000 7.629 MB
W20240131 23:25:38.403155 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100154980000 7.629 MB
W20240131 23:25:38.403246 3198519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100155123000 7.629 MB
W20240131 23:25:38.403332 3198519 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1001558c6000 80 B 
W20240131 23:25:38.403421 3198519 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1001558c8000 8 B 
W20240131 23:25:38.403503 3198519 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240131 23:25:38.404202 3198519 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 23:25:38.405484 3198253 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 23:25:38.405592 3198253 grad_base.h:184] Init GradProcessingBase done
I20240131 23:25:40.521015 3198253 grad_async_v2.h:42] Use main thread to update emb.
W20240131 23:25:40.521256 3198253 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 23:25:40.521265 3198253 kg_controller.h:84] Construct KGCacheController done
E20240131 23:25:40.859784 3198253 recstore.cc:66] init folly done
E20240131 23:25:40.859843 3198523 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240131 23:25:40.860051 3198521 recstore.cc:66] init folly done
E20240131 23:25:40.860061 3198519 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 23:25:40.860867 3198253 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 23:25:41.822105 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 23:25:41.822377 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240131 23:25:42.822183 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:25:42.985638 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 23:25:43.822033 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 23:25:44.082129 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 23:25:44.822077 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:25:45.228191 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 23:25:45.822057 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 136.177 us                | 266.330 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 23:25:46.359396 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 23:25:46.822127 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=76
W20240131 23:25:47.418804 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 23:25:47.822244 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
Before Training
Before Training
I20240131 23:25:49.109567 3198519 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240131 23:25:49.109596 3198253 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 23:25:49.109877 3198523 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 23:25:49.110239 3198521 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
W20240131 23:25:49.125561 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 23:25:49.125973 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.473 us                | 516.704 us                |
| ProcessBack:Shuffle       | 515.851 ms                | 515.851 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:25:50.973759 3199365 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:25:51.218315 3198253 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
W20240131 23:25:51.439148 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [3198519 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3198253 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3198521 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3198523 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
E20240131 23:25:51.973063 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:25:52.852380 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240131 23:25:52.973095 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 4 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 175.539 us                | 435.476 us                |
| GenInput                  | 28.729 ms                 | 33.888 ms                 |
| NN                        | 825.644 us                | 205.381 ms                |
| Forward                   | 1.225 ms                  | 235.947 ms                |
| Backward                  | 2.632 ms                  | 162.060 ms                |
| Optimize                  | 253.439 us                | 8.375 ms                  |
| BarrierTimeBeforeRank0    | 34.545 us                 | 1.099 ms                  |
| AfterBackward             | 320.371 ms                | 1.668 s                   |
| BlockToStepN              | 118.374 us                | 201.994 ms                |
| OneStep                   | 355.227 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 23:25:53.947265 3198253 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
W20240131 23:25:53.964628 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 23:25:53.975152 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=186
W20240131 23:25:54.344452 3198253 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
========== Step 7 ========== 
E20240131 23:25:54.975006 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=541
W20240131 23:25:55.117015 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240131 23:25:55.393085 3198253 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
========== Step 9 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.404 us                | 271.083 us                |
| ProcessBack:Shuffle       | 357.448 ms                | 1.266 s                   |
| ProcessBack:UpdateCache   | 2.318 ms                  | 874.728 ms                |
| ProcessBack:UpsertPq      | 62.359 us                 | 244.732 ms                |
| ProcessOneStep            | 359.092 ms                | 1.668 s                   |
| BlockToStepN              | 45.072 us                 | 201.663 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 10 ========== 
E20240131 23:25:55.975086 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 11 ========== 
W20240131 23:25:56.359997 3198253 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
W20240131 23:25:56.444734 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
========== Step 13 ========== 
E20240131 23:25:56.975034 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 14 ========== 
E20240131 23:25:57.975057 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 15 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 180.184 us                | 527.195 us                |
| GenInput                  | 34.275 ms                 | 48.678 ms                 |
| NN                        | 769.854 us                | 205.381 ms                |
| Forward                   | 1.161 ms                  | 235.947 ms                |
| Backward                  | 2.484 ms                  | 162.060 ms                |
| Optimize                  | 225.544 us                | 8.375 ms                  |
| BarrierTimeBeforeRank0    | 344.699 us                | 2.088 ms                  |
| AfterBackward             | 359.130 ms                | 1.668 s                   |
| BlockToStepN              | 96.322 us                 | 201.994 ms                |
| OneStep                   | 397.197 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 23:25:58.454571 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240131 23:25:58.975013 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
W20240131 23:25:59.733932 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 23:25:59.975100 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 21 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.654 us                | 1.877 ms                  |
| ProcessBack:Shuffle       | 314.984 ms                | 1.266 s                   |
| ProcessBack:UpdateCache   | 1.465 ms                  | 874.728 ms                |
| ProcessBack:UpsertPq      | 54.036 us                 | 244.732 ms                |
| ProcessOneStep            | 320.298 ms                | 1.668 s                   |
| BlockToStepN              | 42.874 us                 | 201.663 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
E20240131 23:26:00.975260 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=272
W20240131 23:26:01.143883 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
========== Step 24 ========== 
E20240131 23:26:01.412264 3198253 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=24, sample_step_cpp_seen_[rank]=23
E20240131 23:26:01.975332 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:26:02.558413 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240131 23:26:02.975021 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 180.184 us                | 527.195 us                |
| GenInput                  | 34.581 ms                 | 48.678 ms                 |
| NN                        | 724.554 us                | 205.381 ms                |
| Forward                   | 1.118 ms                  | 235.947 ms                |
| Backward                  | 2.420 ms                  | 162.060 ms                |
| Optimize                  | 225.544 us                | 8.375 ms                  |
| BarrierTimeBeforeRank0    | 344.699 us                | 2.088 ms                  |
| AfterBackward             | 320.371 ms                | 1.668 s                   |
| BlockToStepN              | 96.322 us                 | 201.994 ms                |
| OneStep                   | 355.227 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:03.975371 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:26:04.053948 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 25 ========== 
========== Step 26 ========== 
E20240131 23:26:04.975020 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
========== Step 27 ========== 
W20240131 23:26:05.225206 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
========== Step 28 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.940 us                | 273.910 us                |
| ProcessBack:Shuffle       | 314.984 ms                | 1.266 s                   |
| ProcessBack:UpdateCache   | 1.447 ms                  | 874.728 ms                |
| ProcessBack:UpsertPq      | 55.693 us                 | 244.732 ms                |
| ProcessOneStep            | 328.161 ms                | 3.010 s                   |
| BlockToStepN              | 45.072 us                 | 201.663 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:05.975032 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:06.280656 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
========== Step 29 ========== 
========== Step 30 ========== 
E20240131 23:26:06.975029 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 31 ========== 
W20240131 23:26:07.297461 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
========== Step 32 ========== 
E20240131 23:26:07.975029 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 33 ========== 
W20240131 23:26:08.185472 3198253 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
========== Step 35 ========== 
W20240131 23:26:08.296130 3198253 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 180.184 us                | 4.548 ms                  |
| GenInput                  | 35.901 ms                 | 48.678 ms                 |
| NN                        | 688.076 us                | 205.381 ms                |
| Forward                   | 1.067 ms                  | 235.947 ms                |
| Backward                  | 2.414 ms                  | 162.060 ms                |
| Optimize                  | 213.861 us                | 8.375 ms                  |
| BarrierTimeBeforeRank0    | 512.258 us                | 2.316 ms                  |
| AfterBackward             | 320.371 ms                | 3.010 s                   |
| BlockToStepN              | 118.374 us                | 201.994 ms                |
| OneStep                   | 355.227 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 23:26:08.637357 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240131 23:26:08.975075 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:09.744369 3198253 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
========== Step 38 ========== 
E20240131 23:26:09.975044 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240131 23:26:10.014045 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
========== Step 39 ========== 
========== Step 40 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.600 us                | 6.207 ms                  |
| ProcessBack:Shuffle       | 314.984 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.447 ms                  | 874.728 ms                |
| ProcessBack:UpsertPq      | 59.095 us                 | 244.732 ms                |
| ProcessOneStep            | 328.161 ms                | 3.010 s                   |
| BlockToStepN              | 55.233 us                 | 201.663 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:10.975008 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240131 23:26:11.434685 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 23:26:11.975103 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:12.247257 3198253 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
========== Step 42 ========== 
W20240131 23:26:12.765230 3198253 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
E20240131 23:26:12.975044 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:13.005264 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 44 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.330 us                | 4.548 ms                  |
| GenInput                  | 36.106 ms                 | 48.678 ms                 |
| NN                        | 689.030 us                | 205.381 ms                |
| Forward                   | 1.080 ms                  | 235.947 ms                |
| Backward                  | 2.420 ms                  | 162.060 ms                |
| Optimize                  | 213.861 us                | 8.375 ms                  |
| BarrierTimeBeforeRank0    | 580.181 us                | 2.738 ms                  |
| AfterBackward             | 344.591 ms                | 3.010 s                   |
| BlockToStepN              | 132.240 us                | 201.994 ms                |
| OneStep                   | 397.092 ms                | 3.048 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
E20240131 23:26:13.975158 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:14.343338 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 23:26:14.975085 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:15.108952 3198253 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
E20240131 23:26:15.183212 3198253 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=49, sample_step_cpp_seen_[rank]=48
W20240131 23:26:15.567529 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 99.889 us                 | 188.651 us                |
| ProcessBack:Shuffle       | 299.771 ms                | 1.430 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 874.728 ms                |
| ProcessBack:UpsertPq      | 61.960 us                 | 244.732 ms                |
| ProcessOneStep            | 328.161 ms                | 3.010 s                   |
| BlockToStepN              | 77.779 us                 | 201.663 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:15.975015 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
E20240131 23:26:16.975131 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:17.244755 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
E20240131 23:26:17.975298 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 53 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.854 us                | 527.195 us                |
| GenInput                  | 36.106 ms                 | 47.983 ms                 |
| NN                        | 684.261 us                | 1.733 ms                  |
| Forward                   | 1.067 ms                  | 2.744 ms                  |
| Backward                  | 2.420 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 429.630 us                |
| BarrierTimeBeforeRank0    | 573.357 us                | 2.622 ms                  |
| AfterBackward             | 328.196 ms                | 2.245 s                   |
| BlockToStepN              | 135.183 us                | 424.465 us                |
| OneStep                   | 375.827 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 54 ========== 
W20240131 23:26:18.764840 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240131 23:26:18.975023 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=8
W20240131 23:26:19.185626 3198253 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
========== Step 56 ========== 
E20240131 23:26:19.975059 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 57 ========== 
W20240131 23:26:20.555516 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.594 us                | 1.567 ms                  |
| ProcessBack:Shuffle       | 323.396 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 7.097 ms                  |
| ProcessBack:UpsertPq      | 62.283 us                 | 166.979 us                |
| ProcessOneStep            | 359.092 ms                | 2.245 s                   |
| BlockToStepN              | 80.982 us                 | 305.632 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:20.975016 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 58 ========== 
W20240131 23:26:21.845721 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240131 23:26:21.975010 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
E20240131 23:26:22.975224 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=263
========== Step 63 ========== 
W20240131 23:26:23.270076 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.854 us                | 527.195 us                |
| GenInput                  | 36.162 ms                 | 47.983 ms                 |
| NN                        | 688.076 us                | 1.733 ms                  |
| Forward                   | 1.076 ms                  | 2.744 ms                  |
| Backward                  | 2.423 ms                  | 19.190 ms                 |
| Optimize                  | 213.861 us                | 429.630 us                |
| BarrierTimeBeforeRank0    | 573.357 us                | 2.622 ms                  |
| AfterBackward             | 359.130 ms                | 2.245 s                   |
| BlockToStepN              | 157.359 us                | 424.465 us                |
| OneStep                   | 397.197 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 64 ========== 
E20240131 23:26:23.975139 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 65 ========== 
========== Step 66 ========== 
W20240131 23:26:24.518754 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
========== Step 67 ========== 
E20240131 23:26:24.975028 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 68 ========== 
========== Step 69 ========== 
E20240131 23:26:25.667418 3198253 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=69, sample_step_cpp_seen_[rank]=68
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.404 us                | 5.969 ms                  |
| ProcessBack:Shuffle       | 323.396 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.435 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 61.511 us                 | 166.979 us                |
| ProcessOneStep            | 344.494 ms                | 2.245 s                   |
| BlockToStepN              | 88.251 us                 | 305.632 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:25.975092 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:26:26.020243 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 70 ========== 
E20240131 23:26:26.975030 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:26:27.182168 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 23:26:27.975039 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 23:26:28.275408 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 71 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.166 us                | 527.195 us                |
| GenInput                  | 36.283 ms                 | 48.454 ms                 |
| NN                        | 684.261 us                | 1.733 ms                  |
| Forward                   | 1.067 ms                  | 2.744 ms                  |
| Backward                  | 2.417 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 573.357 us                | 2.622 ms                  |
| AfterBackward             | 359.130 ms                | 2.245 s                   |
| BlockToStepN              | 160.055 us                | 424.465 us                |
| OneStep                   | 397.197 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 72 ========== 
E20240131 23:26:28.975445 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 73 ========== 
W20240131 23:26:29.323902 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 74 ========== 
E20240131 23:26:29.975124 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
========== Step 75 ========== 
W20240131 23:26:30.366514 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.196 us                | 277.303 us                |
| ProcessBack:Shuffle       | 327.546 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.425 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.874 us                 | 166.979 us                |
| ProcessOneStep            | 359.092 ms                | 2.245 s                   |
| BlockToStepN              | 96.143 us                 | 305.632 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:30.975572 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 76 ========== 
W20240131 23:26:31.769114 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
========== Step 77 ========== 
E20240131 23:26:31.975150 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:32.903223 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 23:26:32.975029 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 23:26:33.067329 3198253 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.166 us                | 527.195 us                |
| GenInput                  | 36.325 ms                 | 48.454 ms                 |
| NN                        | 682.354 us                | 1.733 ms                  |
| Forward                   | 1.052 ms                  | 2.744 ms                  |
| Backward                  | 2.417 ms                  | 19.190 ms                 |
| Optimize                  | 213.146 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 538.601 us                | 2.622 ms                  |
| AfterBackward             | 362.205 ms                | 2.245 s                   |
| BlockToStepN              | 166.410 us                | 424.465 us                |
| OneStep                   | 400.157 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 79 ========== 
W20240131 23:26:33.908123 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240131 23:26:33.975030 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 80 ========== 
========== Step 81 ========== 
E20240131 23:26:34.975519 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:35.095419 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
W20240131 23:26:35.766655 3198253 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.510 us                | 325.596 us                |
| ProcessBack:Shuffle       | 357.448 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.622 us                 | 166.979 us                |
| ProcessOneStep            | 368.430 ms                | 2.245 s                   |
| BlockToStepN              | 101.341 us                | 316.227 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:35.975006 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 23:26:36.242610 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 23:26:36.412274 3198253 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
E20240131 23:26:36.975271 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:37.065632 3198253 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
========== Step 85 ========== 
W20240131 23:26:37.529691 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240131 23:26:37.975102 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 86 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.427 us                | 527.195 us                |
| GenInput                  | 36.270 ms                 | 48.454 ms                 |
| NN                        | 671.148 us                | 1.733 ms                  |
| Forward                   | 1.050 ms                  | 2.744 ms                  |
| Backward                  | 2.417 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 538.601 us                | 2.622 ms                  |
| AfterBackward             | 384.697 ms                | 2.245 s                   |
| BlockToStepN              | 186.474 us                | 424.465 us                |
| OneStep                   | 422.441 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 23:26:38.629806 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240131 23:26:38.960186 3198253 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
E20240131 23:26:38.978914 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:39.714959 3198253 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
W20240131 23:26:39.725699 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 23:26:39.978152 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 89 ========== 
W20240131 23:26:40.832319 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 119.886 us                | 5.792 ms                  |
| ProcessBack:Shuffle       | 366.928 ms                | 1.406 s                   |
| ProcessBack:UpdateCache   | 1.148 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.622 us                 | 166.979 us                |
| ProcessOneStep            | 385.569 ms                | 2.245 s                   |
| BlockToStepN              | 119.468 us                | 360.852 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:40.978060 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
W20240131 23:26:41.025532 3198253 grad_async_v2.h:257] pq is empty
========== Step 90 ========== 
W20240131 23:26:42.025745 3198253 grad_async_v2.h:257] pq is empty
========== Step 91 ========== 
W20240131 23:26:42.038273 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 23:26:42.038621 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:43.025846 3198253 grad_async_v2.h:257] pq is empty
========== Step 92 ========== 
W20240131 23:26:43.038486 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 23:26:43.039191 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 93 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 170.396 us                | 527.195 us                |
| GenInput                  | 36.189 ms                 | 48.454 ms                 |
| NN                        | 663.519 us                | 1.733 ms                  |
| Forward                   | 1.035 ms                  | 7.635 ms                  |
| Backward                  | 2.412 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 573.357 us                | 2.738 ms                  |
| AfterBackward             | 385.593 ms                | 2.245 s                   |
| BlockToStepN              | 197.952 us                | 603.146 us                |
| OneStep                   | 429.499 ms                | 2.310 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:44.039018 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 23:26:44.284802 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 95 ========== 
E20240131 23:26:45.039026 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:45.416189 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.849 us                | 250.299 us                |
| ProcessBack:Shuffle       | 379.216 ms                | 1.429 s                   |
| ProcessBack:UpdateCache   | 1.144 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.525 us                 | 166.979 us                |
| ProcessOneStep            | 391.480 ms                | 2.245 s                   |
| BlockToStepN              | 123.865 us                | 412.344 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 23:26:45.893483 3198253 grad_async_v2.h:257] pq is empty
========== Step 96 ========== 
E20240131 23:26:46.039433 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
========== Step 97 ========== 
W20240131 23:26:46.726734 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 23:26:47.039008 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:26:47.217382 3198253 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
========== Step 99 ========== 
Step99:rank0, time: 74.950, per_step: 0.749496
Step99:rank3, time: 74.950, per_step: 0.749496
Step99:rank2, time: 74.950, per_step: 0.749498
Step99:rank1, time: 74.950, per_step: 0.749495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 170.396 us                | 527.195 us                |
| GenInput                  | 36.165 ms                 | 48.454 ms                 |
| NN                        | 663.519 us                | 1.733 ms                  |
| Forward                   | 1.035 ms                  | 7.635 ms                  |
| Backward                  | 2.414 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 593.012 us                | 3.911 ms                  |
| AfterBackward             | 385.593 ms                | 2.245 s                   |
| BlockToStepN              | 202.571 us                | 603.146 us                |
| OneStep                   | 431.933 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240131 23:26:47.726768 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 23:26:48.039014 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 170.396 us                | 527.195 us                |
| GenInput                  | 36.165 ms                 | 48.454 ms                 |
| NN                        | 663.519 us                | 1.733 ms                  |
| Forward                   | 1.035 ms                  | 7.635 ms                  |
| Backward                  | 2.417 ms                  | 19.190 ms                 |
| Optimize                  | 213.146 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 595.485 us                | 3.911 ms                  |
| AfterBackward             | 385.593 ms                | 2.245 s                   |
| BlockToStepN              | 202.571 us                | 603.146 us                |
| OneStep                   | 429.499 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:26:48.989189 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 101 ========== 
E20240131 23:26:49.039016 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=97
W20240131 23:26:49.789904 3198253 grad_async_v2.h:257] pq is empty
========== Step 102 ========== 
E20240131 23:26:50.039031 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:26:50.105545 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240131 23:26:50.452172 3198253 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.390 us                | 998.055 us                |
| ProcessBack:Shuffle       | 383.508 ms                | 1.430 s                   |
| ProcessBack:UpdateCache   | 1.132 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.874 us                 | 166.979 us                |
| ProcessOneStep            | 396.711 ms                | 2.245 s                   |
| BlockToStepN              | 129.206 us                | 412.344 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:51.039253 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:51.125828 3198253 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
W20240131 23:26:51.137391 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 105 ========== 
E20240131 23:26:52.039225 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:52.451021 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 23:26:52.674937 3198253 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
E20240131 23:26:53.039127 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=46
========== Step 110 ========== 
========== Step 111 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.848 us                | 527.195 us                |
| GenInput                  | 36.036 ms                 | 48.454 ms                 |
| NN                        | 659.943 us                | 1.733 ms                  |
| Forward                   | 1.016 ms                  | 7.635 ms                  |
| Backward                  | 2.420 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 620.138 us                | 3.911 ms                  |
| AfterBackward             | 385.593 ms                | 2.245 s                   |
| BlockToStepN              | 215.388 us                | 603.146 us                |
| OneStep                   | 429.499 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:54.039153 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:54.200135 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 112 ========== 
E20240131 23:26:55.039016 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 156.966 us                | 1.276 ms                  |
| ProcessBack:Shuffle       | 366.928 ms                | 1.430 s                   |
| ProcessBack:UpdateCache   | 1.132 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.525 us                 | 166.979 us                |
| ProcessOneStep            | 385.569 ms                | 2.245 s                   |
| BlockToStepN              | 133.931 us                | 420.403 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:26:56.039052 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
W20240131 23:26:56.198911 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
========== Step 113 ========== 
E20240131 23:26:57.039814 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:26:57.469097 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 114 ========== 
E20240131 23:26:58.039139 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.848 us                | 527.195 us                |
| GenInput                  | 36.106 ms                 | 48.454 ms                 |
| NN                        | 662.088 us                | 1.733 ms                  |
| Forward                   | 1.028 ms                  | 7.635 ms                  |
| Backward                  | 2.425 ms                  | 19.190 ms                 |
| Optimize                  | 213.146 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 628.267 us                | 3.911 ms                  |
| AfterBackward             | 391.524 ms                | 2.245 s                   |
| BlockToStepN              | 216.842 us                | 603.146 us                |
| OneStep                   | 431.933 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:26:58.483772 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 23:26:58.843688 3198253 grad_async_v2.h:257] pq is empty
========== Step 115 ========== 
E20240131 23:26:59.039012 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 23:26:59.497859 3198253 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
W20240131 23:26:59.505223 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 23:27:00.039090 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=24
W20240131 23:27:00.378104 3198253 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
W20240131 23:27:00.573356 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.158 us                | 258.252 us                |
| ProcessBack:Shuffle       | 384.166 ms                | 1.436 s                   |
| ProcessBack:UpdateCache   | 1.132 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.660 us                 | 166.979 us                |
| ProcessOneStep            | 422.477 ms                | 2.245 s                   |
| BlockToStepN              | 138.236 us                | 431.155 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:01.039023 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:27:01.442090 3198253 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
W20240131 23:27:01.496788 3198253 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 120 ========== 
W20240131 23:27:01.659677 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 23:27:02.039060 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:02.956929 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240131 23:27:03.039006 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 23:27:03.121666 3198253 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.571 us                | 527.195 us                |
| GenInput                  | 36.004 ms                 | 48.454 ms                 |
| NN                        | 656.128 us                | 1.733 ms                  |
| Forward                   | 1.022 ms                  | 7.635 ms                  |
| Backward                  | 2.423 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 628.267 us                | 3.911 ms                  |
| AfterBackward             | 422.532 ms                | 2.245 s                   |
| BlockToStepN              | 220.182 us                | 603.146 us                |
| OneStep                   | 471.625 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
E20240131 23:27:04.039112 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=133
W20240131 23:27:04.046314 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
E20240131 23:27:05.039053 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240131 23:27:05.717800 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.205 us                | 1.545 ms                  |
| ProcessBack:Shuffle       | 383.508 ms                | 1.436 s                   |
| ProcessBack:UpdateCache   | 1.132 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.166 us                 | 166.979 us                |
| ProcessOneStep            | 396.711 ms                | 2.245 s                   |
| BlockToStepN              | 151.819 us                | 431.459 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:06.041219 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 128 ========== 
W20240131 23:27:06.728490 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240131 23:27:07.041100 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 129 ========== 
W20240131 23:27:07.921217 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 23:27:08.041160 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.848 us                | 527.195 us                |
| GenInput                  | 36.036 ms                 | 48.454 ms                 |
| NN                        | 661.135 us                | 1.733 ms                  |
| Forward                   | 1.029 ms                  | 7.635 ms                  |
| Backward                  | 2.423 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 675.037 us                | 3.911 ms                  |
| AfterBackward             | 416.270 ms                | 2.245 s                   |
| BlockToStepN              | 224.762 us                | 603.146 us                |
| OneStep                   | 459.485 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:09.041221 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 130 ========== 
W20240131 23:27:09.300807 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 23:27:10.041019 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:10.418211 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.501 us                | 12.424 ms                 |
| ProcessBack:Shuffle       | 384.166 ms                | 1.436 s                   |
| ProcessBack:UpdateCache   | 1.133 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 416.241 ms                | 2.245 s                   |
| BlockToStepN              | 162.251 us                | 489.554 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:11.041079 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:27:11.420100 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240131 23:27:12.041015 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=43
========== Step 134 ========== 
W20240131 23:27:12.441915 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 23:27:13.041114 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
W20240131 23:27:13.340574 3198253 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
========== Step 136 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.848 us                | 527.195 us                |
| GenInput                  | 36.106 ms                 | 48.454 ms                 |
| NN                        | 661.135 us                | 1.733 ms                  |
| Forward                   | 1.029 ms                  | 7.635 ms                  |
| Backward                  | 2.425 ms                  | 19.190 ms                 |
| Optimize                  | 212.431 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 685.894 us                | 3.911 ms                  |
| AfterBackward             | 416.270 ms                | 2.245 s                   |
| BlockToStepN              | 240.003 us                | 2.042 ms                  |
| OneStep                   | 459.485 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:13.544514 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 23:27:14.041065 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=92
W20240131 23:27:14.738360 3198253 grad_async_v2.h:257] pq is empty
W20240131 23:27:14.747256 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 137 ========== 
E20240131 23:27:15.041090 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:15.413390 3198253 grad_async_v2.h:257] pq is empty
========== Step 138 ========== 
W20240131 23:27:15.795593 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.169 us                | 1.960 ms                  |
| ProcessBack:Shuffle       | 389.656 ms                | 1.436 s                   |
| ProcessBack:UpdateCache   | 1.103 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.525 us                 | 5.523 ms                  |
| ProcessOneStep            | 422.477 ms                | 2.245 s                   |
| BlockToStepN              | 164.290 us                | 628.808 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:16.041015 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:27:16.220425 3198253 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
W20240131 23:27:17.037099 3199155 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240131 23:27:17.041067 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=121
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
E20240131 23:27:18.041301 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.844 us                | 527.195 us                |
| GenInput                  | 36.023 ms                 | 48.454 ms                 |
| NN                        | 656.128 us                | 1.733 ms                  |
| Forward                   | 1.022 ms                  | 7.635 ms                  |
| Backward                  | 2.444 ms                  | 19.190 ms                 |
| Optimize                  | 211.954 us                | 3.913 ms                  |
| BarrierTimeBeforeRank0    | 675.037 us                | 3.911 ms                  |
| AfterBackward             | 422.532 ms                | 2.245 s                   |
| BlockToStepN              | 251.351 us                | 2.042 ms                  |
| OneStep                   | 471.625 ms                | 2.310 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:18.513960 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240131 23:27:18.910987 3198253 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
E20240131 23:27:19.041257 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=159
========== Step 146 ========== 
========== Step 147 ========== 
W20240131 23:27:19.922809 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240131 23:27:20.041115 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
========== Step 148 ========== 
========== Step 149 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.094 us                | 1.038 ms                  |
| ProcessBack:Shuffle       | 389.656 ms                | 1.436 s                   |
| ProcessBack:UpdateCache   | 1.132 ms                  | 10.870 ms                 |
| ProcessBack:UpsertPq      | 60.166 us                 | 5.523 ms                  |
| ProcessOneStep            | 422.477 ms                | 2.245 s                   |
| BlockToStepN              | 185.884 us                | 628.808 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:20.931423 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240131 23:27:21.041182 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
========== Step 150 ========== 
E20240131 23:27:22.041107 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:22.672744 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240131 23:27:23.041091 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
========== Step 151 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.844 us                | 435.476 us                |
| GenInput                  | 36.023 ms                 | 47.983 ms                 |
| NN                        | 660.419 us                | 1.567 ms                  |
| Forward                   | 1.029 ms                  | 2.744 ms                  |
| Backward                  | 2.426 ms                  | 15.833 ms                 |
| Optimize                  | 211.954 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 628.267 us                | 3.887 ms                  |
| AfterBackward             | 446.530 ms                | 2.103 s                   |
| BlockToStepN              | 265.576 us                | 693.483 us                |
| OneStep                   | 496.448 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:24.041132 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240131 23:27:24.128734 3198253 grad_async_v2.h:257] pq is empty
========== Step 152 ========== 
W20240131 23:27:24.152211 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
E20240131 23:27:25.041040 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.484 us                | 2.089 ms                  |
| ProcessBack:Shuffle       | 384.166 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.144 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 416.241 ms                | 2.102 s                   |
| BlockToStepN              | 217.365 us                | 608.674 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:26.041013 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 23:27:26.293466 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
W20240131 23:27:26.383915 3198253 grad_async_v2.h:257] pq is empty
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
E20240131 23:27:27.041095 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 23:27:27.405556 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 23:27:28.041175 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.488 us                | 435.476 us                |
| GenInput                  | 36.036 ms                 | 47.983 ms                 |
| NN                        | 659.943 us                | 1.567 ms                  |
| Forward                   | 1.028 ms                  | 2.744 ms                  |
| Backward                  | 2.423 ms                  | 15.833 ms                 |
| Optimize                  | 211.716 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 675.037 us                | 3.887 ms                  |
| AfterBackward             | 396.744 ms                | 2.103 s                   |
| BlockToStepN              | 283.946 us                | 693.483 us                |
| OneStep                   | 441.253 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:29.014958 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240131 23:27:29.041215 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 164 ========== 
E20240131 23:27:30.041172 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.262 us                | 5.526 ms                  |
| ProcessBack:Shuffle       | 383.508 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.148 ms                  | 8.328 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 396.711 ms                | 2.102 s                   |
| BlockToStepN              | 229.254 us                | 608.674 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:31.047252 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=46
W20240131 23:27:31.138295 3199155 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 165 ========== 
========== Step 166 ========== 
E20240131 23:27:32.047041 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 23:27:32.597666 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 23:27:33.047012 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=135
W20240131 23:27:33.414974 3198253 grad_async_v2.h:257] pq is empty
========== Step 167 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.108 us                | 435.476 us                |
| GenInput                  | 36.036 ms                 | 47.983 ms                 |
| NN                        | 660.419 us                | 1.567 ms                  |
| Forward                   | 1.029 ms                  | 2.744 ms                  |
| Backward                  | 2.425 ms                  | 15.833 ms                 |
| Optimize                  | 211.716 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 685.894 us                | 3.887 ms                  |
| AfterBackward             | 422.532 ms                | 2.103 s                   |
| BlockToStepN              | 293.678 us                | 693.483 us                |
| OneStep                   | 471.625 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:33.736567 3199155 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 23:27:34.047036 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 23:27:34.074520 3198253 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
========== Step 169 ========== 
W20240131 23:27:34.296833 3198253 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
========== Step 171 ========== 
E20240131 23:27:35.047145 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:35.242028 3199155 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.482 us                | 609.113 us                |
| ProcessBack:Shuffle       | 384.166 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.148 ms                  | 9.971 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 416.241 ms                | 2.102 s                   |
| BlockToStepN              | 235.670 us                | 608.674 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 172 ========== 
========== Step 173 ========== 
E20240131 23:27:36.047431 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:36.397994 3199155 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240131 23:27:37.047014 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240131 23:27:37.471923 3198253 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
W20240131 23:27:37.678457 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
========== Step 177 ========== 
========== Step 178 ========== 
E20240131 23:27:38.047156 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=109
========== Step 179 ========== 
========== Step 180 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.885 us                | 435.476 us                |
| GenInput                  | 36.069 ms                 | 47.983 ms                 |
| NN                        | 656.128 us                | 1.567 ms                  |
| Forward                   | 1.022 ms                  | 2.744 ms                  |
| Backward                  | 2.417 ms                  | 15.833 ms                 |
| Optimize                  | 209.808 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 809.254 us                | 3.887 ms                  |
| AfterBackward             | 385.593 ms                | 2.103 s                   |
| BlockToStepN              | 315.901 us                | 693.483 us                |
| OneStep                   | 429.499 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:39.047086 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=44
W20240131 23:27:39.297567 3198253 grad_async_v2.h:257] pq is empty
========== Step 181 ========== 
W20240131 23:27:39.770419 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240131 23:27:40.047014 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
========== Step 182 ========== 
========== Step 183 ========== 
W20240131 23:27:40.836570 3198253 grad_async_v2.h:257] pq is empty
========== Step 184 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.477 us                | 11.558 ms                 |
| ProcessBack:Shuffle       | 379.216 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.162 ms                  | 9.971 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 391.480 ms                | 2.102 s                   |
| BlockToStepN              | 251.399 us                | 628.808 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:41.047081 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 23:27:41.195611 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 185 ========== 
========== Step 186 ========== 
E20240131 23:27:42.047013 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
========== Step 187 ========== 
========== Step 188 ========== 
W20240131 23:27:42.841923 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 23:27:43.047109 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.188 us                | 435.476 us                |
| GenInput                  | 36.036 ms                 | 47.983 ms                 |
| NN                        | 659.943 us                | 2.293 ms                  |
| Forward                   | 1.027 ms                  | 7.635 ms                  |
| Backward                  | 2.417 ms                  | 15.833 ms                 |
| Optimize                  | 210.047 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 809.254 us                | 3.887 ms                  |
| AfterBackward             | 385.593 ms                | 2.103 s                   |
| BlockToStepN              | 327.340 us                | 2.042 ms                  |
| OneStep                   | 429.499 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 189 ========== 
========== Step 190 ========== 
E20240131 23:27:44.047428 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 23:27:44.170456 3199155 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240131 23:27:45.047015 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
W20240131 23:27:45.729920 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 194 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.100 us                | 11.435 ms                 |
| ProcessBack:Shuffle       | 366.341 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.162 ms                  | 9.971 ms                  |
| ProcessBack:UpsertPq      | 60.515 us                 | 166.979 us                |
| ProcessOneStep            | 385.467 ms                | 2.102 s                   |
| BlockToStepN              | 272.705 us                | 658.122 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 23:27:46.047008 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 23:27:47.047084 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=108
========== Step 195 ========== 
W20240131 23:27:47.215303 3199155 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 196 ========== 
========== Step 197 ========== 
E20240131 23:27:48.050863 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240131 23:27:48.104804 3198253 grad_async_v2.h:257] pq is empty
========== Step 198 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.488 us                | 435.476 us                |
| GenInput                  | 36.004 ms                 | 48.118 ms                 |
| NN                        | 661.850 us                | 2.293 ms                  |
| Forward                   | 1.033 ms                  | 7.635 ms                  |
| Backward                  | 2.417 ms                  | 15.833 ms                 |
| Optimize                  | 211.239 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 703.267 us                | 3.887 ms                  |
| AfterBackward             | 385.498 ms                | 2.103 s                   |
| BlockToStepN              | 338.468 us                | 2.042 ms                  |
| OneStep                   | 426.839 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 58.438 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:48.637363 3199155 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 23:27:49.050401 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
========== Step 199 ========== 
W20240131 23:27:50.029783 3199155 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240131 23:27:50.050626 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
Step199:rank2, time: 62.810, per_step: 0.621882
Step199:rank3, time: 62.810, per_step: 0.621883
Step199:rank1, time: 62.810, per_step: 0.621883
Step199:rank0, time: 62.810, per_step: 0.621883
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.488 us                | 435.476 us                |
| GenInput                  | 36.004 ms                 | 48.118 ms                 |
| NN                        | 661.850 us                | 2.293 ms                  |
| Forward                   | 1.033 ms                  | 7.635 ms                  |
| Backward                  | 2.417 ms                  | 15.833 ms                 |
| Optimize                  | 211.239 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 703.267 us                | 3.887 ms                  |
| AfterBackward             | 385.593 ms                | 2.103 s                   |
| BlockToStepN              | 343.864 us                | 2.042 ms                  |
| OneStep                   | 429.499 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 62.811 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 23:27:50.381893 3198253 grad_async_v2.h:84] call StopThreads. PID = 3198253
W20240131 23:27:50.381930 3198253 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 23:27:50.381961 3198253 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 23:27:50.381968 3198253 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.028 us                | 248.614 us                |
| ProcessBack:Shuffle       | 366.928 ms                | 1.435 s                   |
| ProcessBack:UpdateCache   | 1.301 ms                  | 10.870 ms                 |
| ProcessBack:UpsertPq      | 60.525 us                 | 166.979 us                |
| ProcessOneStep            | 385.569 ms                | 2.102 s                   |
| BlockToStepN              | 277.421 us                | 723.967 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 23:27:51.031050 3199155 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240131 23:27:51.050096 3199155 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240131 23:27:51.798756 3198253 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.488 us                | 435.476 us                |
| GenInput                  | 36.004 ms                 | 48.118 ms                 |
| NN                        | 661.850 us                | 2.293 ms                  |
| Forward                   | 1.033 ms                  | 7.635 ms                  |
| Backward                  | 2.417 ms                  | 15.833 ms                 |
| Optimize                  | 211.239 us                | 2.044 ms                  |
| BarrierTimeBeforeRank0    | 703.267 us                | 3.887 ms                  |
| AfterBackward             | 385.593 ms                | 2.103 s                   |
| BlockToStepN              | 343.864 us                | 2.042 ms                  |
| OneStep                   | 429.499 ms                | 2.287 s                   |
| E2E-100                   | 58.438 s                  | 62.811 s                  |
+---------------------------+---------------------------+---------------------------+
