WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 21:51:46.676856 2985232 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 21:51:46.677980 2985232 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [2985232 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f62502251c0>==========
Worker 1 pid=2985380
Worker 2 pid=2985382
INFO [2985232 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2985380 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2985384 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2985382 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2985384 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2985382 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:51:51.473954 2985384 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 21:51:51.474440 2985382 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [2985232 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:51:51.475039 2985232 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [2985380 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 21:51:51.476444 2985380 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 21:51:53.340960 2985232 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [944920, 32]; dev=0; size=115.3 MB
W20240131 21:51:53.340937 2985380 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [944920, 32]; dev=1; size=115.3 MB
W20240131 21:51:53.340965 2985382 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [944920, 32]; dev=2; size=115.3 MB
W20240131 21:51:53.340965 2985384 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [944920, 32]; dev=3; size=115.3 MB
W20240131 21:51:53.342054 2985384 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100048183000 7.629 MB
W20240131 21:51:53.342057 2985380 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100048926000 7.629 MB
W20240131 21:51:53.342060 2985382 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000490c9000 7.629 MB
W20240131 21:51:53.342099 2985232 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10004986c000 7.629 MB
W20240131 21:51:53.342150 2985380 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10004a00f000 7.629 MB
W20240131 21:51:53.342154 2985382 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10004a7b2000 7.629 MB
W20240131 21:51:53.342161 2985384 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10004af55000 7.629 MB
W20240131 21:51:53.342167 2985232 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10004b6f8000 7.629 MB
W20240131 21:51:53.342192 2985382 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10004be9b000 122.1 MB
W20240131 21:51:53.342195 2985380 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000538af000 122.1 MB
W20240131 21:51:53.342198 2985384 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10005b2c3000 122.1 MB
W20240131 21:51:53.342201 2985232 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100062cd7000 122.1 MB
W20240131 21:51:53.342229 2985382 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10006a6eb000 122.1 MB
W20240131 21:51:53.342232 2985384 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000720ff000 122.1 MB
W20240131 21:51:53.342239 2985380 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100079b13000 122.1 MB
W20240131 21:51:53.342242 2985232 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100081527000 122.1 MB
W20240131 21:51:53.342262 2985382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 21:51:53.342263 2985384 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 21:51:53.342279 2985232 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 21:51:53.342281 2985380 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 21:51:53.342933 2985382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 21:51:53.342943 2985384 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 21:51:53.342953 2985380 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 21:51:53.342965 2985232 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 3 pid=2985384
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 944920), (944920, 1889840), (1889840, 2834760), (2834760, 3779680)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240131 21:51:57.995318 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100088f4b000 7.629 MB
W20240131 21:51:57.995496 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000896ee000 7.629 MB
W20240131 21:51:57.995522 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100089e91000 7.629 MB
W20240131 21:51:57.995545 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008a634000 7.629 MB
W20240131 21:51:57.995569 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008add7000 7.629 MB
W20240131 21:51:57.995596 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10008b57a000 7.629 MB
W20240131 21:51:57.995618 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10008bd1d000 7.629 MB
W20240131 21:51:57.995648 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10008c4c0000 7.629 MB
W20240131 21:51:57.995668 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10008cc63000 7.629 MB
W20240131 21:51:57.995692 2985382 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10008d406000 7.629 MB
W20240131 21:51:57.995713 2985382 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10008dba9000 80 B 
W20240131 21:51:57.995734 2985382 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10008dbab000 8 B 
W20240131 21:51:57.995749 2985382 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:51:57.996013 2985382 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 21:51:58.017706 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10008dbaf000 7.629 MB
W20240131 21:51:58.017864 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10008e352000 7.629 MB
W20240131 21:51:58.017890 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10008eaf5000 7.629 MB
W20240131 21:51:58.017913 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10008f298000 7.629 MB
W20240131 21:51:58.017936 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10008fa3b000 7.629 MB
W20240131 21:51:58.017958 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000901de000 7.629 MB
W20240131 21:51:58.017990 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100090981000 7.629 MB
W20240131 21:51:58.018021 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100091124000 7.629 MB
W20240131 21:51:58.018039 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000918c7000 7.629 MB
W20240131 21:51:58.018064 2985384 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10009206a000 7.629 MB
W20240131 21:51:58.018093 2985384 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10009280d000 80 B 
W20240131 21:51:58.018116 2985384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10009280f000 8 B 
W20240131 21:51:58.018133 2985384 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:51:58.018386 2985384 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:51:59.108292 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100092813000 7.629 MB
W20240131 21:51:59.108625 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100092fb6000 7.629 MB
W20240131 21:51:59.108675 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100093759000 7.629 MB
W20240131 21:51:59.108705 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100093efc000 7.629 MB
W20240131 21:51:59.108727 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10009469f000 7.629 MB
W20240131 21:51:59.108752 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100094e42000 7.629 MB
W20240131 21:51:59.108780 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000955e5000 7.629 MB
W20240131 21:51:59.108815 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100095d88000 7.629 MB
W20240131 21:51:59.108839 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10009652b000 7.629 MB
W20240131 21:51:59.108858 2985232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100096cce000 7.629 MB
W20240131 21:51:59.108896 2985232 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100097471000 80 B 
W20240131 21:51:59.108938 2985232 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100097473000 8 B 
W20240131 21:51:59.108960 2985232 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:51:59.109627 2985232 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:51:59.166848 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100097477000 7.629 MB
W20240131 21:51:59.166987 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100097c1a000 7.629 MB
W20240131 21:51:59.167013 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000983bd000 7.629 MB
W20240131 21:51:59.167038 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100098b60000 7.629 MB
W20240131 21:51:59.167063 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100099303000 7.629 MB
W20240131 21:51:59.167089 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100099aa6000 7.629 MB
W20240131 21:51:59.167115 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10009a249000 7.629 MB
W20240131 21:51:59.167145 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10009a9ec000 7.629 MB
W20240131 21:51:59.167168 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009b18f000 7.629 MB
W20240131 21:51:59.167193 2985380 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10009b932000 7.629 MB
W20240131 21:51:59.167219 2985380 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10009c0d5000 80 B 
W20240131 21:51:59.167255 2985380 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10009c0d7000 8 B 
W20240131 21:51:59.167274 2985380 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 21:51:59.167563 2985380 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 21:51:59.168946 2985232 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 0.01,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 21:51:59.169045 2985232 grad_base.h:184] Init GradProcessingBase done
I20240131 21:51:59.825429 2985232 grad_async_v2.h:42] Use main thread to update emb.
W20240131 21:51:59.825700 2985232 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 21:51:59.825708 2985232 kg_controller.h:84] Construct KGCacheController done
E20240131 21:52:01.175256 2985232 recstore.cc:66] init folly done
E20240131 21:52:01.175284 2985380 recstore.cc:66] init folly done
E20240131 21:52:01.175312 2985382 recstore.cc:66] init folly done
E20240131 21:52:01.175320 2985384 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 21:52:01.176314 2985232 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 21:52:02.019964 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 21:52:02.020479 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 21:52:03.020037 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:03.112406 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 21:52:04.020135 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:04.151746 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:52:05.020018 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:52:05.240716 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 21:52:06.020110 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.499 us                | 207.008 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:06.257395 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 21:52:07.020161 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:07.281782 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
Before Training
I20240131 21:52:08.814698 2985232 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
I20240131 21:52:08.814903 2985380 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 21:52:08.815232 2985384 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 21:52:08.815647 2985382 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
W20240131 21:52:08.817512 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 21:52:08.817713 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 210.467 us                | 210.467 us                |
| GenInput                  | 34.774 ms                 | 34.774 ms                 |
| NN                        | 188.374 ms                | 188.374 ms                |
| Forward                   | 220.753 ms                | 220.753 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:10.531363 2986222 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:10.894869 2985232 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 169.522 us                | 296.838 us                |
| ProcessBack:Shuffle       | 355.329 ms                | 355.329 ms                |
| ProcessBack:UpdateCache   | 829.323 ms                | 829.323 ms                |
| ProcessBack:UpsertPq      | 363.858 ms                | 363.858 ms                |
| ProcessOneStep            | 1.571 s                   | 1.571 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
W20240131 21:52:11.225739 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
INFO [2985380 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2985382 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2985232 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [2985384 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
E20240131 21:52:11.531014 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=34
W20240131 21:52:12.237584 2985232 grad_async_v2.h:257] pq is empty
========== Step 3 ========== 
W20240131 21:52:12.254374 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:52:12.531119 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:12.749572 2985232 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
========== Step 5 ========== 
W20240131 21:52:13.370018 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240131 21:52:13.531088 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:13.744529 2985232 grad_async_v2.h:257] pq is empty
========== Step 6 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.503 us                | 210.467 us                |
| GenInput                  | 34.774 ms                 | 43.406 ms                 |
| NN                        | 835.180 us                | 188.374 ms                |
| Forward                   | 1.213 ms                  | 220.753 ms                |
| Backward                  | 2.263 ms                  | 226.570 ms                |
| Optimize                  | 244.379 us                | 6.512 ms                  |
| BarrierTimeBeforeRank0    | 570.628 us                | 16.744 ms                 |
| AfterBackward             | 473.705 ms                | 1.571 s                   |
| BlockToStepN              | 104.192 us                | 317.726 ms                |
| OneStep                   | 512.117 ms                | 2.397 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:14.245625 2985232 grad_async_v2.h:257] pq is empty
========== Step 7 ========== 
W20240131 21:52:14.379890 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240131 21:52:14.531095 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:14.759690 2985232 grad_async_v2.h:257] pq is empty
========== Step 8 ========== 
W20240131 21:52:15.269408 2985232 grad_async_v2.h:257] pq is empty
========== Step 9 ========== 
W20240131 21:52:15.393481 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 10 ========== 
E20240131 21:52:15.531078 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=187
========== Step 11 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.087 us                | 252.329 us                |
| ProcessBack:Shuffle       | 464.852 ms                | 867.436 ms                |
| ProcessBack:UpdateCache   | 1.481 ms                  | 829.323 ms                |
| ProcessBack:UpsertPq      | 60.740 us                 | 363.858 ms                |
| ProcessOneStep            | 473.663 ms                | 1.571 s                   |
| BlockToStepN              | 82.209 us                 | 317.371 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 12 ========== 
W20240131 21:52:16.405062 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 13 ========== 
E20240131 21:52:16.531045 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=332
W20240131 21:52:16.666507 2985232 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
========== Step 15 ========== 
W20240131 21:52:16.891799 2985232 grad_async_v2.h:257] pq is empty
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
W20240131 21:52:17.433458 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 21:52:17.531008 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
========== Step 20 ========== 
E20240131 21:52:18.531169 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 21 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.437 us                | 6.115 ms                  |
| GenInput                  | 30.545 ms                 | 43.406 ms                 |
| NN                        | 694.275 us                | 188.374 ms                |
| Forward                   | 1.045 ms                  | 220.753 ms                |
| Backward                  | 1.943 ms                  | 226.570 ms                |
| Optimize                  | 222.445 us                | 6.512 ms                  |
| BarrierTimeBeforeRank0    | 448.082 us                | 16.744 ms                 |
| AfterBackward             | 277.341 ms                | 1.571 s                   |
| BlockToStepN              | 121.147 us                | 317.726 ms                |
| OneStep                   | 324.703 ms                | 2.397 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 22 ========== 
W20240131 21:52:19.329476 2985232 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
E20240131 21:52:19.430780 2985232 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=23, sample_step_cpp_seen_[rank]=22
W20240131 21:52:19.529915 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:52:19.531003 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
E20240131 21:52:20.531294 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:20.643189 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.750 us                | 210.242 us                |
| ProcessBack:Shuffle       | 270.758 ms                | 1.365 s                   |
| ProcessBack:UpdateCache   | 1.053 ms                  | 829.323 ms                |
| ProcessBack:UpsertPq      | 54.047 us                 | 363.858 ms                |
| ProcessOneStep            | 272.290 ms                | 1.571 s                   |
| BlockToStepN              | 66.024 us                 | 317.371 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:21.531016 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:21.684393 2985232 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
W20240131 21:52:22.274665 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
========== Step 28 ========== 
E20240131 21:52:22.531086 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 29 ========== 
W20240131 21:52:23.438638 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
E20240131 21:52:23.531034 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.437 us                | 6.115 ms                  |
| GenInput                  | 31.780 ms                 | 43.406 ms                 |
| NN                        | 699.520 us                | 188.374 ms                |
| Forward                   | 1.076 ms                  | 220.753 ms                |
| Backward                  | 2.065 ms                  | 226.570 ms                |
| Optimize                  | 222.445 us                | 6.512 ms                  |
| BarrierTimeBeforeRank0    | 361.126 us                | 16.744 ms                 |
| AfterBackward             | 277.341 ms                | 1.571 s                   |
| BlockToStepN              | 145.649 us                | 317.726 ms                |
| OneStep                   | 324.703 ms                | 2.397 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 30 ========== 
W20240131 21:52:24.452931 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240131 21:52:24.522255 2985232 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
E20240131 21:52:24.531723 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
========== Step 32 ========== 
========== Step 33 ========== 
W20240131 21:52:25.169899 2985232 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
E20240131 21:52:25.531149 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 35 ========== 
W20240131 21:52:25.806383 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
========== Step 36 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.007 us                | 11.917 ms                 |
| ProcessBack:Shuffle       | 272.536 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.420 ms                  | 829.323 ms                |
| ProcessBack:UpsertPq      | 54.779 us                 | 363.858 ms                |
| ProcessOneStep            | 273.408 ms                | 1.571 s                   |
| BlockToStepN              | 77.512 us                 | 317.371 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:26.531028 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 38 ========== 
========== Step 39 ========== 
W20240131 21:52:27.065119 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240131 21:52:27.531018 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 40 ========== 
========== Step 41 ========== 
W20240131 21:52:28.080931 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240131 21:52:28.531318 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:29.044697 2985232 grad_async_v2.h:257] pq is empty
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.126 us                | 6.115 ms                  |
| GenInput                  | 32.325 ms                 | 43.406 ms                 |
| NN                        | 710.487 us                | 188.374 ms                |
| Forward                   | 1.076 ms                  | 220.753 ms                |
| Backward                  | 2.082 ms                  | 226.570 ms                |
| Optimize                  | 220.299 us                | 6.512 ms                  |
| BarrierTimeBeforeRank0    | 271.233 us                | 16.744 ms                 |
| AfterBackward             | 273.457 ms                | 1.571 s                   |
| BlockToStepN              | 149.402 us                | 317.726 ms                |
| OneStep                   | 310.968 ms                | 2.397 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:29.308668 2985232 grad_async_v2.h:257] pq is empty
========== Step 43 ========== 
========== Step 44 ========== 
E20240131 21:52:29.531289 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 45 ========== 
W20240131 21:52:29.920598 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
========== Step 46 ========== 
E20240131 21:52:30.531059 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:30.988351 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
========== Step 47 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.579 us                | 622.279 us                |
| ProcessBack:Shuffle       | 272.536 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.609 ms                  | 829.323 ms                |
| ProcessBack:UpsertPq      | 56.152 us                 | 363.858 ms                |
| ProcessOneStep            | 273.408 ms                | 1.571 s                   |
| BlockToStepN              | 83.955 us                 | 317.371 ms                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:31.531051 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
E20240131 21:52:32.531035 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:32.659049 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240131 21:52:32.735334 2985232 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
W20240131 21:52:32.829906 2985232 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
E20240131 21:52:33.531121 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:33.851361 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.575 us                | 214.399 us                |
| GenInput                  | 31.780 ms                 | 42.347 ms                 |
| NN                        | 710.487 us                | 5.334 ms                  |
| Forward                   | 1.076 ms                  | 6.159 ms                  |
| Backward                  | 2.115 ms                  | 10.783 ms                 |
| Optimize                  | 218.630 us                | 425.816 us                |
| BarrierTimeBeforeRank0    | 232.309 us                | 6.605 ms                  |
| AfterBackward             | 272.332 ms                | 1.386 s                   |
| BlockToStepN              | 149.975 us                | 545.403 us                |
| OneStep                   | 308.806 ms                | 1.424 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 53 ========== 
========== Step 54 ========== 
E20240131 21:52:34.531076 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 55 ========== 
E20240131 21:52:35.531028 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 21:52:35.931833 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.524 us                | 319.529 us                |
| ProcessBack:Shuffle       | 272.536 ms                | 1.365 s                   |
| ProcessBack:UpdateCache   | 1.420 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 54.047 us                 | 99.914 us                 |
| ProcessOneStep            | 273.408 ms                | 1.386 s                   |
| BlockToStepN              | 88.493 us                 | 453.141 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:36.531174 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 56 ========== 
========== Step 57 ========== 
W20240131 21:52:37.033026 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
========== Step 58 ========== 
========== Step 59 ========== 
E20240131 21:52:37.531087 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:52:38.059365 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240131 21:52:38.531086 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 60 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.126 us                | 214.472 us                |
| GenInput                  | 31.780 ms                 | 42.656 ms                 |
| NN                        | 712.156 us                | 5.334 ms                  |
| Forward                   | 1.082 ms                  | 6.159 ms                  |
| Backward                  | 2.105 ms                  | 10.783 ms                 |
| Optimize                  | 219.822 us                | 425.816 us                |
| BarrierTimeBeforeRank0    | 232.309 us                | 6.605 ms                  |
| AfterBackward             | 273.457 ms                | 1.399 s                   |
| BlockToStepN              | 155.700 us                | 545.403 us                |
| OneStep                   | 310.968 ms                | 1.434 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:39.531011 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:39.698582 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
W20240131 21:52:39.707576 2985232 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
E20240131 21:52:40.531029 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:41.027654 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.030 us                | 517.134 us                |
| ProcessBack:Shuffle       | 275.363 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.420 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 54.719 us                 | 99.914 us                 |
| ProcessOneStep            | 277.283 ms                | 1.399 s                   |
| BlockToStepN              | 94.189 us                 | 453.141 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:41.531097 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 64 ========== 
W20240131 21:52:42.385228 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 21:52:42.531033 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:52:42.880506 2985232 grad_async_v2.h:257] pq is empty
========== Step 65 ========== 
W20240131 21:52:43.373189 2985232 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
W20240131 21:52:43.385705 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 67 ========== 
E20240131 21:52:43.531457 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.437 us                | 214.472 us                |
| GenInput                  | 31.439 ms                 | 44.416 ms                 |
| NN                        | 712.156 us                | 5.334 ms                  |
| Forward                   | 1.082 ms                  | 6.159 ms                  |
| Backward                  | 2.065 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 425.816 us                |
| BarrierTimeBeforeRank0    | 193.034 us                | 6.605 ms                  |
| AfterBackward             | 289.659 ms                | 1.399 s                   |
| BlockToStepN              | 160.981 us                | 545.403 us                |
| OneStep                   | 330.017 ms                | 1.434 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:44.352177 2985232 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
========== Step 69 ========== 
W20240131 21:52:44.475797 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240131 21:52:44.531176 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 70 ========== 
E20240131 21:52:45.531029 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:45.571089 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 71 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.062 us                | 209.817 us                |
| ProcessBack:Shuffle       | 314.199 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.326 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 54.047 us                 | 99.914 us                 |
| ProcessOneStep            | 315.390 ms                | 1.399 s                   |
| BlockToStepN              | 100.431 us                | 453.141 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:46.324748 2985232 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
E20240131 21:52:46.531447 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:46.705226 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 73 ========== 
W20240131 21:52:47.326768 2985232 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
E20240131 21:52:47.531028 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:47.811501 2985232 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
W20240131 21:52:47.823392 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240131 21:52:48.310763 2985232 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
E20240131 21:52:48.531052 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 77 ========== 
W20240131 21:52:48.918409 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.110 us                | 223.816 us                |
| GenInput                  | 31.254 ms                 | 44.416 ms                 |
| NN                        | 710.487 us                | 5.334 ms                  |
| Forward                   | 1.076 ms                  | 6.159 ms                  |
| Backward                  | 2.069 ms                  | 10.783 ms                 |
| Optimize                  | 211.477 us                | 425.816 us                |
| BarrierTimeBeforeRank0    | 155.535 us                | 6.605 ms                  |
| AfterBackward             | 378.952 ms                | 1.399 s                   |
| BlockToStepN              | 174.941 us                | 1.170 ms                  |
| OneStep                   | 415.818 ms                | 1.434 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:49.293690 2985232 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
E20240131 21:52:49.531185 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:49.796288 2985232 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
========== Step 80 ========== 
W20240131 21:52:49.933072 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
========== Step 81 ========== 
========== Step 82 ========== 
E20240131 21:52:50.531244 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 83 ========== 
W20240131 21:52:51.168221 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.426 us                | 951.001 us                |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.172 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 56.152 us                 | 99.914 us                 |
| ProcessOneStep            | 378.917 ms                | 1.399 s                   |
| BlockToStepN              | 106.353 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:51.531170 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 84 ========== 
W20240131 21:52:52.168774 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 21:52:52.531039 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
W20240131 21:52:53.393640 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 21:52:53.531165 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 172.110 us                | 223.816 us                |
| GenInput                  | 31.254 ms                 | 44.416 ms                 |
| NN                        | 707.150 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.159 ms                  |
| Backward                  | 2.060 ms                  | 10.783 ms                 |
| Optimize                  | 210.524 us                | 425.816 us                |
| BarrierTimeBeforeRank0    | 104.147 us                | 6.605 ms                  |
| AfterBackward             | 394.784 ms                | 1.399 s                   |
| BlockToStepN              | 180.802 us                | 1.170 ms                  |
| OneStep                   | 434.041 ms                | 1.434 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 21:52:54.250270 2985232 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
========== Step 89 ========== 
E20240131 21:52:54.531145 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=55
========== Step 90 ========== 
W20240131 21:52:54.594149 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 91 ========== 
========== Step 92 ========== 
E20240131 21:52:55.531056 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:52:55.670131 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
========== Step 93 ========== 
W20240131 21:52:56.147780 2985232 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.492 us                | 9.354 ms                  |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.172 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 55.007 us                 | 99.914 us                 |
| ProcessOneStep            | 377.904 ms                | 1.399 s                   |
| BlockToStepN              | 114.421 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 95 ========== 
E20240131 21:52:56.533972 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 96 ========== 
========== Step 97 ========== 
W20240131 21:52:57.245668 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
========== Step 98 ========== 
E20240131 21:52:57.533146 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=96
========== Step 99 ========== 
E20240131 21:52:58.533330 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:52:58.712028 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
Step99:rank0, time: 65.538, per_step: 0.655376
Step99:rank3, time: 65.537, per_step: 0.655374
Step99:rank2, time: 65.538, per_step: 0.655377
Step99:rank1, time: 65.538, per_step: 0.655376
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.716 us                | 244.725 us                |
| GenInput                  | 31.439 ms                 | 44.416 ms                 |
| NN                        | 699.520 us                | 5.334 ms                  |
| Forward                   | 1.070 ms                  | 6.159 ms                  |
| Backward                  | 2.065 ms                  | 10.783 ms                 |
| Optimize                  | 207.424 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 75.206 us                 | 6.605 ms                  |
| AfterBackward             | 349.176 ms                | 1.399 s                   |
| BlockToStepN              | 209.497 us                | 1.170 ms                  |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.716 us                | 244.725 us                |
| GenInput                  | 31.439 ms                 | 44.416 ms                 |
| NN                        | 699.520 us                | 5.334 ms                  |
| Forward                   | 1.070 ms                  | 6.159 ms                  |
| Backward                  | 2.065 ms                  | 10.783 ms                 |
| Optimize                  | 207.424 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 75.206 us                 | 6.605 ms                  |
| AfterBackward             | 349.176 ms                | 1.399 s                   |
| BlockToStepN              | 209.497 us                | 1.170 ms                  |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:52:59.533169 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:00.171542 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 21:53:00.533131 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:53:00.588299 2985232 grad_async_v2.h:257] pq is empty
========== Step 101 ========== 
========== Step 102 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.121 us                | 1.846 ms                  |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.105 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 55.873 us                 | 99.914 us                 |
| ProcessOneStep            | 377.904 ms                | 1.399 s                   |
| BlockToStepN              | 118.463 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 103 ========== 
W20240131 21:53:01.392374 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240131 21:53:01.533011 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:53:02.261088 2985232 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
W20240131 21:53:02.401995 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240131 21:53:02.533118 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:02.774735 2985232 grad_async_v2.h:257] pq is empty
========== Step 105 ========== 
========== Step 106 ========== 
E20240131 21:53:03.533028 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 107 ========== 
W20240131 21:53:03.650902 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.022 us                | 244.725 us                |
| GenInput                  | 32.191 ms                 | 44.416 ms                 |
| NN                        | 707.150 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.159 ms                  |
| Backward                  | 2.069 ms                  | 10.783 ms                 |
| Optimize                  | 207.663 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 45.724 us                 | 6.605 ms                  |
| AfterBackward             | 378.952 ms                | 1.399 s                   |
| BlockToStepN              | 216.973 us                | 1.170 ms                  |
| OneStep                   | 426.786 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:04.260115 2985232 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
W20240131 21:53:04.318413 2985232 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
E20240131 21:53:04.533037 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240131 21:53:04.652889 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240131 21:53:05.281782 2985232 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
========== Step 111 ========== 
E20240131 21:53:05.533151 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
========== Step 112 ========== 
W20240131 21:53:05.890628 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.942 us                | 503.092 us                |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.032 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 56.152 us                 | 99.914 us                 |
| ProcessOneStep            | 377.904 ms                | 1.399 s                   |
| BlockToStepN              | 128.501 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:53:06.533207 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 113 ========== 
========== Step 114 ========== 
W20240131 21:53:06.973397 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 21:53:07.533311 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
W20240131 21:53:08.087930 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 21:53:08.533030 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.103 us                | 1.882 ms                  |
| GenInput                  | 32.261 ms                 | 44.416 ms                 |
| NN                        | 708.818 us                | 5.334 ms                  |
| Forward                   | 1.073 ms                  | 6.159 ms                  |
| Backward                  | 2.060 ms                  | 15.798 ms                 |
| Optimize                  | 210.524 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 44.211 us                 | 6.605 ms                  |
| AfterBackward             | 377.945 ms                | 1.399 s                   |
| BlockToStepN              | 224.866 us                | 1.170 ms                  |
| OneStep                   | 415.818 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:09.200418 2985232 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
W20240131 21:53:09.213068 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 119 ========== 
========== Step 120 ========== 
E20240131 21:53:09.534114 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 121 ========== 
E20240131 21:53:10.534070 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 122 ========== 
W20240131 21:53:10.696115 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.282 us                | 459.926 us                |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.032 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 56.425 us                 | 99.914 us                 |
| ProcessOneStep            | 377.904 ms                | 1.399 s                   |
| BlockToStepN              | 135.062 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:53:11.534261 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:11.729184 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 123 ========== 
W20240131 21:53:12.368757 2985232 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
E20240131 21:53:12.534065 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:12.747725 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240131 21:53:12.882098 2985232 grad_async_v2.h:257] pq is empty
========== Step 125 ========== 
========== Step 126 ========== 
W20240131 21:53:13.200021 2985232 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
E20240131 21:53:13.534188 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:14.008683 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.164 us                | 1.882 ms                  |
| GenInput                  | 32.191 ms                 | 44.416 ms                 |
| NN                        | 708.818 us                | 5.334 ms                  |
| Forward                   | 1.073 ms                  | 6.159 ms                  |
| Backward                  | 2.064 ms                  | 15.798 ms                 |
| Optimize                  | 207.663 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 40.074 us                 | 6.605 ms                  |
| AfterBackward             | 378.952 ms                | 1.399 s                   |
| BlockToStepN              | 230.485 us                | 1.170 ms                  |
| OneStep                   | 426.786 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:14.412783 2985232 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
========== Step 129 ========== 
E20240131 21:53:14.534245 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
========== Step 130 ========== 
W20240131 21:53:15.210101 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 21:53:15.534166 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 131 ========== 
========== Step 132 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.546 us                | 6.707 ms                  |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.008 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 56.152 us                 | 99.914 us                 |
| ProcessOneStep            | 377.904 ms                | 1.399 s                   |
| BlockToStepN              | 153.017 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:16.359717 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 21:53:16.534046 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
========== Step 133 ========== 
========== Step 134 ========== 
W20240131 21:53:17.443495 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 21:53:17.534457 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 135 ========== 
W20240131 21:53:17.916265 2985232 grad_async_v2.h:257] pq is empty
========== Step 136 ========== 
========== Step 137 ========== 
E20240131 21:53:18.534010 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 21:53:18.570726 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.031 us                | 1.882 ms                  |
| GenInput                  | 32.325 ms                 | 44.416 ms                 |
| NN                        | 705.242 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.159 ms                  |
| Backward                  | 2.060 ms                  | 15.798 ms                 |
| Optimize                  | 207.663 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 40.074 us                 | 6.605 ms                  |
| AfterBackward             | 377.945 ms                | 1.399 s                   |
| BlockToStepN              | 236.587 us                | 1.170 ms                  |
| OneStep                   | 415.818 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 138 ========== 
========== Step 139 ========== 
E20240131 21:53:19.534595 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:19.576545 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240131 21:53:20.447578 2985232 grad_async_v2.h:257] pq is empty
========== Step 140 ========== 
E20240131 21:53:20.534065 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
========== Step 141 ========== 
W20240131 21:53:20.583734 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 21:53:20.632627 2985232 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.264 us                | 333.775 us                |
| ProcessBack:Shuffle       | 347.256 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.016 ms                  | 24.547 ms                 |
| ProcessBack:UpsertPq      | 56.152 us                 | 99.914 us                 |
| ProcessOneStep            | 349.143 ms                | 1.399 s                   |
| BlockToStepN              | 169.324 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:53:21.534534 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:21.679945 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240131 21:53:21.943590 2985232 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
W20240131 21:53:22.141031 2985232 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
E20240131 21:53:22.534121 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 145 ========== 
W20240131 21:53:22.726372 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240131 21:53:23.839943 2985232 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
W20240131 21:53:23.852439 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 21:53:23.852870 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.031 us                | 1.882 ms                  |
| GenInput                  | 32.325 ms                 | 44.416 ms                 |
| NN                        | 705.242 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.159 ms                  |
| Backward                  | 2.069 ms                  | 15.798 ms                 |
| Optimize                  | 210.524 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 40.074 us                 | 6.605 ms                  |
| AfterBackward             | 349.176 ms                | 1.399 s                   |
| BlockToStepN              | 246.234 us                | 1.170 ms                  |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 150 ========== 
E20240131 21:53:24.852281 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:24.948240 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
E20240131 21:53:25.852137 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:25.900524 2985232 grad_async_v2.h:257] pq is empty
========== Step 154 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.758 us                | 6.048 ms                  |
| ProcessBack:Shuffle       | 314.199 ms                | 1.378 s                   |
| ProcessBack:UpdateCache   | 1.027 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.400 us                 | 88.318 us                 |
| ProcessOneStep            | 315.390 ms                | 1.386 s                   |
| BlockToStepN              | 177.777 us                | 479.094 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:26.309566 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
========== Step 155 ========== 
========== Step 156 ========== 
E20240131 21:53:26.852069 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=82
========== Step 157 ========== 
========== Step 158 ========== 
E20240131 21:53:27.853032 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:28.019313 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
W20240131 21:53:28.366832 2985232 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
E20240131 21:53:28.853507 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:29.084342 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.103 us                | 312.980 us                |
| GenInput                  | 32.659 ms                 | 44.416 ms                 |
| NN                        | 707.150 us                | 3.006 ms                  |
| Forward                   | 1.073 ms                  | 3.727 ms                  |
| Backward                  | 2.064 ms                  | 10.783 ms                 |
| Optimize                  | 211.477 us                | 536.919 us                |
| BarrierTimeBeforeRank0    | 34.040 us                 | 5.969 ms                  |
| AfterBackward             | 349.032 ms                | 1.399 s                   |
| BlockToStepN              | 253.512 us                | 581.736 us                |
| OneStep                   | 382.881 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:29.180791 2985232 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
========== Step 161 ========== 
E20240131 21:53:29.853192 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 21:53:30.248015 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240131 21:53:30.756831 2985232 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
E20240131 21:53:30.853238 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 163 ========== 
========== Step 164 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.923 us                | 6.012 ms                  |
| ProcessBack:Shuffle       | 341.960 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.039 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.432 us                 | 89.505 us                 |
| ProcessOneStep            | 348.998 ms                | 1.399 s                   |
| BlockToStepN              | 188.444 us                | 479.094 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 21:53:31.853204 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:31.911887 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
========== Step 165 ========== 
E20240131 21:53:32.853926 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:33.465552 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 166 ========== 
E20240131 21:53:33.853163 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.718 us                | 312.980 us                |
| GenInput                  | 33.242 ms                 | 44.898 ms                 |
| NN                        | 708.818 us                | 3.006 ms                  |
| Forward                   | 1.076 ms                  | 3.727 ms                  |
| Backward                  | 2.064 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 37.167 us                 | 5.969 ms                  |
| AfterBackward             | 349.176 ms                | 1.399 s                   |
| BlockToStepN              | 265.484 us                | 581.736 us                |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:34.492651 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 167 ========== 
E20240131 21:53:34.853055 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 21:53:35.231945 2985232 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
W20240131 21:53:35.515839 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240131 21:53:35.853264 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.989 us                | 623.424 us                |
| ProcessBack:Shuffle       | 347.256 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.073 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.626 us                 | 89.505 us                 |
| ProcessOneStep            | 349.143 ms                | 1.399 s                   |
| BlockToStepN              | 193.006 us                | 479.094 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:36.756753 2985232 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
W20240131 21:53:36.769403 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 21:53:36.853099 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240131 21:53:36.879060 2985232 grad_async_v2.h:257] pq is empty
========== Step 172 ========== 
W20240131 21:53:37.498272 2985232 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
E20240131 21:53:37.853103 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:37.866971 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240131 21:53:38.242338 2985232 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
W20240131 21:53:38.749866 2985232 grad_async_v2.h:257] pq is empty
========== Step 175 ========== 
E20240131 21:53:38.853088 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:38.883302 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 176 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.164 us                | 312.980 us                |
| GenInput                  | 33.242 ms                 | 44.898 ms                 |
| NN                        | 707.150 us                | 3.006 ms                  |
| Forward                   | 1.073 ms                  | 3.727 ms                  |
| Backward                  | 2.058 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.312 us                 | 5.969 ms                  |
| AfterBackward             | 376.978 ms                | 1.399 s                   |
| BlockToStepN              | 269.080 us                | 727.214 us                |
| OneStep                   | 415.818 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:39.855674 2985232 grad_async_v2.h:257] pq is empty
========== Step 177 ========== 
E20240131 21:53:39.873452 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:39.988751 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240131 21:53:40.363000 2985232 grad_async_v2.h:257] pq is empty
========== Step 178 ========== 
========== Step 179 ========== 
W20240131 21:53:40.488088 2985232 grad_async_v2.h:257] pq is empty
========== Step 180 ========== 
E20240131 21:53:40.878602 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 181 ========== 
W20240131 21:53:40.927067 2985232 grad_async_v2.h:257] pq is empty
========== Step 182 ========== 
W20240131 21:53:41.148814 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.138 us                | 6.056 ms                  |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.048 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.425 us                 | 99.914 us                 |
| ProcessOneStep            | 361.466 ms                | 1.399 s                   |
| BlockToStepN              | 194.889 us                | 510.191 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 183 ========== 
W20240131 21:53:41.535001 2985232 grad_async_v2.h:257] pq is empty
========== Step 184 ========== 
========== Step 185 ========== 
E20240131 21:53:41.878322 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 186 ========== 
========== Step 187 ========== 
W20240131 21:53:42.634310 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240131 21:53:42.878047 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=38
========== Step 188 ========== 
W20240131 21:53:43.656051 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240131 21:53:43.878090 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.103 us                | 312.980 us                |
| GenInput                  | 32.748 ms                 | 44.898 ms                 |
| NN                        | 705.242 us                | 5.334 ms                  |
| Forward                   | 1.073 ms                  | 6.138 ms                  |
| Backward                  | 2.056 ms                  | 10.783 ms                 |
| Optimize                  | 212.431 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.245 us                 | 5.969 ms                  |
| AfterBackward             | 350.202 ms                | 1.399 s                   |
| BlockToStepN              | 278.020 us                | 797.912 us                |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
W20240131 21:53:44.757149 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240131 21:53:44.878050 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:45.717643 2985232 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
E20240131 21:53:45.878908 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=40
W20240131 21:53:45.938621 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.066 us                | 5.713 ms                  |
| ProcessBack:Shuffle       | 348.594 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.050 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.626 us                 | 99.914 us                 |
| ProcessOneStep            | 350.169 ms                | 1.399 s                   |
| BlockToStepN              | 209.591 us                | 595.443 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
E20240131 21:53:46.878568 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
E20240131 21:53:47.878023 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:47.892908 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
========== Step 199 ========== 
E20240131 21:53:48.878067 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.031 us                | 312.980 us                |
| GenInput                  | 32.748 ms                 | 44.898 ms                 |
| NN                        | 699.520 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.138 ms                  |
| Backward                  | 2.056 ms                  | 10.783 ms                 |
| Optimize                  | 211.477 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 34.918 us                 | 5.969 ms                  |
| AfterBackward             | 350.202 ms                | 1.399 s                   |
| BlockToStepN              | 285.417 us                | 797.912 us                |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.345 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 21:53:49.290824 2985232 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=199, sample_step_cpp_seen_[rank]=198
W20240131 21:53:49.625444 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
E20240131 21:53:49.878091 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:50.117827 2985232 grad_async_v2.h:257] pq is empty
Step199:rank0, time: 50.958, per_step: 0.504535
Step199:rank3, time: 50.958, per_step: 0.504535
Step199:rank2, time: 50.958, per_step: 0.504535
Step199:rank1, time: 50.958, per_step: 0.504535
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.031 us                | 312.980 us                |
| GenInput                  | 32.748 ms                 | 44.898 ms                 |
| NN                        | 699.520 us                | 5.334 ms                  |
| Forward                   | 1.072 ms                  | 6.138 ms                  |
| Backward                  | 2.056 ms                  | 10.783 ms                 |
| Optimize                  | 211.477 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 34.918 us                 | 5.969 ms                  |
| AfterBackward             | 350.202 ms                | 1.402 s                   |
| BlockToStepN              | 285.417 us                | 797.912 us                |
| OneStep                   | 386.575 ms                | 1.434 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
W20240131 21:53:50.688951 2985232 grad_async_v2.h:257] pq is empty
========== Step 201 ========== 
W20240131 21:53:50.746342 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240131 21:53:50.878075 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:51.080693 2985232 grad_async_v2.h:257] pq is empty
========== Step 202 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.738 us                | 5.653 ms                  |
| ProcessBack:Shuffle       | 349.057 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.058 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.626 us                 | 125.312 us                |
| ProcessOneStep            | 350.169 ms                | 1.402 s                   |
| BlockToStepN              | 214.877 us                | 620.445 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:51.284454 2985232 grad_async_v2.h:257] pq is empty
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
E20240131 21:53:51.878063 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 21:53:52.100826 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240131 21:53:52.878064 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 206 ========== 
========== Step 207 ========== 
W20240131 21:53:53.508056 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 208 ========== 
E20240131 21:53:53.878218 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.718 us                | 312.980 us                |
| GenInput                  | 32.659 ms                 | 44.898 ms                 |
| NN                        | 707.150 us                | 5.334 ms                  |
| Forward                   | 1.076 ms                  | 6.138 ms                  |
| Backward                  | 2.057 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 37.167 us                 | 5.969 ms                  |
| AfterBackward             | 350.202 ms                | 1.402 s                   |
| BlockToStepN              | 292.153 us                | 797.912 us                |
| OneStep                   | 386.575 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:54.226562 2985232 grad_async_v2.h:257] pq is empty
========== Step 209 ========== 
W20240131 21:53:54.593087 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240131 21:53:54.808646 2985232 grad_async_v2.h:257] pq is empty
========== Step 210 ========== 
E20240131 21:53:54.878129 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=13
W20240131 21:53:55.708655 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240131 21:53:55.842965 2985232 grad_async_v2.h:257] pq is empty
========== Step 211 ========== 
E20240131 21:53:55.878459 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.807 us                | 5.184 ms                  |
| ProcessBack:Shuffle       | 355.329 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 56.897 us                 | 125.312 us                |
| ProcessOneStep            | 361.466 ms                | 1.402 s                   |
| BlockToStepN              | 223.497 us                | 635.272 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:53:56.217680 2985232 grad_async_v2.h:257] pq is empty
========== Step 212 ========== 
W20240131 21:53:56.828070 2985232 grad_async_v2.h:257] pq is empty
========== Step 213 ========== 
W20240131 21:53:56.829154 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240131 21:53:56.878646 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=37
W20240131 21:53:57.314927 2985232 grad_async_v2.h:257] pq is empty
========== Step 214 ========== 
W20240131 21:53:57.818039 2985232 grad_async_v2.h:257] pq is empty
========== Step 215 ========== 
W20240131 21:53:57.831220 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 216 ========== 
E20240131 21:53:57.878329 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
========== Step 217 ========== 
========== Step 218 ========== 
E20240131 21:53:58.878480 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:53:59.045939 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.919 us                | 312.980 us                |
| GenInput                  | 32.387 ms                 | 45.718 ms                 |
| NN                        | 711.203 us                | 5.334 ms                  |
| Forward                   | 1.083 ms                  | 6.138 ms                  |
| Backward                  | 2.058 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 683.546 us                |
| BarrierTimeBeforeRank0    | 34.918 us                 | 5.969 ms                  |
| AfterBackward             | 361.500 ms                | 1.402 s                   |
| BlockToStepN              | 299.071 us                | 817.772 us                |
| OneStep                   | 414.636 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
E20240131 21:53:59.878073 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 224 ========== 
W20240131 21:54:00.263082 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240131 21:54:00.878120 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.861 us                | 1.387 ms                  |
| ProcessBack:Shuffle       | 348.594 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 15.878 ms                 |
| ProcessBack:UpsertPq      | 57.110 us                 | 125.312 us                |
| ProcessOneStep            | 350.065 ms                | 1.402 s                   |
| BlockToStepN              | 228.246 us                | 635.272 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 225 ========== 
========== Step 226 ========== 
E20240131 21:54:01.878131 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:02.071360 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
========== Step 227 ========== 
W20240131 21:54:02.345723 2985232 grad_async_v2.h:257] pq is empty
========== Step 228 ========== 
========== Step 229 ========== 
E20240131 21:54:02.880707 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 230 ========== 
W20240131 21:54:03.269851 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
E20240131 21:54:03.880399 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 173.919 us                | 312.980 us                |
| GenInput                  | 32.376 ms                 | 45.718 ms                 |
| NN                        | 710.487 us                | 5.334 ms                  |
| Forward                   | 1.082 ms                  | 6.138 ms                  |
| Backward                  | 2.056 ms                  | 10.783 ms                 |
| Optimize                  | 215.530 us                | 683.546 us                |
| BarrierTimeBeforeRank0    | 35.845 us                 | 5.969 ms                  |
| AfterBackward             | 349.176 ms                | 1.402 s                   |
| BlockToStepN              | 316.797 us                | 1.170 ms                  |
| OneStep                   | 384.498 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:04.395022 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
========== Step 234 ========== 
E20240131 21:54:04.880131 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
========== Step 235 ========== 
E20240131 21:54:05.038808 2985232 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=235, sample_step_cpp_seen_[rank]=234
W20240131 21:54:05.678311 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 236 ========== 
E20240131 21:54:05.880195 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.656 us                | 1.319 ms                  |
| ProcessBack:Shuffle       | 341.960 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 15.878 ms                 |
| ProcessBack:UpsertPq      | 57.110 us                 | 125.312 us                |
| ProcessOneStep            | 349.143 ms                | 1.402 s                   |
| BlockToStepN              | 235.773 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 237 ========== 
E20240131 21:54:06.880133 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
W20240131 21:54:07.006448 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
W20240131 21:54:07.261438 2985232 grad_async_v2.h:257] pq is empty
========== Step 238 ========== 
W20240131 21:54:07.360023 2985232 grad_async_v2.h:257] pq is empty
========== Step 239 ========== 
W20240131 21:54:07.398772 2985232 grad_async_v2.h:257] pq is empty
========== Step 240 ========== 
E20240131 21:54:07.880347 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
E20240131 21:54:08.881100 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=38
========== Step 244 ========== 
========== Step 245 ========== 
W20240131 21:54:08.990304 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.330 us                | 312.980 us                |
| GenInput                  | 32.325 ms                 | 45.718 ms                 |
| NN                        | 715.494 us                | 5.334 ms                  |
| Forward                   | 1.087 ms                  | 6.138 ms                  |
| Backward                  | 2.057 ms                  | 10.783 ms                 |
| Optimize                  | 215.769 us                | 683.546 us                |
| BarrierTimeBeforeRank0    | 34.040 us                 | 5.969 ms                  |
| AfterBackward             | 349.032 ms                | 1.402 s                   |
| BlockToStepN              | 320.417 us                | 1.170 ms                  |
| OneStep                   | 382.881 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 246 ========== 
E20240131 21:54:09.881165 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240131 21:54:10.038012 2985232 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=246, sample_step_cpp_seen_[rank]=245
W20240131 21:54:10.671974 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240131 21:54:10.881132 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:54:10.915235 2985232 grad_async_v2.h:257] pq is empty
========== Step 247 ========== 
========== Step 248 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.256 us                | 730.261 us                |
| ProcessBack:Shuffle       | 314.199 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 15.878 ms                 |
| ProcessBack:UpsertPq      | 57.449 us                 | 125.312 us                |
| ProcessOneStep            | 340.128 ms                | 1.571 s                   |
| BlockToStepN              | 239.887 us                | 1.113 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 249 ========== 
========== Step 250 ========== 
W20240131 21:54:11.802418 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240131 21:54:11.881317 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 251 ========== 
E20240131 21:54:12.881186 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 252 ========== 
W20240131 21:54:13.020279 2985232 grad_async_v2.h:257] pq is empty
========== Step 253 ========== 
W20240131 21:54:13.093353 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240131 21:54:13.239961 2985232 grad_async_v2.h:257] pq is empty
========== Step 254 ========== 
E20240131 21:54:13.881112 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
W20240131 21:54:14.109819 2985232 grad_async_v2.h:257] pq is empty
========== Step 255 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.439 us                | 294.076 us                |
| GenInput                  | 32.261 ms                 | 45.289 ms                 |
| NN                        | 712.156 us                | 3.006 ms                  |
| Forward                   | 1.086 ms                  | 3.994 ms                  |
| Backward                  | 2.057 ms                  | 7.520 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 34.040 us                 | 3.179 ms                  |
| AfterBackward             | 349.032 ms                | 1.402 s                   |
| BlockToStepN              | 327.877 us                | 817.772 us                |
| OneStep                   | 382.881 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:14.186149 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240131 21:54:14.881294 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:15.186702 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 256 ========== 
========== Step 257 ========== 
E20240131 21:54:15.881168 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.322 us                | 2.364 ms                  |
| ProcessBack:Shuffle       | 336.509 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.105 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.449 us                 | 99.914 us                 |
| ProcessOneStep            | 348.998 ms                | 1.402 s                   |
| BlockToStepN              | 246.376 us                | 635.272 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:16.300509 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240131 21:54:16.785246 2985232 grad_async_v2.h:257] pq is empty
========== Step 258 ========== 
E20240131 21:54:16.881086 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:17.286899 2985232 grad_async_v2.h:257] pq is empty
========== Step 259 ========== 
W20240131 21:54:17.413722 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240131 21:54:17.785998 2985232 grad_async_v2.h:257] pq is empty
========== Step 260 ========== 
E20240131 21:54:17.881062 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:18.284049 2985232 grad_async_v2.h:257] pq is empty
========== Step 261 ========== 
========== Step 262 ========== 
W20240131 21:54:18.428774 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 21:54:18.881107 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=82
========== Step 263 ========== 
========== Step 264 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.820 us                | 294.076 us                |
| GenInput                  | 32.201 ms                 | 45.289 ms                 |
| NN                        | 715.494 us                | 3.006 ms                  |
| Forward                   | 1.087 ms                  | 3.994 ms                  |
| Backward                  | 2.058 ms                  | 7.520 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 34.040 us                 | 3.179 ms                  |
| AfterBackward             | 349.176 ms                | 1.402 s                   |
| BlockToStepN              | 331.768 us                | 817.772 us                |
| OneStep                   | 384.498 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 265 ========== 
W20240131 21:54:19.649413 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 266 ========== 
========== Step 267 ========== 
E20240131 21:54:19.881019 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:20.507678 2985232 grad_async_v2.h:257] pq is empty
========== Step 268 ========== 
W20240131 21:54:20.709079 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240131 21:54:20.881657 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=33
========== Step 269 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.577 us                | 10.746 ms                 |
| ProcessBack:Shuffle       | 339.047 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.206 us                 | 99.914 us                 |
| ProcessOneStep            | 349.143 ms                | 1.402 s                   |
| BlockToStepN              | 250.528 us                | 635.272 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 270 ========== 
========== Step 271 ========== 
E20240131 21:54:21.881057 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240131 21:54:22.026216 2986018 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
========== Step 272 ========== 
E20240131 21:54:22.881446 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
========== Step 273 ========== 
========== Step 274 ========== 
W20240131 21:54:23.403409 2986018 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240131 21:54:23.881078 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.953 us                | 294.076 us                |
| GenInput                  | 32.215 ms                 | 45.289 ms                 |
| NN                        | 712.156 us                | 3.006 ms                  |
| Forward                   | 1.085 ms                  | 3.994 ms                  |
| Backward                  | 2.056 ms                  | 7.520 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.312 us                 | 3.179 ms                  |
| AfterBackward             | 349.176 ms                | 1.402 s                   |
| BlockToStepN              | 339.861 us                | 817.772 us                |
| OneStep                   | 384.498 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
W20240131 21:54:24.833509 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240131 21:54:24.881225 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
========== Step 278 ========== 
========== Step 279 ========== 
E20240131 21:54:25.881083 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 280 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.017 us                | 11.146 ms                 |
| ProcessBack:Shuffle       | 336.509 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.079 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.206 us                 | 99.914 us                 |
| ProcessOneStep            | 348.998 ms                | 1.402 s                   |
| BlockToStepN              | 255.597 us                | 635.272 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:26.440443 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240131 21:54:26.881048 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240131 21:54:27.360774 2985232 grad_async_v2.h:257] pq is empty
========== Step 281 ========== 
E20240131 21:54:27.881017 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240131 21:54:28.131464 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240131 21:54:28.798413 2985232 grad_async_v2.h:257] pq is empty
========== Step 282 ========== 
E20240131 21:54:28.881116 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.953 us                | 294.076 us                |
| GenInput                  | 32.215 ms                 | 45.718 ms                 |
| NN                        | 715.494 us                | 3.006 ms                  |
| Forward                   | 1.087 ms                  | 3.994 ms                  |
| Backward                  | 2.057 ms                  | 8.908 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 34.040 us                 | 3.179 ms                  |
| AfterBackward             | 349.176 ms                | 1.402 s                   |
| BlockToStepN              | 346.167 us                | 817.772 us                |
| OneStep                   | 384.498 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:29.187223 2986018 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240131 21:54:29.881270 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240131 21:54:29.920697 2985232 grad_async_v2.h:257] pq is empty
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
W20240131 21:54:30.192289 2986018 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240131 21:54:30.881160 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=27
========== Step 286 ========== 
W20240131 21:54:30.950001 2985232 grad_async_v2.h:257] pq is empty
========== Step 287 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.445 us                | 6.014 ms                  |
| ProcessBack:Shuffle       | 339.047 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.094 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.449 us                 | 99.914 us                 |
| ProcessOneStep            | 349.143 ms                | 1.402 s                   |
| BlockToStepN              | 258.671 us                | 804.273 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:31.526248 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240131 21:54:31.881089 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 288 ========== 
W20240131 21:54:32.530958 2986018 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240131 21:54:32.881048 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240131 21:54:32.910877 2985232 grad_async_v2.h:257] pq is empty
========== Step 289 ========== 
W20240131 21:54:33.414636 2985232 grad_async_v2.h:257] pq is empty
========== Step 290 ========== 
========== Step 291 ========== 
W20240131 21:54:33.548874 2986018 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240131 21:54:33.881193 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.953 us                | 294.076 us                |
| GenInput                  | 32.201 ms                 | 45.718 ms                 |
| NN                        | 716.686 us                | 3.006 ms                  |
| Forward                   | 1.089 ms                  | 3.994 ms                  |
| Backward                  | 2.057 ms                  | 8.908 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.245 us                 | 3.268 ms                  |
| AfterBackward             | 350.202 ms                | 1.402 s                   |
| BlockToStepN              | 353.662 us                | 887.583 us                |
| OneStep                   | 386.575 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:34.602272 2985232 grad_async_v2.h:257] pq is empty
========== Step 292 ========== 
W20240131 21:54:34.614022 2986018 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240131 21:54:34.881197 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:35.103456 2985232 grad_async_v2.h:257] pq is empty
========== Step 293 ========== 
W20240131 21:54:35.608572 2985232 grad_async_v2.h:257] pq is empty
========== Step 294 ========== 
W20240131 21:54:35.626843 2986018 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 295 ========== 
========== Step 296 ========== 
E20240131 21:54:35.893600 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.958 us                | 3.739 ms                  |
| ProcessBack:Shuffle       | 341.960 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.073 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.495 us                 | 99.914 us                 |
| ProcessOneStep            | 350.065 ms                | 1.402 s                   |
| BlockToStepN              | 261.336 us                | 804.273 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 21:54:36.734635 2986018 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240131 21:54:36.893128 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240131 21:54:37.177625 2985232 grad_async_v2.h:257] pq is empty
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
W20240131 21:54:37.796720 2986018 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240131 21:54:37.893895 2986018 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
W20240131 21:54:38.664404 2985232 grad_async_v2.h:257] pq is empty
Step299:rank2, time: 48.547, per_step: 0.480658
Step299:rank1, time: 48.546, per_step: 0.480658
Step299:rank3, time: 48.547, per_step: 0.480659
Step299:rank0, time: 48.547, per_step: 0.480660
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.820 us                | 294.076 us                |
| GenInput                  | 32.191 ms                 | 45.955 ms                 |
| NN                        | 716.686 us                | 3.006 ms                  |
| Forward                   | 1.089 ms                  | 3.994 ms                  |
| Backward                  | 2.057 ms                  | 8.908 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.212 us                 | 3.268 ms                  |
| AfterBackward             | 350.226 ms                | 1.402 s                   |
| BlockToStepN              | 356.281 us                | 887.583 us                |
| OneStep                   | 391.763 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
W20240131 21:54:38.665251 2985232 grad_async_v2.h:84] call StopThreads. PID = 2985232
W20240131 21:54:38.665261 2985232 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 21:54:38.665287 2985232 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 21:54:38.665293 2985232 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240131 21:54:38.665791 2985232 grad_async_v2.h:105] StopThreads done.
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.820 us                | 294.076 us                |
| GenInput                  | 32.191 ms                 | 45.955 ms                 |
| NN                        | 716.686 us                | 3.006 ms                  |
| Forward                   | 1.089 ms                  | 3.994 ms                  |
| Backward                  | 2.057 ms                  | 8.908 ms                  |
| Optimize                  | 215.530 us                | 594.854 us                |
| BarrierTimeBeforeRank0    | 33.212 us                 | 3.268 ms                  |
| AfterBackward             | 350.226 ms                | 1.402 s                   |
| BlockToStepN              | 356.281 us                | 887.583 us                |
| OneStep                   | 391.763 ms                | 1.442 s                   |
| E2E-100                   | 50.345 s                  | 50.958 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [2985232 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f6243b2dd90>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.504 us                | 593.267 us                |
| ProcessBack:Shuffle       | 347.256 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.063 ms                  | 12.692 ms                 |
| ProcessBack:UpsertPq      | 57.471 us                 | 99.914 us                 |
| ProcessOneStep            | 350.169 ms                | 1.402 s                   |
| BlockToStepN              | 262.559 us                | 804.273 us                |
+---------------------------+---------------------------+---------------------------+
