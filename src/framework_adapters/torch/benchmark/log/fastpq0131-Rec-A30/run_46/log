WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 09:36:41.023386 1824090 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 09:36:41.024737 1824090 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [1824090 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7ff96709d120>==========
Worker 1 pid=1824250
Worker 2 pid=1824252
INFO [1824090 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1824250 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1824254 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1824252 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1824250 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1824254 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1824252 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 09:36:44.335136 1824250 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 09:36:44.335337 1824254 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 09:36:44.335397 1824252 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [1824090 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 09:36:44.340539 1824090 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 09:36:44.346485 1824090 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [944920, 32]; dev=0; size=115.3 MB
W20240131 09:36:44.346459 1824252 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [944920, 32]; dev=2; size=115.3 MB
W20240131 09:36:44.346524 1824250 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [944920, 32]; dev=1; size=115.3 MB
W20240131 09:36:44.346592 1824254 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [944920, 32]; dev=3; size=115.3 MB
W20240131 09:36:44.348731 1824090 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100048183000 7.629 MB
W20240131 09:36:44.348842 1824090 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000490c9000 7.629 MB
W20240131 09:36:44.348834 1824250 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100048926000 7.629 MB
W20240131 09:36:44.348870 1824252 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004986c000 7.629 MB
W20240131 09:36:44.348903 1824090 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10004a7b2000 122.1 MB
W20240131 09:36:44.348891 1824254 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10004a00f000 7.629 MB
W20240131 09:36:44.348948 1824090 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000521c6000 122.1 MB
W20240131 09:36:44.348981 1824090 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 09:36:44.349097 1824254 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100059bda000 7.629 MB
W20240131 09:36:44.349139 1824252 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10005a37d000 7.629 MB
W20240131 09:36:44.349148 1824250 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10005ab20000 7.629 MB
W20240131 09:36:44.349190 1824254 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10005b2c3000 122.1 MB
W20240131 09:36:44.349244 1824254 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100062cd7000 122.1 MB
W20240131 09:36:44.349254 1824252 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10006a6eb000 122.1 MB
W20240131 09:36:44.349277 1824250 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000720ff000 122.1 MB
W20240131 09:36:44.349314 1824254 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 09:36:44.349349 1824252 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100079b13000 122.1 MB
W20240131 09:36:44.349378 1824250 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100081529000 122.1 MB
W20240131 09:36:44.349416 1824090 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 09:36:44.349421 1824252 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 09:36:44.349444 1824250 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 09:36:44.351111 1824254 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 09:36:44.351140 1824250 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 09:36:44.351145 1824252 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
Worker 3 pid=1824254
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 944920), (944920, 1889840), (1889840, 2834760), (2834760, 3779680)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240131 09:36:48.100802 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100088f4b000 7.629 MB
W20240131 09:36:48.100963 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000896ee000 7.629 MB
W20240131 09:36:48.101001 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100089e91000 7.629 MB
W20240131 09:36:48.101023 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10008a634000 7.629 MB
W20240131 09:36:48.101056 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10008add7000 7.629 MB
W20240131 09:36:48.101078 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10008b57a000 7.629 MB
W20240131 09:36:48.101104 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10008bd1d000 7.629 MB
W20240131 09:36:48.101138 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10008c4c0000 7.629 MB
W20240131 09:36:48.101161 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10008cc63000 7.629 MB
W20240131 09:36:48.101189 1824090 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10008d406000 7.629 MB
W20240131 09:36:48.101213 1824090 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10008dba9000 80 B 
W20240131 09:36:48.101233 1824090 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10008dbab000 8 B 
W20240131 09:36:48.101253 1824090 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 09:36:48.101557 1824090 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 09:36:48.326177 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10008dbaf000 7.629 MB
W20240131 09:36:48.326294 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10008e352000 7.629 MB
W20240131 09:36:48.326329 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10008eaf5000 7.629 MB
W20240131 09:36:48.326357 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008f298000 7.629 MB
W20240131 09:36:48.326392 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008fa3b000 7.629 MB
W20240131 09:36:48.326416 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000901de000 7.629 MB
W20240131 09:36:48.326448 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100090981000 7.629 MB
W20240131 09:36:48.326500 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100091124000 7.629 MB
W20240131 09:36:48.326530 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000918c7000 7.629 MB
W20240131 09:36:48.326552 1824252 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10009206a000 7.629 MB
W20240131 09:36:48.326575 1824252 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10009280d000 80 B 
W20240131 09:36:48.326596 1824252 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10009280f000 8 B 
W20240131 09:36:48.326612 1824252 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 09:36:48.326840 1824252 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 09:36:48.352874 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100092813000 7.629 MB
W20240131 09:36:48.352990 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100092fb6000 7.629 MB
W20240131 09:36:48.353017 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100093759000 7.629 MB
W20240131 09:36:48.353044 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100093efc000 7.629 MB
W20240131 09:36:48.353080 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10009469f000 7.629 MB
W20240131 09:36:48.353106 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100094e42000 7.629 MB
W20240131 09:36:48.353127 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000955e5000 7.629 MB
W20240131 09:36:48.353163 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100095d88000 7.629 MB
W20240131 09:36:48.353188 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10009652b000 7.629 MB
W20240131 09:36:48.353209 1824254 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100096cce000 7.629 MB
W20240131 09:36:48.353233 1824254 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x100097471000 80 B 
W20240131 09:36:48.353253 1824254 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100097473000 8 B 
W20240131 09:36:48.353276 1824254 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 09:36:48.353539 1824254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 09:36:48.387943 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100097477000 7.629 MB
W20240131 09:36:48.388052 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100097c1a000 7.629 MB
W20240131 09:36:48.388087 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000983bd000 7.629 MB
W20240131 09:36:48.388115 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100098b60000 7.629 MB
W20240131 09:36:48.388145 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100099303000 7.629 MB
W20240131 09:36:48.388166 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100099aa6000 7.629 MB
W20240131 09:36:48.388188 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10009a249000 7.629 MB
W20240131 09:36:48.388223 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10009a9ec000 7.629 MB
W20240131 09:36:48.388247 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009b18f000 7.629 MB
W20240131 09:36:48.388268 1824250 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10009b932000 7.629 MB
W20240131 09:36:48.388289 1824250 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10009c0d5000 80 B 
W20240131 09:36:48.388319 1824250 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10009c0d7000 8 B 
W20240131 09:36:48.388336 1824250 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 09:36:48.388578 1824250 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 09:36:48.390231 1824090 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 09:36:48.390339 1824090 grad_base.h:184] Init GradProcessingBase done
I20240131 09:36:49.028532 1824090 grad_async_v2.h:43] Use main thread to update emb.
W20240131 09:36:49.028775 1824090 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 09:36:49.028782 1824090 kg_controller.h:84] Construct KGCacheController done
E20240131 09:36:49.359158 1824254 recstore.cc:66] init folly done
E20240131 09:36:49.359184 1824250 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 09:36:49.359282 1824090 recstore.cc:66] init folly done
E20240131 09:36:49.359318 1824252 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 09:36:49.360646 1824090 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 09:36:50.155932 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240131 09:36:50.156165 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:36:51.156082 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:36:51.243793 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:36:52.156034 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:36:52.362313 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
E20240131 09:36:53.156162 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:36:53.464023 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240131 09:36:54.156131 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.965 us                | 210.705 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:36:54.491122 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
Before Training
Before Training
Before Training
I20240131 09:36:55.960675 1824252 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240131 09:36:55.960700 1824254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240131 09:36:55.960716 1824090 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 09:36:55.963531 1824250 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240131 09:36:55.977205 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240131 09:36:55.977350 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:36:57.572255 1824734 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:36:58.038758 1824090 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240131 09:36:58.293215 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [1824252 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1824250 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1824090 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1824254 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.850 us                | 185.223 us                |
| GenInput                  | 33.121 ms                 | 37.229 ms                 |
| NN                        | 1.600 ms                  | 143.371 ms                |
| Forward                   | 1.949 ms                  | 144.494 ms                |
| Backward                  | 2.935 ms                  | 153.657 ms                |
| Optimize                  | 238.100 us                | 8.701 ms                  |
| BarrierTimeBeforeRank0    | 33.444 us                 | 44.340 us                 |
| AfterBackward             | 1.729 s                   | 1.729 s                   |
| BlockToStepN              | 240.079 ms                | 240.079 ms                |
| OneStep                   | 2.315 s                   | 2.315 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:36:58.572034 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:36:58.782188 1824090 grad_async_v2.h:256] pq is empty
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.653 us                | 681.005 us                |
| ProcessBack:Shuffle       | 444.007 ms                | 457.415 ms                |
| ProcessBack:UpdateCache   | 2.884 ms                  | 763.618 ms                |
| ProcessBack:UpsertPq      | 53.230 us                 | 466.752 ms                |
| ProcessOneStep            | 458.525 ms                | 1.729 s                   |
| BlockToStepN              | 44.044 us                 | 239.723 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:36:59.495707 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240131 09:36:59.572088 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
E20240131 09:37:00.572046 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=734
W20240131 09:37:00.582521 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240131 09:37:00.711885 1824090 grad_async_v2.h:256] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240131 09:37:01.431465 1824090 grad_async_v2.h:256] pq is empty
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
E20240131 09:37:01.572145 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:01.747382 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
E20240131 09:37:02.572050 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=406
W20240131 09:37:02.781543 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.076 us                | 237.359 us                |
| GenInput                  | 32.709 ms                 | 44.153 ms                 |
| NN                        | 617.008 us                | 143.371 ms                |
| Forward                   | 904.833 us                | 144.494 ms                |
| Backward                  | 2.664 ms                  | 153.657 ms                |
| Optimize                  | 217.450 us                | 8.701 ms                  |
| BarrierTimeBeforeRank0    | 17.475 us                 | 781.114 us                |
| AfterBackward             | 86.709 ms                 | 1.729 s                   |
| BlockToStepN              | 92.114 us                 | 240.079 ms                |
| OneStep                   | 130.408 ms                | 2.315 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240131 09:37:03.572019 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=67
W20240131 09:37:03.784404 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
W20240131 09:37:04.147025 1824090 grad_async_v2.h:256] pq is empty
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.524 us                | 11.818 ms                 |
| ProcessBack:Shuffle       | 83.604 ms                 | 828.787 ms                |
| ProcessBack:UpdateCache   | 1.065 ms                  | 763.618 ms                |
| ProcessBack:UpsertPq      | 52.153 us                 | 466.752 ms                |
| ProcessOneStep            | 110.332 ms                | 1.729 s                   |
| BlockToStepN              | 44.044 us                 | 239.723 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240131 09:37:04.572125 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=252
W20240131 09:37:05.156708 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240131 09:37:05.572047 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240131 09:37:06.572360 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240131 09:37:07.221983 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end0
E20240131 09:37:07.572111 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:08.280756 1824090 grad_async_v2.h:256] pq is empty
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240131 09:37:08.354547 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.999 us                | 237.359 us                |
| GenInput                  | 33.121 ms                 | 44.153 ms                 |
| NN                        | 585.245 us                | 143.371 ms                |
| Forward                   | 904.833 us                | 144.494 ms                |
| Backward                  | 2.537 ms                  | 153.657 ms                |
| Optimize                  | 202.490 us                | 8.701 ms                  |
| BarrierTimeBeforeRank0    | 44.340 us                 | 2.768 ms                  |
| AfterBackward             | 112.563 ms                | 1.729 s                   |
| BlockToStepN              | 97.318 us                 | 240.079 ms                |
| OneStep                   | 152.019 ms                | 2.315 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:08.572180 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.514 us                | 211.502 us                |
| ProcessBack:Shuffle       | 109.175 ms                | 1.107 s                   |
| ProcessBack:UpdateCache   | 1.065 ms                  | 763.618 ms                |
| ProcessBack:UpsertPq      | 52.262 us                 | 466.752 ms                |
| ProcessOneStep            | 112.542 ms                | 1.729 s                   |
| BlockToStepN              | 53.939 us                 | 239.723 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:09.413614 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
E20240131 09:37:09.572171 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240131 09:37:10.529318 1824090 grad_async_v2.h:256] pq is empty
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
E20240131 09:37:10.572315 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240131 09:37:11.030887 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240131 09:37:11.572242 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:12.372709 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240131 09:37:12.572197 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:12.686815 1824090 grad_async_v2.h:256] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.380 us                | 2.135 ms                  |
| GenInput                  | 32.709 ms                 | 52.680 ms                 |
| NN                        | 605.426 us                | 143.371 ms                |
| Forward                   | 912.326 us                | 144.494 ms                |
| Backward                  | 2.352 ms                  | 153.657 ms                |
| Optimize                  | 205.301 us                | 8.701 ms                  |
| BarrierTimeBeforeRank0    | 68.640 us                 | 2.782 ms                  |
| AfterBackward             | 304.852 ms                | 1.729 s                   |
| BlockToStepN              | 105.697 us                | 240.079 ms                |
| OneStep                   | 339.638 ms                | 2.315 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:13.405493 1824090 grad_async_v2.h:256] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240131 09:37:13.418208 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240131 09:37:13.572046 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.237 us                | 1.188 ms                  |
| ProcessBack:Shuffle       | 140.676 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.107 ms                  | 763.618 ms                |
| ProcessBack:UpsertPq      | 53.293 us                 | 466.752 ms                |
| ProcessOneStep            | 152.302 ms                | 1.729 s                   |
| BlockToStepN              | 55.656 us                 | 239.723 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:14.489701 1824090 grad_async_v2.h:256] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
E20240131 09:37:14.572022 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
W20240131 09:37:14.665576 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
E20240131 09:37:15.572161 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:15.719341 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240131 09:37:16.572448 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:16.823279 1824090 grad_async_v2.h:256] pq is empty
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240131 09:37:17.158586 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
E20240131 09:37:17.572345 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240131 09:37:18.176891 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.435 us                | 2.135 ms                  |
| GenInput                  | 33.461 ms                 | 47.555 ms                 |
| NN                        | 555.201 us                | 1.600 ms                  |
| Forward                   | 855.427 us                | 2.549 ms                  |
| Backward                  | 2.338 ms                  | 17.439 ms                 |
| Optimize                  | 199.683 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 33.444 us                 | 2.788 ms                  |
| AfterBackward             | 151.000 ms                | 1.352 s                   |
| BlockToStepN              | 124.606 us                | 312.395 us                |
| OneStep                   | 185.742 ms                | 1.395 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
E20240131 09:37:18.572098 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.094 us                | 205.842 us                |
| ProcessBack:Shuffle       | 140.676 ms                | 1.153 s                   |
| ProcessBack:UpdateCache   | 1.151 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 55.348 us                 | 77.106 us                 |
| ProcessOneStep            | 150.978 ms                | 1.352 s                   |
| BlockToStepN              | 70.558 us                 | 219.504 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:19.421201 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
E20240131 09:37:19.572146 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240131 09:37:20.503641 1824090 grad_async_v2.h:256] pq is empty
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240131 09:37:20.572297 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=32
W20240131 09:37:20.663424 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
E20240131 09:37:21.572090 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240131 09:37:22.161953 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
E20240131 09:37:22.572327 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.786 us                | 2.135 ms                  |
| GenInput                  | 33.867 ms                 | 48.049 ms                 |
| NN                        | 579.847 us                | 1.600 ms                  |
| Forward                   | 881.710 us                | 2.549 ms                  |
| Backward                  | 2.352 ms                  | 17.439 ms                 |
| Optimize                  | 202.366 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 33.444 us                 | 2.841 ms                  |
| AfterBackward             | 151.000 ms                | 1.374 s                   |
| BlockToStepN              | 135.199 us                | 386.360 us                |
| OneStep                   | 185.742 ms                | 1.428 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:23.572023 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
W20240131 09:37:23.852766 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.554 us                | 3.971 ms                  |
| ProcessBack:Shuffle       | 140.676 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.158 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 55.725 us                 | 79.411 us                 |
| ProcessOneStep            | 150.978 ms                | 1.373 s                   |
| BlockToStepN              | 77.350 us                 | 222.745 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:24.572011 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240131 09:37:25.140074 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240131 09:37:25.572063 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240131 09:37:26.490708 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240131 09:37:26.571257 1824090 grad_async_v2.h:256] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
E20240131 09:37:26.572026 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240131 09:37:27.444525 1824090 grad_async_v2.h:256] pq is empty
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240131 09:37:27.572320 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:27.916400 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
W20240131 09:37:28.238480 1824090 grad_async_v2.h:256] pq is empty
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.786 us                | 2.135 ms                  |
| GenInput                  | 35.177 ms                 | 48.049 ms                 |
| NN                        | 584.181 us                | 1.600 ms                  |
| Forward                   | 902.372 us                | 2.549 ms                  |
| Backward                  | 2.537 ms                  | 17.439 ms                 |
| Optimize                  | 202.490 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 44.340 us                 | 2.841 ms                  |
| AfterBackward             | 151.000 ms                | 1.374 s                   |
| BlockToStepN              | 148.919 us                | 386.360 us                |
| OneStep                   | 185.742 ms                | 1.428 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:28.572091 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.493 us                | 348.763 us                |
| ProcessBack:Shuffle       | 149.738 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.186 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 55.725 us                 | 79.411 us                 |
| ProcessOneStep            | 152.302 ms                | 1.373 s                   |
| BlockToStepN              | 94.684 us                 | 224.245 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
E20240131 09:37:29.572181 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:29.740846 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
E20240131 09:37:30.572108 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240131 09:37:30.972416 1824090 grad_async_v2.h:256] pq is empty
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240131 09:37:31.572381 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:31.676931 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
E20240131 09:37:32.588173 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:32.806628 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.435 us                | 2.135 ms                  |
| GenInput                  | 35.116 ms                 | 48.049 ms                 |
| NN                        | 579.847 us                | 4.038 ms                  |
| Forward                   | 881.710 us                | 4.295 ms                  |
| Backward                  | 2.352 ms                  | 17.439 ms                 |
| Optimize                  | 201.511 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 68.640 us                 | 2.850 ms                  |
| AfterBackward             | 141.743 ms                | 1.388 s                   |
| BlockToStepN              | 161.168 us                | 386.360 us                |
| OneStep                   | 182.548 ms                | 1.429 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:33.588119 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:37:33.959766 1824090 grad_async_v2.h:256] pq is empty
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240131 09:37:34.034361 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.105 us                | 13.353 ms                 |
| ProcessBack:Shuffle       | 109.175 ms                | 1.366 s                   |
| ProcessBack:UpdateCache   | 1.163 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 55.311 us                 | 93.129 us                 |
| ProcessOneStep            | 112.542 ms                | 1.388 s                   |
| BlockToStepN              | 107.067 us                | 224.245 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
E20240131 09:37:34.588022 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
E20240131 09:37:35.588135 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240131 09:37:35.632711 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
W20240131 09:37:36.269182 1824090 grad_async_v2.h:256] pq is empty
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240131 09:37:36.588019 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:36.794514 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
E20240131 09:37:37.588168 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.455 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 577.060 us                | 4.038 ms                  |
| Forward                   | 859.761 us                | 4.295 ms                  |
| Backward                  | 2.338 ms                  | 17.439 ms                 |
| Optimize                  | 198.589 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 74.064 us                 | 2.850 ms                  |
| AfterBackward             | 112.563 ms                | 1.388 s                   |
| BlockToStepN              | 176.438 us                | 460.924 us                |
| OneStep                   | 152.019 ms                | 1.429 s                   |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:38.588474 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:38.812283 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end0
W20240131 09:37:38.932590 1824090 grad_async_v2.h:256] pq is empty
Step99:rank3, time: 54.140, per_step: 0.541395
Step99:rank2, time: 54.139, per_step: 0.541395
Step99:rank1, time: 54.139, per_step: 0.541394
Step99:rank0, time: 54.139, per_step: 0.541394
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.455 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 577.060 us                | 4.038 ms                  |
| Forward                   | 859.761 us                | 4.295 ms                  |
| Backward                  | 2.338 ms                  | 17.439 ms                 |
| Optimize                  | 198.589 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 74.064 us                 | 2.850 ms                  |
| AfterBackward             | 112.563 ms                | 1.388 s                   |
| BlockToStepN              | 176.438 us                | 460.924 us                |
| OneStep                   | 152.019 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.238 us                | 9.874 ms                  |
| ProcessBack:Shuffle       | 104.833 ms                | 1.366 s                   |
| ProcessBack:UpdateCache   | 1.166 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 55.725 us                 | 93.129 us                 |
| ProcessOneStep            | 112.542 ms                | 1.388 s                   |
| BlockToStepN              | 119.458 us                | 352.655 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:39.588169 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240131 09:37:40.448325 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
E20240131 09:37:40.588023 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:37:41.588045 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240131 09:37:42.001739 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240131 09:37:42.588088 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240131 09:37:43.291257 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.435 us                | 2.135 ms                  |
| GenInput                  | 35.116 ms                 | 48.722 ms                 |
| NN                        | 578.249 us                | 4.038 ms                  |
| Forward                   | 876.550 us                | 4.295 ms                  |
| Backward                  | 2.379 ms                  | 17.439 ms                 |
| Optimize                  | 200.991 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 50.299 us                 | 2.850 ms                  |
| AfterBackward             | 141.743 ms                | 1.388 s                   |
| BlockToStepN              | 180.459 us                | 495.680 us                |
| OneStep                   | 182.548 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:43.588158 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.439 us                | 6.035 ms                  |
| ProcessBack:Shuffle       | 135.686 ms                | 1.366 s                   |
| ProcessBack:UpdateCache   | 1.163 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 55.735 us                 | 93.129 us                 |
| ProcessOneStep            | 150.978 ms                | 1.388 s                   |
| BlockToStepN              | 129.458 us                | 383.168 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
E20240131 09:37:44.588016 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=152
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240131 09:37:44.828642 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
E20240131 09:37:45.588156 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:45.941613 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
E20240131 09:37:46.588119 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240131 09:37:47.588174 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:47.628098 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.792 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 579.847 us                | 4.038 ms                  |
| Forward                   | 881.710 us                | 4.295 ms                  |
| Backward                  | 2.368 ms                  | 17.439 ms                 |
| Optimize                  | 202.366 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 44.340 us                 | 2.850 ms                  |
| AfterBackward             | 141.743 ms                | 1.388 s                   |
| BlockToStepN              | 199.829 us                | 790.161 us                |
| OneStep                   | 182.548 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:48.588294 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:49.023857 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.247 us                | 6.031 ms                  |
| ProcessBack:Shuffle       | 135.686 ms                | 1.366 s                   |
| ProcessBack:UpdateCache   | 1.214 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 56.485 us                 | 93.129 us                 |
| ProcessOneStep            | 150.978 ms                | 1.388 s                   |
| BlockToStepN              | 140.312 us                | 410.747 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:37:49.588114 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240131 09:37:50.102789 1824090 grad_async_v2.h:256] pq is empty
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240131 09:37:50.335518 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
W20240131 09:37:50.479254 1824090 grad_async_v2.h:256] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
E20240131 09:37:50.588052 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=87
E20240131 09:37:51.588157 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:51.960995 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
W20240131 09:37:51.977552 1824090 grad_async_v2.h:256] pq is empty
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
E20240131 09:37:52.588086 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.786 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 579.847 us                | 4.038 ms                  |
| Forward                   | 881.710 us                | 4.295 ms                  |
| Backward                  | 2.379 ms                  | 17.439 ms                 |
| Optimize                  | 202.490 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 37.207 us                 | 2.850 ms                  |
| AfterBackward             | 151.000 ms                | 1.389 s                   |
| BlockToStepN              | 207.037 us                | 790.161 us                |
| OneStep                   | 185.742 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
E20240131 09:37:53.588379 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:53.736284 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.088 us                | 11.702 ms                 |
| ProcessBack:Shuffle       | 149.738 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.278 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 56.682 us                 | 93.129 us                 |
| ProcessOneStep            | 213.948 ms                | 1.389 s                   |
| BlockToStepN              | 147.783 us                | 410.747 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
E20240131 09:37:54.588534 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:37:54.966864 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
E20240131 09:37:55.588091 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240131 09:37:56.261543 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end3
E20240131 09:37:56.588356 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240131 09:37:57.314217 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
E20240131 09:37:57.588536 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.786 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 579.847 us                | 4.038 ms                  |
| Forward                   | 881.710 us                | 4.295 ms                  |
| Backward                  | 2.379 ms                  | 17.439 ms                 |
| Optimize                  | 202.490 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 50.299 us                 | 2.850 ms                  |
| AfterBackward             | 213.977 ms                | 1.389 s                   |
| BlockToStepN              | 209.221 us                | 790.161 us                |
| OneStep                   | 254.498 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:58.402068 1824090 grad_async_v2.h:256] pq is empty
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240131 09:37:58.420174 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
E20240131 09:37:58.588112 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.928 us                | 3.215 ms                  |
| ProcessBack:Shuffle       | 151.320 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.286 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 56.782 us                 | 93.129 us                 |
| ProcessOneStep            | 171.393 ms                | 1.389 s                   |
| BlockToStepN              | 152.365 us                | 424.267 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:37:59.506898 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240131 09:37:59.588220 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:37:59.889825 1824090 grad_async_v2.h:256] pq is empty
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240131 09:38:00.394523 1824090 grad_async_v2.h:256] pq is empty
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240131 09:38:00.536160 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
E20240131 09:38:00.588251 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240131 09:38:01.583339 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
E20240131 09:38:01.588115 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:38:01.979744 1824090 grad_async_v2.h:256] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240131 09:38:02.270967 1824090 grad_async_v2.h:256] pq is empty
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240131 09:38:02.588148 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:02.601560 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240131 09:38:02.978807 1824090 grad_async_v2.h:256] pq is empty
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.786 us                | 5.804 ms                  |
| GenInput                  | 35.177 ms                 | 48.722 ms                 |
| NN                        | 578.249 us                | 6.736 ms                  |
| Forward                   | 876.550 us                | 7.169 ms                  |
| Backward                  | 2.379 ms                  | 17.439 ms                 |
| Optimize                  | 202.490 us                | 902.340 us                |
| BarrierTimeBeforeRank0    | 50.299 us                 | 2.898 ms                  |
| AfterBackward             | 244.059 ms                | 1.389 s                   |
| BlockToStepN              | 213.932 us                | 790.161 us                |
| OneStep                   | 288.903 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:03.510033 1824090 grad_async_v2.h:256] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
E20240131 09:38:03.588024 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=52
W20240131 09:38:03.645560 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.810 us                | 12.169 ms                 |
| ProcessBack:Shuffle       | 211.924 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.278 ms                  | 15.620 ms                 |
| ProcessBack:UpsertPq      | 57.785 us                 | 107.685 us                |
| ProcessOneStep            | 244.039 ms                | 1.389 s                   |
| BlockToStepN              | 158.591 us                | 424.267 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:04.520381 1824090 grad_async_v2.h:256] pq is empty
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
E20240131 09:38:04.588019 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240131 09:38:04.679529 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
W20240131 09:38:05.623068 1824090 grad_async_v2.h:256] pq is empty
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
E20240131 09:38:05.636855 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:05.745234 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240131 09:38:06.010851 1824090 grad_async_v2.h:256] pq is empty
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240131 09:38:06.603750 1824090 grad_async_v2.h:256] pq is empty
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240131 09:38:06.636071 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=61
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240131 09:38:06.873363 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240131 09:38:07.636065 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=53
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240131 09:38:08.074769 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.733 us                | 2.135 ms                  |
| GenInput                  | 35.177 ms                 | 48.624 ms                 |
| NN                        | 579.847 us                | 4.038 ms                  |
| Forward                   | 876.550 us                | 4.295 ms                  |
| Backward                  | 2.352 ms                  | 8.986 ms                  |
| Optimize                  | 202.632 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 37.207 us                 | 2.850 ms                  |
| AfterBackward             | 260.222 ms                | 1.388 s                   |
| BlockToStepN              | 228.551 us                | 790.161 us                |
| OneStep                   | 291.165 ms                | 1.428 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:08.565766 1824090 grad_async_v2.h:256] pq is empty
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240131 09:38:08.636250 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240131 09:38:09.186146 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 97.980 us                 | 5.614 ms                  |
| ProcessBack:Shuffle       | 217.420 ms                | 1.377 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 58.025 us                 | 93.129 us                 |
| ProcessOneStep            | 260.195 ms                | 1.388 s                   |
| BlockToStepN              | 162.880 us                | 492.672 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
E20240131 09:38:09.636020 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:38:09.765403 1824090 grad_async_v2.h:256] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240131 09:38:10.417560 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
E20240131 09:38:10.636116 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:38:11.636049 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240131 09:38:11.778486 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240131 09:38:12.636307 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:12.854668 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240131 09:38:12.984314 1824090 grad_async_v2.h:256] pq is empty
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.999 us                | 2.135 ms                  |
| GenInput                  | 35.397 ms                 | 48.624 ms                 |
| NN                        | 585.245 us                | 4.038 ms                  |
| Forward                   | 897.105 us                | 4.295 ms                  |
| Backward                  | 2.360 ms                  | 8.986 ms                  |
| Optimize                  | 202.751 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 36.120 us                 | 2.850 ms                  |
| AfterBackward             | 260.222 ms                | 1.388 s                   |
| BlockToStepN              | 246.030 us                | 790.161 us                |
| OneStep                   | 291.165 ms                | 1.428 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:13.496802 1824090 grad_async_v2.h:256] pq is empty
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240131 09:38:13.636415 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=105
W20240131 09:38:13.984612 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
W20240131 09:38:14.292445 1824090 grad_async_v2.h:256] pq is empty
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.438 us                | 5.966 ms                  |
| ProcessBack:Shuffle       | 217.420 ms                | 1.378 s                   |
| ProcessBack:UpdateCache   | 1.323 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 58.286 us                 | 107.685 us                |
| ProcessOneStep            | 260.195 ms                | 1.388 s                   |
| BlockToStepN              | 169.623 us                | 492.672 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:14.636232 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240131 09:38:15.072896 1824090 grad_async_v2.h:256] pq is empty
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
W20240131 09:38:15.205691 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
E20240131 09:38:15.636538 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:38:16.402724 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240131 09:38:16.637544 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:16.892048 1824090 grad_async_v2.h:256] pq is empty
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240131 09:38:17.637318 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240131 09:38:17.936636 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.733 us                | 2.135 ms                  |
| GenInput                  | 35.397 ms                 | 48.624 ms                 |
| NN                        | 585.245 us                | 4.038 ms                  |
| Forward                   | 881.710 us                | 4.295 ms                  |
| Backward                  | 2.333 ms                  | 8.986 ms                  |
| Optimize                  | 202.700 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 37.207 us                 | 2.850 ms                  |
| AfterBackward             | 244.059 ms                | 1.389 s                   |
| BlockToStepN              | 258.003 us                | 1.273 ms                  |
| OneStep                   | 288.903 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:18.637069 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:38:19.283200 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end8
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 95.041 us                 | 4.810 ms                  |
| ProcessBack:Shuffle       | 217.420 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.408 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 58.807 us                 | 107.685 us                |
| ProcessOneStep            | 244.039 ms                | 1.389 s                   |
| BlockToStepN              | 176.756 us                | 492.672 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:19.637042 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:38:20.637154 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:38:20.763424 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240131 09:38:21.637353 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:38:21.863111 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240131 09:38:22.637080 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:38:22.990547 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240131 09:38:23.123584 1824090 grad_async_v2.h:256] pq is empty
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.733 us                | 2.135 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 589.696 us                | 4.038 ms                  |
| Forward                   | 896.853 us                | 4.295 ms                  |
| Backward                  | 2.333 ms                  | 8.986 ms                  |
| Optimize                  | 202.751 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 44.340 us                 | 2.850 ms                  |
| AfterBackward             | 226.061 ms                | 1.389 s                   |
| BlockToStepN              | 266.325 us                | 1.273 ms                  |
| OneStep                   | 266.978 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:23.637115 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:38:24.001698 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.085 us                | 5.948 ms                  |
| ProcessBack:Shuffle       | 217.420 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.408 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 58.970 us                 | 107.685 us                |
| ProcessOneStep            | 244.039 ms                | 1.389 s                   |
| BlockToStepN              | 183.251 us                | 532.697 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:24.637028 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:25.023512 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240131 09:38:25.637187 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:26.141222 1824090 grad_async_v2.h:256] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240131 09:38:26.159950 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240131 09:38:26.639092 1824090 grad_async_v2.h:256] pq is empty
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
E20240131 09:38:26.652117 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:27.125665 1824090 grad_async_v2.h:256] pq is empty
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240131 09:38:27.263168 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240131 09:38:27.652105 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=75
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240131 09:38:27.940539 1824090 grad_async_v2.h:256] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.036 us                | 5.804 ms                  |
| GenInput                  | 35.436 ms                 | 48.722 ms                 |
| NN                        | 589.541 us                | 4.038 ms                  |
| Forward                   | 896.853 us                | 4.295 ms                  |
| Backward                  | 2.312 ms                  | 8.986 ms                  |
| Optimize                  | 202.751 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 38.574 us                 | 2.850 ms                  |
| AfterBackward             | 244.059 ms                | 1.389 s                   |
| BlockToStepN              | 272.616 us                | 1.273 ms                  |
| OneStep                   | 288.903 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 42.972 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240131 09:38:28.652565 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:28.657615 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.451 us                | 931.594 us                |
| ProcessBack:Shuffle       | 225.120 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.388 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 59.687 us                 | 110.466 us                |
| ProcessOneStep            | 244.039 ms                | 1.389 s                   |
| BlockToStepN              | 188.252 us                | 532.697 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:29.652143 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:29.780807 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240131 09:38:30.652047 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=38
W20240131 09:38:31.109472 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
Step199:rank3, time: 52.341, per_step: 0.518226
Step199:rank2, time: 52.341, per_step: 0.518226
Step199:rank0, time: 52.341, per_step: 0.518226
Step199:rank1, time: 52.341, per_step: 0.518226
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.595 us                | 5.804 ms                  |
| GenInput                  | 35.774 ms                 | 48.722 ms                 |
| NN                        | 589.814 us                | 4.038 ms                  |
| Forward                   | 899.804 us                | 4.295 ms                  |
| Backward                  | 2.305 ms                  | 8.986 ms                  |
| Optimize                  | 203.749 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 38.574 us                 | 2.850 ms                  |
| AfterBackward             | 260.222 ms                | 1.389 s                   |
| BlockToStepN              | 273.923 us                | 1.273 ms                  |
| OneStep                   | 291.165 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
E20240131 09:38:31.652134 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:32.253688 1824090 grad_async_v2.h:256] pq is empty
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240131 09:38:32.266451 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:38:32.653005 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:32.766624 1824090 grad_async_v2.h:256] pq is empty
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
W20240131 09:38:32.926553 1824090 grad_async_v2.h:256] pq is empty
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
W20240131 09:38:33.283020 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.595 us                | 5.804 ms                  |
| GenInput                  | 35.774 ms                 | 48.722 ms                 |
| NN                        | 591.866 us                | 4.038 ms                  |
| Forward                   | 902.372 us                | 4.295 ms                  |
| Backward                  | 2.312 ms                  | 8.986 ms                  |
| Optimize                  | 204.442 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 36.517 us                 | 2.850 ms                  |
| AfterBackward             | 262.991 ms                | 1.389 s                   |
| BlockToStepN              | 274.178 us                | 1.273 ms                  |
| OneStep                   | 303.409 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:33.652143 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240131 09:38:34.381646 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 119.324 us                | 3.872 ms                  |
| ProcessBack:Shuffle       | 259.147 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.385 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 60.048 us                 | 110.466 us                |
| ProcessOneStep            | 287.084 ms                | 1.389 s                   |
| BlockToStepN              | 193.679 us                | 661.033 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:34.652132 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:34.917393 1824090 grad_async_v2.h:256] pq is empty
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
W20240131 09:38:35.539703 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
E20240131 09:38:35.652099 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:38:35.896757 1824090 grad_async_v2.h:256] pq is empty
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
W20240131 09:38:36.437116 1824090 grad_async_v2.h:256] pq is empty
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240131 09:38:36.572717 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 09:38:36.652101 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:36.957170 1824090 grad_async_v2.h:256] pq is empty
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
W20240131 09:38:37.450405 1824090 grad_async_v2.h:256] pq is empty
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
W20240131 09:38:37.520295 1824090 grad_async_v2.h:256] pq is empty
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
W20240131 09:38:37.590934 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 09:38:37.652104 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.638 us                | 5.804 ms                  |
| GenInput                  | 35.774 ms                 | 48.722 ms                 |
| NN                        | 600.729 us                | 4.038 ms                  |
| Forward                   | 902.372 us                | 4.295 ms                  |
| Backward                  | 2.312 ms                  | 8.986 ms                  |
| Optimize                  | 203.901 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 38.574 us                 | 2.850 ms                  |
| AfterBackward             | 304.852 ms                | 1.389 s                   |
| BlockToStepN              | 276.325 us                | 1.273 ms                  |
| OneStep                   | 339.638 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:38.444341 1824090 grad_async_v2.h:256] pq is empty
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
W20240131 09:38:38.596920 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240131 09:38:38.652070 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 99.551 us                 | 3.417 ms                  |
| ProcessBack:Shuffle       | 261.481 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.378 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 60.575 us                 | 110.515 us                |
| ProcessOneStep            | 304.823 ms                | 1.389 s                   |
| BlockToStepN              | 197.020 us                | 661.033 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:39.482592 1824090 grad_async_v2.h:256] pq is empty
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240131 09:38:39.603116 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240131 09:38:39.652202 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
E20240131 09:38:40.652382 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:40.678012 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240131 09:38:40.931993 1824090 grad_async_v2.h:256] pq is empty
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
W20240131 09:38:41.435292 1824090 grad_async_v2.h:256] pq is empty
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240131 09:38:41.652032 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:41.680714 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240131 09:38:41.941711 1824090 grad_async_v2.h:256] pq is empty
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
W20240131 09:38:42.895246 1824090 grad_async_v2.h:256] pq is empty
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240131 09:38:42.908967 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:38:42.909060 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.595 us                | 5.804 ms                  |
| GenInput                  | 35.436 ms                 | 48.722 ms                 |
| NN                        | 602.288 us                | 4.038 ms                  |
| Forward                   | 904.833 us                | 4.295 ms                  |
| Backward                  | 2.306 ms                  | 8.986 ms                  |
| Optimize                  | 203.901 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 36.517 us                 | 2.850 ms                  |
| AfterBackward             | 329.489 ms                | 1.389 s                   |
| BlockToStepN              | 278.338 us                | 1.273 ms                  |
| OneStep                   | 372.136 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:38:43.420234 1824090 grad_async_v2.h:256] pq is empty
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
E20240131 09:38:43.909618 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:44.147787 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 119.586 us                | 11.246 ms                 |
| ProcessBack:Shuffle       | 312.480 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.327 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 61.320 us                 | 110.515 us                |
| ProcessOneStep            | 329.460 ms                | 1.389 s                   |
| BlockToStepN              | 198.856 us                | 661.033 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240131 09:38:44.790372 1824090 grad_async_v2.h:256] pq is empty
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
E20240131 09:38:44.909413 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240131 09:38:45.667413 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
E20240131 09:38:45.909370 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240131 09:38:46.869212 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240131 09:38:46.909139 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
E20240131 09:38:47.909215 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:48.065280 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end6
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.595 us                | 5.804 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 591.866 us                | 4.038 ms                  |
| Forward                   | 903.777 us                | 4.295 ms                  |
| Backward                  | 2.306 ms                  | 8.986 ms                  |
| Optimize                  | 203.446 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 31.396 us                 | 2.850 ms                  |
| AfterBackward             | 304.852 ms                | 1.389 s                   |
| BlockToStepN              | 281.507 us                | 1.273 ms                  |
| OneStep                   | 343.834 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:48.909245 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:49.265153 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.696 us                | 566.270 us                |
| ProcessBack:Shuffle       | 283.376 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.378 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 61.382 us                 | 110.515 us                |
| ProcessOneStep            | 304.823 ms                | 1.389 s                   |
| BlockToStepN              | 203.453 us                | 661.033 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
E20240131 09:38:49.909766 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240131 09:38:50.909219 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:38:51.112509 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
E20240131 09:38:51.909147 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
E20240131 09:38:52.909065 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
W20240131 09:38:53.001555 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.150 us                | 5.804 ms                  |
| GenInput                  | 35.356 ms                 | 48.722 ms                 |
| NN                        | 600.729 us                | 4.038 ms                  |
| Forward                   | 904.833 us                | 4.295 ms                  |
| Backward                  | 2.306 ms                  | 8.986 ms                  |
| Optimize                  | 203.749 us                | 560.444 us                |
| BarrierTimeBeforeRank0    | 33.177 us                 | 2.850 ms                  |
| AfterBackward             | 313.907 ms                | 1.389 s                   |
| BlockToStepN              | 288.347 us                | 1.273 ms                  |
| OneStep                   | 355.026 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
E20240131 09:38:53.909096 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 90.548 us                 | 196.802 us                |
| ProcessBack:Shuffle       | 283.376 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.385 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 61.382 us                 | 110.515 us                |
| ProcessOneStep            | 304.823 ms                | 1.389 s                   |
| BlockToStepN              | 208.245 us                | 765.528 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 09:38:54.909152 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
W20240131 09:38:55.112882 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
E20240131 09:38:55.909127 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
E20240131 09:38:56.909031 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=44
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
W20240131 09:38:57.217486 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
E20240131 09:38:57.909557 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:38:58.301168 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.150 us                | 5.695 ms                  |
| GenInput                  | 35.359 ms                 | 48.624 ms                 |
| NN                        | 604.222 us                | 1.919 ms                  |
| Forward                   | 913.630 us                | 2.549 ms                  |
| Backward                  | 2.290 ms                  | 8.110 ms                  |
| Optimize                  | 203.901 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 33.177 us                 | 2.841 ms                  |
| AfterBackward             | 326.485 ms                | 1.389 s                   |
| BlockToStepN              | 294.924 us                | 1.058 ms                  |
| OneStep                   | 370.219 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
E20240131 09:38:58.909780 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.720 us                 | 980.256 us                |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.408 ms                  | 10.487 ms                 |
| ProcessBack:UpsertPq      | 61.382 us                 | 110.466 us                |
| ProcessOneStep            | 326.449 ms                | 1.389 s                   |
| BlockToStepN              | 215.751 us                | 748.516 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
W20240131 09:38:59.846259 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240131 09:38:59.909065 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240131 09:39:00.909076 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:01.635725 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end5
W20240131 09:39:01.810583 1824090 grad_async_v2.h:256] pq is empty
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
E20240131 09:39:01.909020 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240131 09:39:02.677109 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
E20240131 09:39:02.909065 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.251 us                | 5.695 ms                  |
| GenInput                  | 35.585 ms                 | 48.722 ms                 |
| NN                        | 605.980 us                | 1.919 ms                  |
| Forward                   | 917.006 us                | 2.549 ms                  |
| Backward                  | 2.282 ms                  | 8.110 ms                  |
| Optimize                  | 204.442 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 33.197 us                 | 2.841 ms                  |
| AfterBackward             | 313.907 ms                | 1.389 s                   |
| BlockToStepN              | 296.739 us                | 1.273 ms                  |
| OneStep                   | 355.026 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
W20240131 09:39:03.784551 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end8
E20240131 09:39:03.909042 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 120.920 us                | 5.767 ms                  |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.400 ms                  | 10.487 ms                 |
| ProcessBack:UpsertPq      | 61.481 us                 | 110.466 us                |
| ProcessOneStep            | 317.315 ms                | 1.389 s                   |
| BlockToStepN              | 225.677 us                | 765.528 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240131 09:39:04.909548 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:05.141233 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
E20240131 09:39:05.909538 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
E20240131 09:39:06.909025 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:07.111790 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
E20240131 09:39:07.909152 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.251 us                | 5.695 ms                  |
| GenInput                  | 35.585 ms                 | 48.722 ms                 |
| NN                        | 605.980 us                | 1.919 ms                  |
| Forward                   | 917.006 us                | 2.549 ms                  |
| Backward                  | 2.277 ms                  | 8.110 ms                  |
| Optimize                  | 204.442 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 33.177 us                 | 2.848 ms                  |
| AfterBackward             | 317.369 ms                | 1.389 s                   |
| BlockToStepN              | 303.087 us                | 1.273 ms                  |
| OneStep                   | 360.507 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:08.711203 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
E20240131 09:39:08.909075 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.534 us                | 327.461 us                |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.400 ms                  | 10.487 ms                 |
| ProcessBack:UpsertPq      | 61.699 us                 | 110.466 us                |
| ProcessOneStep            | 317.315 ms                | 1.389 s                   |
| BlockToStepN              | 229.810 us                | 914.528 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:09.421361 1824090 grad_async_v2.h:256] pq is empty
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240131 09:39:09.796416 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 09:39:09.909514 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=51
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
E20240131 09:39:10.909085 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:10.947846 1824090 grad_async_v2.h:256] pq is empty
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240131 09:39:10.954860 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
E20240131 09:39:11.909279 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240131 09:39:12.163827 1824090 grad_async_v2.h:256] pq is empty
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
W20240131 09:39:12.529687 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240131 09:39:12.909087 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240131 09:39:13.117791 1824090 grad_async_v2.h:256] pq is empty
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.280 us                | 5.695 ms                  |
| GenInput                  | 35.630 ms                 | 48.722 ms                 |
| NN                        | 605.368 us                | 1.919 ms                  |
| Forward                   | 914.307 us                | 2.549 ms                  |
| Backward                  | 2.267 ms                  | 8.110 ms                  |
| Optimize                  | 203.641 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.850 ms                  |
| AfterBackward             | 304.852 ms                | 1.389 s                   |
| BlockToStepN              | 312.395 us                | 1.278 ms                  |
| OneStep                   | 343.834 ms                | 1.429 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
E20240131 09:39:13.909198 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:13.966282 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.243 us                | 192.188 us                |
| ProcessBack:Shuffle       | 289.798 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.408 ms                  | 10.487 ms                 |
| ProcessBack:UpsertPq      | 61.923 us                 | 110.466 us                |
| ProcessOneStep            | 304.823 ms                | 1.389 s                   |
| BlockToStepN              | 237.899 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:39:14.909117 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:15.242426 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
E20240131 09:39:15.909013 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:15.925011 1824090 grad_async_v2.h:256] pq is empty
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
W20240131 09:39:16.409307 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240131 09:39:16.909047 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:39:17.024963 1824090 grad_async_v2.h:256] pq is empty
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240131 09:39:17.539948 1824090 grad_async_v2.h:256] pq is empty
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
W20240131 09:39:17.546697 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 09:39:17.909015 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:18.028209 1824090 grad_async_v2.h:256] pq is empty
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.280 us                | 5.695 ms                  |
| GenInput                  | 35.585 ms                 | 48.722 ms                 |
| NN                        | 605.426 us                | 1.919 ms                  |
| Forward                   | 916.525 us                | 2.549 ms                  |
| Backward                  | 2.269 ms                  | 8.110 ms                  |
| Optimize                  | 203.749 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 33.177 us                 | 2.850 ms                  |
| AfterBackward             | 317.369 ms                | 1.391 s                   |
| BlockToStepN              | 315.142 us                | 1.278 ms                  |
| OneStep                   | 360.507 ms                | 1.444 s                   |
| E2E-100                   | 42.972 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240131 09:39:18.635623 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 09:39:18.909236 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:39:19.003824 1824090 grad_async_v2.h:256] pq is empty
Step299:rank2, time: 47.730, per_step: 0.472577
Step299:rank3, time: 47.730, per_step: 0.472577
Step299:rank0, time: 47.730, per_step: 0.472577
Step299:rank1, time: 47.730, per_step: 0.472577
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.280 us                | 5.695 ms                  |
| GenInput                  | 35.518 ms                 | 48.722 ms                 |
| NN                        | 605.426 us                | 1.919 ms                  |
| Forward                   | 916.525 us                | 2.549 ms                  |
| Backward                  | 2.269 ms                  | 8.110 ms                  |
| Optimize                  | 203.749 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 32.400 us                 | 2.850 ms                  |
| AfterBackward             | 326.485 ms                | 1.391 s                   |
| BlockToStepN              | 316.881 us                | 1.278 ms                  |
| OneStep                   | 370.219 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.559 us                | 2.131 ms                  |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.382 ms                  | 10.487 ms                 |
| ProcessBack:UpsertPq      | 61.923 us                 | 110.515 us                |
| ProcessOneStep            | 326.449 ms                | 1.391 s                   |
| BlockToStepN              | 242.190 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:19.504894 1824090 grad_async_v2.h:256] pq is empty
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
W20240131 09:39:19.760138 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 09:39:19.909139 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:20.730448 1824090 grad_async_v2.h:256] pq is empty
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
W20240131 09:39:20.893843 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240131 09:39:20.909039 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
E20240131 09:39:21.909271 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:22.160923 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
W20240131 09:39:22.901075 1824090 grad_async_v2.h:256] pq is empty
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
E20240131 09:39:22.909209 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=22
W20240131 09:39:23.214236 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.525 us                | 5.695 ms                  |
| GenInput                  | 35.359 ms                 | 48.722 ms                 |
| NN                        | 607.073 us                | 2.254 ms                  |
| Forward                   | 917.536 us                | 2.611 ms                  |
| Backward                  | 2.280 ms                  | 8.110 ms                  |
| Optimize                  | 203.901 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 32.400 us                 | 2.850 ms                  |
| AfterBackward             | 326.485 ms                | 1.391 s                   |
| BlockToStepN              | 329.199 us                | 1.278 ms                  |
| OneStep                   | 370.219 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:39:23.909149 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.624 us                | 11.501 ms                 |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 61.699 us                 | 110.515 us                |
| ProcessOneStep            | 326.449 ms                | 1.391 s                   |
| BlockToStepN              | 251.415 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:24.546577 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240131 09:39:24.909337 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:25.426853 1824090 grad_async_v2.h:256] pq is empty
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
W20240131 09:39:25.567005 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240131 09:39:25.909126 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
W20240131 09:39:26.402938 1824090 grad_async_v2.h:256] pq is empty
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
W20240131 09:39:26.641229 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
E20240131 09:39:26.909036 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
E20240131 09:39:27.909435 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:28.019799 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.433 us                | 5.695 ms                  |
| GenInput                  | 35.518 ms                 | 49.267 ms                 |
| NN                        | 611.602 us                | 2.254 ms                  |
| Forward                   | 918.105 us                | 4.295 ms                  |
| Backward                  | 2.261 ms                  | 8.110 ms                  |
| Optimize                  | 203.901 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.628 us                 | 2.850 ms                  |
| AfterBackward             | 326.485 ms                | 1.391 s                   |
| BlockToStepN              | 334.013 us                | 1.278 ms                  |
| OneStep                   | 370.219 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:39:28.909055 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:39:29.015121 1824090 grad_async_v2.h:256] pq is empty
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
W20240131 09:39:29.024204 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.485 us                | 9.852 ms                  |
| ProcessBack:Shuffle       | 303.746 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 61.923 us                 | 110.515 us                |
| ProcessOneStep            | 326.449 ms                | 1.391 s                   |
| BlockToStepN              | 253.215 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:29.737274 1824090 grad_async_v2.h:256] pq is empty
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
E20240131 09:39:29.909296 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:39:30.117434 1824090 grad_async_v2.h:256] pq is empty
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
W20240131 09:39:30.243122 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 09:39:30.909188 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
W20240131 09:39:31.329669 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 09:39:31.623275 1824090 grad_async_v2.h:256] pq is empty
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
E20240131 09:39:31.909055 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240131 09:39:31.988957 1824090 grad_async_v2.h:256] pq is empty
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
W20240131 09:39:32.364029 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
E20240131 09:39:32.909313 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
W20240131 09:39:33.379263 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.433 us                | 5.695 ms                  |
| GenInput                  | 35.436 ms                 | 49.267 ms                 |
| NN                        | 613.497 us                | 2.254 ms                  |
| Forward                   | 919.445 us                | 4.295 ms                  |
| Backward                  | 2.259 ms                  | 8.110 ms                  |
| Optimize                  | 203.749 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.850 ms                  |
| AfterBackward             | 334.712 ms                | 1.391 s                   |
| BlockToStepN              | 342.143 us                | 1.278 ms                  |
| OneStep                   | 376.328 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
W20240131 09:39:33.590814 1824090 grad_async_v2.h:256] pq is empty
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
E20240131 09:39:33.909127 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.137 us                | 5.719 ms                  |
| ProcessBack:Shuffle       | 324.052 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 62.134 us                 | 111.036 us                |
| ProcessOneStep            | 334.561 ms                | 1.391 s                   |
| BlockToStepN              | 258.045 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:34.465942 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
E20240131 09:39:34.909515 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
W20240131 09:39:35.467495 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240131 09:39:35.601122 1824090 grad_async_v2.h:256] pq is empty
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
E20240131 09:39:35.909118 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:39:35.929112 1824090 grad_async_v2.h:256] pq is empty
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
W20240131 09:39:36.713892 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
E20240131 09:39:36.909197 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=73
W20240131 09:39:37.593607 1824090 grad_async_v2.h:256] pq is empty
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
W20240131 09:39:37.740316 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
E20240131 09:39:37.909018 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.525 us                | 5.695 ms                  |
| GenInput                  | 35.397 ms                 | 49.627 ms                 |
| NN                        | 611.602 us                | 2.254 ms                  |
| Forward                   | 919.736 us                | 5.401 ms                  |
| Backward                  | 2.259 ms                  | 8.110 ms                  |
| Optimize                  | 203.446 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 30.830 us                 | 2.850 ms                  |
| AfterBackward             | 334.588 ms                | 1.391 s                   |
| BlockToStepN              | 349.556 us                | 1.278 ms                  |
| OneStep                   | 372.136 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
E20240131 09:39:38.909040 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=34
W20240131 09:39:39.088176 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.633 us                | 11.419 ms                 |
| ProcessBack:Shuffle       | 324.052 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.327 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 62.274 us                 | 111.036 us                |
| ProcessOneStep            | 334.561 ms                | 1.391 s                   |
| BlockToStepN              | 261.789 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
E20240131 09:39:39.909032 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:40.639868 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
E20240131 09:39:40.909030 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
W20240131 09:39:41.788125 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240131 09:39:41.909610 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:41.923799 1824090 grad_async_v2.h:256] pq is empty
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
W20240131 09:39:42.804708 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240131 09:39:42.909293 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.251 us                | 5.695 ms                  |
| GenInput                  | 35.436 ms                 | 49.627 ms                 |
| NN                        | 613.497 us                | 2.254 ms                  |
| Forward                   | 920.527 us                | 5.401 ms                  |
| Backward                  | 2.254 ms                  | 8.110 ms                  |
| Optimize                  | 203.016 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 30.830 us                 | 2.850 ms                  |
| AfterBackward             | 334.588 ms                | 1.410 s                   |
| BlockToStepN              | 360.813 us                | 1.278 ms                  |
| OneStep                   | 372.136 ms                | 1.454 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
W20240131 09:39:43.900698 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
E20240131 09:39:43.909421 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.112 us                | 1.538 ms                  |
| ProcessBack:Shuffle       | 324.052 ms                | 1.382 s                   |
| ProcessBack:UpdateCache   | 1.327 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 62.303 us                 | 111.036 us                |
| ProcessOneStep            | 334.561 ms                | 1.410 s                   |
| BlockToStepN              | 273.185 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
W20240131 09:39:44.902321 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
E20240131 09:39:44.909276 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:39:45.522567 1824090 grad_async_v2.h:256] pq is empty
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
E20240131 09:39:45.909227 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:39:45.932384 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
W20240131 09:39:45.935590 1824090 grad_async_v2.h:256] pq is empty
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
E20240131 09:39:46.909060 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:39:47.262889 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
E20240131 09:39:47.909380 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.525 us                | 5.483 ms                  |
| GenInput                  | 35.397 ms                 | 49.267 ms                 |
| NN                        | 611.602 us                | 1.919 ms                  |
| Forward                   | 919.736 us                | 4.582 ms                  |
| Backward                  | 2.259 ms                  | 7.464 ms                  |
| Optimize                  | 203.446 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.850 ms                  |
| AfterBackward             | 329.489 ms                | 1.391 s                   |
| BlockToStepN              | 374.366 us                | 1.278 ms                  |
| OneStep                   | 370.219 ms                | 1.444 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:48.426003 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
E20240131 09:39:48.909323 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.204 us                | 1.507 ms                  |
| ProcessBack:Shuffle       | 315.857 ms                | 1.381 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 62.303 us                 | 110.515 us                |
| ProcessOneStep            | 330.006 ms                | 1.391 s                   |
| BlockToStepN              | 285.634 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:39:49.909152 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=89
W20240131 09:39:50.062315 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
W20240131 09:39:50.830485 1824090 grad_async_v2.h:256] pq is empty
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
E20240131 09:39:50.909240 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:51.072940 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
E20240131 09:39:51.909032 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
W20240131 09:39:51.935194 1824090 grad_async_v2.h:256] pq is empty
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
W20240131 09:39:52.183684 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end2
E20240131 09:39:52.909132 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:39:53.269737 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.120 us                | 5.483 ms                  |
| GenInput                  | 35.518 ms                 | 49.373 ms                 |
| NN                        | 611.602 us                | 1.919 ms                  |
| Forward                   | 920.527 us                | 4.582 ms                  |
| Backward                  | 2.257 ms                  | 8.110 ms                  |
| Optimize                  | 203.446 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.396 us                 | 2.850 ms                  |
| AfterBackward             | 326.485 ms                | 1.410 s                   |
| BlockToStepN              | 382.351 us                | 1.278 ms                  |
| OneStep                   | 365.647 ms                | 1.454 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
E20240131 09:39:53.909356 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
W20240131 09:39:54.359228 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.596 us                | 11.077 ms                 |
| ProcessBack:Shuffle       | 303.746 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 10.511 ms                 |
| ProcessBack:UpsertPq      | 62.196 us                 | 110.515 us                |
| ProcessOneStep            | 326.449 ms                | 1.410 s                   |
| BlockToStepN              | 292.680 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:54.848640 1824090 grad_async_v2.h:256] pq is empty
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
E20240131 09:39:54.909271 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:39:55.565742 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240131 09:39:55.909097 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
W20240131 09:39:56.832530 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240131 09:39:56.909111 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
W20240131 09:39:57.836932 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 09:39:57.909070 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:39:58.329167 1824090 grad_async_v2.h:256] pq is empty
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.800 us                | 5.483 ms                  |
| GenInput                  | 35.585 ms                 | 49.373 ms                 |
| NN                        | 617.008 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.260 ms                  | 8.901 ms                  |
| Optimize                  | 203.641 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.979 us                 | 2.898 ms                  |
| AfterBackward             | 330.046 ms                | 1.410 s                   |
| BlockToStepN              | 386.360 us                | 1.278 ms                  |
| OneStep                   | 372.121 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:39:58.906678 1824090 grad_async_v2.h:256] pq is empty
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
W20240131 09:39:58.919526 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:39:58.919683 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.306 us                | 5.942 ms                  |
| ProcessBack:Shuffle       | 312.480 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 11.797 ms                 |
| ProcessBack:UpsertPq      | 62.196 us                 | 110.515 us                |
| ProcessOneStep            | 330.006 ms                | 1.410 s                   |
| BlockToStepN              | 298.321 us                | 1.129 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
E20240131 09:39:59.919242 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:00.187144 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
E20240131 09:40:00.919674 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:01.195839 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240131 09:40:01.447491 1824090 grad_async_v2.h:256] pq is empty
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
E20240131 09:40:01.919167 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 09:40:02.302392 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240131 09:40:02.437252 1824090 grad_async_v2.h:256] pq is empty
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
E20240131 09:40:02.919162 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:40:03.305357 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.850 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 613.571 us                | 1.919 ms                  |
| Forward                   | 924.366 us                | 4.582 ms                  |
| Backward                  | 2.259 ms                  | 8.901 ms                  |
| Optimize                  | 203.446 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.396 us                 | 2.898 ms                  |
| AfterBackward             | 334.588 ms                | 1.410 s                   |
| BlockToStepN              | 393.156 us                | 3.172 ms                  |
| OneStep                   | 372.136 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:03.438808 1824090 grad_async_v2.h:256] pq is empty
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
W20240131 09:40:03.504650 1824090 grad_async_v2.h:256] pq is empty
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
W20240131 09:40:03.749734 1824090 grad_async_v2.h:256] pq is empty
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
E20240131 09:40:03.919118 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.697 us                | 4.375 ms                  |
| ProcessBack:Shuffle       | 312.480 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.323 ms                  | 11.797 ms                 |
| ProcessBack:UpsertPq      | 62.134 us                 | 110.515 us                |
| ProcessOneStep            | 330.006 ms                | 1.410 s                   |
| BlockToStepN              | 309.462 us                | 3.062 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
W20240131 09:40:04.608191 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
E20240131 09:40:04.919131 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:05.489917 1824090 grad_async_v2.h:256] pq is empty
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
W20240131 09:40:05.620800 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
E20240131 09:40:05.921346 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240131 09:40:06.601321 1824090 grad_async_v2.h:256] pq is empty
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
W20240131 09:40:06.629091 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240131 09:40:06.921077 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240131 09:40:07.496670 1824090 grad_async_v2.h:256] pq is empty
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
W20240131 09:40:07.631140 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240131 09:40:07.921103 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:08.008716 1824090 grad_async_v2.h:256] pq is empty
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
Step399:rank1, time: 49.372, per_step: 0.488833
Step399:rank2, time: 49.372, per_step: 0.488833
Step399:rank3, time: 49.372, per_step: 0.488833
Step399:rank0, time: 49.372, per_step: 0.488833
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.229 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 617.008 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.254 ms                  | 8.901 ms                  |
| Optimize                  | 203.016 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 30.830 us                 | 2.898 ms                  |
| AfterBackward             | 334.588 ms                | 1.410 s                   |
| BlockToStepN              | 394.473 us                | 3.172 ms                  |
| OneStep                   | 373.969 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.229 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 617.008 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.254 ms                  | 8.901 ms                  |
| Optimize                  | 203.016 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 30.830 us                 | 2.898 ms                  |
| AfterBackward             | 334.588 ms                | 1.410 s                   |
| BlockToStepN              | 394.473 us                | 3.172 ms                  |
| OneStep                   | 373.969 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:08.734493 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
E20240131 09:40:08.921481 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 130.494 us                | 2.073 ms                  |
| ProcessBack:Shuffle       | 324.887 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 11.797 ms                 |
| ProcessBack:UpsertPq      | 62.274 us                 | 111.036 us                |
| ProcessOneStep            | 334.678 ms                | 1.410 s                   |
| BlockToStepN              | 314.843 us                | 3.062 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:09.498687 1824090 grad_async_v2.h:256] pq is empty
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
W20240131 09:40:09.873934 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
E20240131 09:40:09.921160 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 09:40:10.921682 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:10.979460 1824090 grad_async_v2.h:256] pq is empty
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
W20240131 09:40:10.986491 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240131 09:40:11.476828 1824090 grad_async_v2.h:256] pq is empty
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
E20240131 09:40:11.921314 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:40:11.926702 1824090 grad_async_v2.h:256] pq is empty
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
W20240131 09:40:12.093678 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
E20240131 09:40:12.921178 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:12.966696 1824090 grad_async_v2.h:256] pq is empty
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
W20240131 09:40:13.093312 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.942 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 617.880 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.257 ms                  | 8.901 ms                  |
| Optimize                  | 202.977 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 30.830 us                 | 2.898 ms                  |
| AfterBackward             | 334.965 ms                | 1.410 s                   |
| BlockToStepN              | 400.687 us                | 3.172 ms                  |
| OneStep                   | 376.328 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:13.464862 1824090 grad_async_v2.h:256] pq is empty
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
E20240131 09:40:13.921288 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:13.952785 1824090 grad_async_v2.h:256] pq is empty
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
W20240131 09:40:14.199561 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.531 us                | 4.129 ms                  |
| ProcessBack:Shuffle       | 328.378 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 11.797 ms                 |
| ProcessBack:UpsertPq      | 62.196 us                 | 111.036 us                |
| ProcessOneStep            | 335.733 ms                | 1.410 s                   |
| BlockToStepN              | 314.998 us                | 3.062 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:40:14.921672 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:14.962446 1824090 grad_async_v2.h:256] pq is empty
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
W20240131 09:40:15.210156 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 09:40:15.412433 1824090 grad_async_v2.h:256] pq is empty
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
E20240131 09:40:15.921353 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:16.110214 1824090 grad_async_v2.h:256] pq is empty
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
W20240131 09:40:16.289719 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
W20240131 09:40:16.478770 1824090 grad_async_v2.h:256] pq is empty
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
E20240131 09:40:16.921232 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
W20240131 09:40:17.744915 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
E20240131 09:40:17.921983 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.942 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 617.880 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.259 ms                  | 8.986 ms                  |
| Optimize                  | 202.972 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.898 ms                  |
| AfterBackward             | 335.916 ms                | 1.410 s                   |
| BlockToStepN              | 401.834 us                | 3.172 ms                  |
| OneStep                   | 378.896 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
W20240131 09:40:18.855348 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:40:18.921051 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.753 us                | 5.939 ms                  |
| ProcessBack:Shuffle       | 331.853 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.296 ms                  | 12.400 ms                 |
| ProcessBack:UpsertPq      | 62.303 us                 | 111.036 us                |
| ProcessOneStep            | 339.024 ms                | 1.410 s                   |
| BlockToStepN              | 327.190 us                | 3.062 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
E20240131 09:40:19.921476 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:20.176075 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
E20240131 09:40:20.921169 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:21.276185 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
W20240131 09:40:21.770691 1824090 grad_async_v2.h:256] pq is empty
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
E20240131 09:40:21.921079 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
W20240131 09:40:22.739917 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
E20240131 09:40:22.921126 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.229 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 617.880 us                | 1.919 ms                  |
| Forward                   | 925.070 us                | 4.582 ms                  |
| Backward                  | 2.261 ms                  | 8.986 ms                  |
| Optimize                  | 202.977 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.396 us                 | 2.898 ms                  |
| AfterBackward             | 335.916 ms                | 1.410 s                   |
| BlockToStepN              | 409.854 us                | 3.172 ms                  |
| OneStep                   | 378.896 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
W20240131 09:40:23.761066 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
E20240131 09:40:23.921188 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=71
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.458 us                | 12.352 ms                 |
| ProcessBack:Shuffle       | 327.666 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.327 ms                  | 15.326 ms                 |
| ProcessBack:UpsertPq      | 62.196 us                 | 111.036 us                |
| ProcessOneStep            | 334.942 ms                | 1.410 s                   |
| BlockToStepN              | 334.333 us                | 3.471 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:40:24.921265 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
W20240131 09:40:25.408219 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240131 09:40:25.921423 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:26.413389 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
E20240131 09:40:26.921751 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
W20240131 09:40:27.588802 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
E20240131 09:40:27.921890 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.292 us                | 5.483 ms                  |
| GenInput                  | 35.708 ms                 | 49.627 ms                 |
| NN                        | 619.288 us                | 1.919 ms                  |
| Forward                   | 926.791 us                | 4.582 ms                  |
| Backward                  | 2.264 ms                  | 8.986 ms                  |
| Optimize                  | 202.972 us                | 555.003 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.898 ms                  |
| AfterBackward             | 334.965 ms                | 1.410 s                   |
| BlockToStepN              | 420.643 us                | 3.556 ms                  |
| OneStep                   | 376.328 ms                | 1.460 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:40:28.921011 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 09:40:29.093552 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.069 us                | 1.716 ms                  |
| ProcessBack:Shuffle       | 327.666 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 15.326 ms                 |
| ProcessBack:UpsertPq      | 62.134 us                 | 111.036 us                |
| ProcessOneStep            | 334.942 ms                | 1.410 s                   |
| BlockToStepN              | 339.783 us                | 3.471 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
E20240131 09:40:29.921180 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=20
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
W20240131 09:40:30.263751 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
E20240131 09:40:30.921083 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:31.601599 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240131 09:40:31.921244 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
W20240131 09:40:32.624754 1824090 grad_async_v2.h:256] pq is empty
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
W20240131 09:40:32.643417 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 09:40:32.921108 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:33.129976 1824090 grad_async_v2.h:256] pq is empty
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.531 us                | 2.135 ms                  |
| GenInput                  | 35.678 ms                 | 49.373 ms                 |
| NN                        | 625.501 us                | 1.754 ms                  |
| Forward                   | 929.658 us                | 4.295 ms                  |
| Backward                  | 2.267 ms                  | 8.901 ms                  |
| Optimize                  | 202.977 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.850 ms                  |
| AfterBackward             | 334.965 ms                | 1.418 s                   |
| BlockToStepN              | 428.964 us                | 3.172 ms                  |
| OneStep                   | 376.328 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:33.623693 1824090 grad_async_v2.h:256] pq is empty
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
W20240131 09:40:33.749270 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240131 09:40:33.921113 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:40:34.121240 1824090 grad_async_v2.h:256] pq is empty
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.876 us                | 5.836 ms                  |
| ProcessBack:Shuffle       | 328.378 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.345 ms                  | 13.091 ms                 |
| ProcessBack:UpsertPq      | 62.303 us                 | 111.036 us                |
| ProcessOneStep            | 335.733 ms                | 1.418 s                   |
| BlockToStepN              | 342.501 us                | 3.062 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
W20240131 09:40:34.853991 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240131 09:40:34.921018 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:35.663178 1824090 grad_async_v2.h:256] pq is empty
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
W20240131 09:40:35.912070 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 09:40:35.921022 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:40:36.166666 1824090 grad_async_v2.h:256] pq is empty
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
W20240131 09:40:36.680867 1824090 grad_async_v2.h:256] pq is empty
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
E20240131 09:40:36.921049 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:36.936012 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
E20240131 09:40:37.921036 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
W20240131 09:40:38.213235 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.618 us                | 5.483 ms                  |
| GenInput                  | 35.662 ms                 | 49.373 ms                 |
| NN                        | 627.397 us                | 1.919 ms                  |
| Forward                   | 935.771 us                | 4.295 ms                  |
| Backward                  | 2.267 ms                  | 8.901 ms                  |
| Optimize                  | 202.751 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.396 us                 | 2.850 ms                  |
| AfterBackward             | 334.965 ms                | 1.418 s                   |
| BlockToStepN              | 435.739 us                | 4.785 ms                  |
| OneStep                   | 376.328 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:40:38.921092 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.641 us                | 5.992 ms                  |
| ProcessBack:Shuffle       | 328.612 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.323 ms                  | 13.091 ms                 |
| ProcessBack:UpsertPq      | 62.358 us                 | 111.036 us                |
| ProcessOneStep            | 335.733 ms                | 1.418 s                   |
| BlockToStepN              | 348.961 us                | 4.701 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:39.462476 1824641 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
W20240131 09:40:39.880941 1824090 grad_async_v2.h:256] pq is empty
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
E20240131 09:40:39.921221 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=22
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
W20240131 09:40:40.546891 1824641 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
E20240131 09:40:40.924798 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
W20240131 09:40:41.659703 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
E20240131 09:40:41.924155 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:42.162583 1824090 grad_async_v2.h:256] pq is empty
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
W20240131 09:40:42.327374 1824090 grad_async_v2.h:256] pq is empty
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
E20240131 09:40:42.924430 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:42.996088 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.531 us                | 5.483 ms                  |
| GenInput                  | 35.630 ms                 | 49.373 ms                 |
| NN                        | 627.333 us                | 1.919 ms                  |
| Forward                   | 935.771 us                | 4.295 ms                  |
| Backward                  | 2.264 ms                  | 8.901 ms                  |
| Optimize                  | 202.490 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 2.898 ms                  |
| AfterBackward             | 335.758 ms                | 1.418 s                   |
| BlockToStepN              | 445.202 us                | 4.785 ms                  |
| OneStep                   | 376.466 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 09:40:43.924083 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:44.083331 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 148.190 us                | 1.263 ms                  |
| ProcessBack:Shuffle       | 328.612 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.278 ms                  | 13.091 ms                 |
| ProcessBack:UpsertPq      | 62.751 us                 | 111.036 us                |
| ProcessOneStep            | 335.733 ms                | 1.418 s                   |
| BlockToStepN              | 354.431 us                | 4.701 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
E20240131 09:40:44.924090 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 09:40:45.060222 1824090 grad_async_v2.h:256] pq is empty
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
W20240131 09:40:45.144502 1824641 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240131 09:40:45.924017 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:46.122838 1824090 grad_async_v2.h:256] pq is empty
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
W20240131 09:40:46.249584 1824641 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240131 09:40:46.619417 1824090 grad_async_v2.h:256] pq is empty
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
E20240131 09:40:46.924427 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
W20240131 09:40:47.251962 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
E20240131 09:40:47.925022 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.683 us                | 5.695 ms                  |
| GenInput                  | 35.661 ms                 | 49.373 ms                 |
| NN                        | 627.397 us                | 1.919 ms                  |
| Forward                   | 938.716 us                | 4.295 ms                  |
| Backward                  | 2.267 ms                  | 8.901 ms                  |
| Optimize                  | 202.311 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 31.415 us                 | 3.003 ms                  |
| AfterBackward             | 334.965 ms                | 1.418 s                   |
| BlockToStepN              | 446.521 us                | 4.785 ms                  |
| OneStep                   | 376.328 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:48.455267 1824641 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
E20240131 09:40:48.925595 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.244 us                | 3.512 ms                  |
| ProcessBack:Shuffle       | 328.612 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.252 ms                  | 13.091 ms                 |
| ProcessBack:UpsertPq      | 62.971 us                 | 111.036 us                |
| ProcessOneStep            | 335.733 ms                | 1.418 s                   |
| BlockToStepN              | 358.139 us                | 4.701 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
W20240131 09:40:49.779704 1824641 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
E20240131 09:40:49.925769 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:50.774312 1824090 grad_async_v2.h:256] pq is empty
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
W20240131 09:40:50.796104 1824641 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 09:40:50.925343 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240131 09:40:51.282459 1824090 grad_async_v2.h:256] pq is empty
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
W20240131 09:40:51.801057 1824090 grad_async_v2.h:256] pq is empty
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
W20240131 09:40:51.808440 1824641 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 09:40:51.925294 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 09:40:52.144932 1824090 grad_async_v2.h:256] pq is empty
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
W20240131 09:40:52.776276 1824090 grad_async_v2.h:256] pq is empty
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
W20240131 09:40:52.892527 1824090 grad_async_v2.h:256] pq is empty
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
E20240131 09:40:52.925611 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=22
W20240131 09:40:52.932142 1824641 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.683 us                | 5.695 ms                  |
| GenInput                  | 35.661 ms                 | 49.373 ms                 |
| NN                        | 627.450 us                | 1.919 ms                  |
| Forward                   | 938.716 us                | 4.295 ms                  |
| Backward                  | 2.261 ms                  | 8.986 ms                  |
| Optimize                  | 202.311 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 30.725 us                 | 3.003 ms                  |
| AfterBackward             | 334.965 ms                | 1.418 s                   |
| BlockToStepN              | 452.112 us                | 4.785 ms                  |
| OneStep                   | 376.328 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
E20240131 09:40:53.925079 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=26
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
W20240131 09:40:54.202220 1824090 grad_async_v2.h:256] pq is empty
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank3, time: 45.957, per_step: 0.455019
Step499:rank1, time: 45.957, per_step: 0.455019
Step499:rank2, time: 45.957, per_step: 0.455019
Step499:rank0, time: 45.957, per_step: 0.455019
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.618 us                | 5.695 ms                  |
| GenInput                  | 35.662 ms                 | 49.627 ms                 |
| NN                        | 627.450 us                | 1.919 ms                  |
| Forward                   | 938.716 us                | 4.295 ms                  |
| Backward                  | 2.260 ms                  | 8.986 ms                  |
| Optimize                  | 202.264 us                | 537.773 us                |
| BarrierTimeBeforeRank0    | 30.185 us                 | 3.003 ms                  |
| AfterBackward             | 334.712 ms                | 1.418 s                   |
| BlockToStepN              | 452.600 us                | 4.785 ms                  |
| OneStep                   | 376.328 ms                | 1.461 s                   |
| E2E-100                   | 47.730 s                  | 52.341 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:54.333405 1824090 grad_async_v2.h:89] call StopThreads. PID = 1824090
W20240131 09:40:54.333421 1824090 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 09:40:54.333453 1824090 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 09:40:54.333457 1824090 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is timer name is E2E-100E2E-100

[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 122.972 us                | 11.875 ms                 |
| ProcessBack:Shuffle       | 327.666 ms                | 1.383 s                   |
| ProcessBack:UpdateCache   | 1.189 ms                  | 13.091 ms                 |
| ProcessBack:UpsertPq      | 62.951 us                 | 111.036 us                |
| ProcessOneStep            | 334.678 ms                | 1.418 s                   |
| BlockToStepN              | 369.451 us                | 4.701 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 09:40:54.690712 1824641 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240131 09:40:54.925029 1824641 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 09:40:55.428043 1824090 grad_async_v2.h:110] StopThreads done.
timer name is E2E-100
ERROR [1824090 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7ffa1bf46c90>
Successfully xmh
