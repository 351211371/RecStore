WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240131 04:58:56.468561 1659092 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240131 04:58:56.469988 1659092 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [1659092 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fc05c51d120>==========
Worker 1 pid=1659235
Worker 2 pid=1659237
INFO [1659092 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1659235 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1659237 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1659239 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1659239 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1659235 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1659237 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 04:58:59.637305 1659239 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 04:58:59.637310 1659235 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [1659092 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240131 04:58:59.637941 1659237 IPCTensor.h:348] IPCTensor full_emb already exists
E20240131 04:58:59.638494 1659092 IPCTensor.h:348] IPCTensor full_emb already exists
W20240131 04:58:59.642941 1659237 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240131 04:58:59.643646 1659237 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004817d000 7.629 MB
W20240131 04:58:59.643796 1659237 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100048920000 7.629 MB
W20240131 04:58:59.643846 1659237 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000490c3000 122.1 MB
W20240131 04:58:59.643883 1659237 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100050ad7000 122.1 MB
W20240131 04:58:59.643908 1659237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 04:58:59.644307 1659237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240131 04:58:59.645285 1659092 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240131 04:58:59.645478 1659235 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240131 04:58:59.646705 1659239 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240131 04:58:59.646783 1659235 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000584f1000 7.629 MB
W20240131 04:58:59.647086 1659235 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100058c94000 7.629 MB
W20240131 04:58:59.647187 1659235 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100059437000 122.1 MB
W20240131 04:58:59.647276 1659235 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100060e4b000 122.1 MB
W20240131 04:58:59.647332 1659235 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 04:58:59.647581 1659092 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100068861000 7.629 MB
W20240131 04:58:59.647784 1659092 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100069004000 7.629 MB
W20240131 04:58:59.647872 1659092 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1000697a7000 122.1 MB
W20240131 04:58:59.647931 1659092 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000711bd000 122.1 MB
W20240131 04:58:59.648022 1659092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 04:58:59.648175 1659239 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100078bd3000 7.629 MB
W20240131 04:58:59.648312 1659235 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240131 04:58:59.648372 1659239 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100079376000 7.629 MB
W20240131 04:58:59.648463 1659239 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100079b19000 122.1 MB
W20240131 04:58:59.648542 1659239 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10008152d000 122.1 MB
W20240131 04:58:59.648600 1659239 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240131 04:58:59.649782 1659092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240131 04:58:59.649860 1659239 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
Worker 3 pid=1659239
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240131 04:59:03.437377 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100088f4b000 7.629 MB
W20240131 04:59:03.437533 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000896ee000 7.629 MB
W20240131 04:59:03.437559 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100089e91000 7.629 MB
W20240131 04:59:03.437585 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008a634000 7.629 MB
W20240131 04:59:03.437605 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008add7000 7.629 MB
W20240131 04:59:03.437633 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10008b57a000 7.629 MB
W20240131 04:59:03.437657 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10008bd1d000 7.629 MB
W20240131 04:59:03.437690 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10008c4c0000 7.629 MB
W20240131 04:59:03.437711 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10008cc63000 7.629 MB
W20240131 04:59:03.437736 1659237 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10008d406000 7.629 MB
W20240131 04:59:03.437760 1659237 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10008dba9000 80 B 
W20240131 04:59:03.437783 1659237 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10008dbab000 8 B 
W20240131 04:59:03.437798 1659237 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 04:59:03.438063 1659237 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240131 04:59:03.478044 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10008dbaf000 7.629 MB
W20240131 04:59:03.478174 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10008e352000 7.629 MB
W20240131 04:59:03.478200 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10008eaf5000 7.629 MB
W20240131 04:59:03.478222 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10008f298000 7.629 MB
W20240131 04:59:03.478240 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10008fa3b000 7.629 MB
W20240131 04:59:03.478260 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000901de000 7.629 MB
W20240131 04:59:03.478292 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100090981000 7.629 MB
W20240131 04:59:03.478327 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100091124000 7.629 MB
W20240131 04:59:03.478348 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000918c7000 7.629 MB
W20240131 04:59:03.478369 1659235 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10009206a000 7.629 MB
W20240131 04:59:03.478394 1659235 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10009280d000 80 B 
W20240131 04:59:03.478416 1659235 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10009280f000 8 B 
W20240131 04:59:03.478430 1659235 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 04:59:03.478662 1659235 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 04:59:03.682054 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100092813000 7.629 MB
W20240131 04:59:03.682193 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100092fb6000 7.629 MB
W20240131 04:59:03.682221 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100093759000 7.629 MB
W20240131 04:59:03.682253 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100093efc000 7.629 MB
W20240131 04:59:03.682273 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10009469f000 7.629 MB
W20240131 04:59:03.682293 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100094e42000 7.629 MB
W20240131 04:59:03.682317 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000955e5000 7.629 MB
W20240131 04:59:03.682349 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100095d88000 7.629 MB
W20240131 04:59:03.682368 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10009652b000 7.629 MB
W20240131 04:59:03.682392 1659239 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100096cce000 7.629 MB
W20240131 04:59:03.682415 1659239 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x100097471000 80 B 
W20240131 04:59:03.682436 1659239 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100097473000 8 B 
W20240131 04:59:03.682451 1659239 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 04:59:03.682723 1659239 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 04:59:03.738785 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100097477000 7.629 MB
W20240131 04:59:03.738965 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100097c1a000 7.629 MB
W20240131 04:59:03.739022 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000983bd000 7.629 MB
W20240131 04:59:03.739068 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100098b60000 7.629 MB
W20240131 04:59:03.739118 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100099303000 7.629 MB
W20240131 04:59:03.739163 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100099aa6000 7.629 MB
W20240131 04:59:03.739199 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10009a249000 7.629 MB
W20240131 04:59:03.739272 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10009a9ec000 7.629 MB
W20240131 04:59:03.739326 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10009b18f000 7.629 MB
W20240131 04:59:03.739362 1659092 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10009b932000 7.629 MB
W20240131 04:59:03.739406 1659092 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10009c0d5000 80 B 
W20240131 04:59:03.739478 1659092 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10009c0d7000 8 B 
W20240131 04:59:03.739511 1659092 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240131 04:59:03.739900 1659092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240131 04:59:03.741374 1659092 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240131 04:59:03.741474 1659092 grad_base.h:184] Init GradProcessingBase done
I20240131 04:59:04.467695 1659092 grad_async_v2.h:43] Use main thread to update emb.
W20240131 04:59:04.467972 1659092 kg_controller.h:78] after init GradAsyncProcessingV2
I20240131 04:59:04.467979 1659092 kg_controller.h:84] Construct KGCacheController done
E20240131 04:59:04.802284 1659239 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240131 04:59:04.802412 1659092 recstore.cc:66] init folly done
E20240131 04:59:04.802414 1659235 recstore.cc:66] init folly done
E20240131 04:59:04.802435 1659237 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240131 04:59:04.803119 1659092 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240131 04:59:05.552037 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240131 04:59:05.552281 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 04:59:06.552067 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 04:59:06.595933 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 04:59:07.552022 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:07.620406 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240131 04:59:08.552122 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:08.659091 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240131 04:59:09.552102 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:09.728523 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.879 us                | 251.858 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
Before Training
Before Training
I20240131 04:59:11.273129 1659239 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240131 04:59:11.273157 1659237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240131 04:59:11.273178 1659092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240131 04:59:11.273598 1659235 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240131 04:59:11.284821 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240131 04:59:11.284981 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 04:59:12.682641 1659717 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 04:59:12.965070 1659092 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240131 04:59:13.223661 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [1659237 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1659092 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1659235 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [1659239 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
E20240131 04:59:13.682065 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:13.720836 1659092 grad_async_v2.h:256] pq is empty
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.253 us                | 190.775 us                |
| GenInput                  | 29.709 ms                 | 36.555 ms                 |
| NN                        | 1.309 ms                  | 135.147 ms                |
| Forward                   | 1.676 ms                  | 136.334 ms                |
| Backward                  | 2.420 ms                  | 130.908 ms                |
| Optimize                  | 288.710 us                | 8.105 ms                  |
| BarrierTimeBeforeRank0    | 1.555 ms                  | 27.001 ms                 |
| AfterBackward             | 473.135 ms                | 1.358 s                   |
| BlockToStepN              | 108.830 us                | 239.651 ms                |
| OneStep                   | 515.976 ms                | 1.931 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
W20240131 04:59:14.241353 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240131 04:59:14.682210 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.482 us                | 374.345 us                |
| ProcessBack:Shuffle       | 346.870 ms                | 522.738 ms                |
| ProcessBack:UpdateCache   | 838.949 us                | 674.905 ms                |
| ProcessBack:UpsertPq      | 60.328 us                 | 282.987 ms                |
| ProcessOneStep            | 473.096 ms                | 1.357 s                   |
| BlockToStepN              | 35.160 us                 | 239.413 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:15.351826 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240131 04:59:15.682013 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:15.736948 1659092 grad_async_v2.h:256] pq is empty
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240131 04:59:16.232375 1659092 grad_async_v2.h:256] pq is empty
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240131 04:59:16.354614 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 04:59:16.682088 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:16.733247 1659092 grad_async_v2.h:256] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
E20240131 04:59:17.682230 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 04:59:17.716914 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end4
W20240131 04:59:18.471383 1659092 grad_async_v2.h:256] pq is empty
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240131 04:59:18.682031 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.052 us                | 190.775 us                |
| GenInput                  | 29.979 ms                 | 38.525 ms                 |
| NN                        | 589.437 us                | 135.147 ms                |
| Forward                   | 868.174 us                | 136.334 ms                |
| Backward                  | 2.100 ms                  | 130.908 ms                |
| Optimize                  | 203.702 us                | 8.105 ms                  |
| BarrierTimeBeforeRank0    | 380.625 us                | 27.001 ms                 |
| AfterBackward             | 248.293 ms                | 1.358 s                   |
| BlockToStepN              | 107.459 us                | 239.651 ms                |
| OneStep                   | 288.647 ms                | 1.931 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:19.139731 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
W20240131 04:59:19.223925 1659092 grad_async_v2.h:256] pq is empty
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240131 04:59:19.603843 1659092 grad_async_v2.h:256] pq is empty
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240131 04:59:19.682026 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:19.751250 1659092 grad_async_v2.h:256] pq is empty
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.299 us                | 12.061 ms                 |
| ProcessBack:Shuffle       | 115.577 ms                | 938.441 ms                |
| ProcessBack:UpdateCache   | 978.503 us                | 674.905 ms                |
| ProcessBack:UpsertPq      | 53.644 us                 | 282.987 ms                |
| ProcessOneStep            | 117.080 ms                | 1.357 s                   |
| BlockToStepN              | 45.066 us                 | 239.413 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
E20240131 04:59:20.682080 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 04:59:21.170184 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
E20240131 04:59:21.682060 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:22.159755 1659092 grad_async_v2.h:256] pq is empty
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240131 04:59:22.274732 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240131 04:59:22.682008 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
W20240131 04:59:23.439033 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240131 04:59:23.682013 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:23.694794 1659092 grad_async_v2.h:256] pq is empty
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.020 us                | 190.775 us                |
| GenInput                  | 30.378 ms                 | 45.450 ms                 |
| NN                        | 552.541 us                | 135.147 ms                |
| Forward                   | 804.632 us                | 136.334 ms                |
| Backward                  | 2.056 ms                  | 130.908 ms                |
| Optimize                  | 201.347 us                | 8.105 ms                  |
| BarrierTimeBeforeRank0    | 147.284 us                | 27.001 ms                 |
| AfterBackward             | 248.293 ms                | 1.583 s                   |
| BlockToStepN              | 110.575 us                | 239.651 ms                |
| OneStep                   | 288.647 ms                | 1.931 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240131 04:59:24.682320 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:24.693308 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.741 us                | 205.957 us                |
| ProcessBack:Shuffle       | 170.849 ms                | 938.441 ms                |
| ProcessBack:UpdateCache   | 944.804 us                | 674.905 ms                |
| ProcessBack:UpsertPq      | 56.719 us                 | 282.987 ms                |
| ProcessOneStep            | 248.272 ms                | 1.583 s                   |
| BlockToStepN              | 51.832 us                 | 239.413 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240131 04:59:25.686352 1659092 grad_async_v2.h:256] pq is empty
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240131 04:59:25.698550 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 04:59:25.705551 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:26.192077 1659092 grad_async_v2.h:256] pq is empty
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240131 04:59:26.700014 1659092 grad_async_v2.h:256] pq is empty
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240131 04:59:26.712109 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240131 04:59:26.712175 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:27.199146 1659092 grad_async_v2.h:256] pq is empty
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240131 04:59:27.712015 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:27.815670 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
W20240131 04:59:28.197261 1659092 grad_async_v2.h:256] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
E20240131 04:59:28.712320 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.487 us                | 227.164 us                |
| GenInput                  | 30.861 ms                 | 45.450 ms                 |
| NN                        | 552.915 us                | 135.147 ms                |
| Forward                   | 828.891 us                | 136.334 ms                |
| Backward                  | 2.059 ms                  | 130.908 ms                |
| Optimize                  | 198.253 us                | 8.105 ms                  |
| BarrierTimeBeforeRank0    | 31.639 us                 | 27.001 ms                 |
| AfterBackward             | 391.709 ms                | 1.583 s                   |
| BlockToStepN              | 125.802 us                | 239.651 ms                |
| OneStep                   | 428.337 ms                | 1.931 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:29.051183 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240131 04:59:29.183928 1659092 grad_async_v2.h:256] pq is empty
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
E20240131 04:59:29.712020 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.262 us                | 209.339 us                |
| ProcessBack:Shuffle       | 346.870 ms                | 938.441 ms                |
| ProcessBack:UpdateCache   | 852.174 us                | 674.905 ms                |
| ProcessBack:UpsertPq      | 57.483 us                 | 282.987 ms                |
| ProcessOneStep            | 391.654 ms                | 1.583 s                   |
| BlockToStepN              | 66.823 us                 | 239.413 ms                |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:30.164273 1659092 grad_async_v2.h:256] pq is empty
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240131 04:59:30.171065 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240131 04:59:30.712050 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 04:59:31.154577 1659092 grad_async_v2.h:256] pq is empty
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240131 04:59:31.302358 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240131 04:59:31.712006 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:32.156966 1659092 grad_async_v2.h:256] pq is empty
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240131 04:59:32.402536 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240131 04:59:32.654299 1659092 grad_async_v2.h:256] pq is empty
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
E20240131 04:59:32.712491 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=158
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
E20240131 04:59:33.712131 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.487 us                | 224.998 us                |
| GenInput                  | 30.956 ms                 | 41.150 ms                 |
| NN                        | 579.130 us                | 1.309 ms                  |
| Forward                   | 836.976 us                | 1.676 ms                  |
| Backward                  | 2.059 ms                  | 6.249 ms                  |
| Optimize                  | 196.812 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 37.397 us                 | 3.085 ms                  |
| AfterBackward             | 304.893 ms                | 1.583 s                   |
| BlockToStepN              | 138.721 us                | 239.651 ms                |
| OneStep                   | 340.190 ms                | 1.931 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:33.810303 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
E20240131 04:59:34.712102 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.571 us                | 236.174 us                |
| ProcessBack:Shuffle       | 293.913 ms                | 938.441 ms                |
| ProcessBack:UpdateCache   | 852.174 us                | 674.905 ms                |
| ProcessBack:UpsertPq      | 56.719 us                 | 282.987 ms                |
| ProcessOneStep            | 304.871 ms                | 1.583 s                   |
| BlockToStepN              | 78.858 us                 | 239.413 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
W20240131 04:59:34.923653 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
E20240131 04:59:35.712052 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240131 04:59:36.135923 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 04:59:36.712024 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:36.873665 1659092 grad_async_v2.h:256] pq is empty
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240131 04:59:37.135989 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 04:59:37.391572 1659092 grad_async_v2.h:256] pq is empty
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
E20240131 04:59:37.712112 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 04:59:37.857812 1659092 grad_async_v2.h:256] pq is empty
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240131 04:59:38.189006 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240131 04:59:38.712244 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.920 us                | 227.164 us                |
| GenInput                  | 31.404 ms                 | 44.505 ms                 |
| NN                        | 580.514 us                | 1.309 ms                  |
| Forward                   | 843.953 us                | 1.676 ms                  |
| Backward                  | 2.067 ms                  | 6.249 ms                  |
| Optimize                  | 196.812 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 70.499 us                 | 3.085 ms                  |
| AfterBackward             | 397.666 ms                | 1.358 s                   |
| BlockToStepN              | 145.583 us                | 239.379 us                |
| OneStep                   | 431.414 ms                | 1.626 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
W20240131 04:59:39.303292 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240131 04:59:39.712220 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.023 us                | 221.480 us                |
| ProcessBack:Shuffle       | 374.074 ms                | 972.741 ms                |
| ProcessBack:UpdateCache   | 852.047 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 57.483 us                 | 277.765 us                |
| ProcessOneStep            | 391.654 ms                | 1.357 s                   |
| BlockToStepN              | 89.533 us                 | 174.422 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:39.858114 1659092 grad_async_v2.h:256] pq is empty
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240131 04:59:40.467577 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240131 04:59:40.712193 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240131 04:59:41.631228 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 04:59:41.712395 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:42.224311 1659092 grad_async_v2.h:256] pq is empty
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240131 04:59:42.664925 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240131 04:59:42.712069 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:42.824527 1659092 grad_async_v2.h:256] pq is empty
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240131 04:59:43.202145 1659092 grad_async_v2.h:256] pq is empty
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240131 04:59:43.262056 1659092 grad_async_v2.h:256] pq is empty
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240131 04:59:43.311719 1659092 grad_async_v2.h:256] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
E20240131 04:59:43.712100 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:43.712623 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.920 us                | 227.164 us                |
| GenInput                  | 31.618 ms                 | 45.450 ms                 |
| NN                        | 580.514 us                | 1.309 ms                  |
| Forward                   | 843.953 us                | 1.676 ms                  |
| Backward                  | 2.078 ms                  | 6.545 ms                  |
| Optimize                  | 191.921 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.085 ms                  |
| AfterBackward             | 391.709 ms                | 1.358 s                   |
| BlockToStepN              | 154.605 us                | 425.848 us                |
| OneStep                   | 428.337 ms                | 1.626 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
E20240131 04:59:44.712020 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.700 us                | 267.290 us                |
| ProcessBack:Shuffle       | 374.074 ms                | 1.221 s                   |
| ProcessBack:UpdateCache   | 852.047 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 57.483 us                 | 277.765 us                |
| ProcessOneStep            | 391.654 ms                | 1.357 s                   |
| BlockToStepN              | 91.553 us                 | 193.930 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:44.881479 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240131 04:59:45.365813 1659092 grad_async_v2.h:256] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240131 04:59:45.712088 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:45.868278 1659092 grad_async_v2.h:256] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240131 04:59:45.995033 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240131 04:59:46.379273 1659092 grad_async_v2.h:256] pq is empty
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240131 04:59:46.712111 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:46.879483 1659092 grad_async_v2.h:256] pq is empty
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240131 04:59:47.019086 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240131 04:59:47.712030 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:47.903816 1659092 grad_async_v2.h:256] pq is empty
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240131 04:59:48.032424 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
E20240131 04:59:48.712054 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.000 us                | 239.728 us                |
| GenInput                  | 31.648 ms                 | 48.969 ms                 |
| NN                        | 580.514 us                | 1.309 ms                  |
| Forward                   | 844.351 us                | 1.676 ms                  |
| Backward                  | 2.081 ms                  | 7.064 ms                  |
| Optimize                  | 191.921 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.620 ms                  |
| AfterBackward             | 397.666 ms                | 1.358 s                   |
| BlockToStepN              | 157.764 us                | 425.848 us                |
| OneStep                   | 431.414 ms                | 1.626 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240131 04:59:49.483588 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240131 04:59:49.712239 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.483 us                | 266.657 us                |
| ProcessBack:Shuffle       | 378.013 ms                | 1.221 s                   |
| ProcessBack:UpdateCache   | 838.949 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 58.755 us                 | 277.765 us                |
| ProcessOneStep            | 397.595 ms                | 1.357 s                   |
| BlockToStepN              | 94.134 us                 | 193.930 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240131 04:59:50.494829 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240131 04:59:50.712221 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240131 04:59:51.712064 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:51.780601 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240131 04:59:52.589712 1659092 grad_async_v2.h:256] pq is empty
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240131 04:59:52.712471 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:52.937989 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
E20240131 04:59:53.712072 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.000 us                | 239.728 us                |
| GenInput                  | 31.849 ms                 | 48.969 ms                 |
| NN                        | 579.130 us                | 1.309 ms                  |
| Forward                   | 843.953 us                | 1.676 ms                  |
| Backward                  | 2.081 ms                  | 8.003 ms                  |
| Optimize                  | 195.469 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 70.499 us                 | 3.620 ms                  |
| AfterBackward             | 391.709 ms                | 1.358 s                   |
| BlockToStepN              | 168.982 us                | 425.848 us                |
| OneStep                   | 428.337 ms                | 1.626 s                   |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:54.170761 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240131 04:59:54.712069 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.182 us                | 2.852 ms                  |
| ProcessBack:Shuffle       | 374.074 ms                | 1.262 s                   |
| ProcessBack:UpdateCache   | 852.174 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 59.372 us                 | 277.765 us                |
| ProcessOneStep            | 391.654 ms                | 1.357 s                   |
| BlockToStepN              | 97.026 us                 | 306.555 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240131 04:59:55.231704 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240131 04:59:55.712234 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:55.976378 1659092 grad_async_v2.h:256] pq is empty
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240131 04:59:56.395313 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end3
E20240131 04:59:56.712076 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=72
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
E20240131 04:59:57.712163 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 04:59:57.872083 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
W20240131 04:59:58.062623 1659092 grad_async_v2.h:256] pq is empty
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240131 04:59:58.126402 1659092 grad_async_v2.h:256] pq is empty
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 58.574, per_step: 0.585738
Step99:rank1, time: 58.574, per_step: 0.585739
Step99:rank2, time: 58.574, per_step: 0.585739
Step99:rank3, time: 58.574, per_step: 0.585739
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.000 us                | 239.728 us                |
| GenInput                  | 31.748 ms                 | 48.969 ms                 |
| NN                        | 575.180 us                | 1.309 ms                  |
| Forward                   | 836.976 us                | 1.676 ms                  |
| Backward                  | 2.091 ms                  | 8.003 ms                  |
| Optimize                  | 191.921 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 89.789 us                 | 3.620 ms                  |
| AfterBackward             | 378.924 ms                | 1.358 s                   |
| BlockToStepN              | 176.354 us                | 484.360 us                |
| OneStep                   | 428.337 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240131 04:59:58.712060 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.694 us                | 239.728 us                |
| GenInput                  | 31.748 ms                 | 48.969 ms                 |
| NN                        | 579.130 us                | 1.309 ms                  |
| Forward                   | 843.953 us                | 1.676 ms                  |
| Backward                  | 2.091 ms                  | 8.003 ms                  |
| Optimize                  | 191.921 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 91.402 us                 | 3.620 ms                  |
| AfterBackward             | 378.924 ms                | 1.358 s                   |
| BlockToStepN              | 176.709 us                | 484.360 us                |
| OneStep                   | 427.875 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 04:59:59.560014 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
E20240131 04:59:59.712193 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.454 us                | 6.190 ms                  |
| ProcessBack:Shuffle       | 346.870 ms                | 1.289 s                   |
| ProcessBack:UpdateCache   | 852.174 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 58.829 us                 | 277.765 us                |
| ProcessOneStep            | 378.901 ms                | 1.357 s                   |
| BlockToStepN              | 106.061 us                | 306.555 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:00.605664 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end4
E20240131 05:00:00.712078 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:01.078120 1659092 grad_async_v2.h:256] pq is empty
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240131 05:00:01.663084 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end6
E20240131 05:00:01.712070 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240131 05:00:02.712237 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:02.883401 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240131 05:00:03.712066 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 152.920 us                | 239.728 us                |
| GenInput                  | 31.670 ms                 | 48.969 ms                 |
| NN                        | 578.984 us                | 1.309 ms                  |
| Forward                   | 844.351 us                | 1.676 ms                  |
| Backward                  | 2.095 ms                  | 8.003 ms                  |
| Optimize                  | 191.921 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 101.911 us                | 3.620 ms                  |
| AfterBackward             | 391.709 ms                | 1.358 s                   |
| BlockToStepN              | 180.641 us                | 552.179 us                |
| OneStep                   | 428.337 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:03.778908 1659092 grad_async_v2.h:256] pq is empty
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
W20240131 05:00:03.891887 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240131 05:00:04.712029 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.958 us                | 949.639 us                |
| ProcessBack:Shuffle       | 374.074 ms                | 1.289 s                   |
| ProcessBack:UpdateCache   | 852.174 us                | 7.470 ms                  |
| ProcessBack:UpsertPq      | 58.755 us                 | 277.765 us                |
| ProcessOneStep            | 391.654 ms                | 1.357 s                   |
| BlockToStepN              | 112.886 us                | 306.555 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:04.958933 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
E20240131 05:00:05.719274 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 05:00:06.719059 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:06.889145 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240131 05:00:07.719694 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:07.890146 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
W20240131 05:00:07.979830 1659092 grad_async_v2.h:256] pq is empty
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
E20240131 05:00:08.719146 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.694 us                | 239.728 us                |
| GenInput                  | 31.670 ms                 | 48.969 ms                 |
| NN                        | 578.984 us                | 1.309 ms                  |
| Forward                   | 844.816 us                | 1.676 ms                  |
| Backward                  | 2.092 ms                  | 8.003 ms                  |
| Optimize                  | 192.435 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 89.789 us                 | 3.620 ms                  |
| AfterBackward             | 378.924 ms                | 1.358 s                   |
| BlockToStepN              | 183.159 us                | 552.179 us                |
| OneStep                   | 427.875 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240131 05:00:09.719043 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.186 us                | 6.386 ms                  |
| ProcessBack:Shuffle       | 343.402 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 860.354 us                | 17.748 ms                 |
| ProcessBack:UpsertPq      | 59.119 us                 | 277.765 us                |
| ProcessOneStep            | 375.059 ms                | 1.357 s                   |
| BlockToStepN              | 117.290 us                | 306.555 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:09.962348 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
E20240131 05:00:10.719156 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240131 05:00:11.719228 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:12.176110 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
E20240131 05:00:12.719260 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=106
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240131 05:00:13.719307 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.694 us                | 239.728 us                |
| GenInput                  | 31.849 ms                 | 48.969 ms                 |
| NN                        | 578.984 us                | 1.309 ms                  |
| Forward                   | 861.060 us                | 1.676 ms                  |
| Backward                  | 2.092 ms                  | 8.003 ms                  |
| Optimize                  | 192.435 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.620 ms                  |
| AfterBackward             | 391.709 ms                | 1.358 s                   |
| BlockToStepN              | 192.170 us                | 552.179 us                |
| OneStep                   | 428.337 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240131 05:00:14.127370 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240131 05:00:14.360944 1659092 grad_async_v2.h:256] pq is empty
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
E20240131 05:00:14.719031 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.471 us                | 1.179 ms                  |
| ProcessBack:Shuffle       | 346.870 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 874.403 us                | 17.748 ms                 |
| ProcessBack:UpsertPq      | 59.726 us                 | 277.765 us                |
| ProcessOneStep            | 378.901 ms                | 1.357 s                   |
| BlockToStepN              | 122.447 us                | 329.664 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240131 05:00:15.654415 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
E20240131 05:00:15.719269 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
E20240131 05:00:16.719030 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240131 05:00:17.220324 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
E20240131 05:00:17.719096 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240131 05:00:18.242856 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end3
E20240131 05:00:18.719060 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.388 us                | 239.728 us                |
| GenInput                  | 32.418 ms                 | 48.969 ms                 |
| NN                        | 580.423 us                | 1.309 ms                  |
| Forward                   | 864.730 us                | 1.676 ms                  |
| Backward                  | 2.095 ms                  | 8.003 ms                  |
| Optimize                  | 192.691 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 48.690 us                 | 3.620 ms                  |
| AfterBackward             | 397.666 ms                | 1.358 s                   |
| BlockToStepN              | 197.113 us                | 552.179 us                |
| OneStep                   | 431.414 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:19.123155 1659092 grad_async_v2.h:256] pq is empty
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240131 05:00:19.248169 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 05:00:19.623975 1659092 grad_async_v2.h:256] pq is empty
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
E20240131 05:00:19.719177 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.474 us                | 2.493 ms                  |
| ProcessBack:Shuffle       | 390.058 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 896.319 us                | 17.748 ms                 |
| ProcessBack:UpsertPq      | 59.893 us                 | 277.765 us                |
| ProcessOneStep            | 426.519 ms                | 1.357 s                   |
| BlockToStepN              | 130.207 us                | 329.664 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240131 05:00:20.269423 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240131 05:00:20.719025 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:00:21.127014 1659092 grad_async_v2.h:256] pq is empty
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240131 05:00:21.368916 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
E20240131 05:00:21.719048 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:22.453438 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
E20240131 05:00:22.719022 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:00:23.086344 1659092 grad_async_v2.h:256] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240131 05:00:23.455399 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240131 05:00:23.589224 1659092 grad_async_v2.h:256] pq is empty
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240131 05:00:23.719133 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.538 us                | 239.728 us                |
| GenInput                  | 32.230 ms                 | 48.969 ms                 |
| NN                        | 578.984 us                | 1.309 ms                  |
| Forward                   | 863.724 us                | 1.676 ms                  |
| Backward                  | 2.109 ms                  | 9.494 ms                  |
| Optimize                  | 192.691 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 37.397 us                 | 3.620 ms                  |
| AfterBackward             | 426.570 ms                | 1.358 s                   |
| BlockToStepN              | 213.201 us                | 552.179 us                |
| OneStep                   | 466.247 ms                | 1.626 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:24.095923 1659092 grad_async_v2.h:256] pq is empty
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240131 05:00:24.470882 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 05:00:24.606559 1659092 grad_async_v2.h:256] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240131 05:00:24.719044 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.898 us                | 2.380 ms                  |
| ProcessBack:Shuffle       | 395.245 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 896.319 us                | 17.748 ms                 |
| ProcessBack:UpsertPq      | 60.172 us                 | 277.765 us                |
| ProcessOneStep            | 442.035 ms                | 1.357 s                   |
| BlockToStepN              | 144.447 us                | 329.664 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:25.103694 1659092 grad_async_v2.h:256] pq is empty
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
W20240131 05:00:25.515527 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240131 05:00:25.665977 1659092 grad_async_v2.h:256] pq is empty
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
E20240131 05:00:25.719465 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:26.205222 1659092 grad_async_v2.h:256] pq is empty
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240131 05:00:26.578092 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240131 05:00:26.715425 1659092 grad_async_v2.h:256] pq is empty
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
E20240131 05:00:26.726401 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240131 05:00:27.635599 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240131 05:00:27.727840 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240131 05:00:28.657598 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 05:00:28.727123 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.327 us                | 239.728 us                |
| GenInput                  | 33.138 ms                 | 48.969 ms                 |
| NN                        | 578.984 us                | 1.463 ms                  |
| Forward                   | 864.730 us                | 2.365 ms                  |
| Backward                  | 2.108 ms                  | 8.003 ms                  |
| Optimize                  | 192.691 us                | 511.101 us                |
| BarrierTimeBeforeRank0    | 48.690 us                 | 3.085 ms                  |
| AfterBackward             | 454.303 ms                | 1.315 s                   |
| BlockToStepN              | 219.244 us                | 552.179 us                |
| OneStep                   | 495.461 ms                | 1.355 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:29.270228 1659092 grad_async_v2.h:256] pq is empty
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240131 05:00:29.727054 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:29.756525 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.048 us                | 5.878 ms                  |
| ProcessBack:Shuffle       | 419.505 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 911.231 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 60.172 us                 | 111.642 us                |
| ProcessOneStep            | 454.272 ms                | 1.315 s                   |
| BlockToStepN              | 154.889 us                | 376.748 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:30.261106 1659092 grad_async_v2.h:256] pq is empty
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240131 05:00:30.727039 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=41
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240131 05:00:30.804168 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
E20240131 05:00:31.727061 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:00:31.924996 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
E20240131 05:00:32.728338 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
W20240131 05:00:33.261052 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240131 05:00:33.728035 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.327 us                | 273.239 us                |
| GenInput                  | 34.055 ms                 | 48.969 ms                 |
| NN                        | 579.130 us                | 1.773 ms                  |
| Forward                   | 868.174 us                | 5.676 ms                  |
| Backward                  | 2.095 ms                  | 8.003 ms                  |
| Optimize                  | 192.435 us                | 511.101 us                |
| BarrierTimeBeforeRank0    | 48.690 us                 | 3.085 ms                  |
| AfterBackward             | 442.066 ms                | 1.315 s                   |
| BlockToStepN              | 224.486 us                | 625.148 us                |
| OneStep                   | 486.544 ms                | 1.355 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240131 05:00:34.495471 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240131 05:00:34.728672 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.906 us                | 7.604 ms                  |
| ProcessBack:Shuffle       | 419.505 ms                | 1.290 s                   |
| ProcessBack:UpdateCache   | 944.804 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 60.418 us                 | 111.642 us                |
| ProcessOneStep            | 454.272 ms                | 1.315 s                   |
| BlockToStepN              | 162.461 us                | 384.265 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:35.728030 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:35.773855 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240131 05:00:35.942322 1659092 grad_async_v2.h:256] pq is empty
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240131 05:00:36.728332 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:36.815774 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240131 05:00:37.554093 1659092 grad_async_v2.h:256] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
E20240131 05:00:37.728113 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:37.922763 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240131 05:00:38.060969 1659092 grad_async_v2.h:256] pq is empty
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240131 05:00:38.560375 1659092 grad_async_v2.h:256] pq is empty
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240131 05:00:38.728381 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.505 us                | 273.239 us                |
| GenInput                  | 34.111 ms                 | 48.969 ms                 |
| NN                        | 580.423 us                | 1.773 ms                  |
| Forward                   | 868.174 us                | 5.676 ms                  |
| Backward                  | 2.097 ms                  | 8.003 ms                  |
| Optimize                  | 192.435 us                | 511.101 us                |
| BarrierTimeBeforeRank0    | 60.666 us                 | 3.085 ms                  |
| AfterBackward             | 460.495 ms                | 1.316 s                   |
| BlockToStepN              | 230.778 us                | 956.997 us                |
| OneStep                   | 497.114 ms                | 1.359 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:38.928246 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240131 05:00:39.064018 1659092 grad_async_v2.h:256] pq is empty
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240131 05:00:39.564929 1659092 grad_async_v2.h:256] pq is empty
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240131 05:00:39.656005 1659092 grad_async_v2.h:256] pq is empty
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240131 05:00:39.728017 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.687 us                | 11.478 ms                 |
| ProcessBack:Shuffle       | 451.516 ms                | 1.297 s                   |
| ProcessBack:UpdateCache   | 920.078 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 60.997 us                 | 111.642 us                |
| ProcessOneStep            | 460.462 ms                | 1.316 s                   |
| BlockToStepN              | 165.658 us                | 564.999 us                |
+---------------------------+---------------------------+---------------------------+
W20240131 05:00:39.963416 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
E20240131 05:00:40.728214 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:41.037372 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240131 05:00:41.174388 1659092 grad_async_v2.h:256] pq is empty
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240131 05:00:41.670919 1659092 grad_async_v2.h:256] pq is empty
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
E20240131 05:00:41.728369 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240131 05:00:42.274466 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
W20240131 05:00:43.032305 1659092 grad_async_v2.h:256] pq is empty
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
E20240131 05:00:43.045562 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
W20240131 05:00:43.315626 1659092 grad_async_v2.h:256] pq is empty
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240131 05:00:43.573487 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.899 us                | 273.239 us                |
| GenInput                  | 33.138 ms                 | 48.969 ms                 |
| NN                        | 580.423 us                | 1.773 ms                  |
| Forward                   | 868.174 us                | 5.676 ms                  |
| Backward                  | 2.100 ms                  | 8.003 ms                  |
| Optimize                  | 193.528 us                | 511.101 us                |
| BarrierTimeBeforeRank0    | 60.666 us                 | 3.196 ms                  |
| AfterBackward             | 460.495 ms                | 1.316 s                   |
| BlockToStepN              | 238.601 us                | 956.997 us                |
| OneStep                   | 496.547 ms                | 1.359 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:44.045495 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
W20240131 05:00:44.638109 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.936 us                | 1.555 ms                  |
| ProcessBack:Shuffle       | 454.252 ms                | 1.297 s                   |
| ProcessBack:UpdateCache   | 911.231 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 60.997 us                 | 111.642 us                |
| ProcessOneStep            | 460.631 ms                | 1.316 s                   |
| BlockToStepN              | 174.656 us                | 606.647 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:45.045195 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240131 05:00:45.728863 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 05:00:46.040477 1659092 grad_async_v2.h:256] pq is empty
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
E20240131 05:00:46.045132 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240131 05:00:46.604844 1659092 grad_async_v2.h:256] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240131 05:00:46.955083 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end0
E20240131 05:00:47.045421 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
E20240131 05:00:48.045440 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:48.242278 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.904 us                | 273.239 us                |
| GenInput                  | 33.138 ms                 | 48.969 ms                 |
| NN                        | 580.748 us                | 1.773 ms                  |
| Forward                   | 877.077 us                | 5.676 ms                  |
| Backward                  | 2.100 ms                  | 8.003 ms                  |
| Optimize                  | 194.144 us                | 511.101 us                |
| BarrierTimeBeforeRank0    | 48.690 us                 | 3.196 ms                  |
| AfterBackward             | 455.440 ms                | 1.325 s                   |
| BlockToStepN              | 240.732 us                | 956.997 us                |
| OneStep                   | 495.703 ms                | 1.364 s                   |
| E2E-100                   | 47.386 s                  | 47.386 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240131 05:00:49.045071 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:49.076052 1659092 grad_async_v2.h:256] pq is empty
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240131 05:00:49.556054 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.610 us                | 183.970 us                |
| ProcessBack:Shuffle       | 438.686 ms                | 1.309 s                   |
| ProcessBack:UpdateCache   | 944.193 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 61.253 us                 | 111.642 us                |
| ProcessOneStep            | 455.410 ms                | 1.325 s                   |
| BlockToStepN              | 176.494 us                | 606.647 us                |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:50.045231 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240131 05:00:50.799070 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240131 05:00:51.045176 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240131 05:00:51.213065 1659092 grad_async_v2.h:256] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240131 05:00:51.268018 1659092 grad_async_v2.h:256] pq is empty
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
W20240131 05:00:51.920094 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240131 05:00:52.045061 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:00:52.946692 1659092 grad_async_v2.h:256] pq is empty
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240131 05:00:52.959448 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240131 05:00:53.045130 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:53.446494 1659092 grad_async_v2.h:256] pq is empty
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank1, time: 54.858, per_step: 0.543151
Step199:rank2, time: 54.858, per_step: 0.543150
Step199:rank0, time: 54.858, per_step: 0.543151
Step199:rank3, time: 54.858, per_step: 0.543151
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.967 us                | 273.239 us                |
| GenInput                  | 34.055 ms                 | 48.969 ms                 |
| NN                        | 582.546 us                | 4.670 ms                  |
| Forward                   | 883.403 us                | 5.676 ms                  |
| Backward                  | 2.100 ms                  | 8.003 ms                  |
| Optimize                  | 195.922 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 37.397 us                 | 3.196 ms                  |
| AfterBackward             | 460.227 ms                | 1.332 s                   |
| BlockToStepN              | 247.668 us                | 956.997 us                |
| OneStep                   | 497.114 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.967 us                | 273.239 us                |
| GenInput                  | 34.055 ms                 | 48.969 ms                 |
| NN                        | 582.546 us                | 4.670 ms                  |
| Forward                   | 883.403 us                | 5.676 ms                  |
| Backward                  | 2.100 ms                  | 8.003 ms                  |
| Optimize                  | 195.469 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 37.397 us                 | 3.196 ms                  |
| AfterBackward             | 455.440 ms                | 1.332 s                   |
| BlockToStepN              | 256.249 us                | 956.997 us                |
| OneStep                   | 495.703 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:54.045224 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:00:54.298808 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
W20240131 05:00:54.604336 1659092 grad_async_v2.h:256] pq is empty
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.668 us                | 11.451 ms                 |
| ProcessBack:Shuffle       | 419.505 ms                | 1.316 s                   |
| ProcessBack:UpdateCache   | 951.308 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 61.842 us                 | 111.642 us                |
| ProcessOneStep            | 454.272 ms                | 1.332 s                   |
| BlockToStepN              | 186.112 us                | 1.021 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:55.045043 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:00:55.680684 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
W20240131 05:00:55.997272 1659092 grad_async_v2.h:256] pq is empty
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
E20240131 05:00:56.045106 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
E20240131 05:00:57.045078 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:00:57.093360 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
E20240131 05:00:58.045035 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:00:58.291106 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.904 us                | 273.239 us                |
| GenInput                  | 34.055 ms                 | 48.969 ms                 |
| NN                        | 582.546 us                | 4.670 ms                  |
| Forward                   | 883.403 us                | 5.676 ms                  |
| Backward                  | 2.100 ms                  | 8.003 ms                  |
| Optimize                  | 194.823 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 37.397 us                 | 3.620 ms                  |
| AfterBackward             | 454.303 ms                | 1.332 s                   |
| BlockToStepN              | 264.704 us                | 1.350 ms                  |
| OneStep                   | 495.461 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:00:59.045049 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
W20240131 05:00:59.474547 1659092 grad_async_v2.h:256] pq is empty
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
W20240131 05:00:59.703445 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.740 us                | 1.615 ms                  |
| ProcessBack:Shuffle       | 419.505 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 952.099 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 62.037 us                 | 111.642 us                |
| ProcessOneStep            | 454.272 ms                | 1.340 s                   |
| BlockToStepN              | 189.307 us                | 1.021 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:00.045406 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:00.557613 1659092 grad_async_v2.h:256] pq is empty
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
W20240131 05:01:00.929643 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240131 05:01:01.045429 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240131 05:01:01.076507 1659092 grad_async_v2.h:256] pq is empty
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240131 05:01:01.356984 1659092 grad_async_v2.h:256] pq is empty
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240131 05:01:01.648072 1659092 grad_async_v2.h:256] pq is empty
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240131 05:01:02.045387 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:02.337361 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end0
W20240131 05:01:02.860466 1659092 grad_async_v2.h:256] pq is empty
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
E20240131 05:01:03.045440 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:03.736712 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.687 us                | 273.239 us                |
| GenInput                  | 34.171 ms                 | 48.969 ms                 |
| NN                        | 581.869 us                | 4.670 ms                  |
| Forward                   | 882.570 us                | 5.676 ms                  |
| Backward                  | 2.108 ms                  | 8.003 ms                  |
| Optimize                  | 195.784 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 39.496 us                 | 3.620 ms                  |
| AfterBackward             | 426.570 ms                | 1.340 s                   |
| BlockToStepN              | 272.557 us                | 1.350 ms                  |
| OneStep                   | 466.247 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:03.952795 1659092 grad_async_v2.h:256] pq is empty
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
E20240131 05:01:04.045087 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.832 us                | 2.148 ms                  |
| ProcessBack:Shuffle       | 400.909 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 952.099 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 62.182 us                 | 111.642 us                |
| ProcessOneStep            | 442.035 ms                | 1.340 s                   |
| BlockToStepN              | 194.252 us                | 1.021 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:05.020826 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 05:01:05.045076 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:05.198609 1659092 grad_async_v2.h:256] pq is empty
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
E20240131 05:01:06.045032 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:06.148396 1659092 grad_async_v2.h:256] pq is empty
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
W20240131 05:01:06.160143 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240131 05:01:07.045082 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:07.199599 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
E20240131 05:01:08.045097 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:08.347972 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
W20240131 05:01:08.368269 1659092 grad_async_v2.h:256] pq is empty
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.533 us                | 273.239 us                |
| GenInput                  | 34.111 ms                 | 48.969 ms                 |
| NN                        | 581.869 us                | 4.670 ms                  |
| Forward                   | 883.403 us                | 6.710 ms                  |
| Backward                  | 2.109 ms                  | 8.305 ms                  |
| Optimize                  | 195.922 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 41.966 us                 | 3.620 ms                  |
| AfterBackward             | 442.066 ms                | 1.340 s                   |
| BlockToStepN              | 275.996 us                | 1.360 ms                  |
| OneStep                   | 479.510 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:09.045395 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240131 05:01:09.607079 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.413 us                | 3.322 ms                  |
| ProcessBack:Shuffle       | 419.505 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 956.727 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 62.457 us                 | 111.642 us                |
| ProcessOneStep            | 443.947 ms                | 1.340 s                   |
| BlockToStepN              | 200.563 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:10.045024 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:10.629020 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240131 05:01:11.045037 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:11.757339 1659092 grad_async_v2.h:256] pq is empty
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
W20240131 05:01:11.767904 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240131 05:01:12.045181 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:01:12.272538 1659092 grad_async_v2.h:256] pq is empty
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240131 05:01:12.775138 1659092 grad_async_v2.h:256] pq is empty
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
W20240131 05:01:12.787673 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 05:01:13.045099 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240131 05:01:13.271011 1659092 grad_async_v2.h:256] pq is empty
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.904 us                | 273.239 us                |
| GenInput                  | 34.111 ms                 | 48.969 ms                 |
| NN                        | 582.734 us                | 4.670 ms                  |
| Forward                   | 889.764 us                | 6.710 ms                  |
| Backward                  | 2.113 ms                  | 8.305 ms                  |
| Optimize                  | 196.597 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 48.690 us                 | 3.620 ms                  |
| AfterBackward             | 454.538 ms                | 1.340 s                   |
| BlockToStepN              | 277.025 us                | 2.635 ms                  |
| OneStep                   | 495.703 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:13.773386 1659092 grad_async_v2.h:256] pq is empty
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240131 05:01:13.917551 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 05:01:14.045246 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.285 us                | 5.170 ms                  |
| ProcessBack:Shuffle       | 438.686 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 951.308 us                | 17.167 ms                 |
| ProcessBack:UpsertPq      | 62.457 us                 | 111.642 us                |
| ProcessOneStep            | 454.272 ms                | 1.340 s                   |
| BlockToStepN              | 210.101 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:15.024806 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240131 05:01:15.045192 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
E20240131 05:01:16.045235 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:16.128782 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240131 05:01:16.260954 1659092 grad_async_v2.h:256] pq is empty
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
W20240131 05:01:16.763797 1659092 grad_async_v2.h:256] pq is empty
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
E20240131 05:01:17.045203 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240131 05:01:17.136771 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
E20240131 05:01:18.045207 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 05:01:18.246186 1659092 grad_async_v2.h:256] pq is empty
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
W20240131 05:01:18.261530 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.899 us                | 273.239 us                |
| GenInput                  | 34.055 ms                 | 48.969 ms                 |
| NN                        | 581.711 us                | 4.670 ms                  |
| Forward                   | 883.403 us                | 6.710 ms                  |
| Backward                  | 2.113 ms                  | 8.305 ms                  |
| Optimize                  | 196.597 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.620 ms                  |
| AfterBackward             | 454.538 ms                | 1.340 s                   |
| BlockToStepN              | 290.954 us                | 2.635 ms                  |
| OneStep                   | 495.703 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:19.045120 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:19.265239 1659092 grad_async_v2.h:256] pq is empty
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240131 05:01:19.277799 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.625 us                | 5.938 ms                  |
| ProcessBack:Shuffle       | 442.545 ms                | 1.316 s                   |
| ProcessBack:UpdateCache   | 956.727 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.888 us                 | 105.258 us                |
| ProcessOneStep            | 454.501 ms                | 1.332 s                   |
| BlockToStepN              | 213.076 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:20.045329 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:20.270885 1659092 grad_async_v2.h:256] pq is empty
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240131 05:01:20.283313 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
E20240131 05:01:21.066478 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:21.427331 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
E20240131 05:01:22.066251 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
W20240131 05:01:22.785346 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
E20240131 05:01:23.066045 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 05:01:23.637102 1659092 grad_async_v2.h:256] pq is empty
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.899 us                | 273.239 us                |
| GenInput                  | 34.111 ms                 | 48.114 ms                 |
| NN                        | 580.748 us                | 1.812 ms                  |
| Forward                   | 882.570 us                | 5.676 ms                  |
| Backward                  | 2.117 ms                  | 8.003 ms                  |
| Optimize                  | 196.065 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.196 ms                  |
| AfterBackward             | 454.303 ms                | 1.332 s                   |
| BlockToStepN              | 298.894 us                | 1.360 ms                  |
| OneStep                   | 495.461 ms                | 1.374 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
W20240131 05:01:23.914404 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240131 05:01:24.066051 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=194
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.372 us                | 4.107 ms                  |
| ProcessBack:Shuffle       | 435.301 ms                | 1.316 s                   |
| ProcessBack:UpdateCache   | 952.099 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.888 us                 | 105.258 us                |
| ProcessOneStep            | 443.947 ms                | 1.332 s                   |
| BlockToStepN              | 220.763 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:25.066049 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240131 05:01:25.171083 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240131 05:01:26.066113 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240131 05:01:26.315567 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
W20240131 05:01:26.815675 1659092 grad_async_v2.h:256] pq is empty
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
E20240131 05:01:27.066008 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:27.357460 1659092 grad_async_v2.h:256] pq is empty
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
W20240131 05:01:27.370086 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
W20240131 05:01:27.876806 1659092 grad_async_v2.h:256] pq is empty
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
E20240131 05:01:28.066048 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=38
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240131 05:01:28.399981 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.856 us                | 3.864 ms                  |
| GenInput                  | 34.465 ms                 | 48.359 ms                 |
| NN                        | 581.711 us                | 1.812 ms                  |
| Forward                   | 883.403 us                | 5.676 ms                  |
| Backward                  | 2.117 ms                  | 8.003 ms                  |
| Optimize                  | 196.597 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 60.909 us                 | 3.196 ms                  |
| AfterBackward             | 444.003 ms                | 1.332 s                   |
| BlockToStepN              | 313.148 us                | 1.360 ms                  |
| OneStep                   | 494.630 ms                | 1.374 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
E20240131 05:01:29.066025 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240131 05:01:29.712999 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.027 us                | 10.037 ms                 |
| ProcessBack:Shuffle       | 435.301 ms                | 1.316 s                   |
| ProcessBack:UpdateCache   | 965.563 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.888 us                 | 105.258 us                |
| ProcessOneStep            | 443.947 ms                | 1.332 s                   |
| BlockToStepN              | 222.521 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:30.066246 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240131 05:01:31.066288 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:31.071034 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
E20240131 05:01:32.066051 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:32.194242 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
W20240131 05:01:32.313482 1659092 grad_async_v2.h:256] pq is empty
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240131 05:01:33.066045 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
W20240131 05:01:33.508582 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.856 us                | 3.864 ms                  |
| GenInput                  | 34.377 ms                 | 48.359 ms                 |
| NN                        | 582.546 us                | 4.405 ms                  |
| Forward                   | 889.764 us                | 5.676 ms                  |
| Backward                  | 2.124 ms                  | 8.003 ms                  |
| Optimize                  | 196.597 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.196 ms                  |
| AfterBackward             | 442.549 ms                | 1.340 s                   |
| BlockToStepN              | 318.984 us                | 1.360 ms                  |
| OneStep                   | 486.544 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:34.066164 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:34.376893 1659092 grad_async_v2.h:256] pq is empty
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240131 05:01:34.785205 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.360 us                 | 11.488 ms                 |
| ProcessBack:Shuffle       | 400.909 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 972.159 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.888 us                 | 107.992 us                |
| ProcessOneStep            | 442.035 ms                | 1.340 s                   |
| BlockToStepN              | 226.194 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
E20240131 05:01:35.066123 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
E20240131 05:01:36.066138 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:36.455785 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240131 05:01:37.066366 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240131 05:01:37.894631 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240131 05:01:38.066196 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.269 us                | 3.864 ms                  |
| GenInput                  | 34.377 ms                 | 48.359 ms                 |
| NN                        | 582.734 us                | 4.405 ms                  |
| Forward                   | 891.648 us                | 5.676 ms                  |
| Backward                  | 2.136 ms                  | 8.003 ms                  |
| Optimize                  | 197.166 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 70.499 us                 | 3.196 ms                  |
| AfterBackward             | 442.549 ms                | 1.340 s                   |
| BlockToStepN              | 323.818 us                | 1.360 ms                  |
| OneStep                   | 486.544 ms                | 1.379 s                   |
| E2E-100                   | 47.386 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:39.066030 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:39.294612 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 95.825 us                 | 364.021 us                |
| ProcessBack:Shuffle       | 419.505 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 976.410 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.944 us                 | 107.992 us                |
| ProcessOneStep            | 442.519 ms                | 1.340 s                   |
| BlockToStepN              | 229.039 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
E20240131 05:01:40.066180 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=26
W20240131 05:01:40.409309 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240131 05:01:40.668879 1659092 grad_async_v2.h:256] pq is empty
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
W20240131 05:01:40.722342 1659092 grad_async_v2.h:256] pq is empty
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
E20240131 05:01:41.066171 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:41.422820 1659092 grad_async_v2.h:256] pq is empty
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
W20240131 05:01:41.835484 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
E20240131 05:01:42.066363 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank2, time: 49.067, per_step: 0.485809
Step299:rank1, time: 49.067, per_step: 0.485809
Step299:rank3, time: 49.067, per_step: 0.485809
Step299:rank0, time: 49.067, per_step: 0.485809
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.762 us                | 3.864 ms                  |
| GenInput                  | 34.274 ms                 | 48.359 ms                 |
| NN                        | 582.734 us                | 4.405 ms                  |
| Forward                   | 891.648 us                | 5.676 ms                  |
| Backward                  | 2.139 ms                  | 8.003 ms                  |
| Optimize                  | 196.607 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 67.029 us                 | 3.196 ms                  |
| AfterBackward             | 442.066 ms                | 1.340 s                   |
| BlockToStepN              | 329.849 us                | 1.360 ms                  |
| OneStep                   | 486.544 ms                | 1.379 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
E20240131 05:01:43.066252 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
W20240131 05:01:43.296811 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.647 us                | 3.864 ms                  |
| GenInput                  | 34.274 ms                 | 48.359 ms                 |
| NN                        | 581.869 us                | 4.405 ms                  |
| Forward                   | 889.755 us                | 5.676 ms                  |
| Backward                  | 2.141 ms                  | 8.003 ms                  |
| Optimize                  | 196.597 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 80.902 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 331.424 us                | 1.360 ms                  |
| OneStep                   | 451.957 ms                | 1.379 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
E20240131 05:01:44.066455 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 90.407 us                 | 216.581 us                |
| ProcessBack:Shuffle       | 397.008 ms                | 1.317 s                   |
| ProcessBack:UpdateCache   | 977.676 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.153 us                 | 107.992 us                |
| ProcessOneStep            | 426.519 ms                | 1.340 s                   |
| BlockToStepN              | 237.380 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:44.882475 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240131 05:01:45.066262 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
W20240131 05:01:46.055963 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
E20240131 05:01:46.066202 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:46.600973 1659092 grad_async_v2.h:256] pq is empty
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
W20240131 05:01:46.651412 1659092 grad_async_v2.h:256] pq is empty
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
W20240131 05:01:46.984808 1659092 grad_async_v2.h:256] pq is empty
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
E20240131 05:01:47.066174 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
W20240131 05:01:47.356690 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end3
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
E20240131 05:01:48.066236 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.773 us                | 3.864 ms                  |
| GenInput                  | 34.290 ms                 | 48.969 ms                 |
| NN                        | 582.734 us                | 4.405 ms                  |
| Forward                   | 889.755 us                | 5.676 ms                  |
| Backward                  | 2.156 ms                  | 8.003 ms                  |
| Optimize                  | 196.607 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 70.499 us                 | 3.196 ms                  |
| AfterBackward             | 392.335 ms                | 1.340 s                   |
| BlockToStepN              | 339.384 us                | 1.360 ms                  |
| OneStep                   | 429.963 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
W20240131 05:01:48.984436 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end8
E20240131 05:01:49.066008 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.211 us                | 11.682 ms                 |
| ProcessBack:Shuffle       | 378.013 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 986.676 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.944 us                 | 107.992 us                |
| ProcessOneStep            | 392.303 ms                | 1.340 s                   |
| BlockToStepN              | 247.464 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:50.025152 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240131 05:01:50.066093 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
E20240131 05:01:51.066334 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:51.274477 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
E20240131 05:01:52.066046 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
E20240131 05:01:53.066171 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=21
W20240131 05:01:53.105652 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
W20240131 05:01:53.247581 1659092 grad_async_v2.h:256] pq is empty
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.833 us                | 3.864 ms                  |
| GenInput                  | 34.465 ms                 | 48.969 ms                 |
| NN                        | 589.437 us                | 4.405 ms                  |
| Forward                   | 892.651 us                | 5.676 ms                  |
| Backward                  | 2.157 ms                  | 8.003 ms                  |
| Optimize                  | 196.607 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 70.499 us                 | 3.196 ms                  |
| AfterBackward             | 391.709 ms                | 1.340 s                   |
| BlockToStepN              | 345.606 us                | 1.360 ms                  |
| OneStep                   | 428.337 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:01:54.066103 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.564 us                | 1.123 ms                  |
| ProcessBack:Shuffle       | 374.074 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 985.268 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 62.888 us                 | 111.642 us                |
| ProcessOneStep            | 391.654 ms                | 1.340 s                   |
| BlockToStepN              | 255.801 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:01:54.994904 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
E20240131 05:01:55.066283 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
E20240131 05:01:56.066043 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:01:56.419157 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240131 05:01:56.538403 1659092 grad_async_v2.h:256] pq is empty
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
E20240131 05:01:57.066030 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:01:57.625461 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
E20240131 05:01:58.066397 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:58.751991 1659092 grad_async_v2.h:256] pq is empty
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
W20240131 05:01:58.758769 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.833 us                | 3.864 ms                  |
| GenInput                  | 34.465 ms                 | 48.969 ms                 |
| NN                        | 591.770 us                | 4.405 ms                  |
| Forward                   | 892.651 us                | 5.676 ms                  |
| Backward                  | 2.163 ms                  | 8.003 ms                  |
| Optimize                  | 196.812 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 89.789 us                 | 3.196 ms                  |
| AfterBackward             | 392.335 ms                | 1.342 s                   |
| BlockToStepN              | 349.798 us                | 1.360 ms                  |
| OneStep                   | 429.963 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
E20240131 05:01:59.066090 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:01:59.721472 1659092 grad_async_v2.h:256] pq is empty
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
W20240131 05:01:59.849579 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.705 us                | 4.670 ms                  |
| ProcessBack:Shuffle       | 374.074 ms                | 1.332 s                   |
| ProcessBack:UpdateCache   | 985.268 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.269 us                 | 112.812 us                |
| ProcessOneStep            | 392.303 ms                | 1.342 s                   |
| BlockToStepN              | 256.813 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:00.066164 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
E20240131 05:02:01.066380 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:01.070585 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
E20240131 05:02:02.068760 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:02.197255 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
E20240131 05:02:03.068257 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:03.197717 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
W20240131 05:02:03.736995 1659092 grad_async_v2.h:256] pq is empty
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.120 us                | 3.864 ms                  |
| GenInput                  | 34.586 ms                 | 48.969 ms                 |
| NN                        | 594.755 us                | 4.405 ms                  |
| Forward                   | 894.275 us                | 5.676 ms                  |
| Backward                  | 2.164 ms                  | 8.003 ms                  |
| Optimize                  | 197.649 us                | 646.020 us                |
| BarrierTimeBeforeRank0    | 91.402 us                 | 3.196 ms                  |
| AfterBackward             | 397.666 ms                | 1.342 s                   |
| BlockToStepN              | 357.450 us                | 1.360 ms                  |
| OneStep                   | 431.414 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:04.068097 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:04.315004 1659092 grad_async_v2.h:256] pq is empty
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
W20240131 05:02:04.339211 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240131 05:02:04.832592 1659092 grad_async_v2.h:256] pq is empty
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.822 us                | 1.536 ms                  |
| ProcessBack:Shuffle       | 385.508 ms                | 1.332 s                   |
| ProcessBack:UpdateCache   | 986.676 us                | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.278 us                 | 112.812 us                |
| ProcessOneStep            | 398.405 ms                | 1.342 s                   |
| BlockToStepN              | 259.611 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:05.068553 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
W20240131 05:02:05.461628 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
E20240131 05:02:06.069607 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
W20240131 05:02:06.657269 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240131 05:02:07.069286 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:07.284458 1659092 grad_async_v2.h:256] pq is empty
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
W20240131 05:02:07.812842 1659092 grad_async_v2.h:256] pq is empty
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
W20240131 05:02:07.825346 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240131 05:02:08.069092 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:08.321555 1659092 grad_async_v2.h:256] pq is empty
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.269 us                | 1.209 ms                  |
| GenInput                  | 34.593 ms                 | 48.479 ms                 |
| NN                        | 598.445 us                | 3.410 ms                  |
| Forward                   | 896.122 us                | 5.439 ms                  |
| Backward                  | 2.166 ms                  | 7.620 ms                  |
| Optimize                  | 198.379 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 90.834 us                 | 3.122 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 361.055 us                | 1.350 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:08.826831 1659092 grad_async_v2.h:256] pq is empty
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
W20240131 05:02:08.836130 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
E20240131 05:02:09.069416 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.383 us                | 1.611 ms                  |
| ProcessBack:Shuffle       | 390.058 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 985.268 us                | 10.756 ms                 |
| ProcessBack:UpsertPq      | 63.269 us                 | 111.642 us                |
| ProcessOneStep            | 404.205 ms                | 1.340 s                   |
| BlockToStepN              | 261.738 us                | 1.021 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:09.896576 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240131 05:02:09.994946 1659092 grad_async_v2.h:256] pq is empty
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
E20240131 05:02:10.069017 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=35
W20240131 05:02:10.219544 1659092 grad_async_v2.h:256] pq is empty
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
W20240131 05:02:10.393146 1659092 grad_async_v2.h:256] pq is empty
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
W20240131 05:02:11.029152 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
E20240131 05:02:11.069094 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
E20240131 05:02:12.069483 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:12.443209 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
W20240131 05:02:12.486642 1659092 grad_async_v2.h:256] pq is empty
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
E20240131 05:02:13.069056 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:13.587746 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.369 us                | 1.209 ms                  |
| GenInput                  | 34.469 ms                 | 48.479 ms                 |
| NN                        | 598.445 us                | 3.410 ms                  |
| Forward                   | 896.122 us                | 5.439 ms                  |
| Backward                  | 2.170 ms                  | 7.620 ms                  |
| Optimize                  | 198.253 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 82.450 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 369.601 us                | 1.350 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:14.069096 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
W20240131 05:02:14.720937 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 92.957 us                 | 11.422 ms                 |
| ProcessBack:Shuffle       | 395.245 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 985.268 us                | 10.756 ms                 |
| ProcessBack:UpsertPq      | 63.590 us                 | 112.812 us                |
| ProcessOneStep            | 404.205 ms                | 1.340 s                   |
| BlockToStepN              | 268.294 us                | 1.043 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
E20240131 05:02:15.069103 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
E20240131 05:02:16.069036 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 05:02:16.079123 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
E20240131 05:02:17.069089 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240131 05:02:17.101295 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
E20240131 05:02:18.069264 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
W20240131 05:02:18.216290 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
W20240131 05:02:18.625634 1659092 grad_async_v2.h:256] pq is empty
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 158.652 us                | 1.209 ms                  |
| GenInput                  | 34.593 ms                 | 48.691 ms                 |
| NN                        | 599.270 us                | 3.410 ms                  |
| Forward                   | 897.178 us                | 5.439 ms                  |
| Backward                  | 2.172 ms                  | 7.620 ms                  |
| Optimize                  | 198.379 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 82.450 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 378.626 us                | 1.350 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:19.069077 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:19.121691 1659092 grad_async_v2.h:256] pq is empty
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
W20240131 05:02:19.248548 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240131 05:02:19.624224 1659092 grad_async_v2.h:256] pq is empty
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.135 us                | 5.752 ms                  |
| ProcessBack:Shuffle       | 395.245 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 986.676 us                | 10.756 ms                 |
| ProcessBack:UpsertPq      | 63.638 us                 | 114.584 us                |
| ProcessOneStep            | 426.519 ms                | 1.340 s                   |
| BlockToStepN              | 275.896 us                | 1.043 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:20.069113 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:20.139669 1659092 grad_async_v2.h:256] pq is empty
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
W20240131 05:02:20.256114 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240131 05:02:21.069214 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:21.113685 1659092 grad_async_v2.h:256] pq is empty
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
W20240131 05:02:21.366351 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240131 05:02:21.624469 1659092 grad_async_v2.h:256] pq is empty
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
W20240131 05:02:21.808005 1659092 grad_async_v2.h:256] pq is empty
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
E20240131 05:02:22.069053 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
W20240131 05:02:22.471943 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
E20240131 05:02:23.069103 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.066 us                | 1.209 ms                  |
| GenInput                  | 34.593 ms                 | 48.691 ms                 |
| NN                        | 600.121 us                | 3.410 ms                  |
| Forward                   | 898.460 us                | 5.439 ms                  |
| Backward                  | 2.172 ms                  | 7.620 ms                  |
| Optimize                  | 198.562 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 73.425 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 380.980 us                | 1.360 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:24.069061 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
W20240131 05:02:24.124879 1659092 grad_async_v2.h:256] pq is empty
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
W20240131 05:02:24.174427 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.719 us                | 6.059 ms                  |
| ProcessBack:Shuffle       | 385.508 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 994.817 us                | 13.131 ms                 |
| ProcessBack:UpsertPq      | 63.745 us                 | 118.143 us                |
| ProcessOneStep            | 398.405 ms                | 1.340 s                   |
| BlockToStepN              | 284.025 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:25.069303 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
E20240131 05:02:26.069320 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
W20240131 05:02:26.165547 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end4
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
E20240131 05:02:27.069492 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
W20240131 05:02:27.719275 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240131 05:02:28.069061 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.078 us                | 1.209 ms                  |
| GenInput                  | 34.596 ms                 | 48.691 ms                 |
| NN                        | 600.377 us                | 3.410 ms                  |
| Forward                   | 900.005 us                | 5.439 ms                  |
| Backward                  | 2.181 ms                  | 7.620 ms                  |
| Optimize                  | 198.928 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 73.425 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 383.192 us                | 1.360 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:28.848095 1659092 grad_async_v2.h:256] pq is empty
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
W20240131 05:02:28.848649 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
E20240131 05:02:29.069048 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.453 us                | 5.074 ms                  |
| ProcessBack:Shuffle       | 395.245 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.007 ms                  | 13.131 ms                 |
| ProcessBack:UpsertPq      | 63.791 us                 | 118.143 us                |
| ProcessOneStep            | 426.519 ms                | 1.340 s                   |
| BlockToStepN              | 288.865 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:29.864112 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
Step399:rank1, time: 47.410, per_step: 0.469408
Step399:rank2, time: 47.410, per_step: 0.469408
Step399:rank0, time: 47.410, per_step: 0.469408
Step399:rank3, time: 47.410, per_step: 0.469408
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.078 us                | 1.209 ms                  |
| GenInput                  | 34.593 ms                 | 48.691 ms                 |
| NN                        | 601.105 us                | 3.410 ms                  |
| Forward                   | 901.039 us                | 5.439 ms                  |
| Backward                  | 2.181 ms                  | 7.620 ms                  |
| Optimize                  | 198.928 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 80.902 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 385.963 us                | 1.360 ms                  |
| OneStep                   | 466.247 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
E20240131 05:02:30.069074 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
E20240131 05:02:31.069206 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:31.090875 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
W20240131 05:02:31.844101 1659092 grad_async_v2.h:256] pq is empty
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
E20240131 05:02:32.069187 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:02:32.096472 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240131 05:02:32.353263 1659092 grad_async_v2.h:256] pq is empty
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
E20240131 05:02:33.069509 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=38
W20240131 05:02:33.201153 1659092 grad_async_v2.h:256] pq is empty
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
W20240131 05:02:33.379700 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.066 us                | 1.209 ms                  |
| GenInput                  | 34.576 ms                 | 48.691 ms                 |
| NN                        | 601.105 us                | 3.410 ms                  |
| Forward                   | 900.005 us                | 5.439 ms                  |
| Backward                  | 2.188 ms                  | 7.620 ms                  |
| Optimize                  | 198.928 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 82.450 us                 | 3.196 ms                  |
| AfterBackward             | 404.257 ms                | 1.340 s                   |
| BlockToStepN              | 387.907 us                | 1.360 ms                  |
| OneStep                   | 451.957 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:34.069175 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
W20240131 05:02:34.392881 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
W20240131 05:02:34.606261 1659092 grad_async_v2.h:256] pq is empty
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.481 us                | 11.314 ms                 |
| ProcessBack:Shuffle       | 390.058 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.007 ms                  | 13.131 ms                 |
| ProcessBack:UpsertPq      | 63.867 us                 | 118.143 us                |
| ProcessOneStep            | 404.205 ms                | 1.340 s                   |
| BlockToStepN              | 294.101 us                | 1.309 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:35.069198 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
W20240131 05:02:35.630992 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
E20240131 05:02:36.072510 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
W20240131 05:02:36.893043 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
E20240131 05:02:37.072058 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:37.612161 1659092 grad_async_v2.h:256] pq is empty
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
W20240131 05:02:37.711395 1659092 grad_async_v2.h:256] pq is empty
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
E20240131 05:02:38.087666 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:38.089607 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 159.560 us                | 1.209 ms                  |
| GenInput                  | 34.586 ms                 | 48.691 ms                 |
| NN                        | 603.769 us                | 3.410 ms                  |
| Forward                   | 904.259 us                | 5.439 ms                  |
| Backward                  | 2.192 ms                  | 7.620 ms                  |
| Optimize                  | 199.482 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 86.239 us                 | 3.196 ms                  |
| AfterBackward             | 392.335 ms                | 1.342 s                   |
| BlockToStepN              | 401.887 us                | 1.360 ms                  |
| OneStep                   | 429.963 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:39.087085 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
W20240131 05:02:39.546554 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.241 us                | 6.013 ms                  |
| ProcessBack:Shuffle       | 374.074 ms                | 1.332 s                   |
| ProcessBack:UpdateCache   | 995.139 us                | 13.131 ms                 |
| ProcessBack:UpsertPq      | 63.809 us                 | 118.143 us                |
| ProcessOneStep            | 392.303 ms                | 1.342 s                   |
| BlockToStepN              | 311.392 us                | 1.677 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:40.087505 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
W20240131 05:02:40.765635 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
E20240131 05:02:41.087116 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
W20240131 05:02:41.781111 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
E20240131 05:02:42.087049 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
W20240131 05:02:42.789650 1659624 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end0
E20240131 05:02:43.087942 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:43.468606 1659092 grad_async_v2.h:256] pq is empty
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.173 us                | 1.209 ms                  |
| GenInput                  | 34.599 ms                 | 48.691 ms                 |
| NN                        | 606.443 us                | 3.410 ms                  |
| Forward                   | 908.510 us                | 5.439 ms                  |
| Backward                  | 2.194 ms                  | 7.620 ms                  |
| Optimize                  | 200.364 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 89.384 us                 | 3.196 ms                  |
| AfterBackward             | 392.335 ms                | 1.342 s                   |
| BlockToStepN              | 410.492 us                | 2.635 ms                  |
| OneStep                   | 429.963 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:44.087061 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240131 05:02:44.330384 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.099 us                | 3.316 ms                  |
| ProcessBack:Shuffle       | 378.013 ms                | 1.332 s                   |
| ProcessBack:UpdateCache   | 1.011 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.865 us                 | 120.252 us                |
| ProcessOneStep            | 397.595 ms                | 1.342 s                   |
| BlockToStepN              | 316.755 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:45.087064 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:45.377017 1659624 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
W20240131 05:02:45.543614 1659092 grad_async_v2.h:256] pq is empty
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
E20240131 05:02:46.087045 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:02:46.521718 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
W20240131 05:02:46.930692 1659092 grad_async_v2.h:256] pq is empty
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
E20240131 05:02:47.087138 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
W20240131 05:02:47.765343 1659092 grad_async_v2.h:256] pq is empty
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
W20240131 05:02:47.772044 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240131 05:02:48.087087 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 05:02:48.132802 1659092 grad_async_v2.h:256] pq is empty
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
W20240131 05:02:48.758586 1659092 grad_async_v2.h:256] pq is empty
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.281 us                | 3.864 ms                  |
| GenInput                  | 34.729 ms                 | 48.691 ms                 |
| NN                        | 610.434 us                | 3.410 ms                  |
| Forward                   | 912.736 us                | 5.439 ms                  |
| Backward                  | 2.195 ms                  | 7.620 ms                  |
| Optimize                  | 200.646 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 89.384 us                 | 3.196 ms                  |
| AfterBackward             | 398.433 ms                | 1.342 s                   |
| BlockToStepN              | 415.844 us                | 2.635 ms                  |
| OneStep                   | 445.376 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:48.775403 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240131 05:02:49.087153 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:49.264866 1659092 grad_async_v2.h:256] pq is empty
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 128.659 us                | 5.791 ms                  |
| ProcessBack:Shuffle       | 385.508 ms                | 1.332 s                   |
| ProcessBack:UpdateCache   | 1.010 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.912 us                 | 120.252 us                |
| ProcessOneStep            | 398.405 ms                | 1.342 s                   |
| BlockToStepN              | 316.755 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:02:49.884829 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
E20240131 05:02:50.087376 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
W20240131 05:02:50.995033 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
E20240131 05:02:51.087042 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
W20240131 05:02:51.996536 1659624 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
E20240131 05:02:52.087148 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
E20240131 05:02:53.087091 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:02:53.266350 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.457 us                | 1.209 ms                  |
| GenInput                  | 34.729 ms                 | 48.691 ms                 |
| NN                        | 611.418 us                | 2.152 ms                  |
| Forward                   | 915.059 us                | 4.665 ms                  |
| Backward                  | 2.194 ms                  | 7.620 ms                  |
| Optimize                  | 200.622 us                | 582.471 us                |
| BarrierTimeBeforeRank0    | 89.789 us                 | 3.122 ms                  |
| AfterBackward             | 391.709 ms                | 1.340 s                   |
| BlockToStepN              | 418.776 us                | 1.727 ms                  |
| OneStep                   | 429.963 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
E20240131 05:02:54.087033 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:02:54.836354 1659624 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.493 us                | 952.922 us                |
| ProcessBack:Shuffle       | 362.474 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.011 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.791 us                 | 120.252 us                |
| ProcessOneStep            | 376.716 ms                | 1.340 s                   |
| BlockToStepN              | 329.798 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:55.087008 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
E20240131 05:02:56.087193 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:56.998757 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240131 05:02:57.087033 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
E20240131 05:02:58.087093 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:02:58.171515 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.281 us                | 1.209 ms                  |
| GenInput                  | 34.593 ms                 | 48.691 ms                 |
| NN                        | 611.102 us                | 2.152 ms                  |
| Forward                   | 914.025 us                | 4.665 ms                  |
| Backward                  | 2.194 ms                  | 7.620 ms                  |
| Optimize                  | 200.622 us                | 582.471 us                |
| BarrierTimeBeforeRank0    | 90.834 us                 | 3.122 ms                  |
| AfterBackward             | 378.924 ms                | 1.342 s                   |
| BlockToStepN              | 422.225 us                | 2.635 ms                  |
| OneStep                   | 428.337 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:02:59.087065 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:02:59.291404 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240131 05:02:59.427403 1659092 grad_async_v2.h:256] pq is empty
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.101 us                | 5.628 ms                  |
| ProcessBack:Shuffle       | 362.474 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.011 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.791 us                 | 123.021 us                |
| ProcessOneStep            | 378.901 ms                | 1.342 s                   |
| BlockToStepN              | 333.040 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:03:00.087034 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:03:00.420478 1659092 grad_async_v2.h:256] pq is empty
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
W20240131 05:03:00.439621 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
E20240131 05:03:01.087041 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240131 05:03:01.481871 1659092 grad_async_v2.h:256] pq is empty
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
W20240131 05:03:01.494540 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
E20240131 05:03:02.087085 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240131 05:03:02.511413 1659092 grad_async_v2.h:256] pq is empty
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
W20240131 05:03:02.517895 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
E20240131 05:03:03.087169 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
W20240131 05:03:03.646700 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.472 us                | 1.209 ms                  |
| GenInput                  | 34.596 ms                 | 48.969 ms                 |
| NN                        | 611.711 us                | 3.410 ms                  |
| Forward                   | 917.233 us                | 5.439 ms                  |
| Backward                  | 2.198 ms                  | 7.620 ms                  |
| Optimize                  | 200.951 us                | 582.471 us                |
| BarrierTimeBeforeRank0    | 89.789 us                 | 3.122 ms                  |
| AfterBackward             | 378.924 ms                | 1.342 s                   |
| BlockToStepN              | 425.848 us                | 2.635 ms                  |
| OneStep                   | 428.337 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
E20240131 05:03:04.087034 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.962 us                | 11.520 ms                 |
| ProcessBack:Shuffle       | 346.870 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.007 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.791 us                 | 123.021 us                |
| ProcessOneStep            | 375.059 ms                | 1.342 s                   |
| BlockToStepN              | 336.865 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:03:05.087597 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
W20240131 05:03:05.280781 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
E20240131 05:03:06.087193 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
W20240131 05:03:06.752637 1659092 grad_async_v2.h:256] pq is empty
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
W20240131 05:03:07.042479 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
E20240131 05:03:07.087105 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
E20240131 05:03:08.087153 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
W20240131 05:03:08.688640 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.472 us                | 1.209 ms                  |
| GenInput                  | 34.599 ms                 | 49.033 ms                 |
| NN                        | 617.904 us                | 3.410 ms                  |
| Forward                   | 918.553 us                | 5.439 ms                  |
| Backward                  | 2.198 ms                  | 7.620 ms                  |
| Optimize                  | 200.951 us                | 582.471 us                |
| BarrierTimeBeforeRank0    | 83.829 us                 | 3.122 ms                  |
| AfterBackward             | 376.752 ms                | 1.342 s                   |
| BlockToStepN              | 436.468 us                | 2.635 ms                  |
| OneStep                   | 427.875 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:03:09.087679 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.445 us                | 830.236 us                |
| ProcessBack:Shuffle       | 362.474 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.016 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.865 us                 | 123.021 us                |
| ProcessOneStep            | 376.716 ms                | 1.342 s                   |
| BlockToStepN              | 342.447 us                | 2.564 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
E20240131 05:03:10.087168 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:03:10.282923 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
E20240131 05:03:11.087021 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:03:11.400211 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
W20240131 05:03:11.804361 1659092 grad_async_v2.h:256] pq is empty
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
E20240131 05:03:12.087498 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:03:12.310742 1659092 grad_async_v2.h:256] pq is empty
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
W20240131 05:03:12.446594 1659624 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
E20240131 05:03:13.087287 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
W20240131 05:03:13.700060 1659624 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.731 us                | 1.209 ms                  |
| GenInput                  | 34.641 ms                 | 49.033 ms                 |
| NN                        | 620.109 us                | 3.410 ms                  |
| Forward                   | 919.553 us                | 5.439 ms                  |
| Backward                  | 2.205 ms                  | 7.620 ms                  |
| Optimize                  | 201.725 us                | 582.471 us                |
| BarrierTimeBeforeRank0    | 83.829 us                 | 3.196 ms                  |
| AfterBackward             | 378.924 ms                | 1.342 s                   |
| BlockToStepN              | 441.409 us                | 3.332 ms                  |
| OneStep                   | 428.337 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
E20240131 05:03:14.087162 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 489 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.335 us                | 5.946 ms                  |
| ProcessBack:Shuffle       | 366.181 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.011 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.865 us                 | 123.021 us                |
| ProcessOneStep            | 378.901 ms                | 1.342 s                   |
| BlockToStepN              | 345.268 us                | 3.187 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:03:14.908200 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
E20240131 05:03:15.087203 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
E20240131 05:03:16.088009 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:03:16.132477 1659624 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
E20240131 05:03:17.087393 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:03:17.150305 1659624 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
E20240131 05:03:18.087335 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240131 05:03:18.505200 1659624 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.683 us                | 1.209 ms                  |
| GenInput                  | 34.729 ms                 | 49.267 ms                 |
| NN                        | 620.160 us                | 3.410 ms                  |
| Forward                   | 920.367 us                | 5.439 ms                  |
| Backward                  | 2.207 ms                  | 7.620 ms                  |
| Optimize                  | 202.072 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 80.902 us                 | 3.196 ms                  |
| AfterBackward             | 376.752 ms                | 1.342 s                   |
| BlockToStepN              | 447.005 us                | 3.332 ms                  |
| OneStep                   | 427.875 ms                | 1.393 s                   |
| E2E-100                   | 47.410 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
E20240131 05:03:19.087415 1659624 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240131 05:03:19.269582 1659092 grad_async_v2.h:256] pq is empty
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
W20240131 05:03:19.524773 1659624 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
Step499:rank1, time: 49.582, per_step: 0.490914
Step499:rank3, time: 49.582, per_step: 0.490913
Step499:rank2, time: 49.582, per_step: 0.490914
Step499:rank0, time: 49.582, per_step: 0.490914
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 160.472 us                | 1.209 ms                  |
| GenInput                  | 34.729 ms                 | 49.267 ms                 |
| NN                        | 620.160 us                | 3.410 ms                  |
| Forward                   | 920.367 us                | 5.439 ms                  |
| Backward                  | 2.207 ms                  | 7.620 ms                  |
| Optimize                  | 201.725 us                | 591.785 us                |
| BarrierTimeBeforeRank0    | 74.667 us                 | 3.196 ms                  |
| AfterBackward             | 376.752 ms                | 1.342 s                   |
| BlockToStepN              | 447.481 us                | 3.332 ms                  |
| OneStep                   | 428.337 ms                | 1.393 s                   |
| E2E-100                   | 49.067 s                  | 54.858 s                  |
+---------------------------+---------------------------+---------------------------+
W20240131 05:03:19.577617 1659092 grad_async_v2.h:89] call StopThreads. PID = 1659092
W20240131 05:03:19.577632 1659092 grad_base.h:212] before processOneStepNegThread_.join();
W20240131 05:03:19.577682 1659092 grad_base.h:214] after processOneStepNegThread_.join();
W20240131 05:03:19.577687 1659092 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240131 05:03:19.777364 1659092 grad_async_v2.h:110] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.693 us                | 11.179 ms                 |
| ProcessBack:Shuffle       | 363.795 ms                | 1.329 s                   |
| ProcessBack:UpdateCache   | 1.019 ms                  | 15.081 ms                 |
| ProcessBack:UpsertPq      | 63.912 us                 | 123.021 us                |
| ProcessOneStep            | 376.716 ms                | 1.342 s                   |
| BlockToStepN              | 357.872 us                | 3.187 ms                  |
+---------------------------+---------------------------+---------------------------+
ERROR [1659092 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7fc05c52dd50>
Successfully xmh
