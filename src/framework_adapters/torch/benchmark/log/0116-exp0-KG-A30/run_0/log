/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_313', no_save_emb=True, max_step=500, batch_size=8400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=1e-07, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2623155 sampler.py:454] Start PreSampling
WARNING [2623155 sampler.py:532] Before construct renumbering_dict
WARNING [2623155 sampler.py:555] PreSampling done
WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240117 15:52:38.676095 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240117 15:52:38.676208 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240117 15:52:38.676229 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240117 15:52:38.676245 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240117 15:52:38.676260 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240117 15:52:38.676275 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240117 15:52:38.676292 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240117 15:52:38.676311 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240117 15:52:38.676326 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240117 15:52:38.676342 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240117 15:52:38.676359 2623155 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240117 15:52:38.676373 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240117 15:52:38.676385 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240117 15:52:38.676465 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240117 15:52:38.676482 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240117 15:52:38.676497 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240117 15:52:38.676512 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240117 15:52:38.676525 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240117 15:52:38.676553 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240117 15:52:38.676568 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240117 15:52:38.676582 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240117 15:52:38.676605 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240117 15:52:38.676626 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240117 15:52:38.676641 2623155 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240117 15:52:38.676653 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240117 15:52:38.676666 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240117 15:52:38.676695 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240117 15:52:38.676712 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240117 15:52:38.676726 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240117 15:52:38.676739 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240117 15:52:38.676752 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240117 15:52:38.676767 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240117 15:52:38.676789 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240117 15:52:38.676803 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240117 15:52:38.676816 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240117 15:52:38.676832 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240117 15:52:38.676846 2623155 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100001724000
W20240117 15:52:38.676857 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240117 15:52:38.676868 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240117 15:52:38.676898 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240117 15:52:38.676913 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240117 15:52:38.676926 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240117 15:52:38.676941 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240117 15:52:38.676957 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240117 15:52:38.676975 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240117 15:52:38.676988 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240117 15:52:38.677001 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240117 15:52:38.677016 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240117 15:52:38.677029 2623155 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240117 15:52:38.677042 2623155 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100001edc000
W20240117 15:52:38.677053 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240117 15:52:38.677067 2623155 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240117 15:52:38.792762 2623155 IPCTensor.h:367] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240117 15:52:38.792882 2623155 IPCTensor.h:367] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9480, num_edges=154759,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11158, num_edges=169559,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=11355, num_edges=241153,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10394, num_edges=202691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9480 N 154759 E
MertisPartition: part 1 has 11158 N 169559 E
MertisPartition: part 2 has 11355 N 241153 E
MertisPartition: part 3 has 10394 N 202691 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    6,    10,    11,  ...,  2559,  7188, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
After renumbering graph:  {'_ID': tensor([1664, 1754, 1771,  ..., 7540, 6696, 7610]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1.639 seconds
[Rank1] pid = 2623546
[Rank2] pid = 2623610
INFO [2623155 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2623546 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2623637 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2623610 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2623637 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2623610 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240117 15:52:42.039122 2623739 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240117 15:52:42.039127 2623611 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240117 15:52:42.039605 2623611 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1000035c8000
W20240117 15:52:42.039609 2623739 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x10000368d000
W20240117 15:52:42.039716 2623739 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x100003752000
W20240117 15:52:42.039721 2623611 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x100003817000
W20240117 15:52:42.039749 2623739 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 400]0x1000038dc000
W20240117 15:52:42.039757 2623611 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 400]0x10000d174000
W20240117 15:52:42.039795 2623739 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x100016a0c000
W20240117 15:52:42.039803 2623611 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1000202a4000
W20240117 15:52:42.039829 2623611 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240117 15:52:42.039835 2623739 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240117 15:52:42.040369 2623611 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240117 15:52:42.040380 2623739 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
INFO [2623546 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240117 15:52:42.042649 2623547 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240117 15:52:42.043300 2623547 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x100029b46000
INFO [2623155 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240117 15:52:42.043502 2623547 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x100029c0b000
W20240117 15:52:42.043603 2623547 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 400]0x100029cd0000
W20240117 15:52:42.043681 2623547 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x100033568000
W20240117 15:52:42.043819 2623676 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240117 15:52:42.043757 2623547 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240117 15:52:42.045984 2623676 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x10003ce04000
W20240117 15:52:42.046058 2623676 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x10003cec9000
W20240117 15:52:42.046100 2623676 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 400]0x10003cf8e000
W20240117 15:52:42.046089 2623547 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240117 15:52:42.046134 2623676 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x100046826000
W20240117 15:52:42.046196 2623676 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240117 15:52:42.046676 2623676 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
cudaHostRegister 0x100001ee2000
1: KnownLocalCachedEmbedding init done
WARNING [2623546 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
3: KnownLocalCachedEmbedding init done
WARNING [2623637 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
2: KnownLocalCachedEmbedding init done
WARNING [2623610 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 2623637
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
cudaHostRegister 0x100001ee2000
0: KnownLocalCachedEmbedding init done
WARNING [2623155 DistTensor.py:56] The tensor name already exists in the kvstore
I20240117 15:52:42.206926 2623611 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240117 15:52:42.207445 2623676 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240117 15:52:42.208117 2623739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240117 15:52:42.208777 2623547 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 46.897 us                 | 61.233 us                 |
| BlockToStepN              | 17.008 us                 | 145.256 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 44.192 us                 | 61.233 us                 |
| BlockToStepN              | 17.190 us                 | 145.256 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 42.628 us                 | 59.727 us                 |
| BlockToStepN              | 17.341 us                 | 58.134 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 40.400 us                 | 59.727 us                 |
| BlockToStepN              | 17.341 us                 | 58.134 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 40.231 us                 | 59.727 us                 |
| BlockToStepN              | 17.341 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
-------Step 0-------
tensor([ 9307,     1, 11370, 14621,  5657,  6381, 10094,  1922,  3361, 12135]) tensor([ 1771,    99,  6918, 13050, 11669,   287,  9792,  4204, 13431,  8553])
-------Step 1-------
tensor([ 9307,     1, 11370, 14621,  5657,  6381, 10094,  1922,  3361, 12135]) tensor([ 5652, 14573, 12032,  4117, 14480,  8439, 10067,   486,  4621, 14691])
-------Step 2-------
tensor([ 6816,    59, 14525,  9165,  3752, 13274, 14287, 10628,  2740,  5420]) tensor([ 5369, 10597, 14450,  8889,  6507,   969,  5247,  1393, 11538,  8877])
-------Step 3-------
tensor([ 6816,    59, 14525,  9165,  3752, 13274, 14287, 10628,  2740,  5420]) tensor([12482,  8012, 10480,  5578, 13824,  9624, 11020,  3840,  7237,  9456])
-------Step 4-------
tensor([ 3659,  5309,  6355,  7049,   330, 11263,  8616,  7906,  3494,  1275]) tensor([ 6126,  5623, 14920, 14267,  8023,  8454,  4519, 13114,  7028,  2384])
-------Step 5-------
tensor([ 3659,  5309,  6355,  7049,   330, 11263,  8616,  7906,  3494,  1275]) tensor([ 7633,  3921,  3392,  1207, 14315,  3833, 13487,  2189, 11263,  4521])
-------Step 6-------
tensor([ 5420, 11985,  7196,  6056,  5205,  7521,  4838,   239, 11013,  3576]) tensor([ 3604,  4502,  7382,  5461,  2593,  9902,  3980, 10807, 13301,  2163])
-------Step 7-------
tensor([ 5420, 11985,  7196,  6056,  5205,  7521,  4838,   239, 11013,  3576]) tensor([ 2297,  2100,  5985, 13800, 12484, 10155, 11827, 10023, 14487,  7176])
-------Step 8-------
tensor([14877,   865,  5308,  4360,  8675,  4632,  7831,  3131, 14065, 11805]) tensor([12501, 14327,  8765, 13015, 14131,  9883,  9888, 13369, 11260,  8037])
-------Step 9-------
tensor([14877,   865,  5308,  4360,  8675,  4632,  7831,  3131, 14065, 11805]) tensor([ 9607,  9302,  7382, 12727,   183,  8904, 11657,   516,   116, 14680])
[proc 0][Train](100/500) average pos_loss: 1.0936871847510339
[proc 0][Train](100/500) average neg_loss: 0.5569338443176821
[proc 0][Train](100/500) average loss: 0.8253105083107948
[proc 0][Train](100/500) average regularization: 8.558337098293123e-05
[proc 0] 100 steps, total: 32.640, sample: 0.518, forward: 6.879, backward: 22.493, update: 2.669
[proc 1][Train](100/500) average pos_loss: 1.0333108146488668
[proc 1][Train](100/500) average neg_loss: 0.6064941941387951
[proc 1][Train](100/500) average loss: 0.8199025103449822
[proc 1][Train](100/500) average regularization: 8.505312041961588e-05
[proc 1] 100 steps, total: 32.652, sample: 0.431, forward: 2.435, backward: 24.257, update: 0.653
[proc 2][Train](100/500) average pos_loss: 1.0796488770842552
[proc 2][Train](100/500) average neg_loss: 0.6390799025213346
[proc 2][Train](100/500) average loss: 0.8593643778562545
[proc 2][Train](100/500) average regularization: 8.545935454094433e-05
[proc 2] 100 steps, total: 32.640, sample: 0.481, forward: 2.417, backward: 24.284, update: 0.636
[proc 3][Train](100/500) average pos_loss: 1.0666910427808762
[proc 3][Train](100/500) average neg_loss: 0.6565652267448604
[proc 3][Train](100/500) average loss: 0.8616281297802925
[proc 3][Train](100/500) average regularization: 8.496840722727938e-05
[proc 3] 100 steps, total: 32.648, sample: 0.522, forward: 2.296, backward: 24.245, update: 0.690
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 39.546 us                 | 59.727 us                 |
| BlockToStepN              | 16.641 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 39.314 us                 | 59.727 us                 |
| BlockToStepN              | 15.805 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 39.314 us                 | 59.727 us                 |
| BlockToStepN              | 15.932 us                 | 145.256 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.957 us                 | 58.920 us                 |
| BlockToStepN              | 16.151 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 39.314 us                 | 58.920 us                 |
| BlockToStepN              | 16.151 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 39.067 us                 | 58.920 us                 |
| BlockToStepN              | 16.142 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
[proc 0][Train](200/500) average pos_loss: 0.5036515763401985
[proc 0][Train](200/500) average neg_loss: 0.4087881729006767
[proc 0][Train](200/500) average loss: 0.45621987313032153
[proc 0][Train](200/500) average regularization: 0.00010270699691318441
[proc 0] 200 steps, total: 27.478, sample: 0.410, forward: 6.080, backward: 18.522, update: 2.385
[proc 3][Train](200/500) average pos_loss: 0.44657016068696975
[proc 3][Train](200/500) average neg_loss: 0.5247616478800774
[proc 3][Train](200/500) average loss: 0.48566590338945387
[proc 3][Train](200/500) average regularization: 0.00010189755848841742
[proc 3] 200 steps, total: 27.478, sample: 0.474, forward: 1.439, backward: 20.126, update: 0.653
[proc 1][Train](200/500) average pos_loss: 0.41152563393116
[proc 1][Train](200/500) average neg_loss: 0.47103901118040087
[proc 1][Train](200/500) average loss: 0.44128232389688493
[proc 1][Train](200/500) average regularization: 0.00010211684406385757
[proc 1] 200 steps, total: 27.478, sample: 0.466, forward: 1.590, backward: 19.999, update: 0.584
[proc 2][Train](200/500) average pos_loss: 0.45605542093515394
[proc 2][Train](200/500) average neg_loss: 0.5063483306765556
[proc 2][Train](200/500) average loss: 0.4812018769979477
[proc 2][Train](200/500) average regularization: 0.00010246703939628787
[proc 2] 200 steps, total: 27.478, sample: 0.483, forward: 1.616, backward: 19.951, update: 0.606
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.957 us                 | 58.920 us                 |
| BlockToStepN              | 16.142 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.825 us                 | 58.920 us                 |
| BlockToStepN              | 15.892 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.621 us                 | 56.204 us                 |
| BlockToStepN              | 15.861 us                 | 72.874 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.587 us                 | 56.204 us                 |
| BlockToStepN              | 15.712 us                 | 72.874 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.587 us                 | 56.204 us                 |
| BlockToStepN              | 15.712 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
[proc 0][Train](300/500) average pos_loss: 0.5093561974167824
[proc 0][Train](300/500) average neg_loss: 0.40333808958530426
[proc 0][Train](300/500) average loss: 0.45634714543819427
[proc 0][Train](300/500) average regularization: 0.00011735544641851448
[proc 0] 300 steps, total: 27.699, sample: 0.470, forward: 6.063, backward: 18.766, update: 2.320
[proc 1][Train](300/500) average pos_loss: 0.41231597036123274
[proc 1][Train](300/500) average neg_loss: 0.46189667761325837
[proc 1][Train](300/500) average loss: 0.4371063244342804
[proc 1][Train](300/500) average regularization: 0.00011676851128868293
[proc 1] 300 steps, total: 27.699, sample: 0.405, forward: 1.599, backward: 20.243, update: 0.552
[proc 2][Train](300/500) average pos_loss: 0.47250781148672105
[proc 2][Train](300/500) average neg_loss: 0.4947021186351776
[proc 2][Train](300/500) average loss: 0.48360496550798415
[proc 2][Train](300/500) average regularization: 0.00011711247010680381
[proc 2] 300 steps, total: 27.699, sample: 0.458, forward: 1.637, backward: 20.174, update: 0.563
[proc 3][Train](300/500) average pos_loss: 0.4724060243368149
[proc 3][Train](300/500) average neg_loss: 0.514091517329216
[proc 3][Train](300/500) average loss: 0.49324877083301544
[proc 3][Train](300/500) average regularization: 0.00011657607014058158
[proc 3] 300 steps, total: 27.699, sample: 0.440, forward: 1.446, backward: 20.401, update: 0.625
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.137 us                 | 56.204 us                 |
| BlockToStepN              | 15.587 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.132 us                 | 56.204 us                 |
| BlockToStepN              | 15.761 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.079 us                 | 56.204 us                 |
| BlockToStepN              | 15.722 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 37.987 us                 | 56.056 us                 |
| BlockToStepN              | 15.773 us                 | 72.874 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.079 us                 | 56.056 us                 |
| BlockToStepN              | 15.932 us                 | 77.562 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.137 us                 | 56.056 us                 |
| BlockToStepN              | 16.068 us                 | 77.562 us                 |
+---------------------------+---------------------------+---------------------------+
[proc 2][Train](400/500) average pos_loss: 0.4951940569281578
[proc 2][Train](400/500) average neg_loss: 0.47624205231666566
[proc 2][Train](400/500) average loss: 0.4857180553674698
[proc 2][Train](400/500) average regularization: 0.00012110818825021852
[proc 2] 400 steps, total: 27.909, sample: 0.527, forward: 1.578, backward: 20.251, update: 0.606
[proc 3][Train](400/500) average pos_loss: 0.49972863256931305
[proc 3][Train](400/500) average neg_loss: 0.5017366722226143
[proc 3][Train](400/500) average loss: 0.5007326522469521
[proc 3][Train](400/500) average regularization: 0.00012054788101522717
[proc 3] 400 steps, total: 27.909, sample: 0.438, forward: 1.464, backward: 20.508, update: 0.619
[proc 0][Train](400/500) average pos_loss: 0.5054855233430863
[proc 0][Train](400/500) average neg_loss: 0.3960144054889679
[proc 0][Train](400/500) average loss: 0.45074996501207354
[proc 0][Train](400/500) average regularization: 0.00012112397700548172
[proc 0] 400 steps, total: 27.909, sample: 0.443, forward: 6.085, backward: 18.920, update: 2.381
[proc 1][Train](400/500) average pos_loss: 0.41656077235937117
[proc 1][Train](400/500) average neg_loss: 0.45750172466039657
[proc 1][Train](400/500) average loss: 0.4370312482118607
[proc 1][Train](400/500) average regularization: 0.00012066001698258334
[proc 1] 400 steps, total: 27.909, sample: 0.468, forward: 1.648, backward: 20.264, update: 0.608
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.347 us                 | 56.204 us                 |
| BlockToStepN              | 16.068 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.347 us                 | 56.204 us                 |
| BlockToStepN              | 16.119 us                 | 87.897 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.137 us                 | 56.204 us                 |
| BlockToStepN              | 16.142 us                 | 87.897 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.159 us                 | 56.056 us                 |
| BlockToStepN              | 16.119 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.079 us                 | 56.056 us                 |
| BlockToStepN              | 16.119 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
[proc 0][Train](500/500) average pos_loss: 0.4957139736413956
[proc 0][Train](500/500) average neg_loss: 0.39093940079212186
[proc 0][Train](500/500) average loss: 0.4433266893029213
[proc 0][Train](500/500) average regularization: 0.00011913326874491758
[proc 0] 500 steps, total: 27.829, sample: 0.473, forward: 6.085, backward: 18.784, update: 2.405
[proc 1][Train](500/500) average pos_loss: 0.4178405937552452
[proc 1][Train](500/500) average neg_loss: 0.4470933768153191
[proc 1][Train](500/500) average loss: 0.4324669858813286
[proc 1][Train](500/500) average regularization: 0.00011887336193467491
[proc 1] 500 steps, total: 27.829, sample: 0.406, forward: 1.598, backward: 20.205, update: 0.579
[proc 3][Train](500/500) average pos_loss: 0.523682211637497
[proc 3][Train](500/500) average neg_loss: 0.4908838185667992
[proc 3][Train](500/500) average loss: 0.5072830131649971
[proc 3][Train](500/500) average regularization: 0.00011884423161973246
[proc 3] 500 steps, total: 27.829, sample: 0.492, forward: 1.442, backward: 20.341, update: 0.637
[proc 2][Train](500/500) average pos_loss: 0.5191560190916061
[proc 2][Train](500/500) average neg_loss: 0.4652599376440048
[proc 2][Train](500/500) average loss: 0.4922079807519913
[proc 2][Train](500/500) average regularization: 0.00011932870707823894
[proc 2] 500 steps, total: 27.829, sample: 0.432, forward: 1.612, backward: 20.195, update: 0.577
Successfully xmh. training takes 143.5564568042755 seconds
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| BarrierTimeBeforeRank0    | 38.012 us                 | 56.056 us                 |
| BlockToStepN              | 16.142 us                 | 81.976 us                 |
+---------------------------+---------------------------+---------------------------+
