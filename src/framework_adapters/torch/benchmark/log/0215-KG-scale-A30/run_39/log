WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240218 05:38:22.647055 1624542 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_14', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1624542 sampler.py:454] Start PreSampling
WARNING [1624542 sampler.py:532] Before construct renumbering_dict
WARNING [1624542 sampler.py:555] PreSampling done
W20240218 05:38:24.940721 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240218 05:38:24.940868 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240218 05:38:24.940896 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240218 05:38:24.940917 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240218 05:38:24.940937 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240218 05:38:24.940955 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240218 05:38:24.940977 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240218 05:38:24.940999 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240218 05:38:24.941025 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240218 05:38:24.941046 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240218 05:38:24.941069 1624542 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240218 05:38:24.941089 1624542 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240218 05:38:24.941107 1624542 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240218 05:38:24.941193 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240218 05:38:24.941221 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240218 05:38:24.941238 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240218 05:38:24.941277 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240218 05:38:24.941298 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240218 05:38:24.941314 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240218 05:38:24.941336 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240218 05:38:24.941357 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240218 05:38:24.941380 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240218 05:38:24.941396 1624542 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240218 05:38:24.941417 1624542 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240218 05:38:24.941433 1624542 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240218 05:38:24.941448 1624542 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240218 05:38:25.058583 1624542 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000098ca000 22.81 MB
W20240218 05:38:25.085893 1624542 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10000af9c000 58.4 kB
{0: Graph(num_nodes=13804, num_edges=289155,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12626, num_edges=379866,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 13804 N 289155 E
MertisPartition: part 1 has 12626 N 379866 E
Rank0: cached key size 373
Rank1: cached key size 373
Before renumbering graph:  {'_ID': tensor([    0,     2,     6,  ..., 11079,  2237, 14365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([  769,   820,   920,  ..., 10859, 11605, 10970]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=13804, num_edges=289155,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=13804, num_edges=289155,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.467 seconds
INFO [1624876 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1624542 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1624876 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [1624542 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING [1624876 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [1624542 DistTensor.py:59] The tensor name already exists in the kvstore
I20240218 05:38:34.467609 1624877 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240218 05:38:34.467752 1624916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
E20240218 05:38:34.653882 1624877 recstore.cc:67] init folly done
E20240218 05:38:34.653966 1624916 recstore.cc:67] init folly done
I20240218 05:38:34.711162 1624877 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240218 05:38:34.724656 1624916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 881.296 us                | 882.434 us                |
| bucket keys               | 828.981 us                | 169.162 ms                |
| forward: a2a keys         | 1.166 ms                  | 2.406 s                   |
| forward: search cache     | 150.442 us                | 26.003 ms                 |
| forward: a2a values       | 772.715 us                | 1.310 ms                  |
| forward: software         | 464.439 us                | 745.296 us                |
| forward: join             | 1.508 ms                  | 2.713 ms                  |
| Forward                   | 13.672 ms                 | 3.246 s                   |
| back: aggr dram keys      | 16.036 ms                 | 1.070 s                   |
| back: set dram grad       | 2.827 ms                  | 8.133 ms                  |
| back: a2a grad            | 2.702 ms                  | 3.775 ms                  |
| back: grad sum & grad cache  | 1.557 ms                  | 3.068 ms                  |
| Backward                  | 48.273 ms                 | 1.358 s                   |
| Optimize                  | 8.009 ms                  | 46.131 ms                 |
| BarrierTimeBeforeRank0    | 40.841 us                 | 56.161 us                 |
| BlockToStepN              | 5.717 us                  | 8.841 us                  |
| OneStep                   | 69.467 ms                 | 4.652 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.758 ms                  | 26.308 ms                 |
| bucket keys               | 1.705 ms                  | 2.052 ms                  |
| forward: a2a keys         | 1.198 ms                  | 10.928 ms                 |
| forward: search cache     | 327.826 us                | 383.615 us                |
| forward: a2a values       | 1.374 ms                  | 1.626 ms                  |
| forward: software         | 820.160 us                | 1.405 ms                  |
| forward: join             | 2.437 ms                  | 3.187 ms                  |
| Forward                   | 21.487 ms                 | 26.565 ms                 |
| back: aggr dram keys      | 17.431 ms                 | 21.715 ms                 |
| back: set dram grad       | 1.429 ms                  | 5.169 ms                  |
| back: a2a grad            | 1.647 ms                  | 2.738 ms                  |
| back: grad sum & grad cache  | 990.152 us                | 1.662 ms                  |
| Backward                  | 45.707 ms                 | 52.272 ms                 |
| Optimize                  | 9.803 ms                  | 26.500 ms                 |
| BarrierTimeBeforeRank0    | 56.291 us                 | 96.283 us                 |
| BlockToStepN              | 21.275 us                 | 36.416 us                 |
| OneStep                   | 79.414 ms                 | 103.596 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank1] pid = 1624876
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494)]
train_sampler.Prefill()
-------Step 0-------
tensor([  212,  5280,  9893,  8255,  2901, 14611,  3799,  6681,  7060,  7800]) tensor([  951,  9780, 12042, 13542, 13822,  6468,  6085,   377,  7252,  8872])
-------Step 1-------
tensor([  212,  5280,  9893,  8255,  2901, 14611,  3799,  6681,  7060,  7800]) tensor([13150,  1600,  2127,  4194,  7831, 10536, 10194,  9194, 10880,  3888])
-------Step 2-------
tensor([14611,     9,   216,   182,  6871,  6895,  1634, 12472,  8858, 10696]) tensor([ 2536,  2143, 14840, 13354,  5540,  7747, 12538,  2038,  5734,  5114])
-------Step 3-------
tensor([14611,     9,   216,   182,  6871,  6895,  1634, 12472,  8858, 10696]) tensor([14090,  2168,   224,  5558,  6489, 10924,  3243,   832, 14339, 12838])
-------Step 4-------
tensor([2610, 2188,  273, 1787, 8625, 6636, 9577, 8344,   94, 6063]) tensor([ 5724, 13546, 10433,  8339, 11288,  7109,  6627,  8649,  5208,  8782])
-------Step 5-------
tensor([2610, 2188,  273, 1787, 8625, 6636, 9577, 8344,   94, 6063]) tensor([ 8324,  2983, 11493,  4997,  3444,  9801,    56,   793,  5303,  7456])
-------Step 6-------
tensor([ 6946,  3449,  6766,   225,  1230,   108, 14611,  6743,    87,   297]) tensor([13052, 13849,  7797,  7922,   876,  6648,  4293, 13168, 14793,  9180])
-------Step 7-------
tensor([ 6946,  3449,  6766,   225,  1230,   108, 14611,  6743,    87,   297]) tensor([ 7962,  1805, 14743, 12052, 14039,  8365,  1962,   558,    47,  7712])
-------Step 8-------
tensor([ 4580,  9652,  5935,  2224,  5280,  5649,  6871,  2610, 12453, 11905]) tensor([12922,  6973, 14715,  5541,  6245,  8833,  2598,  7328, 12718, 13337])
-------Step 9-------
tensor([ 4580,  9652,  5935,  2224,  5280,  5649,  6871,  2610, 12453, 11905]) tensor([ 4095,  9291, 12012, 14609, 14157,  4050,  2367,  9194, 13094,  3157])
before start barrier
start train
[proc 0] 100 steps, total: 12.733, sample: 0.439, forward: 5.319, backward: 5.864, update: 1.001
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 12.720, sample: 0.470, forward: 5.253, backward: 5.844, update: 0.235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.755 ms                  | 26.893 ms                 |
| bucket keys               | 1.708 ms                  | 2.052 ms                  |
| forward: a2a keys         | 1.198 ms                  | 9.305 ms                  |
| forward: search cache     | 329.018 us                | 369.072 us                |
| forward: a2a values       | 1.345 ms                  | 1.621 ms                  |
| forward: software         | 820.160 us                | 1.400 ms                  |
| forward: join             | 2.429 ms                  | 3.150 ms                  |
| Forward                   | 21.287 ms                 | 26.565 ms                 |
| back: aggr dram keys      | 17.431 ms                 | 20.667 ms                 |
| back: set dram grad       | 1.424 ms                  | 4.025 ms                  |
| back: a2a grad            | 1.599 ms                  | 2.702 ms                  |
| back: grad sum & grad cache  | 972.986 us                | 1.557 ms                  |
| Backward                  | 44.922 ms                 | 52.272 ms                 |
| Optimize                  | 9.820 ms                  | 26.500 ms                 |
| BarrierTimeBeforeRank0    | 55.710 us                 | 96.283 us                 |
| BlockToStepN              | 21.175 us                 | 36.416 us                 |
| OneStep                   | 78.778 ms                 | 103.852 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.750 ms                  | 26.711 ms                 |
| bucket keys               | 1.707 ms                  | 2.050 ms                  |
| forward: a2a keys         | 1.191 ms                  | 4.550 ms                  |
| forward: search cache     | 329.018 us                | 369.310 us                |
| forward: a2a values       | 1.348 ms                  | 1.619 ms                  |
| forward: software         | 821.590 us                | 1.386 ms                  |
| forward: join             | 2.433 ms                  | 3.098 ms                  |
| Forward                   | 21.265 ms                 | 24.365 ms                 |
| back: aggr dram keys      | 17.366 ms                 | 20.603 ms                 |
| back: set dram grad       | 1.423 ms                  | 3.395 ms                  |
| back: a2a grad            | 1.587 ms                  | 2.605 ms                  |
| back: grad sum & grad cache  | 971.794 us                | 1.321 ms                  |
| Backward                  | 44.817 ms                 | 50.750 ms                 |
| Optimize                  | 9.818 ms                  | 15.815 ms                 |
| BarrierTimeBeforeRank0    | 55.570 us                 | 90.260 us                 |
| BlockToStepN              | 21.140 us                 | 32.120 us                 |
| OneStep                   | 78.478 ms                 | 103.596 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 8.127, sample: 0.513, forward: 2.078, backward: 4.477, update: 0.956
[proc 1] 200 steps, total: 8.127, sample: 0.527, forward: 2.035, backward: 4.458, update: 0.198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.756 ms                  | 26.711 ms                 |
| bucket keys               | 1.708 ms                  | 2.050 ms                  |
| forward: a2a keys         | 1.188 ms                  | 5.684 ms                  |
| forward: search cache     | 329.494 us                | 386.477 us                |
| forward: a2a values       | 1.349 ms                  | 1.617 ms                  |
| forward: software         | 821.590 us                | 1.262 ms                  |
| forward: join             | 2.429 ms                  | 2.872 ms                  |
| Forward                   | 21.278 ms                 | 24.365 ms                 |
| back: aggr dram keys      | 17.332 ms                 | 20.632 ms                 |
| back: set dram grad       | 1.416 ms                  | 3.283 ms                  |
| back: a2a grad            | 1.585 ms                  | 2.537 ms                  |
| back: grad sum & grad cache  | 969.172 us                | 1.321 ms                  |
| Backward                  | 44.718 ms                 | 50.750 ms                 |
| Optimize                  | 9.821 ms                  | 15.815 ms                 |
| BarrierTimeBeforeRank0    | 55.645 us                 | 90.260 us                 |
| BlockToStepN              | 21.055 us                 | 32.120 us                 |
| OneStep                   | 78.161 ms                 | 103.852 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 7.995, sample: 0.455, forward: 2.079, backward: 4.430, update: 0.938
[proc 1] 300 steps, total: 7.995, sample: 0.469, forward: 2.040, backward: 4.415, update: 0.201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.759 ms                  | 26.706 ms                 |
| bucket keys               | 1.708 ms                  | 2.052 ms                  |
| forward: a2a keys         | 1.185 ms                  | 4.550 ms                  |
| forward: search cache     | 329.733 us                | 383.615 us                |
| forward: a2a values       | 1.352 ms                  | 1.613 ms                  |
| forward: software         | 821.590 us                | 1.385 ms                  |
| forward: join             | 2.430 ms                  | 3.098 ms                  |
| Forward                   | 21.236 ms                 | 23.532 ms                 |
| back: aggr dram keys      | 17.275 ms                 | 20.632 ms                 |
| back: set dram grad       | 1.409 ms                  | 3.283 ms                  |
| back: a2a grad            | 1.583 ms                  | 2.391 ms                  |
| back: grad sum & grad cache  | 968.218 us                | 1.285 ms                  |
| Backward                  | 44.513 ms                 | 50.335 ms                 |
| Optimize                  | 9.802 ms                  | 13.079 ms                 |
| BarrierTimeBeforeRank0    | 55.616 us                 | 89.851 us                 |
| BlockToStepN              | 21.019 us                 | 32.120 us                 |
| OneStep                   | 77.976 ms                 | 103.596 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.759 ms                  | 26.706 ms                 |
| bucket keys               | 1.708 ms                  | 2.053 ms                  |
| forward: a2a keys         | 1.182 ms                  | 3.668 ms                  |
| forward: search cache     | 329.494 us                | 383.139 us                |
| forward: a2a values       | 1.348 ms                  | 1.613 ms                  |
| forward: software         | 821.590 us                | 1.262 ms                  |
| forward: join             | 2.429 ms                  | 2.872 ms                  |
| Forward                   | 21.210 ms                 | 23.509 ms                 |
| back: aggr dram keys      | 17.264 ms                 | 20.603 ms                 |
| back: set dram grad       | 1.405 ms                  | 2.900 ms                  |
| back: a2a grad            | 1.582 ms                  | 2.303 ms                  |
| back: grad sum & grad cache  | 968.218 us                | 1.283 ms                  |
| Backward                  | 44.413 ms                 | 49.955 ms                 |
| Optimize                  | 9.779 ms                  | 14.994 ms                 |
| BarrierTimeBeforeRank0    | 55.514 us                 | 88.045 us                 |
| BlockToStepN              | 21.055 us                 | 31.960 us                 |
| OneStep                   | 77.859 ms                 | 102.610 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 7.993, sample: 0.458, forward: 2.076, backward: 4.421, update: 0.950
[proc 1] 400 steps, total: 7.993, sample: 0.469, forward: 2.038, backward: 4.411, update: 0.203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.760 ms                  | 26.706 ms                 |
| bucket keys               | 1.710 ms                  | 2.053 ms                  |
| forward: a2a keys         | 1.180 ms                  | 3.418 ms                  |
| forward: search cache     | 330.210 us                | 383.139 us                |
| forward: a2a values       | 1.347 ms                  | 1.611 ms                  |
| forward: software         | 823.021 us                | 1.226 ms                  |
| forward: join             | 2.430 ms                  | 2.841 ms                  |
| Forward                   | 21.214 ms                 | 23.509 ms                 |
| back: aggr dram keys      | 17.223 ms                 | 20.479 ms                 |
| back: set dram grad       | 1.400 ms                  | 2.797 ms                  |
| back: a2a grad            | 1.578 ms                  | 2.103 ms                  |
| back: grad sum & grad cache  | 963.449 us                | 1.253 ms                  |
| Backward                  | 44.342 ms                 | 50.023 ms                 |
| Optimize                  | 9.795 ms                  | 14.994 ms                 |
| BarrierTimeBeforeRank0    | 55.537 us                 | 88.045 us                 |
| BlockToStepN              | 21.013 us                 | 31.960 us                 |
| OneStep                   | 77.849 ms                 | 102.610 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.759 ms                  | 26.711 ms                 |
| bucket keys               | 1.711 ms                  | 2.053 ms                  |
| forward: a2a keys         | 1.179 ms                  | 3.418 ms                  |
| forward: search cache     | 330.210 us                | 383.139 us                |
| forward: a2a values       | 1.352 ms                  | 1.613 ms                  |
| forward: software         | 823.259 us                | 1.211 ms                  |
| forward: join             | 2.432 ms                  | 2.862 ms                  |
| Forward                   | 21.245 ms                 | 23.509 ms                 |
| back: aggr dram keys      | 17.266 ms                 | 20.466 ms                 |
| back: set dram grad       | 1.398 ms                  | 2.787 ms                  |
| back: a2a grad            | 1.575 ms                  | 2.003 ms                  |
| back: grad sum & grad cache  | 959.635 us                | 1.252 ms                  |
| Backward                  | 44.356 ms                 | 50.023 ms                 |
| Optimize                  | 9.811 ms                  | 13.079 ms                 |
| BarrierTimeBeforeRank0    | 55.599 us                 | 87.581 us                 |
| BlockToStepN              | 20.961 us                 | 31.960 us                 |
| OneStep                   | 77.914 ms                 | 103.596 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 8.088, sample: 0.479, forward: 2.091, backward: 4.454, update: 0.964
[proc 1] 500 steps, total: 8.088, sample: 0.463, forward: 2.080, backward: 4.434, update: 0.200
Successfully xmh. training takes 44.936389684677124 seconds
before call kg_cache_controller.StopThreads()
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
INFO [1624542 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
