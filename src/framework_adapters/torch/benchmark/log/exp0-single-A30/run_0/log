File not found. Downloading from https://data.dgl.ai/dataset/FB15k.zip
Download finished. Unzipping the file...
Unzip finished.
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=-1, format='built_in', gamma=16.0, gpu=[0], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=1, num_proc=1, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_FB15k_0', soft_rel_part=False, strict_rel_part=True, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 91.695 seconds
[proc 0][Train](1000/10000) average pos_loss: 0.3084355691447854
[proc 0][Train](1000/10000) average neg_loss: 0.3156133877187967
[proc 0][Train](1000/10000) average loss: 0.31202447882294654
[proc 0][Train](1000/10000) average regularization: 8.96326293968741e-06
[proc 0] 1000 steps, total: 9.454, sample: 0.959, forward: 3.053, backward: 1.743, update: 3.694
[proc 0][Train](2000/10000) average pos_loss: 0.10457822182029486
[proc 0][Train](2000/10000) average neg_loss: 0.13857104586064817
[proc 0][Train](2000/10000) average loss: 0.12157463393360377
[proc 0][Train](2000/10000) average regularization: 1.3067581890027213e-05
[proc 0] 2000 steps, total: 9.117, sample: 0.872, forward: 2.903, backward: 1.447, update: 3.890
[proc 0][Train](3000/10000) average pos_loss: 0.08051706759631634
[proc 0][Train](3000/10000) average neg_loss: 0.11302742748707532
[proc 0][Train](3000/10000) average loss: 0.09677224761992693
[proc 0][Train](3000/10000) average regularization: 1.5002379785073571e-05
[proc 0] 3000 steps, total: 9.123, sample: 0.918, forward: 2.940, backward: 1.113, update: 4.148
[proc 0][Train](4000/10000) average pos_loss: 0.07037184303253889
[proc 0][Train](4000/10000) average neg_loss: 0.10144973228126765
[proc 0][Train](4000/10000) average loss: 0.08591078771650791
[proc 0][Train](4000/10000) average regularization: 1.6248693802481284e-05
[proc 0] 4000 steps, total: 9.153, sample: 0.869, forward: 2.905, backward: 1.678, update: 3.695
[proc 0][Train](5000/10000) average pos_loss: 0.06443865042552352
[proc 0][Train](5000/10000) average neg_loss: 0.09440138230472803
[proc 0][Train](5000/10000) average loss: 0.07942001642286778
[proc 0][Train](5000/10000) average regularization: 1.715442860222538e-05
[proc 0] 5000 steps, total: 9.162, sample: 0.875, forward: 2.911, backward: 1.670, update: 3.701
[proc 0][Train](6000/10000) average pos_loss: 0.060478557370603085
[proc 0][Train](6000/10000) average neg_loss: 0.08957790212333203
[proc 0][Train](6000/10000) average loss: 0.07502822982519865
[proc 0][Train](6000/10000) average regularization: 1.7878522001410603e-05
[proc 0] 6000 steps, total: 9.054, sample: 0.991, forward: 2.889, backward: 1.063, update: 4.107
[proc 0][Train](7000/10000) average pos_loss: 0.05768539984151721
[proc 0][Train](7000/10000) average neg_loss: 0.08620083034038543
[proc 0][Train](7000/10000) average loss: 0.07194311512634158
[proc 0][Train](7000/10000) average regularization: 1.8476789409760386e-05
[proc 0] 7000 steps, total: 9.162, sample: 0.897, forward: 2.936, backward: 1.302, update: 4.022
[proc 0][Train](8000/10000) average pos_loss: 0.05539433606341481
[proc 0][Train](8000/10000) average neg_loss: 0.08319110931828617
[proc 0][Train](8000/10000) average loss: 0.06929272264242173
[proc 0][Train](8000/10000) average regularization: 1.8978059000801295e-05
[proc 0] 8000 steps, total: 9.113, sample: 0.899, forward: 2.921, backward: 1.268, update: 4.020
[proc 0][Train](9000/10000) average pos_loss: 0.053625552590936425
[proc 0][Train](9000/10000) average neg_loss: 0.08104073720797897
[proc 0][Train](9000/10000) average loss: 0.0673331449702382
[proc 0][Train](9000/10000) average regularization: 1.9426232083787908e-05
[proc 0] 9000 steps, total: 9.378, sample: 0.904, forward: 2.970, backward: 1.619, update: 3.881
[proc 0][Train](10000/10000) average pos_loss: 0.05216804576292634
[proc 0][Train](10000/10000) average neg_loss: 0.07925160854309797
[proc 0][Train](10000/10000) average loss: 0.06570982710644603
[proc 0][Train](10000/10000) average regularization: 1.980878519680118e-05
[proc 0] 10000 steps, total: 9.977, sample: 1.041, forward: 3.093, backward: 2.052, update: 3.787
proc 0 takes 92.693 seconds
Successfully xmh. training takes 94.44993567466736 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[0]Test average MRR: 0.5066917409531855
[0]Test average MR: 52.83034822501735
[0]Test average HITS@1: 0.3623859423405732
[0]Test average HITS@3: 0.6074300418140881
[0]Test average HITS@10: 0.7413790184692997
testing takes 387.709 seconds
