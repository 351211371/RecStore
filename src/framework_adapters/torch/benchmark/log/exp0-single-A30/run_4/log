Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 4 parts
part 0 has 120786 edges
part 1 has 120786 edges
part 2 has 120786 edges
part 3 has 120784 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_13', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.205 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 0][Train](1000/10000) average pos_loss: 0.13662820528075098
[proc 0][Train](1000/10000) average neg_loss: 0.15733305629342795
[proc 0][Train](1000/10000) average loss: 0.14698063070327044
[proc 0][Train](1000/10000) average regularization: 1.3735450565945939e-05
[proc 0] 1000 steps, total: 16.617, sample: 1.677, forward: 6.860, backward: 2.463, update: 5.606
[proc 2][Train](1000/10000) average pos_loss: 0.15097317447513342
[proc 2][Train](1000/10000) average neg_loss: 0.18124687545001505
[proc 2][Train](1000/10000) average loss: 0.16611002473533154
[proc 2][Train](1000/10000) average regularization: 1.298610924368404e-05
[proc 2] 1000 steps, total: 16.605, sample: 1.629, forward: 5.720, backward: 2.590, update: 4.345
[proc 1][Train](1000/10000) average pos_loss: 0.14082093979790808
[proc 1][Train](1000/10000) average neg_loss: 0.16525478138029576
[proc 1][Train](1000/10000) average loss: 0.1530378605723381
[proc 1][Train](1000/10000) average regularization: 1.3418587424439465e-05
[proc 1] 1000 steps, total: 16.617, sample: 1.613, forward: 6.351, backward: 2.514, update: 4.824
[proc 3][Train](1000/10000) average pos_loss: 0.1425056314766407
[proc 3][Train](1000/10000) average neg_loss: 0.1708846985772252
[proc 3][Train](1000/10000) average loss: 0.15669516514241696
[proc 3][Train](1000/10000) average regularization: 1.3149512476047676e-05
[proc 3] 1000 steps, total: 16.605, sample: 1.519, forward: 6.052, backward: 2.396, update: 4.318
[proc 0][Train](2000/10000) average pos_loss: 0.05997234238311648
[proc 0][Train](2000/10000) average neg_loss: 0.08813584884628653
[proc 0][Train](2000/10000) average loss: 0.07405409558862448
[proc 0][Train](2000/10000) average regularization: 1.8225641650133185e-05
[proc 0] 2000 steps, total: 14.014, sample: 1.494, forward: 4.875, backward: 2.627, update: 5.009
[proc 3][Train](2000/10000) average pos_loss: 0.06015281619504094
[proc 3][Train](2000/10000) average neg_loss: 0.088904488068074
[proc 3][Train](2000/10000) average loss: 0.07452865217253565
[proc 3][Train](2000/10000) average regularization: 1.804607491249044e-05
[proc 3] 2000 steps, total: 14.014, sample: 1.444, forward: 4.303, backward: 2.352, update: 4.160
[proc 2][Train](2000/10000) average pos_loss: 0.05944919831305742
[proc 2][Train](2000/10000) average neg_loss: 0.08926656413823367
[proc 2][Train](2000/10000) average loss: 0.07435788124427199
[proc 2][Train](2000/10000) average regularization: 1.805459085335315e-05
[proc 2] 2000 steps, total: 14.014, sample: 1.430, forward: 4.184, backward: 2.398, update: 4.263
[proc 1][Train](2000/10000) average pos_loss: 0.05996615147590637
[proc 1][Train](2000/10000) average neg_loss: 0.08884392885863782
[proc 1][Train](2000/10000) average loss: 0.07440504009649157
[proc 1][Train](2000/10000) average regularization: 1.811289544639294e-05
[proc 1] 2000 steps, total: 14.014, sample: 1.590, forward: 4.647, backward: 2.385, update: 4.470
[proc 3][Train](3000/10000) average pos_loss: 0.05251629100367427
[proc 3][Train](3000/10000) average neg_loss: 0.07858628807216883
[proc 3][Train](3000/10000) average loss: 0.06555128943920135
[proc 3][Train](3000/10000) average regularization: 1.9944094996390048e-05
[proc 3] 3000 steps, total: 13.011, sample: 1.643, forward: 4.527, backward: 2.577, update: 4.254
[proc 1][Train](3000/10000) average pos_loss: 0.0521702382452786
[proc 1][Train](3000/10000) average neg_loss: 0.07895477952435613
[proc 1][Train](3000/10000) average loss: 0.06556250889599323
[proc 1][Train](3000/10000) average regularization: 1.99463162534812e-05
[proc 1] 3000 steps, total: 13.010, sample: 1.593, forward: 4.476, backward: 2.639, update: 4.121
[proc 0][Train](3000/10000) average pos_loss: 0.05170717818289995
[proc 0][Train](3000/10000) average neg_loss: 0.07903995157405734
[proc 0][Train](3000/10000) average loss: 0.06537356492504477
[proc 0][Train](3000/10000) average regularization: 1.99612548622099e-05
[proc 0] 3000 steps, total: 13.011, sample: 1.525, forward: 4.467, backward: 2.718, update: 4.176
[proc 2][Train](3000/10000) average pos_loss: 0.05165722277760506
[proc 2][Train](3000/10000) average neg_loss: 0.07903665216639638
[proc 2][Train](3000/10000) average loss: 0.06534693751111627
[proc 2][Train](3000/10000) average regularization: 1.991396768426057e-05
[proc 2] 3000 steps, total: 13.011, sample: 1.566, forward: 4.233, backward: 1.830, update: 4.530
[proc 1][Train](4000/10000) average pos_loss: 0.04874762006476521
[proc 1][Train](4000/10000) average neg_loss: 0.07398255675658584
[proc 1][Train](4000/10000) average loss: 0.06136508841812611
[proc 1][Train](4000/10000) average regularization: 2.1147632485735812e-05
[proc 1] 4000 steps, total: 13.757, sample: 1.494, forward: 4.451, backward: 2.720, update: 5.083
[proc 0][Train](4000/10000) average pos_loss: 0.048036800999194385
[proc 0][Train](4000/10000) average neg_loss: 0.0742559486553073
[proc 0][Train](4000/10000) average loss: 0.06114637487381697
[proc 0][Train](4000/10000) average regularization: 2.10988963208365e-05
[proc 0] 4000 steps, total: 13.757, sample: 1.391, forward: 4.228, backward: 2.684, update: 4.266
[proc 2][Train](4000/10000) average pos_loss: 0.04782762750610709
[proc 2][Train](4000/10000) average neg_loss: 0.07426489427685738
[proc 2][Train](4000/10000) average loss: 0.061046260833740235
[proc 2][Train](4000/10000) average regularization: 2.1073818441436744e-05
[proc 2] 4000 steps, total: 13.757, sample: 1.439, forward: 4.111, backward: 2.048, update: 4.674
[proc 3][Train](4000/10000) average pos_loss: 0.04812489223480225
[proc 3][Train](4000/10000) average neg_loss: 0.07372951449826359
[proc 3][Train](4000/10000) average loss: 0.060927203323692086
[proc 3][Train](4000/10000) average regularization: 2.109232494876778e-05
[proc 3] 4000 steps, total: 13.757, sample: 1.427, forward: 4.335, backward: 2.667, update: 4.384
[proc 1][Train](5000/10000) average pos_loss: 0.04568798005208373
[proc 1][Train](5000/10000) average neg_loss: 0.07110809759050608
[proc 1][Train](5000/10000) average loss: 0.058398038845509294
[proc 1][Train](5000/10000) average regularization: 2.1975284200379975e-05
[proc 1] 5000 steps, total: 13.523, sample: 1.413, forward: 4.194, backward: 2.781, update: 5.126
[proc 0][Train](5000/10000) average pos_loss: 0.046239981707185504
[proc 0][Train](5000/10000) average neg_loss: 0.0712239894233644
[proc 0][Train](5000/10000) average loss: 0.05873198556900024
[proc 0][Train](5000/10000) average regularization: 2.1972409129375593e-05
[proc 0] 5000 steps, total: 13.523, sample: 1.627, forward: 4.364, backward: 2.797, update: 4.472
[proc 2][Train](5000/10000) average pos_loss: 0.045693120162934066
[proc 2][Train](5000/10000) average neg_loss: 0.07114951135590672
[proc 2][Train](5000/10000) average loss: 0.05842131574079394
[proc 2][Train](5000/10000) average regularization: 2.1948577859802754e-05
[proc 2] 5000 steps, total: 13.523, sample: 1.463, forward: 4.080, backward: 2.709, update: 4.528
[proc 3][Train](5000/10000) average pos_loss: 0.04590197257325053
[proc 3][Train](5000/10000) average neg_loss: 0.07095540096238255
[proc 3][Train](5000/10000) average loss: 0.058428686764091256
[proc 3][Train](5000/10000) average regularization: 2.1944378428088384e-05
[proc 3] 5000 steps, total: 13.523, sample: 1.494, forward: 4.376, backward: 2.767, update: 4.458
[proc 1][Train](6000/10000) average pos_loss: 0.044334785856306555
[proc 1][Train](6000/10000) average neg_loss: 0.06910849087312818
[proc 1][Train](6000/10000) average loss: 0.056721638333052396
[proc 1][Train](6000/10000) average regularization: 2.264848878076009e-05
[proc 1] 6000 steps, total: 13.407, sample: 1.299, forward: 4.172, backward: 2.795, update: 5.132
[proc 3][Train](6000/10000) average pos_loss: 0.04432975894957781
[proc 3][Train](6000/10000) average neg_loss: 0.06893544540554285
[proc 3][Train](6000/10000) average loss: 0.05663260218128562
[proc 3][Train](6000/10000) average regularization: 2.262438508114428e-05
[proc 3] 6000 steps, total: 13.407, sample: 1.381, forward: 4.350, backward: 2.612, update: 4.417
[proc 0][Train](6000/10000) average pos_loss: 0.04415311508998275
[proc 0][Train](6000/10000) average neg_loss: 0.06917900502309203
[proc 0][Train](6000/10000) average loss: 0.05666605999320745
[proc 0][Train](6000/10000) average regularization: 2.2637124280663557e-05
[proc 0] 6000 steps, total: 13.407, sample: 1.355, forward: 4.271, backward: 2.291, update: 4.405
[proc 2][Train](6000/10000) average pos_loss: 0.044275946393609045
[proc 2][Train](6000/10000) average neg_loss: 0.06924714804068208
[proc 2][Train](6000/10000) average loss: 0.056761547170579435
[proc 2][Train](6000/10000) average regularization: 2.2639577293375624e-05
[proc 2] 6000 steps, total: 13.407, sample: 1.521, forward: 4.169, backward: 2.716, update: 4.614
[proc 1][Train](7000/10000) average pos_loss: 0.043202092863619326
[proc 1][Train](7000/10000) average neg_loss: 0.0675690694488585
[proc 1][Train](7000/10000) average loss: 0.055385581102222206
[proc 1][Train](7000/10000) average regularization: 2.321057642075175e-05
[proc 1] 7000 steps, total: 13.393, sample: 1.320, forward: 4.196, backward: 2.765, update: 5.103
[proc 2][Train](7000/10000) average pos_loss: 0.0428649684637785
[proc 2][Train](7000/10000) average neg_loss: 0.0677233954705298
[proc 2][Train](7000/10000) average loss: 0.05529418204724788
[proc 2][Train](7000/10000) average regularization: 2.3191339736513328e-05
[proc 2] 7000 steps, total: 13.392, sample: 1.365, forward: 4.045, backward: 2.766, update: 4.449
[proc 3][Train](7000/10000) average pos_loss: 0.04307773119956255
[proc 3][Train](7000/10000) average neg_loss: 0.0673753776922822
[proc 3][Train](7000/10000) average loss: 0.05522655454277992
[proc 3][Train](7000/10000) average regularization: 2.3188703877167427e-05
[proc 3] 7000 steps, total: 13.393, sample: 1.411, forward: 4.333, backward: 2.514, update: 4.382
[proc 0][Train](7000/10000) average pos_loss: 0.0430443302616477
[proc 0][Train](7000/10000) average neg_loss: 0.06765173744410276
[proc 0][Train](7000/10000) average loss: 0.055348033785820004
[proc 0][Train](7000/10000) average regularization: 2.3187361715827138e-05
[proc 0] 7000 steps, total: 13.392, sample: 1.362, forward: 4.286, backward: 1.825, update: 4.396
[proc 1][Train](8000/10000) average pos_loss: 0.042195111826062205
[proc 1][Train](8000/10000) average neg_loss: 0.06644499358162284
[proc 1][Train](8000/10000) average loss: 0.05432005285844207
[proc 1][Train](8000/10000) average regularization: 2.368438829398656e-05
[proc 1] 8000 steps, total: 13.350, sample: 1.300, forward: 4.186, backward: 2.777, update: 5.078
[proc 2][Train](8000/10000) average pos_loss: 0.042031470764428376
[proc 2][Train](8000/10000) average neg_loss: 0.06652027352526783
[proc 2][Train](8000/10000) average loss: 0.054275872126221654
[proc 2][Train](8000/10000) average regularization: 2.3671666102018206e-05
[proc 2] 8000 steps, total: 13.350, sample: 1.366, forward: 4.044, backward: 2.808, update: 4.453
[proc 3][Train](8000/10000) average pos_loss: 0.04212541034072637
[proc 3][Train](8000/10000) average neg_loss: 0.06617710810899735
[proc 3][Train](8000/10000) average loss: 0.0541512592099607
[proc 3][Train](8000/10000) average regularization: 2.3656264724195352e-05
[proc 3] 8000 steps, total: 13.350, sample: 1.389, forward: 4.312, backward: 2.445, update: 4.357
[proc 0][Train](8000/10000) average pos_loss: 0.04226281427592039
[proc 0][Train](8000/10000) average neg_loss: 0.06657381485030055
[proc 0][Train](8000/10000) average loss: 0.054418314546346665
[proc 0][Train](8000/10000) average regularization: 2.3670206664974104e-05
[proc 0] 8000 steps, total: 13.350, sample: 1.358, forward: 4.285, backward: 2.116, update: 4.433
[proc 1][Train](9000/10000) average pos_loss: 0.04141048142686486
[proc 1][Train](9000/10000) average neg_loss: 0.065617934782058
[proc 1][Train](9000/10000) average loss: 0.053514208048582076
[proc 1][Train](9000/10000) average regularization: 2.4095077913443674e-05
[proc 1] 9000 steps, total: 12.376, sample: 1.216, forward: 3.899, backward: 2.708, update: 4.547
[proc 2][Train](9000/10000) average pos_loss: 0.041188495859503745
[proc 2][Train](9000/10000) average neg_loss: 0.0656970455609262
[proc 2][Train](9000/10000) average loss: 0.05344277073815465
[proc 2][Train](9000/10000) average regularization: 2.407648965345288e-05
[proc 2] 9000 steps, total: 12.376, sample: 1.307, forward: 3.792, backward: 2.760, update: 3.870
[proc 0][Train](9000/10000) average pos_loss: 0.041670471858233214
[proc 0][Train](9000/10000) average neg_loss: 0.06551916377246379
[proc 0][Train](9000/10000) average loss: 0.05359481778740883
[proc 0][Train](9000/10000) average regularization: 2.4088546873827e-05
[proc 0] 9000 steps, total: 12.376, sample: 1.317, forward: 3.984, backward: 2.724, update: 3.758
[proc 3][Train](9000/10000) average pos_loss: 0.04146343361958861
[proc 3][Train](9000/10000) average neg_loss: 0.0652667401432991
[proc 3][Train](9000/10000) average loss: 0.053365086913108824
[proc 3][Train](9000/10000) average regularization: 2.4074586972346877e-05
[proc 3] 9000 steps, total: 12.376, sample: 1.332, forward: 3.952, backward: 2.445, update: 4.109
[proc 1][Train](10000/10000) average pos_loss: 0.04086523304134607
[proc 1][Train](10000/10000) average neg_loss: 0.06479964008927346
[proc 1][Train](10000/10000) average loss: 0.05283243662491441
[proc 1][Train](10000/10000) average regularization: 2.4452755049424014e-05
[proc 1] 10000 steps, total: 12.509, sample: 1.257, forward: 3.923, backward: 2.701, update: 4.623
proc 1 takes 135.957 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.04073593160510063
[proc 2][Train](10000/10000) average neg_loss: 0.06492541781440377
[proc 2][Train](10000/10000) average loss: 0.05283067475631833
[proc 2][Train](10000/10000) average regularization: 2.4439578781311866e-05
[proc 2] 10000 steps, total: 12.509, sample: 1.344, forward: 3.957, backward: 2.778, update: 3.960
proc 2 takes 135.945 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.041020438011735674
[proc 0][Train](10000/10000) average neg_loss: 0.0650235041603446
[proc 0][Train](10000/10000) average loss: 0.0530219710059464
[proc 0][Train](10000/10000) average regularization: 2.44474938554049e-05
[proc 0] 10000 steps, total: 12.509, sample: 1.358, forward: 4.083, backward: 2.759, update: 3.837
proc 0 takes 135.958 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.04085011694207787
[proc 3][Train](10000/10000) average neg_loss: 0.06464924650639295
[proc 3][Train](10000/10000) average loss: 0.05274968168511987
[proc 3][Train](10000/10000) average regularization: 2.443184300318535e-05
[proc 3] 10000 steps, total: 12.509, sample: 1.377, forward: 4.048, backward: 2.441, update: 4.200
proc 3 takes 135.945 seconds
Successfully xmh. training takes 136.59226608276367 seconds
-------------- Test result --------------
Test average MRR : 0.5581275356112434
Test average MR : 39.5293883631562
Test average HITS@1 : 0.42100184523708756
Test average HITS@3 : 0.6531546782685244
Test average HITS@10 : 0.7850637368590341
-----------------------------------------
testing takes 68.121 seconds
