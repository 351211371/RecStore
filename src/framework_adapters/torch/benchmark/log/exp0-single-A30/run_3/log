Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 4 parts
part 0 has 120786 edges
part 1 has 120786 edges
part 2 has 120786 edges
part 3 has 120784 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_FB15k_3', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.132 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 0][Train](1000/10000) average pos_loss: 0.14777760186046363
[proc 0][Train](1000/10000) average neg_loss: 0.1701130978167057
[proc 0][Train](1000/10000) average loss: 0.15894534964859486
[proc 0][Train](1000/10000) average regularization: 1.3462488165941976e-05
[proc 0] 1000 steps, total: 16.052, sample: 1.604, forward: 6.572, backward: 2.073, update: 5.793
[proc 3][Train](1000/10000) average pos_loss: 0.14240835212543607
[proc 3][Train](1000/10000) average neg_loss: 0.16967880776524544
[proc 3][Train](1000/10000) average loss: 0.15604358007013797
[proc 3][Train](1000/10000) average regularization: 1.3183212417061441e-05
[proc 3] 1000 steps, total: 16.012, sample: 1.620, forward: 6.099, backward: 2.458, update: 4.234
[proc 2][Train](1000/10000) average pos_loss: 0.1422028590478003
[proc 2][Train](1000/10000) average neg_loss: 0.16871233860403298
[proc 2][Train](1000/10000) average loss: 0.15545759889483451
[proc 2][Train](1000/10000) average regularization: 1.3166515044304105e-05
[proc 2] 1000 steps, total: 16.012, sample: 1.814, forward: 6.067, backward: 2.352, update: 4.487
[proc 1][Train](1000/10000) average pos_loss: 0.14212310092151165
[proc 1][Train](1000/10000) average neg_loss: 0.16899101684242487
[proc 1][Train](1000/10000) average loss: 0.15555705874413253
[proc 1][Train](1000/10000) average regularization: 1.3193249901178205e-05
[proc 1] 1000 steps, total: 16.052, sample: 1.572, forward: 6.129, backward: 2.536, update: 4.302
[proc 0][Train](2000/10000) average pos_loss: 0.059382455114275215
[proc 0][Train](2000/10000) average neg_loss: 0.08844630288332701
[proc 0][Train](2000/10000) average loss: 0.07391437900811434
[proc 0][Train](2000/10000) average regularization: 1.8081955015077255e-05
[proc 0] 2000 steps, total: 12.889, sample: 1.419, forward: 4.682, backward: 1.874, update: 4.904
[proc 3][Train](2000/10000) average pos_loss: 0.06040780138596892
[proc 3][Train](2000/10000) average neg_loss: 0.08891615723818541
[proc 3][Train](2000/10000) average loss: 0.0746619792804122
[proc 3][Train](2000/10000) average regularization: 1.8025124258201687e-05
[proc 3] 2000 steps, total: 12.888, sample: 1.495, forward: 4.428, backward: 2.366, update: 4.084
[proc 2][Train](2000/10000) average pos_loss: 0.06011106757074595
[proc 2][Train](2000/10000) average neg_loss: 0.08886315505951643
[proc 2][Train](2000/10000) average loss: 0.07448711141943931
[proc 2][Train](2000/10000) average regularization: 1.7991546610574004e-05
[proc 2] 2000 steps, total: 12.888, sample: 1.444, forward: 4.261, backward: 2.354, update: 4.242
[proc 1][Train](2000/10000) average pos_loss: 0.06021316616982222
[proc 1][Train](2000/10000) average neg_loss: 0.08903041998296976
[proc 1][Train](2000/10000) average loss: 0.07462179308384657
[proc 1][Train](2000/10000) average regularization: 1.8019834400547552e-05
[proc 1] 2000 steps, total: 12.888, sample: 1.446, forward: 4.450, backward: 2.401, update: 4.201
[proc 1][Train](3000/10000) average pos_loss: 0.052318900395184754
[proc 1][Train](3000/10000) average neg_loss: 0.07873156805336476
[proc 1][Train](3000/10000) average loss: 0.06552523430809379
[proc 1][Train](3000/10000) average regularization: 1.989468119063531e-05
[proc 1] 3000 steps, total: 12.995, sample: 1.639, forward: 4.550, backward: 2.429, update: 4.369
[proc 0][Train](3000/10000) average pos_loss: 0.051829936880618335
[proc 0][Train](3000/10000) average neg_loss: 0.07872606739401818
[proc 0][Train](3000/10000) average loss: 0.0652780021354556
[proc 0][Train](3000/10000) average regularization: 1.987882735556923e-05
[proc 0] 3000 steps, total: 12.996, sample: 1.432, forward: 4.625, backward: 2.174, update: 4.742
[proc 3][Train](3000/10000) average pos_loss: 0.05215179278701544
[proc 3][Train](3000/10000) average neg_loss: 0.07930251248925925
[proc 3][Train](3000/10000) average loss: 0.06572715261951088
[proc 3][Train](3000/10000) average regularization: 1.985492284075008e-05
[proc 3] 3000 steps, total: 12.996, sample: 1.493, forward: 4.389, backward: 2.339, update: 4.052
[proc 2][Train](3000/10000) average pos_loss: 0.05194553776830435
[proc 2][Train](3000/10000) average neg_loss: 0.07891416221112013
[proc 2][Train](3000/10000) average loss: 0.06542985004931688
[proc 2][Train](3000/10000) average regularization: 1.9832716487144353e-05
[proc 2] 3000 steps, total: 12.996, sample: 1.496, forward: 4.241, backward: 2.362, update: 4.169
[proc 0][Train](4000/10000) average pos_loss: 0.048457606632262465
[proc 0][Train](4000/10000) average neg_loss: 0.07393078134953976
[proc 0][Train](4000/10000) average loss: 0.06119419402256608
[proc 0][Train](4000/10000) average regularization: 2.106426831232966e-05
[proc 0] 4000 steps, total: 13.428, sample: 1.468, forward: 4.762, backward: 2.406, update: 4.783
[proc 1][Train](4000/10000) average pos_loss: 0.04792307243123651
[proc 1][Train](4000/10000) average neg_loss: 0.07420214917510748
[proc 1][Train](4000/10000) average loss: 0.06106261068582535
[proc 1][Train](4000/10000) average regularization: 2.1026866395914113e-05
[proc 1] 4000 steps, total: 13.428, sample: 1.571, forward: 4.510, backward: 2.166, update: 4.243
[proc 2][Train](4000/10000) average pos_loss: 0.04827105926349759
[proc 2][Train](4000/10000) average neg_loss: 0.07396298687532545
[proc 2][Train](4000/10000) average loss: 0.06111702310666442
[proc 2][Train](4000/10000) average regularization: 2.1016439946834e-05
[proc 2] 4000 steps, total: 13.428, sample: 1.553, forward: 4.321, backward: 2.330, update: 4.273
[proc 3][Train](4000/10000) average pos_loss: 0.04838607519119978
[proc 3][Train](4000/10000) average neg_loss: 0.07423463898524642
[proc 3][Train](4000/10000) average loss: 0.06131035715714097
[proc 3][Train](4000/10000) average regularization: 2.1031368800322525e-05
[proc 3] 4000 steps, total: 13.428, sample: 1.495, forward: 4.369, backward: 2.406, update: 3.984
[proc 0][Train](5000/10000) average pos_loss: 0.046106583651155233
[proc 0][Train](5000/10000) average neg_loss: 0.07084196445718408
[proc 0][Train](5000/10000) average loss: 0.058474274031817916
[proc 0][Train](5000/10000) average regularization: 2.1927644947936642e-05
[proc 0] 5000 steps, total: 13.802, sample: 1.583, forward: 4.833, backward: 2.466, update: 4.912
[proc 3][Train](5000/10000) average pos_loss: 0.046187740486115215
[proc 3][Train](5000/10000) average neg_loss: 0.07138587268069387
[proc 3][Train](5000/10000) average loss: 0.058786806650459766
[proc 3][Train](5000/10000) average regularization: 2.1900426458159927e-05
[proc 3] 5000 steps, total: 13.802, sample: 1.598, forward: 4.399, backward: 2.387, update: 4.019
[proc 1][Train](5000/10000) average pos_loss: 0.04577984810993076
[proc 1][Train](5000/10000) average neg_loss: 0.07120688854902983
[proc 1][Train](5000/10000) average loss: 0.05849336840584874
[proc 1][Train](5000/10000) average regularization: 2.1880278354728943e-05
[proc 1] 5000 steps, total: 13.803, sample: 1.660, forward: 4.566, backward: 2.151, update: 4.369
[proc 2][Train](5000/10000) average pos_loss: 0.045571982726454734
[proc 2][Train](5000/10000) average neg_loss: 0.07102825189754366
[proc 2][Train](5000/10000) average loss: 0.05830011722818017
[proc 2][Train](5000/10000) average regularization: 2.1856936962649342e-05
[proc 2] 5000 steps, total: 13.803, sample: 1.506, forward: 4.260, backward: 1.863, update: 4.226
[proc 0][Train](6000/10000) average pos_loss: 0.04433540121093393
[proc 0][Train](6000/10000) average neg_loss: 0.06896694478392601
[proc 0][Train](6000/10000) average loss: 0.056651172965765
[proc 0][Train](6000/10000) average regularization: 2.260044348804513e-05
[proc 0] 6000 steps, total: 13.861, sample: 1.565, forward: 4.873, backward: 2.450, update: 4.964
[proc 2][Train](6000/10000) average pos_loss: 0.04437525603547692
[proc 2][Train](6000/10000) average neg_loss: 0.06909712237119675
[proc 2][Train](6000/10000) average loss: 0.05673618916422129
[proc 2][Train](6000/10000) average regularization: 2.2552811546120212e-05
[proc 2] 6000 steps, total: 13.861, sample: 1.603, forward: 4.448, backward: 2.060, update: 4.496
[proc 1][Train](6000/10000) average pos_loss: 0.0442803219370544
[proc 1][Train](6000/10000) average neg_loss: 0.0692097208276391
[proc 1][Train](6000/10000) average loss: 0.05674502141028643
[proc 1][Train](6000/10000) average regularization: 2.2563064376299736e-05
[proc 1] 6000 steps, total: 13.861, sample: 1.529, forward: 4.528, backward: 2.396, update: 4.380
[proc 3][Train](6000/10000) average pos_loss: 0.04433568499237299
[proc 3][Train](6000/10000) average neg_loss: 0.069184674564749
[proc 3][Train](6000/10000) average loss: 0.05676017988845706
[proc 3][Train](6000/10000) average regularization: 2.2563067639566725e-05
[proc 3] 6000 steps, total: 13.862, sample: 1.652, forward: 4.500, backward: 2.005, update: 4.237
[proc 0][Train](7000/10000) average pos_loss: 0.04303460366651416
[proc 0][Train](7000/10000) average neg_loss: 0.06750482747703791
[proc 0][Train](7000/10000) average loss: 0.05526971548050642
[proc 0][Train](7000/10000) average regularization: 2.31482023064018e-05
[proc 0] 7000 steps, total: 13.981, sample: 1.555, forward: 4.876, backward: 2.588, update: 4.953
[proc 1][Train](7000/10000) average pos_loss: 0.04307165612652898
[proc 1][Train](7000/10000) average neg_loss: 0.06755749947577715
[proc 1][Train](7000/10000) average loss: 0.05531457781791687
[proc 1][Train](7000/10000) average regularization: 2.312590316068963e-05
[proc 1] 7000 steps, total: 13.980, sample: 1.713, forward: 4.650, backward: 2.362, update: 4.403
[proc 2][Train](7000/10000) average pos_loss: 0.04280003956705332
[proc 2][Train](7000/10000) average neg_loss: 0.06758376666158437
[proc 2][Train](7000/10000) average loss: 0.05519190306216478
[proc 2][Train](7000/10000) average regularization: 2.3107894476197545e-05
[proc 2] 7000 steps, total: 13.981, sample: 1.493, forward: 4.313, backward: 2.295, update: 4.338
[proc 3][Train](7000/10000) average pos_loss: 0.04345238824933767
[proc 3][Train](7000/10000) average neg_loss: 0.06775335322692991
[proc 3][Train](7000/10000) average loss: 0.055602870628237724
[proc 3][Train](7000/10000) average regularization: 2.3140492839957005e-05
[proc 3] 7000 steps, total: 13.980, sample: 1.741, forward: 4.681, backward: 2.477, update: 4.240
[proc 0][Train](8000/10000) average pos_loss: 0.04235469961166382
[proc 0][Train](8000/10000) average neg_loss: 0.06647668359056115
[proc 0][Train](8000/10000) average loss: 0.054415691651403905
[proc 0][Train](8000/10000) average regularization: 2.3628412614925766e-05
[proc 0] 8000 steps, total: 13.522, sample: 1.481, forward: 4.719, backward: 2.508, update: 4.806
[proc 3][Train](8000/10000) average pos_loss: 0.04245990191027522
[proc 3][Train](8000/10000) average neg_loss: 0.06654980796948075
[proc 3][Train](8000/10000) average loss: 0.054504855033010245
[proc 3][Train](8000/10000) average regularization: 2.3619618375960272e-05
[proc 3] 8000 steps, total: 13.522, sample: 1.530, forward: 4.378, backward: 2.400, update: 3.989
[proc 1][Train](8000/10000) average pos_loss: 0.041916061330586674
[proc 1][Train](8000/10000) average neg_loss: 0.0666076826043427
[proc 1][Train](8000/10000) average loss: 0.05426187194883823
[proc 1][Train](8000/10000) average regularization: 2.3586689354488044e-05
[proc 1] 8000 steps, total: 13.522, sample: 1.469, forward: 4.409, backward: 2.371, update: 3.809
[proc 2][Train](8000/10000) average pos_loss: 0.04212753929942846
[proc 2][Train](8000/10000) average neg_loss: 0.06636727468296885
[proc 2][Train](8000/10000) average loss: 0.05424740691110492
[proc 2][Train](8000/10000) average regularization: 2.358001326501835e-05
[proc 2] 8000 steps, total: 13.522, sample: 1.480, forward: 4.204, backward: 2.253, update: 4.070
[proc 3][Train](9000/10000) average pos_loss: 0.041708658918738366
[proc 3][Train](9000/10000) average neg_loss: 0.06564984329044819
[proc 3][Train](9000/10000) average loss: 0.05367925114557147
[proc 3][Train](9000/10000) average regularization: 2.4031259614275767e-05
[proc 3] 9000 steps, total: 11.934, sample: 1.523, forward: 4.148, backward: 2.481, update: 3.775
[proc 0][Train](9000/10000) average pos_loss: 0.04130677296966314
[proc 0][Train](9000/10000) average neg_loss: 0.06551198646053671
[proc 0][Train](9000/10000) average loss: 0.05340937969088554
[proc 0][Train](9000/10000) average regularization: 2.4034706515521977e-05
[proc 0] 9000 steps, total: 11.934, sample: 1.377, forward: 4.146, backward: 2.690, update: 3.649
[proc 2][Train](9000/10000) average pos_loss: 0.04153767573460936
[proc 2][Train](9000/10000) average neg_loss: 0.06550771993771196
[proc 2][Train](9000/10000) average loss: 0.053522697873413565
[proc 2][Train](9000/10000) average regularization: 2.4001502753890236e-05
[proc 2] 9000 steps, total: 11.934, sample: 1.414, forward: 4.057, backward: 2.437, update: 3.722
[proc 1][Train](9000/10000) average pos_loss: 0.04144942447170615
[proc 1][Train](9000/10000) average neg_loss: 0.0656854607500136
[proc 1][Train](9000/10000) average loss: 0.05356744264811277
[proc 1][Train](9000/10000) average regularization: 2.3998879909413516e-05
[proc 1] 9000 steps, total: 11.934, sample: 1.415, forward: 4.126, backward: 2.334, update: 3.552
[proc 3][Train](10000/10000) average pos_loss: 0.041097969084978106
[proc 3][Train](10000/10000) average neg_loss: 0.06498138894513249
[proc 3][Train](10000/10000) average loss: 0.053039679009467364
[proc 3][Train](10000/10000) average regularization: 2.439141164359171e-05
[proc 3] 10000 steps, total: 11.669, sample: 1.384, forward: 3.964, backward: 2.729, update: 3.584
proc 3 takes 134.096 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.04086015984043479
[proc 2][Train](10000/10000) average neg_loss: 0.06466134839504957
[proc 2][Train](10000/10000) average loss: 0.052760754149407146
[proc 2][Train](10000/10000) average regularization: 2.4370095299673266e-05
[proc 2] 10000 steps, total: 11.670, sample: 1.396, forward: 3.968, backward: 2.705, update: 3.593
proc 2 takes 134.096 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.040740758083760736
[proc 1][Train](10000/10000) average neg_loss: 0.0648813503421843
[proc 1][Train](10000/10000) average loss: 0.05281105422601104
[proc 1][Train](10000/10000) average regularization: 2.436219089941005e-05
[proc 1] 10000 steps, total: 11.669, sample: 1.399, forward: 3.969, backward: 2.455, update: 3.333
proc 1 takes 134.136 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.04084492759034038
[proc 0][Train](10000/10000) average neg_loss: 0.06470729580149054
[proc 0][Train](10000/10000) average loss: 0.05277611169219017
[proc 0][Train](10000/10000) average regularization: 2.4393232493821414e-05
[proc 0] 10000 steps, total: 11.670, sample: 1.403, forward: 4.076, backward: 2.734, update: 3.428
proc 0 takes 134.136 seconds
Successfully xmh. training takes 134.7043924331665 seconds
-------------- Test result --------------
Test average MRR : 0.5583554548340088
Test average MR : 39.57535000253932
Test average HITS@1 : 0.422390005247922
Test average HITS@3 : 0.6512163328875421
Test average HITS@10 : 0.7862318227218094
-----------------------------------------
testing takes 68.145 seconds
