Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=-1, format='built_in', gamma=16.0, gpu=[0], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=False, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=1, num_proc=1, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_10', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.894 seconds
[proc 0][Train](1000/10000) average pos_loss: 0.3075091523453593
[proc 0][Train](1000/10000) average neg_loss: 0.31463877080380914
[proc 0][Train](1000/10000) average loss: 0.311073961764574
[proc 0][Train](1000/10000) average regularization: 8.987219306845872e-06
[proc 0] 1000 steps, total: 6.891, sample: 1.246, forward: 2.113, backward: 1.855, update: 1.673
[proc 0][Train](2000/10000) average pos_loss: 0.10414005011320114
[proc 0][Train](2000/10000) average neg_loss: 0.13847408066689967
[proc 0][Train](2000/10000) average loss: 0.12130706543475389
[proc 0][Train](2000/10000) average regularization: 1.311609411277459e-05
[proc 0] 2000 steps, total: 7.145, sample: 1.402, forward: 2.239, backward: 1.757, update: 1.743
[proc 0][Train](3000/10000) average pos_loss: 0.08048693683743477
[proc 0][Train](3000/10000) average neg_loss: 0.1130914581567049
[proc 0][Train](3000/10000) average loss: 0.09678919749706984
[proc 0][Train](3000/10000) average regularization: 1.5053563908622891e-05
[proc 0] 3000 steps, total: 6.798, sample: 1.217, forward: 2.099, backward: 1.803, update: 1.675
[proc 0][Train](4000/10000) average pos_loss: 0.07026033940538765
[proc 0][Train](4000/10000) average neg_loss: 0.1013922311142087
[proc 0][Train](4000/10000) average loss: 0.0858262853100896
[proc 0][Train](4000/10000) average regularization: 1.6309109056237503e-05
[proc 0] 4000 steps, total: 6.766, sample: 1.235, forward: 2.092, backward: 1.722, update: 1.714
[proc 0][Train](5000/10000) average pos_loss: 0.06439063597470522
[proc 0][Train](5000/10000) average neg_loss: 0.09438380254805089
[proc 0][Train](5000/10000) average loss: 0.07938721938431263
[proc 0][Train](5000/10000) average regularization: 1.7229914310519233e-05
[proc 0] 5000 steps, total: 7.101, sample: 1.360, forward: 2.268, backward: 1.748, update: 1.720
[proc 0][Train](6000/10000) average pos_loss: 0.060512650333344936
[proc 0][Train](6000/10000) average neg_loss: 0.08968280763924122
[proc 0][Train](6000/10000) average loss: 0.07509772896021605
[proc 0][Train](6000/10000) average regularization: 1.7954818211364907e-05
[proc 0] 6000 steps, total: 7.329, sample: 1.455, forward: 2.278, backward: 1.889, update: 1.703
[proc 0][Train](7000/10000) average pos_loss: 0.057670028634369375
[proc 0][Train](7000/10000) average neg_loss: 0.08615375328436493
[proc 0][Train](7000/10000) average loss: 0.07191189090907574
[proc 0][Train](7000/10000) average regularization: 1.855712733049586e-05
[proc 0] 7000 steps, total: 6.748, sample: 1.306, forward: 2.028, backward: 1.732, update: 1.677
[proc 0][Train](8000/10000) average pos_loss: 0.05543147820979357
[proc 0][Train](8000/10000) average neg_loss: 0.08336733170598745
[proc 0][Train](8000/10000) average loss: 0.06939940490573644
[proc 0][Train](8000/10000) average regularization: 1.906439086997125e-05
[proc 0] 8000 steps, total: 6.886, sample: 1.277, forward: 2.142, backward: 1.778, update: 1.684
[proc 0][Train](9000/10000) average pos_loss: 0.05363347028568387
[proc 0][Train](9000/10000) average neg_loss: 0.08106076738238335
[proc 0][Train](9000/10000) average loss: 0.067347118742764
[proc 0][Train](9000/10000) average regularization: 1.950255125120748e-05
[proc 0] 9000 steps, total: 7.232, sample: 1.384, forward: 2.325, backward: 1.749, update: 1.769
[proc 0][Train](10000/10000) average pos_loss: 0.05223739518225193
[proc 0][Train](10000/10000) average neg_loss: 0.07926995624601842
[proc 0][Train](10000/10000) average loss: 0.06575367571786046
[proc 0][Train](10000/10000) average regularization: 1.988547382825345e-05
[proc 0] 10000 steps, total: 7.147, sample: 1.393, forward: 2.225, backward: 1.822, update: 1.703
proc 0 takes 70.044 seconds
Successfully xmh. training takes 70.04426169395447 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[0]Test average MRR: 0.5077712182194497
[0]Test average MR: 52.56949264444482
[0]Test average HITS@1: 0.3649760457754228
[0]Test average HITS@3: 0.6066005315637115
[0]Test average HITS@10: 0.7397115335782364
testing takes 324.671 seconds
