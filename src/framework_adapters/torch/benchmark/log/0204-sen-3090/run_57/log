WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 15:16:44.830484 56849 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_117', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=12, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [56849 sampler.py:454] Start PreSampling
WARNING [56849 sampler.py:532] Before construct renumbering_dict
WARNING [56849 sampler.py:555] PreSampling done
W20240205 15:36:26.917941 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 15:36:26.918159 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 15:36:26.918195 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 15:36:26.918219 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 15:36:26.918243 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 15:36:26.918262 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 15:36:26.918280 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 15:36:26.918316 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 15:36:26.918344 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 15:36:26.918365 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 15:36:26.918401 56849 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 15:36:26.918423 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 15:36:26.918439 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 15:36:26.918593 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 15:36:26.918632 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 15:36:26.918651 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 15:36:26.918694 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 15:36:26.918710 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 15:36:26.918735 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 15:36:26.918756 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 15:36:26.918782 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 15:36:26.918810 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 15:36:26.918833 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 15:36:26.918851 56849 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 15:36:26.918866 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 15:36:26.918881 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 15:36:26.918929 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 15:36:26.918952 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 15:36:26.918969 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 15:36:26.918985 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 15:36:26.919003 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 15:36:26.919018 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 15:36:26.919039 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 15:36:26.919064 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 15:36:26.919083 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 15:36:26.919106 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 15:36:26.919128 56849 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 15:36:26.919142 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 15:36:26.919162 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 15:36:26.919207 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 15:36:26.919239 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 15:36:26.919260 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 15:36:26.919277 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 15:36:26.919294 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 15:36:26.919314 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 15:36:26.919339 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 15:36:26.919361 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 15:36:26.919378 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 15:36:26.919396 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 15:36:26.919417 56849 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 15:36:26.919432 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 15:36:26.919446 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 15:36:26.919486 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 15:36:26.919515 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 15:36:26.919533 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 15:36:26.919553 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 15:36:26.919579 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 15:36:26.919595 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 15:36:26.919617 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 15:36:26.919636 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 15:36:26.919656 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 15:36:26.919685 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 15:36:26.919704 56849 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 15:36:26.919719 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 15:36:26.919732 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 15:36:26.919767 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 15:36:26.919786 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 15:36:26.919803 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 15:36:26.919821 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 15:36:26.919838 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 15:36:26.919857 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 15:36:26.919874 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 15:36:26.919893 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 15:36:26.919909 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 15:36:26.919929 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 15:36:26.919945 56849 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 15:36:26.919960 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 15:36:26.919973 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 15:36:26.920008 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 15:36:26.920028 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 15:36:26.920059 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 15:36:26.920079 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 15:36:26.920099 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 15:36:26.920122 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 15:36:26.920145 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 15:36:26.920168 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 15:36:26.920197 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 15:36:26.920222 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 15:36:26.920240 56849 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 15:36:26.920254 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 15:36:26.920274 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 15:36:26.920316 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 15:36:26.920337 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 15:36:26.920359 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 15:36:26.920382 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 15:36:26.920406 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 15:36:26.920424 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 15:36:26.920451 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 15:36:26.920475 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 15:36:26.920495 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 15:36:26.920516 56849 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 15:36:26.920534 56849 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 15:36:26.920549 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 15:36:26.920567 56849 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 15:36:27.325167 56849 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 15:39:25.401751 56849 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302713,  4302737,    93612,  ..., 70750162, 48599090,  5202323]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1872.694 seconds
[Rank1] pid = 38803
[Rank2] pid = 38897
[Rank3] pid = 38964
[Rank4] pid = 39032
[Rank5] pid = 39101
[Rank6] pid = 39168
INFO [56849 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [38803 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38897 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38964 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [39032 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [39101 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [39168 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [39236 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [38964 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39032 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39101 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56849 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38897 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39236 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39168 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38803 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 15:48:07.737351 38965 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 15:48:07.740873 39237 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 15:48:07.741515 39300 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 15:48:07.741605 39169 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 15:48:07.741649 38898 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 15:48:07.741823 39033 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 15:48:07.741997 39102 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 15:48:07.742082 38804 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 15:48:07.802862 39300 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497a9000 7.629 MB
W20240205 15:48:07.803072 39300 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x102049f4c000 7.629 MB
W20240205 15:48:07.803125 39300 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204a6ef000 1.49 GB
W20240205 15:48:07.803164 39300 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1020a9cd2000 1.49 GB
W20240205 15:48:07.803220 39300 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 15:48:07.814190 39033 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1021092b5000 7.629 MB
W20240205 15:48:07.814206 39102 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102109a58000 7.629 MB
W20240205 15:48:07.814208 38804 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10210a1fb000 7.629 MB
W20240205 15:48:07.816337 38804 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210a99e000 7.629 MB
W20240205 15:48:07.816466 38804 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10210b141000 1.49 GB
W20240205 15:48:07.816536 38804 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10216a724000 1.49 GB
W20240205 15:48:07.816670 39033 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1021c9d07000 7.629 MB
W20240205 15:48:07.816695 39102 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021ca4aa000 7.629 MB
W20240205 15:48:07.816711 38804 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 15:48:07.816740 39033 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cac4d000 1.49 GB
W20240205 15:48:07.816780 39033 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10222a230000 1.49 GB
W20240205 15:48:07.816812 39102 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x102289813000 1.49 GB
W20240205 15:48:07.816859 39033 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 15:48:07.816874 39102 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1022e8df6000 1.49 GB
W20240205 15:48:07.816926 39102 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 15:48:07.822666 39169 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1023483db000 7.629 MB
W20240205 15:48:07.822808 39169 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102348b80000 7.629 MB
W20240205 15:48:07.822871 39169 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102349323000 1.49 GB
W20240205 15:48:07.822868 39300 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 15:48:07.822925 39169 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023a8906000 1.49 GB
W20240205 15:48:07.822984 39169 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 15:48:07.823175 38804 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 15:48:07.824741 39033 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 15:48:07.826210 39102 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 15:48:07.833995 39169 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 15:48:07.858626 39237 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102407efd000 7.629 MB
W20240205 15:48:07.858810 39237 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1024086a0000 7.629 MB
W20240205 15:48:07.858963 39237 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102408e43000 1.49 GB
W20240205 15:48:07.859035 39237 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102468426000 1.49 GB
W20240205 15:48:07.859123 39237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 15:48:07.880268 38965 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1024c7a0b000 7.629 MB
W20240205 15:48:07.880404 38965 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1024c81ae000 7.629 MB
W20240205 15:48:07.880465 38965 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1024c8951000 1.49 GB
W20240205 15:48:07.880535 38965 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102527f34000 1.49 GB
W20240205 15:48:07.880592 38965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 15:48:07.883323 39237 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 15:48:07.883558 38898 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10258751b000 7.629 MB
W20240205 15:48:07.883726 38898 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102587cbe000 7.629 MB
W20240205 15:48:07.883823 38898 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102588461000 1.49 GB
W20240205 15:48:07.883910 38898 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a44000 1.49 GB
W20240205 15:48:07.884023 38898 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 15:48:07.885485 38965 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 15:48:07.890661 38898 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [39101 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 39236
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [56849 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [38803 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [38964 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [39236 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [39168 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [39032 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [38897 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 15:48:57.097945 38898 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.098127 38804 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.098212 39169 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.098474 38965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.098559 39300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.098839 39102 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.099037 39033 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 15:48:57.099081 39237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 15:48:57.102002 39237 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 12,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 15:48:57.102305 39237 grad_base.h:184] Init GradProcessingBase done
I20240205 15:49:09.911314 39237 grad_async_v1.h:203] Use main thread to update emb.
W20240205 15:49:09.911543 39237 kg_controller.h:75] after init GradAsyncProcessing
I20240205 15:49:09.911554 39237 kg_controller.h:84] Construct KGCacheController done
E20240205 15:49:11.649483 39237 recstore.cc:66] init folly done
E20240205 15:49:11.649498 39300 recstore.cc:66] init folly done
E20240205 15:49:11.649583 38898 recstore.cc:66] init folly done
E20240205 15:49:11.649583 39033 recstore.cc:66] init folly done
E20240205 15:49:11.649588 39102 recstore.cc:66] init folly done
E20240205 15:49:11.649591 38804 recstore.cc:66] init folly done
E20240205 15:49:11.649598 38965 recstore.cc:66] init folly done
E20240205 15:49:11.649608 39169 recstore.cc:66] init folly done
I20240205 15:49:11.650703 39237 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 15:49:33.330873 39102 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 15:49:33.569520 39033 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:33.635275 39300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:35.197908 38898 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:35.606513 38965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:35.614627 38804 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:35.999205 39237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 15:49:37.166582 39169 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 15:49:39.446554 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 15:49:40.560252 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240205 15:49:41.571359 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.992 ms                  | 281.142 ms                |
| ProcessBack:UpdateCache   | 12.152 ms                 | 709.074 ms                |
| ProcessBack:UpsertPq      | 43.609 ms                 | 66.642 ms                 |
| ProcessOneStep            | 79.543 ms                 | 1.286 s                   |
| BlockToStepN              | 8.278 ms                  | 874.121 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.354 ms                  | 7.023 ms                  |
| Forward                   | 6.414 ms                  | 746.231 ms                |
| Backward                  | 10.666 ms                 | 220.079 ms                |
| Optimize                  | 4.355 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 10.780 ms                 | 14.656 ms                 |
| AfterBackward             | 79.588 ms                 | 1.286 s                   |
| BlockToStepN              | 8.330 ms                  | 875.874 ms                |
| OneStep                   | 121.355 ms                | 3.157 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:49:42.674578 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240205 15:49:43.873906 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240205 15:49:44.928439 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240205 15:49:46.052244 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.017 ms                  | 281.142 ms                |
| ProcessBack:UpdateCache   | 11.483 ms                 | 709.074 ms                |
| ProcessBack:UpsertPq      | 44.911 ms                 | 75.265 ms                 |
| ProcessOneStep            | 78.281 ms                 | 1.286 s                   |
| BlockToStepN              | 8.278 ms                  | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.626 ms                  | 94.339 ms                 |
| Forward                   | 6.224 ms                  | 746.231 ms                |
| Backward                  | 10.500 ms                 | 220.079 ms                |
| Optimize                  | 2.655 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 7.708 ms                  | 21.453 ms                 |
| AfterBackward             | 78.070 ms                 | 1.286 s                   |
| BlockToStepN              | 8.330 ms                  | 877.028 ms                |
| OneStep                   | 199.859 ms                | 3.157 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:49:47.108114 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240205 15:49:48.155637 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240205 15:49:49.195127 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 15:49:50.234879 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240205 15:49:51.400012 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.017 ms                  | 281.142 ms                |
| ProcessBack:UpdateCache   | 9.509 ms                  | 709.074 ms                |
| ProcessBack:UpsertPq      | 39.817 ms                 | 75.265 ms                 |
| ProcessOneStep            | 66.408 ms                 | 1.286 s                   |
| BlockToStepN              | 8.278 ms                  | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.918 ms                 | 198.908 ms                |
| Forward                   | 5.853 ms                  | 746.231 ms                |
| Backward                  | 10.309 ms                 | 220.079 ms                |
| Optimize                  | 2.759 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 1.054 ms                  | 21.453 ms                 |
| AfterBackward             | 66.454 ms                 | 1.286 s                   |
| BlockToStepN              | 8.330 ms                  | 877.028 ms                |
| OneStep                   | 199.859 ms                | 3.157 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:49:52.474457 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240205 15:49:53.474006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240205 15:49:54.474009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 15:49:55.474007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 15:49:56.474009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.689 ms                  | 248.133 ms                |
| ProcessBack:UpdateCache   | 9.389 ms                  | 708.288 ms                |
| ProcessBack:UpsertPq      | 35.086 ms                 | 71.577 ms                 |
| ProcessOneStep            | 54.295 ms                 | 1.286 s                   |
| BlockToStepN              | 10.582 ms                 | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.918 ms                 | 198.908 ms                |
| Forward                   | 5.403 ms                  | 746.231 ms                |
| Backward                  | 10.267 ms                 | 220.079 ms                |
| Optimize                  | 2.553 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 53.275 us                 | 21.453 ms                 |
| AfterBackward             | 54.324 ms                 | 1.286 s                   |
| BlockToStepN              | 10.629 ms                 | 877.028 ms                |
| OneStep                   | 199.859 ms                | 3.157 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:49:57.474010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240205 15:49:58.474009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240205 15:49:59.489224 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 15:50:00.541239 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240205 15:50:01.574973 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.415 ms                  | 248.133 ms                |
| ProcessBack:UpdateCache   | 9.385 ms                  | 708.288 ms                |
| ProcessBack:UpsertPq      | 33.522 ms                 | 71.577 ms                 |
| ProcessOneStep            | 53.271 ms                 | 1.286 s                   |
| BlockToStepN              | 10.582 ms                 | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.454 ms                 | 198.908 ms                |
| Forward                   | 5.360 ms                  | 746.231 ms                |
| Backward                  | 10.202 ms                 | 220.079 ms                |
| Optimize                  | 2.496 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 53.275 us                 | 23.804 ms                 |
| AfterBackward             | 53.303 ms                 | 1.286 s                   |
| BlockToStepN              | 10.629 ms                 | 877.028 ms                |
| OneStep                   | 199.859 ms                | 3.157 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:02.581873 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240205 15:50:03.610342 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 15:50:04.637465 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240205 15:50:05.637008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240205 15:50:06.637007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 248.133 ms                |
| ProcessBack:UpdateCache   | 9.345 ms                  | 708.288 ms                |
| ProcessBack:UpsertPq      | 32.770 ms                 | 71.577 ms                 |
| ProcessOneStep            | 53.271 ms                 | 88.809 ms                 |
| BlockToStepN              | 12.728 ms                 | 874.121 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.795 ms                 | 177.495 ms                |
| Forward                   | 5.287 ms                  | 9.897 ms                  |
| Backward                  | 10.209 ms                 | 11.359 ms                 |
| Optimize                  | 2.496 ms                  | 5.210 ms                  |
| BarrierTimeBeforeRank0    | 46.745 us                 | 23.804 ms                 |
| AfterBackward             | 53.303 ms                 | 88.858 ms                 |
| BlockToStepN              | 12.782 ms                 | 875.874 ms                |
| OneStep                   | 199.859 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:07.637007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240205 15:50:08.637010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240205 15:50:09.637006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240205 15:50:10.637009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240205 15:50:11.637009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.505 ms                  | 248.133 ms                |
| ProcessBack:UpdateCache   | 9.397 ms                  | 708.288 ms                |
| ProcessBack:UpsertPq      | 32.466 ms                 | 71.577 ms                 |
| ProcessOneStep            | 53.720 ms                 | 88.809 ms                 |
| BlockToStepN              | 12.728 ms                 | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.078 ms                 | 177.495 ms                |
| Forward                   | 5.320 ms                  | 9.897 ms                  |
| Backward                  | 10.237 ms                 | 11.665 ms                 |
| Optimize                  | 2.502 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 55.471 us                 | 23.804 ms                 |
| AfterBackward             | 53.753 ms                 | 88.858 ms                 |
| BlockToStepN              | 12.782 ms                 | 877.028 ms                |
| OneStep                   | 199.859 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:12.637006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 15:50:13.637008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240205 15:50:14.737738 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240205 15:50:15.737010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 21.685 ms                 |
| ProcessBack:UpdateCache   | 9.477 ms                  | 30.881 ms                 |
| ProcessBack:UpsertPq      | 33.212 ms                 | 66.642 ms                 |
| ProcessOneStep            | 54.501 ms                 | 92.152 ms                 |
| BlockToStepN              | 12.728 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:16.737005 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.603 ms                 | 177.495 ms                |
| Forward                   | 5.325 ms                  | 9.897 ms                  |
| Backward                  | 10.191 ms                 | 11.665 ms                 |
| Optimize                  | 2.496 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 56.036 us                 | 23.804 ms                 |
| AfterBackward             | 54.849 ms                 | 92.195 ms                 |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 199.859 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:17.737008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240205 15:50:18.737010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240205 15:50:19.737010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240205 15:50:20.737010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.424 ms                  | 21.685 ms                 |
| ProcessBack:UpdateCache   | 9.477 ms                  | 30.881 ms                 |
| ProcessBack:UpsertPq      | 33.052 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.861 ms                 | 92.152 ms                 |
| BlockToStepN              | 12.728 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:21.737005 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.284 ms                 | 177.495 ms                |
| Forward                   | 5.267 ms                  | 9.897 ms                  |
| Backward                  | 10.055 ms                 | 11.665 ms                 |
| Optimize                  | 2.483 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 87.217 us                 | 26.812 ms                 |
| AfterBackward             | 55.902 ms                 | 92.195 ms                 |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 199.859 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:22.737007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 15:50:23.737006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240205 15:50:24.747965 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240205 15:50:25.765431 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.403 ms                  | 21.685 ms                 |
| ProcessBack:UpdateCache   | 9.509 ms                  | 30.881 ms                 |
| ProcessBack:UpsertPq      | 32.788 ms                 | 66.642 ms                 |
| ProcessOneStep            | 54.501 ms                 | 92.152 ms                 |
| BlockToStepN              | 395.107 ms                | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:26.775568 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.603 ms                 | 177.495 ms                |
| Forward                   | 5.285 ms                  | 9.897 ms                  |
| Backward                  | 8.562 ms                  | 11.665 ms                 |
| Optimize                  | 2.476 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 55.471 us                 | 26.812 ms                 |
| AfterBackward             | 55.246 ms                 | 116.187 ms                |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:27.851167 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.146, sample: 1.432, forward: 1.247, backward: 1.141, update: 0.271
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 51.615, sample: 1.393, forward: 1.230, backward: 1.236, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.451, sample: 1.398, forward: 1.235, backward: 1.202, update: 0.286
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 53.584, sample: 1.358, forward: 1.278, backward: 1.285, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.167, sample: 1.316, forward: 1.234, backward: 1.023, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.175, sample: 1.341, forward: 1.235, backward: 1.043, update: 0.243
train_sampler.Prefill()
-------Step 0-------
tensor([   65739,    65779,    65827,    65866,  6058517,   138120, 67777625,
        20235318, 24229646,    65898]) tensor([ 5332222, 15182842, 72503644, 66433235, 17367397, 37799788, 30313027,
        83709703, 75985762, 25255818])
-------Step 1-------
tensor([   65739,    65779,    65827,    65866,  6058517,   138120, 67777625,
        20235318, 24229646,    65898]) tensor([77515259, 30470649,  9477673, 81330980, 84971134, 50770057, 78927844,
        40478687, 43092575, 14991787])
-------Step 2-------
tensor([  163644,   163689,   163722,    18450,   163781,   163829,   163866,
        23697284,   163902,   163935]) tensor([61799633, 28094101, 66316952, 59047400, 46138232, 32434227, 77708906,
        46421805, 15721784, 49677193])
-------Step 3-------
tensor([  163644,   163689,   163722,    18450,   163781,   163829,   163866,
        23697284,   163902,   163935]) tensor([56825212, 82850060, 40118153, 46506591, 51925370, 54611875, 32983201,
        18699796, 22875489,   763479])
-------Step 4-------
tensor([  260269, 55668715,   260310,   175163,   260361,   175210,   260394,
        48672866,   260439,   260480]) tensor([80959580, 11260468, 67135334, 15524141, 75788334, 51149357, 63671691,
        45607537, 83346769, 41558689])
-------Step 5-------
tensor([  260269, 55668715,   260310,   175163,   260361,   175210,   260394,
        48672866,   260439,   260480]) tensor([41480139, 67428642,   315984, 85290086, 51000152, 65539356, 16493193,
         8383442, 79998482, 47073906])
-------Step 6-------
tensor([  356156,    38516,   356195,   356232,    38540, 73356122,   356262,
          356306,   193587, 44170751]) tensor([11335272, 44561440, 41495556, 68854708, 39224886, 30350832, 23021388,
         6432291, 58744936, 82380195])
-------Step 7-------
tensor([  356156,    38516,   356195,   356232,    38540, 73356122,   356262,
          356306,   193587, 44170751]) tensor([29234217, 45002364, 79778126, 61127479, 69871419, 61366314, 47436464,
        65657446, 41213837, 27329374])
-------Step 8-------
tensor([  413532, 28901534,   413554,   210535,   413573,    48176,   413593,
          413615,   413634,   413654]) tensor([51662838, 22258415, 39437155,  2026114, 42781770, 75727072, 12740756,
        76242072,  1582486, 73613784])
-------Step 9-------
tensor([  413532, 28901534,   413554,   210535,   413573,    48176,   413593,
          413615,   413634,   413654]) tensor([48934158, 33802850, 13222215, 45973520, 10032765, 47954983, 27459573,
        38730855, 71627807, 75531926])
before start barrier
start train
[proc 0] 100 steps, total: 52.782, sample: 2.737, forward: 1.279, backward: 1.006, update: 0.306
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.212, sample: 1.852, forward: 1.296, backward: 1.211, update: 0.280
W20240205 15:50:28.869711 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 15:50:30.055339 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 15:50:31.125269 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.393 ms                  | 21.685 ms                 |
| ProcessBack:UpdateCache   | 9.509 ms                  | 30.881 ms                 |
| ProcessBack:UpsertPq      | 33.173 ms                 | 71.577 ms                 |
| ProcessOneStep            | 55.861 ms                 | 116.130 ms                |
| BlockToStepN              | 12.728 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.603 ms                 | 192.295 ms                |
| Forward                   | 5.268 ms                  | 9.897 ms                  |
| Backward                  | 7.912 ms                  | 11.665 ms                 |
| Optimize                  | 2.443 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 56.036 us                 | 26.812 ms                 |
| AfterBackward             | 55.659 ms                 | 116.187 ms                |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:32.125005 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 15:50:33.125007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240205 15:50:34.125008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 15:50:35.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240205 15:50:36.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.340 ms                  | 21.685 ms                 |
| ProcessBack:UpdateCache   | 9.509 ms                  | 30.881 ms                 |
| ProcessBack:UpsertPq      | 32.770 ms                 | 71.577 ms                 |
| ProcessOneStep            | 54.451 ms                 | 116.130 ms                |
| BlockToStepN              | 12.728 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.094 ms                 | 192.295 ms                |
| Forward                   | 5.251 ms                  | 11.209 ms                 |
| Backward                  | 7.440 ms                  | 11.665 ms                 |
| Optimize                  | 2.462 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 53.392 us                 | 26.812 ms                 |
| AfterBackward             | 54.399 ms                 | 116.187 ms                |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:37.125006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 15:50:38.125008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240205 15:50:39.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240205 15:50:40.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240205 15:50:41.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.340 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.389 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 32.466 ms                 | 66.642 ms                 |
| ProcessOneStep            | 54.295 ms                 | 116.130 ms                |
| BlockToStepN              | 12.728 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.909 ms                 | 192.295 ms                |
| Forward                   | 5.251 ms                  | 11.209 ms                 |
| Backward                  | 8.016 ms                  | 11.665 ms                 |
| Optimize                  | 2.443 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 45.044 us                 | 26.812 ms                 |
| AfterBackward             | 54.324 ms                 | 116.187 ms                |
| BlockToStepN              | 12.782 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:42.125005 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 15:50:43.125011 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 15:50:44.125011 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240205 15:50:45.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240205 15:50:46.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.380 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.471 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 32.466 ms                 | 66.642 ms                 |
| ProcessOneStep            | 54.451 ms                 | 116.130 ms                |
| BlockToStepN              | 395.107 ms                | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.415 ms                 | 192.295 ms                |
| Forward                   | 5.268 ms                  | 11.209 ms                 |
| Backward                  | 7.912 ms                  | 11.665 ms                 |
| Optimize                  | 2.422 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 53.392 us                 | 33.822 ms                 |
| AfterBackward             | 54.486 ms                 | 116.187 ms                |
| BlockToStepN              | 81.768 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:47.125005 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 15:50:48.125025 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 15:50:49.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240205 15:50:50.125010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 15:50:51.125007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.403 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.543 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 32.959 ms                 | 67.686 ms                 |
| ProcessOneStep            | 55.266 ms                 | 116.130 ms                |
| BlockToStepN              | 82.259 ms                 | 914.352 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.653 ms                 | 192.295 ms                |
| Forward                   | 5.207 ms                  | 11.209 ms                 |
| Backward                  | 6.497 ms                  | 11.665 ms                 |
| Optimize                  | 2.437 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 67.637 us                 | 33.822 ms                 |
| AfterBackward             | 55.306 ms                 | 116.187 ms                |
| BlockToStepN              | 84.680 ms                 | 914.474 ms                |
| OneStep                   | 236.529 ms                | 1.100 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:52.173493 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 15:50:53.173008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240205 15:50:54.188798 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240205 15:50:55.188010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 15:50:56.188011 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.415 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.678 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 33.018 ms                 | 67.686 ms                 |
| ProcessOneStep            | 55.526 ms                 | 92.152 ms                 |
| BlockToStepN              | 124.324 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.619 ms                 | 177.495 ms                |
| Forward                   | 5.187 ms                  | 9.897 ms                  |
| Backward                  | 6.238 ms                  | 11.359 ms                 |
| Optimize                  | 2.422 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 339.603 us                | 26.812 ms                 |
| AfterBackward             | 55.586 ms                 | 92.195 ms                 |
| BlockToStepN              | 124.388 ms                | 877.028 ms                |
| OneStep                   | 236.529 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:50:57.188010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240205 15:50:58.188010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 15:50:59.188010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240205 15:51:00.188009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240205 15:51:01.188022 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.434 ms                  | 19.607 ms                 |
| ProcessBack:UpdateCache   | 9.807 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 33.052 ms                 | 67.686 ms                 |
| ProcessOneStep            | 55.526 ms                 | 92.152 ms                 |
| BlockToStepN              | 124.324 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.107 ms                 | 177.495 ms                |
| Forward                   | 5.180 ms                  | 11.209 ms                 |
| Backward                  | 6.025 ms                  | 11.359 ms                 |
| Optimize                  | 2.411 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 59.224 us                 | 26.812 ms                 |
| AfterBackward             | 55.586 ms                 | 92.195 ms                 |
| BlockToStepN              | 124.388 ms                | 877.028 ms                |
| OneStep                   | 236.529 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:02.242777 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 15:51:03.242009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 15:51:04.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240205 15:51:05.242008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 15:51:06.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.434 ms                  | 19.607 ms                 |
| ProcessBack:UpdateCache   | 9.807 ms                  | 30.215 ms                 |
| ProcessBack:UpsertPq      | 33.513 ms                 | 67.686 ms                 |
| ProcessOneStep            | 55.618 ms                 | 92.152 ms                 |
| BlockToStepN              | 124.324 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.715 ms                 | 177.495 ms                |
| Forward                   | 5.177 ms                  | 11.209 ms                 |
| Backward                  | 6.238 ms                  | 11.359 ms                 |
| Optimize                  | 2.437 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 87.217 us                 | 33.822 ms                 |
| AfterBackward             | 55.659 ms                 | 92.195 ms                 |
| BlockToStepN              | 124.388 ms                | 877.028 ms                |
| OneStep                   | 236.529 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:07.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 15:51:08.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240205 15:51:09.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240205 15:51:10.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240205 15:51:11.242008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 9.604 ms                  | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.212 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.618 ms                 | 92.152 ms                 |
| BlockToStepN              | 124.324 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.620 ms                 | 177.495 ms                |
| Forward                   | 5.159 ms                  | 11.209 ms                 |
| Backward                  | 6.497 ms                  | 11.359 ms                 |
| Optimize                  | 2.443 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 72.348 us                 | 33.822 ms                 |
| AfterBackward             | 55.659 ms                 | 92.195 ms                 |
| BlockToStepN              | 124.388 ms                | 877.028 ms                |
| OneStep                   | 236.529 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:12.242007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240205 15:51:13.242009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240205 15:51:14.242008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240205 15:51:15.242010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240205 15:51:16.292039 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.434 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 9.678 ms                  | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.052 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.696 ms                 | 92.152 ms                 |
| BlockToStepN              | 138.138 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.294 ms                 | 177.495 ms                |
| Forward                   | 5.146 ms                  | 11.209 ms                 |
| Backward                  | 6.326 ms                  | 11.359 ms                 |
| Optimize                  | 2.422 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 73.809 us                 | 33.822 ms                 |
| AfterBackward             | 55.729 ms                 | 92.195 ms                 |
| BlockToStepN              | 138.196 ms                | 877.028 ms                |
| OneStep                   | 244.179 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:17.292006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240205 15:51:18.292009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 5] 200 steps, total: 49.981, sample: 1.219, forward: 0.536, backward: 0.975, update: 0.264
[proc 0] 200 steps, total: 49.981, sample: 2.224, forward: 0.521, backward: 0.695, update: 0.288
[proc 6] 200 steps, total: 49.981, sample: 1.266, forward: 0.537, backward: 0.855, update: 0.259
[proc 2] 200 steps, total: 49.981, sample: 1.349, forward: 0.542, backward: 1.016, update: 0.268
[proc 3] 200 steps, total: 49.981, sample: 1.298, forward: 0.542, backward: 0.881, update: 0.246
[proc 1] 200 steps, total: 49.981, sample: 1.345, forward: 0.539, backward: 0.890, update: 0.254
[proc 7] 200 steps, total: 49.981, sample: 1.254, forward: 0.538, backward: 0.773, update: 0.258
[proc 4] 200 steps, total: 49.981, sample: 1.932, forward: 0.588, backward: 0.971, update: 0.277
W20240205 15:51:19.292011 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 15:51:20.292009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 15:51:21.292009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.427 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 9.826 ms                  | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.052 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.713 ms                 | 92.152 ms                 |
| BlockToStepN              | 148.303 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.116 ms                 | 177.495 ms                |
| Forward                   | 5.128 ms                  | 11.209 ms                 |
| Backward                  | 6.225 ms                  | 11.359 ms                 |
| Optimize                  | 2.437 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 339.603 us                | 34.261 ms                 |
| AfterBackward             | 55.750 ms                 | 92.195 ms                 |
| BlockToStepN              | 162.413 ms                | 877.028 ms                |
| OneStep                   | 263.600 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:22.292008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240205 15:51:23.293547 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240205 15:51:24.293007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240205 15:51:25.309360 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240205 15:51:26.309008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.434 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 9.920 ms                  | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.052 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.748 ms                 | 92.152 ms                 |
| BlockToStepN              | 162.348 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.998 ms                  | 177.495 ms                |
| Forward                   | 5.128 ms                  | 11.209 ms                 |
| Backward                  | 6.034 ms                  | 11.359 ms                 |
| Optimize                  | 2.443 ms                  | 7.911 ms                  |
| BarrierTimeBeforeRank0    | 984.289 us                | 35.280 ms                 |
| AfterBackward             | 55.902 ms                 | 92.195 ms                 |
| BlockToStepN              | 162.413 ms                | 877.028 ms                |
| OneStep                   | 263.600 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:27.309006 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240205 15:51:28.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240205 15:51:29.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 15:51:30.309008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240205 15:51:31.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.427 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.126 ms                 | 66.642 ms                 |
| ProcessOneStep            | 55.893 ms                 | 92.152 ms                 |
| BlockToStepN              | 162.348 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.937 ms                  | 177.495 ms                |
| Forward                   | 5.133 ms                  | 11.209 ms                 |
| Backward                  | 6.025 ms                  | 11.359 ms                 |
| Optimize                  | 2.443 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 1.042 ms                  | 35.280 ms                 |
| AfterBackward             | 55.925 ms                 | 92.195 ms                 |
| BlockToStepN              | 395.185 ms                | 877.028 ms                |
| OneStep                   | 263.600 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:32.309008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240205 15:51:33.309011 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 15:51:34.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240205 15:51:35.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 15:51:36.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.424 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.870 ms                  | 14.593 ms                 |
| ProcessBack:UpsertPq      | 33.173 ms                 | 66.039 ms                 |
| ProcessOneStep            | 55.893 ms                 | 92.152 ms                 |
| BlockToStepN              | 173.283 ms                | 880.073 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.871 ms                  | 177.495 ms                |
| Forward                   | 5.128 ms                  | 11.209 ms                 |
| Backward                  | 5.999 ms                  | 11.359 ms                 |
| Optimize                  | 2.449 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 1.054 ms                  | 48.250 ms                 |
| AfterBackward             | 55.925 ms                 | 92.195 ms                 |
| BlockToStepN              | 173.357 ms                | 880.170 ms                |
| OneStep                   | 263.600 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:37.309008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240205 15:51:38.309007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 15:51:39.309010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240205 15:51:40.377931 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240205 15:51:41.377009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.415 ms                  | 17.627 ms                 |
| ProcessBack:UpdateCache   | 9.899 ms                  | 14.593 ms                 |
| ProcessBack:UpsertPq      | 33.173 ms                 | 66.039 ms                 |
| ProcessOneStep            | 55.950 ms                 | 92.152 ms                 |
| BlockToStepN              | 175.047 ms                | 880.073 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.281 ms                  | 177.495 ms                |
| Forward                   | 5.115 ms                  | 11.209 ms                 |
| Backward                  | 5.962 ms                  | 11.359 ms                 |
| Optimize                  | 2.450 ms                  | 19.801 ms                 |
| BarrierTimeBeforeRank0    | 1.303 ms                  | 48.250 ms                 |
| AfterBackward             | 55.994 ms                 | 92.195 ms                 |
| BlockToStepN              | 175.108 ms                | 880.170 ms                |
| OneStep                   | 263.600 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:42.377004 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240205 15:51:43.377010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 15:51:44.377010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 15:51:45.410598 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240205 15:51:46.410008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.431 ms                  | 19.607 ms                 |
| ProcessBack:UpdateCache   | 10.022 ms                 | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.594 ms                 | 66.039 ms                 |
| ProcessOneStep            | 56.023 ms                 | 103.102 ms                |
| BlockToStepN              | 175.047 ms                | 880.073 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.227 ms                  | 177.495 ms                |
| Forward                   | 5.115 ms                  | 11.209 ms                 |
| Backward                  | 5.893 ms                  | 11.359 ms                 |
| Optimize                  | 2.450 ms                  | 19.801 ms                 |
| BarrierTimeBeforeRank0    | 1.714 ms                  | 48.250 ms                 |
| AfterBackward             | 56.057 ms                 | 103.141 ms                |
| BlockToStepN              | 175.108 ms                | 880.170 ms                |
| OneStep                   | 279.072 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:47.489776 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240205 15:51:48.489008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240205 15:51:49.489008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240205 15:51:50.489010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240205 15:51:51.489009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.443 ms                  | 19.607 ms                 |
| ProcessBack:UpdateCache   | 10.034 ms                 | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.595 ms                 | 66.039 ms                 |
| ProcessOneStep            | 56.303 ms                 | 92.152 ms                 |
| BlockToStepN              | 196.115 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.966 ms                  | 170.394 ms                |
| Forward                   | 5.093 ms                  | 9.897 ms                  |
| Backward                  | 5.867 ms                  | 11.237 ms                 |
| Optimize                  | 2.462 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 1.783 ms                  | 35.280 ms                 |
| AfterBackward             | 56.340 ms                 | 92.195 ms                 |
| BlockToStepN              | 196.213 ms                | 877.028 ms                |
| OneStep                   | 279.072 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:52.531033 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 15:51:53.531008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240205 15:51:54.598068 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240205 15:51:55.614609 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 15:51:56.614009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.443 ms                  | 19.607 ms                 |
| ProcessBack:UpdateCache   | 10.257 ms                 | 20.491 ms                 |
| ProcessBack:UpsertPq      | 33.594 ms                 | 66.039 ms                 |
| ProcessOneStep            | 56.400 ms                 | 92.152 ms                 |
| BlockToStepN              | 196.115 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.980 ms                  | 170.394 ms                |
| Forward                   | 5.092 ms                  | 9.897 ms                  |
| Backward                  | 5.847 ms                  | 11.237 ms                 |
| Optimize                  | 2.450 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 1.783 ms                  | 35.280 ms                 |
| AfterBackward             | 56.434 ms                 | 92.195 ms                 |
| BlockToStepN              | 395.185 ms                | 877.028 ms                |
| OneStep                   | 475.627 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:51:57.614010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240205 15:51:58.614024 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240205 15:51:59.614010 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240205 15:52:00.614007 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240205 15:52:01.614008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 10.221 ms                 | 16.399 ms                 |
| ProcessBack:UpsertPq      | 33.696 ms                 | 60.839 ms                 |
| ProcessOneStep            | 56.628 ms                 | 92.152 ms                 |
| BlockToStepN              | 196.115 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.227 ms                  | 170.394 ms                |
| Forward                   | 5.093 ms                  | 9.897 ms                  |
| Backward                  | 5.847 ms                  | 11.237 ms                 |
| Optimize                  | 2.449 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 2.002 ms                  | 35.280 ms                 |
| AfterBackward             | 56.696 ms                 | 92.195 ms                 |
| BlockToStepN              | 196.213 ms                | 877.028 ms                |
| OneStep                   | 279.072 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:52:02.614009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240205 15:52:03.663053 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240205 15:52:04.663009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240205 15:52:05.663008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 10.076 ms                 | 16.399 ms                 |
| ProcessBack:UpsertPq      | 33.793 ms                 | 60.839 ms                 |
| ProcessOneStep            | 56.876 ms                 | 92.152 ms                 |
| BlockToStepN              | 196.115 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 15:52:06.786901 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.966 ms                  | 170.394 ms                |
| Forward                   | 5.090 ms                  | 9.897 ms                  |
| Backward                  | 5.769 ms                  | 11.237 ms                 |
| Optimize                  | 2.443 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 2.373 ms                  | 35.280 ms                 |
| AfterBackward             | 56.915 ms                 | 92.195 ms                 |
| BlockToStepN              | 196.213 ms                | 877.028 ms                |
| OneStep                   | 279.072 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 15:52:07.786008 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240205 15:52:08.795687 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
W20240205 15:52:09.795009 39237 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 1] 300 steps, total: 51.415, sample: 1.177, forward: 0.561, backward: 1.004, update: 0.256
[proc 0] 300 steps, total: 51.415, sample: 1.699, forward: 0.508, backward: 0.544, update: 0.321
[proc 6] 300 steps, total: 51.415, sample: 1.177, forward: 0.532, backward: 0.967, update: 0.264
[proc 3] 300 steps, total: 51.415, sample: 1.211, forward: 0.580, backward: 0.881, update: 0.254
[proc 7] 300 steps, total: 51.415, sample: 1.168, forward: 0.527, backward: 1.030, update: 0.274
[proc 5] 300 steps, total: 51.415, sample: 1.121, forward: 0.528, backward: 0.992, update: 0.281
[proc 2] 300 steps, total: 51.415, sample: 1.150, forward: 0.568, backward: 0.987, update: 0.269
Successfully xmh. training takes 154.17873692512512 seconds
before call kg_cache_controller.StopThreads()
[proc 4] 300 steps, total: 51.415, sample: 1.720, forward: 0.559, backward: 0.990, update: 0.278
W20240205 15:52:10.177999 39237 grad_async_v1.h:243] call StopThreads. PID = 56849
W20240205 15:52:10.178030 39237 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 15:52:10.181736 39237 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 15:52:10.181746 39237 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 15:52:10.195665 39237 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.445 ms                  | 18.018 ms                 |
| ProcessBack:UpdateCache   | 10.029 ms                 | 16.399 ms                 |
| ProcessBack:UpsertPq      | 33.793 ms                 | 60.839 ms                 |
| ProcessOneStep            | 56.941 ms                 | 92.152 ms                 |
| BlockToStepN              | 206.519 ms                | 876.898 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.966 ms                  | 170.394 ms                |
| Forward                   | 5.075 ms                  | 9.897 ms                  |
| Backward                  | 5.759 ms                  | 11.237 ms                 |
| Optimize                  | 2.437 ms                  | 8.710 ms                  |
| BarrierTimeBeforeRank0    | 2.306 ms                  | 35.280 ms                 |
| AfterBackward             | 56.975 ms                 | 92.195 ms                 |
| BlockToStepN              | 206.594 ms                | 877.028 ms                |
| OneStep                   | 290.417 ms                | 1.072 s                   |
+---------------------------+---------------------------+---------------------------+
