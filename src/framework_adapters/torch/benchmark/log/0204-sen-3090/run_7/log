WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:14:46.257603 57457 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_113', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=2, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [57457 sampler.py:454] Start PreSampling
WARNING [57457 sampler.py:532] Before construct renumbering_dict
WARNING [57457 sampler.py:555] PreSampling done
W20240204 10:14:51.728947 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:14:51.729122 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:14:51.729159 57457 IPCTensor.h:369] NewIPCTensor: step_r0 [2]0x100000f48000 16 B 
W20240204 10:14:51.729185 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100000f4a000 8 B 
W20240204 10:14:51.729209 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100000f4c000 8 B 
W20240204 10:14:51.729328 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100000f4e000 7.629 MB
W20240204 10:14:51.729368 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000016f1000 7.629 MB
W20240204 10:14:51.729401 57457 IPCTensor.h:369] NewIPCTensor: step_r1 [2]0x100001e94000 16 B 
W20240204 10:14:51.729420 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100001e96000 8 B 
W20240204 10:14:51.729439 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100001e98000 8 B 
W20240204 10:14:51.729483 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100001e9a000 7.629 MB
W20240204 10:14:51.729524 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000263d000 7.629 MB
W20240204 10:14:51.729552 57457 IPCTensor.h:369] NewIPCTensor: step_r2 [2]0x100002de0000 16 B 
W20240204 10:14:51.729570 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100002de2000 8 B 
W20240204 10:14:51.729590 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100002de4000 8 B 
W20240204 10:14:51.729640 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100002de6000 7.629 MB
W20240204 10:14:51.729693 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100003589000 7.629 MB
W20240204 10:14:51.729717 57457 IPCTensor.h:369] NewIPCTensor: step_r3 [2]0x100003d2c000 16 B 
W20240204 10:14:51.729735 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100003d2e000 8 B 
W20240204 10:14:51.729753 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100003d30000 8 B 
W20240204 10:14:51.729794 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100003d32000 7.629 MB
W20240204 10:14:51.729825 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000044d5000 7.629 MB
W20240204 10:14:51.729846 57457 IPCTensor.h:369] NewIPCTensor: step_r4 [2]0x100004c78000 16 B 
W20240204 10:14:51.729864 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100004c7a000 8 B 
W20240204 10:14:51.729883 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100004c7c000 8 B 
W20240204 10:14:51.729930 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100004c7e000 7.629 MB
W20240204 10:14:51.729962 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100005421000 7.629 MB
W20240204 10:14:51.729985 57457 IPCTensor.h:369] NewIPCTensor: step_r5 [2]0x100005bc4000 16 B 
W20240204 10:14:51.730003 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100005bc6000 8 B 
W20240204 10:14:51.730020 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100005bc8000 8 B 
W20240204 10:14:51.730057 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100005bca000 7.629 MB
W20240204 10:14:51.730093 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10000636d000 7.629 MB
W20240204 10:14:51.730114 57457 IPCTensor.h:369] NewIPCTensor: step_r6 [2]0x100006b10000 16 B 
W20240204 10:14:51.730132 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x100006b12000 8 B 
W20240204 10:14:51.730151 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100006b14000 8 B 
W20240204 10:14:51.730190 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x100006b16000 7.629 MB
W20240204 10:14:51.730227 57457 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000072b9000 7.629 MB
W20240204 10:14:51.730250 57457 IPCTensor.h:369] NewIPCTensor: step_r7 [2]0x100007a5c000 16 B 
W20240204 10:14:51.730268 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100007a5e000 8 B 
W20240204 10:14:51.730284 57457 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100007a60000 8 B 
W20240204 10:14:51.943873 57457 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100007a62000 22.81 MB
W20240204 10:14:51.974397 57457 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100009134000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 745, 1093, 1673,  ..., 7916, 9890, 8380]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.751 seconds
[Rank1] pid = 57882
[Rank2] pid = 57903
[Rank3] pid = 57948
[Rank4] pid = 58074
[Rank5] pid = 58081
[Rank6] pid = 58139
INFO [57457 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [57882 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [57903 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [58074 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [57948 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [58139 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [58204 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [58081 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [57948 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [58139 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [58074 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [58081 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [58204 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57903 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57457 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57882 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:14:53.672305 58141 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:14:53.672622 58268 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:14:53.672513 58011 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:14:53.672537 58075 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:14:53.672880 57947 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:14:53.672539 58140 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:14:53.673417 58267 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:14:53.674518 57883 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:14:53.715590 58268 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100009148000 7.629 MB
W20240204 10:14:53.715796 58141 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000098ef000 7.629 MB
W20240204 10:14:53.715857 58140 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10000a094000 7.629 MB
W20240204 10:14:53.715873 58268 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10000a837000 7.629 MB
W20240204 10:14:53.715910 58075 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10000afde000 7.629 MB
W20240204 10:14:53.715981 58268 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10000b783000 1.49 GB
W20240204 10:14:53.716024 58268 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10006ad66000 1.49 GB
W20240204 10:14:53.716034 58141 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000ca349000 7.629 MB
W20240204 10:14:53.716060 58267 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000caaec000 7.629 MB
W20240204 10:14:53.716092 58140 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000cb28f000 7.629 MB
W20240204 10:14:53.716128 58075 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000cc1d5000 7.629 MB
W20240204 10:14:53.716127 58011 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000cba32000 7.629 MB
W20240204 10:14:53.716145 58268 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:14:53.716181 57947 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000cc978000 7.629 MB
W20240204 10:14:53.716212 58075 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1000cd11b000 1.49 GB
W20240204 10:14:53.716215 58267 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10012c6fe000 7.629 MB
W20240204 10:14:53.716276 58075 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10012d644000 1.49 GB
W20240204 10:14:53.716264 57883 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10012cea1000 7.629 MB
W20240204 10:14:53.716336 58011 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10018cc27000 7.629 MB
W20240204 10:14:53.716356 58075 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:14:53.716395 57947 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10018d3ca000 7.629 MB
W20240204 10:14:53.716436 57883 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10018db6d000 7.629 MB
W20240204 10:14:53.717940 58140 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10018e310000 1.49 GB
W20240204 10:14:53.717995 58140 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001ed8f3000 1.49 GB
W20240204 10:14:53.718067 58140 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:14:53.719496 58267 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10024ced6000 1.49 GB
W20240204 10:14:53.719528 58011 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1002ac4b9000 1.49 GB
W20240204 10:14:53.719549 58267 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10030ba9c000 1.49 GB
W20240204 10:14:53.719581 57947 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10036b07f000 1.49 GB
W20240204 10:14:53.719599 57883 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1003ca662000 1.49 GB
W20240204 10:14:53.719602 58267 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:14:53.719606 58011 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100429c45000 1.49 GB
W20240204 10:14:53.719647 57947 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100489228000 1.49 GB
W20240204 10:14:53.719677 58141 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1004e880b000 1.49 GB
W20240204 10:14:53.719686 57883 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100547dee000 1.49 GB
W20240204 10:14:53.719700 58011 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:14:53.719724 57947 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:14:53.719745 58141 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1005a73d1000 1.49 GB
W20240204 10:14:53.719780 57883 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:14:53.719805 58141 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:14:53.729903 58268 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:14:53.730213 58075 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:14:53.732005 58267 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:14:53.732040 58011 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:14:53.732044 57947 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:14:53.732088 58140 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:14:53.733657 57883 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:14:53.733734 58141 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100007a62000
2: KnownLocalCachedEmbedding init done
WARNING [57903 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
3: KnownLocalCachedEmbedding init done
WARNING [57948 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
5: KnownLocalCachedEmbedding init done
WARNING [58081 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
4: KnownLocalCachedEmbedding init done
WARNING [58074 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
6: KnownLocalCachedEmbedding init done
WARNING [58139 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 58204
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100007a62000
0: KnownLocalCachedEmbedding init done
WARNING [57457 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
1: KnownLocalCachedEmbedding init done
WARNING [57882 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100007a62000
7: KnownLocalCachedEmbedding init done
WARNING [58204 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:14:56.490206 58268 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.490890 58075 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491016 58140 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491231 57883 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491436 58011 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491575 58141 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491672 57947 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:14:56.491807 58267 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:14:56.496338 58267 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 2,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:14:56.496671 58267 grad_base.h:184] Init GradProcessingBase done
I20240204 10:14:56.503419 58267 grad_async_v1.h:203] Use main thread to update emb.
W20240204 10:14:56.503540 58267 kg_controller.h:75] after init GradAsyncProcessing
I20240204 10:14:56.503567 58267 kg_controller.h:84] Construct KGCacheController done
E20240204 10:14:58.241245 57947 recstore.cc:66] init folly done
E20240204 10:14:58.241400 58141 recstore.cc:66] init folly done
E20240204 10:14:58.241425 58268 recstore.cc:66] init folly done
E20240204 10:14:58.241423 57883 recstore.cc:66] init folly done
E20240204 10:14:58.241465 58075 recstore.cc:66] init folly done
E20240204 10:14:58.241910 58267 recstore.cc:66] init folly done
E20240204 10:14:58.242468 58140 recstore.cc:66] init folly done
E20240204 10:14:58.242460 58011 recstore.cc:66] init folly done
I20240204 10:14:58.244174 58267 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 10:14:59.052484 58267 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:14:59.057600 57883 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.061086 58141 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.061873 58268 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.064525 58075 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.074874 57947 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.080305 58140 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:14:59.084038 58011 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 10:15:01.476722 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.219 ms                  | 1.219 ms                  |
| Forward                   | 722.403 ms                | 722.403 ms                |
| Backward                  | 199.327 ms                | 199.327 ms                |
| Optimize                  | 4.706 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 146.991 us                | 146.991 us                |
| AfterBackward             | 1.463 s                   | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 10:15:01.573421 58786 grad_async_v1.h:533] Stalled in ProcessBackward: rank=3, step_no=1, sample_step_cpp_seen_[rank]=0
W20240204 10:15:02.530332 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.131 ms                  | 423.169 ms                |
| ProcessBack:UpdateCache   | 9.921 ms                  | 770.383 ms                |
| ProcessBack:UpsertPq      | 8.633 ms                  | 26.567 ms                 |
| ProcessOneStep            | 41.704 ms                 | 1.462 s                   |
| BlockToStepN              | 196.334 ms                | 566.546 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:03.530019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=6, pq.top=6
W20240204 10:15:04.530027 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240204 10:15:05.530074 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=8, pq.top=8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.552 ms                  | 4.664 ms                  |
| Forward                   | 6.545 ms                  | 722.403 ms                |
| Backward                  | 9.935 ms                  | 199.327 ms                |
| Optimize                  | 2.088 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 79.662 us                 | 5.242 ms                  |
| AfterBackward             | 32.749 ms                 | 1.463 s                   |
| BlockToStepN              | 566.832 ms                | 796.483 ms                |
| OneStep                   | 787.700 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:06.530007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240204 10:15:07.530020 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.820 ms                  | 423.169 ms                |
| ProcessBack:UpdateCache   | 9.865 ms                  | 770.383 ms                |
| ProcessBack:UpsertPq      | 13.800 ms                 | 26.567 ms                 |
| ProcessOneStep            | 35.363 ms                 | 1.462 s                   |
| BlockToStepN              | 584.737 ms                | 796.178 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:08.530009 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240204 10:15:09.530018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240204 10:15:10.530007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.552 ms                  | 24.272 ms                 |
| Forward                   | 5.907 ms                  | 722.403 ms                |
| Backward                  | 9.710 ms                  | 199.327 ms                |
| Optimize                  | 1.954 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 146.991 us                | 10.229 ms                 |
| AfterBackward             | 35.415 ms                 | 1.463 s                   |
| BlockToStepN              | 577.928 ms                | 796.483 ms                |
| OneStep                   | 643.263 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:11.557508 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=18, pq.top=18
W20240204 10:15:12.557011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 423.169 ms                |
| ProcessBack:UpdateCache   | 9.579 ms                  | 770.383 ms                |
| ProcessBack:UpsertPq      | 12.426 ms                 | 26.567 ms                 |
| ProcessOneStep            | 32.006 ms                 | 1.462 s                   |
| BlockToStepN              | 566.546 ms                | 796.178 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:13.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 10:15:14.557019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 10:15:15.557013 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=24, pq.top=24
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.272 ms                 |
| Forward                   | 5.462 ms                  | 722.403 ms                |
| Backward                  | 9.540 ms                  | 199.327 ms                |
| Optimize                  | 1.795 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 146.991 us                | 10.229 ms                 |
| AfterBackward             | 31.326 ms                 | 1.463 s                   |
| BlockToStepN              | 547.477 ms                | 796.483 ms                |
| OneStep                   | 618.099 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:16.557004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=26, pq.top=26
W20240204 10:15:17.557013 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.616 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.654 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.174 ms                 | 22.675 ms                 |
| ProcessOneStep            | 31.297 ms                 | 1.462 s                   |
| BlockToStepN              | 540.378 ms                | 796.178 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:18.557009 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 10:15:19.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240204 10:15:20.557006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.272 ms                 |
| Forward                   | 5.608 ms                  | 722.403 ms                |
| Backward                  | 9.534 ms                  | 199.327 ms                |
| Optimize                  | 1.888 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 621.956 us                | 17.822 ms                 |
| AfterBackward             | 31.101 ms                 | 1.463 s                   |
| BlockToStepN              | 547.477 ms                | 796.483 ms                |
| OneStep                   | 605.962 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:21.557004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240204 10:15:22.557014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.862 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.314 ms                 | 22.675 ms                 |
| ProcessOneStep            | 31.224 ms                 | 1.462 s                   |
| BlockToStepN              | 546.957 ms                | 796.178 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:23.557016 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=38, pq.top=38
W20240204 10:15:24.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 10:15:25.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.961 ms                  | 24.272 ms                 |
| Forward                   | 5.462 ms                  | 722.403 ms                |
| Backward                  | 9.344 ms                  | 199.327 ms                |
| Optimize                  | 1.795 ms                  | 4.706 ms                  |
| BarrierTimeBeforeRank0    | 1.669 ms                  | 17.822 ms                 |
| AfterBackward             | 31.101 ms                 | 1.463 s                   |
| BlockToStepN              | 540.470 ms                | 796.483 ms                |
| OneStep                   | 593.764 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:26.557004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 10:15:27.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.535 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.654 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.363 ms                 | 22.675 ms                 |
| ProcessOneStep            | 30.755 ms                 | 1.462 s                   |
| BlockToStepN              | 541.247 ms                | 796.178 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:28.557018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
W20240204 10:15:29.557008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
W20240204 10:15:30.557006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.961 ms                  | 21.431 ms                 |
| Forward                   | 5.420 ms                  | 11.674 ms                 |
| Backward                  | 9.344 ms                  | 13.486 ms                 |
| Optimize                  | 1.795 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 787.782 us                | 14.435 ms                 |
| AfterBackward             | 30.236 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.382 ms                | 796.483 ms                |
| OneStep                   | 592.924 ms                | 2.441 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:31.588179 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
W20240204 10:15:32.588016 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.680 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.174 ms                 | 22.675 ms                 |
| ProcessOneStep            | 30.172 ms                 | 82.357 ms                 |
| BlockToStepN              | 539.280 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:33.588007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240204 10:15:34.588006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240204 10:15:35.588027 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=58, pq.top=58
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.858 ms                  | 21.431 ms                 |
| Forward                   | 5.345 ms                  | 11.674 ms                 |
| Backward                  | 9.294 ms                  | 13.486 ms                 |
| Optimize                  | 1.790 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 186.580 us                | 14.435 ms                 |
| AfterBackward             | 29.804 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.411 ms                | 792.504 ms                |
| OneStep                   | 593.680 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:36.588004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
W20240204 10:15:37.588006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.535 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.640 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.095 ms                 | 22.675 ms                 |
| ProcessOneStep            | 29.759 ms                 | 82.357 ms                 |
| BlockToStepN              | 540.260 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:38.588007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240204 10:15:39.588019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240204 10:15:40.588007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.864 ms                  | 21.431 ms                 |
| Forward                   | 5.251 ms                  | 11.674 ms                 |
| Backward                  | 9.293 ms                  | 13.486 ms                 |
| Optimize                  | 1.790 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 79.662 us                 | 14.435 ms                 |
| AfterBackward             | 29.804 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.382 ms                | 792.504 ms                |
| OneStep                   | 593.351 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:41.616408 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240204 10:15:42.616007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.538 ms                  | 392.608 ms                |
| ProcessBack:UpdateCache   | 9.598 ms                  | 769.520 ms                |
| ProcessBack:UpsertPq      | 10.040 ms                 | 22.675 ms                 |
| ProcessOneStep            | 29.704 ms                 | 82.357 ms                 |
| BlockToStepN              | 537.962 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:43.616014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240204 10:15:44.616014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
W20240204 10:15:45.616014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.858 ms                  | 21.431 ms                 |
| Forward                   | 5.181 ms                  | 11.674 ms                 |
| Backward                  | 9.278 ms                  | 13.486 ms                 |
| Optimize                  | 1.778 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 90.147 us                 | 14.435 ms                 |
| AfterBackward             | 29.628 ms                 | 82.432 ms                 |
| BlockToStepN              | 538.071 ms                | 792.504 ms                |
| OneStep                   | 588.301 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:46.616005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240204 10:15:47.616011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.538 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.633 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 10.040 ms                 | 22.298 ms                 |
| ProcessOneStep            | 29.595 ms                 | 82.357 ms                 |
| BlockToStepN              | 538.705 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:48.616012 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240204 10:15:49.616008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240204 10:15:50.616008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.961 ms                  | 24.272 ms                 |
| Forward                   | 5.233 ms                  | 11.674 ms                 |
| Backward                  | 9.278 ms                  | 22.882 ms                 |
| Optimize                  | 1.790 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 90.147 us                 | 16.876 ms                 |
| AfterBackward             | 29.738 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.382 ms                | 792.504 ms                |
| OneStep                   | 592.008 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:51.616014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 10:15:52.616007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.585 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 10.040 ms                 | 22.298 ms                 |
| ProcessOneStep            | 29.595 ms                 | 82.357 ms                 |
| BlockToStepN              | 540.292 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:53.616007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240204 10:15:54.616007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 10:15:55.616015 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.864 ms                  | 24.272 ms                 |
| Forward                   | 5.181 ms                  | 11.674 ms                 |
| Backward                  | 9.253 ms                  | 22.882 ms                 |
| Optimize                  | 1.781 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 146.991 us                | 16.876 ms                 |
| AfterBackward             | 29.526 ms                 | 82.432 ms                 |
| BlockToStepN              | 541.351 ms                | 792.504 ms                |
| OneStep                   | 593.764 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:56.616011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240204 10:15:57.616006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.538 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.640 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 10.040 ms                 | 22.298 ms                 |
| ProcessOneStep            | 29.496 ms                 | 82.357 ms                 |
| BlockToStepN              | 541.247 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:15:58.616006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 10:15:59.616012 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240204 10:16:00.616019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.272 ms                 |
| Forward                   | 5.181 ms                  | 11.674 ms                 |
| Backward                  | 9.256 ms                  | 22.882 ms                 |
| Optimize                  | 1.795 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 471.530 us                | 16.876 ms                 |
| AfterBackward             | 29.526 ms                 | 82.432 ms                 |
| BlockToStepN              | 545.602 ms                | 792.504 ms                |
| OneStep                   | 598.172 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:01.616005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 63.048, sample: 0.394, forward: 1.083, backward: 0.717, update: 0.196
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 63.029, sample: 0.380, forward: 1.143, backward: 0.850, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 63.047, sample: 0.336, forward: 1.036, backward: 1.086, update: 0.184
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 63.034, sample: 0.365, forward: 1.160, backward: 0.995, update: 0.192
train_sampler.Prefill()
-------Step 0-------
tensor([ 1852,    53,  4010,  2788, 10579, 14030,  1054,   441, 13530, 13582]) tensor([ 1673,  8260,  5050, 12238, 13622,   984,   576,  6024,   512, 11268])
-------Step 1-------
tensor([ 1852,    53,  4010,  2788, 10579, 14030,  1054,   441, 13530, 13582]) tensor([ 4560, 12448, 14473,  1410,  1066,  8116, 12395, 12088,  4538, 11456])
before start barrier
start train
[proc 0] 100 steps, total: 63.057, sample: 0.521, forward: 1.256, backward: 1.050, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 63.051, sample: 0.381, forward: 1.065, backward: 0.855, update: 0.193
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 63.025, sample: 0.364, forward: 1.127, backward: 0.853, update: 0.194
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 63.045, sample: 0.379, forward: 1.133, backward: 1.052, update: 0.189
W20240204 10:16:02.616008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.520 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.668 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 10.040 ms                 | 22.298 ms                 |
| ProcessOneStep            | 29.496 ms                 | 82.357 ms                 |
| BlockToStepN              | 545.687 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:03.616006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 10:16:04.616027 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240204 10:16:05.616006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.040 ms                  | 24.272 ms                 |
| Forward                   | 5.233 ms                  | 12.873 ms                 |
| Backward                  | 9.278 ms                  | 22.882 ms                 |
| Optimize                  | 1.826 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 621.956 us                | 16.876 ms                 |
| AfterBackward             | 29.628 ms                 | 82.432 ms                 |
| BlockToStepN              | 547.070 ms                | 792.504 ms                |
| OneStep                   | 601.013 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:06.626719 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=108, pq.top=108
W20240204 10:16:07.626008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.642 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 9.962 ms                  | 22.298 ms                 |
| ProcessOneStep            | 29.450 ms                 | 82.357 ms                 |
| BlockToStepN              | 545.687 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:08.626020 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 10:16:09.626008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 10:16:10.636210 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.272 ms                 |
| Forward                   | 5.181 ms                  | 12.873 ms                 |
| Backward                  | 9.256 ms                  | 22.882 ms                 |
| Optimize                  | 1.828 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 471.530 us                | 16.876 ms                 |
| AfterBackward             | 29.480 ms                 | 82.432 ms                 |
| BlockToStepN              | 544.306 ms                | 792.504 ms                |
| OneStep                   | 596.454 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:11.636006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240204 10:16:12.636021 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=118, pq.top=118
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.540 ms                  | 18.920 ms                 |
| ProcessBack:UpdateCache   | 9.640 ms                  | 15.839 ms                 |
| ProcessBack:UpsertPq      | 9.941 ms                  | 22.298 ms                 |
| ProcessOneStep            | 29.450 ms                 | 82.357 ms                 |
| BlockToStepN              | 541.155 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:13.636005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240204 10:16:14.636013 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 10:16:15.636006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.961 ms                  | 24.272 ms                 |
| Forward                   | 5.168 ms                  | 12.873 ms                 |
| Backward                  | 9.253 ms                  | 22.882 ms                 |
| Optimize                  | 1.826 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 195.376 us                | 16.876 ms                 |
| AfterBackward             | 29.480 ms                 | 82.432 ms                 |
| BlockToStepN              | 541.121 ms                | 792.504 ms                |
| OneStep                   | 593.351 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:16.636005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240204 10:16:17.636018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.542 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.634 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.874 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.398 ms                 | 82.357 ms                 |
| BlockToStepN              | 540.378 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:18.636006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
W20240204 10:16:19.636008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240204 10:16:20.636008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.910 ms                  | 24.272 ms                 |
| Forward                   | 5.159 ms                  | 12.873 ms                 |
| Backward                  | 9.245 ms                  | 22.882 ms                 |
| Optimize                  | 1.846 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 401.550 us                | 16.876 ms                 |
| AfterBackward             | 29.365 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.035 ms                | 792.504 ms                |
| OneStep                   | 591.688 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:21.693934 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240204 10:16:22.693018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.538 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.585 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.865 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.317 ms                 | 82.357 ms                 |
| BlockToStepN              | 540.260 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:23.693012 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240204 10:16:24.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 10:16:25.693007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.882 ms                  | 24.272 ms                 |
| Forward                   | 5.087 ms                  | 12.873 ms                 |
| Backward                  | 9.216 ms                  | 22.882 ms                 |
| Optimize                  | 1.828 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 235.892 us                | 16.876 ms                 |
| AfterBackward             | 29.318 ms                 | 82.432 ms                 |
| BlockToStepN              | 540.382 ms                | 792.504 ms                |
| OneStep                   | 592.008 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:26.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240204 10:16:27.693009 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.520 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.579 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.831 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.288 ms                 | 82.357 ms                 |
| BlockToStepN              | 539.280 ms                | 792.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:28.693014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240204 10:16:29.693007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240204 10:16:30.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.975 ms                  | 24.541 ms                 |
| Forward                   | 5.073 ms                  | 12.873 ms                 |
| Backward                  | 9.211 ms                  | 22.882 ms                 |
| Optimize                  | 1.826 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 471.530 us                | 17.822 ms                 |
| AfterBackward             | 29.318 ms                 | 82.432 ms                 |
| BlockToStepN              | 539.495 ms                | 792.504 ms                |
| OneStep                   | 591.583 ms                | 868.842 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:31.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 10:16:32.693022 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.467 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.633 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.855 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.288 ms                 | 51.573 ms                 |
| BlockToStepN              | 538.705 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:33.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240204 10:16:34.693006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240204 10:16:35.718479 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.961 ms                  | 24.272 ms                 |
| Forward                   | 5.087 ms                  | 11.674 ms                 |
| Backward                  | 9.211 ms                  | 20.698 ms                 |
| Optimize                  | 1.804 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 235.892 us                | 16.876 ms                 |
| AfterBackward             | 29.288 ms                 | 51.682 ms                 |
| BlockToStepN              | 538.071 ms                | 738.313 ms                |
| OneStep                   | 589.188 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:36.718015 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240204 10:16:37.718015 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.454 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.640 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.823 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.261 ms                 | 51.573 ms                 |
| BlockToStepN              | 537.616 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:38.718008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240204 10:16:39.718008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240204 10:16:40.718024 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.272 ms                 |
| Forward                   | 5.089 ms                  | 11.674 ms                 |
| Backward                  | 9.186 ms                  | 20.698 ms                 |
| Optimize                  | 1.800 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 547.518 us                | 17.506 ms                 |
| AfterBackward             | 29.288 ms                 | 51.682 ms                 |
| BlockToStepN              | 537.339 ms                | 738.313 ms                |
| OneStep                   | 589.142 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:41.718005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240204 10:16:42.722810 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.412 ms                  | 16.021 ms                 |
| ProcessBack:UpdateCache   | 9.654 ms                  | 15.507 ms                 |
| ProcessBack:UpsertPq      | 9.823 ms                  | 18.774 ms                 |
| ProcessOneStep            | 29.242 ms                 | 51.573 ms                 |
| BlockToStepN              | 536.315 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:43.722007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240204 10:16:44.722019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240204 10:16:45.722005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.000 ms                  | 24.272 ms                 |
| Forward                   | 5.148 ms                  | 12.873 ms                 |
| Backward                  | 9.189 ms                  | 20.698 ms                 |
| Optimize                  | 1.800 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 634.004 us                | 17.822 ms                 |
| AfterBackward             | 29.269 ms                 | 51.682 ms                 |
| BlockToStepN              | 536.134 ms                | 738.313 ms                |
| OneStep                   | 588.555 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:46.722005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240204 10:16:47.722026 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.435 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.654 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.818 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.242 ms                 | 51.573 ms                 |
| BlockToStepN              | 534.831 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:48.722007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240204 10:16:49.724768 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240204 10:16:50.724006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.975 ms                  | 24.272 ms                 |
| Forward                   | 5.163 ms                  | 12.873 ms                 |
| Backward                  | 9.212 ms                  | 20.698 ms                 |
| Optimize                  | 1.804 ms                  | 3.273 ms                  |
| BarrierTimeBeforeRank0    | 672.926 us                | 17.836 ms                 |
| AfterBackward             | 29.269 ms                 | 51.682 ms                 |
| BlockToStepN              | 533.556 ms                | 738.313 ms                |
| OneStep                   | 588.167 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:51.724005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240204 10:16:52.724018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.412 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.678 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.815 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.237 ms                 | 51.573 ms                 |
| BlockToStepN              | 533.441 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:53.747380 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 10:16:54.747011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240204 10:16:55.747058 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.975 ms                  | 24.541 ms                 |
| Forward                   | 5.163 ms                  | 17.022 ms                 |
| Backward                  | 9.207 ms                  | 20.698 ms                 |
| Optimize                  | 1.795 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 859.535 us                | 17.836 ms                 |
| AfterBackward             | 29.269 ms                 | 51.682 ms                 |
| BlockToStepN              | 532.607 ms                | 738.313 ms                |
| OneStep                   | 587.444 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:56.747006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240204 10:16:57.747025 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.388 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.691 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.815 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.223 ms                 | 51.573 ms                 |
| BlockToStepN              | 532.507 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:16:58.747006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240204 10:16:59.747011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 6] 200 steps, total: 58.530, sample: 0.357, forward: 0.441, backward: 0.457, update: 0.175
[proc 7] 200 steps, total: 58.529, sample: 0.343, forward: 0.463, backward: 0.864, update: 0.176
[proc 2] 200 steps, total: 58.529, sample: 0.396, forward: 0.476, backward: 0.870, update: 0.191
[proc 5] 200 steps, total: 58.529, sample: 0.394, forward: 0.502, backward: 0.666, update: 0.190
[proc 4] 200 steps, total: 58.529, sample: 0.372, forward: 0.527, backward: 0.829, update: 0.193
[proc 3] 200 steps, total: 58.529, sample: 0.362, forward: 0.475, backward: 0.870, update: 0.194
[proc 0] 200 steps, total: 58.529, sample: 0.543, forward: 0.564, backward: 0.838, update: 0.185
[proc 1] 200 steps, total: 58.529, sample: 0.357, forward: 0.446, backward: 0.750, update: 0.187
W20240204 10:17:00.747014 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.168 ms                  | 17.022 ms                 |
| Backward                  | 9.185 ms                  | 20.698 ms                 |
| Optimize                  | 1.795 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.118 ms                  | 21.142 ms                 |
| AfterBackward             | 29.206 ms                 | 51.682 ms                 |
| BlockToStepN              | 531.865 ms                | 738.313 ms                |
| OneStep                   | 587.391 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:01.747004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240204 10:17:02.747022 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.383 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.730 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.818 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.179 ms                 | 51.573 ms                 |
| BlockToStepN              | 531.174 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:03.747006 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240204 10:17:04.777496 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240204 10:17:05.777024 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.005 ms                  | 24.541 ms                 |
| Forward                   | 5.168 ms                  | 17.022 ms                 |
| Backward                  | 9.183 ms                  | 20.698 ms                 |
| Optimize                  | 1.799 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.286 ms                  | 21.142 ms                 |
| AfterBackward             | 29.232 ms                 | 51.682 ms                 |
| BlockToStepN              | 531.251 ms                | 738.313 ms                |
| OneStep                   | 587.109 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:06.777005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240204 10:17:07.777011 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.360 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.742 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.815 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.179 ms                 | 51.573 ms                 |
| BlockToStepN              | 531.127 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:08.824847 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 10:17:09.824012 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240204 10:17:10.824005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.163 ms                  | 17.022 ms                 |
| Backward                  | 9.186 ms                  | 20.698 ms                 |
| Optimize                  | 1.795 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.545 ms                  | 21.181 ms                 |
| AfterBackward             | 29.201 ms                 | 51.682 ms                 |
| BlockToStepN              | 530.968 ms                | 738.313 ms                |
| OneStep                   | 586.569 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:11.824008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240204 10:17:12.824018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.356 ms                  | 14.993 ms                 |
| ProcessBack:UpdateCache   | 9.742 ms                  | 13.670 ms                 |
| ProcessBack:UpsertPq      | 9.808 ms                  | 18.254 ms                 |
| ProcessOneStep            | 29.151 ms                 | 51.573 ms                 |
| BlockToStepN              | 531.127 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:13.824007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 10:17:14.824007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240204 10:17:15.824018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.159 ms                  | 17.022 ms                 |
| Backward                  | 9.186 ms                  | 20.698 ms                 |
| Optimize                  | 1.790 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.518 ms                  | 21.181 ms                 |
| AfterBackward             | 29.183 ms                 | 51.682 ms                 |
| BlockToStepN              | 530.743 ms                | 738.313 ms                |
| OneStep                   | 585.435 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:16.824009 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240204 10:17:17.824007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.348 ms                  | 14.688 ms                 |
| ProcessBack:UpdateCache   | 9.782 ms                  | 13.386 ms                 |
| ProcessBack:UpsertPq      | 9.814 ms                  | 17.904 ms                 |
| ProcessOneStep            | 29.170 ms                 | 51.573 ms                 |
| BlockToStepN              | 530.243 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:18.824019 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240204 10:17:19.824005 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240204 10:17:20.824007 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.168 ms                  | 17.022 ms                 |
| Backward                  | 9.186 ms                  | 20.698 ms                 |
| Optimize                  | 1.794 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.648 ms                  | 21.392 ms                 |
| AfterBackward             | 29.181 ms                 | 51.682 ms                 |
| BlockToStepN              | 530.438 ms                | 738.313 ms                |
| OneStep                   | 584.345 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:21.824018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240204 10:17:22.824004 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.345 ms                  | 14.688 ms                 |
| ProcessBack:UpdateCache   | 9.785 ms                  | 13.386 ms                 |
| ProcessBack:UpsertPq      | 9.798 ms                  | 17.904 ms                 |
| ProcessOneStep            | 29.145 ms                 | 51.573 ms                 |
| BlockToStepN              | 530.243 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:23.850494 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 10:17:24.850021 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240204 10:17:25.850008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.163 ms                  | 17.022 ms                 |
| Backward                  | 9.185 ms                  | 20.698 ms                 |
| Optimize                  | 1.795 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.545 ms                  | 21.392 ms                 |
| AfterBackward             | 29.181 ms                 | 51.682 ms                 |
| BlockToStepN              | 530.327 ms                | 738.313 ms                |
| OneStep                   | 584.310 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:26.850008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
W20240204 10:17:27.850018 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.345 ms                  | 14.688 ms                 |
| ProcessBack:UpdateCache   | 9.782 ms                  | 13.386 ms                 |
| ProcessBack:UpsertPq      | 9.798 ms                  | 17.904 ms                 |
| ProcessOneStep            | 29.143 ms                 | 51.573 ms                 |
| BlockToStepN              | 530.232 ms                | 738.108 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 10:17:28.850008 58267 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
Successfully xmh. training takes 150.66443276405334 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:17:29.716921 58267 grad_async_v1.h:243] call StopThreads. PID = 57457
W20240204 10:17:29.716945 58267 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:17:29.721391 58267 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:17:29.721408 58267 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 10:17:29.749044 58267 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.962 ms                  | 24.541 ms                 |
| Forward                   | 5.159 ms                  | 17.022 ms                 |
| Backward                  | 9.183 ms                  | 20.698 ms                 |
| Optimize                  | 1.795 ms                  | 3.447 ms                  |
| BarrierTimeBeforeRank0    | 1.545 ms                  | 21.392 ms                 |
| AfterBackward             | 29.174 ms                 | 51.682 ms                 |
| BlockToStepN              | 530.335 ms                | 738.313 ms                |
| OneStep                   | 584.345 ms                | 850.511 ms                |
+---------------------------+---------------------------+---------------------------+
