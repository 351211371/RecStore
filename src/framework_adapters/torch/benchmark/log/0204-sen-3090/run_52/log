WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 12:02:51.787559 27867 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_112', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [27867 sampler.py:454] Start PreSampling
WARNING [27867 sampler.py:532] Before construct renumbering_dict
WARNING [27867 sampler.py:555] PreSampling done
W20240205 12:19:34.252857 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 12:19:34.253185 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 12:19:34.253290 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 12:19:34.253387 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 12:19:34.253484 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 12:19:34.253571 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 12:19:34.253641 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 12:19:34.253722 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 12:19:34.253794 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 12:19:34.253868 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 12:19:34.253957 27867 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 12:19:34.254026 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 12:19:34.254096 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 12:19:34.254341 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 12:19:34.254433 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 12:19:34.254508 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 12:19:34.254623 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 12:19:34.254731 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 12:19:34.254834 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 12:19:34.254973 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 12:19:34.255101 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 12:19:34.255196 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 12:19:34.255311 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 12:19:34.255411 27867 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 12:19:34.255496 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 12:19:34.255576 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 12:19:34.255754 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 12:19:34.255863 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 12:19:34.255985 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 12:19:34.256119 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 12:19:34.256215 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 12:19:34.256327 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 12:19:34.256438 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 12:19:34.256532 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 12:19:34.256637 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 12:19:34.256732 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 12:19:34.256843 27867 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 12:19:34.256927 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 12:19:34.257006 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 12:19:34.257195 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 12:19:34.257330 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 12:19:34.257432 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 12:19:34.257529 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 12:19:34.257638 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 12:19:34.257751 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 12:19:34.257853 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 12:19:34.257966 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 12:19:34.258064 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 12:19:34.258186 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 12:19:34.258296 27867 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 12:19:34.258380 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 12:19:34.258461 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 12:19:34.258649 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 12:19:34.258764 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 12:19:34.258862 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 12:19:34.258958 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 12:19:34.259063 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 12:19:34.259161 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 12:19:34.259279 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 12:19:34.259382 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 12:19:34.259478 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 12:19:34.259586 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 12:19:34.259696 27867 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 12:19:34.259780 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 12:19:34.259864 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 12:19:34.260033 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 12:19:34.260165 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 12:19:34.260285 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 12:19:34.260391 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 12:19:34.260499 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 12:19:34.260597 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 12:19:34.260701 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 12:19:34.260818 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 12:19:34.260917 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 12:19:34.261029 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 12:19:34.261152 27867 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 12:19:34.261235 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 12:19:34.261330 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 12:19:34.261503 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 12:19:34.261633 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 12:19:34.261749 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 12:19:34.261866 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 12:19:34.261977 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 12:19:34.262091 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 12:19:34.262204 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 12:19:34.262312 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 12:19:34.262418 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 12:19:34.262549 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 12:19:34.262652 27867 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 12:19:34.262737 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 12:19:34.262837 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 12:19:34.263016 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 12:19:34.263134 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 12:19:34.263252 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 12:19:34.263374 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 12:19:34.263494 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 12:19:34.263595 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 12:19:34.263710 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 12:19:34.263837 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 12:19:34.263939 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 12:19:34.264087 27867 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 12:19:34.264201 27867 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 12:19:34.264282 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 12:19:34.264345 27867 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 12:19:34.801981 27867 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 12:26:48.504720 27867 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302733,   105297,  ..., 68730751, 49434564,  5063437]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1946.487 seconds
[Rank1] pid = 50861
[Rank2] pid = 50957
[Rank3] pid = 51024
[Rank4] pid = 51092
[Rank5] pid = 51225
[Rank6] pid = 51388
INFO [27867 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [50861 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [50957 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [51024 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [50957 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51092 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [51388 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [51092 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51225 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [51548 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [51388 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51225 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51548 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27867 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [50861 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 12:35:30.933326 50958 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 12:35:30.933919 51093 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 12:35:30.934118 51389 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 12:35:30.934156 51226 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 12:35:30.934221 51612 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 12:35:30.934505 51549 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 12:35:30.936229 50862 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
INFO [51024 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 12:35:30.941586 51025 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 12:35:31.006276 51549 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102049f48000 7.629 MB
W20240205 12:35:31.006276 51226 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020497a5000 7.629 MB
W20240205 12:35:31.019018 51612 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204a6ed000 7.629 MB
W20240205 12:35:31.019199 51389 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204ae92000 7.629 MB
W20240205 12:35:31.038142 51226 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10204b637000 7.629 MB
W20240205 12:35:31.038151 51389 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204bdda000 7.629 MB
W20240205 12:35:31.038172 51612 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204c57d000 7.629 MB
W20240205 12:35:31.038203 50862 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204cd20000 7.629 MB
W20240205 12:35:31.038302 50862 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204d4c3000 7.629 MB
W20240205 12:35:31.038427 50862 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10204dc66000 1.49 GB
W20240205 12:35:31.038483 50862 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1020ad249000 1.49 GB
W20240205 12:35:31.038591 50862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 12:35:31.058018 51549 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210c82c000 7.629 MB
W20240205 12:35:31.058079 51226 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10210cfcf000 1.49 GB
W20240205 12:35:31.058086 51389 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216c5b2000 1.49 GB
W20240205 12:35:31.058127 51226 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1021cbb95000 1.49 GB
W20240205 12:35:31.058136 51549 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10222b178000 1.49 GB
W20240205 12:35:31.058159 51389 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10228a75b000 1.49 GB
W20240205 12:35:31.058221 51549 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102349321000 1.49 GB
W20240205 12:35:31.058241 51226 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 12:35:31.058243 51389 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 12:35:31.058220 51612 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1022e9d3e000 1.49 GB
W20240205 12:35:31.058290 51549 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 12:35:31.058380 51612 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1023a8904000 1.49 GB
W20240205 12:35:31.058513 51612 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 12:35:31.059861 51025 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102407ee9000 7.629 MB
W20240205 12:35:31.059967 51025 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10240868c000 7.629 MB
W20240205 12:35:31.060021 51025 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102408e2f000 1.49 GB
W20240205 12:35:31.060081 51025 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102468412000 1.49 GB
W20240205 12:35:31.060134 51025 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 12:35:31.071679 50958 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1024c79f7000 7.629 MB
W20240205 12:35:31.071816 50958 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1024c81a6000 7.629 MB
W20240205 12:35:31.071832 50862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 12:35:31.071856 51389 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 12:35:31.071864 51226 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 12:35:31.071877 51025 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 12:35:31.071882 51549 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 12:35:31.071907 50958 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1024c8949000 1.49 GB
W20240205 12:35:31.071961 50958 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102527f2c000 1.49 GB
W20240205 12:35:31.071962 51612 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 12:35:31.072026 50958 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 12:35:31.084363 50958 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 12:35:31.084538 51093 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10258751f000 7.629 MB
W20240205 12:35:31.084767 51093 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102587cc2000 7.629 MB
W20240205 12:35:31.084914 51093 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102588465000 1.49 GB
W20240205 12:35:31.085037 51093 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1025e7a48000 1.49 GB
W20240205 12:35:31.085179 51093 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 12:35:31.089699 51093 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [51225 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [51092 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [51388 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 51548
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [27867 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [50861 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [50957 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [51024 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [51548 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 12:36:21.024142 51612 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.024220 50958 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.024444 51025 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.024992 51093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.025101 51389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.025604 51549 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.025650 50862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 12:36:21.025714 51226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 12:36:21.028182 51549 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 12:36:21.028419 51549 grad_base.h:184] Init GradProcessingBase done
I20240205 12:36:33.509476 51549 grad_async_v2.h:42] Use main thread to update emb.
W20240205 12:36:33.509723 51549 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 12:36:33.509733 51549 kg_controller.h:84] Construct KGCacheController done
E20240205 12:36:35.269166 51226 recstore.cc:66] init folly done
E20240205 12:36:35.269176 51389 recstore.cc:66] init folly done
E20240205 12:36:35.269179 51093 recstore.cc:66] init folly done
E20240205 12:36:35.269326 50958 recstore.cc:66] init folly done
E20240205 12:36:35.270009 51612 recstore.cc:66] init folly done
E20240205 12:36:35.270582 50862 recstore.cc:66] init folly done
E20240205 12:36:35.270591 51025 recstore.cc:66] init folly done
E20240205 12:36:35.270617 51549 recstore.cc:66] init folly done
I20240205 12:36:35.272029 51549 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 12:36:53.781188 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:36:53.781565 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:36:54.878841 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 12:36:54.878973 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.506 us                | 367.451 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 12:36:56.871238 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 12:36:56.885848 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 12:36:57.090345 51612 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 12:36:57.209328 51226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 12:36:57.218066 51093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 12:36:57.885011 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 12:36:57.966980 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240205 12:36:58.174908 50958 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 12:36:59.088860 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 12:36:59.105813 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 12:36:59.286451 51025 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 12:36:59.375754 51549 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 12:36:59.801026 50862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 12:37:00.168617 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 12:37:00.183140 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 146.288 us                | 284.756 us                |
+---------------------------+---------------------------+---------------------------+
I20240205 12:37:00.343756 51389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.193 ms                 | 10.193 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:02.864809 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 12:37:03.215080 51549 grad_async_v2.h:257] pq is empty
W20240205 12:37:03.219177 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 12:37:03.566058 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=3, pq.top=3
E20240205 12:37:03.864012 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=36
W20240205 12:37:04.408663 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240205 12:37:04.864012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
W20240205 12:37:05.153264 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 267.193 us                | 2.637 ms                  |
| ProcessBack:Shuffle       | 8.239 ms                  | 365.718 ms                |
| ProcessBack:UpdateCache   | 11.602 ms                 | 816.931 ms                |
| ProcessBack:UpsertPq      | 62.128 ms                 | 351.199 ms                |
| ProcessOneStep            | 102.525 ms                | 1.832 s                   |
| BlockToStepN              | 175.079 us                | 1.443 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:05.477466 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 12:37:05.849377 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=15, sample_step_cpp_seen_[rank]=14
E20240205 12:37:05.864006 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=459
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.995 ms                  | 548.616 ms                |
| Forward                   | 5.267 ms                  | 782.215 ms                |
| Backward                  | 4.622 ms                  | 236.863 ms                |
| Optimize                  | 2.381 ms                  | 15.903 ms                 |
| BarrierTimeBeforeRank0    | 2.849 ms                  | 63.021 ms                 |
| AfterBackward             | 94.102 ms                 | 1.833 s                   |
| BlockToStepN              | 671.061 us                | 6.202 ms                  |
| OneStep                   | 130.800 ms                | 2.872 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:06.592315 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240205 12:37:06.864012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240205 12:37:07.359545 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 12:37:07.688266 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 12:37:07.864008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=424
W20240205 12:37:08.446285 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240205 12:37:08.840471 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:37:08.864004 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=567
W20240205 12:37:09.863626 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 12:37:09.864005 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=77
W20240205 12:37:09.933351 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 348.276 us                | 2.440 ms                  |
| ProcessBack:Shuffle       | 7.612 ms                  | 337.858 ms                |
| ProcessBack:UpdateCache   | 10.253 ms                 | 816.157 ms                |
| ProcessBack:UpsertPq      | 33.618 ms                 | 204.083 ms                |
| ProcessOneStep            | 94.341 ms                 | 1.832 s                   |
| BlockToStepN              | 175.079 us                | 6.117 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:10.864009 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=4951
W20240205 12:37:10.918152 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 12:37:10.989223 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.768 ms                  | 548.616 ms                |
| Forward                   | 5.267 ms                  | 782.215 ms                |
| Backward                  | 4.622 ms                  | 236.863 ms                |
| Optimize                  | 2.188 ms                  | 15.903 ms                 |
| BarrierTimeBeforeRank0    | 3.087 ms                  | 76.242 ms                 |
| AfterBackward             | 94.102 ms                 | 1.833 s                   |
| BlockToStepN              | 270.613 us                | 6.202 ms                  |
| OneStep                   | 128.694 ms                | 2.872 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:11.601979 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=47, sample_step_cpp_seen_[rank]=46
E20240205 12:37:11.864010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3156
W20240205 12:37:12.103417 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
W20240205 12:37:12.739817 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=48, pq.top=48
E20240205 12:37:12.864040 53171 parallel_pq_v2.h:79] insert failed, size(hashtable)=43175
W20240205 12:37:13.195520 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 12:37:13.787401 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=56, pq.top=56
E20240205 12:37:13.864010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=5199
W20240205 12:37:14.308687 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 12:37:14.864012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 250.043 us                | 1.421 ms                  |
| ProcessBack:Shuffle       | 7.574 ms                  | 337.858 ms                |
| ProcessBack:UpdateCache   | 9.788 ms                  | 816.157 ms                |
| ProcessBack:UpsertPq      | 23.267 ms                 | 204.083 ms                |
| ProcessOneStep            | 90.738 ms                 | 1.156 s                   |
| BlockToStepN              | 589.122 us                | 3.705 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:15.326488 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
E20240205 12:37:15.864010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1023
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.995 ms                  | 114.643 ms                |
| Forward                   | 5.292 ms                  | 9.334 ms                  |
| Backward                  | 4.668 ms                  | 7.944 ms                  |
| Optimize                  | 2.468 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.922 ms                  | 73.347 ms                 |
| AfterBackward             | 91.012 ms                 | 1.156 s                   |
| BlockToStepN              | 611.309 us                | 3.792 ms                  |
| OneStep                   | 124.478 ms                | 1.177 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:16.441196 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240205 12:37:16.585484 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=73, pq.top=73
E20240205 12:37:16.864009 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
E20240205 12:37:17.360787 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=80, sample_step_cpp_seen_[rank]=79
W20240205 12:37:17.648275 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:37:17.864012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
W20240205 12:37:18.311021 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240205 12:37:18.666414 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240205 12:37:18.864007 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1661
W20240205 12:37:19.311029 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=90, pq.top=89
W20240205 12:37:19.725801 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:37:19.864008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 326.983 us                | 4.412 ms                  |
| ProcessBack:Shuffle       | 7.708 ms                  | 47.822 ms                 |
| ProcessBack:UpdateCache   | 9.976 ms                  | 40.773 ms                 |
| ProcessBack:UpsertPq      | 24.967 ms                 | 147.196 ms                |
| ProcessOneStep            | 90.669 ms                 | 1.156 s                   |
| BlockToStepN              | 589.122 us                | 6.117 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:20.757390 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240205 12:37:20.864008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=286
W20240205 12:37:20.950639 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=96, pq.top=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.806 ms                  | 114.643 ms                |
| Forward                   | 5.322 ms                  | 9.334 ms                  |
| Backward                  | 4.646 ms                  | 8.917 ms                  |
| Optimize                  | 2.622 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.721 ms                  | 76.242 ms                 |
| AfterBackward             | 90.715 ms                 | 1.156 s                   |
| BlockToStepN              | 674.004 us                | 8.577 ms                  |
| OneStep                   | 121.053 ms                | 1.177 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 24.314, sample: 1.542, forward: 1.328, backward: 0.788, update: 0.278
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 24.195, sample: 1.495, forward: 1.372, backward: 0.932, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 24.186, sample: 1.438, forward: 1.330, backward: 0.940, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 21.603, sample: 1.409, forward: 1.264, backward: 0.882, update: 0.249
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 21.060, sample: 1.466, forward: 1.267, backward: 0.965, update: 0.243
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.118, sample: 1.626, forward: 1.319, backward: 0.870, update: 0.289
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.229, sample: 1.169, forward: 1.282, backward: 0.854, update: 0.229
train_sampler.Prefill()
-------Step 0-------
tensor([   74923,    74953,    75007,    75044,  6019236,    90670, 55489348,
        15986484, 18475991,    75107]) tensor([ 5313849, 16997616, 53699829, 80341162, 18099594, 30976353, 32039657,
        70125029, 78027219, 25213915])
-------Step 1-------
tensor([   74923,    74953,    75007,    75044,  6019236,    90670, 55489348,
        15986484, 18475991,    75107]) tensor([61779484, 32302901,  9934680, 83958147, 82866130, 47800740, 65058368,
        42444149, 42534416, 12024364])
-------Step 2-------
tensor([  185704,   185759,   185805,    18930,   185853,   185890,   185925,
        21618141,   185966,   186017]) tensor([64411949, 25781241, 71872353, 43519787, 46627243, 24576113, 62082382,
        45707896, 12769229, 46850227])
-------Step 3-------
tensor([  185704,   185759,   185805,    18930,   185853,   185890,   185925,
        21618141,   185966,   186017]) tensor([55240010, 85273824, 30361117, 37438071, 56672082, 70718488, 31262004,
        14745968, 22857318,   670503])
-------Step 4-------
tensor([  295686, 45931004,   295742,   111039,   295784,   111065,   295831,
        39220572,   295875,   295924]) tensor([83718146,  9247707, 76707759, 15973008, 78431350, 37168522, 65907123,
        36669016, 85568473, 57951937])
-------Step 5-------
tensor([  295686, 45931004,   295742,   111039,   295784,   111065,   295831,
        39220572,   295875,   295924]) tensor([39405461, 70299351,   360127, 82594917, 64413494, 48232617, 13320896,
         8775068, 63839162, 35015138])
-------Step 6-------
tensor([  379339,    37248,   379360,   379379,    37268, 74116749,   379399,
          379420,   121247, 35506206]) tensor([11918333, 33152302, 39428331, 84176802, 37485946, 32078740, 20930534,
         6282847, 60689279, 84730021])
-------Step 7-------
tensor([  379339,    37248,   379360,   379379,    37268, 74116749,   379399,
          379420,   121247, 35506206]) tensor([26666848, 57582331, 70573512, 64919708, 72681491, 55824047, 47905349,
        63008868, 31038799, 27796204])
-------Step 8-------
tensor([  428450, 24945389,   428472,   130759,   428493,    46045,   428520,
          428541,   428561,   428577]) tensor([39078460, 28420807, 38954426,  1885258, 54608421, 58752823, 13463825,
        79071255,  1450424, 68683771])
-------Step 9-------
tensor([  428450, 24945389,   428472,   130759,   428493,    46045,   428520,
          428541,   428561,   428577]) tensor([54403656, 41176242, 12328330, 48064407,  9888831, 45190907, 30509357,
        42660817, 75904202, 59034183])
before start barrier
start train
[proc 0] 100 steps, total: 22.028, sample: 1.996, forward: 1.325, backward: 0.714, update: 0.303
E20240205 12:37:21.864017 53156 parallel_pq_v2.h:79] insert failed, size(hashtable)=35400
W20240205 12:37:21.879627 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
W20240205 12:37:22.283880 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=105, pq.top=105
E20240205 12:37:22.864013 53183 parallel_pq_v2.h:79] insert failed, size(hashtable)=8006
E20240205 12:37:22.992486 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=111, sample_step_cpp_seen_[rank]=110
W20240205 12:37:23.152258 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:37:23.867393 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:37:24.176560 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 12:37:24.374686 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240205 12:37:24.867008 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1436
W20240205 12:37:25.236811 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 352.064 us                | 9.182 ms                  |
| ProcessBack:Shuffle       | 7.805 ms                  | 49.625 ms                 |
| ProcessBack:UpdateCache   | 9.991 ms                  | 40.773 ms                 |
| ProcessBack:UpsertPq      | 24.967 ms                 | 147.196 ms                |
| ProcessOneStep            | 90.964 ms                 | 1.265 s                   |
| BlockToStepN              | 664.338 us                | 11.679 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:25.429816 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=120, pq.top=120
E20240205 12:37:25.867019 53151 parallel_pq_v2.h:79] insert failed, size(hashtable)=9912
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.892 ms                  | 114.643 ms                |
| Forward                   | 5.364 ms                  | 32.299 ms                 |
| Backward                  | 4.649 ms                  | 8.917 ms                  |
| Optimize                  | 2.581 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 4.207 ms                  | 96.276 ms                 |
| AfterBackward             | 91.012 ms                 | 1.265 s                   |
| BlockToStepN              | 908.850 us                | 11.795 ms                 |
| OneStep                   | 123.513 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:26.326762 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240205 12:37:26.867013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1574
W20240205 12:37:27.349797 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 12:37:27.867058 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=66001
W20240205 12:37:28.401593 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240205 12:37:28.737402 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240205 12:37:28.867530 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:37:29.462841 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
W20240205 12:37:29.763847 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240205 12:37:29.867018 53177 parallel_pq_v2.h:79] insert failed, size(hashtable)=10562
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 401.853 us                | 7.214 ms                  |
| ProcessBack:Shuffle       | 7.905 ms                  | 47.822 ms                 |
| ProcessBack:UpdateCache   | 10.015 ms                 | 16.274 ms                 |
| ProcessBack:UpsertPq      | 26.703 ms                 | 159.652 ms                |
| ProcessOneStep            | 91.279 ms                 | 1.265 s                   |
| BlockToStepN              | 755.159 us                | 26.637 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:30.511009 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=148, sample_step_cpp_seen_[rank]=147
W20240205 12:37:30.535681 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240205 12:37:30.867012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=4218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.341 ms                  | 114.643 ms                |
| Forward                   | 5.380 ms                  | 32.299 ms                 |
| Backward                  | 4.731 ms                  | 8.917 ms                  |
| Optimize                  | 2.616 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 5.001 ms                  | 96.276 ms                 |
| AfterBackward             | 91.984 ms                 | 1.265 s                   |
| BlockToStepN              | 898.496 us                | 26.778 ms                 |
| OneStep                   | 126.409 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:31.548027 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 12:37:31.867010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=25612
W20240205 12:37:31.984305 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 12:37:32.599303 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240205 12:37:32.867012 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=366
W20240205 12:37:33.436085 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240205 12:37:33.748225 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:37:33.867012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=141619
W20240205 12:37:34.842849 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240205 12:37:34.867007 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2746
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 296.010 us                | 3.295 ms                  |
| ProcessBack:Shuffle       | 7.968 ms                  | 47.822 ms                 |
| ProcessBack:UpdateCache   | 9.987 ms                  | 17.063 ms                 |
| ProcessBack:UpsertPq      | 26.048 ms                 | 162.490 ms                |
| ProcessOneStep            | 92.182 ms                 | 1.156 s                   |
| BlockToStepN              | 860.216 us                | 11.679 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:35.833555 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=170, pq.top=169
E20240205 12:37:35.868950 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:37:35.881001 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.719 ms                  | 218.307 ms                |
| Forward                   | 5.392 ms                  | 21.793 ms                 |
| Backward                  | 4.729 ms                  | 8.917 ms                  |
| Optimize                  | 2.565 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 4.332 ms                  | 95.043 ms                 |
| AfterBackward             | 92.275 ms                 | 1.156 s                   |
| BlockToStepN              | 968.891 us                | 12.945 ms                 |
| OneStep                   | 128.126 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:36.868008 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=17876
W20240205 12:37:36.892485 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240205 12:37:36.941265 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:37:37.054562 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=180, sample_step_cpp_seen_[rank]=179
E20240205 12:37:37.875560 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:37:37.967617 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 12:37:38.078429 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
E20240205 12:37:38.875015 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1033
W20240205 12:37:39.017370 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
W20240205 12:37:39.228370 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
E20240205 12:37:39.875101 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=35
W20240205 12:37:40.243906 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 337.785 us                | 14.833 ms                 |
| ProcessBack:Shuffle       | 8.039 ms                  | 33.678 ms                 |
| ProcessBack:UpdateCache   | 9.987 ms                  | 16.274 ms                 |
| ProcessBack:UpsertPq      | 25.776 ms                 | 159.652 ms                |
| ProcessOneStep            | 91.279 ms                 | 1.156 s                   |
| BlockToStepN              | 997.419 us                | 26.637 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:40.875013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.971 ms                  | 364.008 ms                |
| Forward                   | 5.385 ms                  | 21.793 ms                 |
| Backward                  | 4.753 ms                  | 8.917 ms                  |
| Optimize                  | 2.554 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.960 ms                  | 95.043 ms                 |
| AfterBackward             | 91.326 ms                 | 1.156 s                   |
| BlockToStepN              | 1.119 ms                  | 26.778 ms                 |
| OneStep                   | 128.168 ms                | 1.190 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:41.330734 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 12:37:41.875011 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=4308
W20240205 12:37:41.887259 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=198, pq.top=197
W20240205 12:37:42.392189 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
[proc 6] 200 steps, total: 21.072, sample: 1.180, forward: 0.543, backward: 0.648, update: 0.215
[proc 2] 200 steps, total: 21.072, sample: 1.668, forward: 0.731, backward: 0.661, update: 0.281
[proc 4] 200 steps, total: 21.073, sample: 1.338, forward: 0.592, backward: 0.805, update: 0.264
[proc 1] 200 steps, total: 21.073, sample: 1.355, forward: 0.549, backward: 0.642, update: 0.245
[proc 3] 200 steps, total: 21.073, sample: 1.923, forward: 0.527, backward: 0.564, update: 0.232
[proc 7] 200 steps, total: 21.073, sample: 1.139, forward: 0.549, backward: 0.653, update: 0.264
[proc 5] 200 steps, total: 21.073, sample: 1.312, forward: 0.566, backward: 0.653, update: 0.247
[proc 0] 200 steps, total: 21.072, sample: 2.815, forward: 0.602, backward: 0.502, update: 0.301
E20240205 12:37:42.875008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=4245
W20240205 12:37:43.048465 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240205 12:37:43.398684 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240205 12:37:43.838403 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=211, sample_step_cpp_seen_[rank]=210
E20240205 12:37:43.875017 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1717
W20240205 12:37:44.468382 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240205 12:37:44.698248 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=212, pq.top=212
E20240205 12:37:44.875046 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=69649
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 326.563 us                | 4.612 ms                  |
| ProcessBack:Shuffle       | 8.040 ms                  | 33.678 ms                 |
| ProcessBack:UpdateCache   | 9.987 ms                  | 16.274 ms                 |
| ProcessBack:UpsertPq      | 26.322 ms                 | 159.652 ms                |
| ProcessOneStep            | 91.038 ms                 | 1.265 s                   |
| BlockToStepN              | 904.821 us                | 39.353 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:45.475605 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 12:37:45.875216 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.085 ms                  | 364.008 ms                |
| Forward                   | 5.387 ms                  | 21.793 ms                 |
| Backward                  | 4.770 ms                  | 8.917 ms                  |
| Optimize                  | 2.554 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.721 ms                  | 95.043 ms                 |
| AfterBackward             | 91.326 ms                 | 1.265 s                   |
| BlockToStepN              | 987.001 us                | 39.458 ms                 |
| OneStep                   | 128.694 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:46.036325 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240205 12:37:46.503540 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 12:37:46.875013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=12538
W20240205 12:37:47.635147 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240205 12:37:47.875012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=14840
W20240205 12:37:47.964073 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 12:37:48.654024 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240205 12:37:48.875012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
W20240205 12:37:49.017264 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 12:37:49.817812 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 12:37:49.875007 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=5671
E20240205 12:37:49.927690 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=244, sample_step_cpp_seen_[rank]=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 374.412 us                | 10.826 ms                 |
| ProcessBack:Shuffle       | 8.073 ms                  | 22.581 ms                 |
| ProcessBack:UpdateCache   | 9.788 ms                  | 15.609 ms                 |
| ProcessBack:UpsertPq      | 25.505 ms                 | 147.196 ms                |
| ProcessOneStep            | 90.738 ms                 | 1.265 s                   |
| BlockToStepN              | 997.419 us                | 51.221 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:50.824095 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 12:37:50.875010 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=24939
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.086 ms                  | 364.008 ms                |
| Forward                   | 5.385 ms                  | 21.793 ms                 |
| Backward                  | 4.785 ms                  | 13.133 ms                 |
| Optimize                  | 2.555 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.718 ms                  | 95.043 ms                 |
| AfterBackward             | 90.923 ms                 | 1.265 s                   |
| BlockToStepN              | 1.119 ms                  | 51.350 ms                 |
| OneStep                   | 127.671 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:51.875011 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1387
W20240205 12:37:51.879839 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
W20240205 12:37:51.974192 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=252, pq.top=252
E20240205 12:37:52.875008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=653
W20240205 12:37:52.908495 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:37:53.875038 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=5722
W20240205 12:37:53.913524 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240205 12:37:54.320511 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=261, pq.top=261
E20240205 12:37:54.875044 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=516
W20240205 12:37:54.976399 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 390.334 us                | 6.724 ms                  |
| ProcessBack:Shuffle       | 8.115 ms                  | 22.581 ms                 |
| ProcessBack:UpdateCache   | 9.758 ms                  | 15.609 ms                 |
| ProcessBack:UpsertPq      | 25.194 ms                 | 147.196 ms                |
| ProcessOneStep            | 90.873 ms                 | 1.265 s                   |
| BlockToStepN              | 1.002 ms                  | 41.007 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:37:55.381183 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=269, pq.top=269
E20240205 12:37:55.875030 53162 parallel_pq_v2.h:79] insert failed, size(hashtable)=50112
W20240205 12:37:55.996753 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.429 ms                  | 326.624 ms                |
| Forward                   | 5.415 ms                  | 11.543 ms                 |
| Backward                  | 4.795 ms                  | 8.917 ms                  |
| Optimize                  | 2.581 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.169 ms                  | 85.318 ms                 |
| AfterBackward             | 90.923 ms                 | 1.265 s                   |
| BlockToStepN              | 1.227 ms                  | 41.148 ms                 |
| OneStep                   | 127.633 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:37:56.206759 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=275, sample_step_cpp_seen_[rank]=274
E20240205 12:37:56.875013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=6596
W20240205 12:37:57.010469 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 12:37:57.389771 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240205 12:37:57.875011 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=53001
W20240205 12:37:58.094027 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240205 12:37:58.449730 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=284, pq.top=284
E20240205 12:37:58.875010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=34474
W20240205 12:37:59.160856 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
W20240205 12:37:59.449100 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240205 12:37:59.881114 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 573.915 us                | 25.058 ms                 |
| ProcessBack:Shuffle       | 8.202 ms                  | 22.581 ms                 |
| ProcessBack:UpdateCache   | 9.742 ms                  | 15.480 ms                 |
| ProcessBack:UpsertPq      | 25.776 ms                 | 158.789 ms                |
| ProcessOneStep            | 90.951 ms                 | 1.265 s                   |
| BlockToStepN              | 1.208 ms                  | 52.889 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:00.279691 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
W20240205 12:38:00.710315 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=292, pq.top=292
E20240205 12:38:00.881014 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=354
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.901 ms                  | 326.624 ms                |
| Forward                   | 5.474 ms                  | 17.610 ms                 |
| Backward                  | 4.837 ms                  | 8.917 ms                  |
| Optimize                  | 2.622 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.131 ms                  | 85.318 ms                 |
| AfterBackward             | 90.998 ms                 | 1.265 s                   |
| BlockToStepN              | 1.345 ms                  | 53.009 ms                 |
| OneStep                   | 127.808 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:01.322142 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
W20240205 12:38:01.798209 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=300, pq.top=299
[proc 0] 300 steps, total: 19.346, sample: 2.279, forward: 0.591, backward: 0.527, update: 0.315
[proc 1] 300 steps, total: 19.346, sample: 1.109, forward: 0.533, backward: 0.644, update: 0.232
[proc 6] 300 steps, total: 19.346, sample: 1.281, forward: 0.633, backward: 0.703, update: 0.268
[proc 3] 300 steps, total: 19.346, sample: 1.464, forward: 0.591, backward: 0.680, update: 0.240
[proc 2] 300 steps, total: 19.346, sample: 1.153, forward: 0.608, backward: 0.709, update: 0.258
[proc 5] 300 steps, total: 19.346, sample: 0.962, forward: 0.569, backward: 0.787, update: 0.240
[proc 7] 300 steps, total: 19.346, sample: 0.977, forward: 0.542, backward: 0.695, update: 0.249
[proc 4] 300 steps, total: 19.346, sample: 1.115, forward: 0.598, backward: 0.670, update: 0.258
E20240205 12:38:01.881011 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=23278
W20240205 12:38:02.541754 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 12:38:02.545706 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=305, sample_step_cpp_seen_[rank]=304
E20240205 12:38:02.881017 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3117
W20240205 12:38:03.579147 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 12:38:03.881012 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1813
W20240205 12:38:03.899121 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240205 12:38:04.634955 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240205 12:38:04.881012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=9964
W20240205 12:38:05.008505 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 351.406 us                | 13.517 ms                 |
| ProcessBack:Shuffle       | 8.269 ms                  | 22.581 ms                 |
| ProcessBack:UpdateCache   | 9.675 ms                  | 15.480 ms                 |
| ProcessBack:UpsertPq      | 26.853 ms                 | 158.789 ms                |
| ProcessOneStep            | 90.991 ms                 | 1.265 s                   |
| BlockToStepN              | 1.345 ms                  | 52.889 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:05.851469 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 12:38:05.881004 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=5468
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.892 ms                  | 326.624 ms                |
| Forward                   | 5.503 ms                  | 17.610 ms                 |
| Backward                  | 4.904 ms                  | 10.655 ms                 |
| Optimize                  | 2.625 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.051 ms                  | 85.318 ms                 |
| AfterBackward             | 91.017 ms                 | 1.265 s                   |
| BlockToStepN              | 1.450 ms                  | 53.009 ms                 |
| OneStep                   | 128.126 ms                | 1.287 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:06.881013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:38:06.883498 53152 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240205 12:38:07.010322 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240205 12:38:07.881012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1752
W20240205 12:38:07.982324 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240205 12:38:08.045495 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=327, pq.top=327
E20240205 12:38:08.881014 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=100362
W20240205 12:38:08.999537 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240205 12:38:09.045578 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=335, pq.top=335
E20240205 12:38:09.388458 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=337, sample_step_cpp_seen_[rank]=336
E20240205 12:38:09.881014 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=4842
W20240205 12:38:10.093546 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 434.118 us                | 8.755 ms                  |
| ProcessBack:Shuffle       | 8.352 ms                  | 22.215 ms                 |
| ProcessBack:UpdateCache   | 9.742 ms                  | 15.686 ms                 |
| ProcessBack:UpsertPq      | 27.074 ms                 | 156.160 ms                |
| ProcessOneStep            | 91.038 ms                 | 1.356 s                   |
| BlockToStepN              | 1.360 ms                  | 57.835 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:10.881019 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.917 ms                  | 326.624 ms                |
| Forward                   | 5.489 ms                  | 17.610 ms                 |
| Backward                  | 4.882 ms                  | 10.655 ms                 |
| Optimize                  | 2.624 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 3.087 ms                  | 85.318 ms                 |
| AfterBackward             | 91.085 ms                 | 1.404 s                   |
| BlockToStepN              | 1.486 ms                  | 57.950 ms                 |
| OneStep                   | 128.708 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:11.109725 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 12:38:11.192454 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240205 12:38:11.881009 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=224
W20240205 12:38:12.158491 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 12:38:12.239523 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=346, pq.top=346
E20240205 12:38:12.881009 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1702
W20240205 12:38:13.213443 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 12:38:13.479373 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240205 12:38:13.881392 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 12:38:14.347635 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240205 12:38:14.388005 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=358, sample_step_cpp_seen_[rank]=357
E20240205 12:38:14.881012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2771
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 390.545 us                | 5.694 ms                  |
| ProcessBack:Shuffle       | 8.390 ms                  | 22.215 ms                 |
| ProcessBack:UpdateCache   | 9.729 ms                  | 15.686 ms                 |
| ProcessBack:UpsertPq      | 27.648 ms                 | 158.789 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.356 s                   |
| BlockToStepN              | 1.409 ms                  | 52.889 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:15.353652 53152 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 12:38:15.725340 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240205 12:38:15.881012 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=55540
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.085 ms                  | 299.052 ms                |
| Forward                   | 5.489 ms                  | 12.490 ms                 |
| Backward                  | 4.935 ms                  | 10.589 ms                 |
| Optimize                  | 2.630 ms                  | 7.207 ms                  |
| BarrierTimeBeforeRank0    | 3.165 ms                  | 82.187 ms                 |
| AfterBackward             | 91.326 ms                 | 1.356 s                   |
| BlockToStepN              | 1.508 ms                  | 57.950 ms                 |
| OneStep                   | 129.341 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:16.436589 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240205 12:38:16.883201 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:38:17.759886 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240205 12:38:17.883009 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3363
W20240205 12:38:18.422811 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240205 12:38:18.781785 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240205 12:38:18.883010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=13965
W20240205 12:38:19.614567 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240205 12:38:19.809607 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 12:38:19.865725 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=385, sample_step_cpp_seen_[rank]=384
E20240205 12:38:19.883006 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 404.168 us                | 10.821 ms                 |
| ProcessBack:Shuffle       | 8.322 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.702 ms                  | 15.609 ms                 |
| ProcessBack:UpsertPq      | 27.518 ms                 | 156.160 ms                |
| ProcessOneStep            | 91.038 ms                 | 1.404 s                   |
| BlockToStepN              | 1.443 ms                  | 60.626 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:20.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=654
W20240205 12:38:20.889294 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.023 ms                  | 299.052 ms                |
| Forward                   | 5.447 ms                  | 12.490 ms                 |
| Backward                  | 4.942 ms                  | 10.589 ms                 |
| Optimize                  | 2.638 ms                  | 7.207 ms                  |
| BarrierTimeBeforeRank0    | 3.087 ms                  | 82.187 ms                 |
| AfterBackward             | 91.085 ms                 | 1.404 s                   |
| BlockToStepN              | 1.537 ms                  | 60.751 ms                 |
| OneStep                   | 129.917 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:21.284754 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=387, pq.top=387
E20240205 12:38:21.883010 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1596
W20240205 12:38:21.968459 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 12:38:22.412519 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
E20240205 12:38:22.883041 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=65758
W20240205 12:38:23.040282 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
[proc 2] 400 steps, total: 21.284, sample: 0.953, forward: 0.507, backward: 0.578, update: 0.226
[proc 6] 400 steps, total: 21.284, sample: 1.213, forward: 0.580, backward: 0.651, update: 0.258
[proc 7] 400 steps, total: 21.284, sample: 1.000, forward: 0.551, backward: 0.630, update: 0.243
[proc 3] 400 steps, total: 21.284, sample: 1.455, forward: 0.562, backward: 0.813, update: 0.246
[proc 0] 400 steps, total: 21.284, sample: 1.680, forward: 0.535, backward: 0.540, update: 0.279
[proc 1] 400 steps, total: 21.284, sample: 1.095, forward: 0.522, backward: 0.696, update: 0.246
[proc 4] 400 steps, total: 21.284, sample: 1.046, forward: 0.625, backward: 0.736, update: 0.251
[proc 5] 400 steps, total: 21.284, sample: 1.054, forward: 0.584, backward: 0.681, update: 0.255
E20240205 12:38:23.883028 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
W20240205 12:38:24.151463 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
W20240205 12:38:24.487154 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=403, pq.top=403
E20240205 12:38:24.883018 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3082
W20240205 12:38:25.236835 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 404.059 us                | 8.731 ms                  |
| ProcessBack:Shuffle       | 8.309 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.667 ms                  | 15.609 ms                 |
| ProcessBack:UpsertPq      | 27.392 ms                 | 156.160 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.404 s                   |
| BlockToStepN              | 1.445 ms                  | 64.215 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:25.677543 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
E20240205 12:38:25.883100 53158 parallel_pq_v2.h:79] insert failed, size(hashtable)=17524
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.239 ms                  | 299.052 ms                |
| Forward                   | 5.457 ms                  | 12.490 ms                 |
| Backward                  | 4.978 ms                  | 10.589 ms                 |
| Optimize                  | 2.625 ms                  | 7.207 ms                  |
| BarrierTimeBeforeRank0    | 2.914 ms                  | 82.187 ms                 |
| AfterBackward             | 91.326 ms                 | 1.404 s                   |
| BlockToStepN              | 1.548 ms                  | 64.371 ms                 |
| OneStep                   | 130.629 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:26.214174 51549 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=415, sample_step_cpp_seen_[rank]=414
W20240205 12:38:26.345362 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 12:38:26.883010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1699
W20240205 12:38:27.347584 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 12:38:27.418991 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=416, pq.top=416
E20240205 12:38:27.883495 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:38:28.465977 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
W20240205 12:38:28.477188 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240205 12:38:28.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240205 12:38:29.557794 53152 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 12:38:29.883011 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2046
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 529.987 us                | 21.418 ms                 |
| ProcessBack:Shuffle       | 8.322 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.662 ms                  | 15.480 ms                 |
| ProcessBack:UpsertPq      | 27.061 ms                 | 153.216 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.404 s                   |
| BlockToStepN              | 1.475 ms                  | 64.215 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:30.591233 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 12:38:30.685103 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=432, pq.top=432
E20240205 12:38:30.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=60850
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.468 ms                  | 299.052 ms                |
| Forward                   | 5.474 ms                  | 14.168 ms                 |
| Backward                  | 4.995 ms                  | 10.589 ms                 |
| Optimize                  | 2.620 ms                  | 7.278 ms                  |
| BarrierTimeBeforeRank0    | 2.802 ms                  | 82.187 ms                 |
| AfterBackward             | 91.984 ms                 | 1.404 s                   |
| BlockToStepN              | 1.642 ms                  | 64.371 ms                 |
| OneStep                   | 131.104 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:31.622746 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
W20240205 12:38:31.861200 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240205 12:38:31.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=43032
W20240205 12:38:32.672159 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 12:38:32.883014 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=12095
W20240205 12:38:32.943946 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240205 12:38:33.219292 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=449, sample_step_cpp_seen_[rank]=448
W20240205 12:38:33.733944 53152 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240205 12:38:33.883008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=98
W20240205 12:38:34.753479 53152 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240205 12:38:34.883010 52427 parallel_pq_v2.h:79] insert failed, size(hashtable)=22695
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 584.420 us                | 31.489 ms                 |
| ProcessBack:Shuffle       | 8.352 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.662 ms                  | 15.480 ms                 |
| ProcessBack:UpsertPq      | 27.254 ms                 | 153.216 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.356 s                   |
| BlockToStepN              | 1.576 ms                  | 64.215 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:35.864854 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240205 12:38:35.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=202026
W20240205 12:38:35.932181 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.500 ms                  | 246.227 ms                |
| Forward                   | 5.474 ms                  | 14.168 ms                 |
| Backward                  | 4.995 ms                  | 8.917 ms                  |
| Optimize                  | 2.602 ms                  | 7.207 ms                  |
| BarrierTimeBeforeRank0    | 2.886 ms                  | 76.242 ms                 |
| AfterBackward             | 91.326 ms                 | 1.356 s                   |
| BlockToStepN              | 1.679 ms                  | 64.371 ms                 |
| OneStep                   | 131.708 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:36.883009 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=3700
W20240205 12:38:37.087288 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240205 12:38:37.433110 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240205 12:38:37.883826 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 12:38:38.152828 53152 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 12:38:38.512593 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=473, pq.top=473
E20240205 12:38:38.883010 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=52898
W20240205 12:38:39.217015 53152 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
W20240205 12:38:39.582674 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=481, pq.top=481
E20240205 12:38:39.726585 52427 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=482, sample_step_cpp_seen_[rank]=481
E20240205 12:38:39.883008 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=56973
W20240205 12:38:40.222756 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 685.298 us                | 34.120 ms                 |
| ProcessBack:Shuffle       | 8.374 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.632 ms                  | 15.119 ms                 |
| ProcessBack:UpsertPq      | 27.192 ms                 | 147.196 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.356 s                   |
| BlockToStepN              | 1.667 ms                  | 80.534 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 12:38:40.883013 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=2896
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.753 ms                  | 246.227 ms                |
| Forward                   | 5.474 ms                  | 14.168 ms                 |
| Backward                  | 4.996 ms                  | 8.917 ms                  |
| Optimize                  | 2.602 ms                  | 7.207 ms                  |
| BarrierTimeBeforeRank0    | 2.886 ms                  | 76.242 ms                 |
| AfterBackward             | 91.984 ms                 | 1.356 s                   |
| BlockToStepN              | 1.781 ms                  | 80.689 ms                 |
| OneStep                   | 131.714 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 12:38:41.244277 53152 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end7
E20240205 12:38:41.883009 51549 parallel_pq_v2.h:79] insert failed, size(hashtable)=926
W20240205 12:38:41.978543 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240205 12:38:42.363917 53152 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 12:38:42.883011 53152 parallel_pq_v2.h:79] insert failed, size(hashtable)=1874
W20240205 12:38:43.470119 53152 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
W20240205 12:38:43.662199 51549 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 2] 500 steps, total: 20.709, sample: 1.037, forward: 0.578, backward: 0.710, update: 0.239
[proc 5] 500 steps, total: 20.709, sample: 0.971, forward: 0.612, backward: 0.693, update: 0.251
[proc 4] 500 steps, total: 20.709, sample: 1.047, forward: 0.601, backward: 0.652, update: 0.259
[proc 6] 500 steps, total: 20.709, sample: 1.087, forward: 0.574, backward: 0.631, update: 0.263
[proc 3] 500 steps, total: 20.709, sample: 1.160, forward: 0.553, backward: 0.663, update: 0.248
[proc 7] 500 steps, total: 20.709, sample: 0.994, forward: 0.569, backward: 0.786, update: 0.264
[proc 0] 500 steps, total: 20.709, sample: 2.158, forward: 0.568, backward: 0.515, update: 0.274
[proc 1] 500 steps, total: 20.709, sample: 1.088, forward: 0.660, backward: 0.746, update: 0.260
Successfully xmh. training takes 104.44066977500916 seconds
before call kg_cache_controller.StopThreads()
W20240205 12:38:43.816579 51549 grad_async_v2.h:84] call StopThreads. PID = 27867
W20240205 12:38:43.816612 51549 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 12:38:43.817580 51549 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 12:38:43.817588 51549 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240205 12:38:43.851716 51549 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 531.488 us                | 27.021 ms                 |
| ProcessBack:Shuffle       | 8.434 ms                  | 19.973 ms                 |
| ProcessBack:UpdateCache   | 9.634 ms                  | 15.119 ms                 |
| ProcessBack:UpsertPq      | 27.061 ms                 | 147.196 ms                |
| ProcessOneStep            | 91.934 ms                 | 1.356 s                   |
| BlockToStepN              | 1.673 ms                  | 80.534 ms                 |
+---------------------------+---------------------------+---------------------------+
