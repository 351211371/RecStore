WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 20:32:41.315853  1824 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_99', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=6, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1824 sampler.py:454] Start PreSampling
WARNING [1824 sampler.py:532] Before construct renumbering_dict
WARNING [1824 sampler.py:555] PreSampling done
W20240204 20:53:25.123922  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 20:53:25.124150  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 20:53:25.124190  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 20:53:25.124228  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 20:53:25.124264  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 20:53:25.124305  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 20:53:25.124341  1824 IPCTensor.h:369] NewIPCTensor: step_r0 [6]0x100002dd4000 48 B 
W20240204 20:53:25.124373  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100002dd6000 8 B 
W20240204 20:53:25.124400  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100002dd8000 8 B 
W20240204 20:53:25.124559  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100002dda000 7.629 MB
W20240204 20:53:25.124599  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10000357d000 7.629 MB
W20240204 20:53:25.124634  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100003d20000 7.629 MB
W20240204 20:53:25.124662  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000044c3000 7.629 MB
W20240204 20:53:25.124694  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100004c66000 7.629 MB
W20240204 20:53:25.124728  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100005409000 7.629 MB
W20240204 20:53:25.124763  1824 IPCTensor.h:369] NewIPCTensor: step_r1 [6]0x100005bac000 48 B 
W20240204 20:53:25.124800  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100005bae000 8 B 
W20240204 20:53:25.124832  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100005bb0000 8 B 
W20240204 20:53:25.124891  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100005bb2000 7.629 MB
W20240204 20:53:25.124928  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100006355000 7.629 MB
W20240204 20:53:25.124959  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100006af8000 7.629 MB
W20240204 20:53:25.124989  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000729b000 7.629 MB
W20240204 20:53:25.125025  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100007a3e000 7.629 MB
W20240204 20:53:25.125059  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000081e1000 7.629 MB
W20240204 20:53:25.125097  1824 IPCTensor.h:369] NewIPCTensor: step_r2 [6]0x100008984000 48 B 
W20240204 20:53:25.125119  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x100008986000 8 B 
W20240204 20:53:25.125145  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100008988000 8 B 
W20240204 20:53:25.125221  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000898a000 7.629 MB
W20240204 20:53:25.125250  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000912d000 7.629 MB
W20240204 20:53:25.125279  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000098d0000 7.629 MB
W20240204 20:53:25.125316  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000a073000 7.629 MB
W20240204 20:53:25.125342  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10000a816000 7.629 MB
W20240204 20:53:25.125372  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10000afb9000 7.629 MB
W20240204 20:53:25.125406  1824 IPCTensor.h:369] NewIPCTensor: step_r3 [6]0x10000b75c000 48 B 
W20240204 20:53:25.125428  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10000b75e000 8 B 
W20240204 20:53:25.125452  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10000b760000 8 B 
W20240204 20:53:25.125504  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10000b762000 7.629 MB
W20240204 20:53:25.125541  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x10000bf05000 7.629 MB
W20240204 20:53:25.125569  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x10000c6a8000 7.629 MB
W20240204 20:53:25.125602  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10000ce4b000 7.629 MB
W20240204 20:53:25.125633  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10000d5ee000 7.629 MB
W20240204 20:53:25.125665  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x10000dd91000 7.629 MB
W20240204 20:53:25.125701  1824 IPCTensor.h:369] NewIPCTensor: step_r4 [6]0x10000e534000 48 B 
W20240204 20:53:25.125723  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x10000e536000 8 B 
W20240204 20:53:25.125747  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10000e538000 8 B 
W20240204 20:53:25.125802  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x10000e53a000 7.629 MB
W20240204 20:53:25.125841  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x10000ecdd000 7.629 MB
W20240204 20:53:25.125869  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10000f480000 7.629 MB
W20240204 20:53:25.125895  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x10000fc23000 7.629 MB
W20240204 20:53:25.125921  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000103c6000 7.629 MB
W20240204 20:53:25.125952  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100010b69000 7.629 MB
W20240204 20:53:25.125978  1824 IPCTensor.h:369] NewIPCTensor: step_r5 [6]0x10001130c000 48 B 
W20240204 20:53:25.126008  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001130e000 8 B 
W20240204 20:53:25.126030  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100011310000 8 B 
W20240204 20:53:25.126080  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x100011312000 7.629 MB
W20240204 20:53:25.126118  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x100011ab5000 7.629 MB
W20240204 20:53:25.126147  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x100012258000 7.629 MB
W20240204 20:53:25.126179  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000129fb000 7.629 MB
W20240204 20:53:25.126206  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001319e000 7.629 MB
W20240204 20:53:25.126245  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x100013941000 7.629 MB
W20240204 20:53:25.126271  1824 IPCTensor.h:369] NewIPCTensor: step_r6 [6]0x1000140e4000 48 B 
W20240204 20:53:25.126293  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000140e6000 8 B 
W20240204 20:53:25.126315  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000140e8000 8 B 
W20240204 20:53:25.126367  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000140ea000 7.629 MB
W20240204 20:53:25.126400  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10001488d000 7.629 MB
W20240204 20:53:25.126430  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100015030000 7.629 MB
W20240204 20:53:25.126470  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000157d3000 7.629 MB
W20240204 20:53:25.126497  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x100015f76000 7.629 MB
W20240204 20:53:25.126524  1824 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100016719000 7.629 MB
W20240204 20:53:25.126551  1824 IPCTensor.h:369] NewIPCTensor: step_r7 [6]0x100016ebc000 48 B 
W20240204 20:53:25.126574  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100016ebe000 8 B 
W20240204 20:53:25.126601  1824 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100016ec0000 8 B 
W20240204 20:53:25.560585  1824 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100016ec2000 128.2 GB
W20240204 21:02:07.704639  1824 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102025afa000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302719,  4302758,    85189,  ..., 55267806, 50876852,  4926633]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2276.550 seconds
[Rank1] pid = 28220
[Rank2] pid = 28314
[Rank3] pid = 28381
[Rank4] pid = 28511
[Rank5] pid = 28717
[Rank6] pid = 28915
INFO [1824 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28220 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [28314 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [28381 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [28915 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [28511 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [28717 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29101 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [29101 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28717 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28915 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28511 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28381 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 21:10:49.413314 28719 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 21:10:49.413388 29165 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 21:10:49.413412 28916 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 21:10:49.413456 28512 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 21:10:49.413539 28382 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
INFO [28314 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1824 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28220 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 21:10:49.418359 28315 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 21:10:49.419464 29102 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 21:10:49.420590 28221 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 21:10:49.493990 29165 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10203a343000 7.629 MB
W20240204 21:10:49.494153 29102 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10203aaf4000 7.629 MB
W20240204 21:10:49.494168 28719 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10203b297000 7.629 MB
W20240204 21:10:49.494180 29165 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10203c1dd000 7.629 MB
W20240204 21:10:49.494179 28512 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10203ba3a000 7.629 MB
W20240204 21:10:49.494216 28315 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203c980000 7.629 MB
W20240204 21:10:49.494251 29165 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10203d8c6000 1.49 GB
W20240204 21:10:49.494249 28382 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10203d123000 7.629 MB
W20240204 21:10:49.494261 28916 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10209cea9000 7.629 MB
W20240204 21:10:49.494266 28221 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10209d64c000 7.629 MB
W20240204 21:10:49.494284 29102 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10209ddef000 7.629 MB
W20240204 21:10:49.494311 29165 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10209e592000 1.49 GB
W20240204 21:10:49.494347 28719 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020fdb75000 7.629 MB
W20240204 21:10:49.494349 29102 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020fe318000 1.49 GB
W20240204 21:10:49.494372 28512 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10215d8fb000 7.629 MB
W20240204 21:10:49.494380 29165 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 21:10:49.494390 29102 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10215e09e000 1.49 GB
W20240204 21:10:49.494422 28719 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021bd681000 1.49 GB
W20240204 21:10:49.494437 29102 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 21:10:49.494446 28512 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10221cc64000 1.49 GB
W20240204 21:10:49.494454 28916 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10227c247000 7.629 MB
W20240204 21:10:49.494462 28315 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10227c9ea000 7.629 MB
W20240204 21:10:49.494469 28382 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10227d18d000 7.629 MB
W20240204 21:10:49.494475 28221 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10227d930000 7.629 MB
W20240204 21:10:49.494493 28719 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10227e0d3000 1.49 GB
W20240204 21:10:49.494520 28512 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022dd6b6000 1.49 GB
W20240204 21:10:49.494535 28916 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10233cc99000 1.49 GB
W20240204 21:10:49.494558 28382 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10239c27c000 1.49 GB
W20240204 21:10:49.494571 28719 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 21:10:49.494585 28916 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023fb85f000 1.49 GB
W20240204 21:10:49.494592 28315 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10245ae42000 1.49 GB
W20240204 21:10:49.494601 28221 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1024ba425000 1.49 GB
W20240204 21:10:49.494616 28512 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 21:10:49.494624 28382 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102519a08000 1.49 GB
W20240204 21:10:49.494659 28315 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102578feb000 1.49 GB
W20240204 21:10:49.494666 28221 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025d85ce000 1.49 GB
W20240204 21:10:49.494673 28916 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 21:10:49.494686 28382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 21:10:49.494720 28221 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 21:10:49.494720 28315 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 21:10:49.507254 28221 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 21:10:49.507269 28315 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 21:10:49.507277 28512 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 21:10:49.507282 28916 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 21:10:49.507294 28382 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 21:10:49.507299 29102 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 21:10:49.507313 28719 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 21:10:49.507323 29165 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
cudaHostRegister 0x100016ec2000
3: KnownLocalCachedEmbedding init done
WARNING [28381 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
5: KnownLocalCachedEmbedding init done
WARNING [28717 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
4: KnownLocalCachedEmbedding init done
WARNING [28511 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
1: KnownLocalCachedEmbedding init done
WARNING [28220 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 29101
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100016ec2000
0: KnownLocalCachedEmbedding init done
WARNING [1824 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
2: KnownLocalCachedEmbedding init done
WARNING [28314 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
6: KnownLocalCachedEmbedding init done
WARNING [28915 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100016ec2000
7: KnownLocalCachedEmbedding init done
WARNING [29101 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 21:11:39.106520 29165 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.106598 29102 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.106719 28315 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.106779 28916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.106853 28221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.106988 28512 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.107167 28382 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 21:11:39.107836 28719 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 21:11:39.109755 29102 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 6,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 21:11:39.109917 29102 grad_base.h:184] Init GradProcessingBase done
I20240204 21:11:52.278301 29102 grad_async_v1.h:203] Use main thread to update emb.
W20240204 21:11:52.278453 29102 kg_controller.h:75] after init GradAsyncProcessing
I20240204 21:11:52.278462 29102 kg_controller.h:84] Construct KGCacheController done
E20240204 21:11:53.048645 28221 recstore.cc:66] init folly done
E20240204 21:11:53.048710 28719 recstore.cc:66] init folly done
E20240204 21:11:53.048751 28315 recstore.cc:66] init folly done
E20240204 21:11:53.048729 28916 recstore.cc:66] init folly done
E20240204 21:11:53.048755 28512 recstore.cc:66] init folly done
E20240204 21:11:53.048772 29102 recstore.cc:66] init folly done
E20240204 21:11:53.048846 29165 recstore.cc:66] init folly done
E20240204 21:11:53.049410 28382 recstore.cc:66] init folly done
I20240204 21:11:53.050360 29102 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 21:12:15.748613 29165 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 21:12:15.749631 28719 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:16.040889 28512 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:16.422508 28315 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:17.454125 28221 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:17.479434 29102 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:18.479921 28382 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 21:12:20.179169 28916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 21:12:22.560400 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 258.872 ms                | 293.321 ms                |
| ProcessBack:UpdateCache   | 683.718 ms                | 684.923 ms                |
| ProcessBack:UpsertPq      | 37.363 ms                 | 39.007 ms                 |
| ProcessOneStep            | 1.317 s                   | 1.317 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:23.639102 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.971 ms                  | 9.334 ms                  |
| Forward                   | 8.956 ms                  | 784.613 ms                |
| Backward                  | 11.813 ms                 | 230.950 ms                |
| Optimize                  | 4.795 ms                  | 5.333 ms                  |
| BarrierTimeBeforeRank0    | 18.564 ms                 | 32.686 ms                 |
| AfterBackward             | 69.508 ms                 | 1.318 s                   |
| BlockToStepN              | 7.710 ms                  | 862.193 ms                |
| OneStep                   | 96.646 ms                 | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:24.705652 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240204 21:12:25.793772 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240204 21:12:26.832139 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.011 ms                  | 293.321 ms                |
| ProcessBack:UpdateCache   | 11.901 ms                 | 684.923 ms                |
| ProcessBack:UpsertPq      | 56.564 ms                 | 91.771 ms                 |
| ProcessOneStep            | 89.209 ms                 | 1.317 s                   |
| BlockToStepN              | 7.659 ms                  | 860.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:28.253916 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.970 ms                  | 190.568 ms                |
| Forward                   | 6.018 ms                  | 784.613 ms                |
| Backward                  | 11.141 ms                 | 230.950 ms                |
| Optimize                  | 4.326 ms                  | 6.894 ms                  |
| BarrierTimeBeforeRank0    | 2.443 ms                  | 190.628 ms                |
| AfterBackward             | 89.262 ms                 | 1.318 s                   |
| BlockToStepN              | 781.983 ms                | 862.193 ms                |
| OneStep                   | 917.394 ms                | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:29.548492 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=12, pq.top=12
W20240204 21:12:30.603375 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240204 21:12:31.610267 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
W20240204 21:12:32.710239 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.797 ms                  | 293.321 ms                |
| ProcessBack:UpdateCache   | 12.555 ms                 | 684.923 ms                |
| ProcessBack:UpsertPq      | 46.169 ms                 | 91.771 ms                 |
| ProcessOneStep            | 72.552 ms                 | 1.317 s                   |
| BlockToStepN              | 7.659 ms                  | 860.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:33.710005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.019 ms                 | 406.778 ms                |
| Forward                   | 5.488 ms                  | 784.613 ms                |
| Backward                  | 10.697 ms                 | 230.950 ms                |
| Optimize                  | 2.986 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 53.909 us                 | 190.628 ms                |
| AfterBackward             | 71.037 ms                 | 1.318 s                   |
| BlockToStepN              | 7.710 ms                  | 862.193 ms                |
| OneStep                   | 518.594 ms                | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:34.710008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 21:12:35.710007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240204 21:12:36.981652 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.052 ms                 | 258.872 ms                |
| ProcessBack:UpdateCache   | 12.655 ms                 | 683.718 ms                |
| ProcessBack:UpsertPq      | 43.165 ms                 | 88.649 ms                 |
| ProcessOneStep            | 69.917 ms                 | 1.317 s                   |
| BlockToStepN              | 7.659 ms                  | 860.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:38.062299 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 21:12:39.062007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 15.047 ms                 | 406.778 ms                |
| Forward                   | 5.406 ms                  | 784.613 ms                |
| Backward                  | 10.017 ms                 | 230.950 ms                |
| Optimize                  | 2.865 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 38.394 us                 | 190.628 ms                |
| AfterBackward             | 69.508 ms                 | 1.318 s                   |
| BlockToStepN              | 7.710 ms                  | 862.193 ms                |
| OneStep                   | 518.594 ms                | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:40.062008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240204 21:12:41.062011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240204 21:12:42.062008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.052 ms                 | 258.872 ms                |
| ProcessBack:UpdateCache   | 12.472 ms                 | 683.718 ms                |
| ProcessBack:UpsertPq      | 41.074 ms                 | 88.649 ms                 |
| ProcessOneStep            | 67.339 ms                 | 1.317 s                   |
| BlockToStepN              | 7.869 ms                  | 860.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:43.062808 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 21:12:44.062007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.554 ms                 | 406.778 ms                |
| Forward                   | 5.053 ms                  | 784.613 ms                |
| Backward                  | 10.006 ms                 | 230.950 ms                |
| Optimize                  | 2.655 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.969 us                 | 190.628 ms                |
| AfterBackward             | 67.024 ms                 | 1.318 s                   |
| BlockToStepN              | 7.929 ms                  | 862.193 ms                |
| OneStep                   | 518.594 ms                | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:45.330451 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 21:12:46.401466 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240204 21:12:47.401007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.227 ms                 | 258.872 ms                |
| ProcessBack:UpdateCache   | 12.555 ms                 | 683.718 ms                |
| ProcessBack:UpsertPq      | 40.061 ms                 | 88.649 ms                 |
| ProcessOneStep            | 67.339 ms                 | 1.317 s                   |
| BlockToStepN              | 7.869 ms                  | 860.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:48.473356 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.303 ms                 | 406.778 ms                |
| Forward                   | 5.072 ms                  | 784.613 ms                |
| Backward                  | 10.000 ms                 | 230.950 ms                |
| Optimize                  | 2.682 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 38.394 us                 | 190.628 ms                |
| AfterBackward             | 67.370 ms                 | 1.318 s                   |
| BlockToStepN              | 7.929 ms                  | 862.193 ms                |
| OneStep                   | 518.594 ms                | 3.244 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:49.473008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 21:12:50.568809 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 21:12:51.658275 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240204 21:12:52.681030 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.172 ms                 | 258.872 ms                |
| ProcessBack:UpdateCache   | 12.892 ms                 | 683.718 ms                |
| ProcessBack:UpsertPq      | 41.742 ms                 | 103.865 ms                |
| ProcessOneStep            | 69.853 ms                 | 153.461 ms                |
| BlockToStepN              | 7.869 ms                  | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:54.023011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.334 ms                  | 387.068 ms                |
| Forward                   | 5.053 ms                  | 18.288 ms                 |
| Backward                  | 10.006 ms                 | 22.304 ms                 |
| Optimize                  | 2.832 ms                  | 7.070 ms                  |
| BarrierTimeBeforeRank0    | 53.909 us                 | 39.937 ms                 |
| AfterBackward             | 69.987 ms                 | 153.510 ms                |
| BlockToStepN              | 7.929 ms                  | 822.129 ms                |
| OneStep                   | 518.594 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:55.064332 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 21:12:56.064006 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240204 21:12:57.064006 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.209 ms                 | 258.872 ms                |
| ProcessBack:UpdateCache   | 12.951 ms                 | 683.718 ms                |
| ProcessBack:UpsertPq      | 41.777 ms                 | 103.865 ms                |
| ProcessOneStep            | 69.853 ms                 | 153.461 ms                |
| BlockToStepN              | 7.869 ms                  | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:58.064010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.334 ms                  | 387.068 ms                |
| Forward                   | 5.053 ms                  | 18.288 ms                 |
| Backward                  | 10.036 ms                 | 22.304 ms                 |
| Optimize                  | 2.708 ms                  | 7.070 ms                  |
| BarrierTimeBeforeRank0    | 41.926 us                 | 39.937 ms                 |
| AfterBackward             | 69.894 ms                 | 153.510 ms                |
| BlockToStepN              | 377.366 ms                | 822.129 ms                |
| OneStep                   | 515.300 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:12:59.280433 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 21:13:00.280012 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240204 21:13:01.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240204 21:13:02.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.170 ms                 | 23.063 ms                 |
| ProcessBack:UpdateCache   | 12.951 ms                 | 20.543 ms                 |
| ProcessBack:UpsertPq      | 41.855 ms                 | 100.925 ms                |
| ProcessOneStep            | 69.853 ms                 | 153.461 ms                |
| BlockToStepN              | 7.869 ms                  | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:03.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.399 ms                 | 387.068 ms                |
| Forward                   | 5.001 ms                  | 18.288 ms                 |
| Backward                  | 10.126 ms                 | 22.304 ms                 |
| Optimize                  | 2.796 ms                  | 7.070 ms                  |
| BarrierTimeBeforeRank0    | 39.694 us                 | 39.937 ms                 |
| AfterBackward             | 69.894 ms                 | 153.510 ms                |
| BlockToStepN              | 7.929 ms                  | 822.129 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:04.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 21:13:05.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 21:13:06.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240204 21:13:07.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.111 ms                 | 23.063 ms                 |
| ProcessBack:UpdateCache   | 13.024 ms                 | 20.543 ms                 |
| ProcessBack:UpsertPq      | 41.399 ms                 | 100.925 ms                |
| ProcessOneStep            | 68.534 ms                 | 153.461 ms                |
| BlockToStepN              | 7.869 ms                  | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:08.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.399 ms                 | 387.068 ms                |
| Forward                   | 4.926 ms                  | 18.288 ms                 |
| Backward                  | 10.296 ms                 | 22.304 ms                 |
| Optimize                  | 2.684 ms                  | 7.070 ms                  |
| BarrierTimeBeforeRank0    | 36.243 us                 | 39.937 ms                 |
| AfterBackward             | 68.545 ms                 | 153.510 ms                |
| BlockToStepN              | 7.929 ms                  | 822.129 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:09.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 21:13:10.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240204 21:13:11.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240204 21:13:12.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.060 ms                 | 23.063 ms                 |
| ProcessBack:UpdateCache   | 13.295 ms                 | 20.543 ms                 |
| ProcessBack:UpsertPq      | 41.074 ms                 | 100.925 ms                |
| ProcessOneStep            | 67.955 ms                 | 153.461 ms                |
| BlockToStepN              | 7.869 ms                  | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:13.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 58.023, sample: 1.335, forward: 1.286, backward: 1.191, update: 0.266
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 58.024, sample: 1.423, forward: 1.229, backward: 1.162, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 57.350, sample: 1.975, forward: 1.311, backward: 1.052, update: 0.255
train_sampler.Prefill()
-------Step 0-------
tensor([   57881,    57916,    57958,    57998,  5577601,    95411, 50498990,
        18868356, 21883285,    58035]) tensor([ 5001640, 16004613, 63057875, 80452542, 21156913, 30636750, 33604727,
        81910822, 78331589, 27052175])
-------Step 1-------
tensor([   57881,    57916,    57958,    57998,  5577601,    95411, 50498990,
        18868356, 21883285,    58035]) tensor([76355142, 29919450, 11085449, 84588478, 83900019, 38879524, 80123885,
        53142618, 34695656, 13862971])
-------Step 2-------
tensor([  149093,   149125,   149163,    31672,   149195,   149235,   149271,
        23407708,   149310,   149347]) tensor([78162733, 22978983, 77391337, 51790269, 45309951, 29771693, 76724824,
        44787244, 14388288, 38141261])
-------Step 3-------
tensor([  149093,   149125,   149163,    31672,   149195,   149235,   149271,
        23407708,   149310,   149347]) tensor([44546202, 84855629, 35497129, 36226020, 57417055, 58036430, 33608490,
        17375068, 24419397,   701660])
-------Step 4-------
tensor([  238647, 41515712,   238678,   120237,   238712,   120260,   238744,
        37623450,   238776,   238810]) tensor([83261462, 10344904, 74866097, 18835203, 63106878, 46956915, 60383862,
        35607036, 85532097, 47868196])
-------Step 5-------
tensor([  238647, 41515712,   238678,   120237,   238712,   120260,   238744,
        37623450,   238776,   238810]) tensor([32386278, 83392737,   212546, 75268831, 52382442, 59862046, 15069328,
         9868602, 73347721, 43752310])
before start barrier
start train
[proc 0] 100 steps, total: 56.293, sample: 3.425, forward: 1.304, backward: 1.258, update: 0.332
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 56.319, sample: 2.129, forward: 1.231, backward: 1.384, update: 0.287
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 53.593, sample: 1.569, forward: 1.265, backward: 1.185, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 57.731, sample: 1.385, forward: 1.311, backward: 0.994, update: 0.259
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 55.292, sample: 1.336, forward: 1.246, backward: 0.718, update: 0.276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.113 ms                 | 387.068 ms                |
| Forward                   | 4.926 ms                  | 18.288 ms                 |
| Backward                  | 10.323 ms                 | 24.428 ms                 |
| Optimize                  | 2.682 ms                  | 7.070 ms                  |
| BarrierTimeBeforeRank0    | 40.136 us                 | 39.937 ms                 |
| AfterBackward             | 67.575 ms                 | 153.510 ms                |
| BlockToStepN              | 7.929 ms                  | 822.129 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:14.280011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 21:13:15.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 21:13:16.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240204 21:13:17.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.060 ms                 | 23.063 ms                 |
| ProcessBack:UpdateCache   | 13.038 ms                 | 20.543 ms                 |
| ProcessBack:UpsertPq      | 40.748 ms                 | 100.925 ms                |
| ProcessOneStep            | 66.992 ms                 | 153.461 ms                |
| BlockToStepN              | 370.925 ms                | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:18.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.399 ms                 | 387.068 ms                |
| Forward                   | 4.926 ms                  | 18.288 ms                 |
| Backward                  | 10.382 ms                 | 24.428 ms                 |
| Optimize                  | 2.684 ms                  | 16.362 ms                 |
| BarrierTimeBeforeRank0    | 40.376 us                 | 152.645 ms                |
| AfterBackward             | 67.023 ms                 | 153.510 ms                |
| BlockToStepN              | 7.929 ms                  | 822.129 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:19.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 21:13:20.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 21:13:21.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240204 21:13:22.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.066 ms                 | 23.063 ms                 |
| ProcessBack:UpdateCache   | 13.039 ms                 | 20.543 ms                 |
| ProcessBack:UpsertPq      | 41.013 ms                 | 100.925 ms                |
| ProcessOneStep            | 67.072 ms                 | 153.461 ms                |
| BlockToStepN              | 370.925 ms                | 821.969 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:23.280010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.747 ms                  | 387.068 ms                |
| Forward                   | 4.926 ms                  | 18.288 ms                 |
| Backward                  | 10.404 ms                 | 24.428 ms                 |
| Optimize                  | 2.684 ms                  | 16.362 ms                 |
| BarrierTimeBeforeRank0    | 40.136 us                 | 152.645 ms                |
| AfterBackward             | 67.122 ms                 | 153.510 ms                |
| BlockToStepN              | 371.031 ms                | 822.129 ms                |
| OneStep                   | 482.368 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:24.280009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 21:13:25.639384 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 21:13:26.803970 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240204 21:13:27.805804 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.075 ms                 | 19.951 ms                 |
| ProcessBack:UpdateCache   | 13.039 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 41.334 ms                 | 100.925 ms                |
| ProcessOneStep            | 67.955 ms                 | 153.461 ms                |
| BlockToStepN              | 7.949 ms                  | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:28.833694 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.692 ms                  | 387.068 ms                |
| Forward                   | 4.939 ms                  | 18.288 ms                 |
| Backward                  | 10.458 ms                 | 24.428 ms                 |
| Optimize                  | 2.721 ms                  | 16.362 ms                 |
| BarrierTimeBeforeRank0    | 40.576 us                 | 152.645 ms                |
| AfterBackward             | 68.053 ms                 | 153.510 ms                |
| BlockToStepN              | 8.354 ms                  | 825.187 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:29.847872 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 21:13:30.853108 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240204 21:13:31.903422 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240204 21:13:32.944916 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.066 ms                 | 19.951 ms                 |
| ProcessBack:UpdateCache   | 13.039 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 41.334 ms                 | 100.925 ms                |
| ProcessOneStep            | 68.012 ms                 | 153.461 ms                |
| BlockToStepN              | 8.309 ms                  | 834.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.919 ms                  | 387.068 ms                |
| Forward                   | 4.935 ms                  | 18.288 ms                 |
| Backward                  | 10.458 ms                 | 24.428 ms                 |
| Optimize                  | 2.721 ms                  | 16.362 ms                 |
| BarrierTimeBeforeRank0    | 39.694 us                 | 152.645 ms                |
| AfterBackward             | 67.988 ms                 | 153.510 ms                |
| BlockToStepN              | 39.190 ms                 | 834.349 ms                |
| OneStep                   | 476.998 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:34.258133 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 21:13:35.320853 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240204 21:13:36.320008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 21:13:37.320008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.060 ms                 | 19.951 ms                 |
| ProcessBack:UpdateCache   | 12.892 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 40.938 ms                 | 100.925 ms                |
| ProcessOneStep            | 67.339 ms                 | 153.461 ms                |
| BlockToStepN              | 370.925 ms                | 834.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:38.320009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.337 ms                 | 387.068 ms                |
| Forward                   | 4.939 ms                  | 18.288 ms                 |
| Backward                  | 10.463 ms                 | 24.428 ms                 |
| Optimize                  | 2.708 ms                  | 16.362 ms                 |
| BarrierTimeBeforeRank0    | 36.243 us                 | 152.645 ms                |
| AfterBackward             | 67.122 ms                 | 153.510 ms                |
| BlockToStepN              | 371.031 ms                | 834.349 ms                |
| OneStep                   | 482.368 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:39.320009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240204 21:13:40.320008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 21:13:41.320008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240204 21:13:42.536088 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.041 ms                 | 19.951 ms                 |
| ProcessBack:UpdateCache   | 12.795 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 40.061 ms                 | 100.925 ms                |
| ProcessOneStep            | 66.985 ms                 | 139.513 ms                |
| BlockToStepN              | 96.969 ms                 | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:43.536007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.399 ms                 | 361.841 ms                |
| Forward                   | 4.935 ms                  | 15.258 ms                 |
| Backward                  | 10.487 ms                 | 22.304 ms                 |
| Optimize                  | 2.684 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.969 us                 | 113.055 ms                |
| AfterBackward             | 66.865 ms                 | 139.566 ms                |
| BlockToStepN              | 97.078 ms                 | 825.187 ms                |
| OneStep                   | 476.998 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:44.536007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240204 21:13:45.536007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240204 21:13:46.561028 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240204 21:13:47.610415 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.000 ms                 | 19.951 ms                 |
| ProcessBack:UpdateCache   | 12.555 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 39.606 ms                 | 100.925 ms                |
| ProcessOneStep            | 66.533 ms                 | 139.513 ms                |
| BlockToStepN              | 96.969 ms                 | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:48.654675 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.399 ms                 | 361.841 ms                |
| Forward                   | 4.909 ms                  | 15.258 ms                 |
| Backward                  | 10.496 ms                 | 22.304 ms                 |
| Optimize                  | 2.682 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.668 us                 | 113.055 ms                |
| AfterBackward             | 66.487 ms                 | 139.566 ms                |
| BlockToStepN              | 97.078 ms                 | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:49.887868 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240204 21:13:50.887007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240204 21:13:51.887006 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 21:13:52.952220 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.976 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 12.376 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 39.081 ms                 | 97.690 ms                 |
| ProcessOneStep            | 66.209 ms                 | 139.513 ms                |
| BlockToStepN              | 110.049 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:53.952009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.504 ms                 | 361.841 ms                |
| Forward                   | 4.894 ms                  | 15.258 ms                 |
| Backward                  | 10.516 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.668 us                 | 113.055 ms                |
| AfterBackward             | 66.157 ms                 | 139.566 ms                |
| BlockToStepN              | 114.005 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:54.952008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240204 21:13:56.008150 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240204 21:13:57.078297 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.949 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 12.210 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 39.037 ms                 | 97.690 ms                 |
| ProcessOneStep            | 65.819 ms                 | 139.513 ms                |
| BlockToStepN              | 355.060 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:58.139248 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.504 ms                 | 361.841 ms                |
| Forward                   | 4.894 ms                  | 15.258 ms                 |
| Backward                  | 10.528 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.668 us                 | 113.055 ms                |
| AfterBackward             | 65.787 ms                 | 139.566 ms                |
| BlockToStepN              | 125.169 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:13:59.139005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 21:14:00.139009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 21:14:01.139008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240204 21:14:02.139010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.940 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 12.241 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 39.006 ms                 | 97.690 ms                 |
| ProcessOneStep            | 65.819 ms                 | 139.513 ms                |
| BlockToStepN              | 125.040 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:03.139005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.193 ms                 | 361.841 ms                |
| Forward                   | 4.873 ms                  | 18.288 ms                 |
| Backward                  | 10.563 ms                 | 22.304 ms                 |
| Optimize                  | 2.684 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.969 us                 | 113.055 ms                |
| AfterBackward             | 65.888 ms                 | 139.566 ms                |
| BlockToStepN              | 130.439 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:04.139004 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 4] 200 steps, total: 51.284, sample: 1.182, forward: 0.545, backward: 0.477, update: 0.266
[proc 2] 200 steps, total: 51.284, sample: 2.134, forward: 0.577, backward: 0.783, update: 0.243
[proc 7] 200 steps, total: 51.284, sample: 1.306, forward: 0.538, backward: 0.978, update: 0.253
[proc 3] 200 steps, total: 51.284, sample: 1.221, forward: 0.527, backward: 0.751, update: 0.256
[proc 5] 200 steps, total: 51.284, sample: 1.132, forward: 0.556, backward: 0.854, update: 0.259
[proc 0] 200 steps, total: 51.284, sample: 2.195, forward: 0.530, backward: 1.067, update: 0.362
[proc 6] 200 steps, total: 51.284, sample: 1.309, forward: 0.534, backward: 0.761, update: 0.243
[proc 1] 200 steps, total: 51.284, sample: 2.449, forward: 0.523, backward: 0.978, update: 0.253
W20240204 21:14:05.148759 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240204 21:14:06.148007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240204 21:14:07.148010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.949 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 11.970 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 38.693 ms                 | 97.690 ms                 |
| ProcessOneStep            | 65.748 ms                 | 139.513 ms                |
| BlockToStepN              | 130.373 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:08.148005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.919 ms                  | 361.841 ms                |
| Forward                   | 4.852 ms                  | 18.288 ms                 |
| Backward                  | 10.563 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 36.243 us                 | 113.055 ms                |
| AfterBackward             | 65.492 ms                 | 139.566 ms                |
| BlockToStepN              | 130.439 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:09.148005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240204 21:14:10.148010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240204 21:14:11.148007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 21:14:12.148010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.917 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.876 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 38.445 ms                 | 97.690 ms                 |
| ProcessOneStep            | 64.947 ms                 | 139.513 ms                |
| BlockToStepN              | 137.955 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:13.148005 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.747 ms                  | 361.841 ms                |
| Forward                   | 4.834 ms                  | 18.288 ms                 |
| Backward                  | 10.590 ms                 | 22.304 ms                 |
| Optimize                  | 2.669 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 35.969 us                 | 113.055 ms                |
| AfterBackward             | 64.976 ms                 | 139.566 ms                |
| BlockToStepN              | 138.032 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:14.392434 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240204 21:14:15.439994 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240204 21:14:16.439009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 21:14:17.439008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.902 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.888 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 38.445 ms                 | 97.690 ms                 |
| ProcessOneStep            | 65.459 ms                 | 139.513 ms                |
| BlockToStepN              | 140.149 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:18.439007 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.684 ms                  | 361.841 ms                |
| Forward                   | 4.852 ms                  | 27.430 ms                 |
| Backward                  | 10.563 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 38.394 us                 | 113.055 ms                |
| AfterBackward             | 65.787 ms                 | 139.566 ms                |
| BlockToStepN              | 142.494 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:19.519438 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240204 21:14:20.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 21:14:21.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240204 21:14:22.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.874 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 11.888 ms                 | 17.193 ms                 |
| ProcessBack:UpsertPq      | 38.693 ms                 | 94.687 ms                 |
| ProcessOneStep            | 65.902 ms                 | 139.513 ms                |
| BlockToStepN              | 148.507 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:23.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.631 ms                  | 361.841 ms                |
| Forward                   | 4.854 ms                  | 27.430 ms                 |
| Backward                  | 10.550 ms                 | 24.428 ms                 |
| Optimize                  | 2.669 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 39.172 us                 | 113.055 ms                |
| AfterBackward             | 65.980 ms                 | 139.566 ms                |
| BlockToStepN              | 348.268 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:24.519008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240204 21:14:25.519008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240204 21:14:26.519009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240204 21:14:27.519009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.845 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.806 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 38.878 ms                 | 94.687 ms                 |
| ProcessOneStep            | 65.902 ms                 | 139.513 ms                |
| BlockToStepN              | 170.470 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:28.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.229 ms                  | 361.841 ms                |
| Forward                   | 4.853 ms                  | 27.430 ms                 |
| Backward                  | 10.516 ms                 | 24.428 ms                 |
| Optimize                  | 2.682 ms                  | 10.582 ms                 |
| BarrierTimeBeforeRank0    | 40.376 us                 | 113.055 ms                |
| AfterBackward             | 65.937 ms                 | 139.566 ms                |
| BlockToStepN              | 177.809 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.252 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:29.519009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240204 21:14:30.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 21:14:31.519011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240204 21:14:32.520920 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.826 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.654 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 38.874 ms                 | 94.687 ms                 |
| ProcessOneStep            | 65.748 ms                 | 138.103 ms                |
| BlockToStepN              | 177.740 ms                | 826.123 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:33.626674 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.251 ms                  | 327.575 ms                |
| Forward                   | 4.854 ms                  | 18.288 ms                 |
| Backward                  | 10.521 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 40.576 us                 | 68.143 ms                 |
| AfterBackward             | 65.787 ms                 | 138.159 ms                |
| BlockToStepN              | 177.809 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:34.705549 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 21:14:35.705009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240204 21:14:36.722757 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240204 21:14:37.722011 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.820 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.591 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 38.952 ms                 | 94.687 ms                 |
| ProcessOneStep            | 65.902 ms                 | 138.103 ms                |
| BlockToStepN              | 348.191 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:38.722009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.631 ms                  | 327.575 ms                |
| Forward                   | 4.873 ms                  | 18.288 ms                 |
| Backward                  | 10.521 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 39.779 us                 | 68.143 ms                 |
| AfterBackward             | 65.937 ms                 | 138.159 ms                |
| BlockToStepN              | 348.268 ms                | 825.187 ms                |
| OneStep                   | 442.117 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:39.722009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240204 21:14:40.722008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 21:14:41.889593 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 21:14:42.919270 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.811 ms                  | 19.951 ms                 |
| ProcessBack:UpdateCache   | 11.519 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 39.005 ms                 | 94.687 ms                 |
| ProcessOneStep            | 65.902 ms                 | 138.103 ms                |
| BlockToStepN              | 186.663 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:43.919009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.692 ms                  | 327.575 ms                |
| Forward                   | 4.873 ms                  | 18.288 ms                 |
| Backward                  | 10.537 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 39.172 us                 | 68.143 ms                 |
| AfterBackward             | 65.937 ms                 | 138.159 ms                |
| BlockToStepN              | 186.747 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:44.919008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240204 21:14:45.919010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240204 21:14:46.919010 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240204 21:14:47.919009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.806 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 11.349 ms                 | 17.224 ms                 |
| ProcessBack:UpsertPq      | 38.952 ms                 | 93.680 ms                 |
| ProcessOneStep            | 65.819 ms                 | 138.103 ms                |
| BlockToStepN              | 192.259 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:48.919009 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.692 ms                  | 327.575 ms                |
| Forward                   | 4.883 ms                  | 18.288 ms                 |
| Backward                  | 10.550 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 37.465 us                 | 68.143 ms                 |
| AfterBackward             | 65.787 ms                 | 138.159 ms                |
| BlockToStepN              | 192.332 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:49.919008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240204 21:14:51.165979 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240204 21:14:52.187404 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.806 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 11.270 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 38.878 ms                 | 93.680 ms                 |
| ProcessOneStep            | 65.324 ms                 | 138.103 ms                |
| BlockToStepN              | 348.191 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:53.187008 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.836 ms                  | 327.575 ms                |
| Forward                   | 4.890 ms                  | 18.288 ms                 |
| Backward                  | 10.550 ms                 | 22.304 ms                 |
| Optimize                  | 2.672 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 38.394 us                 | 68.143 ms                 |
| AfterBackward             | 65.457 ms                 | 138.159 ms                |
| BlockToStepN              | 204.232 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 21:14:54.243078 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240204 21:14:55.243012 29102 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 158.10579204559326 seconds
before call kg_cache_controller.StopThreads()
W20240204 21:14:55.585399 29102 grad_async_v1.h:243] call StopThreads. PID = 1824
W20240204 21:14:55.585429 29102 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 21:14:55.591373 29102 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 21:14:55.591395 29102 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240204 21:14:55.781841 29102 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.811 ms                  | 19.616 ms                 |
| ProcessBack:UpdateCache   | 11.287 ms                 | 18.317 ms                 |
| ProcessBack:UpsertPq      | 38.878 ms                 | 93.680 ms                 |
| ProcessOneStep            | 65.459 ms                 | 138.103 ms                |
| BlockToStepN              | 204.099 ms                | 825.044 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.770 ms                  | 327.575 ms                |
| Forward                   | 4.882 ms                  | 18.288 ms                 |
| Backward                  | 10.540 ms                 | 22.304 ms                 |
| Optimize                  | 2.676 ms                  | 9.832 ms                  |
| BarrierTimeBeforeRank0    | 38.394 us                 | 68.143 ms                 |
| AfterBackward             | 65.492 ms                 | 138.159 ms                |
| BlockToStepN              | 204.232 ms                | 825.187 ms                |
| OneStep                   | 436.475 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
