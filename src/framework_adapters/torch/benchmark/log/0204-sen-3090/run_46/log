WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 02:51:09.541246 38954 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_104', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=4, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38954 sampler.py:454] Start PreSampling
WARNING [38954 sampler.py:532] Before construct renumbering_dict
WARNING [38954 sampler.py:555] PreSampling done
W20240205 03:11:28.541352 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 03:11:28.541538 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 03:11:28.541575 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 03:11:28.541616 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 03:11:28.541652 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 03:11:28.541692 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 03:11:28.541725 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 03:11:28.541760 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 03:11:28.541790 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 03:11:28.541822 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 03:11:28.541854 38954 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 03:11:28.541879 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 03:11:28.541904 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 03:11:28.542057 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 03:11:28.542098 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 03:11:28.542124 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 03:11:28.542163 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 03:11:28.542188 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 03:11:28.542217 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 03:11:28.542248 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 03:11:28.542285 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 03:11:28.542321 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 03:11:28.542346 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 03:11:28.542377 38954 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 03:11:28.542399 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 03:11:28.542421 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 03:11:28.542471 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 03:11:28.542500 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 03:11:28.542534 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 03:11:28.542565 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 03:11:28.542598 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 03:11:28.542625 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 03:11:28.542655 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 03:11:28.542681 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 03:11:28.542712 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 03:11:28.542737 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 03:11:28.542769 38954 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 03:11:28.542791 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 03:11:28.542812 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 03:11:28.542868 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 03:11:28.542901 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 03:11:28.542932 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 03:11:28.542964 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 03:11:28.542999 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 03:11:28.543040 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 03:11:28.543077 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 03:11:28.543105 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 03:11:28.543133 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 03:11:28.543159 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 03:11:28.543185 38954 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 03:11:28.543207 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 03:11:28.543229 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 03:11:28.543284 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 03:11:28.543319 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 03:11:28.543354 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 03:11:28.543380 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 03:11:28.543406 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 03:11:28.543432 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 03:11:28.543458 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 03:11:28.543484 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 03:11:28.543519 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 03:11:28.543552 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 03:11:28.543577 38954 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 03:11:28.543601 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 03:11:28.543622 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 03:11:28.543670 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 03:11:28.543701 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 03:11:28.543730 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 03:11:28.543766 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 03:11:28.543792 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 03:11:28.543818 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 03:11:28.543853 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 03:11:28.543880 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 03:11:28.543910 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 03:11:28.543937 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 03:11:28.543962 38954 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 03:11:28.543985 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 03:11:28.544008 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 03:11:28.544064 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 03:11:28.544095 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 03:11:28.544123 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 03:11:28.544150 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 03:11:28.544181 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 03:11:28.544210 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 03:11:28.544243 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 03:11:28.544282 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 03:11:28.544315 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 03:11:28.544348 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 03:11:28.544375 38954 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 03:11:28.544397 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 03:11:28.544420 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 03:11:28.544471 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 03:11:28.544505 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 03:11:28.544536 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 03:11:28.544572 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 03:11:28.544603 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 03:11:28.544636 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 03:11:28.544662 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 03:11:28.544694 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 03:11:28.544723 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 03:11:28.544754 38954 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 03:11:28.544785 38954 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 03:11:28.544808 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 03:11:28.544831 38954 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 03:11:28.979305 38954 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 03:20:00.295711 38954 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302708,  4302730,    98125,  ..., 53250142, 48666157,  4872098]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2238.772 seconds
[Rank1] pid = 1467
[Rank2] pid = 1570
[Rank3] pid = 1708
[Rank4] pid = 1814
[Rank5] pid = 2021
[Rank6] pid = 2149
INFO [38954 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1467 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2021 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [1570 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1708 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2149 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [2149 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2356 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [1814 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [1467 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1708 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2356 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1814 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [1570 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2021 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 03:28:40.287654  2159 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 03:28:40.288154  1468 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 03:28:40.288143  1816 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 03:28:40.288157  2400 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 03:28:40.288195  1571 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 03:28:40.288269  2022 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 03:28:40.288630  1709 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
INFO [38954 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 03:28:40.293687  2363 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 03:28:40.366236  2159 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020497ad000 7.629 MB
W20240205 03:28:40.366297  1816 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102049f52000 7.629 MB
W20240205 03:28:40.366307  1468 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204a6f5000 7.629 MB
W20240205 03:28:40.366310  2400 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204ae98000 7.629 MB
W20240205 03:28:40.366314  2022 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204b63b000 7.629 MB
W20240205 03:28:40.366331  1571 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204bdde000 7.629 MB
W20240205 03:28:40.366405  2363 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204c581000 7.629 MB
W20240205 03:28:40.366453  2159 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204cd24000 7.629 MB
W20240205 03:28:40.366488  1468 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204d4c7000 7.629 MB
W20240205 03:28:40.366492  1816 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204dc6a000 7.629 MB
W20240205 03:28:40.366505  2022 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10204e40d000 7.629 MB
W20240205 03:28:40.366509  1571 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204ebb0000 7.629 MB
W20240205 03:28:40.366514  2400 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204f353000 7.629 MB
W20240205 03:28:40.366523  2363 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204faf6000 7.629 MB
W20240205 03:28:40.366547  2159 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102050299000 1.49 GB
W20240205 03:28:40.366577  1468 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1020af87c000 1.49 GB
W20240205 03:28:40.366596  2159 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10210ee5f000 1.49 GB
W20240205 03:28:40.366598  2363 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10216e442000 1.49 GB
W20240205 03:28:40.366605  1816 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cda25000 1.49 GB
W20240205 03:28:40.366627  1571 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10222d008000 1.49 GB
W20240205 03:28:40.366634  2022 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10228c5eb000 1.49 GB
W20240205 03:28:40.366641  2400 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1022ebbce000 1.49 GB
W20240205 03:28:40.366645  2363 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10234b1b1000 1.49 GB
W20240205 03:28:40.366670  1468 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1023aa794000 1.49 GB
W20240205 03:28:40.366688  2363 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 03:28:40.366691  1816 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102409d77000 1.49 GB
W20240205 03:28:40.366710  1571 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10246935a000 1.49 GB
W20240205 03:28:40.366716  2159 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 03:28:40.366717  2022 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1024c893d000 1.49 GB
W20240205 03:28:40.366724  2400 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102527f20000 1.49 GB
W20240205 03:28:40.366739  1468 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 03:28:40.366773  1816 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 03:28:40.366789  1571 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 03:28:40.366803  2022 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 03:28:40.366809  2400 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 03:28:40.377542  1709 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102587505000 7.629 MB
W20240205 03:28:40.377712  1709 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102587ca8000 7.629 MB
W20240205 03:28:40.377784  1709 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10258844b000 1.49 GB
W20240205 03:28:40.377828  1709 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240205 03:28:40.377918  1709 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 03:28:40.377921  2363 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 03:28:40.377967  1816 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 03:28:40.377976  2159 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 03:28:40.377983  1571 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 03:28:40.377990  2022 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 03:28:40.377993  1468 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 03:28:40.378010  2400 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 03:28:40.390343  1709 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
[Rank7] pid = 2356
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [38954 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [1708 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [2149 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [2356 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [1570 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [1467 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [2021 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [1814 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 03:29:30.207933  1816 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208088  1468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208143  2363 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208191  2022 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208220  1571 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208257  2159 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208310  2400 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 03:29:30.208366  1709 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 03:29:30.209532  2363 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 4,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 03:29:30.209717  2363 grad_base.h:184] Init GradProcessingBase done
I20240205 03:29:43.158604  2363 grad_async_v2.h:42] Use main thread to update emb.
W20240205 03:29:43.158766  2363 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 03:29:43.158774  2363 kg_controller.h:84] Construct KGCacheController done
E20240205 03:29:43.953121  2400 recstore.cc:66] init folly done
E20240205 03:29:43.953122  1468 recstore.cc:66] init folly done
E20240205 03:29:43.953142  2022 recstore.cc:66] init folly done
E20240205 03:29:43.953167  2159 recstore.cc:66] init folly done
E20240205 03:29:43.953186  2363 recstore.cc:66] init folly done
E20240205 03:29:43.953186  1816 recstore.cc:66] init folly done
E20240205 03:29:43.953191  1571 recstore.cc:66] init folly done
E20240205 03:29:43.953702  1709 recstore.cc:66] init folly done
I20240205 03:29:43.954566  2363 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 03:30:02.356276  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 03:30:02.356663  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:03.471850  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 03:30:03.472009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 174.626 us                | 595.882 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:05.175856  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 03:30:05.190760  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 03:30:05.324088  2400 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 03:30:05.637219  2022 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 03:30:05.909710  1816 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 03:30:07.103986  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 03:30:07.120287  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 03:30:07.161825  1571 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 03:30:07.249373  1468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 03:30:07.433456  1709 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 03:30:08.492038  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 03:30:08.512727  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 03:30:08.547277  2363 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 162.457 us                | 299.175 us                |
+---------------------------+---------------------------+---------------------------+
I20240205 03:30:09.476995  2159 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 03:30:09.517002  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 03:30:09.562203  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.976 ms                  | 7.976 ms                  |
| Forward                   | 720.647 ms                | 720.647 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 03:30:11.724301  4651 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 03:30:11.841856  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240205 03:30:11.854521  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 03:30:12.724009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=207
W20240205 03:30:12.887127  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240205 03:30:12.956493  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240205 03:30:13.724020  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=383
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 383.487 us                | 8.940 ms                  |
| ProcessBack:Shuffle       | 7.597 ms                  | 337.671 ms                |
| ProcessBack:UpdateCache   | 10.946 ms                 | 663.899 ms                |
| ProcessBack:UpsertPq      | 23.857 ms                 | 128.315 ms                |
| ProcessOneStep            | 113.648 ms                | 1.394 s                   |
| BlockToStepN              | 864.563 us                | 6.047 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:13.968278  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240205 03:30:14.123523  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 03:30:14.392176  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=17, sample_step_cpp_seen_[rank]=16
E20240205 03:30:14.763638  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.486 ms                  | 96.555 ms                 |
| Forward                   | 5.339 ms                  | 720.647 ms                |
| Backward                  | 4.737 ms                  | 234.856 ms                |
| Optimize                  | 2.380 ms                  | 5.625 ms                  |
| BarrierTimeBeforeRank0    | 9.017 ms                  | 266.903 ms                |
| AfterBackward             | 89.711 ms                 | 1.395 s                   |
| BlockToStepN              | 847.478 us                | 6.146 ms                  |
| OneStep                   | 155.655 ms                | 2.374 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:15.283098  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
W20240205 03:30:15.732120  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=19, pq.top=19
E20240205 03:30:15.773145  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240205 03:30:16.296344  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240205 03:30:16.773010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=22
W20240205 03:30:17.429756  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 03:30:17.551729  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240205 03:30:17.773015  6814 parallel_pq_v2.h:79] insert failed, size(hashtable)=7271
E20240205 03:30:18.773011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2447
W20240205 03:30:18.821010  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 243.840 us                | 973.447 us                |
| ProcessBack:Shuffle       | 7.927 ms                  | 304.667 ms                |
| ProcessBack:UpdateCache   | 10.727 ms                 | 662.894 ms                |
| ProcessBack:UpsertPq      | 29.411 ms                 | 120.545 ms                |
| ProcessOneStep            | 103.330 ms                | 1.394 s                   |
| BlockToStepN              | 455.644 us                | 6.047 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:19.569914  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=37, pq.top=37
E20240205 03:30:19.773705  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:19.843935  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.224 ms                  | 96.555 ms                 |
| Forward                   | 5.358 ms                  | 720.647 ms                |
| Backward                  | 4.753 ms                  | 234.856 ms                |
| Optimize                  | 2.822 ms                  | 5.693 ms                  |
| BarrierTimeBeforeRank0    | 4.901 ms                  | 305.628 ms                |
| AfterBackward             | 108.025 ms                | 1.395 s                   |
| BlockToStepN              | 506.509 us                | 6.146 ms                  |
| OneStep                   | 149.864 ms                | 2.374 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:20.690034  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=41, pq.top=41
E20240205 03:30:20.773010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=9663
W20240205 03:30:20.889575  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
W20240205 03:30:21.715185  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240205 03:30:21.776000  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
E20240205 03:30:22.123936  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=52, sample_step_cpp_seen_[rank]=51
W20240205 03:30:22.138154  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 03:30:22.780836  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:23.294173  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240205 03:30:23.899700  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 286.696 us                | 1.978 ms                  |
| ProcessBack:Shuffle       | 8.014 ms                  | 304.667 ms                |
| ProcessBack:UpdateCache   | 10.652 ms                 | 662.894 ms                |
| ProcessBack:UpsertPq      | 44.556 ms                 | 174.210 ms                |
| ProcessOneStep            | 113.648 ms                | 1.147 s                   |
| BlockToStepN              | 455.644 us                | 6.047 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:24.321417  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240205 03:30:24.899015  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=34369
W20240205 03:30:25.097707  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.664 ms                  | 96.555 ms                 |
| Forward                   | 5.441 ms                  | 27.665 ms                 |
| Backward                  | 4.753 ms                  | 8.217 ms                  |
| Optimize                  | 2.786 ms                  | 6.885 ms                  |
| BarrierTimeBeforeRank0    | 3.287 ms                  | 266.903 ms                |
| AfterBackward             | 108.025 ms                | 1.149 s                   |
| BlockToStepN              | 506.509 us                | 6.146 ms                  |
| OneStep                   | 149.864 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:25.349488  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 03:30:25.899012  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=94
W20240205 03:30:26.424242  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 03:30:26.899009  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
W20240205 03:30:27.462340  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240205 03:30:27.899669  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:28.261679  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 03:30:28.671319  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 03:30:28.782932  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=81, sample_step_cpp_seen_[rank]=80
E20240205 03:30:28.899006  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=770
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 569.535 us                | 9.027 ms                  |
| ProcessBack:Shuffle       | 8.227 ms                  | 46.270 ms                 |
| ProcessBack:UpdateCache   | 10.782 ms                 | 39.731 ms                 |
| ProcessBack:UpsertPq      | 35.447 ms                 | 128.315 ms                |
| ProcessOneStep            | 107.973 ms                | 1.311 s                   |
| BlockToStepN              | 411.745 us                | 6.047 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:29.786839  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240205 03:30:29.899010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1065
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.664 ms                  | 103.238 ms                |
| Forward                   | 5.393 ms                  | 27.665 ms                 |
| Backward                  | 4.871 ms                  | 10.053 ms                 |
| Optimize                  | 2.671 ms                  | 6.885 ms                  |
| BarrierTimeBeforeRank0    | 3.021 ms                  | 266.903 ms                |
| AfterBackward             | 108.025 ms                | 1.311 s                   |
| BlockToStepN              | 498.880 us                | 6.146 ms                  |
| OneStep                   | 149.864 ms                | 1.337 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:30.421875  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240205 03:30:30.847193  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
E20240205 03:30:30.899008  4651 parallel_pq_v2.h:79] insert failed, size(hashtable)=2730
W20240205 03:30:31.589610  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
E20240205 03:30:31.907397  4651 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:31.965557  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 03:30:32.643074  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=96, pq.top=96
E20240205 03:30:32.907008  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=199
W20240205 03:30:32.978403  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 03:30:33.782009  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=98, sample_step_cpp_seen_[rank]=97
E20240205 03:30:33.916783  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 322.249 us                | 1.065 ms                  |
| ProcessBack:Shuffle       | 8.163 ms                  | 46.270 ms                 |
| ProcessBack:UpdateCache   | 10.840 ms                 | 39.731 ms                 |
| ProcessBack:UpsertPq      | 36.348 ms                 | 128.315 ms                |
| ProcessOneStep            | 107.570 ms                | 1.394 s                   |
| BlockToStepN              | 561.148 us                | 6.187 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:34.084756  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
W20240205 03:30:34.369096  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 28.549, sample: 1.611, forward: 1.263, backward: 0.747, update: 0.269
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.210, sample: 1.995, forward: 1.287, backward: 0.798, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.025, sample: 1.326, forward: 1.311, backward: 0.809, update: 0.242
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.135, sample: 1.239, forward: 1.258, backward: 0.779, update: 0.240
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 28.822, sample: 1.959, forward: 1.335, backward: 0.728, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.297, sample: 2.446, forward: 1.250, backward: 0.791, update: 0.236
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.981, sample: 1.324, forward: 1.205, backward: 0.741, update: 0.243
train_sampler.Prefill()
-------Step 0-------
tensor([   70668,    70712,    70769,    70827,  5995976,    89466, 62761983,
        20656491, 18067571,    70876]) tensor([ 5346955, 17695580, 53513701, 80269376, 23066019, 36193952, 40749766,
        69676217, 78289812, 33044976])
-------Step 1-------
tensor([   70668,    70712,    70769,    70827,  5995976,    89466, 62761983,
        20656491, 18067571,    70876]) tensor([77359143, 32631420, 11437289, 83892554, 72756948, 48373090, 79888782,
        43567784, 31995575, 15081131])
-------Step 2-------
tensor([  175410,   175462,   175500,    20861,   175537,   175582,   175630,
        21501534,   175678,   175718]) tensor([79492609, 26218527, 71925822, 43288627, 35585950, 23905067, 77522268,
        47073313, 12351250, 47398113])
-------Step 3-------
tensor([  175410,   175462,   175500,    20861,   175537,   175582,   175630,
        21501534,   175678,   175718]) tensor([42419674, 84695313, 30705196, 43696058, 70257157, 73047924, 31383313,
        19007317, 30297627,   680648])
-------Step 4-------
tensor([  278437, 44835698,   278472,   113132,   278514,   113157,   278566,
        45572710,   278621,   278658]) tensor([83415480, 11121794, 83226881, 20247687, 61323269, 48829751, 74715264,
        42897044, 85505031, 59179140])
-------Step 5-------
tensor([  278437, 44835698,   278472,   113132,   278514,   113157,   278566,
        45572710,   278621,   278658]) tensor([29674655, 82900551,   324258, 85597711, 49678146, 47317904, 12876608,
         9228224, 63769216, 34600812])
-------Step 6-------
tensor([  382194,    43407,   382236,   382277,    43427, 79833713,   382325,
          382374,   124988, 41688426]) tensor([14372425, 33692105, 30245123, 84505971, 28152885, 40802259, 20849783,
         6195863, 77229407, 85008711])
-------Step 7-------
tensor([  382194,    43407,   382236,   382277,    43427, 79833713,   382325,
          382374,   124988, 41688426]) tensor([26941166, 59566145, 68724525, 50788229, 71213733, 43523099, 61223743,
        48589438, 31431707, 28579868])
-------Step 8-------
tensor([  451499, 28489178,   451515,   136173,   451535,    54490,   451554,
          451572,   451588,   451604]) tensor([50764252, 29050965, 29059844,  2034962, 56524524, 75384868, 17123347,
        62100488,  1590362, 52823274])
-------Step 9-------
tensor([  451499, 28489178,   451515,   136173,   451535,    54490,   451554,
          451572,   451588,   451604]) tensor([60732557, 30845507, 12132948, 47971510,  8136491, 34686152, 31134888,
        43435148, 85357112, 58443545])
before start barrier
start train
[proc 0] 100 steps, total: 25.912, sample: 2.458, forward: 1.285, backward: 0.785, update: 0.315
E20240205 03:30:34.916013  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1623
W20240205 03:30:35.161738  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.412 ms                  | 495.953 ms                |
| Forward                   | 5.353 ms                  | 27.665 ms                 |
| Backward                  | 4.990 ms                  | 13.523 ms                 |
| Optimize                  | 2.636 ms                  | 6.885 ms                  |
| BarrierTimeBeforeRank0    | 2.602 ms                  | 266.903 ms                |
| AfterBackward             | 107.614 ms                | 1.395 s                   |
| BlockToStepN              | 690.558 us                | 6.279 ms                  |
| OneStep                   | 148.543 ms                | 1.684 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:35.677259  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=105, pq.top=105
E20240205 03:30:35.916010  6814 parallel_pq_v2.h:79] insert failed, size(hashtable)=25559
W20240205 03:30:36.319006  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240205 03:30:36.699474  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240205 03:30:36.916008  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=24878
W20240205 03:30:37.370947  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 03:30:37.916010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240205 03:30:38.377257  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240205 03:30:38.916033  6820 parallel_pq_v2.h:79] insert failed, size(hashtable)=53981
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 373.601 us                | 4.103 ms                  |
| ProcessBack:Shuffle       | 8.322 ms                  | 46.270 ms                 |
| ProcessBack:UpdateCache   | 10.895 ms                 | 39.731 ms                 |
| ProcessBack:UpsertPq      | 37.379 ms                 | 128.315 ms                |
| ProcessOneStep            | 107.973 ms                | 1.394 s                   |
| BlockToStepN              | 658.830 us                | 6.187 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:39.397019  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
W20240205 03:30:39.476812  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=122, pq.top=121
E20240205 03:30:39.916007  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=1619
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.646 ms                  | 495.953 ms                |
| Forward                   | 5.381 ms                  | 27.665 ms                 |
| Backward                  | 5.057 ms                  | 13.523 ms                 |
| Optimize                  | 2.682 ms                  | 6.885 ms                  |
| BarrierTimeBeforeRank0    | 2.245 ms                  | 266.903 ms                |
| AfterBackward             | 108.025 ms                | 1.395 s                   |
| BlockToStepN              | 789.913 us                | 7.526 ms                  |
| OneStep                   | 149.896 ms                | 1.684 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:40.485670  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240205 03:30:40.672449  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
E20240205 03:30:40.916019  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=623
E20240205 03:30:40.927510  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=133, sample_step_cpp_seen_[rank]=132
W20240205 03:30:41.670297  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240205 03:30:41.916013  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1484
W20240205 03:30:42.212435  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240205 03:30:42.703003  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240205 03:30:42.916013  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 03:30:43.246810  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 03:30:43.722275  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 03:30:43.922909  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=41440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 499.886 us                | 24.859 ms                 |
| ProcessBack:Shuffle       | 8.522 ms                  | 43.637 ms                 |
| ProcessBack:UpdateCache   | 10.860 ms                 | 32.004 ms                 |
| ProcessBack:UpsertPq      | 38.388 ms                 | 158.762 ms                |
| ProcessOneStep            | 107.973 ms                | 1.394 s                   |
| BlockToStepN              | 746.674 us                | 28.731 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:44.784169  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240205 03:30:44.922705  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:45.188269  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=148, pq.top=148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.903 ms                  | 495.953 ms                |
| Forward                   | 5.401 ms                  | 27.665 ms                 |
| Backward                  | 5.164 ms                  | 13.523 ms                 |
| Optimize                  | 2.688 ms                  | 6.885 ms                  |
| BarrierTimeBeforeRank0    | 2.130 ms                  | 266.903 ms                |
| AfterBackward             | 108.025 ms                | 1.395 s                   |
| BlockToStepN              | 848.801 us                | 28.863 ms                 |
| OneStep                   | 149.864 ms                | 1.684 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:45.831845  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 03:30:45.922008  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240205 03:30:46.324335  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240205 03:30:46.920027  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240205 03:30:46.922019  6831 parallel_pq_v2.h:79] insert failed, size(hashtable)=18281
E20240205 03:30:47.026240  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=161, sample_step_cpp_seen_[rank]=160
E20240205 03:30:47.930687  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:30:48.035040  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240205 03:30:48.328076  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=162, pq.top=162
E20240205 03:30:48.930022  6828 parallel_pq_v2.h:79] insert failed, size(hashtable)=33603
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 480.253 us                | 4.027 ms                  |
| ProcessBack:Shuffle       | 8.553 ms                  | 43.637 ms                 |
| ProcessBack:UpdateCache   | 10.850 ms                 | 32.004 ms                 |
| ProcessBack:UpsertPq      | 35.965 ms                 | 168.700 ms                |
| ProcessOneStep            | 108.042 ms                | 1.319 s                   |
| BlockToStepN              | 908.895 us                | 27.651 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:49.053149  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
W20240205 03:30:49.716197  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=167, pq.top=167
E20240205 03:30:49.930012  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4495
W20240205 03:30:50.129105  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.875 ms                  | 466.696 ms                |
| Forward                   | 5.441 ms                  | 24.949 ms                 |
| Backward                  | 5.669 ms                  | 10.053 ms                 |
| Optimize                  | 2.792 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.848 ms                  | 254.936 ms                |
| AfterBackward             | 108.025 ms                | 1.319 s                   |
| BlockToStepN              | 1.009 ms                  | 27.755 ms                 |
| OneStep                   | 148.543 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:50.921398  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240205 03:30:50.930478  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=33955
W20240205 03:30:51.338682  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 03:30:51.951516  6813 parallel_pq_v2.h:79] insert failed, size(hashtable)=5555
E20240205 03:30:52.026008  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=178, sample_step_cpp_seen_[rank]=177
W20240205 03:30:52.397377  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 03:30:52.512517  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240205 03:30:52.951018  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1042
W20240205 03:30:53.488698  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240205 03:30:53.951009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=50404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 474.386 us                | 9.976 ms                  |
| ProcessBack:Shuffle       | 8.635 ms                  | 41.193 ms                 |
| ProcessBack:UpdateCache   | 10.860 ms                 | 31.129 ms                 |
| ProcessBack:UpsertPq      | 36.588 ms                 | 177.262 ms                |
| ProcessOneStep            | 108.042 ms                | 1.319 s                   |
| BlockToStepN              | 964.460 us                | 27.651 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:54.497073  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240205 03:30:54.529162  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240205 03:30:54.951011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.412 ms                  | 466.696 ms                |
| Forward                   | 5.525 ms                  | 24.949 ms                 |
| Backward                  | 7.070 ms                  | 12.997 ms                 |
| Optimize                  | 2.821 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.960 ms                  | 254.936 ms                |
| AfterBackward             | 107.614 ms                | 1.319 s                   |
| BlockToStepN              | 1.098 ms                  | 27.755 ms                 |
| OneStep                   | 147.304 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:55.660794  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240205 03:30:55.951012  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=126
W20240205 03:30:56.691035  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 03:30:56.947993  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=199, pq.top=199
E20240205 03:30:56.951406  6824 parallel_pq_v2.h:79] insert failed, size(hashtable)=1345
[proc 0] 200 steps, total: 22.636, sample: 3.422, forward: 0.645, backward: 0.717, update: 0.316
[proc 7] 200 steps, total: 22.638, sample: 1.080, forward: 0.564, backward: 0.574, update: 0.230
[proc 1] 200 steps, total: 22.638, sample: 1.852, forward: 0.570, backward: 0.705, update: 0.260
[proc 6] 200 steps, total: 22.638, sample: 1.266, forward: 0.566, backward: 0.577, update: 0.226
[proc 2] 200 steps, total: 22.638, sample: 1.925, forward: 0.584, backward: 0.666, update: 0.249
[proc 5] 200 steps, total: 22.638, sample: 1.476, forward: 0.570, backward: 0.551, update: 0.228
[proc 3] 200 steps, total: 22.638, sample: 1.173, forward: 0.558, backward: 0.516, update: 0.216
[proc 4] 200 steps, total: 22.638, sample: 1.163, forward: 0.551, backward: 0.637, update: 0.228
W20240205 03:30:57.813989  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240205 03:30:57.953176  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240205 03:30:58.709241  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=208, pq.top=207
W20240205 03:30:58.858023  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240205 03:30:58.953020  6815 parallel_pq_v2.h:79] insert failed, size(hashtable)=42489
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 455.950 us                | 16.471 ms                 |
| ProcessBack:Shuffle       | 8.692 ms                  | 41.193 ms                 |
| ProcessBack:UpdateCache   | 10.895 ms                 | 31.129 ms                 |
| ProcessBack:UpsertPq      | 38.439 ms                 | 188.357 ms                |
| ProcessOneStep            | 108.142 ms                | 1.319 s                   |
| BlockToStepN              | 1.038 ms                  | 27.651 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:30:59.857900  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=215, pq.top=215
E20240205 03:30:59.952628  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=215, sample_step_cpp_seen_[rank]=214
E20240205 03:30:59.953286  6807 parallel_pq_v2.h:79] insert failed, size(hashtable)=7299
W20240205 03:31:00.056010  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.412 ms                  | 466.696 ms                |
| Forward                   | 5.525 ms                  | 24.949 ms                 |
| Backward                  | 7.271 ms                  | 12.997 ms                 |
| Optimize                  | 2.741 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.848 ms                  | 254.936 ms                |
| AfterBackward             | 108.087 ms                | 1.319 s                   |
| BlockToStepN              | 1.181 ms                  | 27.755 ms                 |
| OneStep                   | 148.543 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:00.959774  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:01.063760  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 03:31:01.770823  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240205 03:31:01.959030  6823 parallel_pq_v2.h:79] insert failed, size(hashtable)=17304
W20240205 03:31:02.158416  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 03:31:02.959015  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4133
W20240205 03:31:03.360263  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 313.988 us                | 3.973 ms                  |
| ProcessBack:Shuffle       | 8.643 ms                  | 34.298 ms                 |
| ProcessBack:UpdateCache   | 10.840 ms                 | 27.450 ms                 |
| ProcessBack:UpsertPq      | 36.348 ms                 | 187.578 ms                |
| ProcessOneStep            | 108.042 ms                | 1.319 s                   |
| BlockToStepN              | 1.159 ms                  | 27.651 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:03.959012  6814 parallel_pq_v2.h:79] insert failed, size(hashtable)=12503
W20240205 03:31:04.172827  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240205 03:31:04.369719  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240205 03:31:04.959018  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=57336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.486 ms                  | 466.696 ms                |
| Forward                   | 5.493 ms                  | 24.949 ms                 |
| Backward                  | 7.292 ms                  | 12.997 ms                 |
| Optimize                  | 2.648 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 1.848 ms                  | 254.936 ms                |
| AfterBackward             | 108.025 ms                | 1.319 s                   |
| BlockToStepN              | 1.299 ms                  | 27.755 ms                 |
| OneStep                   | 147.881 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:05.226941  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240205 03:31:05.515995  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 03:31:05.633427  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=243, sample_step_cpp_seen_[rank]=242
E20240205 03:31:05.959014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240205 03:31:06.592487  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240205 03:31:06.959012  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=22320
W20240205 03:31:07.242543  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=246, pq.top=245
W20240205 03:31:07.631794  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240205 03:31:07.959009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=92
W20240205 03:31:08.346225  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240205 03:31:08.793426  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 401.004 us                | 8.853 ms                  |
| ProcessBack:Shuffle       | 8.659 ms                  | 34.298 ms                 |
| ProcessBack:UpdateCache   | 10.840 ms                 | 27.450 ms                 |
| ProcessBack:UpsertPq      | 34.872 ms                 | 188.357 ms                |
| ProcessOneStep            | 106.265 ms                | 1.311 s                   |
| BlockToStepN              | 1.241 ms                  | 27.651 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:08.959012  6813 parallel_pq_v2.h:79] insert failed, size(hashtable)=43169
W20240205 03:31:09.455571  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240205 03:31:09.851717  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240205 03:31:09.959012  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.075 ms                  | 433.469 ms                |
| Forward                   | 5.489 ms                  | 17.778 ms                 |
| Backward                  | 6.993 ms                  | 12.248 ms                 |
| Optimize                  | 2.624 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 1.667 ms                  | 127.762 ms                |
| AfterBackward             | 107.349 ms                | 1.311 s                   |
| BlockToStepN              | 1.352 ms                  | 27.755 ms                 |
| OneStep                   | 148.068 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:10.756403  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240205 03:31:10.868324  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 03:31:10.959008  4651 parallel_pq_v2.h:79] insert failed, size(hashtable)=4687
W20240205 03:31:11.843353  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=272, pq.top=272
E20240205 03:31:11.959013  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=126
W20240205 03:31:12.002502  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 03:31:12.390930  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=276, sample_step_cpp_seen_[rank]=275
E20240205 03:31:12.959014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2980
W20240205 03:31:13.078414  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240205 03:31:13.413555  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240205 03:31:13.959010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=3357
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 383.561 us                | 4.629 ms                  |
| ProcessBack:Shuffle       | 8.707 ms                  | 28.375 ms                 |
| ProcessBack:UpdateCache   | 10.785 ms                 | 22.536 ms                 |
| ProcessBack:UpsertPq      | 34.730 ms                 | 188.081 ms                |
| ProcessOneStep            | 106.053 ms                | 1.311 s                   |
| BlockToStepN              | 1.273 ms                  | 33.598 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:14.147739  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
W20240205 03:31:14.437841  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
E20240205 03:31:14.964414  4651 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.464 ms                  | 433.469 ms                |
| Forward                   | 5.493 ms                  | 17.778 ms                 |
| Backward                  | 5.852 ms                  | 12.248 ms                 |
| Optimize                  | 2.620 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 1.667 ms                  | 127.762 ms                |
| AfterBackward             | 104.104 ms                | 1.311 s                   |
| BlockToStepN              | 1.385 ms                  | 33.856 ms                 |
| OneStep                   | 147.304 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:15.310283  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
W20240205 03:31:15.495350  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240205 03:31:15.968137  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:16.503475  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240205 03:31:16.968055  6816 parallel_pq_v2.h:79] insert failed, size(hashtable)=33227
W20240205 03:31:17.033545  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240205 03:31:17.520925  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
[proc 1] 300 steps, total: 20.568, sample: 1.534, forward: 0.552, backward: 0.689, update: 0.238
[proc 7] 300 steps, total: 20.568, sample: 1.017, forward: 0.585, backward: 0.540, update: 0.259
[proc 0] 300 steps, total: 20.568, sample: 1.867, forward: 0.562, backward: 0.598, update: 0.284
[proc 6] 300 steps, total: 20.568, sample: 1.168, forward: 0.565, backward: 0.536, update: 0.247
[proc 5] 300 steps, total: 20.568, sample: 1.097, forward: 0.592, backward: 0.545, update: 0.228
[proc 4] 300 steps, total: 20.567, sample: 0.999, forward: 0.569, backward: 0.551, update: 0.243
[proc 3] 300 steps, total: 20.567, sample: 1.102, forward: 0.527, backward: 0.552, update: 0.231
[proc 2] 300 steps, total: 20.568, sample: 1.658, forward: 0.574, backward: 0.749, update: 0.234
E20240205 03:31:17.968009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=16606
W20240205 03:31:18.061471  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240205 03:31:18.806823  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 03:31:18.892894  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=309, sample_step_cpp_seen_[rank]=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 545.813 us                | 17.161 ms                 |
| ProcessBack:Shuffle       | 8.692 ms                  | 28.375 ms                 |
| ProcessBack:UpdateCache   | 10.702 ms                 | 22.536 ms                 |
| ProcessBack:UpsertPq      | 33.973 ms                 | 188.081 ms                |
| ProcessOneStep            | 104.039 ms                | 1.311 s                   |
| BlockToStepN              | 1.372 ms                  | 34.201 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:18.968005  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240205 03:31:19.835337  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240205 03:31:19.968029  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.190 ms                  | 433.469 ms                |
| Forward                   | 5.493 ms                  | 17.778 ms                 |
| Backward                  | 5.830 ms                  | 12.248 ms                 |
| Optimize                  | 2.603 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 1.667 ms                  | 127.762 ms                |
| AfterBackward             | 104.104 ms                | 1.319 s                   |
| BlockToStepN              | 1.470 ms                  | 34.302 ms                 |
| OneStep                   | 147.881 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:20.749644  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240205 03:31:20.838531  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240205 03:31:20.968008  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=7104
W20240205 03:31:21.835680  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240205 03:31:21.968019  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=48826
W20240205 03:31:22.145136  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 03:31:22.968014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=983
W20240205 03:31:23.260133  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 03:31:23.605443  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 326.339 us                | 3.794 ms                  |
| ProcessBack:Shuffle       | 8.748 ms                  | 27.651 ms                 |
| ProcessBack:UpdateCache   | 10.730 ms                 | 16.800 ms                 |
| ProcessBack:UpsertPq      | 34.260 ms                 | 187.578 ms                |
| ProcessOneStep            | 104.039 ms                | 1.319 s                   |
| BlockToStepN              | 1.429 ms                  | 41.722 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:23.968022  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=49167
W20240205 03:31:24.403781  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 03:31:24.672345  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=333, pq.top=333
E20240205 03:31:24.968017  6803 parallel_pq_v2.h:79] insert failed, size(hashtable)=24444
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.190 ms                  | 433.469 ms                |
| Forward                   | 5.493 ms                  | 17.778 ms                 |
| Backward                  | 5.801 ms                  | 12.248 ms                 |
| Optimize                  | 2.599 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 1.667 ms                  | 127.762 ms                |
| AfterBackward             | 103.408 ms                | 1.319 s                   |
| BlockToStepN              | 1.524 ms                  | 54.859 ms                 |
| OneStep                   | 147.944 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:25.553171  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 03:31:25.643455  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=338, sample_step_cpp_seen_[rank]=337
E20240205 03:31:25.968026  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4497
W20240205 03:31:26.704087  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240205 03:31:26.968012  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=273
W20240205 03:31:27.056573  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240205 03:31:27.742894  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240205 03:31:27.968008  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=929
W20240205 03:31:28.075271  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240205 03:31:28.762408  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 436.113 us                | 9.007 ms                  |
| ProcessBack:Shuffle       | 8.828 ms                  | 27.651 ms                 |
| ProcessBack:UpdateCache   | 10.758 ms                 | 20.546 ms                 |
| ProcessBack:UpsertPq      | 33.747 ms                 | 187.578 ms                |
| ProcessOneStep            | 103.343 ms                | 1.319 s                   |
| BlockToStepN              | 1.477 ms                  | 46.809 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:28.968014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2094
W20240205 03:31:29.774900  6802 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 03:31:29.968009  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=1546
W20240205 03:31:29.997134  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=353, pq.top=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.362 ms                  | 433.350 ms                |
| Forward                   | 5.489 ms                  | 11.772 ms                 |
| Backward                  | 5.704 ms                  | 10.092 ms                 |
| Optimize                  | 2.589 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.577 ms                  | 120.907 ms                |
| AfterBackward             | 103.917 ms                | 1.319 s                   |
| BlockToStepN              | 1.576 ms                  | 46.924 ms                 |
| OneStep                   | 147.558 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:30.876856  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
E20240205 03:31:30.968011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=46217
W20240205 03:31:31.224972  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240205 03:31:31.968015  6829 parallel_pq_v2.h:79] insert failed, size(hashtable)=131290
E20240205 03:31:32.003424  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=367, sample_step_cpp_seen_[rank]=366
W20240205 03:31:32.034093  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 03:31:32.968015  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=6367
W20240205 03:31:33.139082  6802 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 03:31:33.350976  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 395.686 us                | 10.149 ms                 |
| ProcessBack:Shuffle       | 8.838 ms                  | 27.651 ms                 |
| ProcessBack:UpdateCache   | 10.753 ms                 | 20.546 ms                 |
| ProcessBack:UpsertPq      | 33.148 ms                 | 187.578 ms                |
| ProcessOneStep            | 104.039 ms                | 1.319 s                   |
| BlockToStepN              | 1.520 ms                  | 54.733 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:33.968009  6815 parallel_pq_v2.h:79] insert failed, size(hashtable)=56384
W20240205 03:31:34.180279  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 03:31:34.438587  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=376, pq.top=375
E20240205 03:31:34.968008  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=154
W20240205 03:31:35.182013  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.190 ms                  | 433.350 ms                |
| Forward                   | 5.484 ms                  | 11.772 ms                 |
| Backward                  | 5.494 ms                  | 10.092 ms                 |
| Optimize                  | 2.585 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.607 ms                  | 120.907 ms                |
| AfterBackward             | 103.384 ms                | 1.319 s                   |
| BlockToStepN              | 1.643 ms                  | 54.859 ms                 |
| OneStep                   | 147.425 ms                | 1.342 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:35.968022  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=4934
W20240205 03:31:36.336160  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240205 03:31:36.756263  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240205 03:31:36.968012  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=369
W20240205 03:31:37.440726  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 03:31:37.811789  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240205 03:31:37.968012  2363 parallel_pq_v2.h:79] insert failed, size(hashtable)=2540
E20240205 03:31:38.322125  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=397, sample_step_cpp_seen_[rank]=396
W20240205 03:31:38.661336  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 522.820 us                | 11.847 ms                 |
| ProcessBack:Shuffle       | 8.855 ms                  | 26.451 ms                 |
| ProcessBack:UpdateCache   | 10.703 ms                 | 16.800 ms                 |
| ProcessBack:UpsertPq      | 32.594 ms                 | 185.554 ms                |
| ProcessOneStep            | 103.223 ms                | 1.328 s                   |
| BlockToStepN              | 1.648 ms                  | 54.733 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:38.968695  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:39.681967  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
[proc 0] 400 steps, total: 22.141, sample: 1.367, forward: 0.549, backward: 0.547, update: 0.267
[proc 6] 400 steps, total: 22.141, sample: 1.045, forward: 0.593, backward: 0.532, update: 0.267
[proc 2] 400 steps, total: 22.140, sample: 1.285, forward: 0.535, backward: 0.762, update: 0.227
[proc 5] 400 steps, total: 22.141, sample: 1.069, forward: 0.570, backward: 0.580, update: 0.237
[proc 4] 400 steps, total: 22.140, sample: 1.082, forward: 0.561, backward: 0.551, update: 0.238
[proc 7] 400 steps, total: 22.141, sample: 1.009, forward: 0.597, backward: 0.562, update: 0.237
[proc 3] 400 steps, total: 22.140, sample: 1.088, forward: 0.554, backward: 0.525, update: 0.225
[proc 1] 400 steps, total: 22.141, sample: 1.214, forward: 0.565, backward: 0.666, update: 0.241
E20240205 03:31:39.968010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=42447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.903 ms                  | 433.350 ms                |
| Forward                   | 5.525 ms                  | 11.772 ms                 |
| Backward                  | 5.417 ms                  | 10.092 ms                 |
| Optimize                  | 2.603 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.659 ms                  | 120.907 ms                |
| AfterBackward             | 103.384 ms                | 1.328 s                   |
| BlockToStepN              | 1.743 ms                  | 54.859 ms                 |
| OneStep                   | 147.304 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:40.404449  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240205 03:31:40.700877  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 03:31:40.968015  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=11094
W20240205 03:31:41.446030  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240205 03:31:41.833465  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 03:31:41.968010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2852
W20240205 03:31:42.861737  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 03:31:42.968010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=31292
W20240205 03:31:43.034250  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=415, pq.top=414
W20240205 03:31:43.945210  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 485.952 us                | 18.118 ms                 |
| ProcessBack:Shuffle       | 8.894 ms                  | 27.651 ms                 |
| ProcessBack:UpdateCache   | 10.704 ms                 | 16.800 ms                 |
| ProcessBack:UpsertPq      | 32.536 ms                 | 185.554 ms                |
| ProcessOneStep            | 103.223 ms                | 1.328 s                   |
| BlockToStepN              | 1.703 ms                  | 54.733 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:43.968011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=12348
W20240205 03:31:44.189844  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=423, pq.top=423
E20240205 03:31:44.686450  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=427, sample_step_cpp_seen_[rank]=426
E20240205 03:31:44.968011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=3632
W20240205 03:31:45.169445  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.985 ms                  | 433.350 ms                |
| Forward                   | 5.534 ms                  | 11.772 ms                 |
| Backward                  | 5.571 ms                  | 11.605 ms                 |
| Optimize                  | 2.603 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.462 ms                  | 120.907 ms                |
| AfterBackward             | 103.384 ms                | 1.328 s                   |
| BlockToStepN              | 1.816 ms                  | 54.859 ms                 |
| OneStep                   | 146.921 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:45.968014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=15648
W20240205 03:31:46.170920  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 03:31:46.875766  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=434, pq.top=433
E20240205 03:31:46.968433  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:47.222558  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 03:31:47.968011  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=24075
W20240205 03:31:48.063585  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240205 03:31:48.305279  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 492.163 us                | 25.115 ms                 |
| ProcessBack:Shuffle       | 8.920 ms                  | 28.375 ms                 |
| ProcessBack:UpdateCache   | 10.704 ms                 | 16.800 ms                 |
| ProcessBack:UpsertPq      | 32.446 ms                 | 181.768 ms                |
| ProcessOneStep            | 103.330 ms                | 1.328 s                   |
| BlockToStepN              | 1.753 ms                  | 70.900 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:48.970883  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:49.476958  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240205 03:31:49.686012  2363 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=445, sample_step_cpp_seen_[rank]=444
E20240205 03:31:49.970009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=6430
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.903 ms                  | 433.350 ms                |
| Forward                   | 5.525 ms                  | 11.772 ms                 |
| Backward                  | 5.747 ms                  | 11.605 ms                 |
| Optimize                  | 2.589 ms                  | 7.692 ms                  |
| BarrierTimeBeforeRank0    | 1.131 ms                  | 120.907 ms                |
| AfterBackward             | 103.384 ms                | 1.328 s                   |
| BlockToStepN              | 1.845 ms                  | 70.995 ms                 |
| OneStep                   | 147.304 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:50.511471  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240205 03:31:50.970010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=161434
W20240205 03:31:51.175551  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240205 03:31:51.761181  6802 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 03:31:51.970010  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2296
W20240205 03:31:52.953454  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240205 03:31:52.972401  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 03:31:53.869132  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 403.717 us                | 6.107 ms                  |
| ProcessBack:Shuffle       | 8.920 ms                  | 28.375 ms                 |
| ProcessBack:UpdateCache   | 10.671 ms                 | 16.800 ms                 |
| ProcessBack:UpsertPq      | 31.960 ms                 | 181.768 ms                |
| ProcessOneStep            | 103.330 ms                | 1.328 s                   |
| BlockToStepN              | 1.753 ms                  | 64.226 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 03:31:53.964268  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 03:31:53.972625  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240205 03:31:54.894066  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=472, pq.top=472
E20240205 03:31:54.972013  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=21
W20240205 03:31:55.005787  6802 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.748 ms                  | 378.597 ms                |
| Forward                   | 5.553 ms                  | 11.504 ms                 |
| Backward                  | 5.895 ms                  | 10.092 ms                 |
| Optimize                  | 2.569 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 984.314 us                | 105.537 ms                |
| AfterBackward             | 103.282 ms                | 1.328 s                   |
| BlockToStepN              | 1.864 ms                  | 70.995 ms                 |
| OneStep                   | 147.558 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:55.413964  4651 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=475, sample_step_cpp_seen_[rank]=474
E20240205 03:31:55.972014  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=2663
W20240205 03:31:56.034895  6802 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240205 03:31:56.887444  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=477, pq.top=477
E20240205 03:31:56.973166  6818 parallel_pq_v2.h:79] insert failed, size(hashtable)=52692
W20240205 03:31:57.118638  6802 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240205 03:31:57.887095  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=485, pq.top=484
E20240205 03:31:57.973016  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=66341
W20240205 03:31:58.151901  6802 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 478.948 us                | 9.719 ms                  |
| ProcessBack:Shuffle       | 8.937 ms                  | 27.651 ms                 |
| ProcessBack:UpdateCache   | 10.636 ms                 | 16.091 ms                 |
| ProcessBack:UpsertPq      | 31.725 ms                 | 177.262 ms                |
| ProcessOneStep            | 103.330 ms                | 1.330 s                   |
| BlockToStepN              | 1.815 ms                  | 82.193 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 03:31:58.973009  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=5109
W20240205 03:31:59.271806  6802 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240205 03:31:59.927735  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240205 03:31:59.973008  6802 parallel_pq_v2.h:79] insert failed, size(hashtable)=60053
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.571 ms                  | 378.597 ms                |
| Forward                   | 5.558 ms                  | 11.504 ms                 |
| Backward                  | 6.220 ms                  | 10.092 ms                 |
| Optimize                  | 2.566 ms                  | 8.246 ms                  |
| BarrierTimeBeforeRank0    | 982.131 us                | 105.553 ms                |
| AfterBackward             | 103.384 ms                | 1.330 s                   |
| BlockToStepN              | 1.913 ms                  | 82.331 ms                 |
| OneStep                   | 147.304 ms                | 1.354 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 03:32:00.299347  6802 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240205 03:32:00.959939  2363 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=500, pq.top=500
E20240205 03:32:00.973363  6820 parallel_pq_v2.h:79] insert failed, size(hashtable)=5688
[proc 0] 500 steps, total: 21.215, sample: 1.140, forward: 0.565, backward: 0.775, update: 0.291
[proc 5] 500 steps, total: 21.215, sample: 0.998, forward: 0.557, backward: 0.568, update: 0.236
[proc 3] 500 steps, total: 21.215, sample: 0.996, forward: 0.537, backward: 0.585, update: 0.236
[proc 1] 500 steps, total: 21.215, sample: 1.174, forward: 0.518, backward: 0.580, update: 0.233
[proc 6] 500 steps, total: 21.215, sample: 1.196, forward: 0.550, backward: 0.595, update: 0.236
Successfully xmh. training takes 112.47301411628723 seconds
[proc 2] 500 steps, total: 21.215, sample: 1.148, forward: 0.562, backward: 0.703, update: 0.221
before call kg_cache_controller.StopThreads()
W20240205 03:32:01.020426  2363 grad_async_v2.h:84] call StopThreads. PID = 38954
W20240205 03:32:01.020458  2363 grad_base.h:212] before processOneStepNegThread_.join();
[proc 4] 500 steps, total: 21.215, sample: 0.998, forward: 0.527, backward: 0.592, update: 0.241
[proc 7] 500 steps, total: 21.215, sample: 1.003, forward: 0.551, backward: 0.532, update: 0.242
W20240205 03:32:01.020891  2363 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 03:32:01.020906  2363 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240205 03:32:01.317492  6802 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240205 03:32:01.573861  2363 grad_async_v2.h:105] StopThreads done.
