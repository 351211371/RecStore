WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 10:33:02.356546 42442 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_119', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=2, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [42442 sampler.py:454] Start PreSampling
WARNING [42442 sampler.py:532] Before construct renumbering_dict
WARNING [42442 sampler.py:555] PreSampling done
W20240204 10:33:07.992926 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 10:33:07.993117 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 10:33:07.993170 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 10:33:07.993220 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 10:33:07.993261 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 10:33:07.993319 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 10:33:07.993369 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 10:33:07.993459 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 10:33:07.993508 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 10:33:07.993548 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 10:33:07.993602 42442 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 10:33:07.993642 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 10:33:07.993677 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 10:33:07.993878 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 10:33:07.993932 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 10:33:07.993990 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 10:33:07.994051 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 10:33:07.994109 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 10:33:07.994158 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 10:33:07.994200 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 10:33:07.994243 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 10:33:07.994295 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 10:33:07.994342 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 10:33:07.994390 42442 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 10:33:07.994424 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 10:33:07.994467 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 10:33:07.994550 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 10:33:07.994604 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 10:33:07.994652 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 10:33:07.994706 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 10:33:07.994746 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 10:33:07.994791 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 10:33:07.994839 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 10:33:07.994889 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 10:33:07.994927 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 10:33:07.994979 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 10:33:07.995021 42442 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 10:33:07.995055 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 10:33:07.995097 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 10:33:07.995173 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 10:33:07.995224 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 10:33:07.995268 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 10:33:07.995311 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 10:33:07.995350 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 10:33:07.995390 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 10:33:07.995433 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 10:33:07.995473 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 10:33:07.995513 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 10:33:07.995565 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 10:33:07.995613 42442 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 10:33:07.995647 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 10:33:07.995682 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 10:33:07.995759 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 10:33:07.995817 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 10:33:07.995859 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 10:33:07.995899 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 10:33:07.995949 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 10:33:07.995997 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 10:33:07.996055 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 10:33:07.996102 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 10:33:07.996143 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 10:33:07.996196 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 10:33:07.996237 42442 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 10:33:07.996273 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 10:33:07.996315 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 10:33:07.996394 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 10:33:07.996439 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 10:33:07.996484 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 10:33:07.996533 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 10:33:07.996580 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 10:33:07.996621 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 10:33:07.996662 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 10:33:07.996730 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 10:33:07.996778 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 10:33:07.996827 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 10:33:07.996868 42442 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 10:33:07.996903 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 10:33:07.996937 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 10:33:07.997010 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 10:33:07.997054 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 10:33:07.997095 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 10:33:07.997153 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 10:33:07.997205 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 10:33:07.997251 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 10:33:07.997301 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 10:33:07.997344 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 10:33:07.997406 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 10:33:07.997463 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 10:33:07.997519 42442 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 10:33:07.997555 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 10:33:07.997591 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 10:33:07.997666 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 10:33:07.997711 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 10:33:07.997754 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 10:33:07.997797 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 10:33:07.997846 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 10:33:07.997903 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 10:33:07.997946 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 10:33:07.997995 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 10:33:07.998059 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 10:33:07.998102 42442 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 10:33:07.998144 42442 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 10:33:07.998179 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 10:33:07.998215 42442 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 10:33:08.224171 42442 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240204 10:33:08.313400 42442 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 744, 1070, 1607,  ..., 9495, 8122, 6214]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.074 seconds
[Rank1] pid = 43026
[Rank2] pid = 43052
[Rank3] pid = 43154
[Rank4] pid = 43202
[Rank5] pid = 43282
[Rank6] pid = 43352
INFO [42442 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [43026 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [43052 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [43154 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [43202 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [43202 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43352 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [43282 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [43353 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [43352 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43282 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43154 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43353 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42442 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43026 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43052 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 10:33:10.994400 43388 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240204 10:33:10.995379 43219 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240204 10:33:10.995705 43354 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240204 10:33:10.995752 43283 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240204 10:33:10.995792 43419 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240204 10:33:10.995797 43155 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240204 10:33:10.995977 43091 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240204 10:33:10.996003 43027 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240204 10:33:11.022346 43219 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100027a06000 7.629 MB
W20240204 10:33:11.022531 43219 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000281a9000 7.629 MB
W20240204 10:33:11.022589 43219 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10002894c000 1.49 GB
W20240204 10:33:11.022647 43219 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100087f2f000 1.49 GB
W20240204 10:33:11.022708 43219 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:33:11.022955 43419 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000e7518000 7.629 MB
W20240204 10:33:11.022962 43354 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000e7cbb000 7.629 MB
W20240204 10:33:11.022994 43283 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000e845e000 7.629 MB
W20240204 10:33:11.023125 43354 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000e8c01000 7.629 MB
W20240204 10:33:11.023139 43283 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000e93a4000 7.629 MB
W20240204 10:33:11.023150 43419 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000e9b47000 7.629 MB
W20240204 10:33:11.023201 43354 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1000ea2ea000 1.49 GB
W20240204 10:33:11.023221 43283 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1001498cd000 1.49 GB
W20240204 10:33:11.023228 43419 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001a8eb0000 1.49 GB
W20240204 10:33:11.023278 43354 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100208493000 1.49 GB
W20240204 10:33:11.023305 43283 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100267a76000 1.49 GB
W20240204 10:33:11.023313 43419 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1002c7059000 1.49 GB
W20240204 10:33:11.023351 43354 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:33:11.023367 43283 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:33:11.023375 43419 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:33:11.030131 43354 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 10:33:11.030134 43219 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 10:33:11.030135 43419 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 10:33:11.030167 43283 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 10:33:11.030229 43388 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10032664c000 7.629 MB
W20240204 10:33:11.030345 43388 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100326def000 7.629 MB
W20240204 10:33:11.030388 43027 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100327592000 7.629 MB
W20240204 10:33:11.030412 43388 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100327d35000 1.49 GB
W20240204 10:33:11.030436 43155 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100387318000 7.629 MB
W20240204 10:33:11.030463 43091 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100387abb000 7.629 MB
W20240204 10:33:11.030478 43388 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10038825e000 1.49 GB
W20240204 10:33:11.030546 43388 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 10:33:11.030570 43027 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003e7841000 7.629 MB
W20240204 10:33:11.030596 43155 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1003e7fe4000 7.629 MB
W20240204 10:33:11.030634 43091 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e8787000 7.629 MB
W20240204 10:33:11.030651 43027 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1003e8f2a000 1.49 GB
W20240204 10:33:11.030675 43155 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10044850d000 1.49 GB
W20240204 10:33:11.030719 43091 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1004a7af0000 1.49 GB
W20240204 10:33:11.030738 43027 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005070d3000 1.49 GB
W20240204 10:33:11.030761 43155 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005666b6000 1.49 GB
W20240204 10:33:11.030808 43091 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005c5c99000 1.49 GB
W20240204 10:33:11.030817 43027 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:33:11.030830 43155 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:33:11.030871 43091 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:33:11.043643 43027 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 10:33:11.043658 43155 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 10:33:11.043673 43091 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 10:33:11.043681 43388 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [43154 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [43052 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [43026 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [43282 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [43352 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [43353 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [43202 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 43353
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [42442 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 10:33:13.015221 43388 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.015457 43419 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.015563 43155 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.015676 43091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.015789 43354 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.015916 43219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.016208 43283 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 10:33:13.016320 43027 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 10:33:13.018916 43388 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 2,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 10:33:13.019079 43388 grad_base.h:184] Init GradProcessingBase done
I20240204 10:33:13.023638 43388 grad_async_v2.h:42] Use main thread to update emb.
W20240204 10:33:13.023689 43388 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 10:33:13.023697 43388 kg_controller.h:84] Construct KGCacheController done
E20240204 10:33:13.781159 43091 recstore.cc:66] init folly done
E20240204 10:33:13.781246 43419 recstore.cc:66] init folly done
E20240204 10:33:13.781286 43155 recstore.cc:66] init folly done
E20240204 10:33:13.781328 43354 recstore.cc:66] init folly done
E20240204 10:33:13.781368 43027 recstore.cc:66] init folly done
E20240204 10:33:13.781754 43283 recstore.cc:66] init folly done
E20240204 10:33:13.781869 43388 recstore.cc:66] init folly done
E20240204 10:33:13.781880 43219 recstore.cc:66] init folly done
I20240204 10:33:13.782932 43388 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 10:33:14.516659 44520 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 10:33:14.517055 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
I20240204 10:33:14.549305 43354 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 10:33:14.550716 43419 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.551792 43027 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.551824 43388 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.556641 43219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.563344 43155 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.567065 43091 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 10:33:14.576952 43283 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 10:33:17.152704 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 10:33:17.207250 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 10:33:17.249581 43388 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
W20240204 10:33:17.390738 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=4, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.441 ms                  | 21.681 ms                 |
| Forward                   | 5.323 ms                  | 686.869 ms                |
| Backward                  | 6.412 ms                  | 214.269 ms                |
| Optimize                  | 2.240 ms                  | 4.140 ms                  |
| BarrierTimeBeforeRank0    | 997.251 us                | 105.037 ms                |
| AfterBackward             | 40.024 ms                 | 1.614 s                   |
| BlockToStepN              | 92.403 us                 | 1.026 ms                  |
| OneStep                   | 58.066 ms                 | 2.628 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:18.152007 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=305
W20240204 10:33:18.212571 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
W20240204 10:33:18.512953 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=22, pq.top=22
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 288.829 us                | 8.022 ms                  |
| ProcessBack:Shuffle       | 8.353 ms                  | 346.444 ms                |
| ProcessBack:UpdateCache   | 11.030 ms                 | 915.449 ms                |
| ProcessBack:UpsertPq      | 20.370 ms                 | 49.641 ms                 |
| ProcessOneStep            | 41.429 ms                 | 1.614 s                   |
| BlockToStepN              | 27.567 us                 | 11.077 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:19.152132 44038 parallel_pq_v2.h:79] insert failed, size(hashtable)=525
W20240204 10:33:19.271541 44520 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
W20240204 10:33:19.631388 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=35, pq.top=35
E20240204 10:33:20.152007 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=451
W20240204 10:33:20.272547 44520 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:33:20.650769 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=51, pq.top=51
E20240204 10:33:21.152096 44526 parallel_pq_v2.h:79] insert failed, size(hashtable)=5480
W20240204 10:33:21.278604 44520 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240204 10:33:21.685205 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=67, pq.top=67
E20240204 10:33:22.152057 44525 parallel_pq_v2.h:79] insert failed, size(hashtable)=2296
W20240204 10:33:22.287724 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:22.700700 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.668 ms                  | 21.687 ms                 |
| Forward                   | 5.081 ms                  | 15.275 ms                 |
| Backward                  | 4.877 ms                  | 9.397 ms                  |
| Optimize                  | 2.085 ms                  | 3.918 ms                  |
| BarrierTimeBeforeRank0    | 2.512 ms                  | 24.140 ms                 |
| AfterBackward             | 42.573 ms                 | 303.018 ms                |
| BlockToStepN              | 466.401 us                | 3.687 ms                  |
| OneStep                   | 61.047 ms                 | 319.004 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:23.152021 44530 parallel_pq_v2.h:79] insert failed, size(hashtable)=12508
W20240204 10:33:23.293890 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 10:33:23.755244 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 303.192 us                | 6.532 ms                  |
| ProcessBack:Shuffle       | 8.517 ms                  | 13.945 ms                 |
| ProcessBack:UpdateCache   | 11.044 ms                 | 14.509 ms                 |
| ProcessBack:UpsertPq      | 21.776 ms                 | 26.529 ms                 |
| ProcessOneStep            | 42.534 ms                 | 302.542 ms                |
| BlockToStepN              | 396.221 us                | 3.598 ms                  |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 9.272, sample: 0.389, forward: 1.195, backward: 0.722, update: 0.188
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 9.260, sample: 0.371, forward: 1.167, backward: 0.648, update: 0.183
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 9.274, sample: 0.360, forward: 1.283, backward: 0.667, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 9.266, sample: 0.412, forward: 1.218, backward: 0.791, update: 0.194
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 9.256, sample: 0.373, forward: 1.124, backward: 0.735, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 9.246, sample: 0.381, forward: 1.235, backward: 0.795, update: 0.189
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 9.271, sample: 0.396, forward: 1.213, backward: 0.655, update: 0.193
train_sampler.Prefill()
-------Step 0-------
tensor([ 2079,    43,  3149,  3749, 11391, 11475,  1060,   444, 12399, 11249]) tensor([ 1607, 10172,  6116, 11949, 10711,  1063,   575,  5515,   513, 13694])
-------Step 1-------
tensor([ 2079,    43,  3149,  3749, 11391, 11475,  1060,   444, 12399, 11249]) tensor([ 3381,  8977, 13370,  1771,  1004,  7007, 14575,  8717,  5686, 14315])
-------Step 2-------
tensor([ 8711, 10511,  4773,  3710, 10911,  8027, 11962,    53,  9482,   958]) tensor([ 3558,  4473,  4442, 10283,  6035,  9532, 12824,  9062, 14122, 10339])
-------Step 3-------
tensor([ 8711, 10511,  4773,  3710, 10911,  8027, 11962,    53,  9482,   958]) tensor([ 9178,  7020,  6457,  9702,  6097,   704,  5053,  1970, 13588,  2216])
-------Step 4-------
tensor([   43, 12088, 11384,  5671,  5637,  3001,    59,  8225,  6848,   987]) tensor([ 596, 1113, 4690, 3283, 3730, 2520,  444, 5820, 4918, 1900])
-------Step 5-------
tensor([   43, 12088, 11384,  5671,  5637,  3001,    59,  8225,  6848,   987]) tensor([12115,  4817,  5234,  1646,  2891,   808,   836,  1241,  5309,  6155])
-------Step 6-------
tensor([ 1580,  8737,    54,    60,  8107,  2613,  7288, 13452, 14519, 14396]) tensor([10511,  2855,  6883,  4358,  8014,  8921,  4054,  9238, 10808, 12746])
-------Step 7-------
tensor([ 1580,  8737,    54,    60,  8107,  2613,  7288, 13452, 14519, 14396]) tensor([13841, 13872,  5383,  6908,  1311,  7614,  6262,  3587,   146, 13642])
-------Step 8-------
tensor([ 4079,  7707,  4982, 13641,    26,    71, 11204, 13487,    12,  1924]) tensor([ 5305,  4873,  4794,  7281,  2372, 12557,  9122,  1329,  9552,  3011])
-------Step 9-------
tensor([ 4079,  7707,  4982, 13641,    26,    71, 11204, 13487,    12,  1924]) tensor([11515,  4055, 13769,  7373, 14834, 12322, 12385,  8717,   660, 11702])
before start barrier
start train
[proc 0] 100 steps, total: 9.271, sample: 0.417, forward: 1.210, backward: 0.747, update: 0.212
E20240204 10:33:24.152058 44534 parallel_pq_v2.h:79] insert failed, size(hashtable)=10563
W20240204 10:33:24.293704 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:24.759896 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=114, pq.top=114
E20240204 10:33:25.152456 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240204 10:33:25.293638 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 10:33:25.822578 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=130, pq.top=130
E20240204 10:33:26.152082 44525 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 10:33:26.299639 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:26.824160 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=144, pq.top=144
E20240204 10:33:27.152026 44524 parallel_pq_v2.h:79] insert failed, size(hashtable)=5756
W20240204 10:33:27.309715 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240204 10:33:27.829494 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.763 ms                  | 25.457 ms                 |
| Forward                   | 5.044 ms                  | 12.201 ms                 |
| Backward                  | 4.677 ms                  | 9.373 ms                  |
| Optimize                  | 2.163 ms                  | 3.800 ms                  |
| BarrierTimeBeforeRank0    | 2.820 ms                  | 18.388 ms                 |
| AfterBackward             | 42.744 ms                 | 79.332 ms                 |
| BlockToStepN              | 657.189 us                | 3.860 ms                  |
| OneStep                   | 63.119 ms                 | 97.020 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:28.152112 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 10:33:28.317752 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 306.825 us                | 7.410 ms                  |
| ProcessBack:Shuffle       | 8.494 ms                  | 13.572 ms                 |
| ProcessBack:UpdateCache   | 10.885 ms                 | 14.302 ms                 |
| ProcessBack:UpsertPq      | 22.122 ms                 | 39.747 ms                 |
| ProcessOneStep            | 42.686 ms                 | 79.281 ms                 |
| BlockToStepN              | 609.747 us                | 3.912 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 10:33:28.851415 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=173, pq.top=173
E20240204 10:33:29.152225 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240204 10:33:29.327410 44520 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240204 10:33:29.917198 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
E20240204 10:33:30.152453 44549 parallel_pq_v2.h:79] insert failed, size(hashtable)=1105
W20240204 10:33:30.333648 44520 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
[proc 6] 200 steps, total: 7.196, sample: 0.411, forward: 0.497, backward: 0.550, update: 0.186
[proc 2] 200 steps, total: 7.196, sample: 0.414, forward: 0.510, backward: 0.495, update: 0.201
[proc 3] 200 steps, total: 7.197, sample: 0.504, forward: 0.537, backward: 0.487, update: 0.194
[proc 7] 200 steps, total: 7.197, sample: 0.406, forward: 0.478, backward: 0.506, update: 0.176
[proc 4] 200 steps, total: 7.197, sample: 0.475, forward: 0.532, backward: 0.586, update: 0.197
[proc 1] 200 steps, total: 7.196, sample: 0.422, forward: 0.523, backward: 0.427, update: 0.197
[proc 5] 200 steps, total: 7.196, sample: 0.482, forward: 0.555, backward: 0.492, update: 0.213
[proc 0] 200 steps, total: 7.196, sample: 0.458, forward: 0.483, backward: 0.454, update: 0.207
W20240204 10:33:31.097455 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=201, pq.top=201
E20240204 10:33:31.152019 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=1031
W20240204 10:33:31.335645 44520 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 10:33:32.152009 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=1419
W20240204 10:33:32.161607 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 10:33:32.339553 44520 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.837 ms                  | 26.809 ms                 |
| Forward                   | 4.980 ms                  | 12.201 ms                 |
| Backward                  | 4.680 ms                  | 9.373 ms                  |
| Optimize                  | 2.159 ms                  | 3.800 ms                  |
| BarrierTimeBeforeRank0    | 3.286 ms                  | 36.995 ms                 |
| AfterBackward             | 42.744 ms                 | 79.332 ms                 |
| BlockToStepN              | 896.483 us                | 4.669 ms                  |
| OneStep                   | 65.322 ms                 | 115.277 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:33.152043 44535 parallel_pq_v2.h:79] insert failed, size(hashtable)=7497
W20240204 10:33:33.198417 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240204 10:33:33.347579 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 308.649 us                | 6.276 ms                  |
| ProcessBack:Shuffle       | 8.376 ms                  | 13.473 ms                 |
| ProcessBack:UpdateCache   | 10.727 ms                 | 14.233 ms                 |
| ProcessBack:UpsertPq      | 22.339 ms                 | 41.362 ms                 |
| ProcessOneStep            | 42.705 ms                 | 79.281 ms                 |
| BlockToStepN              | 843.719 us                | 4.596 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:34.152007 44535 parallel_pq_v2.h:79] insert failed, size(hashtable)=10822
W20240204 10:33:34.226594 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 10:33:34.354326 44520 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 10:33:35.152009 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=1434
W20240204 10:33:35.227612 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240204 10:33:35.359319 44520 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 10:33:36.152042 44550 parallel_pq_v2.h:79] insert failed, size(hashtable)=11089
W20240204 10:33:36.276948 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240204 10:33:36.366998 44520 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240204 10:33:37.153512 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 10:33:37.280392 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240204 10:33:37.368183 44520 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.923 ms                  | 25.457 ms                 |
| Forward                   | 4.978 ms                  | 10.196 ms                 |
| Backward                  | 4.653 ms                  | 9.366 ms                  |
| Optimize                  | 2.181 ms                  | 3.721 ms                  |
| BarrierTimeBeforeRank0    | 3.926 ms                  | 36.611 ms                 |
| AfterBackward             | 42.679 ms                 | 79.332 ms                 |
| BlockToStepN              | 1.142 ms                  | 4.422 ms                  |
| OneStep                   | 67.012 ms                 | 106.030 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:38.153038 44545 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240204 10:33:38.325779 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240204 10:33:38.371428 44520 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 323.928 us                | 6.320 ms                  |
| ProcessBack:Shuffle       | 8.241 ms                  | 13.473 ms                 |
| ProcessBack:UpdateCache   | 10.559 ms                 | 14.233 ms                 |
| ProcessBack:UpsertPq      | 22.397 ms                 | 43.296 ms                 |
| ProcessOneStep            | 42.615 ms                 | 79.281 ms                 |
| BlockToStepN              | 1.124 ms                  | 4.520 ms                  |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 7.845, sample: 0.421, forward: 0.526, backward: 0.469, update: 0.202
[proc 7] 300 steps, total: 7.845, sample: 0.489, forward: 0.583, backward: 0.511, update: 0.213
[proc 4] 300 steps, total: 7.845, sample: 0.436, forward: 0.534, backward: 0.511, update: 0.198
[proc 0] 300 steps, total: 7.845, sample: 0.429, forward: 0.488, backward: 0.474, update: 0.213
[proc 1] 300 steps, total: 7.845, sample: 0.436, forward: 0.530, backward: 0.447, update: 0.198
[proc 2] 300 steps, total: 7.845, sample: 0.344, forward: 0.470, backward: 0.511, update: 0.185
[proc 3] 300 steps, total: 7.845, sample: 0.465, forward: 0.571, backward: 0.502, update: 0.214
[proc 5] 300 steps, total: 7.845, sample: 0.373, forward: 0.475, backward: 0.520, update: 0.183
E20240204 10:33:39.154304 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 10:33:39.359077 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240204 10:33:39.371133 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240204 10:33:40.154007 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=95
W20240204 10:33:40.375946 44520 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240204 10:33:40.410876 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=320, pq.top=320
E20240204 10:33:41.154321 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240204 10:33:41.380600 44520 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:33:41.483196 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=334, pq.top=334
E20240204 10:33:42.154008 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=581
W20240204 10:33:42.412185 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:42.521104 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.986 ms                  | 25.165 ms                 |
| Forward                   | 4.956 ms                  | 9.102 ms                  |
| Backward                  | 4.651 ms                  | 9.327 ms                  |
| Optimize                  | 2.193 ms                  | 3.721 ms                  |
| BarrierTimeBeforeRank0    | 4.607 ms                  | 34.427 ms                 |
| AfterBackward             | 42.631 ms                 | 76.983 ms                 |
| BlockToStepN              | 1.511 ms                  | 4.899 ms                  |
| OneStep                   | 69.327 ms                 | 111.024 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:43.154023 44038 parallel_pq_v2.h:79] insert failed, size(hashtable)=1095
W20240204 10:33:43.415680 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:43.538939 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=358, pq.top=358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 335.405 us                | 6.352 ms                  |
| ProcessBack:Shuffle       | 8.227 ms                  | 14.240 ms                 |
| ProcessBack:UpdateCache   | 10.353 ms                 | 13.476 ms                 |
| ProcessBack:UpsertPq      | 22.516 ms                 | 47.019 ms                 |
| ProcessOneStep            | 42.609 ms                 | 79.281 ms                 |
| BlockToStepN              | 1.457 ms                  | 4.866 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:44.154016 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=1847
W20240204 10:33:44.416965 44520 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 10:33:44.553215 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=370, pq.top=370
E20240204 10:33:45.154009 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=665
W20240204 10:33:45.417086 44520 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:33:45.612032 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240204 10:33:46.154035 44536 parallel_pq_v2.h:79] insert failed, size(hashtable)=8672
W20240204 10:33:46.425288 44520 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 10:33:46.639330 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 7] 400 steps, total: 7.859, sample: 0.444, forward: 0.567, backward: 0.584, update: 0.205
[proc 3] 400 steps, total: 7.859, sample: 0.412, forward: 0.524, backward: 0.458, update: 0.199
[proc 2] 400 steps, total: 7.859, sample: 0.402, forward: 0.489, backward: 0.470, update: 0.189
[proc 6] 400 steps, total: 7.859, sample: 0.434, forward: 0.514, backward: 0.458, update: 0.195
[proc 4] 400 steps, total: 7.859, sample: 0.404, forward: 0.487, backward: 0.483, update: 0.184
[proc 0] 400 steps, total: 7.859, sample: 0.434, forward: 0.471, backward: 0.464, update: 0.216
[proc 1] 400 steps, total: 7.859, sample: 0.425, forward: 0.497, backward: 0.503, update: 0.183
[proc 5] 400 steps, total: 7.859, sample: 0.495, forward: 0.552, backward: 0.467, update: 0.217
E20240204 10:33:47.154017 44038 parallel_pq_v2.h:79] insert failed, size(hashtable)=460
W20240204 10:33:47.429718 44520 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240204 10:33:47.641510 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=412, pq.top=412
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.018 ms                  | 25.165 ms                 |
| Forward                   | 4.919 ms                  | 9.102 ms                  |
| Backward                  | 4.677 ms                  | 9.327 ms                  |
| Optimize                  | 2.196 ms                  | 3.800 ms                  |
| BarrierTimeBeforeRank0    | 4.921 ms                  | 34.427 ms                 |
| AfterBackward             | 42.728 ms                 | 79.332 ms                 |
| BlockToStepN              | 2.103 ms                  | 5.636 ms                  |
| OneStep                   | 70.423 ms                 | 111.173 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:48.154246 44532 parallel_pq_v2.h:79] insert failed, size(hashtable)=3541
W20240204 10:33:48.451747 44520 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240204 10:33:48.667428 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=426, pq.top=426
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 357.003 us                | 7.193 ms                  |
| ProcessBack:Shuffle       | 8.239 ms                  | 14.099 ms                 |
| ProcessBack:UpdateCache   | 10.259 ms                 | 13.993 ms                 |
| ProcessBack:UpsertPq      | 22.742 ms                 | 45.340 ms                 |
| ProcessOneStep            | 42.703 ms                 | 79.281 ms                 |
| BlockToStepN              | 2.187 ms                  | 5.519 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:49.154013 44533 parallel_pq_v2.h:79] insert failed, size(hashtable)=9527
W20240204 10:33:49.451112 44520 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 10:33:49.711705 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=438, pq.top=438
E20240204 10:33:50.154011 43388 parallel_pq_v2.h:79] insert failed, size(hashtable)=810
W20240204 10:33:50.483194 44520 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 10:33:50.754173 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=452, pq.top=452
E20240204 10:33:51.154067 44522 parallel_pq_v2.h:79] insert failed, size(hashtable)=12431
W20240204 10:33:51.491129 44520 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240204 10:33:51.811437 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240204 10:33:52.154011 44038 parallel_pq_v2.h:79] insert failed, size(hashtable)=1079
W20240204 10:33:52.494377 44520 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240204 10:33:52.856319 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=480, pq.top=480
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.099 ms                  | 24.233 ms                 |
| Forward                   | 4.902 ms                  | 8.574 ms                  |
| Backward                  | 4.693 ms                  | 9.298 ms                  |
| Optimize                  | 2.186 ms                  | 3.918 ms                  |
| BarrierTimeBeforeRank0    | 4.801 ms                  | 35.792 ms                 |
| AfterBackward             | 43.069 ms                 | 79.332 ms                 |
| BlockToStepN              | 2.546 ms                  | 5.612 ms                  |
| OneStep                   | 70.567 ms                 | 111.024 ms                |
+---------------------------+---------------------------+---------------------------+
E20240204 10:33:53.154009 44038 parallel_pq_v2.h:79] insert failed, size(hashtable)=995
W20240204 10:33:53.499368 44520 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 347.596 us                | 7.201 ms                  |
| ProcessBack:Shuffle       | 8.263 ms                  | 14.271 ms                 |
| ProcessBack:UpdateCache   | 9.980 ms                  | 13.588 ms                 |
| ProcessBack:UpsertPq      | 23.083 ms                 | 47.473 ms                 |
| ProcessOneStep            | 43.023 ms                 | 79.281 ms                 |
| BlockToStepN              | 2.494 ms                  | 5.507 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240204 10:33:53.883931 43388 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=494, pq.top=494
E20240204 10:33:54.154084 44544 parallel_pq_v2.h:79] insert failed, size(hashtable)=11988
[proc 4] 500 steps, total: 7.635, sample: 0.385, forward: 0.504, backward: 0.535, update: 0.185
[proc 5] 500 steps, total: 7.635, sample: 0.374, forward: 0.500, backward: 0.505, update: 0.193
[proc 3] 500 steps, total: 7.635, sample: 0.442, forward: 0.536, backward: 0.447, update: 0.197
[proc 1] 500 steps, total: 7.635, sample: 0.400, forward: 0.521, backward: 0.400, update: 0.193
[proc 0] 500 steps, total: 7.635, sample: 0.464, forward: 0.468, backward: 0.484, update: 0.210
[proc 6] 500 steps, total: 7.635, sample: 0.388, forward: 0.541, backward: 0.469, update: 0.202
[proc 2] 500 steps, total: 7.635, sample: 0.434, forward: 0.499, backward: 0.450, update: 0.197
[proc 7] 500 steps, total: 7.635, sample: 0.483, forward: 0.563, backward: 0.493, update: 0.207
Successfully xmh. training takes 39.808255672454834 seconds
before call kg_cache_controller.StopThreads()
W20240204 10:33:54.360227 43388 grad_async_v2.h:84] call StopThreads. PID = 42442
W20240204 10:33:54.360268 43388 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 10:33:54.360872 43388 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 10:33:54.360890 43388 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240204 10:33:54.364961 43388 grad_async_v2.h:105] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f6544c22c50>
