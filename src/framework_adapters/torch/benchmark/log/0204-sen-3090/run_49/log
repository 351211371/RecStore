WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 07:36:09.524803 63141 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_108', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=12, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [63141 sampler.py:454] Start PreSampling
WARNING [63141 sampler.py:532] Before construct renumbering_dict
WARNING [63141 sampler.py:555] PreSampling done
W20240205 07:56:48.546775 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 07:56:48.546973 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 07:56:48.547014 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 07:56:48.547044 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 07:56:48.547080 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 07:56:48.547111 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 07:56:48.547147 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 07:56:48.547190 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 07:56:48.547221 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 07:56:48.547258 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 07:56:48.547294 63141 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 07:56:48.547322 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 07:56:48.547355 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 07:56:48.547515 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 07:56:48.547549 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 07:56:48.547590 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 07:56:48.547636 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 07:56:48.547667 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 07:56:48.547694 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 07:56:48.547719 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 07:56:48.547757 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 07:56:48.547791 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 07:56:48.547821 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 07:56:48.547847 63141 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 07:56:48.547869 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 07:56:48.547891 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 07:56:48.547955 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 07:56:48.547986 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 07:56:48.548017 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 07:56:48.548061 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 07:56:48.548094 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 07:56:48.548125 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 07:56:48.548158 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 07:56:48.548190 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 07:56:48.548220 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 07:56:48.548252 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 07:56:48.548277 63141 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 07:56:48.548300 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 07:56:48.548321 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 07:56:48.548381 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 07:56:48.548416 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 07:56:48.548446 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 07:56:48.548472 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 07:56:48.548506 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 07:56:48.548535 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 07:56:48.548568 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 07:56:48.548606 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 07:56:48.548632 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 07:56:48.548660 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 07:56:48.548688 63141 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 07:56:48.548709 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 07:56:48.548731 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 07:56:48.548787 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 07:56:48.548823 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 07:56:48.548853 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 07:56:48.548885 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 07:56:48.548918 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 07:56:48.548955 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 07:56:48.548983 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 07:56:48.549011 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 07:56:48.549036 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 07:56:48.549064 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 07:56:48.549089 63141 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 07:56:48.549111 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 07:56:48.549141 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 07:56:48.549193 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 07:56:48.549229 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 07:56:48.549257 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 07:56:48.549283 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 07:56:48.549314 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 07:56:48.549346 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 07:56:48.549374 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 07:56:48.549404 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 07:56:48.549438 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 07:56:48.549475 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 07:56:48.549510 63141 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 07:56:48.549532 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 07:56:48.549554 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 07:56:48.549605 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 07:56:48.549644 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 07:56:48.549674 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 07:56:48.549701 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 07:56:48.549727 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 07:56:48.549762 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 07:56:48.549791 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 07:56:48.549820 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 07:56:48.549847 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 07:56:48.549883 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 07:56:48.549914 63141 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 07:56:48.549937 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 07:56:48.549960 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 07:56:48.550016 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 07:56:48.550048 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 07:56:48.550081 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 07:56:48.550108 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 07:56:48.550136 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 07:56:48.550180 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 07:56:48.550211 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 07:56:48.550246 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 07:56:48.550278 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 07:56:48.550308 63141 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 07:56:48.550334 63141 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 07:56:48.550357 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 07:56:48.550379 63141 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 07:56:48.964874 63141 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240205 08:05:32.048934 63141 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302715,  4302744,    83294,  ..., 57012541, 51122020,  5151877]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2273.628 seconds
[Rank1] pid = 28324
[Rank2] pid = 28482
[Rank3] pid = 28645
[Rank4] pid = 28808
[Rank5] pid = 29022
[Rank6] pid = 29160
INFO [63141 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28324 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [28482 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [28645 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29022 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29160 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [28808 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [29160 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28808 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29326 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [29326 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28482 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28645 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [29022 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [63141 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [28324 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 08:14:15.238364 29184 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240205 08:14:15.241520 29332 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240205 08:14:15.242303 28833 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240205 08:14:15.242549 29045 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240205 08:14:15.242570 28325 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240205 08:14:15.242604 28495 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240205 08:14:15.242611 28668 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240205 08:14:15.242626 29405 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240205 08:14:15.336848 29405 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497a9000 7.629 MB
W20240205 08:14:15.336915 28833 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102049f4c000 7.629 MB
W20240205 08:14:15.336966 28668 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204a6ef000 7.629 MB
W20240205 08:14:15.336969 29332 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204ae92000 7.629 MB
W20240205 08:14:15.337100 29405 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204b635000 7.629 MB
W20240205 08:14:15.337170 29405 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204bdd8000 1.49 GB
W20240205 08:14:15.337240 29405 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1020ab3bb000 1.49 GB
W20240205 08:14:15.337285 29405 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 08:14:15.337705 29045 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10210a9a0000 7.629 MB
W20240205 08:14:15.339184 29332 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210b147000 7.629 MB
W20240205 08:14:15.339203 28668 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210b8ea000 7.629 MB
W20240205 08:14:15.339253 28833 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210cfd5000 7.629 MB
W20240205 08:14:15.339249 29045 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210c832000 7.629 MB
W20240205 08:14:15.339241 28325 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10210c08f000 7.629 MB
W20240205 08:14:15.339324 29405 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 08:14:15.339385 29184 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10210d778000 7.629 MB
W20240205 08:14:15.339417 29332 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210df1b000 1.49 GB
W20240205 08:14:15.339426 28833 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10216d4fe000 1.49 GB
W20240205 08:14:15.339447 28668 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021ccae1000 1.49 GB
W20240205 08:14:15.339473 29045 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222c0c4000 1.49 GB
W20240205 08:14:15.339491 29332 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10228b6a7000 1.49 GB
W20240205 08:14:15.339547 28325 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1022eac8a000 7.629 MB
W20240205 08:14:15.339639 28325 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1022eb42d000 1.49 GB
W20240205 08:14:15.339671 29184 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10234aa10000 7.629 MB
W20240205 08:14:15.339715 28325 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10234b1b3000 1.49 GB
W20240205 08:14:15.339799 29184 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1023aa796000 1.49 GB
W20240205 08:14:15.341010 29332 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 08:14:15.341044 28668 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102409d79000 1.49 GB
W20240205 08:14:15.341066 29045 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10246935c000 1.49 GB
W20240205 08:14:15.341090 28325 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 08:14:15.341138 28668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 08:14:15.341143 29045 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 08:14:15.341199 28833 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1024c893f000 1.49 GB
W20240205 08:14:15.341246 28833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 08:14:15.341234 29184 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102527f22000 1.49 GB
W20240205 08:14:15.341369 29184 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 08:14:15.341768 28495 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102587507000 7.629 MB
W20240205 08:14:15.341914 28495 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102587caa000 7.629 MB
W20240205 08:14:15.342003 28495 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10258844d000 1.49 GB
W20240205 08:14:15.342079 28495 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a30000 1.49 GB
W20240205 08:14:15.342149 28495 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 08:14:15.359515 29332 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 08:14:15.359544 28325 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 08:14:15.359582 28495 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 08:14:15.359588 28668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 08:14:15.359613 29184 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 08:14:15.361227 28833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 08:14:15.361235 29045 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [29022 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [28324 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 29326
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [63141 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [28482 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [29160 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [29326 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [28645 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [28808 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 08:15:04.909384 28325 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.909473 29332 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910041 28833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910233 29184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910362 28668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910475 29045 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910571 28495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 08:15:04.910630 29405 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 08:15:04.912498 29332 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 12,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 08:15:04.912691 29332 grad_base.h:184] Init GradProcessingBase done
I20240205 08:15:17.120699 29332 grad_async_v2.h:42] Use main thread to update emb.
W20240205 08:15:17.120925 29332 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 08:15:17.120935 29332 kg_controller.h:84] Construct KGCacheController done
E20240205 08:15:17.878859 28668 recstore.cc:66] init folly done
E20240205 08:15:17.879065 29405 recstore.cc:66] init folly done
E20240205 08:15:17.879104 28495 recstore.cc:66] init folly done
E20240205 08:15:17.879175 28325 recstore.cc:66] init folly done
E20240205 08:15:17.879186 29045 recstore.cc:66] init folly done
E20240205 08:15:17.879233 29184 recstore.cc:66] init folly done
E20240205 08:15:17.879310 28833 recstore.cc:66] init folly done
E20240205 08:15:17.879869 29332 recstore.cc:66] init folly done
I20240205 08:15:17.880805 29332 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 08:15:36.415366 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 08:15:36.415738 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 08:15:37.518291 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 08:15:37.518407 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.052 us                | 269.137 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:39.311668 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 08:15:39.362002 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
I20240205 08:15:39.503065 29045 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 08:15:39.572764 28833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 08:15:39.579222 29405 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 08:15:40.361016 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 08:15:40.437479 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
I20240205 08:15:40.885051 28495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240205 08:15:41.509653 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 08:15:41.532554 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 08:15:41.575722 28325 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 08:15:41.982926 28668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.761 us                | 252.562 us                |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:42.956120 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 08:15:42.976173 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 08:15:43.009344 29332 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 08:15:43.916277 29184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 08:15:43.976017 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=20
W20240205 08:15:44.092002 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.326 ms                  | 8.326 ms                  |
| Forward                   | 820.110 ms                | 820.110 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 08:15:46.343760 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 08:15:46.653151 29332 grad_async_v2.h:257] pq is empty
W20240205 08:15:46.656946 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 08:15:46.759382 29332 grad_async_v2.h:257] pq is empty
W20240205 08:15:46.918385 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=3, pq.top=3
E20240205 08:15:47.343014 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240205 08:15:47.749414 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 210.086 us                | 4.114 ms                  |
| ProcessBack:Shuffle       | 8.584 ms                  | 293.473 ms                |
| ProcessBack:UpdateCache   | 9.954 ms                  | 655.595 ms                |
| ProcessBack:UpsertPq      | 52.422 ms                 | 306.344 ms                |
| ProcessOneStep            | 119.556 ms                | 1.536 s                   |
| BlockToStepN              | 571.894 us                | 2.042 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:48.154336 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=9, pq.top=9
E20240205 08:15:48.343009 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 08:15:48.799183 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 08:15:49.067121 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=17, sample_step_cpp_seen_[rank]=16
E20240205 08:15:49.343009 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=70
W20240205 08:15:49.836882 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.243 ms                  | 104.869 ms                |
| Forward                   | 5.077 ms                  | 820.110 ms                |
| Backward                  | 4.529 ms                  | 189.059 ms                |
| Optimize                  | 2.562 ms                  | 5.091 ms                  |
| BarrierTimeBeforeRank0    | 10.009 ms                 | 259.345 ms                |
| AfterBackward             | 99.352 ms                 | 1.537 s                   |
| BlockToStepN              | 747.761 us                | 2.484 ms                  |
| OneStep                   | 150.054 ms                | 2.738 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:50.327912 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=19, pq.top=19
E20240205 08:15:50.343386 34007 parallel_pq_v2.h:79] insert failed, size(hashtable)=443
W20240205 08:15:50.900867 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240205 08:15:51.343010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=221
W20240205 08:15:51.616291 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240205 08:15:51.934149 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 08:15:52.344303 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 08:15:52.680510 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=28, pq.top=28
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 529.346 us                | 12.405 ms                 |
| ProcessBack:Shuffle       | 7.474 ms                  | 254.746 ms                |
| ProcessBack:UpdateCache   | 10.714 ms                 | 654.491 ms                |
| ProcessBack:UpsertPq      | 56.133 ms                 | 197.672 ms                |
| ProcessOneStep            | 122.704 ms                | 1.536 s                   |
| BlockToStepN              | 644.448 us                | 15.315 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:52.991562 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240205 08:15:53.344010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=1913
W20240205 08:15:53.683740 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240205 08:15:54.157778 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 08:15:54.344015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1923
E20240205 08:15:54.828815 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=38, sample_step_cpp_seen_[rank]=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.146 ms                  | 699.847 ms                |
| Forward                   | 5.360 ms                  | 820.110 ms                |
| Backward                  | 4.591 ms                  | 189.059 ms                |
| Optimize                  | 2.562 ms                  | 15.965 ms                 |
| BarrierTimeBeforeRank0    | 6.645 ms                  | 259.345 ms                |
| AfterBackward             | 120.999 ms                | 1.537 s                   |
| BlockToStepN              | 831.341 us                | 15.415 ms                 |
| OneStep                   | 160.538 ms                | 2.738 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:55.173756 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240205 08:15:55.344012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=2018
W20240205 08:15:55.557251 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 08:15:55.919140 29332 grad_async_v2.h:257] pq is empty
W20240205 08:15:56.213888 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240205 08:15:56.344010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=579
W20240205 08:15:56.775624 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240205 08:15:57.219182 33753 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240205 08:15:57.344013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=37574
W20240205 08:15:57.819594 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 578.633 us                | 7.668 ms                  |
| ProcessBack:Shuffle       | 7.545 ms                  | 254.746 ms                |
| ProcessBack:UpdateCache   | 10.065 ms                 | 654.491 ms                |
| ProcessBack:UpsertPq      | 53.432 ms                 | 197.672 ms                |
| ProcessOneStep            | 121.716 ms                | 1.071 s                   |
| BlockToStepN              | 695.815 us                | 12.367 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:15:58.300168 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 08:15:58.344012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=75
E20240205 08:15:59.344015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240205 08:15:59.346298 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 08:15:59.853166 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.099 ms                  | 109.851 ms                |
| Forward                   | 5.375 ms                  | 60.446 ms                 |
| Backward                  | 4.628 ms                  | 10.888 ms                 |
| Optimize                  | 2.709 ms                  | 6.727 ms                  |
| BarrierTimeBeforeRank0    | 2.271 ms                  | 239.342 ms                |
| AfterBackward             | 122.757 ms                | 1.537 s                   |
| BlockToStepN              | 832.874 us                | 12.483 ms                 |
| OneStep                   | 162.435 ms                | 1.665 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:00.344010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=87
W20240205 08:16:00.375588 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
W20240205 08:16:00.952540 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
E20240205 08:16:01.344013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=128
W20240205 08:16:01.482666 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 08:16:01.619400 29332 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=68, sample_step_cpp_seen_[rank]=67
E20240205 08:16:02.344013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=552
W20240205 08:16:02.650467 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 361.995 us                | 2.957 ms                  |
| ProcessBack:Shuffle       | 7.738 ms                  | 254.746 ms                |
| ProcessBack:UpdateCache   | 10.068 ms                 | 654.491 ms                |
| ProcessBack:UpsertPq      | 50.138 ms                 | 197.672 ms                |
| ProcessOneStep            | 119.257 ms                | 1.536 s                   |
| BlockToStepN              | 823.650 us                | 12.367 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:03.093668 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240205 08:16:03.344012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=715
W20240205 08:16:03.775213 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 08:16:04.274657 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=75, pq.top=75
E20240205 08:16:04.344013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=10825
W20240205 08:16:04.875571 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.146 ms                  | 427.488 ms                |
| Forward                   | 5.450 ms                  | 60.446 ms                 |
| Backward                  | 4.830 ms                  | 10.888 ms                 |
| Optimize                  | 2.709 ms                  | 7.186 ms                  |
| BarrierTimeBeforeRank0    | 4.525 ms                  | 239.342 ms                |
| AfterBackward             | 108.756 ms                | 1.537 s                   |
| BlockToStepN              | 926.743 us                | 12.483 ms                 |
| OneStep                   | 154.946 ms                | 1.665 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:05.344015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=184
W20240205 08:16:05.509307 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240205 08:16:05.902143 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 08:16:06.344015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1136
W20240205 08:16:06.930358 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240205 08:16:06.976361 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240205 08:16:07.344009 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=16020
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 463.914 us                | 14.655 ms                 |
| ProcessBack:Shuffle       | 7.873 ms                  | 29.051 ms                 |
| ProcessBack:UpdateCache   | 10.068 ms                 | 18.135 ms                 |
| ProcessBack:UpsertPq      | 34.169 ms                 | 171.631 ms                |
| ProcessOneStep            | 106.774 ms                | 1.536 s                   |
| BlockToStepN              | 1.001 ms                  | 15.315 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:08.038440 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240205 08:16:08.189415 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 08:16:08.272755 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=99, sample_step_cpp_seen_[rank]=98
E20240205 08:16:08.344005 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=846
W20240205 08:16:09.196324 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.796, sample: 1.439, forward: 1.485, backward: 0.771, update: 0.245
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.720, sample: 1.715, forward: 1.386, backward: 0.796, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.723, sample: 2.539, forward: 1.331, backward: 0.813, update: 0.256
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 25.383, sample: 1.481, forward: 1.314, backward: 0.729, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.316, sample: 1.620, forward: 1.323, backward: 0.795, update: 0.264
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.414, sample: 1.404, forward: 1.326, backward: 0.780, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.726, sample: 1.676, forward: 1.283, backward: 0.851, update: 0.266
train_sampler.Prefill()
-------Step 0-------
tensor([   57611,    57656,    57691,    57727,  5977673,   129690, 60145172,
        19594577, 18372001,    57759]) tensor([ 5278529, 16273899, 65009803, 68587733, 22881094, 33959862, 32339538,
        82036099, 75645286, 28634079])
-------Step 1-------
tensor([   57611,    57656,    57691,    57727,  5977673,   129690, 60145172,
        19594577, 18372001,    57759]) tensor([76622711, 28531681, 11957524, 82973687, 75165910, 45324592, 64746870,
        43171021, 35138353, 14347154])
-------Step 2-------
tensor([  145865,   145916,   145943,    27341,   145983,   146014,   146061,
        22965494,   146096,   146123]) tensor([76572343, 25661225, 82227233, 52737121, 37069227, 24728634, 76951916,
        42765306, 13131499, 44359779])
-------Step 3-------
tensor([  145865,   145916,   145943,    27341,   145983,   146014,   146061,
        22965494,   146096,   146123]) tensor([45746533, 78689918, 37309253, 41250301, 60337386, 69168123, 33245179,
        18037772, 26195272,   795941])
-------Step 4-------
tensor([  235844, 49075324,   235870,   164442,   235905,   164489,   235945,
        43056231,   235990,   236024]) tensor([75190436, 10455321, 76216297, 20353072, 65868102, 37480945, 63293585,
        40502032, 84083470, 57011043])
-------Step 5-------
tensor([  235844, 49075324,   235870,   164442,   235905,   164489,   235945,
        43056231,   235990,   236024]) tensor([38324945, 83621033,   228146, 85849039, 61069745, 51853227, 13706807,
         8894260, 77177511, 38928715])
-------Step 6-------
tensor([  327807,    54681,   327843,   327875,    54717, 71442015,   327914,
          327950,   181735, 39330902]) tensor([14724493, 40936534, 35962887, 83079982, 36396343, 32373647, 22252871,
         6296799, 72332187, 83168314])
-------Step 7-------
tensor([  327807,    54681,   327843,   327875,    54717, 71442015,   327914,
          327950,   181735, 39330902]) tensor([26570671, 56012296, 78166094, 52538775, 74266052, 55147902, 60384898,
        52237301, 38177497, 28485728])
-------Step 8-------
tensor([  420040, 26284920,   420098,   198259,   420141,    67557,   420174,
          420216,   420262,   420306]) tensor([49113897, 26138434, 32044544,  1996811, 52947143, 57882756, 13525596,
        66743671,  1457129, 65736939])
-------Step 9-------
tensor([  420040, 26284920,   420098,   198259,   420141,    67557,   420174,
          420216,   420262,   420306]) tensor([51627878, 37507698, 13037108, 60219064,  8406710, 41727874, 27087792,
        39265028, 85882903, 59782774])
before start barrier
start train
[proc 0] 100 steps, total: 26.290, sample: 2.384, forward: 1.488, backward: 0.749, update: 0.313
E20240205 08:16:09.344034 34005 parallel_pq_v2.h:79] insert failed, size(hashtable)=13934
W20240205 08:16:09.555423 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.559 ms                  | 427.488 ms                |
| Forward                   | 5.422 ms                  | 60.446 ms                 |
| Backward                  | 5.050 ms                  | 10.888 ms                 |
| Optimize                  | 2.651 ms                  | 8.119 ms                  |
| BarrierTimeBeforeRank0    | 5.471 ms                  | 239.342 ms                |
| AfterBackward             | 106.832 ms                | 1.537 s                   |
| BlockToStepN              | 1.240 ms                  | 16.950 ms                 |
| OneStep                   | 147.820 ms                | 1.665 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:10.196417 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240205 08:16:10.344020 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1315
W20240205 08:16:10.658114 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=109, pq.top=109
E20240205 08:16:11.344017 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=2947
W20240205 08:16:11.396466 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 08:16:12.344012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=5736
W20240205 08:16:12.432305 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240205 08:16:12.572547 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 372.918 us                | 4.485 ms                  |
| ProcessBack:Shuffle       | 7.878 ms                  | 29.051 ms                 |
| ProcessBack:UpdateCache   | 9.963 ms                  | 18.135 ms                 |
| ProcessBack:UpsertPq      | 31.151 ms                 | 180.315 ms                |
| ProcessOneStep            | 106.696 ms                | 1.536 s                   |
| BlockToStepN              | 1.278 ms                  | 16.888 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:13.344017 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=61461
W20240205 08:16:13.521839 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
W20240205 08:16:13.572240 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=124, pq.top=124
E20240205 08:16:14.344013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=9858
W20240205 08:16:14.583567 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240205 08:16:14.641016 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 08:16:14.765573 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=133, sample_step_cpp_seen_[rank]=132
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.939 ms                  | 427.488 ms                |
| Forward                   | 5.455 ms                  | 60.446 ms                 |
| Backward                  | 5.352 ms                  | 10.888 ms                 |
| Optimize                  | 2.651 ms                  | 8.119 ms                  |
| BarrierTimeBeforeRank0    | 5.063 ms                  | 239.342 ms                |
| AfterBackward             | 104.403 ms                | 1.537 s                   |
| BlockToStepN              | 1.631 ms                  | 64.755 ms                 |
| OneStep                   | 143.538 ms                | 1.665 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:15.344012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=3156
W20240205 08:16:15.641073 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 08:16:16.121465 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
E20240205 08:16:16.344007 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=985
W20240205 08:16:16.727229 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240205 08:16:17.190040 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240205 08:16:17.344008 34005 parallel_pq_v2.h:79] insert failed, size(hashtable)=16495
W20240205 08:16:17.769243 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 491.570 us                | 17.588 ms                 |
| ProcessBack:Shuffle       | 7.882 ms                  | 23.411 ms                 |
| ProcessBack:UpdateCache   | 10.016 ms                 | 14.585 ms                 |
| ProcessBack:UpsertPq      | 29.614 ms                 | 171.631 ms                |
| ProcessOneStep            | 103.690 ms                | 1.536 s                   |
| BlockToStepN              | 1.592 ms                  | 65.184 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:18.351203 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 08:16:18.800712 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 08:16:18.924465 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=150, pq.top=150
E20240205 08:16:19.351049 33999 parallel_pq_v2.h:79] insert failed, size(hashtable)=29229
W20240205 08:16:19.809701 33753 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.865 ms                  | 306.377 ms                |
| Forward                   | 5.445 ms                  | 33.611 ms                 |
| Backward                  | 5.371 ms                  | 11.853 ms                 |
| Optimize                  | 2.675 ms                  | 8.119 ms                  |
| BarrierTimeBeforeRank0    | 4.294 ms                  | 176.567 ms                |
| AfterBackward             | 103.637 ms                | 1.490 s                   |
| BlockToStepN              | 1.682 ms                  | 64.755 ms                 |
| OneStep                   | 143.538 ms                | 1.547 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:20.052104 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=156, pq.top=156
E20240205 08:16:20.351007 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=8096
W20240205 08:16:21.000258 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
W20240205 08:16:21.133371 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=164, pq.top=164
E20240205 08:16:21.351015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1059
E20240205 08:16:21.841315 29332 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=167, sample_step_cpp_seen_[rank]=166
W20240205 08:16:22.140806 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240205 08:16:22.351014 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=2218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 357.447 us                | 5.255 ms                  |
| ProcessBack:Shuffle       | 7.928 ms                  | 23.411 ms                 |
| ProcessBack:UpdateCache   | 9.998 ms                  | 14.585 ms                 |
| ProcessBack:UpsertPq      | 29.021 ms                 | 171.631 ms                |
| ProcessOneStep            | 103.199 ms                | 1.490 s                   |
| BlockToStepN              | 1.657 ms                  | 65.184 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:23.055137 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240205 08:16:23.154759 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240205 08:16:23.351011 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=43009
W20240205 08:16:24.137300 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
E20240205 08:16:24.351017 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=863
W20240205 08:16:24.386487 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.762 ms                  | 306.377 ms                |
| Forward                   | 5.443 ms                  | 33.611 ms                 |
| Backward                  | 5.228 ms                  | 11.853 ms                 |
| Optimize                  | 2.627 ms                  | 8.119 ms                  |
| BarrierTimeBeforeRank0    | 4.294 ms                  | 176.567 ms                |
| AfterBackward             | 102.038 ms                | 1.490 s                   |
| BlockToStepN              | 1.745 ms                  | 82.549 ms                 |
| OneStep                   | 143.538 ms                | 1.547 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:25.248154 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=182, pq.top=182
E20240205 08:16:25.375965 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 08:16:25.403362 33753 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 08:16:26.375010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=7665
W20240205 08:16:26.447474 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240205 08:16:26.471788 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240205 08:16:27.375010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=23235
E20240205 08:16:27.502753 29332 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=197, sample_step_cpp_seen_[rank]=196
W20240205 08:16:27.638993 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 546.546 us                | 19.805 ms                 |
| ProcessBack:Shuffle       | 7.963 ms                  | 23.411 ms                 |
| ProcessBack:UpdateCache   | 9.950 ms                  | 14.576 ms                 |
| ProcessBack:UpsertPq      | 28.213 ms                 | 170.150 ms                |
| ProcessOneStep            | 102.543 ms                | 1.490 s                   |
| BlockToStepN              | 1.604 ms                  | 82.429 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:28.375013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=6835
W20240205 08:16:28.725507 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
[proc 0] 200 steps, total: 19.857, sample: 1.704, forward: 0.564, backward: 0.600, update: 0.330
[proc 7] 200 steps, total: 19.858, sample: 1.069, forward: 0.585, backward: 0.596, update: 0.247
[proc 6] 200 steps, total: 19.858, sample: 1.299, forward: 0.585, backward: 0.624, update: 0.247
[proc 3] 200 steps, total: 19.858, sample: 1.371, forward: 0.551, backward: 0.641, update: 0.245
[proc 2] 200 steps, total: 19.858, sample: 1.807, forward: 0.517, backward: 0.621, update: 0.251
[proc 1] 200 steps, total: 19.858, sample: 2.058, forward: 0.558, backward: 0.689, update: 0.265
[proc 5] 200 steps, total: 19.858, sample: 1.107, forward: 0.562, backward: 0.584, update: 0.237
[proc 4] 200 steps, total: 19.858, sample: 1.223, forward: 0.581, backward: 0.618, update: 0.233
E20240205 08:16:29.375027 34013 parallel_pq_v2.h:79] insert failed, size(hashtable)=66152
W20240205 08:16:29.514709 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 08:16:29.816304 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.519 ms                  | 306.377 ms                |
| Forward                   | 5.443 ms                  | 33.611 ms                 |
| Backward                  | 5.221 ms                  | 11.853 ms                 |
| Optimize                  | 2.627 ms                  | 8.213 ms                  |
| BarrierTimeBeforeRank0    | 5.463 ms                  | 189.813 ms                |
| AfterBackward             | 102.607 ms                | 1.490 s                   |
| BlockToStepN              | 1.635 ms                  | 82.549 ms                 |
| OneStep                   | 144.641 ms                | 1.547 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:30.375011 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=626
W20240205 08:16:30.894461 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 08:16:31.375015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=7337
W20240205 08:16:31.568651 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 08:16:31.914891 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240205 08:16:32.375011 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=1009
W20240205 08:16:32.636184 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 433.658 us                | 19.681 ms                 |
| ProcessBack:Shuffle       | 7.992 ms                  | 23.715 ms                 |
| ProcessBack:UpdateCache   | 9.910 ms                  | 14.576 ms                 |
| ProcessBack:UpsertPq      | 28.119 ms                 | 170.150 ms                |
| ProcessOneStep            | 101.994 ms                | 1.490 s                   |
| BlockToStepN              | 1.604 ms                  | 82.429 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:32.950583 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 08:16:33.375010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=662
W20240205 08:16:33.715658 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240205 08:16:33.757694 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=227, sample_step_cpp_seen_[rank]=226
W20240205 08:16:34.098716 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240205 08:16:34.383263 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=42
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.503 ms                  | 306.377 ms                |
| Forward                   | 5.434 ms                  | 33.611 ms                 |
| Backward                  | 5.230 ms                  | 13.647 ms                 |
| Optimize                  | 2.639 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 4.546 ms                  | 189.813 ms                |
| AfterBackward             | 102.038 ms                | 1.490 s                   |
| BlockToStepN              | 1.733 ms                  | 82.549 ms                 |
| OneStep                   | 144.641 ms                | 1.547 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:35.021883 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 08:16:35.145429 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240205 08:16:35.383015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=42445
W20240205 08:16:36.148456 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 08:16:36.200394 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240205 08:16:36.383018 33999 parallel_pq_v2.h:79] insert failed, size(hashtable)=12326
W20240205 08:16:37.191736 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=243, pq.top=243
E20240205 08:16:37.383014 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240205 08:16:37.394340 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 441.671 us                | 22.609 ms                 |
| ProcessBack:Shuffle       | 8.012 ms                  | 24.975 ms                 |
| ProcessBack:UpdateCache   | 9.908 ms                  | 14.585 ms                 |
| ProcessBack:UpsertPq      | 28.119 ms                 | 170.150 ms                |
| ProcessOneStep            | 102.543 ms                | 1.490 s                   |
| BlockToStepN              | 1.657 ms                  | 82.429 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:38.383010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=18200
W20240205 08:16:38.398795 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240205 08:16:38.628618 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240205 08:16:39.383010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=37929
W20240205 08:16:39.421170 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240205 08:16:39.697067 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.282 ms                  | 299.913 ms                |
| Forward                   | 5.446 ms                  | 27.866 ms                 |
| Backward                  | 5.248 ms                  | 11.853 ms                 |
| Optimize                  | 2.669 ms                  | 8.213 ms                  |
| BarrierTimeBeforeRank0    | 4.932 ms                  | 176.567 ms                |
| AfterBackward             | 102.862 ms                | 1.149 s                   |
| BlockToStepN              | 1.780 ms                  | 65.754 ms                 |
| OneStep                   | 145.274 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:40.383009 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=16092
W20240205 08:16:40.563561 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
W20240205 08:16:40.722728 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=259, pq.top=259
E20240205 08:16:40.881265 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=260, sample_step_cpp_seen_[rank]=259
E20240205 08:16:41.383019 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1314
W20240205 08:16:41.701524 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240205 08:16:42.227604 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=261, pq.top=261
E20240205 08:16:42.383019 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1585
W20240205 08:16:42.826666 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 428.053 us                | 5.461 ms                  |
| ProcessBack:Shuffle       | 8.026 ms                  | 24.975 ms                 |
| ProcessBack:UpdateCache   | 9.910 ms                  | 14.585 ms                 |
| ProcessBack:UpsertPq      | 28.392 ms                 | 170.150 ms                |
| ProcessOneStep            | 102.812 ms                | 1.366 s                   |
| BlockToStepN              | 1.735 ms                  | 65.630 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:43.354117 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=267, pq.top=267
E20240205 08:16:43.383010 34013 parallel_pq_v2.h:79] insert failed, size(hashtable)=46875
W20240205 08:16:43.988866 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 08:16:44.383016 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=47740
W20240205 08:16:44.394670 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.164 ms                  | 299.913 ms                |
| Forward                   | 5.446 ms                  | 27.866 ms                 |
| Backward                  | 5.304 ms                  | 11.853 ms                 |
| Optimize                  | 2.651 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 3.878 ms                  | 176.567 ms                |
| AfterBackward             | 102.862 ms                | 1.366 s                   |
| BlockToStepN              | 1.935 ms                  | 65.754 ms                 |
| OneStep                   | 143.538 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:44.995188 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240205 08:16:45.383018 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=4722
W20240205 08:16:45.839516 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240205 08:16:46.001168 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240205 08:16:46.408985 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 08:16:47.011080 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240205 08:16:47.408020 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=25877
W20240205 08:16:47.852118 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 498.701 us                | 21.449 ms                 |
| ProcessBack:Shuffle       | 8.133 ms                  | 27.771 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 14.689 ms                 |
| ProcessBack:UpsertPq      | 28.569 ms                 | 170.150 ms                |
| ProcessOneStep            | 102.817 ms                | 1.366 s                   |
| BlockToStepN              | 1.905 ms                  | 65.630 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:48.309945 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 08:16:48.411373 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240205 08:16:48.728739 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=295, sample_step_cpp_seen_[rank]=294
W20240205 08:16:49.374550 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240205 08:16:49.411006 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=4288
W20240205 08:16:49.695129 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=296, pq.top=296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.501 ms                  | 299.913 ms                |
| Forward                   | 5.455 ms                  | 27.866 ms                 |
| Backward                  | 5.381 ms                  | 11.853 ms                 |
| Optimize                  | 2.669 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 3.582 ms                  | 176.567 ms                |
| AfterBackward             | 103.182 ms                | 1.366 s                   |
| BlockToStepN              | 2.016 ms                  | 65.754 ms                 |
| OneStep                   | 145.515 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 21.137, sample: 1.132, forward: 0.546, backward: 0.546, update: 0.244
[proc 4] 300 steps, total: 21.136, sample: 1.021, forward: 0.563, backward: 0.642, update: 0.236
[proc 2] 300 steps, total: 21.136, sample: 1.677, forward: 0.566, backward: 0.640, update: 0.266
[proc 5] 300 steps, total: 21.136, sample: 1.042, forward: 0.569, backward: 0.610, update: 0.248
[proc 3] 300 steps, total: 21.137, sample: 1.304, forward: 0.521, backward: 0.611, update: 0.232
[proc 0] 300 steps, total: 21.137, sample: 1.867, forward: 0.584, backward: 0.654, update: 0.324
[proc 1] 300 steps, total: 21.136, sample: 1.789, forward: 0.526, backward: 0.563, update: 0.247
[proc 7] 300 steps, total: 21.137, sample: 0.977, forward: 0.579, backward: 0.556, update: 0.250
E20240205 08:16:50.411010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=37516
W20240205 08:16:50.445073 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 08:16:50.769196 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240205 08:16:51.411017 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=678
W20240205 08:16:51.588721 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
W20240205 08:16:52.107506 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=311, pq.top=311
E20240205 08:16:52.411012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=36987
W20240205 08:16:52.808091 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 584.356 us                | 18.017 ms                 |
| ProcessBack:Shuffle       | 8.170 ms                  | 27.771 ms                 |
| ProcessBack:UpdateCache   | 9.940 ms                  | 14.689 ms                 |
| ProcessBack:UpsertPq      | 29.021 ms                 | 171.631 ms                |
| ProcessOneStep            | 102.817 ms                | 1.366 s                   |
| BlockToStepN              | 1.929 ms                  | 65.630 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:16:53.411015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=527
E20240205 08:16:53.728010 29332 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=317, sample_step_cpp_seen_[rank]=316
W20240205 08:16:53.829061 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240205 08:16:54.173921 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=320, pq.top=320
E20240205 08:16:54.411010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=14891
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.541 ms                  | 299.913 ms                |
| Forward                   | 5.465 ms                  | 27.866 ms                 |
| Backward                  | 5.462 ms                  | 12.778 ms                 |
| Optimize                  | 2.675 ms                  | 10.354 ms                 |
| BarrierTimeBeforeRank0    | 2.940 ms                  | 176.567 ms                |
| AfterBackward             | 102.862 ms                | 1.366 s                   |
| BlockToStepN              | 2.056 ms                  | 65.754 ms                 |
| OneStep                   | 144.328 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:54.972659 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
W20240205 08:16:55.228426 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=328, pq.top=328
E20240205 08:16:55.411010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=43819
W20240205 08:16:56.141340 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 08:16:56.411012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1093
W20240205 08:16:56.778914 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240205 08:16:57.142069 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 08:16:57.411012 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=19777
W20240205 08:16:57.796805 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=341, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 401.669 us                | 6.558 ms                  |
| ProcessBack:Shuffle       | 8.217 ms                  | 25.602 ms                 |
| ProcessBack:UpdateCache   | 9.910 ms                  | 15.691 ms                 |
| ProcessBack:UpsertPq      | 29.166 ms                 | 170.150 ms                |
| ProcessOneStep            | 102.812 ms                | 1.366 s                   |
| BlockToStepN              | 1.950 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:16:58.329807 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 08:16:58.411010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=25019
E20240205 08:16:58.747679 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=347, sample_step_cpp_seen_[rank]=346
W20240205 08:16:59.353325 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240205 08:16:59.417042 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.711 ms                  | 299.913 ms                |
| Forward                   | 5.456 ms                  | 27.866 ms                 |
| Backward                  | 5.422 ms                  | 12.778 ms                 |
| Optimize                  | 2.654 ms                  | 10.354 ms                 |
| BarrierTimeBeforeRank0    | 3.033 ms                  | 176.567 ms                |
| AfterBackward             | 102.862 ms                | 1.366 s                   |
| BlockToStepN              | 2.093 ms                  | 88.839 ms                 |
| OneStep                   | 144.328 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:00.293912 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=352, pq.top=352
W20240205 08:17:00.394096 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240205 08:17:00.417006 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=21789
E20240205 08:17:01.417330 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=12033
W20240205 08:17:01.517987 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
W20240205 08:17:01.804764 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240205 08:17:02.417011 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=19019
W20240205 08:17:02.686945 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 523.410 us                | 30.659 ms                 |
| ProcessBack:Shuffle       | 8.207 ms                  | 25.602 ms                 |
| ProcessBack:UpdateCache   | 9.886 ms                  | 15.691 ms                 |
| ProcessBack:UpsertPq      | 28.756 ms                 | 170.150 ms                |
| ProcessOneStep            | 101.480 ms                | 1.149 s                   |
| BlockToStepN              | 2.063 ms                  | 86.169 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:03.058059 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=372, pq.top=372
E20240205 08:17:03.417047 34021 parallel_pq_v2.h:79] insert failed, size(hashtable)=42864
E20240205 08:17:03.747011 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=374, sample_step_cpp_seen_[rank]=373
W20240205 08:17:03.750283 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240205 08:17:04.417109 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=3162
W20240205 08:17:04.627180 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240205 08:17:04.763262 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.849 ms                  | 226.063 ms                |
| Forward                   | 5.450 ms                  | 11.895 ms                 |
| Backward                  | 5.364 ms                  | 11.853 ms                 |
| Optimize                  | 2.640 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 2.676 ms                  | 153.168 ms                |
| AfterBackward             | 101.529 ms                | 1.149 s                   |
| BlockToStepN              | 2.185 ms                  | 88.839 ms                 |
| OneStep                   | 143.185 ms                | 1.389 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:17:05.417019 34012 parallel_pq_v2.h:79] insert failed, size(hashtable)=22790
W20240205 08:17:05.680209 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240205 08:17:05.939960 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240205 08:17:06.417428 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=139965
W20240205 08:17:07.009809 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240205 08:17:07.417011 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=7817
W20240205 08:17:07.589290 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=391, pq.top=391
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 580.257 us                | 17.317 ms                 |
| ProcessBack:Shuffle       | 8.256 ms                  | 24.975 ms                 |
| ProcessBack:UpdateCache   | 9.878 ms                  | 15.985 ms                 |
| ProcessBack:UpsertPq      | 29.021 ms                 | 169.994 ms                |
| ProcessOneStep            | 101.480 ms                | 1.149 s                   |
| BlockToStepN              | 2.103 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:08.029160 33753 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240205 08:17:08.417011 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240205 08:17:08.611785 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=399, pq.top=398
[proc 0] 400 steps, total: 18.462, sample: 1.763, forward: 0.573, backward: 0.613, update: 0.300
[proc 5] 400 steps, total: 18.463, sample: 1.033, forward: 0.598, backward: 0.605, update: 0.246
[proc 6] 400 steps, total: 18.463, sample: 1.136, forward: 0.535, backward: 0.610, update: 0.246
[proc 1] 400 steps, total: 18.462, sample: 1.468, forward: 0.552, backward: 0.605, update: 0.263
[proc 7] 400 steps, total: 18.462, sample: 0.927, forward: 0.591, backward: 0.523, update: 0.242
[proc 2] 400 steps, total: 18.463, sample: 1.410, forward: 0.551, backward: 0.750, update: 0.260
[proc 3] 400 steps, total: 18.462, sample: 1.169, forward: 0.534, backward: 0.535, update: 0.234
[proc 4] 400 steps, total: 18.463, sample: 0.984, forward: 0.557, backward: 0.614, update: 0.227
W20240205 08:17:09.156333 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 08:17:09.418453 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=34021
E20240205 08:17:09.457760 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=405, sample_step_cpp_seen_[rank]=404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.865 ms                  | 226.063 ms                |
| Forward                   | 5.465 ms                  | 19.015 ms                 |
| Backward                  | 5.426 ms                  | 11.853 ms                 |
| Optimize                  | 2.639 ms                  | 10.354 ms                 |
| BarrierTimeBeforeRank0    | 2.503 ms                  | 153.168 ms                |
| AfterBackward             | 101.423 ms                | 1.149 s                   |
| BlockToStepN              | 2.272 ms                  | 88.839 ms                 |
| OneStep                   | 143.770 ms                | 1.389 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:10.223582 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240205 08:17:10.418010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1527
W20240205 08:17:10.921655 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240205 08:17:11.248142 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240205 08:17:11.418016 33752 parallel_pq_v2.h:79] insert failed, size(hashtable)=12462
W20240205 08:17:12.115253 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240205 08:17:12.258467 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 08:17:12.418010 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=106487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 557.969 us                | 22.357 ms                 |
| ProcessBack:Shuffle       | 8.273 ms                  | 24.975 ms                 |
| ProcessBack:UpdateCache   | 9.804 ms                  | 15.985 ms                 |
| ProcessBack:UpsertPq      | 28.569 ms                 | 169.994 ms                |
| ProcessOneStep            | 101.053 ms                | 1.155 s                   |
| BlockToStepN              | 2.232 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:13.357432 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240205 08:17:13.418258 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 08:17:13.703454 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=422, pq.top=422
E20240205 08:17:14.418011 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=1147
W20240205 08:17:14.469480 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.863 ms                  | 226.063 ms                |
| Forward                   | 5.467 ms                  | 19.015 ms                 |
| Backward                  | 5.486 ms                  | 11.853 ms                 |
| Optimize                  | 2.640 ms                  | 10.354 ms                 |
| BarrierTimeBeforeRank0    | 2.652 ms                  | 153.168 ms                |
| AfterBackward             | 101.106 ms                | 1.155 s                   |
| BlockToStepN              | 2.385 ms                  | 88.839 ms                 |
| OneStep                   | 143.185 ms                | 1.389 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:14.940570 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240205 08:17:15.418009 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=68181
W20240205 08:17:15.640275 33753 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240205 08:17:15.790093 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=437, sample_step_cpp_seen_[rank]=436
E20240205 08:17:16.418016 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=5295
W20240205 08:17:16.658195 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240205 08:17:17.274386 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=441, pq.top=441
E20240205 08:17:17.418013 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=7831
W20240205 08:17:17.754976 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 589.096 us                | 21.725 ms                 |
| ProcessBack:Shuffle       | 8.309 ms                  | 24.861 ms                 |
| ProcessBack:UpdateCache   | 9.749 ms                  | 15.691 ms                 |
| ProcessBack:UpsertPq      | 28.468 ms                 | 167.624 ms                |
| ProcessOneStep            | 101.053 ms                | 1.155 s                   |
| BlockToStepN              | 2.351 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:17:18.418016 34010 parallel_pq_v2.h:79] insert failed, size(hashtable)=90220
W20240205 08:17:18.429116 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240205 08:17:18.798987 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240205 08:17:19.418012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=441
W20240205 08:17:19.674582 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240205 08:17:19.798792 33753 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.865 ms                  | 204.997 ms                |
| Forward                   | 5.476 ms                  | 11.895 ms                 |
| Backward                  | 5.488 ms                  | 11.175 ms                 |
| Optimize                  | 2.640 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 2.652 ms                  | 142.275 ms                |
| AfterBackward             | 100.759 ms                | 1.149 s                   |
| BlockToStepN              | 2.463 ms                  | 88.839 ms                 |
| OneStep                   | 143.185 ms                | 1.195 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 08:17:20.418015 34009 parallel_pq_v2.h:79] insert failed, size(hashtable)=23135
W20240205 08:17:20.674896 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240205 08:17:20.801625 33753 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240205 08:17:21.185433 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=465, sample_step_cpp_seen_[rank]=464
E20240205 08:17:21.418074 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=561
W20240205 08:17:21.878321 33753 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240205 08:17:22.273625 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=466, pq.top=466
E20240205 08:17:22.418010 29332 parallel_pq_v2.h:79] insert failed, size(hashtable)=2207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 594.388 us                | 38.976 ms                 |
| ProcessBack:Shuffle       | 8.308 ms                  | 24.861 ms                 |
| ProcessBack:UpdateCache   | 9.749 ms                  | 15.691 ms                 |
| ProcessBack:UpsertPq      | 28.325 ms                 | 167.624 ms                |
| ProcessOneStep            | 100.507 ms                | 1.149 s                   |
| BlockToStepN              | 2.394 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:22.956025 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240205 08:17:23.377796 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=473, pq.top=472
E20240205 08:17:23.418015 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=37879
W20240205 08:17:24.166585 33753 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240205 08:17:24.418017 34018 parallel_pq_v2.h:79] insert failed, size(hashtable)=37418
W20240205 08:17:24.421857 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.863 ms                  | 204.997 ms                |
| Forward                   | 5.482 ms                  | 12.179 ms                 |
| Backward                  | 5.478 ms                  | 11.175 ms                 |
| Optimize                  | 2.640 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 2.652 ms                  | 142.275 ms                |
| AfterBackward             | 100.551 ms                | 1.149 s                   |
| BlockToStepN              | 2.538 ms                  | 88.839 ms                 |
| OneStep                   | 143.538 ms                | 1.195 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 08:17:25.352620 33753 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 08:17:25.418004 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1913
W20240205 08:17:26.005470 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=483, pq.top=483
E20240205 08:17:26.418012 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=846
W20240205 08:17:26.423419 33753 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
W20240205 08:17:27.062155 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240205 08:17:27.418009 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=43000
W20240205 08:17:27.693390 33753 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 08:17:27.737624 31393 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=496, sample_step_cpp_seen_[rank]=495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 533.111 us                | 32.734 ms                 |
| ProcessBack:Shuffle       | 8.341 ms                  | 23.715 ms                 |
| ProcessBack:UpdateCache   | 9.764 ms                  | 15.036 ms                 |
| ProcessBack:UpsertPq      | 28.229 ms                 | 167.544 ms                |
| ProcessOneStep            | 99.248 ms                 | 1.155 s                   |
| BlockToStepN              | 2.473 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240205 08:17:28.418020 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 08:17:28.699803 33753 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240205 08:17:28.958390 29332 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=497, pq.top=497
E20240205 08:17:29.418008 33753 parallel_pq_v2.h:79] insert failed, size(hashtable)=50285
[proc 0] 500 steps, total: 20.720, sample: 1.267, forward: 0.564, backward: 0.622, update: 0.262
[proc 1] 500 steps, total: 20.719, sample: 1.262, forward: 0.556, backward: 0.646, update: 0.261
[proc 5] 500 steps, total: 20.720, sample: 1.008, forward: 0.558, backward: 0.607, update: 0.243
Successfully xmh. training takes 106.46747469902039 seconds
[proc 2] 500 steps, total: 20.719, sample: 1.143, forward: 0.561, backward: 0.640, update: 0.254
[proc 6] 500 steps, total: 20.720, sample: 1.040, forward: 0.549, backward: 0.558, update: 0.248
before call kg_cache_controller.StopThreads()
W20240205 08:17:29.476898 29332 grad_async_v2.h:84] call StopThreads. PID = 63141
W20240205 08:17:29.476936 29332 grad_base.h:212] before processOneStepNegThread_.join();
[proc 3] 500 steps, total: 20.719, sample: 1.121, forward: 0.552, backward: 0.606, update: 0.241
[proc 7] 500 steps, total: 20.719, sample: 1.042, forward: 0.563, backward: 0.591, update: 0.249
[proc 4] 500 steps, total: 20.719, sample: 1.169, forward: 0.565, backward: 0.667, update: 0.252
W20240205 08:17:29.477376 29332 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 08:17:29.477385 29332 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240205 08:17:29.776072 33753 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 08:17:29.901173 29332 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.849 ms                  | 204.997 ms                |
| Forward                   | 5.467 ms                  | 12.179 ms                 |
| Backward                  | 5.517 ms                  | 11.175 ms                 |
| Optimize                  | 2.627 ms                  | 8.928 ms                  |
| BarrierTimeBeforeRank0    | 2.531 ms                  | 142.275 ms                |
| AfterBackward             | 99.352 ms                 | 1.234 s                   |
| BlockToStepN              | 2.563 ms                  | 88.839 ms                 |
| OneStep                   | 143.041 ms                | 1.389 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 476.531 us                | 19.598 ms                 |
| ProcessBack:Shuffle       | 8.353 ms                  | 23.715 ms                 |
| ProcessBack:UpdateCache   | 9.774 ms                  | 15.036 ms                 |
| ProcessBack:UpsertPq      | 28.340 ms                 | 167.544 ms                |
| ProcessOneStep            | 99.301 ms                 | 1.234 s                   |
| BlockToStepN              | 2.485 ms                  | 88.700 ms                 |
+---------------------------+---------------------------+---------------------------+
